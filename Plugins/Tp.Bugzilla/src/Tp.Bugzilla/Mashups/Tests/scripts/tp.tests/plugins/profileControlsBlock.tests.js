require(["tp/plugins/profileControlsBlock","tp/jquery.utils"],function(a){(function(){module("profile controls block tests",{setup:function(){this.placeholder=$('<div><div class="controls-block" /></div>'),this.block=new a({placeholder:this.placeholder});var b=this;this.block.bus.publish=function(a,c){b.publishedMessage=a,b.publishedArgs=c},this.block.navigator.profileNameSource.setProfileName=function(a){b.profileNameSet=a}},teardown:function(){}}),test("should render create and back buttons",function(){this.block.render(),ok(this.placeholder.find("#save").length>0,"save button rendered"),ok(this.placeholder.find("#cancel").length>0,"back button rendered")}),test("should publish SaveProfile message and disable save button when save button clicked",function(){this.block.render();var a=this;this.placeholder.find("#save").click(),equal(this.publishedMessage,"SaveProfile","SaveProfile message published"),ok(!a.placeholder.find("#save").enabled(),"save button disabled")}),test("should navigate to plugins list when clicked cancel button",function(){this.block.render(),expect(1),this.block.navigator.backToPlugins=function(){ok(!0,"navigated to plugins list")},this.placeholder.find("#cancel").click()}),test("should enable save button on ProfileSaveSucceed message",function(){var a="profile name";this.block.render(),this.placeholder.find("#save").click(),this.block._onProfileSaveSucceed({Name:a}),ok(this.placeholder.find("#save").enabled(),"save button enabled")}),test("should enable save button, show failure status on ProfileSaveFailed",function(){this.block.render(),this.placeholder.find("#save").click(),this.block._onProfileSaveFailed({rawResponse:{status:500,responseText:"some text"}}),ok(this.placeholder.find("#save").enabled(),"save button enabled")})})()})