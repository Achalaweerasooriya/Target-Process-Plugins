(function(){function a(){}a.prototype={options:null,visible:!1,changeLogPopup:function(a){if(a=="show")this.visible=!0;else{if(a=="isVisible")return this.visible;this.options=a}return this}},module("changeLogLink",{setup:function(){this.source=[{Version:{Number:"1"},Url:"http://targetprocess.com/"},{Version:{Number:"2"},Url:"http://google.com/"},{Version:{Number:"3"},Url:"http://plan.tpondemand.com/"}],this.target=$('<a id="uniqueid" href="http://google.com/"/>'),this.form=$("<div />"),this.container=new a,this.iframe=$('<iframe id="uniqueiframeid"/>'),this.popupOptions={container:this.container,iframe:this.iframe,form:this.form},this.deactivated=!1,this.deactivate=function(){this.deactivated=!0}},teardown:function(){delete this.source,this.target.remove(),delete this.target,delete this.container,this.iframe.remove(),delete this.iframe,delete this.popupOptions,delete this.deactivated,delete this.deactivate}}),test("creation",function(){this.target.changeLogLink({popup:this.popupOptions,source:this.source,opened:!1,deactivate:$.proxy(this.deactivate,this)}),equals(this.container.options.iterator.current().Url,"http://google.com/","iterator should be passed to popup options"),equals(this.container.options.iframe.id(),this.iframe.id(),"iframe should be passed to popup options"),this.target.click(),equals(this.container.visible,!0,'"show" method of popup should be called when link is clicked'),equals(this.deactivated,!0,"link should be deactivated")}),test("opened",function(){this.target.changeLogLink({popup:this.popupOptions,source:this.source,opened:!0,deactivate:$.proxy(this.deactivate,this)}),equals(this.container.visible,!0,'"show" method of popup should be called right after creation'),equals(this.deactivated,!0,"link should be deactivated")})})()