define(["Underscore","tau/core/model.editable.base"],function(a,b){return b.extend({category:"edit",name:"Editable attachment","bus dataBind":function(a){this.bus.fire("permissionsReady",{editable:!0,deletable:!0}),this._attachments||(this._attachments=a.data.items)},"bus attachmentUploaded":function(a){this._addAttachment(a.data.data)},onInit:function(){var a=this;this.store.on({eventName:"afterRemove",listener:a,type:"attachment"},function(b){var c=parseInt(b.data.cmd.config.id);a._isValidAttachmentId(c)&&(a._removeAttachment(c),a.bus.fire("afterAttachmentRemove",{id:c}))})},_addAttachment:function(a){this._attachments.push(a)},_removeAttachment:function(b){this._attachments=a.reject(this._attachments,function(a){return b===a.id})},_isValidAttachmentId:function(b){return a.any(this._attachments,function(a){return a.id===b})}})})