define(["Underscore","tau/core/model.editable.base","tau/models/model.state-list.strategies"],function(a,b,c){return b.extend({name:"states-list",onInit:function(){var b=this,d=b.config.context,e=d.entity.entityType.name,f=d.entity.id,g={id:f,fields:[{entityState:["id"]},{entityType:["id"]}]};e=="iteration"?g.fields=["id"]:e=="project"?g.fields=["id"]:e.toLowerCase()=="testcase"&&(g.fields=[{entityType:["id","name"]}]);var h=this.strategyConfig=c.get(b.config.listType);b.store.get(e,g).done({success:function(c){var e=a(d).clone();b.entity=e.assignable=c[0].data,b.store.get(h.listType,h.getCommand(e)).done({success:b.onDataRetrieved.tauCreateDelegate(b)})}})},onDataRetrieved:function(a){var b=this,c=this.entity,d=a[0].data,e=b.config.data&&b.config.data.value?b.config.data.value:b.config.data,f=b.strategyConfig.filter(c,d,e,b.config),g={states:f.items,completed:f.completed,nullableValue:f.nullableValue===!0};f.defaultValue&&(g.defaultValue=f.defaultValue),b.fire("dataBind",g)},"bus updateState":function(a){var b=this,c=a.data,d={},e=b.config.listType;d[e]={id:c.id},this.fire("save",d)},destroy:function(){this.strategyConfig=null,this._super()}})})