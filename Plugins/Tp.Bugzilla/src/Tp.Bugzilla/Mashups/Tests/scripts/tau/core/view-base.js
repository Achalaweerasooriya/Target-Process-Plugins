define(["Underscore","jQuery","tau/core/class","tau/core/event","tau/core/bus","tau/core/templates-factory"],function(a,b,c,d,e,f){var g=c.extend({beforeSubscribe:function(){},merge:function(c,d){var e=this;if(d&&e.element){b.isArray(d)||(d=[d]);var f=a(d).isArray()?d:[d],g=this.element;a(f).each(function(a){var d=g.find(a),e=c.find(a);d.each(function(a){b(this).replaceWith(e.eq(a))})})}},updateElement:function(a,b){var c=this;c.element&&b?c.merge(a,b):(c.element&&(a.length?c.element.replaceWith(a):c.element.remove()),c.element=a)},doRender:function(a,b){var c=this.config.template.name,d=f.get(c).bind(this.config,a),e=" tmpl-"+c,g="ui-placeholder"+e.replace(".","-");d.addClass(g),this.updateElement(d,b),!this.config.visible&&this.hide()},init:function(a){var b=this;a=a||{},this.bus=a.bus||new e,b.config=a,b.beforeSubscribe(),d.subscribeOn(b)},fireAfterInit:function(a){this.fire("afterInit",{config:this.config,refreshSelector:a})},initialize:function(a){var b=this;this.fireAfterInit(a)},setDefaultConfig:function(){var b=this;a.defaults(b.config,{visible:!0})},"bus refresh":function(a){var b=a.data||{},c=b.refreshSelector;this.startLifeCycle(a,c)},"bus initialize":function(a){this.startLifeCycle(a)},startLifeCycle:function(b,c){var d=this;d.setDefaultConfig(),a.extend(d.config,b.data),d.fire("beforeInit",{config:d.config}),this.initialize(c)},"bus show":function(){this.show()},"bus hide":function(){this.hide()},show:function(){this.element.show(),this.config.visible=!0},hide:function(){this.element.hide(),this.config.visible=!1},on:function(){this.bus.on.apply(this.bus,arguments)},fire:function(a,b){this.bus.fire.call(this.bus,a,b,this)},"bus applyTo":function(a){this.element=a.data.element},"bus afterInit+dataBind":function(a){this.render(a.dataBind.data,a.afterInit.data)},render:function(a,b){this.fireBeforeRender({data:a}),this.doRender(a,b.refreshSelector),this.fireAfterRender({data:a})},fireBeforeRender:function(a){a=a||{},this.fire("beforeRender",{data:a.data,view:this,element:this.element})},fireAfterRender:function(a){a=a||{},this.fire("afterRender",{data:a.data,view:this,element:this.element})},preRender:function(){this.element.empty()},"bus destroy":function(){this.destroy()},destroy:function(){d.unSubscribe(this),this.element&&this.element.remove(),this.element=null,this.bus=null,this.config=null}});return g})