define(["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(a,b,c,d){var e=d.extend({category:"edit",beforeSaveComment:function(a){var c=this.placeHolder.find('input[type="checkbox"]'),d={};c.each(function(a,c){var e=b(c);e.attr("checked")&&(d[e.val()]=!0)}),this.guid=+(new Date),a.cmd["comment-practices-notification-guid"]=this.guid,a.cmd["comment-practices-notification-opts"]=d},afterSaveComment:function(b){if(b.cmd["comment-practices-notification-guid"]===this.guid){var d=b.cmd["comment-practices-notification-opts"];if(a(d).keys().length){var e=c.getNotificationService();e.notifyComment(b.obj.id,d)}}},"bus editorSave":function(){if(!this.globalSettings.IsEmailNotificationsEnabled)return;var a=this;a.config.store.on({eventName:"beforeSave",type:"comment",listener:a},function(b){var c=b.data;a.beforeSaveComment(c)}),a.config.store.on({eventName:"afterSave",type:"comment",listener:a},function(b){var c=b.data;a.afterSaveComment(c),a.config.store.unbind(a)})},"bus editorCreated":function(a){this.globalSettings=this.config.context.applicationContext.globalSettings||{};if(!this.globalSettings.IsEmailNotificationsEnabled)return;var c=a.data.editorElement;this.placeHolder=c.find(".tau-notification-practices-settings");if(!this.placeHolder.length){var d=this.placeHolder=b('<div class="tau-notification-practices-settings"><span class="prompt">Notify by email: </span></div>');d.append("<input type='checkbox' id='owner' value='Owner' /><label for='owner'>Owner</label>"),d.append("<input type='checkbox' id='people' value='Assigned' /><label for='people'>Assigned people</label>"),this.config.context.general.entityType.name.toLowerCase()==="request"?d.append("<input type='checkbox' id='requestor' value='Requesters' /><label for='requestor'>Requester(s)</label>"):d.append("<input type='checkbox' id='team' value='Team' /><label for='team'>Project Team</label>"),d.insertBefore(c.find(".ui-richeditor__controls"))}},"bus destroy":function(){this.config.store.unbind(this),this._super.apply(this,arguments)}});return e})