define(["Underscore","tau/core/class","tau/core/event","tau/core/types","tau/configurator"],function(a,b,c,d,e){return b.extend({init:function(b){this.config=b,this.bus=b.bus,this.globalBus=this.bus.getGlobalBus(),e.getWindow().document&&(this.defaultTitle=e.getWindow().document.title),c.subscribeOn(this);var d=function(a){a.data&&a.data.title&&(e.getWindow().document.title=a.data.title)};this._currentHandler=a.bind(d,this),this._updateHandler=a.bind(this["bus history.updateCurrent"],this),this.bus.getGlobalBus().on("history.updateCurrent",this._updateHandler,this)},"bus controller.preExecute":function(a){e.getHistory().process()},"bus controller.postExecute":function(a){},"globalBus history.setCurrent":function(a){a.data&&a.data.title&&(e.getWindow().document.title=a.data.title)},"globalBus history.clearCurrent":function(){this.clearCurrent()},"globalBus history.exclude":function(a){var b=a.data.id;e.getHistory().exclude(b)},"bus history.updateCurrent":function(a){e.getHistory().updateCurrent(a.data)},clearCurrent:function(){e.getHistory().current=null},"bus destroy":function(){e.getWindow().document&&(e.getWindow().document.title=this.defaultTitle),this.clearCurrent(),e.getHistory().stack=[],e.getGlobalBus().removeAllListeners(this)}})})