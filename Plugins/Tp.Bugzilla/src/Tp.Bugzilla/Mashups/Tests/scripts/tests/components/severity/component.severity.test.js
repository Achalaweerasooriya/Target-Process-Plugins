define(["tau/core/types.targetprocess","jQuery","tau/components/component.property.severity","tests/components/component.specs","tests/common/testData.Generator","tests/common/service.mock","tau/configurator","tests/components/common/common.setup"],function(a,b,c,d,e,f,g,h){var i=function(){var a=new e;a.initDefaultData();var i=a.getData(),j=a.getProjects(),k=a.getBugs()[0],l=a.getSeverities(),m={manualContext:!0,context:{entity:{entityType:{name:k.__type},id:k.id},applicationContext:{selectedProjects:[j[0]],culture:{name:"en-US",timePattern:"g:i A",shortDateFormat:"M/d/yyyy",longDateFormat:"dddd, MMMM dd, yyyy",decimalSeparator:".",__type:"culture"},processes:a.getProcesses()}}},n=k.severity,o=l[3],p=h.create("[component.severity]",i,c,m),q=[{name:"should render valid markup",test:function(){var a=this.$el;equal(a.find(".property-text").text(),n.name,"Severity name")}},{name:"should change severity",preSetup:function(){var a=this.service=new f;g.setService(a),g.getProxy().markRecordSetAsCompleteLoaded("severity")},test:function(){var a=this.$el,c=a;c.click();var d=b(".tau-bubble");equal(d.size(),1,"Count of bubbles");var e=d.eq(0).find('.drop-down-option:contains("'+o.name+'")');this.service.registerSaveCommand({config:{$set:{severity:{id:o.id}},fields:["id"],id:k.id},returnedData:{id:k.id,severity:{id:o.id,name:o.name}}}),e.click(),equal(this.$el.find(".property-text").text(),o.name,"Severity was changed")}}];d.create(p,m).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests(q).done();var r=h.create("[component.severity] empty",i,c,m),s=a.getBugs()[1],t={context:{type:s.__type,id:s.id}};d.create(r,t).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests([{name:"should render valid markup for empty Severity",test:function(){var a=this.$el;equal(a.find(".property-text").text(),"","Severity name")}}]).done()};return{run:i}})