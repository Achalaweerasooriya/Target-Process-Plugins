define(["tau/core/class","tests/components/customField/component.customField.specification.base","tau/components/component.customField.dropdown","tau/components/component.customField.dropdown.list"],function(a,b,c){var d=function(){var d=["Atos","Portos","Aramis"];b.run("dropdown.editable",c,{name:"CF DropDownList",type:"dropdown",required:!1,listed:!0,value:d,options:d},"Atos",[{name:"Should show popup",test:function(){var a=this.data,b=this.$el;ok(this.$el.hasClass("ui-customfield_editable_true"),"Editable highlighting is applied");var c=b.find(".ui-customfield__value");c.click();var e=c.parents("tr:first").tauBubble("widget");equals(e.length,1,"Has bubble");var f=e.find(".drop-down-list");equals(f.length,1,"Has bubble with choices");var g=f.find(".drop-down-option");equals(g.length,2,"Render correct options without existing"),equals(g.eq(0).text(),d[1],"Render correct options"),equals(g.eq(1).text(),d[2],"Render correct options")}},{name:"Should allow to change and save",preSetup:b.shouldSave("CF DropDownList",d[2]),test:function(){var a=this.data,b=this.$el,c=b.find(".ui-customfield__value");c.click();var d=c.parents("tr:first").tauBubble("widget"),e=d.find(".drop-down-list"),f=e.find(".drop-down-option");f.eq(1).click()}},{name:"Should show popup with clear link for non-required data",preSetup:b.shouldSave("CF DropDownList",null),test:function(){var b=this,c=this.data,d=this.$el;this.executeStub=function(c){b.repositoryMock.expects().unbind(TypeOf.isA(a)),b.repositoryMock.expects().unbind(TypeOf.isA(a));var d=c[0];d.callbacks.success({command:d})};var e=d.find(".ui-customfield__value");e.click();var f=e.parents("tr:first").tauBubble("widget");equals(f.length,1,"Has bubble");var g=f.find(".drop-down-actions");equals(g.find(".clear").length,1,"Has clear action"),g.find(".clear").click(),e=d.find(".ui-customfield__value"),e.click(),f=e.parents("tr:first").tauBubble("widget"),g=f.find(".drop-down-actions"),equals(g.find(".clear").length,0,"Has no clear action if value is empty")}}]),b.run("dropdown.editable.required",c,{name:"CF DropDownList",type:"dropdown",required:!0,listed:!0,value:d,options:d},"Atos",[{name:"Should show popup with no clear link for required data",test:function(){var a=this.data,b=this.$el,c=b.find(".ui-customfield__value");c.click();var d=c.parents("tr:first").tauBubble("widget");equals(d.length,1,"Has bubble");var e=d.find(".drop-down-actions");equals(e.find(".clear").length,0,"Has no clear action")}}])};return{run:d}})