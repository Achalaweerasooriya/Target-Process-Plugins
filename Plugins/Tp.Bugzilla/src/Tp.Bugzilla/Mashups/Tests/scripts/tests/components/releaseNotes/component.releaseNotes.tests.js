define(["Underscore","jQuery","tau/configurator","tests/common/applicationContext.simple","tau/models/dataprocessor/model.processor.context","tests/components/common/common.setup","tests/components/component.specs","tests/common/service.mock","tau/utils/utils.fixturesLoader","tau/components/component.releaseNotes"],function(a,b,c,d,e,f,g,h,i,j){var k=new i({generateId:!0,setType:!0}),l=function(b,c,d){var e=c.release[d.release],f={};a.forEach(["bug","userStory","feature"],function(b){f[b]=[],a.forEach(c[b],function(c,e){a.indexOf(d.willReturn[b],e)>-1&&f[b].push(c)})}),b.registerFindCommand({config:{fields:["id","name"],$query:{"Release.Id":e.id,"EntityState.isFinal":1},$orderBy:"id"},returnedData:f.bug}),b.registerFindCommand({config:{fields:["id","name",{release:["id"]},{userStories:["id","name",{release:["id"]},{entityState:["id","isFinal"]}],list:!0}],$query:{"Release.Id":e.id,"EntityState.isFinal":1},$orderBy:"id"},returnedData:f.feature}),b.registerFindCommand({config:{fields:["id","name",{release:["id"]},{feature:["id"]},{entityState:["id","isFinal"]}],$query:{"Release.Id":e.id,"Feature.Id":null,"EntityState.isFinal":1},$orderBy:"id"},returnedData:f.userStory})},m=function(b,d){var e=b.release[d.release];return function(){this.service=new h,this.sourceData=b,this.entity=e,c.setService(this.service),l(this.service,b,d),a.forEach(a.keys(this.sourceData),function(a){c.getProxy().markRecordSetAsCompleteLoaded(a)});var f=[];a.forEach(this.sourceData,function(b,c){f=f.concat(a.values(b))}),c.setInitialData(f)}},n=function(b){return function(){var c=this.$el;equals(c.length,1,"Rendered");var d=c.find(".tau-releaseNotes__inner");equals(d.length,1,"Rendered");var e=c.find(".tau-releaseNotes__title");ok(e.text().match(this.entity.name),"Release name"),(b.userStories.length||a.keys(b.features).length)&&equals(d.find('.tau-releaseNotes__subtitle:contains("Added features")').length,1,"Title rendered");var f=d.find(".tau-releaseNotes__feature");equals(f.length,a.keys(b.features).length,"Rendered features");var g=0;a.forEach(b.features,function(b,c){var d=f.eq(g);equals(d.length,1,"Render item"),equals(d.data("name"),c,"Output ok");var e=d.find(".tau-releaseNotes__userstory");equals(e.length,b.length,"Rendered user stories"),a.forEach(b,function(a,b){equals(e.eq(b).length,1,"Render item"),equals(e.eq(b).data("name"),a,"Output ok")}),g++});var h=d.find(".tau-releaseNotes__userstory_separate_true");equals(h.length,b.userStories.length,"Rendered user stories"),a.forEach(b.userStories,function(a,b){equals(h.eq(b).length,1,"Render item"),equals(h.eq(b).data("name"),a,"Output ok")}),b.bugs.length&&equals(d.find('.tau-releaseNotes__subtitle:contains("Fixed Bugs")').length,1,"Title rendered");var i=d.find(".tau-releaseNotes__bug");equals(i.length,b.bugs.length,"Rendered bugs"),a.forEach(b.bugs,function(a,b){equals(i.eq(b).length,1,"Render item"),equals(i.eq(b).data("name"),a,"Output ok")}),this.service.verify()}},o=function(a,b,c,d){var e=k.load(b),f=e.release[c.release];return{name:a,context:{id:f.id,type:"release"},preSetup:m(e,c),test:n(d)}},p=function(){var a={us:"User Story",feature:"Feature",bug:"Bug"},b={prototype:"Prototype"},c={proto:"Proto Iter",release:"prototype"},d={bug_closed:{name:"Closed",isFinal:!0,entityType:"bug"}},e={b1:{name:"Critical Bug",release:"prototype",iteration:"proto",entityState:"bug_closed"}},f={entityTypes:a,releases:b,entityStates:d,bugs:e,iterations:c},g={bugs:["Critical Bug"],features:[],userStories:[]};return o("test39909",f,{release:"prototype",willReturn:{bug:["b1"],feature:[],userStory:[]}},g)},q=function(){var a={us:"User Story",feature:"Feature",bug:"Bug"},b={prototype:"Prototype"},c={bug_closed:{name:"Closed",isFinal:!0,entityType:"bug"}},d={b1:{name:"Critical Bug",release:"prototype",entityState:"bug_closed"}},e={entityTypes:a,releases:b,entityStates:c,bugs:d},f={bugs:["Critical Bug"],features:[],userStories:[]};return o("test39908",e,{release:"prototype",willReturn:{bug:["b1"],feature:[],userStory:[]}},f)},r=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype",first:"Fist Release"},c={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"}},d={f1:{name:"F#1",release:"first",entityState:"feature_open",userStories:["us1_1"]}},e={us1_1:{name:"US#1.1",release:"prototype",entityState:"us_closed"}},f={entityTypes:a,releases:b,entityStates:c,features:d,us:e},g={bugs:[],features:[],userStories:["US#1.1"]};return o("test39907",f,{release:"prototype",willReturn:{bug:[],feature:["f1"],userStory:["us1_1"]}},g)},s=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype",first:"Fist Release"},c={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"}},d={f1:{name:"F#1",release:"prototype",entityState:"feature_open",userStories:["us1_1"]}},e={us1_1:{name:"US#1.1",release:"first",entityState:"us_closed"}},f={entityTypes:a,releases:b,entityStates:c,features:d,us:e},g={bugs:[],features:[],userStories:[]};return o("test39902",f,{release:"prototype",willReturn:{bug:[],feature:[],userStory:[]}},g)},t=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_open",userStories:["us1_1"]}},f={us1_1:{name:"US#1.1",release:"prototype",iteration:"proto",entityState:"us_closed"}},g={entityTypes:a,releases:b,entityStates:d,features:e,iterations:c,us:f},h={bugs:[],features:{"F#1":["US#1.1"]},userStories:[]};return o("test39901",g,{release:"prototype",willReturn:{bug:[],feature:["f1"],userStory:[]}},h)},u=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_open",userStories:["us1_1"]}},f={us1_1:{name:"US#1.1",release:"prototype",entityState:"us_closed"}},g={entityTypes:a,releases:b,entityStates:d,features:e,iterations:c,us:f},h={bugs:[],features:{"F#1":["US#1.1"]},userStories:[]};return o("test39899",g,{release:"prototype",willReturn:{bug:[],feature:["f1"],userStory:[]}},h)},v=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},feature_closed:{name:"Closed",isFinal:!0,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_open"},f2:{name:"F#2",release:"prototype",entityState:"feature_closed"}},f={us1_1:{name:"US#1.1",release:"prototype",entityState:"us_closed"}},g={entityTypes:a,releases:b,entityStates:d,features:e,iterations:c,us:f},h={bugs:[],features:[],userStories:[]};return o("test39897",g,{release:"prototype",willReturn:{bug:[],feature:["f2"],userStory:[]}},h)},w=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},feature_closed:{name:"Closed",isFinal:!0,entityType:"feature"},us_open:{name:"Open",isFinal:!1,entityType:"us"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_open"}},f={us1_1:{name:"US#1.1",release:"prototype",entityState:"us_open"}},g={entityTypes:a,releases:b,entityStates:d,features:e,iterations:c,us:f},h={bugs:[],features:[],userStories:[]};return o("test39898",g,{release:"prototype",willReturn:{bug:[],feature:[],userStory:[]}},h)},x=function(){var a={us:"User Story",feature:"Feature"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},feature_closed:{name:"Closed",isFinal:!0,entityType:"feature"},us_open:{name:"Open",isFinal:!1,entityType:"us"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_closed",userStories:["us1_1"]}},f={us1_1:{name:"US#1.1",release:"prototype",entityState:"us_open"}},g={entityTypes:a,releases:b,entityStates:d,features:e,iterations:c,us:f},h={bugs:[],features:{"F#1":[]},userStories:[]};return o("test39903",g,{release:"prototype",willReturn:{bug:[],feature:["f1"],userStory:[]}},h)},y=function(){var a={us:"User Story",feature:"Feature",bug:"Bug"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},feature_closed:{name:"Closed",isFinal:!0,entityType:"feature"},bug_open:{name:"Open",isFinal:!1,entityType:"bug"}},e={f1:{name:"F#1",release:"prototype",entityState:"feature_closed",userStories:["us1_1"]}},f={bug1:{name:"Critical Bug",release:"prototype",entityState:"bug_open"}},g={entityTypes:a,releases:b,entityStates:d,iterations:c,bug:f},h={bugs:[],features:[],userStories:[]};return o("test39910",g,{release:"prototype",willReturn:{bug:[],feature:["f1"],userStory:[]}},h)},z=function(){var a={us:"User Story",feature:"Feature",bug:"Bug"},b={prototype:"Prototype"},c={proto:"Proto Iteration"},d={feature_open:{name:"Open",isFinal:!1,entityType:"feature"},feature_closed:{name:"Closed",isFinal:!0,entityType:"feature"},us_closed:{name:"Closed",isFinal:!0,entityType:"us"},bug_open:{name:"Open",isFinal:!1,entityType:"bug"}},e={us1_1:{name:"Test Story",release:"prototype",entityState:"us_closed"}},f={f1:{name:"F#1",release:"prototype",entityState:"feature_closed"}},g={bug1:{name:"Critical Bug",release:"prototype",entityState:"bug_open"}},h={entityTypes:a,releases:b,entityStates:d,userStories:e,iterations:c,bug:g},i={bugs:[],features:[],userStories:["Test Story"]};return o("test39905",h,{release:"prototype",willReturn:{bug:[],feature:[],userStory:["us1_1"]}},i)},A=function(){var a=new d,b={context:{applicationContext:a}};e(b.context);var c=[],h=f.create("[component.releaseNotes]",c,j,b,a),i={context:null},k=g.create(h,i);k.viewShouldPassTests([p(),q(),r(),s(),t(),u(),v(),w(),x(),y(),z()]).done()};return{run:A}})