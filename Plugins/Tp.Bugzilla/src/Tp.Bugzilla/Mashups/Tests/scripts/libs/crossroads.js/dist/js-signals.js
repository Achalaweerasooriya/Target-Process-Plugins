(function(a){function c(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}var b={VERSION:"0.6"};c.prototype={active:!0,execute:function(a){var b;this.active&&(b=this._listener.apply(this.context,a),this._isOnce&&this.detach());return b},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach(),this._destroy()},_destroy:function(){delete this._signal,delete this._isOnce,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", active: "+this.active+"]"}},b.Signal=function(){this._bindings=[]},b.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(a,b,d,e){if(typeof a!="function")throw new Error("listener is a required param of add() and addOnce() and should be a Function.");var f=this._indexOfListener(a),g;if(f!==-1){g=this._bindings[f];if(g.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else g=new c(this,a,b,d,e),this._addBinding(g);return g},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a){var b=this._bindings.length;while(b--)if(this._bindings[b]._listener===a)return b;return-1},add:function(a,b,c){return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return this._registerListener(a,!0,b,c)},remove:function(a){if(typeof a!="function")throw new Error("listener is a required param of remove() and should be a Function.");var b=this._indexOfListener(a);b!==-1&&(this._bindings[b]._destroy(),this._bindings.splice(b,1));return a},removeAll:function(){var a=this._bindings.length;while(a--)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(!!this.active){var b=Array.prototype.slice.call(arguments),c=this._bindings.slice(),d=this._bindings.length;this._shouldPropagate=!0;do d--;while(c[d]&&this._shouldPropagate&&c[d].execute(b)!==!1)}},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},a.signals=b})(window||global||this)