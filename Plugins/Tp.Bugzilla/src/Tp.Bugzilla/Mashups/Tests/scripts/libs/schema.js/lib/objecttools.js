define(function(require,exports,module){typeof global=="undefined"&&typeof window=="object"&&(window.global=window),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)a.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b});var a=0,b=["$ref","$refs","$$refs"],c={},d=c.find=function(a,b){var c,d=a;for(var e=b.length,f=0;f<e;f++){if((c=b[f])===undefined)break;if((d instanceof Object||d instanceof Array)&&c in d)d=d[c];else return}return d},e={},f=c.id=function(b){if(b instanceof Object){b.hasOwnProperty("__id")||(b.__id=a++);return b.__id}return},g=c.resetRefs=function(a){if(a instanceof Object){var b=h(a);if(b){b.splice(0);return b}b=[],a instanceof Array?a.push({$$refs:b}):a.$refs=b;return b}return null},h=c.getRefs=function(a){if(a instanceof Object){if(a instanceof Array&&a[a.length-1]&&a[a.length-1].$$refs instanceof Array)return a[a.length-1].$$refs;return a.hasOwnProperty("$refs")?a.$refs:null}return null},i=c.addRef=function(a,b,c){var d=h(a);if(!d)throw new Error("You need to call resetRefs(object) first!");d.push(b),d.push(c);return d},j=c.findRefs=function(a){var c={},d=[],e=g(a),h=function(g){if(g instanceof Object){var i=f(g);if(c[i]!==undefined){e.push([].concat(d)),e.push(c[i]);return}c[i]=["#"].concat(d);if(a instanceof Array){for(var j=a.length,k=0;k<j;k++)d.push(k),h(g[k]),d.pop();return}for(var l=Object.keys(g),j=l.length,k=0,m;m=l[k],k<j;k++){if(b.indexOf(m)>-1)continue;d.push(m),h(g[m]),d.pop()}}};h(a);return a},k=c.resolveRefs=function(a,b){var c,e=a instanceof Array;if(e){var f=a[a.length-1];f instanceof Object&&f.$refs instanceof Array&&(c=f.$refs)}else a instanceof Object&&a.$refs instanceof Array&&(c=a.$refs);if(!c)return a;var g,h,i,j,k;for(var l=c.length,m=0;m<l;m+=2){g=[].concat(c[m]),i=[].concat(c[m+1]),h=g.pop(),j=i.shift();if(h===undefined||j===undefined)continue;k=d(a,g);if(!k)continue;j!=="#"&&i.unshift(j);if(j!=="#"&&!b)continue;k[h]=d(j==="#"?a:global,i),c.splice(m,2),m-=2,l-=2}return a};module.exports={},typeof module=="object"&&module.exports&&(module.exports=c)})