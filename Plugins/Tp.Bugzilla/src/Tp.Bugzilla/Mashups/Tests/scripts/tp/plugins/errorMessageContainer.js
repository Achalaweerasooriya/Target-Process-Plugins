define(["libs/jquery/jquery","libs/jquery/jquery.tmpl"],function(a){function b(a){this._create(a)}return b.prototype={messageTemplate:'{{ if Message.Length }} <span>&nbsp;<span class="error">${Message}</span></span> {{/if}}',workingSpace:null,errorList:null,generalErrorContainer:null,generalErrorMessage:null,_create:function(a){this.workingSpace=a.placeholder,this.errorList=[],this.generalErrorContainer=a.generalErrorContainer,this.generalErrorMessage=a.generalErrorMessage},reset:function(){this.errorList=[],this.workingSpace.find('[name*="ErrorLabel"]').html("")},add:function(a){this.errorList.push(a)},addRange:function(b){var c=this;a(b).each(function(a,b){c.add(b)})},_renderError:function(a,b){this.workingSpace.find('*[name="'+b.FieldName+'"]').addClass("error"),this.workingSpace.find('*[name="'+b.FieldName+'ErrorLabel"]').html(b.Message)},render:function(){this.errorList.length==0?this.workingSpace.find(".error").removeClass("error"):(a(this.errorList).each(a.proxy(this._renderError,this)),a('*[name="'+this.errorList[0].FieldName+'"]').focus(),this._renderGeneralError())},_renderGeneralError:function(){var b;this.generalErrorMessage&&(b=this.generalErrorMessage);if(this.generalErrorContainer){var c=a.grep(this.errorList,function(a){return!a.FieldName});c.length>0&&(b=a.map(c,function(a){return a.Message}).join(" "))}b&&this.workingSpace.find(this.generalErrorContainer).show().text(b)},clearErrors:function(){this._removeErrorClass("input"),this._removeErrorClass("textarea"),this._removeErrorClass("select"),this.reset(),this.generalErrorContainer&&this.workingSpace.find(this.generalErrorContainer).hide().text("")},setOnFocusEvent:function(){this._setOnFocusForControl("input"),this._setOnFocusForControl("textarea"),this._setOnFocusForControl("select")},_setOnFocusForControl:function(b){this.workingSpace.find(b).focus(function(){a(this).removeClass("error")})},_removeErrorClass:function(a){this.workingSpace.find(a).removeClass("error")}},b})