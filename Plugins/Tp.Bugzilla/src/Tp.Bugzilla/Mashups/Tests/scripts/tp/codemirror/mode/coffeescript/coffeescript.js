CodeMirror.defineMode("coffeescript",function(a){function v(a,c){var d=c.tokenize(a,c),e=a.current();if(e==="."){d=c.tokenize(a,c),e=a.current();return d==="variable"?"variable":b}if(e==="@"){d=c.tokenize(a,c),e=a.current();return d==="variable"?"variable-2":b}e==="return"&&(c.dedent+=1),((e==="->"||e==="=>")&&!c.lambda&&c.scopes[0].type=="coffee"&&a.peek()===""||d==="indent")&&t(a,c);var f="[({".indexOf(e);f!==-1&&t(a,c,"])}".slice(f,f+1)),k.exec(e)&&t(a,c),e=="then"&&u(a,c);if(d==="dedent"&&u(a,c))return b;f="])}".indexOf(e);if(f!==-1&&u(a,c))return b;c.dedent>0&&a.eol()&&c.scopes[0].type=="coffee"&&(c.scopes.length>1&&c.scopes.shift(),c.dedent-=1);return d}function u(a,b){if(b.scopes.length!=1){if(b.scopes[0].type==="coffee"){var c=a.indentation(),d=-1;for(var e=0;e<b.scopes.length;++e)if(c===b.scopes[e].offset){d=e;break}if(d===-1)return!0;while(b.scopes[0].offset!==c)b.scopes.shift();return!1}b.scopes.shift();return!1}}function t(b,c,d){d=d||"coffee";var e=0;if(d==="coffee"){for(var f=0;f<c.scopes.length;f++)if(c.scopes[f].type==="coffee"){e=c.scopes[f].offset+a.indentUnit;break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function s(c,d){var e=new RegExp(c),f=c.length==1;return function g(c,g){while(!c.eol()){c.eatWhile(/[^'"\/\\]/);if(c.eat("\\")){c.next();if(f&&c.eol())return d}else{if(c.match(e)){g.tokenize=r;return d}c.eat(/['"\/]/)}}f&&(a.mode.singleLineStringErrors?d=b:g.tokenize=r);return d}}function r(a,c){if(a.sol()){var k=c.scopes[0].offset;if(a.eatSpace()){var l=a.indentation();if(l>k)return"indent";if(l<k)return"dedent";return null}k>0&&u(a,c)}if(a.eatSpace())return null;var p=a.peek();if(p==="#"){a.skipToEnd();return"comment"}if(a.match(/^-?[0-9\.]/,!1)){var r=!1;a.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),a.match(/^-?\d+\.\d*/)&&(r=!0),a.match(/^-?\.\d+/)&&(r=!0);if(r)return"number";var t=!1;a.match(/^-?0x[0-9a-f]+/i)&&(t=!0),a.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(t=!0),a.match(/^-?0(?![\dx])/i)&&(t=!0);if(t)return"number"}if(a.match(n)){c.tokenize=s(a.current(),"string");return c.tokenize(a,c)}if(a.match(o)){if(a.current()!="/"||a.match(/^.*\//,!1)){c.tokenize=s(a.current(),"string-2");return c.tokenize(a,c)}a.backUp(1)}if(a.match(h)||a.match(g))return"punctuation";if(a.match(f)||a.match(d)||a.match(j))return"operator";if(a.match(e))return"punctuation";if(a.match(q))return"atom";if(a.match(m))return"keyword";if(a.match(i))return"variable";a.next();return b}function c(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}var b="error",d=new RegExp("^[\\+\\-\\*/%&|\\^~<>!?]"),e=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),f=new RegExp("^((->)|(=>)|(\\+\\+)|(\\+\\=)|(\\-\\-)|(\\-\\=)|(\\*\\*)|(\\*\\=)|(\\/\\/)|(\\/\\=)|(==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//))"),g=new RegExp("^((\\.\\.)|(\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),h=new RegExp("^((\\.\\.\\.)|(//=)|(>>=)|(<<=)|(\\*\\*=))"),i=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),j=c(["and","or","not","is","isnt","in","instanceof","typeof"]),k=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],l=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","throw","when","until"],m=c(k.concat(l));k=c(k);var n=new RegExp("^('{3}|\"{3}|['\"])"),o=new RegExp("^(/{3}|/)"),p=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],q=c(p),w={startState:function(a){return{tokenize:r,scopes:[{offset:a||0,type:"coffee"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=v(a,b);b.lastToken={style:c,content:a.current()},a.eol()&&a.lambda&&(b.lambda=!1);return c},indent:function(a,b){return a.tokenize!=r?0:a.scopes[0].offset}};return w}),CodeMirror.defineMIME("text/x-coffeescript","coffeescript")