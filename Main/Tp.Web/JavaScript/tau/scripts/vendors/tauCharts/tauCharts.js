!function(t,e){if("function"==typeof define&&define.amd)define(["underscore","d3"],function(t,i){return e(t,i)});else if("object"==typeof module&&module.exports){var i=require("underscore"),n=require("d3");module.exports=e(i,n)}else t.tauCharts=e(t._,t.d3)}(this,function(t,e){var i,n,r;return function(t){function e(t,e){return b.call(t,e)}function a(t,e){var i,n,r,a,o,s,u,l,c,d,h,g=e&&e.split("/"),f=x.map,p=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(g=g.slice(0,g.length-1),t=t.split("/"),o=t.length-1,x.nodeIdCompat&&L.test(t[o])&&(t[o]=t[o].replace(L,"")),t=g.concat(t),c=0;c<t.length;c+=1)if(h=t[c],"."===h)t.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((g||p)&&f){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),g)for(d=g.length;d>0;d-=1)if(r=f[g.slice(0,d).join("/")],r&&(r=r[n])){a=r,s=c;break}if(a)break;!u&&p&&p[n]&&(u=p[n],l=c)}!a&&u&&(a=u,s=l),a&&(i.splice(0,s,a),t=i.join("/"))}return t}function o(e,i){return function(){var n=w.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),g.apply(t,n.concat([e,i]))}}function s(t){return function(e){return a(e,t)}}function u(t){return function(e){m[t]=e}}function l(i){if(e(y,i)){var n=y[i];delete y[i],v[i]=!0,h.apply(t,n)}if(!e(m,i)&&!e(v,i))throw new Error("No "+i);return m[i]}function c(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function d(t){return function(){return x&&x.config&&x.config[t]||{}}}var h,g,f,p,m={},y={},x={},v={},b=Object.prototype.hasOwnProperty,w=[].slice,L=/\.js$/;f=function(t,e){var i,n=c(t),r=n[0];return t=n[1],r&&(r=a(r,e),i=l(r)),r?t=i&&i.normalize?i.normalize(t,s(e)):a(t,e):(t=a(t,e),n=c(t),r=n[0],t=n[1],r&&(i=l(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},p={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:d(t)}
}},h=function(i,n,r,a){var s,c,d,h,g,x,b=[],w=typeof r;if(a=a||i,"undefined"===w||"function"===w){for(n=!n.length&&r.length?["require","exports","module"]:n,g=0;g<n.length;g+=1)if(h=f(n[g],a),c=h.f,"require"===c)b[g]=p.require(i);else if("exports"===c)b[g]=p.exports(i),x=!0;else if("module"===c)s=b[g]=p.module(i);else if(e(m,c)||e(y,c)||e(v,c))b[g]=l(c);else{if(!h.p)throw new Error(i+" missing "+c);h.p.load(h.n,o(a,!0),u(c),{}),b[g]=m[c]}d=r?r.apply(m[i],b):void 0,i&&(s&&s.exports!==t&&s.exports!==m[i]?m[i]=s.exports:d===t&&x||(m[i]=d))}else i&&(m[i]=r)},i=n=g=function(e,i,n,r,a){if("string"==typeof e)return p[e]?p[e](i):l(f(e,i).f);if(!e.splice){if(x=e,x.deps&&g(x.deps,x.callback),!i)return;i.splice?(e=i,i=n,n=null):e=t}return i=i||function(){},"function"==typeof n&&(n=r,r=a),r?h(t,e,i,n):setTimeout(function(){h(t,e,i,n)},4),g},g.config=function(t){return g(t)},i._defined=m,r=function(t,i,n){i.splice||(n=i,i=[]),e(m,t)||e(y,t)||(y[t]=[t,i,n])},r.amd={jQuery:!0}}(),r("../node_modules/almond/almond",function(){}),r("utils/utils-dom",["exports"],function(i){var n=document.createElement("div"),r={appendTo:function(t,e){var i;return t instanceof Node?i=t:(n.insertAdjacentHTML("afterbegin",t),i=n.childNodes[0]),e.appendChild(i),i},getScrollbarWidth:function(){var t=document.createElement("div");t.style.overflow="scroll",t.style.visibility="hidden",t.style.position="absolute",t.style.width="100px",t.style.height="100px",document.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},getStyle:function(t,e){return window.getComputedStyle(t,void 0).getPropertyValue(e)},getStyleAsNum:function(t,e){return parseInt(this.getStyle(t,e)||0,10)},getContainerSize:function(t){var e=this.getStyleAsNum(t,"padding-left"),i=this.getStyleAsNum(t,"padding-right"),n=this.getStyleAsNum(t,"padding-bottom"),r=this.getStyleAsNum(t,"padding-top"),a=this.getStyleAsNum(t,"border-top-width"),o=this.getStyleAsNum(t,"border-left-width"),s=this.getStyleAsNum(t,"border-right-width"),u=this.getStyleAsNum(t,"border-bottom-width"),l=a+o+s+u,c=t.getBoundingClientRect();
return{width:c.width-e-i-2*l,height:c.height-n-r-2*l}},getAxisTickLabelSize:function(i){var n=['<svg class="graphical-report__svg">','<g class="graphical-report__cell cell">','<g class="x axis">','<g class="tick"><text><%= xTick %></text></g>',"</g>","</g>","</svg>"].join(""),r=t.template(n),a=document.createElement("div");a.style.position="absolute",a.style.visibility="hidden",a.style.width="100px",a.style.height="100px",a.style.border="1px solid green",document.body.appendChild(a),a.innerHTML=r({xTick:i});var o=e.select(a).selectAll(".x.axis .tick text")[0][0],s={width:0,height:0},u=o.getBoundingClientRect();s.width=u.right-u.left,s.height=u.bottom-u.top;var l=0!==i.length?s.width/i.length:0;return s.width=s.width+1.5*l,document.body.removeChild(a),s}};i.utilsDom=r}),r("dsl-reader",["exports"],function(e){var i=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},n=function(){function e(t,e){this.domain=t,this.UnitsRegistry=e}return i(e,null,{buildGraph:{value:function(t){var e=this,i=function(t){return e.UnitsRegistry.get(t.type).walk(e.domain.mix(t),i)};return i(t.unit)},writable:!0,enumerable:!0,configurable:!0},calcLayout:{value:function(t,e){t.options={top:0,left:0,width:e.width,height:e.height};var i=function(t){if(!t.$matrix)return t;var e,n=t.options,r=t.guide.padding,a=n.width-(r.l+r.r),o=n.height-(r.t+r.b),s=t.$matrix.sizeR(),u=t.$matrix.sizeC(),l=a/u,c=o/s;return e=t.guide.split?{calcHeight:function(t,e,i,n){return t/n},calcTop:function(t,e,i,n){return(e+1)*(t/n)*i}}:{calcHeight:function(t){return t},calcTop:function(t,e){return e*c}},t.childUnits=t.childUnits||[],t.$matrix.iterate(function(n,r,a){var o=a.length;a.forEach(function(a,s){a.options={width:l,left:r*l,height:e.calcHeight(c,n,s,o),top:e.calcTop(c,n,s,o)},t.childUnits.push(a),i(a)})}),t};return i(t)},writable:!0,enumerable:!0,configurable:!0},renderGraph:{value:function(e,i,n){var r=this,a=n||function(t){return t};e.options.container=i;var o=function(e){var i=r.domain.mix(e),n=r.UnitsRegistry.get(e.type).draw(i),s=e.childUnits||[];
s.forEach(function(i){i.options=t.extend({container:n},i.options),i.parentUnit=e,o(i)}),a(i)};return e.parentUnit=null,o(e),e.options.container},writable:!0,enumerable:!0,configurable:!0}}),e}();e.DSLReader=n}),r("const",["exports"],function(t){t.CSS_PREFIX="graphical-report__"}),r("api/balloon",["exports","../const"],function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){return t&&null!=t.setInterval}function r(t){var e=d.pageYOffset||f.scrollTop,r=d.pageXOffset||f.scrollLeft,a={left:0,right:0,top:0,bottom:0,width:0,height:0};if(n(t))a.width=d.innerWidth||f.clientWidth,a.height=d.innerHeight||f.clientHeight;else{if(!f.contains(t)||null==t.getBoundingClientRect)return a;i(a,t.getBoundingClientRect()),a.width=a.right-a.left,a.height=a.bottom-a.top}return a.top=a.top+e-f.clientTop,a.left=a.left+r-f.clientLeft,a.right=a.left+a.width,a.bottom=a.top+a.height,a}function a(t){return 0|Math.round(String(t).replace(/[^\-0-9.]/g,""))}function o(t){var e=String(m(t,o.propName)),i=e.match(/([0-9.]+)([ms]{1,2})/);return i&&(e=Number(i[1]),"s"===i[2]&&(e*=1e3)),0|e}function s(t,e){return this instanceof s?(this.hidden=1,this.options=i(y(s.defaults),e),this._createElement(),void(t&&this.content(t))):new s(t,e)}var u=e.CSS_PREFIX,l=function(t){return{add:function(e){t.classList.add(e)},remove:function(e){t.classList.remove(e)}}},c=function(t,e){return t.indexOf(e)},d=window,h=d.document,g=h.body,f=h.documentElement,p=["top","bottom"],m=d.getComputedStyle;o.propName=function(){for(var t=h.createElement("div"),e=["transitionDuration","webkitTransitionDuration"],i="1s",n=0;n<e.length;n++)if(t.style[e[n]]=i,t.style[e[n]]===i)return e[n]}();var y=Object.create;s.prototype._createElement=function(){this.element=h.createElement("div"),this.classes=l(this.element),this.classes.add(this.options.baseClass);for(var t,e=0;e<s.classTypes.length;e++)t=s.classTypes[e]+"Class",this.options[t]&&this.classes.add(this.options[t])},s.prototype.type=function(t){return this.changeClassType("type",t)
},s.prototype.effect=function(t){return this.changeClassType("effect",t)},s.prototype.changeClassType=function(t,e){return t+="Class",this.options[t]&&this.classes.remove(this.options[t]),this.options[t]=e,e&&this.classes.add(e),this},s.prototype.updateSize=function(){return this.hidden&&(this.element.style.visibility="hidden",g.appendChild(this.element)),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,null==this.spacing&&(this.spacing=null!=this.options.spacing?this.options.spacing:a(m(this.element,"top"))),this.hidden?(g.removeChild(this.element),this.element.style.visibility=""):this.position(),this},s.prototype.content=function(t){return"object"==typeof t?(this.element.innerHTML="",this.element.appendChild(t)):this.element.innerHTML=t,this.updateSize(),this},s.prototype.place=function(t){return this.options.place=t,this.hidden||this.position(),this},s.prototype.attach=function(t){return this.attachedTo=t,this.hidden||this.position(),this},s.prototype.detach=function(){return this.hide(),this.attachedTo=null,this},s.prototype._pickPlace=function(t){if(!this.options.auto)return this.options.place;var e=r(d),i=this.options.place.split("-"),n=this.spacing;if(~c(p,i[0]))switch(t.top-this.height-n<=e.top?i[0]="bottom":t.bottom+this.height+n>=e.bottom&&(i[0]="top"),i[1]){case"left":t.right-this.width<=e.left&&(i[1]="right");break;case"right":t.left+this.width>=e.right&&(i[1]="left");break;default:t.left+t.width/2+this.width/2>=e.right?i[1]="left":t.right-t.width/2-this.width/2<=e.left&&(i[1]="right")}else switch(t.left-this.width-n<=e.left?i[0]="right":t.right+this.width+n>=e.right&&(i[0]="left"),i[1]){case"top":t.bottom-this.height<=e.top&&(i[1]="bottom");break;case"bottom":t.top+this.height>=e.bottom&&(i[1]="top");break;default:t.top+t.height/2+this.height/2>=e.bottom?i[1]="top":t.bottom-t.height/2-this.height/2<=e.top&&(i[1]="bottom")}return i.join("-")},s.prototype.position=function(t,e){this.attachedTo&&(t=this.attachedTo),null==t&&this._p?(t=this._p[0],e=this._p[1]):this._p=arguments;
var i="number"==typeof t?{left:0|t,right:0|t,top:0|e,bottom:0|e,width:0,height:0}:r(t),n=this.spacing,a=this._pickPlace(i);a!==this.curPlace&&(this.curPlace&&this.classes.remove(this.curPlace),this.classes.add(a),this.curPlace=a);var o,s;switch(this.curPlace){case"top":o=i.top-this.height-n,s=i.left+i.width/2-this.width/2;break;case"top-left":o=i.top-this.height-n,s=i.right-this.width;break;case"top-right":o=i.top-this.height-n,s=i.left;break;case"bottom":o=i.bottom+n,s=i.left+i.width/2-this.width/2;break;case"bottom-left":o=i.bottom+n,s=i.right-this.width;break;case"bottom-right":o=i.bottom+n,s=i.left;break;case"left":o=i.top+i.height/2-this.height/2,s=i.left-this.width-n;break;case"left-top":o=i.bottom-this.height,s=i.left-this.width-n;break;case"left-bottom":o=i.top,s=i.left-this.width-n;break;case"right":o=i.top+i.height/2-this.height/2,s=i.right+n;break;case"right-top":o=i.bottom-this.height,s=i.right+n;break;case"right-bottom":o=i.top,s=i.right+n}return this.element.style.top=Math.round(o)+"px",this.element.style.left=Math.round(s)+"px",this},s.prototype.show=function(t,e){return t=this.attachedTo?this.attachedTo:t,clearTimeout(this.aIndex),null!=t&&this.position(t,e),this.hidden&&(this.hidden=0,g.appendChild(this.element)),this.attachedTo&&this._aware(),this.options.inClass&&(this.options.effectClass&&void this.element.clientHeight,this.classes.add(this.options.inClass)),this},s.prototype.getElement=function(){return this.element},s.prototype.hide=function(){if(!this.hidden){var t=this,e=0;return this.options.inClass&&(this.classes.remove(this.options.inClass),this.options.effectClass&&(e=o(this.element))),this.attachedTo&&this._unaware(),clearTimeout(this.aIndex),this.aIndex=setTimeout(function(){t.aIndex=0,g.removeChild(t.element),t.hidden=1},e),this}},s.prototype.toggle=function(t,e){return this[this.hidden?"show":"hide"](t,e)},s.prototype.destroy=function(){clearTimeout(this.aIndex),this._unaware(),this.hidden||g.removeChild(this.element),this.element=this.options=null
},s.prototype._aware=function(){var t=c(s.winAware,this);~t||s.winAware.push(this)},s.prototype._unaware=function(){var t=c(s.winAware,this);~t&&s.winAware.splice(t,1)},s.reposition=function(){var t,e=function(){!t&&s.winAware.length&&(t=n(i))},i=function(){t=0;for(var e,i=0,n=s.winAware.length;n>i;i++)e=s.winAware[i],e.position()},n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,17)};return e}(),s.winAware=[],window.addEventListener("resize",s.reposition),window.addEventListener("scroll",s.reposition),s.classTypes=["type","effect"],s.defaults={baseClass:u+"tooltip",typeClass:null,effectClass:null,inClass:"in",place:"top",spacing:null,auto:0},t.Tooltip=s}),r("event",["exports"],function(t){function e(t){var e=r[t];return e||(e=function(){for(var e,i,n=this,r=0;n=n.handler;){if(i=n.callbacks[t],"function"==typeof i){if(!e)for(e=[this],r=0;r<arguments.length;r++)e.push(arguments[r]);i.apply(n.context,e)}if(i=n.callbacks["*"],"function"==typeof i){if(!e)for(e=[this],r=0;r<arguments.length;r++)e.push(arguments[r]);i.call(n.context,{sender:this,type:t,args:e})}}},r[t]=e),e}var i=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},n={},r={},a=function(){function t(){this.handler=null,this.emit_destroy=e("destroy")}return i(t,null,{addHandler:{value:function(t,e){e=e||this,this.handler={callbacks:t,context:e,handler:this.handler}},writable:!0,enumerable:!0,configurable:!0},on:{value:function(t,e,i){var n={};return n[t]=e,this.addHandler(n,i),n},writable:!0,enumerable:!0,configurable:!0},fire:{value:function(t,i){e.call(this,t).call(this,i)},writable:!0,enumerable:!0,configurable:!0},removeHandler:{value:function(t,e){var i,r=this;for(e=e||this;i=r,r=r.handler;)if(r.callbacks===t&&r.context===e)return r.callbacks=n,void(i.handler=r.handler)},writable:!0,enumerable:!0,configurable:!0},destroy:{value:function(){this.emit_destroy(),this.handler=null},writable:!0,enumerable:!0,configurable:!0}}),t
}();t.Emitter=a}),r("utils/utils",["exports"],function(t){var e=function(t,i,n,r){var a=r(n(t),t);return(a[i]||[]).forEach(function(t){return e(t,i,n,r)}),a},i={clone:function(t){return JSON.parse(JSON.stringify(t))},isArray:function(t){return Array.isArray(t)},autoScale:function(t){var e=10,i=Math.min.apply(null,t),n=Math.max.apply(null,t);if(i===n){var r=n>=0?-1:1,a=n||1;n-=r*a/e}for(var o=[i,n],s=o[1]-o[0],u=Math.pow(10,Math.floor(Math.log(s/e)/Math.LN10)),l=e/s*u,c=[[.15,10],[.35,5],[.75,2],[1,1],[2,1]],d=-1;l>c[++d][0];);u*=c[d][1],o[0]=Math.floor(o[0]/u)*u,o[1]=Math.ceil(o[1]/u)*u;var h=i-o[0],g=o[1]-n,f=u/2;if(i>=0)o[0]=0;else{var p=f>=h?u:0;o[0]=o[0]-p}if(0>=n)o[1]=0;else{var m=f>=g?u:0;o[1]=o[1]+m}return[parseFloat(o[0].toFixed(15)),parseFloat(o[1].toFixed(15))]},traverseJSON:e};t.utils=i}),r("formatter-registry",["exports","d3"],function(e,i){var n=i,r={"x-num-auto":function(t){var e=parseFloat(t.toFixed(2));return Math.abs(e)<1?e.toString():n.format("s")(e)},percent:function(t){var e=parseFloat((100*t).toFixed(2));return e.toString()+"%"},day:n.time.format("%d-%b-%Y"),"day-short":n.time.format("%d-%b"),week:n.time.format("%d-%b-%Y"),"week-short":n.time.format("%d-%b"),month:function(t){var e=new Date(t),i=e.getMonth(),r=0===i?"%B, %Y":"%B";return n.time.format(r)(t)},"month-short":function(t){var e=new Date(t),i=e.getMonth(),r=0===i?"%b '%y":"%b";return n.time.format(r)(t)},"month-year":n.time.format("%B, %Y"),quarter:function(t){var e=new Date(t),i=e.getMonth(),n=(i-i%3)/3;return"Q"+(n+1)+" "+e.getFullYear()},year:n.time.format("%Y"),"x-time-auto":null},a={get:function(e,i){var a=i||"",o=function(t){return(null===t||"undefined"==typeof t?a:t).toString()},s=r.hasOwnProperty(e),u=s?r[e]:o;return s&&(u=r[e]),!s&&e&&(u=function(i){var r=t.isDate(i)?n.time.format(e):n.format(e);return r(i)}),s||e||(u=o),u},add:function(t,e){r[t]=e}};e.FormatterRegistry=a}),r("utils/utils-draw",["exports","../utils/utils","../formatter-registry","underscore","d3"],function(t,e,i,n,r){var a=(e.utils,i.FormatterRegistry),o=n,s=r,u=function(t,e){return"translate("+t+","+e+")"
},l=function(t){return"rotate("+t+")"},c=function(t){return o.contains(["bottom","top"],t.toLowerCase())?"h":"v"},d=o.memoize(function(t){return t.node().getComputedTextLength()},function(t){return t.node().textContent.length}),h=function(t,e,i){i=i||d,t.each(function(){var t=s.select(this),n=t.text().split(/\s+/),r=!1,a=n.reduce(function(n,a,o){if(r)return n;var s=o>0?[n,a].join(" "):a,u=i(t.text(s));if(e>u)n=s;else{var l=Math.floor(e/u*s.length);n=s.substr(0,l-4)+"...",r=!0}return n},"");t.text(a)})},g=function(t,e,i,n,r,a){a=a||d;var o=function(t,e,i,n,r,a,o){var s=o*i+a;return t.append("tspan").attr("x",n).attr("y",r).attr("dy",s+"em").text(e)};t.each(function(){var t=s.select(this),u=t.text().split(/\s+/),l=1.1,c=t.attr("x"),d=t.attr("y"),h=parseFloat(t.attr("dy"));t.text(null);var g=o(t,null,l,c,d,h,0),f=!1,p=u.length-1,m=u.reduce(function(t,n,r){if(f)return t;var o=t.length===i||r===p,s=t[t.length-1],u=""!==s?s+" "+n:n,l=a(g.text(u)),c=l>e;if(c&&o){var d=Math.floor(e/l*u.length);t[t.length-1]=u.substr(0,d-4)+"...",f=!0}return c&&!o&&t.push(n),c||(t[t.length-1]=u),t},[""]).filter(function(t){return t.length>0});d=r?-1*(m.length-1)*Math.floor(.5*n):d,m.forEach(function(e,i){return o(t,e,l,c,d,h,i)}),g.remove()})},f=function(t,e,i){var n=t.selectAll(".tick line"),r=i/n[0].length,a=r/2,o="h"===c(e.guide.scaleOrient);if("ordinal"===e.scaleType||"period"===e.scaleType){var s=o?"x":"y",u=o?a:-a;n.attr(s+"1",u).attr(s+"2",u)}},p=function(t,e){var i="h"===c(e.guide.scaleOrient);if(i&&"time"===e.scaleType){var n=t.selectAll(".tick")[0];if(n.length<2)return;var r=parseFloat(n[0].attributes.transform.value.replace("translate(","")),a=parseFloat(n[1].attributes.transform.value.replace("translate(","")),o=a-r,s=0,u=-1,l=t.selectAll(".tick text")[0];if(l.forEach(function(t,e){var i=t.textContent||"",n=i.length;n>s&&(s=n,u=e)}),u>=0){var d=l[u].getBoundingClientRect();o-d.width<8&&t.classed({"graphical-report__d3-time-overflown":!0})}}},m=function(t,e,i){var n=t.selectAll(".tick line"),r="h"===c(e.guide.scaleOrient);
if(!r){var a=!1,o=-1;if("time"===e.scaleType)a=!0,o=0;else if("ordinal"===e.scaleType||"period"===e.scaleType){a=!0;var s=i/n[0].length,l=s/2;o=-l}if(a){var d=t.select(".tick").node().cloneNode(!0);t.append(function(){return d}).attr("transform",u(0,i-o))}}},y=function(t,e){var i=c(e.guide.scaleOrient),n="h"===i?1:-1,r=t.append("text").attr("transform",l(e.guide.label.rotate)).attr("class",e.guide.label.cssClass).attr("x",n*e.guide.size*.5).attr("y",n*e.guide.label.padding).style("text-anchor",e.guide.label.textAnchor),a=" > ",o=e.guide.label.text.split(a),s=o.length;if(o.forEach(function(t,e){r.append("tspan").attr("class","label-token label-token-"+e).text(t),s-1>e&&r.append("tspan").attr("class","label-token-delimiter label-token-delimiter-"+e).text(a)}),"right"===e.guide.label.dock){var u=t.selectAll("path.domain").node().getBBox();r.attr("x","h"===i?u.width:0)}else if("left"===e.guide.label.dock){var u=t.selectAll("path.domain").node().getBBox();r.attr("x","h"===i?0:-u.height)}},x=function(t,e){var i="h"===c(e.guide.scaleOrient),n=e.guide.rotate,r=t.selectAll(".tick text");if(r.attr("transform",l(n)).style("text-anchor",e.guide.textAnchor),90===n){var a=parseFloat(r.attr("dy"))/2;r.attr("x",9).attr("y",0).attr("dy",""+a+"em")}e.guide.tickFormatWordWrap?r.call(g,e.guide.tickFormatWordWrapLimit,e.guide.tickFormatWordWrapLines,e.guide.$maxTickTextH,!i):r.call(h,e.guide.tickFormatWordWrapLimit)},v=function(t,e,i){var n=this;if(t.scaleDim){var r=s.svg.axis().scale(t.scaleObj).orient(t.guide.scaleOrient),o=a.get(t.guide.tickFormat,t.guide.tickFormatNullAlias);null!==o&&(r.ticks(Math.round(i/t.guide.density)),r.tickFormat(o));var l=n.append("g").attr("class",t.guide.cssClass).attr("transform",u.apply(null,e)).call(r);f(l,t,i),x(l,t),y(l,t),p(l,t)}},b=function(t,e,i){var n=this,r=n.append("g").attr("class","grid").attr("transform",u(0,0)),o=(t.guide.showGridLines||"").toLowerCase();if(o.length>0){var l=r.append("g").attr("class","grid-lines");if(o.indexOf("x")>-1&&t.x.scaleDim){var c=t.x,d=s.svg.axis().scale(c.scaleObj).orient(c.guide.scaleOrient).tickSize(e),h=a.get(c.guide.tickFormat);
null!==h&&(d.ticks(Math.round(i/c.guide.density)),d.tickFormat(h));var g=l.append("g").attr("class","grid-lines-x").call(d);f(g,c,i);var p=g.select("g.tick");if(p.node()&&"translate(0,0)"!==p.attr("transform")){var y=p.node().cloneNode(!0);l.node().appendChild(y),s.select(y).attr("class","border").attr("transform",u(0,0)).select("line").attr("x1",0).attr("x2",0)}}if(o.indexOf("y")>-1&&t.y.scaleDim){var x=t.y,v=s.svg.axis().scale(x.scaleObj).orient(x.guide.scaleOrient).tickSize(-i),h=a.get(x.guide.tickFormat);null!==h&&(v.ticks(Math.round(e/x.guide.density)),v.tickFormat(h));var b=l.append("g").attr("class","grid-lines-y").call(v);f(b,x,e),m(b,x,e)}l.selectAll("text").remove()}return r},w=function(t,e,i){return t[e]=o.defaults(t[e]||{},{label:""}),t[e].label=o.isObject(t[e].label)?t[e].label:{text:t[e].label},t[e].label=o.defaults(t[e].label,i||{},{padding:32,rotate:0,textAnchor:"middle",cssClass:"label",dock:null}),t[e]},L=function(t,e,i){return t[e]=o.defaults(t[e],i||{},{padding:0,density:30,rotate:0,tickPeriod:null,tickFormat:null,autoScale:!0}),t[e].tickFormat=t[e].tickFormat||t[e].tickPeriod,t[e]},k=function(t){return t.options=t.options||{},t.guide=t.guide||{},t.guide.padding=o.defaults(t.guide.padding||{},{l:0,b:0,r:0,t:0}),t.guide.x=w(t.guide,"x"),t.guide.x=L(t.guide,"x",{cssClass:"x axis",scaleOrient:"bottom",textAnchor:"middle"}),t.guide.y=w(t.guide,"y",{rotate:-90}),t.guide.y=L(t.guide,"y",{cssClass:"y axis",scaleOrient:"left",textAnchor:"end"}),t.guide.size=w(t.guide,"size"),t.guide.color=w(t.guide,"color"),t},T={translate:u,rotate:l,getOrientation:c,fnDrawDimAxis:v,fnDrawGrid:b,applyNodeDefaults:k,cutText:h,wrapText:g};t.utilsDraw=T}),r("spec-engine-factory",["exports","./utils/utils","./utils/utils-draw","./formatter-registry","./utils/utils-dom"],function(e,i,n,r,a){function o(e,i,n,r){var a=e.hasOwnProperty(n)?e[n]:{};t.each(r,function(e){t.extend(i.guide[n][e],a[e])}),t.extend(i.guide[n],t.omit.apply(t,[a].concat[r]))}var s=i.utils,u=n.utilsDraw,l=r.FormatterRegistry,c=(a.utilsDom,function(e,i){var n=i.guide||{},r={x:["label"],y:["label"],size:["label"],color:["label"],padding:[]};
return t.each(r,function(t,i){o(n,e,i,t)}),t.extend(e.guide,t.omit.apply(t,[n].concat(t.keys(r)))),e}),d=function(e,i){return e.guide=e.guide||{},e.guide.padding=e.guide.padding||{l:0,t:0,r:0,b:0},e.hasOwnProperty("unit")||(e=t.defaults(e,i),e.guide=t.defaults(e.guide,s.clone(i.guide)),e.guide.x=t.defaults(e.guide.x,s.clone(i.guide.x)),e.guide.y=t.defaults(e.guide.y,s.clone(i.guide.y))),e},h=function(t){var e=t.unit||[],i=!t.hasOwnProperty("unit"),n=!e.some(function(t){return t.hasOwnProperty("unit")});return{type:t.type,isLeaf:i,isLeafParent:!i&&n}},g=function(e,i,n,r){if(0===e.length)return{width:0,height:0};if(null===i){var a=n("TauChart Library");return a.width=.625*r,a}var o=t.max(e,function(t){return i(t).toString().length}),s=t.isNumber(o)?".00":"";return n(i(o)+s)},f=function(t,e,i){var n=t.dimType,r=t.scaleType,a="*",o=[n,r,a].join(":"),s=[n,r].join(":");return i[o]||i[s]||i[n]||null},p=function(t,e,i,n,r,a){var o=e.dimension(t.x),s=e.dimension(t.y),u="measure"===o.dimType,c="measure"===s.dimType,d=i.hasOwnProperty("xDensityPadding:"+o.dimType)?i["xDensityPadding:"+o.dimType]:i.xDensityPadding,h=i.hasOwnProperty("yDensityPadding:"+s.dimType)?i["yDensityPadding:"+s.dimType]:i.yDensityPadding,p=e.scaleMeta(t.x,t.guide.x),m=p.values,y=e.scaleMeta(t.y,t.guide.y),x=y.values;t.guide.x.tickFormat=t.guide.x.tickFormat||f(o,p,i.defaultFormats),t.guide.y.tickFormat=t.guide.y.tickFormat||f(s,y,i.defaultFormats),["day","week","month"].indexOf(t.guide.x.tickFormat)>=0&&(t.guide.x.tickFormat+="-short"),["day","week","month"].indexOf(t.guide.y.tickFormat)>=0&&(t.guide.y.tickFormat+="-short");var v=0===m.length,b=0===x.length,w=g(m,l.get(t.guide.x.tickFormat,t.guide.x.tickFormatNullAlias),i.getAxisTickLabelSize,i.xAxisTickLabelLimit),L=g(x,l.get(t.guide.y.tickFormat,t.guide.y.tickFormatNullAlias),i.getAxisTickLabelSize,i.yAxisTickLabelLimit),k=i.xAxisPadding,T=i.yAxisPadding,A=n?!u:!1,D=r?!c:!1;t.guide.x.padding=v?0:k,t.guide.y.padding=b?0:T,t.guide.x.rotate=A?90:0,t.guide.x.textAnchor=A?"start":t.guide.x.textAnchor,t.guide.y.rotate=D?-90:0,t.guide.y.textAnchor=D?"middle":t.guide.y.textAnchor;
var E=v?0:i.xTickWidth,S=b?0:i.yTickWidth;t.guide.x.tickFormatWordWrapLimit=i.xAxisTickLabelLimit,t.guide.y.tickFormatWordWrapLimit=i.yAxisTickLabelLimit;var C=A?{w:w.height,h:w.width}:{h:w.height,w:w.width};if(w.width>i.xAxisTickLabelLimit){t.guide.x.tickFormatWordWrap=!0,t.guide.x.tickFormatWordWrapLines=i.xTickWordWrapLinesLimit;var O=Math.ceil(w.width/i.xAxisTickLabelLimit),P=Math.min(O,i.xTickWordWrapLinesLimit),F=P*w.height;A?(C.h=i.xAxisTickLabelLimit,C.w=F):(C.h=F,C.w=i.xAxisTickLabelLimit)}var M=D?{w:L.height,h:L.width}:{h:L.height,w:L.width};if(L.width>i.yAxisTickLabelLimit){t.guide.y.tickFormatWordWrap=!0,t.guide.y.tickFormatWordWrapLines=i.yTickWordWrapLinesLimit;var O=Math.ceil(L.width/i.yAxisTickLabelLimit),P=Math.min(O,i.yTickWordWrapLinesLimit),F=P*L.height;D?(M.w=F,M.h=i.yAxisTickLabelLimit):(M.w=i.yAxisTickLabelLimit,M.h=F)}var N=E+C.h,W=S+M.w,_=i.xFontLabelHeight,R=i.yFontLabelHeight,z=i.distToXAxisLabel,j=i.distToYAxisLabel;if(t.guide.x.density=C.w+2*d,t.guide.y.density=M.h+2*h,a){var I=(k-_)/2;t.guide.x.label.padding=0+_-z+I,t.guide.y.label.padding=0-j+I,t.guide.x.label.cssClass+=" inline",t.guide.x.label.dock="right",t.guide.x.label.textAnchor="end",t.guide.y.label.cssClass+=" inline",t.guide.y.label.dock="right",t.guide.y.label.textAnchor="end",t.guide.padding.b=k+N,t.guide.padding.l=T+W,t.guide.padding.b=t.guide.x.hide?0:t.guide.padding.b,t.guide.padding.l=t.guide.y.hide?0:t.guide.padding.l}else{t.guide.x.label.padding=+_+(t.guide.x.label.text?N+z:0),t.guide.y.label.padding=-_+(t.guide.y.label.text?W+j:0);var H=t.guide.x.label.text?t.guide.x.label.padding+_:N,U=t.guide.y.label.text?t.guide.y.label.padding+R:W;t.guide.padding.b=k+H-E,t.guide.padding.l=T+U,t.guide.padding.b=t.guide.x.hide?0:t.guide.padding.b,t.guide.padding.l=t.guide.y.hide?0:t.guide.padding.l}return t.guide.x.tickFontHeight=w.height,t.guide.y.tickFontHeight=L.height,t.guide.x.$minimalDomain=m.length,t.guide.y.$minimalDomain=x.length,t.guide.x.$maxTickTextW=w.width,t.guide.x.$maxTickTextH=w.height,t.guide.y.$maxTickTextW=L.width,t.guide.y.$maxTickTextH=L.height,t
},m={NONE:function(t,e,i){var n=s.clone(t);return y(s.clone(n.unit),n.unit,function(t,e){return e.guide.x.tickFontHeight=i.getAxisTickLabelSize("X").height,e.guide.y.tickFontHeight=i.getAxisTickLabelSize("Y").height,e.guide.x.tickFormatWordWrapLimit=i.xAxisTickLabelLimit,e.guide.y.tickFormatWordWrapLimit=i.yAxisTickLabelLimit,e}),n},"BUILD-LABELS":function(e){var i=s.clone(e),n=[],r=[],a=null,o=null;return s.traverseJSON(i.unit,"unit",h,function(e,i){if(e.isLeaf)return i;!a&&i.x&&(a=i),!o&&i.y&&(o=i),i.guide=i.guide||{},i.guide.x=i.guide.x||{label:""},i.guide.y=i.guide.y||{label:""},i.guide.x.label=t.isObject(i.guide.x.label)?i.guide.x.label:{text:i.guide.x.label},i.guide.y.label=t.isObject(i.guide.y.label)?i.guide.y.label:{text:i.guide.y.label},i.x&&(i.guide.x.label.text=i.guide.x.label.text||i.x),i.y&&(i.guide.y.label.text=i.guide.y.label.text||i.y);var s=i.guide.x.label.text;s&&(n.push(s),i.guide.x.tickFormatNullAlias=i.guide.x.hasOwnProperty("tickFormatNullAlias")?i.guide.x.tickFormatNullAlias:"No "+s,i.guide.x.label.text="");var u=i.guide.y.label.text;return u&&(r.push(u),i.guide.y.tickFormatNullAlias=i.guide.y.hasOwnProperty("tickFormatNullAlias")?i.guide.y.tickFormatNullAlias:"No "+u,i.guide.y.label.text=""),i}),a&&(a.guide.x.label.text=n.join(" > ")),o&&(o.guide.y.label.text=r.join(" > ")),i},"BUILD-GUIDE":function(t,e,i){var n=s.clone(t);return y(s.clone(n.unit),n.unit,function(t,n){if(t.isLeaf)return n;t.isLeafParent&&!n.guide.hasOwnProperty("showGridLines")&&(n.guide.showGridLines="xy");var r=!t.isLeaf&&!t.isLeafParent;r&&(n.guide.x.cssClass+=" facet-axis",n.guide.y.cssClass+=" facet-axis");var a=e.dimension(n.x),o=e.dimension(n.y),s="measure"===a.dimType,u="measure"===o.dimType,c=i.hasOwnProperty("xDensityPadding:"+a.dimType)?i["xDensityPadding:"+a.dimType]:i.xDensityPadding,d=i.hasOwnProperty("yDensityPadding:"+o.dimType)?i["yDensityPadding:"+o.dimType]:i.yDensityPadding,h=e.scaleMeta(n.x,n.guide.x),p=h.values,m=e.scaleMeta(n.y,n.guide.y),y=m.values;n.guide.x.tickFormat=n.guide.x.tickFormat||f(a,h,i.defaultFormats),n.guide.y.tickFormat=n.guide.y.tickFormat||f(o,m,i.defaultFormats);
var x=0===p.length,v=0===y.length,b=g(p,l.get(n.guide.x.tickFormat,n.guide.x.tickFormatNullAlias),i.getAxisTickLabelSize,i.xAxisTickLabelLimit),w=g(y,l.get(n.guide.y.tickFormat,n.guide.y.tickFormatNullAlias),i.getAxisTickLabelSize,i.yAxisTickLabelLimit),L=t.isLeafParent?i.xAxisPadding:0,k=t.isLeafParent?i.yAxisPadding:0,T=!r&&!!a.dimType&&"measure"!==a.dimType;n.guide.x.padding=x?0:L,n.guide.y.padding=v?0:k,n.guide.x.rotate=T?90:0,n.guide.x.textAnchor=T?"start":n.guide.x.textAnchor;var A=x?0:i.xTickWidth,D=v?0:i.yTickWidth;n.guide.x.tickFormatWordWrapLimit=i.xAxisTickLabelLimit,n.guide.y.tickFormatWordWrapLimit=i.yAxisTickLabelLimit;var E=T?b.width:b.height;!s&&E>i.xAxisTickLabelLimit&&(E=i.xAxisTickLabelLimit),!T&&b.width>i.xAxisTickLabelLimit&&(n.guide.x.tickFormatWordWrap=!0,n.guide.x.tickFormatWordWrapLines=i.xTickWordWrapLinesLimit,E=i.xTickWordWrapLinesLimit*b.height);var S=w.width;!u&&S>i.yAxisTickLabelLimit&&(S=i.yAxisTickLabelLimit,n.guide.y.tickFormatWordWrap=!0,n.guide.y.tickFormatWordWrapLines=i.yTickWordWrapLinesLimit);var C=A+E,O=D+S,P=i.xFontLabelHeight,F=i.yFontLabelHeight,M=i.distToXAxisLabel,N=i.distToYAxisLabel,W=Math.min(i.xAxisTickLabelLimit,T?b.height:b.width);n.guide.x.density=W+2*c;var _=Math.ceil(w.width/i.yAxisTickLabelLimit),R=Math.min(_,i.yTickWordWrapLinesLimit),z=Math.min(i.yAxisTickLabelLimit,R*w.height);n.guide.y.density=z+2*d,n.guide.x.label.padding=n.guide.x.label.text?C+M:0,n.guide.y.label.padding=n.guide.y.label.text?O+N:0;var j=n.guide.x.label.text?n.guide.x.label.padding+P:C,I=n.guide.y.label.text?n.guide.y.label.padding+F:O;return n.guide.padding.b=L+j,n.guide.padding.l=k+I,n.guide.padding.b=n.guide.x.hide?0:n.guide.padding.b,n.guide.padding.l=n.guide.y.hide?0:n.guide.padding.l,n.guide.x.tickFontHeight=b.height,n.guide.y.tickFontHeight=w.height,n.guide.x.$minimalDomain=p.length,n.guide.y.$minimalDomain=y.length,n.guide.x.$maxTickTextW=b.width,n.guide.x.$maxTickTextH=b.height,n.guide.y.$maxTickTextW=w.width,n.guide.y.$maxTickTextH=w.height,n
}),n},"BUILD-COMPACT":function(e,i,n){var r=s.clone(e);return y(s.clone(r.unit),r.unit,function(e,r){return e.isLeaf?r:e.isLeafParent?(r.guide.showGridLines=r.guide.hasOwnProperty("showGridLines")?r.guide.showGridLines:"xy",p(r,i,t.defaults({xTickWordWrapLinesLimit:1,yTickWordWrapLinesLimit:1},n),!0,!1,!0)):(r.guide.x.cssClass+=" facet-axis compact",r.guide.y.cssClass+=" facet-axis compact",p(r,i,t.defaults({xAxisPadding:0,yAxisPadding:0,distToXAxisLabel:0,distToYAxisLabel:0,xTickWordWrapLinesLimit:1,yTickWordWrapLinesLimit:1},n),!1,!0,!1))}),r},"OPTIMAL-SIZE":function(t,e,i){var n=s.clone(t),r=function(t){var e;if(t.unit){var i=r(t.unit[0]),n=t.guide,a=n.x.$minimalDomain||1,o=n.y.$minimalDomain||1,s=Math.max(a*n.x.density,a*i.w),u=Math.max(o*n.y.density,o*i.h);e={w:s+n.padding.l+n.padding.r,h:u+n.padding.t+n.padding.b}}else e={w:0,h:0};return e},a=function(t,e,i,n){var r=e.guide.x.$minimalDomain||1,o=e.guide.y.$minimalDomain||1,s=i.width/r,u=i.height/o,l=t.dimension(e.x),c=t.dimension(e.y),d=n.hasOwnProperty("xDensityPadding:"+l.dimType)?n["xDensityPadding:"+l.dimType]:n.xDensityPadding,h=n.hasOwnProperty("yDensityPadding:"+c.dimType)?n["yDensityPadding:"+c.dimType]:n.yDensityPadding;if(e.guide.x.hide!==!0&&0!==e.guide.x.rotate&&s>e.guide.x.$maxTickTextW+2*d){e.guide.x.rotate=0,e.guide.x.textAnchor="middle",e.guide.x.tickFormatWordWrapLimit=s;var g=Math.min(n.xAxisTickLabelLimit,e.guide.x.$maxTickTextW),f=0-g+e.guide.x.$maxTickTextH;e.guide.padding.b+=e.guide.padding.b>0?f:0,e.guide.x.label.padding>g+n.xAxisPadding&&(e.guide.x.label.padding+=f)}e.guide.y.hide!==!0&&0!==e.guide.y.rotate&&1===e.guide.y.tickFormatWordWrapLines&&u>e.guide.y.$maxTickTextW+2*h&&(e.guide.y.tickFormatWordWrapLimit=u-2*h);var p={width:s,height:u};e.unit&&a(t,e.unit[0],p,n)},o=r(n.unit),u=o.w,l=o.h,c=i.size,d=i.getScrollBarWidth(),h=c.width-u,g=c.height-l,f=h>=0?c.width:u,p=g>=0?0:d,m=g>=0?c.height:l,y=h>=0?0:d;return i.size.height=m-y,i.size.width=f-p,a(e,n.unit,i.size,i),n}};m.AUTO=function(t,e,i){return["BUILD-LABELS","BUILD-GUIDE"].reduce(function(t,n){return m[n](t,e,i)
},t)},m.COMPACT=function(t,e,i){return["BUILD-LABELS","BUILD-COMPACT"].reduce(function(t,n){return m[n](t,e,i)},t)};var y=function(e,i,n){var r=u.applyNodeDefaults(i);r=n(h(r),r),r=c(r,e);var a=t.omit(r,"unit");return(r.unit||[]).forEach(function(t){return y(s.clone(t),d(t,a),n)}),r},x={get:function(t,e){var i=m[t]||m.NONE;return function(t,n){var r=i(t,n,e);return e.fitSize&&(r=m["OPTIMAL-SIZE"](r,n,e)),r}}};e.SpecEngineFactory=x}),r("matrix",["exports"],function(e){var i=function(){var e=function(e,i){var n,r=t.toArray(arguments);n=t.isArray(r[0])?r[0]:t.times(e,function(){return t.times(i,function(){return null})}),this.cube=n};return e.prototype={iterate:function(e){var i=this.cube;return t.each(i,function(i,n){t.each(i,function(t,i){e(n,i,t)})}),this},getRC:function(t,e){return this.cube[t][e]},setRC:function(t,e,i){return this.cube[t][e]=i,this},sizeR:function(){return this.cube.length},sizeC:function(){var t=this.cube[0]||[];return t.length}},e}();e.TMatrix=i}),r("layout-engine-factory",["exports","./utils/utils","./utils/utils-draw","./matrix"],function(t,e,i,n){var r=e.utils,a=i.utilsDraw,o=n.TMatrix,s=function(t,e){var i=e?e:{depth:-1,paddings:[]},n=t.guide.padding;return i.depth+=1,i.paddings.unshift({l:n.l,b:n.b,r:n.r,t:n.t}),t.unit&&t.unit.length&&s(t.unit[0],i),i},u={NONE:function(t){return t},EXTRACT:function(t){var e=function(t,i,n){var r=t,a=r.sizeR(),s=r.sizeC();r.iterate(function(t,r,u){u.forEach(function(e){return n(e,{firstRow:0===t,firstCol:0===r,lastRow:t===a-1,lastCol:r===s-1,depth:i})}),u.filter(function(t){return t.$matrix}).forEach(function(t){t.$matrix=new o(t.$matrix.cube),e(t.$matrix,i-1,n)})})},i=r.clone(t),n=new o([[[i]]]),u=s(i),l=u.paddings.reduce(function(t,e){return t.l+=e.l,t.b+=e.b,t.r+=e.r,t.t+=e.t,t},{l:0,b:0,r:0,t:0}),c=r.clone(l),d=u.paddings.reverse().map(function(t){return t.l=c.l-t.l,t.b=c.b-t.b,c={l:t.l,b:t.b},t});u.paddings=d.reverse();var h=10,g=a.applyNodeDefaults({type:"COORDS.RECT",options:r.clone(t.options),$matrix:new o([[[i]]]),guide:{padding:{l:l.l-h,b:l.b-h,r:l.r+h,t:l.t+h}}});
return e(n,u.depth,function(t,e){var i=e.depth;t.guide.x.hide=t.guide.x.hide?t.guide.x.hide:!e.lastRow,t.guide.y.hide=t.guide.y.hide?t.guide.y.hide:!e.firstCol;var n=i>1?0:h,r=i>1?h:0;return t.guide.x.padding+=u.paddings[i].b,t.guide.y.padding+=u.paddings[i].l,t.guide.x.padding-=r,t.guide.y.padding-=r,t.guide.padding.l=n,t.guide.padding.b=n,t.guide.padding.r=n,t.guide.padding.t=n,t}),g}},l={get:function(t){return u[t]||u.NONE}};t.LayoutEngineFactory=l}),r("plugins",["exports"],function(t){var i=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},n=function(){function t(t,e){this.chart=e,this._plugins=t.map(this.initPlugin,this)}return i(t,null,{initPlugin:{value:function(t){var e=this;t.init&&t.init(this.chart),this.chart.on("destroy",t.destroy&&t.destroy.bind(t)||function(){}),Object.keys(t).forEach(function(i){if(0===i.indexOf("on")){var n=i.substr(2);e.chart.on(n.toLowerCase(),t[i].bind(t))}})},writable:!0,enumerable:!0,configurable:!0}}),t}(),r=["click","mouseover","mouseout","mousemove"],a=function(t){return function(){r.forEach(function(i){this.on(i,function(n){t.fire("element"+i,{elementData:n,element:this,cellData:e.select(this.parentNode.parentNode).datum()})})},this)}};t.propagateDatumEvents=a,t.Plugins=n}),r("unit-domain-period-generator",["exports"],function(t){var e={day:{cast:function(t){return new Date(t.setHours(0,0,0,0))},next:function(t){return new Date(t.setDate(t.getDate()+1))}},week:{cast:function(t){return t=new Date(t.setHours(0,0,0,0)),t=new Date(t.setDate(t.getDate()-t.getDay()))},next:function(t){return new Date(t.setDate(t.getDate()+7))}},month:{cast:function(t){return t=new Date(t.setHours(0,0,0,0)),t=new Date(t.setDate(1))},next:function(t){return new Date(t.setMonth(t.getMonth()+1))}},quarter:{cast:function(t){t=new Date(t.setHours(0,0,0,0)),t=new Date(t.setDate(1));var e=t.getMonth(),i=e-e%3;return new Date(t.setMonth(i))},next:function(t){return new Date(t.setMonth(t.getMonth()+3))}},year:{cast:function(t){return t=new Date(t.setHours(0,0,0,0)),t=new Date(t.setDate(1)),t=new Date(t.setMonth(0))
},next:function(t){return new Date(t.setFullYear(t.getFullYear()+1))}}},i={add:function(t,i){return e[t.toLowerCase()]=i,this},get:function(t){return e[t.toLowerCase()]},generate:function(t,i,n){var r=[],a=e[n.toLowerCase()];if(a){var o=a.cast(new Date(i)),s=a.cast(new Date(t));for(r.push(s);(s=a.next(new Date(s)))<=o;)r.push(s)}return r}};t.UnitDomainPeriodGenerator=i}),r("size",["exports"],function(e){var i=function(t){return Math.sqrt(t)},n=function(e,n,r,a){var o=t.filter(e,t.isFinite);if(0===o.length)return function(){return a};var s=1,u=0,l=Math.min.apply(null,o),c=Math.max.apply(null,o),d=i(Math.max.apply(null,[Math.abs(l),Math.abs(c),c-l]));return u=0>l?l:0,s=0===d?1:(r-n)/d,function(e){var a=null!==e?parseFloat(e):0;if(!t.isFinite(a))return r;var o=a-u;return n+i(o)*s}};e.sizeScale=n}),r("unit-domain-mixin",["exports","./unit-domain-period-generator","./utils/utils","./size","underscore","d3"],function(t,e,i,n,r,a){var o=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},s=e.UnitDomainPeriodGenerator,u=i.utils,l=n.sizeScale,c=r,d=a,h={ordinal:function(t){return t},linear:function(t,e){var i=e.autoScale?u.autoScale(t):d.extent(t),n=c.isNumber(e.min)?e.min:i[0],r=c.isNumber(e.max)?e.max:i[1];return[Math.min(n,i[0]),Math.max(r,i[1])]},period:function(t,e){var i=d.extent(t),n=c.isNull(e.min)||c.isUndefined(e.min)?i[0]:new Date(e.min).getTime(),r=c.isNull(e.max)||c.isUndefined(e.max)?i[1]:new Date(e.max).getTime(),a=[new Date(Math.min(n,i[0])),new Date(Math.max(r,i[1]))];return s.generate(a[0],a[1],e.period)},time:function(t,e){var i=d.extent(t),n=c.isNull(e.min)||c.isUndefined(e.min)?i[0]:new Date(e.min).getTime(),r=c.isNull(e.max)||c.isUndefined(e.max)?i[1]:new Date(e.max).getTime();return[new Date(Math.min(n,i[0])),new Date(Math.max(r,i[1]))]}},g={ordinal:function(t,e){return d.scale.ordinal().domain(t).rangePoints(e,1)},linear:function(t,e){return d.scale.linear().domain(t).rangeRound(e,1)},period:function(t,e){return d.scale.ordinal().domain(t).rangePoints(e,1)
},time:function(t,e){return d.time.scale().domain(t).range(e)}},f=function(){function t(t,e){var i=function(t){return function(e){var i=e||{};return i.hasOwnProperty(t)?i[t]:null}},n=function(e){var n=t[e]||{},r=n.value?i(n.value):function(t){return t},a=c.contains(["period","time"],n.scale);return a?c.compose(function(t){return new Date(t).getTime()},r):r},r=function(e){var i=t[e]||{};return i.order||null},a=function(t){var e={category:function(t,e,i){return i},order:function(t,e,i){var n=r(t);return n?c.union(n,i):c.sortBy(i,e)},measure:function(t,e,i){return c.sortBy(i,e)},"as-is":function(t,e,i){return i}};return e[t]||e["as-is"]},o=function(t){var e={category:a("category"),order:a("order"),measure:a("measure"),"as-is":a("as-is")};return e[t]||e["as-is"]};this.fnDimension=function(e,i){var n=(i||{}).dimensions||{},r=t[e]||{},a=n[e]||{};return{scaleDim:e,scaleType:a.scale||r.scale,dimType:a.type||r.type}},this.fnSource=function(t){var i=c.map(t,function(t,e){return function(i){return n(e)(i[e])===t}});return c(e).filter(function(t){return c.every(i,function(e){return e(t)})})};var u=function(i,r){if(!t[i])return[];var a=n(i),o=c(e).chain().pluck(i).uniq(a).value();return r(i,a,o)};this.fnDomain=function(e){var i=n(e),r=(t[e]||{}).type,o=u(e,a(r));return o.map(i)};var f=function(e,r){var a={},l=r||{};a.map=l.hasOwnProperty("map")?l.map:l.tickLabel,a.min=l.hasOwnProperty("min")?l.min:l.tickMin,a.max=l.hasOwnProperty("max")?l.max:l.tickMax,a.period=l.hasOwnProperty("period")?l.period:l.tickPeriod,a.autoScale=l.autoScale;var d=c.defaults({},t[e]),g={"order:period":function(t){return function(e){return s.get(t.period).cast(new Date(e))}},"*":function(){return function(t){return t}}},f=a.map?i(a.map):n(e),p=[d.type,d.scale].join(":"),m=(g[p]||g["*"])(a),y=u(e,o(d.type)).map(f),x=d.scale?h[d.scale](y,a):y;return{extract:function(t){return m(f(t))},values:x,source:y}};this.fnScaleMeta=f,this.fnScaleTo=function(e,i,n){var r=n||{},a=c.defaults({},t[e]),o=f(e,n),s=g[a.scale](o.values,i,r),u=function(t){return s(o.extract(t))
};return Object.keys(s).forEach(function(t){return u[t]=s[t]}),u},this.fnScaleColor=function(t,e,i){var n,r=i||{},a=f(t,r),o=c.constant("color-default"),s=c.times(20,function(t){return"color20-"+(1+t)}),u=function(t,e){if(0===t.length||1===t.length&&null===t[0])return o;var i=t.map(function(t){return String(t).toString()});return d.scale.ordinal().range(e).domain(i)},l=function(t,e){var i=c.keys(t),n=c.values(t),r=d.scale.ordinal().range(n).domain(i);return function(i){return t.hasOwnProperty(i)?r(i):e(i)}},h=function(t){return function(e){return t(String(e).toString())}};if(e)if(c.isArray(e))n=h(u(a.values,e));else if(c.isFunction(e))n=function(t){return e(t,h(u(a.values,s)))};else{if(!c.isObject(e))throw new Error("This brewer is not supported");n=l(e,o)}else n=h(u(a.values,s));var g=function(t){return n(a.extract(t))};return g.get=g,g.dimension=t,g.legend=function(t){var e=a.extract(t),i=r.tickLabel?(t||{})[r.tickLabel]:e,o=n(e);return{value:e,color:o,label:i}},g},this.fnScaleSize=function(t,e,i){var n=i||{},r=e[0],a=e[1],o=e[e.length-1],s=f(t,n),u=l(s.source,r,a,o),c=function(t){return u(s.extract(t))};return c}}return o(t,null,{mix:{value:function(t){return t.dimension=this.fnDimension,t.source=this.fnSource,t.domain=this.fnDomain,t.scaleMeta=this.fnScaleMeta,t.scaleTo=this.fnScaleTo,t.scaleDist=this.fnScaleTo,t.scaleColor=this.fnScaleColor,t.scaleSize=this.fnScaleSize,t.partition=function(){return t.data||t.source(t.$where)},t.groupBy=function(e,i){var n=t.scaleMeta(i);return c.chain(e).groupBy(function(t){return n.extract(t[i])}).map(function(t){return{key:t[0][i],values:t}}).value()},t},writable:!0,enumerable:!0,configurable:!0}}),t}();t.UnitDomainMixin=f}),r("units-registry",["exports"],function(t){var e={},i={add:function(t,i){var n={};return n.draw="function"==typeof i?i:i.draw,n.walk=i.walk||function(t){return t},e[t]=n,this},get:function(t){if(!e.hasOwnProperty(t))throw new Error("Unknown unit type: "+t);return e[t]}};t.UnitsRegistry=i}),r("data-processor",["exports","./utils/utils"],function(e,i){var n=i.utils,r=function(t){return t===Object(t)
},a={isYFunctionOfX:function(t,e,i){var n=!0,a=null;try{t.reduce(function(t,n){var o=function(t,e){var i=n[e],a=r(i)?JSON.stringify(i):i;return t.push(a),t},s=e.reduce(o,[]).join("/"),u=i.reduce(o,[]).join("/");if(t.hasOwnProperty(s)){var l=t[s];if(l!==u)throw a={type:"RelationIsNotAFunction",keyX:e.join("/"),keyY:i.join("/"),valX:s,errY:[l,u]},new Error("RelationIsNotAFunction")}else t[s]=u;return t},{})}catch(o){if("RelationIsNotAFunction"!==o.message)throw o;n=!1}return{result:n,error:a}},excludeNullValues:function(t,e){var i=Object.keys(t).reduce(function(e,i){var n=t[i];return n.hasOwnProperty("hasNull")&&!n.hasNull||"measure"!==n.type&&"period"!==n.scale||e.push(i),e},[]);return function(t){var n=!i.some(function(e){return!(e in t)||null===t[e]});return n||e(t),n}},autoAssignScales:function(t){var e="category",i={category:"ordinal",order:"ordinal",measure:"linear"},n={};return Object.keys(t).forEach(function(r){var a=t[r],o=(a.type||e).toLowerCase();n[r]={},n[r].type=o,n[r].scale=a.scale||i[o],n[r].value=a.value}),n},autoDetectDimTypes:function(e){var i={type:"category",scale:"ordinal"},r=function(e,i){var n=i;return t.isDate(e)?(n.type="measure",n.scale="time"):t.isObject(e)?(n.type="order",n.scale="ordinal"):t.isNumber(e)&&(n.type="measure",n.scale="linear"),n},a=function(t,e){return Object.keys(e).forEach(function(a){var o=e.hasOwnProperty(a)?e[a]:null;if(t[a]=t[a]||{type:null,hasNull:!1},null===o)t[a].hasNull=!0;else{var s=r(o,n.clone(i)),u=s.type,l=s.scale,c=null!==t[a].type&&t[a].type!==u;t[a].type=c?i.type:u,t[a].scale=c?i.scale:l}}),t};return t.reduce(e,a,{})}};e.DataProcessor=a}),r("utils/layuot-template",["exports","../const"],function(t,e){var i=e.CSS_PREFIX,n=function(t,e){var n="div",r=document.createElement(n);return r.classList.add(i+t),e&&e.appendChild(r),r},r=function(){var t=n("layout"),e=n("layout__header",t),i=n("layout__container",t),r=n("layout__sidebar",i),a=n("layout__content",i),o=n("layout__content__wrap",a),s=n("layout__sidebar-right",i),u=n("layout__sidebar-right__wrap",s),l=n("layout__footer",t);
return{layout:t,header:e,content:o,leftSidebar:r,rightSidebar:u,footer:l}};t.getLayout=r}),r("charts/tau.plot",["exports","../dsl-reader","../api/balloon","../event","../spec-engine-factory","../layout-engine-factory","../plugins","../utils/utils","../utils/utils-dom","../const","../unit-domain-mixin","../units-registry","../data-processor","../utils/layuot-template"],function(i,n,r,a,o,s,u,l,c,d,h,g,f,p){var m=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},y=function N(t,e,i){var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:N(r,e,i)}if("value"in n&&n.writable)return n.value;var a=n.get;return void 0===a?void 0:a.call(i)},x=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},v=n.DSLReader,b=r.Tooltip,w=a.Emitter,L=o.SpecEngineFactory,k=s.LayoutEngineFactory,T=u.Plugins,A=u.propagateDatumEvents,D=l.utils,E=c.utilsDom,S=d.CSS_PREFIX,C=h.UnitDomainMixin,O=g.UnitsRegistry,P=f.DataProcessor,F=p.getLayout,M=function(i){function n(t){y(Object.getPrototypeOf(n.prototype),"constructor",this).call(this),this._svg=null,this._filtersStore={filters:{},tick:0},this._layout=F(),this.setupConfig(t),this._plugins=new T(this.config.plugins,this)}return x(n,i),m(n,null,{setupConfig:{value:function(e){if(!e.spec&&!e.spec.unit)throw new Error("Provide spec for plot");this.config=t.defaults(e,{spec:{},data:[],plugins:[],settings:{}}),this._emptyContainer=e.emptyContainer||"",this.config.settings.specEngine=this.config.specEngine||this.config.settings.specEngine,this.config.settings.layoutEngine=this.config.layoutEngine||this.config.settings.layoutEngine,this.config.settings=this.setupSettings(this.config.settings),D.isArray(this.config.settings.specEngine)||(this.config.settings.specEngine=[{width:Number.MAX_VALUE,name:this.config.settings.specEngine}]),this.config.spec.dimensions=this.setupMetaInfo(this.config.spec.dimensions,this.config.data);
var i=this.config.settings.log;this.config.settings.excludeNull&&this.addFilter({tag:"default",predicate:P.excludeNullValues(this.config.spec.dimensions,function(t){i([t,"point was excluded, because it has undefined values."],"WARN")})})},writable:!0,enumerable:!0,configurable:!0},getConfig:{value:function(){return this.config},writable:!0,enumerable:!0,configurable:!0},setupMetaInfo:{value:function(t,e){var i=t?t:P.autoDetectDimTypes(e);return P.autoAssignScales(i)},writable:!0,enumerable:!0,configurable:!0},setupSettings:{value:function(e){var i=n.globalSettings,r={};return Object.keys(i).forEach(function(e){r[e]=t.isFunction(i[e])?i[e]:D.clone(i[e])}),t.defaults(e||{},r)},writable:!0,enumerable:!0,configurable:!0},insertToRightSidebar:{value:function(t){return E.appendTo(t,this._layout.rightSidebar)},writable:!0,enumerable:!0,configurable:!0},insertToHeader:{value:function(t){return E.appendTo(t,this._layout.header)},writable:!0,enumerable:!0,configurable:!0},addBalloon:{value:function(t){return new b("",t||{})},writable:!0,enumerable:!0,configurable:!0},renderTo:{value:function(i,n){this._renderGraph=null,this._svg=null,this._defaultSize=t.clone(n);var r=e.select(i),a=r.node();if(this._target=i,null===a)throw new Error("Target element not found");a.appendChild(this._layout.layout),r=e.select(this._layout.content);var o=t.clone(n)||{};this._layout.content.innerHTML="",o.width&&o.height||(o=t.defaults(o,E.getContainerSize(this._layout.content.parentNode)));var s=this.getData();if(0===s.length)return void(this._layout.content.innerHTML=this._emptyContainer);this._layout.content.innerHTML="";var u=new C(this.config.spec.dimensions,s),l=t.find(this.config.settings.specEngine,function(t){return o.width<=t.width});this.config.settings.size=o;var c=L.get(l.name,this.config.settings),d=c(this.config.spec,u.mix({})),h=this.config.settings.size,g=new v(u,O),f=this,p=g.buildGraph(d),m=k.get(this.config.settings.layoutEngine)(p),y=g.calcLayout(m,h),x=g.renderGraph(y,r.append("svg").attr("class",S+"svg").attr("width",h.width).attr("height",h.height),function(t){return f.fire("unitready",t)
});this._renderGraph=y,this._svg=x.node(),x.selectAll(".i-role-datum").call(A(this)),this._layout.rightSidebar.style.maxHeight=h.height+"px",this.fire("render",this._svg)},writable:!0,enumerable:!0,configurable:!0},getData:{value:function(e){e=e||{};var i=t.chain(this._filtersStore.filters).values().flatten().reject(function(i){return t.contains(e.excludeFilter,i.tag)}).pluck("predicate").value();return t.filter(this.config.data,t.reduce(i,function(t,e){return function(i){return t(i)&&e(i)}},function(){return!0}))},writable:!0,enumerable:!0,configurable:!0},setData:{value:function(t){this.config.data=t,this.refresh()},writable:!0,enumerable:!0,configurable:!0},getSVG:{value:function(){return this._svg},writable:!0,enumerable:!0,configurable:!0},addFilter:{value:function(t){var e=t.tag,i=this._filtersStore.filters[e]=this._filtersStore.filters[e]||[],n=this._filtersStore.tick++;return t.id=n,i.push(t),this.refresh(),n},writable:!0,enumerable:!0,configurable:!0},removeFilter:{value:function(e){var i=this;t.each(this._filtersStore.filters,function(n,r){i._filtersStore.filters[r]=t.reject(n,function(t){return t.id===e})}),this.refresh()},writable:!0,enumerable:!0,configurable:!0},refresh:{value:function(){this._target&&this.renderTo(this._target,this._defaultSize)},writable:!0,enumerable:!0,configurable:!0},resize:{value:function(){var t=void 0===arguments[0]?{}:arguments[0];this.renderTo(this._target,t)},writable:!0,enumerable:!0,configurable:!0},select:{value:function(t){var e=[];if(!this._renderGraph)return e;var i=function(t,e){e(t),(t.childUnits||[]).forEach(function(t){return i(t,e)})};return i(this._renderGraph,function(i){t(i)&&e.push(i)}),e},writable:!0,enumerable:!0,configurable:!0}}),n}(w);i.Plot=M}),r("charts/tau.chart",["exports","./tau.plot","../utils/utils","../data-processor"],function(e,i,n,r){function a(t,e,i){return e.reduce(function(e,n,r){var a=t[n];return a?e.status!=y.FAIL&&("measure"===a.type&&(e.countMeasureAxis++,e.indexMeasureAxis.push(r)),"measure"!==a.type&&1===e.countMeasureAxis?e.status=y.WARNING:e.countMeasureAxis>1&&(e.status=y.FAIL,e.messages.push('There is more than one measure dimension for "'+i+'" axis'))):(e.status=y.FAIL,e.messages.push(n?'"'+n+'" dimension is undefined for "'+i+'" axis':'"'+i+'" axis should be specified')),e
},{status:y.SUCCESS,countMeasureAxis:0,indexMeasureAxis:[],messages:[],axis:i})}function o(e,i){for(var n=p(i.x),r=p(i.y),o=Math.max(n.length,r.length),s=p(i.guide);s.length<o;)s.push({});s=s.slice(0,o);var u=a(i.dimensions,n,"x"),l=a(i.dimensions,r,"y");n=x[u.status](n,u,s),r=x[l.status](r,l,s);for(var c={type:"COORDS.RECT",unit:[]},d=o;d>0;d--){var h=n.pop(),g=r.pop(),y=s.pop()||{};d===o?(c.x=h,c.y=g,c.unit.push(m(e,{x:f(h),y:f(g),color:i.color,size:i.size,flip:i.flip,colorGuide:y.color,sizeGuide:y.size})),c.guide=t.defaults(y,{x:{label:h},y:{label:g}})):c={type:"COORDS.RECT",x:f(h),y:f(g),unit:[c],guide:t.defaults(y,{x:{label:h},y:{label:g}})}}return i.spec={dimensions:i.dimensions,unit:c},i}var s=function(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0})},u=function(t,e,i){e&&Object.defineProperties(t,e),i&&Object.defineProperties(t.prototype,i)},l=function w(t,e,i){var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:w(r,e,i)}if("value"in n&&n.writable)return n.value;var a=n.get;return void 0===a?void 0:a.call(i)},c=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},d=i.Plot,h=n.utils,g=r.DataProcessor,f=function(t){return t?t:null},p=function(t){return h.isArray(t)?0===t.length?[null]:t:[t]},m=function(t,e){return{type:t,x:e.x,y:e.y,color:e.color,guide:{color:e.colorGuide,size:e.sizeGuide},flip:e.flip,size:e.size}},y={SUCCESS:"SUCCESS",WARNING:"WARNING",FAIL:"FAIL"},x=function(){var e={};return s(e,y.SUCCESS,function(t){return t}),s(e,y.FAIL,function(t,e){throw new Error((e.messages||[]).join("\n")||"This configuration is not supported, See http://api.taucharts.com/basic/facet.html#easy-approach-for-creating-facet-chart")}),s(e,y.WARNING,function(e,i,n){var r=i.axis,a=i.indexMeasureAxis[0],o=e[a],s=t.without(e,o);
s.push(o);var u=n[a][r]||{},l=n[n.length-1][r]||{};return n[n.length-1][r]=u,n[a][r]=l,s}),e}(),v={scatterplot:function(t){return o("ELEMENT.POINT",t)},line:function(e){var i=e.data,n=e.settings.log,r={none:function(){return null},horizontal:function(t){var e=h.isArray(t.x)?t.x:[t.x];return e[e.length-1]},vertical:function(t){var e=h.isArray(t.y)?t.y:[t.y];return e[e.length-1]},auto:function(t){var e,r=h.isArray(t.x)?t.x:[t.x],a=h.isArray(t.y)?t.y:[t.y],o=r[r.length-1],s=r.slice(0,r.length-1),u=a[a.length-1],l=a.slice(0,a.length-1),c=t.color,d=s.concat(l).concat([c]).filter(function(t){return null!==t}),f=-1,p=[[[o].concat(d),u],[[u].concat(d),o]],m=p.some(function(t,e){var r=t[0],a=t[1],o=g.isYFunctionOfX(i,r,[a]);return o.result?f=e:n(["Attempt to find a functional relation between",t[0]+" and "+t[1]+" is failed.","There are several "+o.error.keyY+" values (e.g. "+o.error.errY.join(",")+")","for ("+o.error.keyX+" = "+o.error.valX+")."].join(" ")),o.result});return m?e=p[f][0][0]:(n(["All attempts are failed.","Will orient line horizontally by default.","NOTE: the [scatterplot] chart is more convenient for that data."].join(" ")),e=o),e}},a=(e.lineOrientation||"auto").toLowerCase(),s=r.hasOwnProperty(a)?r[a]:r.auto,u=s(e);return null!==u&&(e.data=t(i).sortBy(u)),o("ELEMENT.LINE",e)},bar:function(t){return t.flip=!1,o("ELEMENT.INTERVAL",t)},horizontalBar:function(t){return t.flip=!0,o("ELEMENT.INTERVAL",t)}},b=function(e){function i(e){e=t.defaults(e,{autoResize:!0}),e.autoResize&&i.winAware.push(this),e.settings=this.setupSettings(e.settings),e.dimensions=this.setupMetaInfo(e.dimensions,e.data);var n=v[e.type];if(!t.isFunction(n))throw new Error("Chart type "+e.type+" is not supported. Use one of "+t.keys(v).join(", ")+".");l(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,n(e))}return c(i,e),u(i,null,{destroy:{value:function(){var t=i.winAware.indexOf(this);-1!==t&&i.winAware.splice(t,1),l(Object.getPrototypeOf(i.prototype),"destroy",this).call(this)
},writable:!0,enumerable:!0,configurable:!0}}),i}(d);b.resizeOnWindowEvent=function(){var t,e=function(){!t&&b.winAware.length&&(t=n(i))},i=function(){t=0;for(var e,i=0,n=b.winAware.length;n>i;i++)e=b.winAware[i],e.resize()},n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,17)};return e}(),b.winAware=[],window.addEventListener("resize",b.resizeOnWindowEvent),e.Chart=b}),r("elements/coords",["exports","../utils/utils-draw","../const","../utils/utils","../matrix"],function(e,i,n,r,a){var o=i.utilsDraw,s=n.CSS_PREFIX,u=r.utils,l=a.TMatrix,c={CROSS:function(e,i,n,r,a){var o=0===n.length?[null]:n,s=0===a.length?[null]:a.reverse(),u=function(t){return t instanceof Date?t.getTime():t};return t(s).map(function(e){return t(o).map(function(t){var n={};return i&&(n[i]=u(t)),r&&(n[r]=u(e)),n})})}},d=function(t){return c[t]||function(){return[[{}]]}},h=function(e,i,n){var r=t.defaults(u.clone(e),t.pick.apply(t,[i].concat(n)));return r.guide=t.extend(u.clone(i.guide),r.guide),r},g={walk:function(e,i){var n=t.defaults(e,{$where:{}}),r=t.any(n.unit,function(t){return 0===t.type.indexOf("COORDS.")}),a=d(r?"CROSS":""),o=n.scaleMeta(n.x,t.omit(n.guide.x,"tickLabel")).values,s=n.scaleMeta(n.y,t.omit(n.guide.y,"tickLabel")).values,u=new l(a(n,n.x,o,n.y,s)),c=new l(u.sizeR(),u.sizeC());return u.iterate(function(e,i,r){var a=t.extend({},n.$where,r),o=t(n.unit).map(function(e){return t.extend(h(e,n,["x","y"]),{$where:a})});c.setRC(e,i,o)}),n.$matrix=c,c.iterate(function(e,n,r){t.each(r,function(t){return i(t)})}),n},draw:function(t){var e=t.options,i=t.guide.padding;t.x.guide=t.guide.x,t.y.guide=t.guide.y;var n=e.left+i.l,r=e.top+i.t,a=e.width-(i.l+i.r),u=e.height-(i.t+i.b);t.x.scaleObj=t.x.scaleDim&&t.scaleTo(t.x.scaleDim,[0,a],t.x.guide),t.y.scaleObj=t.y.scaleDim&&t.scaleTo(t.y.scaleDim,[u,0],t.y.guide),t.x.guide.size=a,t.y.guide.size=u;var l=[0,u+t.guide.x.padding],c=[0-t.guide.y.padding,0],d=e.container.append("g").attr("class",s+"cell cell").attr("transform",o.translate(n,r)).datum({$where:t.$where});
return t.x.guide.hide||o.fnDrawDimAxis.call(d,t.x,l,a),t.y.guide.hide||o.fnDrawDimAxis.call(d,t.y,c,u),o.fnDrawGrid.call(d,t,u,a)}};e.coords=g}),r("utils/css-class-map",["exports","../const"],function(t,e){function i(t){return o[t-1]||o[4]}function n(t){var e=0;return t>=160&&320>t?e=1:t>=320&&480>t?e=2:t>=480&&640>t?e=3:t>=640&&(e=4),s[e]}var r=e.CSS_PREFIX,a=[1,2,3,4,5],o=a.map(function(t){return r+"line-opacity-"+t}),s=a.map(function(t){return r+"line-width-"+t});t.getLineClassesByWidth=n,t.getLineClassesByCount=i}),r("elements/line",["exports","../const","../utils/css-class-map"],function(t,i,n){var r=i.CSS_PREFIX,a=n.getLineClassesByWidth,o=n.getLineClassesByCount,s=function(t){var i=t.options,n=i.xScale,s=i.yScale,u=i.color,l=t.groupBy(t.partition(),t.color.scaleDim),c=a(i.width),d=o(l.length),h=function(){this.attr("class",function(t){return""+r+"line i-role-element i-role-datum line "+u(t.key)+" "+c+" "+d});var t=this.selectAll("path").data(function(t){return[t.values]});t.call(p),t.enter().append("path").call(p),t.exit().remove()},g=function(e){var a=function(){return this.attr("r",1.5).attr("class",function(e){return""+r+"dot-line dot-line i-role-element "+r+"dot i-role-datum "+u(e[t.color.scaleDim])}).attr("cx",function(e){return n(e[t.x.scaleDim])}).attr("cy",function(e){return s(e[t.y.scaleDim])})},o=i.container.selectAll(".dot-line").data(e);o.call(a),o.exit().remove(),o.enter().append("circle").call(a)},f=e.svg.line().x(function(e){return n(e[t.x.scaleDim])}).y(function(e){return s(e[t.y.scaleDim])}),p=function(){this.attr("d",f)},m=l.reduce(function(t,e){var i=e.values;return 1===i.length&&t.push(i[0]),t},[]);m.length>0&&g(m);var y=i.container.selectAll(".line").data(l);y.call(h),y.enter().append("g").call(h),y.exit().remove()};t.line=s}),r("elements/point",["exports","../const"],function(t,e){var i=e.CSS_PREFIX,n=function(t){var e=t.options,n=e.xScale,r=e.yScale,a=e.color,o=e.sizeScale,s=function(){return this.attr("r",function(e){return o(e[t.size.scaleDim])
}).attr("cx",function(e){return n(e[t.x.scaleDim])}).attr("cy",function(e){return r(e[t.y.scaleDim])}).attr("class",function(e){return""+i+"dot dot i-role-element i-role-datum "+a(e[t.color.scaleDim])})},u=e.container.selectAll(".dot").data(t.partition());u.call(s),u.exit().remove(),u.enter().append("circle").call(s)};t.point=n}),r("elements/interval",["exports","../utils/utils-draw","../const"],function(e,i,n){var r=function(t){return Array.isArray(t)?t:Array.from(t)},a=i.utilsDraw,o=n.CSS_PREFIX,s="i-role-bar-group",u=function(t){return"measure"===t.dimType},l=function(t){var e=t.domain().length,i=t.categoryLength,n=t.size/e,r=n/(i+1);return{tickWidth:n,intervalWidth:r,offsetCategory:r}},c={NORM:function(t,e,i,n,o,s,c){var d=1,h=Math.min.apply(Math,r(i.domain())),g=!isNaN(h),f=!g||0>=h?0:h,p=u(t.x),m=p?c:l({domain:e.domain,categoryLength:n.count(),size:o}),y=m.tickWidth,x=m.intervalWidth,v=m.offsetCategory,b=function(i){return e(i[t.x.scaleDim])-y/2},w=g?function(e){var n=e[t.y.scaleDim],r=i(Math.max(f,n)),a=Math.abs(i(n)-i(f)),o=d>a;return o&&n>0?r-d:r}:function(e){return i(e[t.y.scaleDim])},L=function(){return x},k=g?function(e){var n=e[t.y.scaleDim],r=Math.abs(i(n)-i(f));return 0===n?r:Math.max(d,r)}:function(e){return s-i(e[t.y.scaleDim])},T=function(t){return a.translate(n(t)*v+v/2,0)};return{calculateX:b,calculateY:w,calculateWidth:L,calculateHeight:k,calculateTranslate:T}},FLIP:function(t,e,i,n,o,s,c){var d=1,h=Math.min.apply(Math,r(e.domain())),g=!isNaN(h),f=!g||0>=h?0:h,p=u(t.y),m=p?c:l({domain:i.domain,categoryLength:n.count(),size:s}),y=m.tickWidth,x=m.intervalWidth,v=m.offsetCategory,b=g?function(i){var n=i[t.x.scaleDim],r=Math.abs(e(n)-e(f)),a=e(Math.min(f,n)),o=r-d,s=n>0?d+o:0>n?0-d:0,u=0>o;return u?a+s:a}:0,w=function(e){return i(e[t.y.scaleDim])-y/2},L=g?function(i){var n=i[t.x.scaleDim],r=Math.abs(e(n)-e(f));return 0===n?r:Math.max(d,r)}:function(i){return e(i[t.x.scaleDim])},k=function(){return x},T=function(t){return a.translate(0,n(t)*v+v/2)};return{calculateX:b,calculateY:w,calculateWidth:L,calculateHeight:k,calculateTranslate:T}
}},d=function(e){var i=e.options,n=i.xScale,r=i.yScale,a=i.color,u=c[e.flip?"FLIP":"NORM"],l=e.groupBy(e.source(),e.color.scaleDim),d=e.groupBy(e.partition(),e.color.scaleDim),h=function(e){var i=0,n=JSON.stringify(e.key);return t.find(l,function(t,e){var r=JSON.stringify(t.key)===n;return r&&(i=e),r}),i};h.count=function(){return l.length};var g=u(e,n,r,h,i.width,i.height,{tickWidth:5,intervalWidth:5,offsetCategory:0}),f=g.calculateX,p=g.calculateY,m=g.calculateWidth,y=g.calculateHeight,x=g.calculateTranslate,v=function(){return this.attr("height",y).attr("width",m).attr("class",function(t){return"i-role-element i-role-datum bar "+o+"bar "+a(t[e.color.scaleDim])}).attr("x",f).attr("y",p)},b=function(){this.attr("class",s).attr("transform",x);var t=this.selectAll("bar").data(function(t){return t.values});t.call(v),t.enter().append("rect").call(v),t.exit().remove()},w=i.container.selectAll("."+s).data(d);w.call(b),w.enter().append("g").call(b),w.exit().remove()};e.interval=d}),r("elements/coords-parallel",["exports","../utils/utils-draw","../const","../utils/utils","../matrix"],function(i,n,r,a,o){var s=n.utilsDraw,u=(r.CSS_PREFIX,a.utils),l=o.TMatrix,c=function(e,i,n){var r=t.defaults(u.clone(e),t.pick.apply(t,[i].concat(n)));return r.guide=t.extend(u.clone(i.guide||{}),r.guide||{}),r},d={walk:function(e,i){var n=t.defaults(e,{$where:{}}),r=new l(1,1),a=new l(1,1);return r.iterate(function(e,i){var r=t.extend({},n.$where),o=t(n.unit).map(function(e){return t.extend(c(e,n,["x"]),{$where:r})});a.setRC(e,i,o)}),n.$matrix=a,a.iterate(function(e,n,r){t.each(r,function(t){return i(t)})}),n},draw:function(t){var i=t.options,n=t.guide.padding,r=i.left+n.l,a=i.top+n.t,o=i.width-(n.l+n.r),u=i.height-(n.t+n.b),l=t.x.map(function(e){return t.scaleTo(e,[u,0],{})}),c=i.container.append("g").attr("class","graphical-report__cell cell").attr("transform",s.translate(r,a)),d=function(t,e){return"translate("+t+","+e+")"},h=function(t){return"rotate("+t+")"},g=function(t,i){var n=this,r=e.svg.axis().scale(t).orient("left"),a=n.append("g").attr("class","y axis").attr("transform",d.apply(null,i)).call(r);
a.selectAll(".tick text").attr("transform",h(0)).style("text-anchor","end")},f=o/(t.x.length-1);return l.forEach(function(t,e){g.call(c,t,[e*f,0])}),c.append("g").attr("class","grid").attr("transform",d(0,0))}};i.CoordsParallel=d}),r("elements/coords-parallel-line",["exports","../utils/utils-draw","../const"],function(t,i,n){var r=(i.utilsDraw,n.CSS_PREFIX,{draw:function(t){t.color=t.dimension(t.color,t);var i=t.guide.color||{},n=t.scaleColor(t.color.scaleDim,i.brewer,i),r=t.options,a=t.x.reduce(function(e,i){return e[i]=t.scaleTo(i,[r.height,0],{}),e},{}),o=e.nest().key(function(t){return t[n.dimension]}).entries(t.partition()).map(function(e){var i=e.values[0],n=[];return t.x.forEach(function(t){n.push({key:t,val:i[t]})}),n}),s=function(){this.attr("class",function(){return"graphical-report__line line color20-9"});var t=this.selectAll("path").data(function(t){return[t]});t.call(d),t.enter().append("path").call(d),t.exit().remove()},u=r.width/(t.x.length-1),l={};t.x.forEach(function(t,e){l[t]=e*u});var c=e.svg.line().x(function(t){return l[t.key]}).y(function(t){return a[t.key](t.val)}),d=function(){this.attr("d",c)},h=r.container.selectAll(".line").data(o);h.call(s),h.enter().append("g").call(s),h.exit().remove()}});t.CoordsParallelLine=r}),r("node-map",["exports","./elements/coords","./elements/line","./elements/point","./elements/interval","./utils/utils-draw","./elements/coords-parallel","./elements/coords-parallel-line"],function(e,i,n,r,a,o,s,u){var l=i.coords,c=n.line,d=r.point,h=a.interval,g=(o.utilsDraw,s.CoordsParallel),f=u.CoordsParallelLine,p=function(t,e,i,n,r){var a=Math.min(t,e),o=a*i;return Math.max(r,Math.min(n,o))},m=function(e,i){i.forEach(function(t){e[t]=e.dimension(e[t],e)});var n=e.options,r=n.width,a=n.height;e.x.guide=e.guide.x,e.y.guide=e.guide.y,e.options.xScale=e.x.scaleDim&&e.scaleTo(e.x.scaleDim,[0,r],e.x.guide),e.options.yScale=e.y.scaleDim&&e.scaleTo(e.y.scaleDim,[a,0],e.y.guide);var o=e.guide.color||{};if(e.options.color=e.scaleColor(e.color.scaleDim,o.brewer,o),e.size){var s=1,u=.035,l=.5*t.min([e.guide.x.tickFontHeight,e.guide.y.tickFontHeight].filter(function(t){return 0!==t
})),c=.5*t.min([e.guide.x.density,e.guide.y.density].filter(function(t){return 0!==t})),d=e.guide.size||{};e.options.sizeScale=e.scaleSize(e.size.scaleDim,[p(r,a,u,2,s),p(r,a,u,c,s),p(r,a,u,l,s)],d)}return e},y={"COORDS.RECT":{walk:l.walk,draw:function(t,e){return t.x=t.dimension(t.x,t),t.y=t.dimension(t.y,t),l.draw(t,e)}},"ELEMENT.POINT":function(t){return d(m(t,["x","y","color","size"]))},"ELEMENT.LINE":function(t){return c(m(t,["x","y","color"]))},"ELEMENT.INTERVAL":function(t){return h(m(t,["x","y","color"]))},"COORDS.PARALLEL":g,"PARALLEL/ELEMENT.LINE":f};e.nodeMap=y}),r("tau.newCharts",["exports","./utils/utils-dom","./charts/tau.plot","./charts/tau.chart","./unit-domain-mixin","./unit-domain-period-generator","./dsl-reader","./spec-engine-factory","./layout-engine-factory","./formatter-registry","./node-map","./units-registry"],function(i,n,r,a,o,s,u,l,c,d,h,g){var f=n.utilsDom,p=r.Plot,m=a.Chart,y=o.UnitDomainMixin,x=s.UnitDomainPeriodGenerator,v=u.DSLReader,b=l.SpecEngineFactory,w=c.LayoutEngineFactory,L=d.FormatterRegistry,k=h.nodeMap,T=g.UnitsRegistry,A={},D={},E={UnitDomainMixin:y,UnitDomainPeriodGenerator:x,DSLReader:v,SpecEngineFactory:b,LayoutEngineFactory:w},S={UnitsRegistry:T,tickFormat:L,d3:e,_:t,tickPeriod:x,colorBrewers:{add:function(t,e){t in A||(A[t]=e)},get:function(t){return A[t]}},plugins:{add:function(t,e){if(t in D)throw new Error("Plugin is already registered.");D[t]=e},get:function(t){return D[t]}},globalSettings:{log:function(t,e){e=e||"INFO",Array.isArray(t)||(t=[t]),console[e.toLowerCase()].apply(console,t)},excludeNull:!0,specEngine:[{name:"COMPACT",width:600},{name:"AUTO",width:Number.MAX_VALUE}],fitSize:!0,layoutEngine:"EXTRACT",getAxisTickLabelSize:t.memoize(f.getAxisTickLabelSize,function(t){return(t||"").length}),getScrollBarWidth:t.memoize(f.getScrollbarWidth),xAxisTickLabelLimit:100,yAxisTickLabelLimit:100,xTickWordWrapLinesLimit:2,yTickWordWrapLinesLimit:2,xTickWidth:9,yTickWidth:9,distToXAxisLabel:20,distToYAxisLabel:20,xAxisPadding:20,yAxisPadding:20,xFontLabelHeight:10,yFontLabelHeight:10,xDensityPadding:4,yDensityPadding:4,"xDensityPadding:measure":8,"yDensityPadding:measure":8,defaultFormats:{measure:"x-num-auto","measure:time":"x-time-auto"}}};
p.globalSettings=S.globalSettings,S.UnitsRegistry.add("COORDS.PARALLEL",k["COORDS.PARALLEL"]).add("PARALLEL/ELEMENT.LINE",k["PARALLEL/ELEMENT.LINE"]).add("COORDS.RECT",k["COORDS.RECT"]).add("ELEMENT.POINT",k["ELEMENT.POINT"]).add("ELEMENT.LINE",k["ELEMENT.LINE"]).add("ELEMENT.INTERVAL",k["ELEMENT.INTERVAL"]),i.Plot=p,i.Chart=m,i.__api__=E,i.api=S}),r("underscore",function(){return t}),r("d3",function(){return e}),n("tau.newCharts")});