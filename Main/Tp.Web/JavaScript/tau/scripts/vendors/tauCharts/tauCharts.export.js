!function(t,e){if("function"==typeof define&&define.amd)define(["tauCharts"],function(t){return e(t)});else if("object"==typeof module&&module.exports){{require("tauCharts")}module.exports=e(tauCharts)}else e(t.tauCharts)}(this,function(t){var e,n,r;return function(t){function i(t,e){return x.call(t,e)}function a(t,e){var n,i,r,a,s,o,l,u,h,c,f,d=e&&e.split("/"),p=v.map,m=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),s=t.length-1,v.nodeIdCompat&&E.test(t[s])&&(t[s]=t[s].replace(E,"")),t=d.concat(t),h=0;h<t.length;h+=1)if(f=t[h],"."===f)t.splice(h,1),h-=1;else if(".."===f){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&p){for(n=t.split("/"),h=n.length;h>0;h-=1){if(i=n.slice(0,h).join("/"),d)for(c=d.length;c>0;c-=1)if(r=p[d.slice(0,c).join("/")],r&&(r=r[i])){a=r,o=h;break}if(a)break;!l&&m&&m[i]&&(l=m[i],u=h)}!a&&l&&(a=l,o=u),a&&(n.splice(0,o,a),t=n.join("/"))}return t}function s(e,n){return function(){var i=w.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),d.apply(t,i.concat([e,n]))}}function o(t){return function(e){return a(e,t)}}function l(t){return function(e){y[t]=e}}function u(e){if(i(g,e)){var n=g[e];delete g[e],b[e]=!0,f.apply(t,n)}if(!i(y,e)&&!i(b,e))throw new Error("No "+e);return y[e]}function h(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function c(t){return function(){return v&&v.config&&v.config[t]||{}}}var f,d,p,m,y={},g={},v={},b={},x=Object.prototype.hasOwnProperty,w=[].slice,E=/\.js$/;p=function(t,e){var n,i=h(t),r=i[0];return t=i[1],r&&(r=a(r,e),n=u(r)),r?t=n&&n.normalize?n.normalize(t,o(e)):a(t,e):(t=a(t,e),i=h(t),r=i[0],t=i[1],r&&(n=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:n}},m={require:function(t){return s(t)},exports:function(t){var e=y[t];return"undefined"!=typeof e?e:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:c(t)}}},f=function(e,n,r,a){var o,h,c,f,d,v,x=[],w=typeof r;
if(a=a||e,"undefined"===w||"function"===w){for(n=!n.length&&r.length?["require","exports","module"]:n,d=0;d<n.length;d+=1)if(f=p(n[d],a),h=f.f,"require"===h)x[d]=m.require(e);else if("exports"===h)x[d]=m.exports(e),v=!0;else if("module"===h)o=x[d]=m.module(e);else if(i(y,h)||i(g,h)||i(b,h))x[d]=u(h);else{if(!f.p)throw new Error(e+" missing "+h);f.p.load(f.n,s(a,!0),l(h),{}),x[d]=y[h]}c=r?r.apply(y[e],x):void 0,e&&(o&&o.exports!==t&&o.exports!==y[e]?y[e]=o.exports:c===t&&v||(y[e]=c))}else e&&(y[e]=r)},e=n=d=function(e,n,i,r,a){if("string"==typeof e)return m[e]?m[e](n):u(p(e,n).f);if(!e.splice){if(v=e,v.deps&&d(v.deps,v.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"==typeof i&&(i=r,r=a),r?f(t,e,n,i):setTimeout(function(){f(t,e,n,i)},4),d},d.config=function(t){return d(t)},e._defined=y,r=function(t,e,n){e.splice||(n=e,e=[]),i(y,t)||i(g,t)||(g[t]=[t,e,n])},r.amd={jQuery:!0}}(),r("../node_modules/almond/almond",function(){}),function(t){function e(t){this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=t.replace(/ /g,""),t=t.toLowerCase();var n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};
for(var i in n)t==i&&(t=n[i]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],a=0;a<r.length;a++){var s=r[a].re,o=r[a].process,l=s.exec(t);l&&(channels=o(l),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n},this.getHelpXML=function(){for(var t=new Array,i=0;i<r.length;i++)for(var a=r[i].example,s=0;s<a.length;s++)t[t.length]=a[s];for(var o in n)t[t.length]=o;var l=document.createElement("ul");l.setAttribute("id","rgbcolor-examples");for(var i=0;i<t.length;i++)try{var u=document.createElement("li"),h=new e(t[i]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+h.toHex()+"; color:"+h.toHex(),c.appendChild(document.createTextNode("test"));var f=document.createTextNode(" "+t[i]+" -> "+h.toRGB()+" -> "+h.toHex());u.appendChild(c),u.appendChild(f),l.appendChild(u)}catch(d){}return l}}"undefined"!=typeof r&&r.amd?r("../bower_components/canvg/rgbcolor",[],function(){return e}):"undefined"!=typeof module&&module.exports&&(module.exports=e),t.RGBColor=e}("undefined"!=typeof window?window:this),function(t){function e(t,e,r,a){var s=document.getElementById(t),o=s.naturalWidth,l=s.naturalHeight,u=document.getElementById(e);
u.style.width=o+"px",u.style.height=l+"px",u.width=o,u.height=l;var h=u.getContext("2d");h.clearRect(0,0,o,l),h.drawImage(s,0,0),isNaN(r)||1>r||(a?n(e,0,0,o,l,r):i(e,0,0,o,l,r))}function n(t,e,n,i,r,l){if(!(isNaN(l)||1>l)){l|=0;var u,h=document.getElementById(t),c=h.getContext("2d");try{try{u=c.getImageData(e,n,i,r)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),u=c.getImageData(e,n,i,r)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var d,p,m,y,g,v,b,x,w,E,P,C,B,T,k,S,M,V,A,_,R,N,D,O,I=u.data,L=l+l+1,z=i-1,X=r-1,j=l+1,U=j*(j+1)/2,F=new a,q=F;for(m=1;L>m;m++)if(q=q.next=new a,m==j)var H=q;q.next=F;var G=null,W=null;b=v=0;var $=s[l],Y=o[l];for(p=0;r>p;p++){for(S=M=V=A=x=w=E=P=0,C=j*(_=I[v]),B=j*(R=I[v+1]),T=j*(N=I[v+2]),k=j*(D=I[v+3]),x+=U*_,w+=U*R,E+=U*N,P+=U*D,q=F,m=0;j>m;m++)q.r=_,q.g=R,q.b=N,q.a=D,q=q.next;for(m=1;j>m;m++)y=v+((m>z?z:m)<<2),x+=(q.r=_=I[y])*(O=j-m),w+=(q.g=R=I[y+1])*O,E+=(q.b=N=I[y+2])*O,P+=(q.a=D=I[y+3])*O,S+=_,M+=R,V+=N,A+=D,q=q.next;for(G=F,W=H,d=0;i>d;d++)I[v+3]=D=P*$>>Y,0!=D?(D=255/D,I[v]=(x*$>>Y)*D,I[v+1]=(w*$>>Y)*D,I[v+2]=(E*$>>Y)*D):I[v]=I[v+1]=I[v+2]=0,x-=C,w-=B,E-=T,P-=k,C-=G.r,B-=G.g,T-=G.b,k-=G.a,y=b+((y=d+l+1)<z?y:z)<<2,S+=G.r=I[y],M+=G.g=I[y+1],V+=G.b=I[y+2],A+=G.a=I[y+3],x+=S,w+=M,E+=V,P+=A,G=G.next,C+=_=W.r,B+=R=W.g,T+=N=W.b,k+=D=W.a,S-=_,M-=R,V-=N,A-=D,W=W.next,v+=4;b+=i}for(d=0;i>d;d++){for(M=V=A=S=w=E=P=x=0,v=d<<2,C=j*(_=I[v]),B=j*(R=I[v+1]),T=j*(N=I[v+2]),k=j*(D=I[v+3]),x+=U*_,w+=U*R,E+=U*N,P+=U*D,q=F,m=0;j>m;m++)q.r=_,q.g=R,q.b=N,q.a=D,q=q.next;for(g=i,m=1;l>=m;m++)v=g+d<<2,x+=(q.r=_=I[v])*(O=j-m),w+=(q.g=R=I[v+1])*O,E+=(q.b=N=I[v+2])*O,P+=(q.a=D=I[v+3])*O,S+=_,M+=R,V+=N,A+=D,q=q.next,X>m&&(g+=i);for(v=d,G=F,W=H,p=0;r>p;p++)y=v<<2,I[y+3]=D=P*$>>Y,D>0?(D=255/D,I[y]=(x*$>>Y)*D,I[y+1]=(w*$>>Y)*D,I[y+2]=(E*$>>Y)*D):I[y]=I[y+1]=I[y+2]=0,x-=C,w-=B,E-=T,P-=k,C-=G.r,B-=G.g,T-=G.b,k-=G.a,y=d+((y=p+j)<X?y:X)*i<<2,x+=S+=G.r=I[y],w+=M+=G.g=I[y+1],E+=V+=G.b=I[y+2],P+=A+=G.a=I[y+3],G=G.next,C+=_=W.r,B+=R=W.g,T+=N=W.b,k+=D=W.a,S-=_,M-=R,V-=N,A-=D,W=W.next,v+=i
}c.putImageData(u,e,n)}}function i(t,e,n,i,r,l){if(!(isNaN(l)||1>l)){l|=0;var u,h=document.getElementById(t),c=h.getContext("2d");try{try{u=c.getImageData(e,n,i,r)}catch(f){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),u=c.getImageData(e,n,i,r)}catch(f){throw alert("Cannot access local image"),new Error("unable to access local image data: "+f)}}}catch(f){throw alert("Cannot access image"),new Error("unable to access image data: "+f)}var d,p,m,y,g,v,b,x,w,E,P,C,B,T,k,S,M,V,A,_,R=u.data,N=l+l+1,D=i-1,O=r-1,I=l+1,L=I*(I+1)/2,z=new a,X=z;for(m=1;N>m;m++)if(X=X.next=new a,m==I)var j=X;X.next=z;var U=null,F=null;b=v=0;var q=s[l],H=o[l];for(p=0;r>p;p++){for(T=k=S=x=w=E=0,P=I*(M=R[v]),C=I*(V=R[v+1]),B=I*(A=R[v+2]),x+=L*M,w+=L*V,E+=L*A,X=z,m=0;I>m;m++)X.r=M,X.g=V,X.b=A,X=X.next;for(m=1;I>m;m++)y=v+((m>D?D:m)<<2),x+=(X.r=M=R[y])*(_=I-m),w+=(X.g=V=R[y+1])*_,E+=(X.b=A=R[y+2])*_,T+=M,k+=V,S+=A,X=X.next;for(U=z,F=j,d=0;i>d;d++)R[v]=x*q>>H,R[v+1]=w*q>>H,R[v+2]=E*q>>H,x-=P,w-=C,E-=B,P-=U.r,C-=U.g,B-=U.b,y=b+((y=d+l+1)<D?y:D)<<2,T+=U.r=R[y],k+=U.g=R[y+1],S+=U.b=R[y+2],x+=T,w+=k,E+=S,U=U.next,P+=M=F.r,C+=V=F.g,B+=A=F.b,T-=M,k-=V,S-=A,F=F.next,v+=4;b+=i}for(d=0;i>d;d++){for(k=S=T=w=E=x=0,v=d<<2,P=I*(M=R[v]),C=I*(V=R[v+1]),B=I*(A=R[v+2]),x+=L*M,w+=L*V,E+=L*A,X=z,m=0;I>m;m++)X.r=M,X.g=V,X.b=A,X=X.next;for(g=i,m=1;l>=m;m++)v=g+d<<2,x+=(X.r=M=R[v])*(_=I-m),w+=(X.g=V=R[v+1])*_,E+=(X.b=A=R[v+2])*_,T+=M,k+=V,S+=A,X=X.next,O>m&&(g+=i);for(v=d,U=z,F=j,p=0;r>p;p++)y=v<<2,R[y]=x*q>>H,R[y+1]=w*q>>H,R[y+2]=E*q>>H,x-=P,w-=C,E-=B,P-=U.r,C-=U.g,B-=U.b,y=d+((y=p+I)<O?y:O)*i<<2,x+=T+=U.r=R[y],w+=k+=U.g=R[y+1],E+=S+=U.b=R[y+2],U=U.next,P+=M=F.r,C+=V=F.g,B+=A=F.b,T-=M,k-=V,S-=A,F=F.next,v+=i}c.putImageData(u,e,n)}}function a(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],l={image:e,canvasRGBA:n,canvasRGB:i};
"undefined"!=typeof r&&r.amd?r("../bower_components/canvg/StackBlur",[],function(){return l}):"undefined"!=typeof module&&module.exports&&(module.exports=l),t.stackBlur=l}("undefined"!=typeof window?window:this),function(t,e){"undefined"!=typeof r&&r.amd?r("../bower_components/canvg/canvg",["rgbcolor","stackblur"],e):"undefined"!=typeof module&&module.exports&&(module.exports=e(n("rgbcolor"),n("stackblur"))),t.canvg=e(t.RGBColor,t.stackBlur)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e=[0,0,0],n=function(n,i){var r=t.match(n);null!=r&&(e[i]+=r.length,t=t.replace(n," "))};return t=t.replace(/:not\(([^\)]*)\)/g,"     $1 "),t=t.replace(/{[^]*/gm," "),n(o,1),n(l,0),n(u,1),n(h,2),n(c,1),n(f,1),t=t.replace(/[\*\s\+>~]/g," "),t=t.replace(/[#\.]/g," "),n(d,2),e.join("")}function r(r){var s={opts:r};s.FRAMERATE=30,s.MAX_VIRTUAL_PIXELS=3e4,s.log=function(){},1==s.opts.log&&"undefined"!=typeof console&&(s.log=function(t){console.log(t)}),s.init=function(t){var e=0;s.UniqueId=function(){return e++,"canvg"+e},s.Definitions={},s.Styles={},s.StylesSpecificity={},s.Animations=[],s.Images=[],s.ctx=t,s.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},s.init(),s.ImagesLoaded=function(){for(var t=0;t<s.Images.length;t++)if(!s.Images[t].loaded)return!1;return!0},s.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},s.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},s.ajax=function(t){var e;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e?(e.open("GET",t,!1),e.send(null),e.responseText):null
},s.parseXml=function(t){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,e.loadXml(t,n),e}if(window.DOMParser){var i=new DOMParser;return i.parseFromString(t,"text/xml")}t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e},s.Property=function(t,e){this.name=t,this.value=e},s.Property.prototype.getValue=function(){return this.value},s.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},s.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},s.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},s.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},s.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var i=new t(this.value);i.ok&&(n="rgba("+i.r+", "+i.g+", "+i.b+", "+e.numValue()+")")}return new s.Property(this.name,n)},s.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),s.Definitions[t]},s.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},s.Property.prototype.getFillStyleDefinition=function(t,e){var n=this.getDefinition();if(null!=n&&n.createGradient)return n.createGradient(s.ctx,t,e);if(null!=n&&n.createPattern){if(n.getHrefAttribute().hasValue()){var i=n.attribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&(n.attribute("patternTransform",!0).value=i.value)}return n.createPattern(s.ctx,t)}return null},s.Property.prototype.getDPI=function(){return 96},s.Property.prototype.getEM=function(t){var e=12,n=new s.Property("fontSize",s.Font.Parse(s.ctx.font).fontSize);
return n.hasValue()&&(e=n.toPixels(t)),e},s.Property.prototype.getUnits=function(){var t=this.value+"";return t.replace(/[0-9\.\-]/g,"")},s.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/em$/))return this.numValue()*this.getEM(t);if(n.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(n.match(/pc$/))return 15*this.numValue();if(n.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(t);if(n.match(/%$/))return this.numValue()*s.ViewPort.ComputeSize(t);var i=this.numValue();return e&&1>i?i*s.ViewPort.ComputeSize(t):i},s.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},s.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var o={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return s.Property.prototype.toTextBaseline=function(){return this.hasValue()?o[this.value]:null},s.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,n,i,r,a){var o=null!=a?this.Parse(a):this.CreateFont("","","","","",s.ctx.font);return{fontFamily:r||o.fontFamily,fontSize:i||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:n||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")
}}};var t=this;this.Parse=function(e){for(var n={},i=s.trim(s.compressSpaces(e||"")).split(" "),r={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},a="",o=0;o<i.length;o++)r.fontStyle||-1==t.Styles.indexOf(i[o])?r.fontVariant||-1==t.Variants.indexOf(i[o])?r.fontWeight||-1==t.Weights.indexOf(i[o])?r.fontSize?"inherit"!=i[o]&&(a+=i[o]):("inherit"!=i[o]&&(n.fontSize=i[o].split("/")[0]),r.fontStyle=r.fontVariant=r.fontWeight=r.fontSize=!0):("inherit"!=i[o]&&(n.fontWeight=i[o]),r.fontStyle=r.fontVariant=r.fontWeight=!0):("inherit"!=i[o]&&(n.fontVariant=i[o]),r.fontStyle=r.fontVariant=!0):("inherit"!=i[o]&&(n.fontStyle=i[o]),r.fontStyle=!0);return""!=a&&(n.fontFamily=a),n}},s.ToNumberArray=function(t){for(var e=s.trim(s.compressSpaces((t||"").replace(/,/g," "))).split(" "),n=0;n<e.length;n++)e[n]=parseFloat(e[n]);return e},s.Point=function(t,e){this.x=t,this.y=e},s.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},s.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],n=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=n},s.CreatePoint=function(t){var e=s.ToNumberArray(t);return new s.Point(e[0],e[1])},s.CreatePath=function(t){for(var e=s.ToNumberArray(t),n=[],i=0;i<e.length;i+=2)n.push(new s.Point(e[i],e[i+1]));return n},s.BoundingBox=function(t,e,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,n,i,r,a){var s=t+2/3*(n-t),o=e+2/3*(i-e),l=s+1/3*(r-t),u=o+1/3*(a-e);
this.addBezierCurve(t,e,s,l,o,u,r,a)},this.addBezierCurve=function(t,e,n,r,a,s,o,l){var u=[t,e],h=[n,r],c=[a,s],f=[o,l];for(this.addPoint(u[0],u[1]),this.addPoint(f[0],f[1]),i=0;1>=i;i++){var d=function(t){return Math.pow(1-t,3)*u[i]+3*Math.pow(1-t,2)*t*h[i]+3*(1-t)*Math.pow(t,2)*c[i]+Math.pow(t,3)*f[i]},p=6*u[i]-12*h[i]+6*c[i],m=-3*u[i]+9*h[i]-9*c[i]+3*f[i],y=3*h[i]-3*u[i];if(0!=m){var g=Math.pow(p,2)-4*y*m;if(!(0>g)){var v=(-p+Math.sqrt(g))/(2*m);v>0&&1>v&&(0==i&&this.addX(d(v)),1==i&&this.addY(d(v)));var b=(-p-Math.sqrt(g))/(2*m);b>0&&1>b&&(0==i&&this.addX(d(b)),1==i&&this.addY(d(b)))}}else{if(0==p)continue;var x=-y/p;x>0&&1>x&&(0==i&&this.addX(d(x)),1==i&&this.addY(d(x)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(n,r)},s.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=s.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=s.ToNumberArray(t);this.angle=new s.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=s.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])
}},this.Type.matrix=function(t){this.m=s.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],n=this.m[2],i=this.m[4],r=this.m[1],a=this.m[3],s=this.m[5],o=0,l=0,u=1,h=1/(e*(a*u-s*l)-n*(r*u-s*o)+i*(r*l-a*o));t.transform(h*(a*u-s*l),h*(s*o-r*u),h*(i*l-n*u),h*(e*u-i*o),h*(n*s-i*a),h*(i*r-e*s))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new s.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;e>=0;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var n=s.trim(s.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<n.length;i++){var r=s.trim(n[i].split("(")[0]),a=n[i].split("(")[1].replace(")",""),o=new this.Type[r](a);o.type=r,this.transforms.push(o)}},s.AspectRatio=function(t,e,n,i,r,a,o,l,u,h){e=s.compressSpaces(e),e=e.replace(/^defer\s/,"");var c=e.split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",d=n/i,p=r/a,m=Math.min(d,p),y=Math.max(d,p);"meet"==f&&(i*=m,a*=m),"slice"==f&&(i*=y,a*=y),u=new s.Property("refX",u),h=new s.Property("refY",h),u.hasValue()&&h.hasValue()?t.translate(-m*u.toPixels("x"),-m*h.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(n/2-i/2,0),c.match(/YMid$/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(0,r/2-a/2),c.match(/^xMax/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(n-i,0),c.match(/YMax$/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(0,r-a)),"none"==c?t.scale(d,p):"meet"==f?t.scale(m,m):"slice"==f&&t.scale(y,y),t.translate(null==o?0:-o,null==l?0:-l)
},s.Element={},s.EmptyProperty=new s.Property("EMPTY",""),s.Element.ElementBase=function(t){if(this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var n=this.attributes[t];return null!=n?n:(1==e&&(n=new s.Property(t,""),this.attributes[t]=n),n||s.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if(t.match(/:href$/))return this.attributes[t];return s.EmptyProperty},this.style=function(t,e,n){var i=this.styles[t];if(null!=i)return i;var r=this.attribute(t);if(null!=r&&r.hasValue())return this.styles[t]=r,r;if(1!=n){var a=this.parent;if(null!=a){var o=a.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(i=new s.Property(t,""),this.styles[t]=i),i||s.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.attribute("mask").hasValue()){var e=this.attribute("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var n=t;e&&(n=s.CreateElement(t)),n.parent=this,"title"!=n.type&&this.children.push(n)},null!=t&&1==t.nodeType){for(var e=0;e<t.attributes.length;e++){var n=t.attributes[e];this.attributes[n.nodeName]=new s.Property(n.nodeName,n.nodeValue)}for(var i in s.Styles)if(a(t,i)){var r=s.Styles[i],o=s.StylesSpecificity[i];if(null!=r)for(var l in r){var u=this.stylesSpecificity[l];"undefined"==typeof u&&(u="000"),o>u&&(this.styles[l]=r[l],this.stylesSpecificity[l]=o)}}if(this.attribute("style").hasValue())for(var r=this.attribute("style").value.split(";"),e=0;e<r.length;e++)if(""!=s.trim(r[e])){var h=r[e].split(":"),l=s.trim(h[0]),c=s.trim(h[1]);
this.styles[l]=new s.Property(l,c)}this.attribute("id").hasValue()&&null==s.Definitions[this.attribute("id").value]&&(s.Definitions[this.attribute("id").value]=this);for(var e=0;e<t.childNodes.length;e++){var f=t.childNodes[e];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var d=f.nodeValue||f.text||"";""!=s.trim(s.compressSpaces(d))&&this.addChild(new s.Element.tspan(f),!1)}}}},s.Element.RenderedElementBase=function(t){this.base=s.Element.ElementBase,this.base(t),this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=e&&(t.fillStyle=e)}else if(this.style("fill").hasValue()){var n=this.style("fill");"currentColor"==n.value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.fillStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("fill-opacity").hasValue()){var n=new s.Property("fill",t.fillStyle);n=n.addOpacity(this.style("fill-opacity")),t.fillStyle=n.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=e&&(t.strokeStyle=e)}else if(this.style("stroke").hasValue()){var i=this.style("stroke");"currentColor"==i.value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("stroke-opacity").hasValue()){var i=new s.Property("stroke",t.strokeStyle);i=i.addOpacity(this.style("stroke-opacity")),t.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var r=this.style("stroke-width").toPixels();t.lineWidth=0==r?.001:r}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var a=s.ToNumberArray(this.style("stroke-dasharray").value);
"undefined"!=typeof t.setLineDash?t.setLineDash(a):"undefined"!=typeof t.webkitLineDash?t.webkitLineDash=a:"undefined"==typeof t.mozDash||1==a.length&&0==a[0]||(t.mozDash=a);var o=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof t.lineDashOffset?t.lineDashOffset=o:"undefined"!=typeof t.webkitLineDashOffset?t.webkitLineDashOffset=o:"undefined"!=typeof t.mozDashOffset&&(t.mozDashOffset=o)}if("undefined"!=typeof t.font&&(t.font=s.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var l=new s.Transform(this.attribute("transform").value);l.apply(t)}if(this.style("clip-path",!1,!0).hasValue()){var u=this.style("clip-path",!1,!0).getDefinition();null!=u&&u.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},s.Element.RenderedElementBase.prototype=new s.Element.ElementBase,s.Element.PathElementBase=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new s.BoundingBox},this.renderChildren=function(t){this.path(t),s.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()){var n=this.style("marker-start").getDefinition();n.render(t,e[0][0],e[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var n=this.style("marker-mid").getDefinition(),i=1;i<e.length-1;i++)n.render(t,e[i][0],e[i][1]);if(this.style("marker-end").isUrlDefinition()){var n=this.style("marker-end").getDefinition();n.render(t,e[e.length-1][0],e[e.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},s.Element.PathElementBase.prototype=new s.Element.RenderedElementBase,s.Element.svg=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),s.ViewPort.RemoveCurrent()
},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,"undefined"!=typeof t.font&&"undefined"!=typeof window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=s.ViewPort.width(),n=s.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){e=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");var i=0,r=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),r=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(i,r),t.lineTo(e,r),t.lineTo(e,n),t.lineTo(i,n),t.closePath(),t.clip())}if(s.ViewPort.SetCurrent(e,n),this.attribute("viewBox").hasValue()){var a=s.ToNumberArray(this.attribute("viewBox").value),o=a[0],l=a[1];e=a[2],n=a[3],s.AspectRatio(t,this.attribute("preserveAspectRatio").value,s.ViewPort.width(),e,s.ViewPort.height(),n,o,l,this.attribute("refX").value,this.attribute("refY").value),s.ViewPort.RemoveCurrent(),s.ViewPort.SetCurrent(a[2],a[3])}}},s.Element.svg.prototype=new s.Element.RenderedElementBase,s.Element.rect=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y"),a=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=a),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(a=o),a=Math.min(a,i/2),o=Math.min(o,r/2),null!=t&&(t.beginPath(),t.moveTo(e+a,n),t.lineTo(e+i-a,n),t.quadraticCurveTo(e+i,n,e+i,n+o),t.lineTo(e+i,n+r-o),t.quadraticCurveTo(e+i,n+r,e+i-a,n+r),t.lineTo(e+a,n+r),t.quadraticCurveTo(e,n+r,e,n+r-o),t.lineTo(e,n+o),t.quadraticCurveTo(e,n,e+a,n),t.closePath()),new s.BoundingBox(e,n,e+i,n+r)
}},s.Element.rect.prototype=new s.Element.PathElementBase,s.Element.circle=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,n,i,0,2*Math.PI,!0),t.closePath()),new s.BoundingBox(e-i,n-i,e+i,n+i)}},s.Element.circle.prototype=new s.Element.PathElementBase,s.Element.ellipse=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=4*((Math.sqrt(2)-1)/3),n=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),r=this.attribute("cx").toPixels("x"),a=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(r,a-i),t.bezierCurveTo(r+e*n,a-i,r+n,a-e*i,r+n,a),t.bezierCurveTo(r+n,a+e*i,r+e*n,a+i,r,a+i),t.bezierCurveTo(r-e*n,a+i,r-n,a+e*i,r-n,a),t.bezierCurveTo(r-n,a-e*i,r-e*n,a-i,r,a-i),t.closePath()),new s.BoundingBox(r-n,a-i,r+n,a+i)}},s.Element.ellipse.prototype=new s.Element.PathElementBase,s.Element.line=function(t){this.base=s.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new s.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new s.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new s.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},s.Element.line.prototype=new s.Element.PathElementBase,s.Element.polyline=function(t){this.base=s.Element.PathElementBase,this.base(t),this.points=s.CreatePath(this.attribute("points").value),this.path=function(t){var e=new s.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var n=1;n<this.points.length;n++)e.addPoint(this.points[n].x,this.points[n].y),null!=t&&t.lineTo(this.points[n].x,this.points[n].y);
return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},s.Element.polyline.prototype=new s.Element.PathElementBase,s.Element.polygon=function(t){this.base=s.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},s.Element.polygon.prototype=new s.Element.polyline,s.Element.path=function(t){this.base=s.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," "),e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),e=e.replace(/([0-9])([+\-])/gm,"$1 $2"),e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=s.compressSpaces(e),e=s.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new s.Point(0,0),this.control=new s.Point(0,0),this.current=new s.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new s.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)
},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t,t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t,t},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var t=new s.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var n=new s.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var i=e.getAsCurrentPoint();for(e.addMarker(i),n.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),e.start=e.current;!e.isCommandOrEnd();){var i=e.getAsCurrentPoint();e.addMarker(i,e.start),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"L":case"l":for(;!e.isCommandOrEnd();){var r=e.current,i=e.getAsCurrentPoint();e.addMarker(i,r),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var a=new s.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(a,e.current),e.current=a,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();){var a=new s.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar());
e.addMarker(a,e.current),e.current=a,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getPoint(),u=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,u,l),n.addBezierCurve(o.x,o.y,l.x,l.y,u.x,u.y,h.x,h.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,h.x,h.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getReflectedControlPoint(),u=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,u,l),n.addBezierCurve(o.x,o.y,l.x,l.y,u.x,u.y,h.x,h.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,h.x,h.y)}break;case"Q":case"q":for(;!e.isCommandOrEnd();){var o=e.current,u=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,u,u),n.addQuadraticCurve(o.x,o.y,u.x,u.y,h.x,h.y),null!=t&&t.quadraticCurveTo(u.x,u.y,h.x,h.y)}break;case"T":case"t":for(;!e.isCommandOrEnd();){var o=e.current,u=e.getReflectedControlPoint();e.control=u;var h=e.getAsCurrentPoint();e.addMarker(h,u,u),n.addQuadraticCurve(o.x,o.y,u.x,u.y,h.x,h.y),null!=t&&t.quadraticCurveTo(u.x,u.y,h.x,h.y)}break;case"A":case"a":for(;!e.isCommandOrEnd();){var o=e.current,c=e.getScalar(),f=e.getScalar(),d=e.getScalar()*(Math.PI/180),p=e.getScalar(),m=e.getScalar(),h=e.getAsCurrentPoint(),y=new s.Point(Math.cos(d)*(o.x-h.x)/2+Math.sin(d)*(o.y-h.y)/2,-Math.sin(d)*(o.x-h.x)/2+Math.cos(d)*(o.y-h.y)/2),g=Math.pow(y.x,2)/Math.pow(c,2)+Math.pow(y.y,2)/Math.pow(f,2);g>1&&(c*=Math.sqrt(g),f*=Math.sqrt(g));var v=(p==m?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(y.y,2)-Math.pow(f,2)*Math.pow(y.x,2))/(Math.pow(c,2)*Math.pow(y.y,2)+Math.pow(f,2)*Math.pow(y.x,2)));isNaN(v)&&(v=0);var b=new s.Point(v*c*y.y/f,v*-f*y.x/c),x=new s.Point((o.x+h.x)/2+Math.cos(d)*b.x-Math.sin(d)*b.y,(o.y+h.y)/2+Math.sin(d)*b.x+Math.cos(d)*b.y),w=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(w(t)*w(e))},P=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))
},C=P([1,0],[(y.x-b.x)/c,(y.y-b.y)/f]),B=[(y.x-b.x)/c,(y.y-b.y)/f],T=[(-y.x-b.x)/c,(-y.y-b.y)/f],k=P(B,T);E(B,T)<=-1&&(k=Math.PI),E(B,T)>=1&&(k=0);var S=1-m?1:-1,M=C+S*(k/2),V=new s.Point(x.x+c*Math.cos(M),x.y+f*Math.sin(M));if(e.addMarkerAngle(V,M-S*Math.PI/2),e.addMarkerAngle(h,M-S*Math.PI),n.addPoint(h.x,h.y),null!=t){var E=c>f?c:f,A=c>f?1:c/f,_=c>f?f/c:1;t.translate(x.x,x.y),t.rotate(d),t.scale(A,_),t.arc(0,0,E,C,C+k,1-m),t.scale(1/A,1/_),t.rotate(-d),t.translate(-x.x,-x.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return n},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),n=[],i=0;i<t.length;i++)n.push([t[i],e[i]]);return n}},s.Element.path.prototype=new s.Element.PathElementBase,s.Element.pattern=function(t){this.base=s.Element.ElementBase,this.base(t),this.createPattern=function(t){var e=this.attribute("width").toPixels("x",!0),n=this.attribute("height").toPixels("y",!0),i=new s.Element.svg;i.attributes.viewBox=new s.Property("viewBox",this.attribute("viewBox").value),i.attributes.width=new s.Property("width",e+"px"),i.attributes.height=new s.Property("height",n+"px"),i.attributes.transform=new s.Property("transform",this.attribute("patternTransform").value),i.children=this.children;var r=document.createElement("canvas");r.width=e,r.height=n;var a=r.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&a.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var o=-1;1>=o;o++)for(var l=-1;1>=l;l++)a.save(),a.translate(o*r.width,l*r.height),i.render(a),a.restore();var u=t.createPattern(r,"repeat");return u}},s.Element.pattern.prototype=new s.Element.ElementBase,s.Element.marker=function(t){this.base=s.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,n){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(n),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();
var i=new s.Element.svg;i.attributes.viewBox=new s.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new s.Property("refX",this.attribute("refX").value),i.attributes.refY=new s.Property("refY",this.attribute("refY").value),i.attributes.width=new s.Property("width",this.attribute("markerWidth").value),i.attributes.height=new s.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new s.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new s.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-n),t.translate(-e.x,-e.y)}},s.Element.marker.prototype=new s.Element.ElementBase,s.Element.defs=function(t){this.base=s.Element.ElementBase,this.base(t),this.render=function(){}},s.Element.defs.prototype=new s.Element.ElementBase,s.Element.GradientBase=function(t){this.base=s.Element.ElementBase,this.base(t),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"stop"==n.type&&this.stops.push(n)}this.getGradient=function(){},this.createGradient=function(t,e,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition());var r=function(t){if(n.hasValue()){var e=new s.Property("color",t);return e.addOpacity(n).value}return t},a=this.getGradient(t,e);if(null==a)return r(i.stops[i.stops.length-1].color);for(var o=0;o<i.stops.length;o++)a.addColorStop(i.stops[o].offset,r(i.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var l=s.ViewPort.viewPorts[0],u=new s.Element.rect;u.attributes.x=new s.Property("x",-s.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new s.Property("y",-s.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new s.Property("width",s.MAX_VIRTUAL_PIXELS),u.attributes.height=new s.Property("height",s.MAX_VIRTUAL_PIXELS);
var h=new s.Element.g;h.attributes.transform=new s.Property("transform",this.attribute("gradientTransform").value),h.children=[u];var c=new s.Element.svg;c.attributes.x=new s.Property("x",0),c.attributes.y=new s.Property("y",0),c.attributes.width=new s.Property("width",l.width),c.attributes.height=new s.Property("height",l.height),c.children=[h];var f=document.createElement("canvas");f.width=l.width,f.height=l.height;var d=f.getContext("2d");return d.fillStyle=a,c.render(d),d.createPattern(f,"no-repeat")}return a}},s.Element.GradientBase.prototype=new s.Element.ElementBase,s.Element.linearGradient=function(t){this.base=s.Element.GradientBase,this.base(t),this.getGradient=function(t,e){var n="objectBoundingBox"==this.gradientUnits?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var i="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),r="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),a="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),s="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return i==a&&r==s?null:t.createLinearGradient(i,r,a,s)}},s.Element.linearGradient.prototype=new s.Element.GradientBase,s.Element.radialGradient=function(t){this.base=s.Element.GradientBase,this.base(t),this.getGradient=function(t,e){var n=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");
var i="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),r="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),a=i,s=r;this.attribute("fx").hasValue()&&(a="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(s="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(a,s,0,i,r,o)}},s.Element.radialGradient.prototype=new s.Element.GradientBase,s.Element.stop=function(t){this.base=s.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var e=this.style("stop-color");this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},s.Element.stop.prototype=new s.Element.ElementBase,s.Element.AnimateBase=function(t){this.base=s.Element.ElementBase,this.base(t),s.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;
else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var i=this.attribute("type").value;n=i+"("+n+")"}this.getProperty().value=n,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),n=Math.floor(e),i=Math.ceil(e);t.from=new s.Property("from",parseFloat(this.values.value[n])),t.to=new s.Property("to",parseFloat(this.values.value[i])),t.progress=(e-n)/(i-n)}else t.from=this.from,t.to=this.to;return t}},s.Element.AnimateBase.prototype=new s.Element.ElementBase,s.Element.animate=function(t){this.base=s.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress(),e=t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress;return e+this.initialUnits}},s.Element.animate.prototype=new s.Element.AnimateBase,s.Element.animateColor=function(e){this.base=s.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),n=new t(e.from.value),i=new t(e.to.value);if(n.ok&&i.ok){var r=n.r+(i.r-n.r)*e.progress,a=n.g+(i.g-n.g)*e.progress,s=n.b+(i.b-n.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(a,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},s.Element.animateColor.prototype=new s.Element.AnimateBase,s.Element.animateTransform=function(t){this.base=s.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=s.ToNumberArray(t.from.value),n=s.ToNumberArray(t.to.value),i="",r=0;r<e.length;r++)i+=e[r]+(n[r]-e[r])*t.progress+" ";
return i}},s.Element.animateTransform.prototype=new s.Element.animate,s.Element.font=function(t){this.base=s.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"font-face"==n.type?(this.fontFace=n,n.style("font-family").hasValue()&&(s.Definitions[n.style("font-family").value]=this)):"missing-glyph"==n.type?this.missingGlyph=n:"glyph"==n.type&&(""!=n.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[n.unicode]&&(this.glyphs[n.unicode]=[]),this.glyphs[n.unicode][n.arabicForm]=n):this.glyphs[n.unicode]=n)}},s.Element.font.prototype=new s.Element.ElementBase,s.Element.fontface=function(t){this.base=s.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},s.Element.fontface.prototype=new s.Element.ElementBase,s.Element.missingglyph=function(t){this.base=s.Element.path,this.base(t),this.horizAdvX=0},s.Element.missingglyph.prototype=new s.Element.path,s.Element.glyph=function(t){this.base=s.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},s.Element.glyph.prototype=new s.Element.path,s.Element.text=function(t){this.captureTextNodes=!0,this.base=s.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize);return new s.BoundingBox(t,e-n,t+Math.floor(2*n/3)*this.children[0].getText().length,e)
},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,e)},this.getAnchorDelta=function(t,e,n){var i=this.style("text-anchor").valueOrDefault("start");if("start"!=i){for(var r=0,a=n;a<e.children.length;a++){var s=e.children[a];if(a>n&&s.attribute("x").hasValue())break;r+=s.measureTextRecursive(t)}return-1*("end"==i?r:r/2)}return 0},this.renderChild=function(t,e,n){var i=e.children[n];i.attribute("x").hasValue()?(i.x=i.attribute("x").toPixels("x")+this.getAnchorDelta(t,e,n),i.attribute("dx").hasValue()&&(i.x+=i.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),i.attribute("dx").hasValue()&&(this.x+=i.attribute("dx").toPixels("x")),i.x=this.x),this.x=i.x+i.measureText(t),i.attribute("y").hasValue()?(i.y=i.attribute("y").toPixels("y"),i.attribute("dy").hasValue()&&(i.y+=i.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),i.attribute("dy").hasValue()&&(this.y+=i.attribute("dy").toPixels("y")),i.y=this.y),this.y=i.y,i.render(t);for(var n=0;n<i.children.length;n++)this.renderChild(t,i,n)}},s.Element.text.prototype=new s.Element.RenderedElementBase,s.Element.TextElementBase=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,n){var i=e[n],r=null;if(t.isArabic){var a="isolated";(0==n||" "==e[n-1])&&n<e.length-2&&" "!=e[n+1]&&(a="terminal"),n>0&&" "!=e[n-1]&&n<e.length-2&&" "!=e[n+1]&&(a="medial"),n>0&&" "!=e[n-1]&&(n==e.length-1||" "==e[n+1])&&(a="initial"),"undefined"!=typeof t.glyphs[i]&&(r=t.glyphs[i][a],null==r&&"glyph"==t.glyphs[i].type&&(r=t.glyphs[i]))}else r=t.glyphs[i];return null==r&&(r=t.missingGlyph),r},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(s.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(s.compressSpaces(this.getText()),this.x,this.y);
else{var n=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(s.Font.Parse(s.ctx.font).fontStyle),r=this.getText();e.isRTL&&(r=r.split("").reverse().join(""));for(var a=s.ToNumberArray(this.parent.attribute("dx").value),o=0;o<r.length;o++){var l=this.getGlyph(e,r,o),u=n/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(u,-u);var h=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/n,"italic"==i&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==i&&t.transform(1,0,-.4,1,0,0),t.lineWidth=h,t.scale(1/u,-1/u),t.translate(-this.x,-this.y),this.x+=n*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,"undefined"==typeof a[o]||isNaN(a[o])||(this.x+=a[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),n=0;n<this.children.length;n++)e+=this.children[n].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var n=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize),i=0,r=this.getText();e.isRTL&&(r=r.split("").reverse().join(""));for(var a=s.ToNumberArray(this.parent.attribute("dx").value),o=0;o<r.length;o++){var l=this.getGlyph(e,r,o);i+=(l.horizAdvX||e.horizAdvX)*n/e.fontFace.unitsPerEm,"undefined"==typeof a[o]||isNaN(a[o])||(i+=a[o])}return i}var u=s.compressSpaces(this.getText());if(!t.measureText)return 10*u.length;t.save(),this.setContext(t);var h=t.measureText(u).width;return t.restore(),h}},s.Element.TextElementBase.prototype=new s.Element.RenderedElementBase,s.Element.tspan=function(t){this.captureTextNodes=!0,this.base=s.Element.TextElementBase,this.base(t),this.text=t.nodeValue||t.text||"",this.getText=function(){return this.text}},s.Element.tspan.prototype=new s.Element.TextElementBase,s.Element.tref=function(t){this.base=s.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();
return null!=t?t.children[0].getText():void 0}},s.Element.tref.prototype=new s.Element.TextElementBase,s.Element.a=function(t){this.base=s.Element.TextElementBase,this.base(t),this.hasText=t.childNodes.length>0;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new s.Property("fontSize",s.Font.Parse(s.ctx.font).fontSize);s.Mouse.checkBoundingBox(this,new s.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(this.children.length>0){var n=new s.Element.g;n.children=this.children,n.parent=this,n.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){s.ctx.canvas.style.cursor="pointer"}},s.Element.a.prototype=new s.Element.TextElementBase,s.Element.image=function(t){this.base=s.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var n=e.match(/\.svg$/);if(s.Images.push(this),this.loaded=!1,n)this.img=s.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==s.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){s.log('ERROR: image "'+e+'" not found'),i.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y");0!=r&&0!=a&&(t.save(),n?t.drawSvg(this.img,e,i,r,a):(t.translate(e,i),s.AspectRatio(t,this.attribute("preserveAspectRatio").value,r,this.img.width,a,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");
return new s.BoundingBox(t,e,t+n,e+i)}}},s.Element.image.prototype=new s.Element.RenderedElementBase,s.Element.g=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new s.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},s.Element.g.prototype=new s.Element.RenderedElementBase,s.Element.symbol=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.render=function(){}},s.Element.symbol.prototype=new s.Element.RenderedElementBase,s.Element.style=function(t){this.base=s.Element.ElementBase,this.base(t);for(var e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].nodeValue;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),e=s.compressSpaces(e);for(var r=e.split("}"),i=0;i<r.length;i++)if(""!=s.trim(r[i]))for(var a=r[i].split("{"),o=a[0].split(","),l=a[1].split(";"),u=0;u<o.length;u++){var h=s.trim(o[u]);if(""!=h){for(var c={},f=0;f<l.length;f++){var d=l[f].indexOf(":"),p=l[f].substr(0,d),m=l[f].substr(d+1,l[f].length-d);null!=p&&null!=m&&(c[s.trim(p)]=new s.Property(s.trim(p),s.trim(m)))}if(s.Styles[h]=c,s.StylesSpecificity[h]=n(h),"@font-face"==h)for(var y=c["font-family"].value.replace(/"/g,""),g=c.src.value.split(","),v=0;v<g.length;v++)if(g[v].indexOf('format("svg")')>0)for(var b=g[v].indexOf("url"),x=g[v].indexOf(")",b),w=g[v].substr(b+5,x-b-6),E=s.parseXml(s.ajax(w)),P=E.getElementsByTagName("font"),C=0;C<P.length;C++){var B=s.CreateElement(P[C]);s.Definitions[y]=B}}}},s.Element.style.prototype=new s.Element.ElementBase,s.Element.use=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)
},this.getBoundingBox=function(){return null!=e?e.getBoundingBox():void 0},this.renderChildren=function(t){if(null!=e){var n=e;"symbol"==e.type&&(n=new s.Element.svg,n.type="svg",n.attributes.viewBox=new s.Property("viewBox",e.attribute("viewBox").value),n.attributes.preserveAspectRatio=new s.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),n.attributes.overflow=new s.Property("overflow",e.attribute("overflow").value),n.children=e.children),"svg"==n.type&&(this.attribute("width").hasValue()&&(n.attributes.width=new s.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(n.attributes.height=new s.Property("height",this.attribute("height").value)));var i=n.parent;n.parent=null,n.render(t),n.parent=i}}},s.Element.use.prototype=new s.Element.RenderedElementBase,s.Element.mask=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y");if(0==r&&0==a){for(var o=new s.BoundingBox,l=0;l<this.children.length;l++)o.addBoundingBox(this.children[l].getBoundingBox());var n=Math.floor(o.x1),i=Math.floor(o.y1),r=Math.floor(o.width()),a=Math.floor(o.height())}var u=e.attribute("mask").value;e.attribute("mask").value="";var h=document.createElement("canvas");h.width=n+r,h.height=i+a;var c=h.getContext("2d");this.renderChildren(c);var f=document.createElement("canvas");f.width=n+r,f.height=i+a;var d=f.getContext("2d");e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=c.createPattern(h,"no-repeat"),d.fillRect(0,0,n+r,i+a),t.fillStyle=d.createPattern(f,"no-repeat"),t.fillRect(0,0,n+r,i+a),e.attribute("mask").value=u},this.render=function(){}},s.Element.mask.prototype=new s.Element.ElementBase,s.Element.clipPath=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;
CanvasRenderingContext2D.prototype.beginPath=function(){};var n=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var i=0;i<this.children.length;i++){var r=this.children[i];if("undefined"!=typeof r.path){var a=null;r.attribute("transform").hasValue()&&(a=new s.Transform(r.attribute("transform").value),a.apply(t)),r.path(t),CanvasRenderingContext2D.prototype.closePath=n,a&&a.unapply(t)}}n.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=n},this.render=function(){}},s.Element.clipPath.prototype=new s.Element.ElementBase,s.Element.filter=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=e.getBoundingBox(),i=Math.floor(n.x1),r=Math.floor(n.y1),a=Math.floor(n.width()),s=Math.floor(n.height()),o=e.style("filter").value;e.style("filter").value="";for(var l=0,u=0,h=0;h<this.children.length;h++){var c=this.children[h].extraFilterDistance||0;l=Math.max(l,c),u=Math.max(u,c)}var f=document.createElement("canvas");f.width=a+2*l,f.height=s+2*u;var d=f.getContext("2d");d.translate(-i+l,-r+u),e.render(d);for(var h=0;h<this.children.length;h++)this.children[h].apply(d,0,0,a+2*l,s+2*u);t.drawImage(f,0,0,a+2*l,s+2*u,i-l,r-u,a+2*l,s+2*u),e.style("filter",!0).value=o},this.render=function(){}},s.Element.filter.prototype=new s.Element.ElementBase,s.Element.feMorphology=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(){}},s.Element.feMorphology.prototype=new s.Element.ElementBase,s.Element.feComposite=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(){}},s.Element.feComposite.prototype=new s.Element.ElementBase,s.Element.feColorMatrix=function(t){function e(t,e,n,i,r,a){return t[n*i*4+4*e+a]}function n(t,e,n,i,r,a,s){t[n*i*4+4*e+a]=s}function i(t,e){var n=r[t];return n*(0>n?e-255:e)}this.base=s.Element.ElementBase,this.base(t);var r=s.ToNumberArray(this.attribute("values").value);
switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var a=r[0];r=[.213+.787*a,.715-.715*a,.072-.072*a,0,0,.213-.213*a,.715+.285*a,.072-.072*a,0,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var o=r[0]*Math.PI/180,l=function(t,e,n){return t+Math.cos(o)*e+Math.sin(o)*n};r=[l(.213,.787,-.213),l(.715,-.715,-.715),l(.072,-.072,.928),0,0,l(.213,-.213,.143),l(.715,.285,.14),l(.072,-.072,-.283),0,0,l(.213,-.213,-.787),l(.715,-.715,.715),l(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(t,r,a,s,o){for(var l=t.getImageData(0,0,s,o),a=0;o>a;a++)for(var r=0;s>r;r++){var u=e(l.data,r,a,s,o,0),h=e(l.data,r,a,s,o,1),c=e(l.data,r,a,s,o,2),f=e(l.data,r,a,s,o,3);n(l.data,r,a,s,o,0,i(0,u)+i(1,h)+i(2,c)+i(3,f)+i(4,1)),n(l.data,r,a,s,o,1,i(5,u)+i(6,h)+i(7,c)+i(8,f)+i(9,1)),n(l.data,r,a,s,o,2,i(10,u)+i(11,h)+i(12,c)+i(13,f)+i(14,1)),n(l.data,r,a,s,o,3,i(15,u)+i(16,h)+i(17,c)+i(18,f)+i(19,1))}t.clearRect(0,0,s,o),t.putImageData(l,0,0)}},s.Element.feColorMatrix.prototype=new s.Element.ElementBase,s.Element.feGaussianBlur=function(t){this.base=s.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,i,r,a){return"undefined"==typeof e.canvasRGBA?void s.log("ERROR: StackBlur.js must be included for blur to work"):(t.canvas.id=s.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas.id,n,i,r,a,this.blurRadius),void document.body.removeChild(t.canvas))}},s.Element.feGaussianBlur.prototype=new s.Element.ElementBase,s.Element.title=function(){},s.Element.title.prototype=new s.Element.ElementBase,s.Element.desc=function(){},s.Element.desc.prototype=new s.Element.ElementBase,s.Element.MISSING=function(t){s.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},s.Element.MISSING.prototype=new s.Element.ElementBase,s.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");
e=e.replace(/\-/g,"");var n=null;return n="undefined"!=typeof s.Element[e]?new s.Element[e](t):new s.Element.MISSING(t),n.type=t.nodeName,n},s.load=function(t,e){s.loadXml(t,s.ajax(e))},s.loadXml=function(t,e){s.loadXmlDoc(t,s.parseXml(e))},s.loadXmlDoc=function(t,e){s.init(t);var n=function(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=s.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=n(new s.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));s.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=n(new s.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));s.Mouse.onmousemove(e.x,e.y)});var i=s.CreateElement(e.documentElement);i.root=!0;var r=!0,a=function(){s.ViewPort.Clear(),t.canvas.parentNode&&s.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=s.opts.ignoreDimensions&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var n=t.canvas.clientWidth||t.canvas.width,a=t.canvas.clientHeight||t.canvas.height;if(1==s.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(n=i.style("width").toPixels("x"),a=i.style("height").toPixels("y")),s.ViewPort.SetCurrent(n,a),null!=s.opts.offsetX&&(i.attribute("x",!0).value=s.opts.offsetX),null!=s.opts.offsetY&&(i.attribute("y",!0).value=s.opts.offsetY),null!=s.opts.scaleWidth||null!=s.opts.scaleHeight){var o=null,l=null,u=s.ToNumberArray(i.attribute("viewBox").value);null!=s.opts.scaleWidth&&(i.attribute("width").hasValue()?o=i.attribute("width").toPixels("x")/s.opts.scaleWidth:isNaN(u[2])||(o=u[2]/s.opts.scaleWidth)),null!=s.opts.scaleHeight&&(i.attribute("height").hasValue()?l=i.attribute("height").toPixels("y")/s.opts.scaleHeight:isNaN(u[3])||(l=u[3]/s.opts.scaleHeight)),null==o&&(o=l),null==l&&(l=o),i.attribute("width",!0).value=s.opts.scaleWidth,i.attribute("height",!0).value=s.opts.scaleHeight,i.attribute("transform",!0).value+=" scale("+1/o+","+1/l+")"
}1!=s.opts.ignoreClear&&t.clearRect(0,0,n,a),i.render(t),r&&(r=!1,"function"==typeof s.opts.renderCallback&&s.opts.renderCallback(e))},o=!0;s.ImagesLoaded()&&(o=!1,a()),s.intervalID=setInterval(function(){var t=!1;if(o&&s.ImagesLoaded()&&(o=!1,t=!0),1!=s.opts.ignoreMouse&&(t|=s.Mouse.hasEvents()),1!=s.opts.ignoreAnimation)for(var e=0;e<s.Animations.length;e++)t|=s.Animations[e].update(1e3/s.FRAMERATE);"function"==typeof s.opts.forceRedraw&&1==s.opts.forceRedraw()&&(t=!0),t&&(a(),s.Mouse.runEvents())},1e3/s.FRAMERATE)},s.stop=function(){s.intervalID&&clearInterval(s.intervalID)},s.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInPath&&e.isPointInPath(i.x,i.y)&&(this.eventElements[n]=t)}},this.checkBoundingBox=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInBox(i.x,i.y)&&(this.eventElements[n]=t)}},this.runEvents=function(){s.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],n=this.eventElements[t];n;)e.run(n),n=n.parent;this.events=[],this.eventElements=[]}},s}var a,s=function(t,e,n){if(null!=t||null!=e||null!=n){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var i=r(n||{});(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=i);var a=t.getContext("2d");"undefined"!=typeof e.documentElement?i.loadXmlDoc(a,e):"<"==e.substr(0,1)?i.loadXml(a,e):i.load(a,e)}else for(var o=document.querySelectorAll("svg"),l=0;l<o.length;l++){var u=o[l],h=document.createElement("canvas");h.width=u.clientWidth,h.height=u.clientHeight,u.parentNode.insertBefore(h,u),u.parentNode.removeChild(u);
var c=document.createElement("div");c.appendChild(u),s(h,c.innerHTML)}};a="undefined"!=typeof Element.prototype.matches?function(t,e){return t.matches(e)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?function(t,e){return t.webkitMatchesSelector(e)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?function(t,e){return t.mozMatchesSelector(e)}:"undefined"!=typeof Element.prototype.msMatchesSelector?function(t,e){return t.msMatchesSelector(e)}:"undefined"!=typeof Element.prototype.oMatchesSelector?function(t,e){return t.oMatchesSelector(e)}:Sizzle.matchesSelector;var o=/(\[[^\]]+\])/g,l=/(#[^\s\+>~\.\[:]+)/g,u=/(\.[^\s\+>~\.\[:]+)/g,h=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:[\w-]+\([^\)]*\))/gi,f=/(:[^\s\+>~\.\[:]+)/g,d=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,n,i,r){s(this.canvas,t,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:n,scaleWidth:i,scaleHeight:r})}),s}),r("../bower_components/FileSaver.js/FileSaver",[],function(){return window.saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in i,a=function(n){var i=e.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)},s=t.webkitRequestFileSystem,o=t.requestFileSystem||s||t.mozRequestFileSystem,l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},u="application/octet-stream",h=0,c=500,f=function(e){var i=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};t.chrome?i():setTimeout(i,c)},d=function(t,e,n){e=[].concat(e);for(var i=e.length;i--;){var r=t["on"+e[i]];if("function"==typeof r)try{r.call(t,n||t)
}catch(a){l(a)}}},p=function(e,l){var c,p,m,y=this,g=e.type,v=!1,b=function(){d(y,"writestart progress write writeend".split(" "))},x=function(){if((v||!c)&&(c=n().createObjectURL(e)),p)p.location.href=c;else{var i=t.open(c,"_blank");void 0==i&&"undefined"!=typeof safari&&(t.location.href=c)}y.readyState=y.DONE,b(),f(c)},w=function(t){return function(){return y.readyState!==y.DONE?t.apply(this,arguments):void 0}},E={create:!0,exclusive:!1};return y.readyState=y.INIT,l||(l="download"),r?(c=n().createObjectURL(e),i.href=c,i.download=l,a(i),y.readyState=y.DONE,b(),void f(c)):(t.chrome&&g&&g!==u&&(m=e.slice||e.webkitSlice,e=m.call(e,0,e.size,u),v=!0),s&&"download"!==l&&(l+=".download"),(g===u||s)&&(p=t),o?(h+=e.size,void o(t.TEMPORARY,h,w(function(t){t.root.getDirectory("saved",E,w(function(t){var n=function(){t.getFile(l,E,w(function(t){t.createWriter(w(function(n){n.onwriteend=function(e){p.location.href=t.toURL(),y.readyState=y.DONE,d(y,"writeend",e),f(t)},n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&x()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=y["on"+t]}),n.write(e),y.abort=function(){n.abort(),y.readyState=y.DONE},y.readyState=y.WRITING}),x)}),x)};t.getFile(l,{create:!1},w(function(t){t.remove(),n()}),w(function(t){t.code===t.NOT_FOUND_ERR?n():x()}))}),x)}),x)):void x())},m=p.prototype,y=function(t,e){return new p(t,e)};return m.abort=function(){var t=this;t.readyState=t.DONE,d(t,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,y}}(window)}),function(){function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function i(){}function a(){return function(){process.nextTick(u)}}function s(){var t=0,e=new L(u),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function o(){var t=new MessageChannel;
return t.port1.onmessage=u,function(){t.port2.postMessage(0)}}function l(){return function(){setTimeout(u,1)}}function u(){for(var t=0;D>t;t+=2){var e=X[t],n=X[t+1];e(n),X[t]=void 0,X[t+1]=void 0}D=0}function h(){}function c(){return new TypeError("You cannot resolve a promise with itself")}function f(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(e){return q.error=e,q}}function p(t,e,n,i){try{t.call(e,n,i)}catch(r){return r}}function m(t,e,n){O(function(t){var i=!1,r=p(n,e,function(n){i||(i=!0,e!==n?v(t,n):x(t,n))},function(e){i||(i=!0,w(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,w(t,r))},t)}function y(t,e){e._state===U?x(t,e._result):t._state===F?w(t,e._result):E(e,void 0,function(e){v(t,e)},function(e){w(t,e)})}function g(t,n){if(n.constructor===t.constructor)y(t,n);else{var i=d(n);i===q?w(t,q.error):void 0===i?x(t,n):e(i)?m(t,n,i):x(t,n)}}function v(e,n){e===n?w(e,c()):t(n)?g(e,n):x(e,n)}function b(t){t._onerror&&t._onerror(t._result),P(t)}function x(t,e){t._state===j&&(t._result=e,t._state=U,0===t._subscribers.length||O(P,t))}function w(t,e){t._state===j&&(t._state=F,t._result=e,O(b,t))}function E(t,e,n,i){var r=t._subscribers,a=r.length;t._onerror=null,r[a]=e,r[a+U]=n,r[a+F]=i,0===a&&t._state&&O(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,r,a=t._result,s=0;s<e.length;s+=3)i=e[s],r=e[s+n],i?T(n,i,r,a):r(a);t._subscribers.length=0}}function C(){this.error=null}function B(t,e){try{return t(e)}catch(n){return H.error=n,H}}function T(t,n,i,r){var a,s,o,l,u=e(i);if(u){if(a=B(i,r),a===H?(l=!0,s=a.error,a=null):o=!0,n===a)return void w(n,f())}else a=r,o=!0;n._state!==j||(u&&o?v(n,a):l?w(n,s):t===U?x(n,a):t===F&&w(n,a))}function k(t,e){try{e(function(e){v(t,e)},function(e){w(t,e)})}catch(n){w(t,n)}}function S(t,e,n,i){this._instanceConstructor=t,this.promise=new t(h,i),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):w(this.promise,this._validationError())
}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function A(t){this._id=Z++,this._state=void 0,this._result=void 0,this._subscribers=[],h!==t&&(e(t)||M(),this instanceof A||V(),k(this,t))}var _;_=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var R,N=_,D=(Date.now||function(){return(new Date).getTime()},Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return i.prototype=t,new i},0),O=function(t,e){X[D]=t,X[D+1]=e,D+=2,2===D&&R()},I="undefined"!=typeof window?window:{},L=I.MutationObserver||I.WebKitMutationObserver,z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=new Array(1e3);R="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?a():L?s():z?o():l();var j=void 0,U=1,F=2,q=new C,H=new C;S.prototype._validateInput=function(t){return N(t)},S.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},S.prototype._init=function(){this._result=new Array(this.length)};var G=S;S.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,i=0;e._state===j&&t>i;i++)this._eachEntry(n[i],i)},S.prototype._eachEntry=function(t,e){var i=this._instanceConstructor;n(t)?t.constructor===i&&t._state!==j?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(i.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(U,e,t))},S.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===j&&(this._remaining--,this._abortOnReject&&t===F?w(i,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&x(i,this._result)
},S.prototype._makeResult=function(t,e,n){return n},S.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){n._settledAt(U,e,t)},function(t){n._settledAt(F,e,t)})};var W=function(t,e){return new G(this,t,!0,e).promise},$=function(t,e){function n(t){v(a,t)}function i(t){w(a,t)}var r=this,a=new r(h,e);if(!N(t))return w(a,new TypeError("You must pass an array to race.")),a;for(var s=t.length,o=0;a._state===j&&s>o;o++)E(r.resolve(t[o]),void 0,n,i);return a},Y=function(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var i=new n(h,e);return v(i,t),i},Q=function(t,e){var n=this,i=new n(h,e);return w(i,t),i},Z=0,J=A;A.all=W,A.race=$,A.resolve=Y,A.reject=Q,A.prototype={constructor:A,then:function(t,e){var n=this,i=n._state;if(i===U&&!t||i===F&&!e)return this;var r=new this.constructor(h),a=n._result;if(i){var s=arguments[i-1];O(function(){T(i,r,s,a)})}else E(n,r,t,e);return r},"catch":function(t){return this.then(null,t)}};var K=function(){var t;t="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var n;return new t.Promise(function(t){n=t}),e(n)}();n||(t.Promise=J)},te={Promise:J,polyfill:K};"function"==typeof r&&r.amd?r("../bower_components/es6-promise/promise",[],function(){return te}):"undefined"!=typeof module&&module.exports?module.exports=te:"undefined"!=typeof this&&(this.ES6Promise=te)}.call(this),r("../node_modules/requirejs-text/text",["module"],function(t){var e,i,r,a,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,c=h&&location.protocol&&location.protocol.replace(/\:/,""),f=h&&location.hostname,d=h&&(location.port||void 0),p={},m=t.config&&t.config()||{};return e={version:"2.0.12",strip:function(t){if(t){t=t.replace(l,"");
var e=t.match(u);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){n=o[e];try{t=new ActiveXObject(n)}catch(i){}if(t){o=[n];break}}return t},parseName:function(t){var e,n,i,r=!1,a=t.indexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!s||a>1)?(e=t.substring(0,a),n=t.substring(a+1,t.length)):e=t,i=n||e,a=i.indexOf("!"),-1!==a&&(r="strip"===i.substring(a+1),i=i.substring(0,a),n?n=i:e=i),{moduleName:e,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,n,i,r){var a,s,o,l=e.xdRegExp.exec(t);return l?(a=l[2],s=l[3],s=s.split(":"),o=s[1],s=s[0],!(a&&a!==n||s&&s.toLowerCase()!==i.toLowerCase()||(o||s)&&o!==r)):!0},finishLoad:function(t,n,i,r){i=n?e.strip(i):i,m.isBuild&&(p[t]=i),r(i)},load:function(t,n,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();m.isBuild=r&&r.isBuild;var a=e.parseName(t),s=a.moduleName+(a.ext?"."+a.ext:""),o=n.toUrl(s),l=m.useXhr||e.useXhr;return 0===o.indexOf("empty:")?void i():void(!h||l(o,c,f,d)?e.get(o,function(n){e.finishLoad(t,a.strip,n,i)},function(t){i.error&&i.error(t)}):n([s],function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,i)}))},write:function(t,n,i){if(p.hasOwnProperty(n)){var r=e.jsEscape(p[n]);i.asModule(t+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,n,i,r,a){var s=e.parseName(n),o=s.ext?"."+s.ext:"",l=s.moduleName+o,u=i.toUrl(s.moduleName+o)+".js";e.load(l,i,function(){var n=function(t){return r(u,t)};n.asModule=function(t,e){return r.asModule(t,u,e)},e.write(t,l,n,a)},a)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=n.nodeRequire("fs"),e.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");
0===r.indexOf("﻿")&&(r=r.substring(1)),e(r)}catch(a){n&&n(a)}}):"xhr"===m.env||!m.env&&e.createXhr()?e.get=function(t,n,i,r){var a,s=e.createXhr();if(s.open("GET",t,!0),r)for(a in r)r.hasOwnProperty(a)&&s.setRequestHeader(a.toLowerCase(),r[a]);m.onXhr&&m.onXhr(s,t),s.onreadystatechange=function(){var e,r;4===s.readyState&&(e=s.status||0,e>399&&600>e?(r=new Error(t+" HTTP status: "+e),r.xhr=s,i&&i(r)):n(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,t))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var n,i,r="utf-8",a=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),r)),l="";try{for(n=new java.lang.StringBuffer,i=o.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=o.readLine());)n.append(s),n.append(i);l=String(n.toString())}finally{o.close()}e(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,e.get=function(t,e){var n,i,o,l={};s&&(t=t.replace(/\//g,"\\")),o=new FileUtils.File(t);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),n.init(o,1,0,!1),i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),i.init(n,"utf-8",n.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),l),i.close(),n.close(),e(l.value)}catch(u){throw new Error((o&&o.path||"")+": "+u)}}),e}),r("../node_modules/requirejs-text/text!print.style.css",[],function(){return"body > * {\r\n    visibility: hidden;\r\n}\r\nbody {\r\n    overflow: hidden;\r\n}\r\nbody * {\r\n    visibility: hidden !important;\r\n}\r\n\r\n.graphical-report__print-block {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    visibility: visible !important;\r\n    display: block !important;\r\n    width: 100%;\r\n    /*height: 100%;*/\r\n}\r\n"
}),function(){function t(e){this.map={};var n=this;e instanceof t?e.forEach(function(t,e){e.forEach(function(e){n.append(t,e)})}):e&&Object.getOwnPropertyNames(e).forEach(function(t){n.append(t,e[t])})}function e(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function n(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function i(t){var e=new FileReader;return e.readAsArrayBuffer(t),n(e)}function r(t){var e=new FileReader;return e.readAsText(t),n(e)}function a(){return this.bodyUsed=!1,c?(this.blob=function(){var t=e(this);return t?t:Promise.resolve(this._bodyBlob)},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){return this.blob().then(r)}):this.text=function(){var t=e(this);return t?t:Promise.resolve(this._bodyText)},"FormData"in self&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function s(t){var e=t.toUpperCase();return f.indexOf(e)>-1?e:t}function o(e,n){n=n||{},this.url=e,this._body=n.body,this.credentials=n.credentials||"omit",this.headers=new t(n.headers),this.method=s(n.method||"GET"),this.mode=n.mode||null,this.referrer=null}function l(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function u(e){var n=new t,i=e.getAllResponseHeaders().trim().split("\n");return i.forEach(function(t){var e=t.trim().split(":"),i=e.shift().trim(),r=e.join(":").trim();n.append(i,r)}),n}function h(t,e){e||(e={}),c?this._bodyBlob="string"==typeof t?new Blob([t]):t:this._bodyText=t,this.type="default",this.url=null,this.status=e.status,this.statusText=e.statusText,this.headers=e.headers,this.url=e.url||""}if(!self.fetch){t.prototype.append=function(t,e){t=t.toLowerCase();var n=this.map[t];n||(n=[],this.map[t]=n),n.push(e)},t.prototype["delete"]=function(t){delete this.map[t.toLowerCase()]
},t.prototype.get=function(t){var e=this.map[t.toLowerCase()];return e?e[0]:null},t.prototype.getAll=function(t){return this.map[t.toLowerCase()]||[]},t.prototype.has=function(t){return this.map.hasOwnProperty(t.toLowerCase())},t.prototype.set=function(t,e){this.map[t.toLowerCase()]=[e]},t.prototype.forEach=function(t){var e=this;Object.getOwnPropertyNames(this.map).forEach(function(n){t(n,e.map[n])})};var c="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];o.prototype.fetch=function(){var t=this;return new Promise(function(e,n){function i(){return"responseURL"in r?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):void 0}var r=new XMLHttpRequest;r.onload=function(){var t=1223===r.status?204:r.status;if(100>t||t>599)return void n(new TypeError("Network request failed"));var a={status:t,statusText:r.statusText,headers:u(r),url:i()},s="response"in r?r.response:r.responseText;e(new h(s,a))},r.onerror=function(){n(new TypeError("Network request failed"))},r.open(t.method,t.url),"responseType"in r&&c&&(r.responseType="blob"),t.headers.forEach(function(t,e){e.forEach(function(e){r.setRequestHeader(t,e)})}),r.send(void 0===t._body?null:t._body)})},a.call(o.prototype),a.call(h.prototype),self.Headers=t,self.Request=o,self.Response=h,self.fetch=function(t,e){return new o(t,e).fetch()},self.fetch.polyfill=!0}}(),r("../bower_components/fetch/fetch",function(){}),function(t){"function"==typeof r&&r.amd?r("export",["tauCharts","canvg","FileSaver","promise","print.style.css","fetch"],function(e,n,i,r,a){return window.Promise=window.Promise||r.Promise,t(e,n,i,window.Promise,a)}):t(this.tauCharts,this.canvg,this.saveAs)}(function(t,e,n,i,r){function a(t){return Math.log(t)/Math.LN10}function s(r){return{_createDataUrl:function(t){var n=this._cssPaths.map(function(t){return fetch(t).then(function(t){return t.text()})});return i.all(n).then(function(t){return t.join(" ")
}).then(function(n){var i=d(n),r=document.createElement("div"),a=t.getSVG().cloneNode(!0);r.appendChild(a),l.select(a).attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg"),a.insertBefore(i,a.firstChild),this._renderAdditionalInfo(a,t);var s=document.createElement("canvas");return s.height=a.getAttribute("height"),s.width=a.getAttribute("width"),e(s,a.parentNode.innerHTML),s.toDataURL("image/png")}.bind(this))},_findUnit:function(t){var e=t.getConfig();return h(e.spec.unit,function(t){return t.color||t.size&&"measure"===e.dimensions[t.size].type})},_toPng:function(t){this._createDataUrl(t).then(function(t){for(var e=atob(t.substring("data:image/png;base64,".length)),i=new Uint8Array(e.length),r=0,a=e.length;a>r;++r)i[r]=e.charCodeAt(r);var s=new Blob([i.buffer],{type:"image/png"});n(s,(this._fileName||"export")+".png")}.bind(this))},_toPrint:function(t){this._createDataUrl(t).then(function(t){o=document.createElement("img"),o.classList.add("graphical-report__print-block");var e=o;document.body.appendChild(e),e.src=t,document.head.appendChild(p),e.onload=function(){window.print()}})},_renderColorLegend:function(t,e,n,i){t.guide=t.guide||{},t.guide.color=this._unit.guide.color;var a=t.guide.color.label.text||this._unit.options.color.dimension,s=this._getColorMap(n),o=function(){this.attr("transform",function(t,e){return"translate(5,"+20*(e+1)+")"}),this.append("circle").attr("r",6).attr("class",function(t){return t.color}),this.append("text").attr("x",12).attr("y",5).text(function(t){return t.value}).style({"font-size":r.fontSize+"px"})},l=e.append("g").attr("class","legend").attr("transform","translate("+(i+10)+","+r.paddingTop+")");return l.append("text").text(a.toUpperCase()).style({"text-transform":"uppercase","font-weight":"600","font-size":r.fontSize+"px"}),l.selectAll("g").data(s).enter().append("g").call(o),{h:20*s.length+20,w:0}},_renderSizeLegend:function(t,e,n,i,s){var o=this._unit.options.sizeScale,l=this._unit.size.scaleDim;t.guide=t.guide||{},t.guide.size=this._unit.guide.size;
var h,f=t.guide.size.label.text||l,d=u.sortBy(n.getData(),function(t){return o(t[l])}),p=d.length,m=d[0][l],y=d[p-1][l];if(y-m){var g=a(y-m),v=0>4-g?0:Math.round(4-g),b=Math.pow(10,v),x=(y-m)/5;h=u([m,m+x,m+2*x,m+3*x,y]).chain().map(function(t){return t===y||t===m?t:Math.round(t*b)/b}).unique().value()}else h=[m];var w=h.map(function(e){var n=o(e);return{diameter:c(2*n+2),radius:n,value:e,className:t.color?"color-definite":""}}.bind(this)).reverse(),E=Math.max.apply(null,u.pluck(w,"diameter")),P=r.fontSize,C=0,B=function(){this.attr("transform",function(){C+=E;var t="translate(5,"+C+")";return C+=10,t}),this.append("circle").attr("r",function(t){return t.radius}).attr("class",function(t){return t.className}).style({opacity:.4}),this.append("g").attr("transform",function(){return"translate("+E+","+P/2+")"}).append("text").attr("x",function(){return 0}).attr("y",function(){return 0}).text(function(t){return t.value}).style({"font-size":P+"px"})},T=e.append("g").attr("class","legend").attr("transform","translate("+(i+10)+","+(r.paddingTop+s.h+20)+")");T.append("text").text(f.toUpperCase()).style({"text-transform":"uppercase","font-weight":"600","font-size":P+"px"}),T.selectAll("g").data(w).enter().append("g").call(B)},_renderAdditionalInfo:function(t,e){var n=this._findUnit(e);if(n){var i={h:0,w:0};t=l.select(t);{var r=parseInt(t.attr("width"),10);t.attr("height")}if(t.attr("width",r+160),n.color){var a=this._renderColorLegend(n,t,e,r);i.h=a.h,i.w=a.w}n.size&&"measure"===e.getConfig().spec.dimensions[n.size].type&&this._renderSizeLegend(n,t,e,r,i)}},onUnitReady:function(t,e){-1!==e.type.indexOf("ELEMENT")&&(this._unit=e)},_getColorMap:function(t){var e=this._unit.options.color,n=this._unit.color.scaleDim,i=t.getData();return u(i).chain().map(function(t){return e.legend(t[n])}).uniq(function(t){return t.value}).value().reduce(function(t,e){return t.push(e),t},[])},_select:function(t,e){t=t||"";var n=this["_to"+t.charAt(0).toUpperCase()+t.slice(1)];n&&n.call(this,e)},_handleMenu:function(t,e,n){t.addEventListener("click",function(t){if("a"===t.target.tagName.toLowerCase()){var i=t.target.getAttribute("data-value");
this._select(i,e),n.hide()}}.bind(this)),t.addEventListener("mouseover",function(t){"a"===t.target.tagName.toLowerCase()&&t.target.focus()}.bind(this)),t.addEventListener("keydown",function(t){if(t.keyCode===f.ESCAPE&&n.hide(),t.keyCode===f.DOWN&&(t.target.parentNode.nextSibling?t.target.parentNode.nextSibling.childNodes[0].focus():t.target.parentNode.parentNode.firstChild.childNodes[0].focus()),t.keyCode===f.UP&&(t.target.parentNode.previousSibling?t.target.parentNode.previousSibling.childNodes[0].focus():t.target.parentNode.parentNode.lastChild.childNodes[0].focus()),t.keyCode===f.ENTER){var i=t.target.getAttribute("data-value");this._select(i,e)}t.preventDefault()}.bind(this));var i=null,r=v(),a=r?"focusin":"focus",s=r?"focusout":"blur";t.addEventListener(s,function(){i=setTimeout(function(){n.hide()},100)},!r),t.addEventListener(a,function(){clearTimeout(i)},!r),this._container.addEventListener("click",function(){n.toggle(),n.hidden||t.querySelectorAll("a")[0].focus()})},init:function(e){r=r||{},this._cssPaths=r.cssPaths,this._fileName=r.fileName,this._cssPaths||(this._cssPaths=[],t.api.globalSettings.log("You should specified cssPath for correct work export plugin","warn")),r=u.defaults(r,{fontSize:13,paddingTop:30}),this._container=e.insertToHeader('<a class="graphical-report__export">Export</a>>');var n=e.addBalloon({place:"bottom-left"});this._popup=n,n.content(['<ul class="graphical-report__export__list">','<li class="graphical-report__export__item"><a href="#" data-value="print" tabindex="1">Print</a></li>','<li class="graphical-report__export__item"><a href="#" data-value="png" tabindex="2">Export to png</a></li>',"</ul>"].join("")),n.attach(this._container);var i=n.getElement();i.setAttribute("tabindex","-1"),this._handleMenu(i,e,n),e.on("exportTo",function(t,e){this._select(e,t)}.bind(this))},destroy:function(){this._popup&&this._popup.destroy()}}}var o,l=t.api.d3,u=t.api._,h=function(t,e){if(e(t))return t;var n,i,r,a=t.unit||[];for(n=0;n<a.length;n+=1)if(i=a[n],r=h(i,e))return r
},c=function(t){return t=Math.round(t),t%2?t+1:t},f={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},d=function(t,e){e=e||"all";var n=document.createElement("style");return n.setAttribute("media",e),n.innerHTML=t,n},p=d(r,"print"),m=function(){p.parentNode&&p.parentNode.removeChild(p),o.parentNode&&o.parentNode.removeChild(o)},y=/PhantomJS/.test(navigator.userAgent);y||("onafterprint"in window?window.addEventListener("afterprint",m):window.matchMedia("screen").addListener(function(t){t.matches&&m()}));var g,v=function(){function t(){e=!0}if(g)return g;var e=!1,n=document.createElement("a");return n.href="#",n.addEventListener("focusin",t,!1),document.body.appendChild(n),n.focus(),document.body.removeChild(n),g=e,e};return t.api.plugins.add("exportTo",s),s}),r("tauCharts",function(){return t}),n.config({map:{"*":{canvg:"../bower_components/canvg/canvg",FileSaver:"../bower_components/FileSaver.js/FileSaver",rgbcolor:"../bower_components/canvg/rgbcolor",stackblur:"../bower_components/canvg/StackBlur",fetch:"../bower_components/fetch/fetch",promise:"../bower_components/es6-promise/promise","print.style.css":"../node_modules/requirejs-text/text!print.style.css"}}}),n("export")});