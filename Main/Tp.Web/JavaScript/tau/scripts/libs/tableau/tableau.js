!function(){function e(e){if(e.__basePrototypePending){var t=e.__baseType;t.__basePrototypePending&&t.__setupBase();for(var i in t.prototype){var n=t.prototype[i];e.prototype[i]||(e.prototype[i]=n)}delete e.__basePrototypePending,delete e.__setupBase}}function t(e,t,i){e.__basePrototypePending&&e.__setupBase(),i?e.__baseType.apply(t,i):e.__baseType.apply(t)}function i(e,t,i,n){var r=e.__baseType.prototype[i];return n?r.apply(t,n):r.apply(t)}function n(){for(var e in o)if(o.hasOwnProperty(e)){var t=o[e],i=t.isPrototype?a.prototype:a;t.func?i[e]=t.func:delete i[e]}}var r={version:"0.7.4.0",isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null===e||void 0===e},isValue:function(e){return null!==e&&void 0!==e}};Object.keys||(Object.keys=function(e){var t=[];for(var i in e)t.push(i);return t});var a=Function,o={registerNamespace:{isPrototype:!1,func:a.registerNamespace},registerInterface:{isPrototype:!0,func:a.prototype.registerInterface},registerClass:{isPrototype:!0,func:a.prototype.registerClass},registerEnum:{isPrototype:!0,func:a.prototype.registerEnum}},s={};a.registerNamespace=function(e){"tableauSoftware"===e&&(window.tableauSoftware=window.tableau=window.tableauSoftware||{})},a.prototype.registerInterface=function(){},a.prototype.registerEnum=function(){for(var e in this.prototype)this[e]=this.prototype[e]},a.prototype.registerClass=function(n,r){var a=this;this.prototype.constructor=this,this.__baseType=r||Object,r&&(this.__basePrototypePending=!0,this.__setupBase=function(){e(a)},this.initializeBase=function(e,i){t(a,e,i)},this.callBaseMethod=function(e,t,n){i(a,e,t,n)})},r.Delegate=function(){},r.Delegate.registerClass("Delegate"),r.Delegate.empty=function(){},r.Delegate._contains=function(e,t,i){for(var n=0;n<e.length;n+=2)if(e[n]===t&&e[n+1]===i)return!0;return!1},r.Delegate._create=function(e){var t=function(){if(2==e.length)return e[1].apply(e[0],arguments);for(var t=e.concat(),i=0;i<t.length;i+=2)r.Delegate._contains(e,t[i],t[i+1])&&t[i+1].apply(t[i],arguments);
return null};return t._targets=e,t},r.Delegate.create=function(e,t){return e?r.Delegate._create([e,t]):t},r.Delegate.combine=function(e,t){if(!e)return t._targets?t:r.Delegate.create(null,t);if(!t)return e._targets?e:r.Delegate.create(null,e);var i=e._targets?e._targets:[null,e],n=t._targets?t._targets:[null,t];return r.Delegate._create(i.concat(n))},r.Delegate.remove=function(e,t){if(!e||e===t)return null;if(!t)return e;var i,n=e._targets,a=null;t._targets?(a=t._targets[0],i=t._targets[1]):i=t;for(var o=0;o<n.length;o+=2)if(n[o]===a&&n[o+1]===i)return 2==n.length?null:(n.splice(o,2),r.Delegate._create(n));return e},r.IEnumerator=function(){},r.IEnumerator.prototype={get_current:null,moveNext:null,reset:null},r.IEnumerator.getEnumerator=function(e){return e?e.getEnumerator?e.getEnumerator():new r.ArrayEnumerator(e):null},r.IEnumerable=function(){},r.IEnumerable.prototype={getEnumerator:null},r.ArrayEnumerator=function(e){this._array=e,this._index=-1,this.current=null},r.ArrayEnumerator.prototype={moveNext:function(){return this._index++,this.current=this._array[this._index],this._index<this._array.length},reset:function(){this._index=-1,this.current=null}},r.IDisposable=function(){},r.IDisposable.prototype={dispose:null},r.StringBuilder=function(e){this._parts=r.isNullOrUndefined(e)?[]:[e],this.isEmpty=0==this._parts.length},r.StringBuilder.prototype={append:function(e){return r.isNullOrUndefined(e)||(this._parts.push(e),this.isEmpty=!1),this},appendLine:function(e){return this.append(e),this.append("\r\n"),this.isEmpty=!1,this},clear:function(){this._parts=[],this.isEmpty=!0},toString:function(e){return this._parts.join(e||"")}},r.StringBuilder.registerClass("StringBuilder"),r.EventArgs=function(){},r.EventArgs.registerClass("EventArgs"),r.EventArgs.Empty=new r.EventArgs,r.CancelEventArgs=function(){r.CancelEventArgs.initializeBase(this),this.cancel=!1},r.CancelEventArgs.registerClass("CancelEventArgs",r.EventArgs),r.Tuple=function(e,t,i){this.first=e,this.second=t,3==arguments.length&&(this.third=i)
},r.Tuple.registerClass("Tuple"),a.registerNamespace("tab"),s.EscapingUtil=function(){},s.EscapingUtil.escapeHtml=function(e){var t=e||"";return t=t.replace(new RegExp("&","g"),"&amp;"),t=t.replace(new RegExp("<","g"),"&lt;"),t=t.replace(new RegExp(">","g"),"&gt;"),t=t.replace(new RegExp('"',"g"),"&quot;"),t=t.replace(new RegExp("'","g"),"&#39;"),t=t.replace(new RegExp("/","g"),"&#47;")},s.WindowHelper=function(e){this.$C=e},s.WindowHelper.get_windowSelf=function(){return window.self},s.WindowHelper.close=function(e){e.close()},s.WindowHelper.getOpener=function(e){return e.opener},s.WindowHelper.getLocation=function(e){return e.location},s.WindowHelper.getPathAndSearch=function(e){return e.location.pathname+e.location.search},s.WindowHelper.setLocationHref=function(e,t){e.location.href=t},s.WindowHelper.locationReplace=function(e,t){e.location.replace(t)},s.WindowHelper.open=function(e,t,i){return window.open(e,t,i)},s.WindowHelper.reload=function(e,t){e.location.reload(t)},s.WindowHelper.requestAnimationFrame=function(e){return s.WindowHelper.$A(e)},s.WindowHelper.cancelAnimationFrame=function(e){r.isValue(e)&&s.WindowHelper.$B(e)},s.WindowHelper.$D=function(){var e=0;s.WindowHelper.$A=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e));e=i+n;var r=window.setTimeout(function(){t()},n);return r}},s.WindowHelper.prototype={$C:null,get_pageXOffset:function(){return s.WindowHelper.$4(this.$C)},get_pageYOffset:function(){return s.WindowHelper.$5(this.$C)},get_clientWidth:function(){return s.WindowHelper.$2(this.$C)},get_clientHeight:function(){return s.WindowHelper.$3(this.$C)},get_innerWidth:function(){return s.WindowHelper.$0(this.$C)},get_outerWidth:function(){return s.WindowHelper.$8(this.$C)},get_innerHeight:function(){return s.WindowHelper.$1(this.$C)},get_outerHeight:function(){return s.WindowHelper.$9(this.$C)},get_screenLeft:function(){return s.WindowHelper.$6(this.$C)},get_screenTop:function(){return s.WindowHelper.$7(this.$C)}},s.EscapingUtil.registerClass("tab.EscapingUtil"),s.WindowHelper.registerClass("tab.WindowHelper"),s.WindowHelper.$0=null,s.WindowHelper.$1=null,s.WindowHelper.$2=null,s.WindowHelper.$3=null,s.WindowHelper.$4=null,s.WindowHelper.$5=null,s.WindowHelper.$6=null,s.WindowHelper.$7=null,s.WindowHelper.$8=null,s.WindowHelper.$9=null,s.WindowHelper.$A=null,s.WindowHelper.$B=null,function(){s.WindowHelper.$0="innerWidth"in window?function(e){return e.innerWidth
}:function(e){return e.document.documentElement.offsetWidth},s.WindowHelper.$8="outerWidth"in window?function(e){return e.outerWidth}:s.WindowHelper.$0,s.WindowHelper.$1="innerHeight"in window?function(e){return e.innerHeight}:function(e){return e.document.documentElement.offsetHeight},s.WindowHelper.$9="outerHeight"in window?function(e){return e.outerHeight}:s.WindowHelper.$1,s.WindowHelper.$2="clientWidth"in window?function(e){return e.clientWidth}:function(e){return e.document.documentElement.clientWidth},s.WindowHelper.$3="clientHeight"in window?function(e){return e.clientHeight}:function(e){return e.document.documentElement.clientHeight},s.WindowHelper.$4=r.isValue(window.self.pageXOffset)?function(e){return e.pageXOffset}:function(e){return e.document.documentElement.scrollLeft},s.WindowHelper.$5=r.isValue(window.self.pageYOffset)?function(e){return e.pageYOffset}:function(e){return e.document.documentElement.scrollTop},s.WindowHelper.$6="screenLeft"in window?function(e){return e.screenLeft}:function(e){return e.screenX},s.WindowHelper.$7="screenTop"in window?function(e){return e.screenTop}:function(e){return e.screenY};var e="requestAnimationFrame",t="cancelAnimationFrame",i=["ms","moz","webkit","o"],n=null,a=null;e in window&&(n=e),t in window&&(a=t);for(var o=0;o<i.length&&(null==n||null==a);++o){var l=i[o],u=l+"RequestAnimationFrame";null==n&&u in window&&(n=u),null==a&&(u=l+"CancelAnimationFrame",u in window&&(a=u),u=l+"CancelRequestAnimationFrame",u in window&&(a=u))}null!=n?s.WindowHelper.$A=function(e){return window[n](e)}:s.WindowHelper.$D(),s.WindowHelper.$B=null!=a?function(e){window[a](e)}:function(e){window.clearTimeout(e)}}(),a.registerNamespace("tab"),s.$create__SheetInfoImpl=function(e,t,i,n,r,a,o,s,l){var u={};return u.name=e,u.sheetType=t,u.index=i,u.size=n,u.workbook=r,u.url=a,u.isActive=o,u.isHidden=s,u.zoneId=l,u},s.$create_JavaScriptApi$0=function(e,t,i,n,r){var a={};return a.$1=e,a.$0=t,a.$2=i,a.$3=n,a.$4=r,a},s.$create__StoryPointInfoImpl=function(e,t,i,n,r,a){var o={};
return o.caption=e,o.index=t,o.storyPointId=i,o.isActive=n,o.isUpdated=r,o.parentStoryImpl=a,o},s._ApiCommand=function(e,t,i,n){this.$0=e,this.$2=t,this.$1=i,this.$3=n},s._ApiCommand.parse=function(e){var t,i=e.indexOf(",");if(0>i)return t=e,new s._ApiCommand(t,null,null,null);t=e.substr(0,i);var n,r=e.substr(i+1);if(i=r.indexOf(","),0>i)return n=r,new s._ApiCommand(t,n,null,null);n=r.substr(0,i);var a,o=r.substr(i+1);if(i=o.indexOf(","),0>i)return a=o,new s._ApiCommand(t,n,a,null);a=o.substr(0,i);var l=o.substr(i+1);return new s._ApiCommand(t,n,a,l)},s._ApiCommand.prototype={$0:null,$1:null,$2:null,$3:null,get_name:function(){return this.$0},get_handlerId:function(){return this.$1},get_sourceId:function(){return this.$2},get_parameters:function(){return this.$3},get_isApiCommandName:function(){return!this.get_rawName().indexOf("api.",0)},get_rawName:function(){return this.$0},serialize:function(){var e=[];e.push(this.$0),e.push(this.$2),e.push(this.$1),r.isValue(this.$3)&&e.push(this.$3);var t=e.join(",");return t}},s._ApiServerResultParser=function(e){var t=JSON.parse(e);this.$0=t["api.commandResult"],this.$1=t["api.commandData"]},s._ApiServerResultParser.prototype={$0:null,$1:null,get_result:function(){return this.$0},get_data:function(){return this.$1}},s._ApiServerNotification=function(e,t,i){this.$0=e,this.$1=t,this.$2=i},s._ApiServerNotification.deserialize=function(e){var t=JSON.parse(e),i=t["api.workbookName"],n=t["api.worksheetName"],r=t["api.commandData"];return new s._ApiServerNotification(i,n,r)},s._ApiServerNotification.prototype={$0:null,$1:null,$2:null,get_workbookName:function(){return this.$0},get_worksheetName:function(){return this.$1},get_data:function(){return this.$2},serialize:function(){var e={};return e["api.workbookName"]=this.$0,e["api.worksheetName"]=this.$1,e["api.commandData"]=this.$2,JSON.stringify(e)}},s._CommandReturnHandler=function(e,t,i,n){this.$0=e,this.$2=i,this.$1=t,this.$3=n},s._CommandReturnHandler.prototype={$0:null,$1:0,$2:null,$3:null,get_commandName:function(){return this.$0
},get_successCallback:function(){return this.$2},get_successCallbackTiming:function(){return this.$1},get_errorCallback:function(){return this.$3}},s.JavaScriptApi$1=function(){this.$2={},this.$3={},this.$4={},this.$5={},s._Utility.hasWindowAddEventListener()?window.addEventListener("message",this.$8(),!1):s._Utility.hasDocumentAttachEvent()?(document.attachEvent("onmessage",this.$8()),window.attachEvent("onmessage",this.$8())):window.onmessage=this.$8(),this.$0=this.$1=0},s.JavaScriptApi$1.prototype={$0:0,$1:0,registerHandler:function(e){var t="handler"+this.$0;if(r.isValue(e.get_handlerId())||r.isValue(this.$2[e.get_handlerId()]))throw s._TableauException.createInternalError("Handler '"+e.get_handlerId()+"' is already registered.");this.$0++,e.set_handlerId(t),this.$2[t]=e,e.add_customViewsListLoad(r.Delegate.create(this,this.$6)),e.add_stateReadyForQuery(r.Delegate.create(this,this.$7))},unregisterHandler:function(e){(r.isValue(e.get_handlerId())||r.isValue(this.$2[e.get_handlerId()]))&&(delete this.$2[e.get_handlerId()],e.remove_customViewsListLoad(r.Delegate.create(this,this.$6)),e.remove_stateReadyForQuery(r.Delegate.create(this,this.$7)))},sendCommand:function(e,t,i){var n=e.get_iframe(),a=e.get_handlerId();if(s._Utility.hasWindowPostMessage()&&!r.isNullOrUndefined(n)&&!r.isNullOrUndefined(n.contentWindow)){var o="cmd"+this.$1;this.$1++;var l=this.$3[a];r.isNullOrUndefined(l)&&(l={},this.$3[a]=l),l[o]=i;var u=i.get_commandName();if("api.ShowCustomViewCommand"===u){var h=this.$4[a];r.isNullOrUndefined(h)&&(h={},this.$4[a]=h),h[o]=i}var c=null;r.isValue(t)&&(c=s.JsonUtil.toJson(t,!1,""));var p=new s._ApiCommand(u,o,a,c),f=p.serialize();s._Utility.isPostMessageSynchronous()?window.setTimeout(function(){n.contentWindow.postMessage(f,e.get_serverRoot())},0):n.contentWindow.postMessage(f,e.get_serverRoot())}},$6:function(e){var t=e.get_handlerId(),i=this.$4[t];if(!r.isNullOrUndefined(i)){var n=i;for(var a in n){var o={key:a,value:n[a]},s=o.value;r.isValue(s.get_successCallback())&&s.get_successCallback()(null)
}delete this.$4[t]}},$7:function(e){var t=this.$5[e.get_handlerId()];if(!s._Utility.isNullOrEmpty(t))for(;t.length>0;){var i=t.pop();r.isValue(i)&&i()}},$8:function(){return r.Delegate.create(this,function(e){this.$9(e)})},$9:function(e){if(!r.isNullOrUndefined(e.data)){var t=s._ApiCommand.parse(e.data),i=t.get_rawName(),n=t.get_handlerId(),a=this.$2[n];(r.isNullOrUndefined(a)||a.get_handlerId()!==t.get_handlerId())&&(a=new s.JavaScriptApi$2),t.get_isApiCommandName()?"xdomainSourceId"===t.get_sourceId()?(a.handleEventNotification(t.get_name(),t.get_parameters()),"api.FirstVizSizeKnownEvent"===t.get_name()&&e.source.postMessage("tableau.bootstrap","*")):this.$A(t):this.$B(i,e,a)}},$A:function(e){var t=this.$3[e.get_handlerId()],i=r.isValue(t)?t[e.get_sourceId()]:null;if(!r.isNullOrUndefined(i)&&(delete t[e.get_sourceId()],e.get_name()===i.get_commandName())){var n=new s._ApiServerResultParser(e.get_parameters()),a=n.get_data();if("api.success"===n.get_result())switch(i.get_successCallbackTiming()){case 0:r.isValue(i.get_successCallback())&&i.get_successCallback()(a);break;case 1:var o=function(){r.isValue(i.get_successCallback())&&i.get_successCallback()(a)},l=this.$5[e.get_handlerId()];r.isNullOrUndefined(l)&&(l=[],this.$5[e.get_handlerId()]=l),l.push(o);break;default:throw s._TableauException.createInternalError("Unknown timing value: "+i.get_successCallbackTiming())}else if(r.isValue(i.get_errorCallback())){var u="api.remotefailed"===n.get_result();i.get_errorCallback()(u,a)}}},$B:function(e,t,i){"layoutInfoReq"===e?(s._VizManagerImpl.$4(),this.$C(t.source)):("tableau.completed"===e||"completed"===e)&&i.handleVizLoad()},$C:function(e){if(s._Utility.hasWindowPostMessage()){var t=new s.WindowHelper(window.self),i=r.isValue(t.get_innerWidth())?t.get_innerWidth():document.documentElement.offsetWidth,n=r.isValue(t.get_innerHeight())?t.get_innerHeight():document.documentElement.offsetHeight,a=r.isValue(t.get_pageXOffset())?t.get_pageXOffset():document.documentElement.scrollLeft,o=r.isValue(t.get_pageYOffset())?t.get_pageYOffset():document.documentElement.scrollTop,l=[];
l.push("layoutInfoResp"),l.push(a),l.push(o),l.push(i),l.push(n),e.postMessage(l.join(","),"*")}}},s.JavaScriptApi$2=function(){},s.JavaScriptApi$2.prototype={$0:null,add_customViewsListLoad:function(e){this.$1=r.Delegate.combine(this.$1,e)},remove_customViewsListLoad:function(e){this.$1=r.Delegate.remove(this.$1,e)},$1:null,add_stateReadyForQuery:function(e){this.$2=r.Delegate.combine(this.$2,e)},remove_stateReadyForQuery:function(e){this.$2=r.Delegate.remove(this.$2,e)},$2:null,get_iframe:function(){return null},get_handlerId:function(){return this.$0},set_handlerId:function(e){return this.$0=e,e},get_serverRoot:function(){return"*"},handleVizLoad:function(){},handleEventNotification:function(){},$3:function(){this.$1(null),this.$2(null)}},s.CrossDomainMessagingOptions=function(e,t){s._Param.verifyValue(e,"router"),s._Param.verifyValue(t,"handler"),this.$0=e,this.$1=t},s.CrossDomainMessagingOptions.prototype={$0:null,$1:null,get_router:function(){return this.$0},get_handler:function(){return this.$1},sendCommand:function(e,t){this.$0.sendCommand(this.$1,e,t)}},s._Enums=function(){},s._Enums.$0=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.PeriodType,!0)},s._Enums.$1=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.DateRangeType,!0)},s._Enums.$2=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.FilterUpdateType,!0)},s._Enums.$3=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.SelectionUpdateType,!0)},s._Enums.$4=function(e){var t=r.isValue(e)?e.toString():"";return null!=s._Enums.$8(t,"",tableauSoftware.SelectionUpdateType,!1)},s._Enums.$5=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.NullOption,!0)},s._Enums.$6=function(e,t){var i=r.isValue(e)?e:"";return s._Enums.$8(i,t,tableauSoftware.SheetSizeBehavior,!0)},s._Enums.$7=function(e){var t=r.isValue(e)?e:"";return s._Enums.$8(t,"",tableauSoftware.TableauEventName,!1)},s._Enums.$8=function(e,t,i,n){if(r.isValue(e)){var a=e.toString().toUpperCase(),o=i;
for(var l in o){var u={key:l,value:o[l]},h=u.value.toString().toUpperCase();if(a===h)return u.value}}if(n)throw s._TableauException.createInvalidParameter(t);return null},s._ApiBootstrap=function(){},s._ApiBootstrap.initialize=function(){s._ApiObjectRegistry.registerCrossDomainMessageRouter(function(){return new s.JavaScriptApi$1})},s._ApiObjectRegistry=function(){},s._ApiObjectRegistry.registerCrossDomainMessageRouter=function(e){return s._ApiObjectRegistry.$3("ICrossDomainMessageRouter",e)},s._ApiObjectRegistry.getCrossDomainMessageRouter=function(){return s._ApiObjectRegistry.$5("ICrossDomainMessageRouter")},s._ApiObjectRegistry.disposeCrossDomainMessageRouter=function(){s._ApiObjectRegistry.$6("ICrossDomainMessageRouter")},s._ApiObjectRegistry.$3=function(e,t){r.isNullOrUndefined(s._ApiObjectRegistry.$1)&&(s._ApiObjectRegistry.$1={});var i=s._ApiObjectRegistry.$1[e];return s._ApiObjectRegistry.$1[e]=t,i},s._ApiObjectRegistry.$4=function(e){if(r.isNullOrUndefined(s._ApiObjectRegistry.$1))throw s._TableauException.createInternalError("No types registered");var t=s._ApiObjectRegistry.$1[e];if(r.isNullOrUndefined(t))throw s._TableauException.createInternalError("No creation function has been registered for interface type '"+e+"'.");var i=t();return i},s._ApiObjectRegistry.$5=function(e){r.isNullOrUndefined(s._ApiObjectRegistry.$2)&&(s._ApiObjectRegistry.$2={});var t=s._ApiObjectRegistry.$2[e];return r.isNullOrUndefined(t)&&(t=s._ApiObjectRegistry.$4(e),s._ApiObjectRegistry.$2[e]=t),t},s._ApiObjectRegistry.$6=function(e){if(r.isNullOrUndefined(s._ApiObjectRegistry.$2))return null;var t=s._ApiObjectRegistry.$2[e];return delete s._ApiObjectRegistry.$2[e],t},s._CustomViewImpl=function(e,t,i){this.$2=e,this.$4=t,this.$3=i,this.$7=!1,this.$8=!1,this.$9=!1},s._CustomViewImpl._getAsync=function(e){var t=new s._Deferred;return t.resolve(e.get__customViewImpl().get_$A()),t.get_promise()},s._CustomViewImpl._createNew=function(e,t,i,n){var a=new s._CustomViewImpl(e,i.name,t);return a.$7=i.isPublic,a.$6=i.url,a.$5=i.owner.friendlyName,a.$8=r.isValue(n)&&n===i.id,a.$1=i,a
},s._CustomViewImpl._saveNewAsync=function(e,t,i){var n=new s._Deferred,a={};a["api.customViewName"]=i;var o=s._CustomViewImpl.$13("api.SaveNewCustomViewCommand",n,function(i){s._CustomViewImpl._processCustomViewUpdate(e,t,i,!0);var a=null;r.isValue(e.get_$18())&&(a=e.get_$18().get_item(0)),n.resolve(a)});return t.sendCommand(a,o),n.get_promise()},s._CustomViewImpl._showCustomViewAsync=function(e,t,i){var n=new s._Deferred,a={};r.isValue(i)&&(a["api.customViewParam"]=i);var o=s._CustomViewImpl.$13("api.ShowCustomViewCommand",n,function(){var t=e.get_activeCustomView();n.resolve(t)});return t.sendCommand(a,o),n.get_promise()},s._CustomViewImpl._makeCurrentCustomViewDefaultAsync=function(e,t){var i=new s._Deferred,n={},r=s._CustomViewImpl.$13("api.MakeCurrentCustomViewDefaultCommand",i,function(){var t=e.get_activeCustomView();i.resolve(t)});return t.sendCommand(n,r),i.get_promise()},s._CustomViewImpl._getCustomViewsAsync=function(e,t){var i=new s._Deferred,n=new s._CommandReturnHandler("api.FetchCustomViewsCommand",0,function(n){s._CustomViewImpl._processCustomViews(e,t,n),i.resolve(e.get_$17()._toApiCollection())},function(e,t){i.reject(s._TableauException.create("serverError",t))});return t.sendCommand(null,n),i.get_promise()},s._CustomViewImpl._processCustomViews=function(e,t,i){s._CustomViewImpl._processCustomViewUpdate(e,t,i,!1)},s._CustomViewImpl._processCustomViewUpdate=function(e,t,i,n){n&&e.set_$18(new s._Collection),e.set_$1A(null);var a=null;r.isValue(i.currentView)&&(a=i.currentView.name);var o=i.defaultCustomViewId;if(n&&r.isValue(i.newView)){var l=s._CustomViewImpl._createNew(e,t,i.newView,o);e.get_$18()._add(l.get_$D(),l.get_$A())}if(e.set_$19(e.get_$17()),e.set_$17(new s._Collection),r.isValue(i.customViews)){var u=i.customViews;if(u.length>0)for(var h=0;h<u.length;h++){var c=s._CustomViewImpl._createNew(e,t,u[h],o);e.get_$17()._add(c.get_$D(),c.get_$A()),e.get_$19()._has(c.get_$D())?e.get_$19()._remove(c.get_$D()):n&&(e.get_$18()._has(c.get_$D())||e.get_$18()._add(c.get_$D(),c.get_$A())),r.isValue(a)&&c.get_$D()===a&&e.set_$1A(c.get_$A())
}}},s._CustomViewImpl.$13=function(e,t,i){var n=function(e,i){t.reject(s._TableauException.create("serverError",i))};return new s._CommandReturnHandler(e,0,i,n)},s._CustomViewImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:!1,$8:!1,$9:!1,get_$A:function(){return null==this.$0&&(this.$0=new tableauSoftware.CustomView(this)),this.$0},get_$B:function(){return this.$2.get_workbook()},get_$C:function(){return this.$6},get_$D:function(){return this.$4},set_$D:function(e){if(this.$9)throw s._TableauException.create("staleDataReference","Stale data");return this.$4=e,e},get_$E:function(){return this.$5},get_$F:function(){return this.$7},set_$F:function(e){if(this.$9)throw s._TableauException.create("staleDataReference","Stale data");return this.$7=e,e},get_$10:function(){return this.$8},$11:function(){if(this.$9||r.isNullOrUndefined(this.$1))throw s._TableauException.create("staleDataReference","Stale data");this.$1.isPublic=this.$7,this.$1.name=this.$4;var e=new s._Deferred,t={};t["api.customViewParam"]=this.$1;var i=s._CustomViewImpl.$13("api.UpdateCustomViewCommand",e,r.Delegate.create(this,function(t){s._CustomViewImpl._processCustomViewUpdate(this.$2,this.$3,t,!0),e.resolve(this.get_$A())}));return this.$3.sendCommand(t,i),e.get_promise()},$12:function(){var e=new s._Deferred,t={};t["api.customViewParam"]=this.$1;var i=s._CustomViewImpl.$13("api.RemoveCustomViewCommand",e,r.Delegate.create(this,function(t){this.$9=!0,s._CustomViewImpl._processCustomViews(this.$2,this.$3,t),e.resolve(this.get_$A())}));return this.$3.sendCommand(t,i),e.get_promise()},_showAsync:function(){if(this.$9||r.isNullOrUndefined(this.$1))throw s._TableauException.create("staleDataReference","Stale data");return s._CustomViewImpl._showCustomViewAsync(this.$2,this.$3,this.$1)},$14:function(e){return this.$5!==e.$5||this.$6!==e.$6||this.$7!==e.$7||this.$8!==e.$8}},s._DashboardImpl=function(e,t,i){this.$F=new s._Collection,this.$10=new s._Collection,s._DashboardImpl.initializeBase(this,[e,t,i])
},s._DashboardImpl.prototype={$E:null,get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){return null==this.$E&&(this.$E=new tableauSoftware.Dashboard(this)),this.$E},get_worksheets:function(){return this.$F},get_objects:function(){return this.$10},$11:function(e,t){this.$10=new s._Collection,this.$F=new s._Collection;for(var i=0;i<e.length;i++){var n=e[i],a=null;if("worksheet"===e[i].$0){var o=n.$1;if(r.isNullOrUndefined(o))continue;var l=this.$F.get__length(),u=s.SheetSizeFactory.createAutomatic(),h=!1,c=t(o),p=r.isNullOrUndefined(c),f=p?"":c.getUrl(),$=s.$create__SheetInfoImpl(o,"worksheet",l,u,this.get_workbook(),f,h,p,n.$4),_=new s._WorksheetImpl($,this.get_workbookImpl(),this.get_messagingOptions(),this);a=_.get_worksheet(),this.$F._add(o,_.get_worksheet())}var m=new tableauSoftware.DashboardObject(n,this.get_dashboard(),a);this.$10._add(i.toString(),m)}}},s._DataSourceImpl=function(e,t){this.$1=new s._Collection,s._Param.verifyString(e,"name"),this.$0=e,this.$2=t},s._DataSourceImpl.processDataSource=function(e){for(var t=new s._DataSourceImpl(e.name,e.isPrimary),i=e.fields||new Array(0),n=r.IEnumerator.getEnumerator(i);n.moveNext();){var a=n.current,o=new tableauSoftware.Field(t.get_dataSource(),a.name,a.role,a.aggregation);t.addField(o)}return t},s._DataSourceImpl.processDataSourcesForWorksheet=function(e){for(var t=new s._Collection,i=null,n=r.IEnumerator.getEnumerator(e.dataSources);n.moveNext();){var a=n.current,o=s._DataSourceImpl.processDataSource(a);a.isPrimary?i=o:t._add(a.name,o.get_dataSource())}return r.isValue(i)&&t._addToFirst(i.get_name(),i.get_dataSource()),t},s._DataSourceImpl.prototype={$0:null,$2:!1,$3:null,get_dataSource:function(){return null==this.$3&&(this.$3=new tableauSoftware.DataSource(this)),this.$3},get_name:function(){return this.$0},get_fields:function(){return this.$1},get_isPrimary:function(){return this.$2},addField:function(e){this.$1._add(e.getName(),e)}},s._DeferredUtil=function(){},s._DeferredUtil.$0=function(e){var t;
if(e instanceof tableauSoftware.Promise)t=e;else if(r.isValue(e)&&"function"==typeof e.valueOf&&(e=e.valueOf()),s._DeferredUtil.$4(e)){var i=new s._DeferredImpl;e.then(r.Delegate.create(i,i.resolve),r.Delegate.create(i,i.reject)),t=i.get_promise()}else t=s._DeferredUtil.$2(e);return t},s._DeferredUtil.$1=function(e){return s._DeferredUtil.$0(e).then(function(e){return s._DeferredUtil.$3(e)},null)},s._DeferredUtil.$2=function(e){var t=new s._PromiseImpl(function(t){try{return s._DeferredUtil.$0(r.isValue(t)?t(e):e)}catch(i){return s._DeferredUtil.$3(i)}});return t},s._DeferredUtil.$3=function(e){var t=new s._PromiseImpl(function(t,i){try{return r.isValue(i)?s._DeferredUtil.$0(i(e)):s._DeferredUtil.$3(e)}catch(n){return s._DeferredUtil.$3(n)}});return t},s._DeferredUtil.$4=function(e){return r.isValue(e)&&"function"==typeof e.then},s._CollectionImpl=function(){this.$0=[],this.$1={}},s._CollectionImpl.prototype={get__length:function(){return this.$0.length},get__rawArray:function(){return this.$0},_get:function(e){var t=this.$4(e);return r.isValue(this.$1[t])?this.$1[t]:void 0},_has:function(e){return r.isValue(this._get(e))},_add:function(e,t){this.$3(e,t);var i=this.$4(e);this.$0.push(t),this.$1[i]=t},_addToFirst:function(e,t){this.$3(e,t);var i=this.$4(e);this.$0.unshift(t),this.$1[i]=t},_remove:function(e){var t=this.$4(e);if(r.isValue(this.$1[t])){var i=this.$1[t];delete this.$1[t];for(var n=0;n<this.$0.length;n++)if(this.$0[n]===i){this.$0.splice(n,1);break}}},_toApiCollection:function(){var e=this.$0.concat();return e.get=r.Delegate.create(this,function(e){return this._get(e)}),e.has=r.Delegate.create(this,function(e){return this._has(e)}),e},$2:function(e){if(s._Utility.isNullOrEmpty(e))throw new Error("Null key");if(this._has(e))throw new Error("Duplicate key '"+e+"'")},$3:function(e,t){if(this.$2(e),r.isNullOrUndefined(t))throw new Error("Null item")},$4:function(e){return"_"+e},get_item:function(e){return this.$0[e]}},s._DeferredImpl=function(){this.$2=[],this.$0=new s._PromiseImpl(r.Delegate.create(this,this.then)),this.$1=r.Delegate.create(this,this.$5),this.$3=r.Delegate.create(this,this.$6)
},s._DeferredImpl.prototype={$0:null,$1:null,$3:null,get_promise:function(){return this.$0},$4:function(e){var t=new s._DeferredImpl,i=e.length,n=i,r=[];if(!i)return t.resolve(r),t.get_promise();for(var a=function(e,i){var a=s._DeferredUtil.$0(e);a.then(function(e){return r[i]=e,n--,n||t.resolve(r),null},function(e){return t.reject(e),null})},o=0;i>o;o++)a(e[o],o);return t.get_promise()},then:function(e,t){return this.$1(e,t)},resolve:function(e){return this.$3(e)},reject:function(e){return this.$3(s._DeferredUtil.$3(e))},$5:function(e,t){var i=new s._DeferredImpl;return this.$2.push(function(n){n.then(e,t).then(r.Delegate.create(i,i.resolve),r.Delegate.create(i,i.reject))}),i.get_promise()},$6:function(e){var t=s._DeferredUtil.$0(e);this.$1=t.then,this.$3=s._DeferredUtil.$0;for(var i=0;i<this.$2.length;i++){var n=this.$2[i];n(t)}return this.$2=null,t}},s._PromiseImpl=function(e){this.then=e},s._PromiseImpl.prototype={then:null,always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}},s._MarkImpl=function(e){if(this.$1=new s._Collection,s._jQueryShim.$12(e))for(var t=e,i=0;i<t.length;i++){var n=t[i];if(!r.isValue(n.fieldName))throw s._TableauException.createInvalidParameter("pair.fieldName");if(!r.isValue(n.value))throw s._TableauException.createInvalidParameter("pair.value");var a=new tableauSoftware.Pair(n.fieldName,n.value);this.$1._add(a.fieldName,a)}else this.$2=e},s._MarkImpl.$6=function(e){var t=new s._Collection;if(r.isNullOrUndefined(e)||s._Utility.isNullOrEmpty(e.marks))return t;for(var i=r.IEnumerator.getEnumerator(e.marks);i.moveNext();){var n=i.current,a=n.tupleId,o=new tableauSoftware.Mark(a);t._add(a.toString(),o);for(var l=r.IEnumerator.getEnumerator(n.pairs);l.moveNext();){var u=l.current,h=s._Utility.convertRawValue(u.value,u.valueDataType),c=new tableauSoftware.Pair(u.fieldName,h);c.formattedValue=u.formattedValue,o.$0.get_$3()._has(c.fieldName)||o.$0.$7(c)}}return t},s._MarkImpl.prototype={$0:null,$2:0,get_$3:function(){return this.$1
},get_$4:function(){return this.$2},get_$5:function(){return null==this.$0&&(this.$0=this.$1._toApiCollection()),this.$0},$7:function(e){this.$1._add(e.fieldName,e)}},s._Param=function(){},s._Param.verifyString=function(e,t){if(r.isNullOrUndefined(e)||!e.length)throw s._TableauException.createInternalStringArgumentException(t)},s._Param.verifyValue=function(e,t){if(r.isNullOrUndefined(e))throw s._TableauException.createInternalNullArgumentException(t)},s._ParameterImpl=function(e){if(this.$1=e.name,this.$2=s._Utility.getDataValue(e.currentValue),this.$3=e.dataType,this.$4=e.allowableValuesType,r.isValue(e.allowableValues)&&"list"===this.$4){this.$5=[];for(var t=r.IEnumerator.getEnumerator(e.allowableValues);t.moveNext();){var i=t.current;this.$5.push(s._Utility.getDataValue(i))}}"range"===this.$4&&(this.$6=s._Utility.getDataValue(e.minValue),this.$7=s._Utility.getDataValue(e.maxValue),this.$8=e.stepSize,("date"===this.$3||"datetime"===this.$3)&&r.isValue(this.$8)&&r.isValue(e.dateStepPeriod)&&(this.$9=e.dateStepPeriod))},s._ParameterImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,get_$A:function(){return null==this.$0&&(this.$0=new tableauSoftware.Parameter(this)),this.$0},get_$B:function(){return this.$1},get_$C:function(){return this.$2},get_$D:function(){return this.$3},get_$E:function(){return this.$4},get_$F:function(){return this.$5},get_$10:function(){return this.$6},get_$11:function(){return this.$7},get_$12:function(){return this.$8},get_$13:function(){return this.$9}},s._SheetImpl=function(e,t,i){s._Param.verifyValue(e,"sheetInfoImpl"),s._Param.verifyValue(t,"workbookImpl"),s._Param.verifyValue(i,"messagingOptions"),this.$0=e.name,this.$1=e.index,this.$2=e.isActive,this.$3=e.isHidden,this.$4=e.sheetType,this.$5=e.size,this.$6=e.url,this.$7=t,this.$8=i,this.$A=e.zoneId},s._SheetImpl.$B=function(e){return r.isValue(e)?s._Utility.toInt(e):e},s._SheetImpl.$C=function(e){var t=s._Enums.$6(e.behavior,"size.behavior"),i=e.minSize;
r.isValue(i)&&(i=s.$create_Size(s._SheetImpl.$B(e.minSize.width),s._SheetImpl.$B(e.minSize.height)));var n=e.maxSize;return r.isValue(n)&&(n=s.$create_Size(s._SheetImpl.$B(e.maxSize.width),s._SheetImpl.$B(e.maxSize.height))),s.$create_SheetSize(t,i,n)},s._SheetImpl.prototype={$0:null,$1:0,$2:!1,$3:!1,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,$A:0,get_name:function(){return this.$0},get_index:function(){return this.$1},get_workbookImpl:function(){return this.$7},get_workbook:function(){return this.$7.get_workbook()},get_url:function(){if(this.$3)throw s._TableauException.createNoUrlForHiddenWorksheet();return this.$6},get_size:function(){return this.$5},get_isHidden:function(){return this.$3},get_isActive:function(){return this.$2},set_isActive:function(e){return this.$2=e,e},get_isDashboard:function(){return"dashboard"===this.$4},get_sheetType:function(){return this.$4},get_parentStoryPoint:function(){return r.isValue(this.$9)?this.$9.get_storyPoint():null},get_parentStoryPointImpl:function(){return this.$9},set_parentStoryPointImpl:function(e){if("story"===this.$4)throw s._TableauException.createInternalError("A story cannot be a child of another story.");return this.$9=e,e},get_zoneId:function(){return this.$A},get_messagingOptions:function(){return this.$8},changeSizeAsync:function(e){if(e=s._SheetImpl.$C(e),"worksheet"===this.$4&&"automatic"!==e.behavior)throw s._TableauException.createInvalidSizeBehaviorOnWorksheet();var t=new s._Deferred;if(this.$5.behavior===e.behavior&&"automatic"===e.behavior)return t.resolve(e),t.get_promise();var i=this.$D(e),n={};n["api.setSheetSizeName"]=this.$0,n["api.minWidth"]=i["api.minWidth"],n["api.minHeight"]=i["api.minHeight"],n["api.maxWidth"]=i["api.maxWidth"],n["api.maxHeight"]=i["api.maxHeight"];var a=new s._CommandReturnHandler("api.SetSheetSizeCommand",1,r.Delegate.create(this,function(){this.get_workbookImpl()._update(r.Delegate.create(this,function(){var e=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();
t.resolve(e)}))}),function(e,i){t.reject(s._TableauException.createServerError(i))});return this.sendCommand(n,a),t.get_promise()},sendCommand:function(e,t){this.$8.sendCommand(e,t)},$D:function(e){var t=null;if(r.isNullOrUndefined(e)||r.isNullOrUndefined(e.behavior)||"automatic"!==e.behavior&&r.isNullOrUndefined(e.minSize)&&r.isNullOrUndefined(e.maxSize))throw s._TableauException.createInvalidSheetSizeParam();var i=0,n=0,a=0,o=0,l={};if(l["api.minWidth"]=0,l["api.minHeight"]=0,l["api.maxWidth"]=0,l["api.maxHeight"]=0,"automatic"===e.behavior)t=s.$create_SheetSize("automatic",void 0,void 0);else if("atmost"===e.behavior){if(r.isNullOrUndefined(e.maxSize)||r.isNullOrUndefined(e.maxSize.width)||r.isNullOrUndefined(e.maxSize.height))throw s._TableauException.createMissingMaxSize();if(e.maxSize.width<0||e.maxSize.height<0)throw s._TableauException.createInvalidSizeValue();l["api.maxWidth"]=e.maxSize.width,l["api.maxHeight"]=e.maxSize.height,t=s.$create_SheetSize("atmost",void 0,e.maxSize)}else if("atleast"===e.behavior){if(r.isNullOrUndefined(e.minSize)||r.isNullOrUndefined(e.minSize.width)||r.isNullOrUndefined(e.minSize.height))throw s._TableauException.createMissingMinSize();if(e.minSize.width<0||e.minSize.height<0)throw s._TableauException.createInvalidSizeValue();l["api.minWidth"]=e.minSize.width,l["api.minHeight"]=e.minSize.height,t=s.$create_SheetSize("atleast",e.minSize,void 0)}else if("range"===e.behavior){if(r.isNullOrUndefined(e.minSize)||r.isNullOrUndefined(e.maxSize)||r.isNullOrUndefined(e.minSize.width)||r.isNullOrUndefined(e.maxSize.width)||r.isNullOrUndefined(e.minSize.height)||r.isNullOrUndefined(e.maxSize.height))throw s._TableauException.createMissingMinMaxSize();if(e.minSize.width<0||e.minSize.height<0||e.maxSize.width<0||e.maxSize.height<0||e.minSize.width>e.maxSize.width||e.minSize.height>e.maxSize.height)throw s._TableauException.createInvalidRangeSize();l["api.minWidth"]=e.minSize.width,l["api.minHeight"]=e.minSize.height,l["api.maxWidth"]=e.maxSize.width,l["api.maxHeight"]=e.maxSize.height,t=s.$create_SheetSize("range",e.minSize,e.maxSize)
}else if("exactly"===e.behavior){if(r.isValue(e.minSize)&&r.isValue(e.maxSize)&&r.isValue(e.minSize.width)&&r.isValue(e.maxSize.width)&&r.isValue(e.minSize.height)&&r.isValue(e.maxSize.height)){if(i=e.minSize.width,n=e.minSize.height,a=e.maxSize.width,o=e.maxSize.height,i!==a||n!==o)throw s._TableauException.createSizeConflictForExactly()}else r.isValue(e.minSize)&&r.isValue(e.minSize.width)&&r.isValue(e.minSize.height)?(i=e.minSize.width,n=e.minSize.height,a=i,o=n):r.isValue(e.maxSize)&&r.isValue(e.maxSize.width)&&r.isValue(e.maxSize.height)&&(a=e.maxSize.width,o=e.maxSize.height,i=a,n=o);l["api.minWidth"]=i,l["api.minHeight"]=n,l["api.maxWidth"]=a,l["api.maxHeight"]=o,t=s.$create_SheetSize("exactly",s.$create_Size(i,n),s.$create_Size(a,o))}return this.$5=t,l}},s._StoryImpl=function(e,t,i,n,r){s._StoryImpl.initializeBase(this,[e,t,i]),s._Param.verifyValue(n,"storyPm"),s._Param.verifyValue(r,"findSheetFunc"),this.$F=r,this.update(n)},s._StoryImpl.prototype={$E:null,$F:null,$10:null,$11:null,add_activeStoryPointChange:function(e){this.$12=r.Delegate.combine(this.$12,e)},remove_activeStoryPointChange:function(e){this.$12=r.Delegate.remove(this.$12,e)},$12:null,get_activeStoryPointImpl:function(){return this.$E},get_sheet:function(){return this.get_story()},get_story:function(){return null==this.$10&&(this.$10=new tableauSoftware.Story(this)),this.$10},get_storyPointsInfo:function(){return this.$11},update:function(e){var t=null,i=null;this.$11=this.$11||new Array(e.storyPoints.length);for(var n=0;n<e.storyPoints.length;n++){var a=e.storyPoints[n],o=a.caption,l=n===e.activeStoryPointIndex,u=s.$create__StoryPointInfoImpl(o,n,a.storyPointId,l,a.isUpdated,this);if(r.isNullOrUndefined(this.$11[n]))this.$11[n]=new tableauSoftware.StoryPointInfo(u);else if(this.$11[n]._impl.storyPointId===u.storyPointId){var h=this.$11[n]._impl;h.caption=u.caption,h.index=u.index,h.isActive=l,h.isUpdated=u.isUpdated}else this.$11[n]=new tableauSoftware.StoryPointInfo(u);l&&(t=a.containedSheetInfo,i=u)
}var c=this.$11.length-e.storyPoints.length;this.$11.splice(e.storyPoints.length,c);var p=r.isNullOrUndefined(this.$E)||this.$E.get_storyPointId()!==i.storyPointId;r.isValue(this.$E)&&p&&this.$E.set_isActive(!1);var f=this.$E;if(p){var $=s._StoryPointImpl.createContainedSheet(t,this.get_workbookImpl(),this.get_messagingOptions(),this.$F);this.$E=new s._StoryPointImpl(i,$)}else this.$E.set_isActive(i.isActive),this.$E.set_isUpdated(i.isUpdated);p&&r.isValue(f)&&this.$16(this.$11[f.get_index()],this.$E.get_storyPoint())},activatePreviousStoryPointAsync:function(){return this.$13("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function(){return this.$13("api.ActivateNextStoryPoint")},activateStoryPointAsync:function(e){var t=new s._Deferred;if(0>e||e>=this.$11.length)throw s._TableauException.createIndexOutOfRange(e);var i=this.get_activeStoryPointImpl(),n={};n["api.storyPointIndex"]=e;var a=new s._CommandReturnHandler("api.ActivateStoryPoint",0,r.Delegate.create(this,function(e){var n=e;this.$15(i,n),t.resolve(this.$E.get_storyPoint())}),function(e,i){t.reject(s._TableauException.createServerError(i))});return this.sendCommand(n,a),t.get_promise()},revertStoryPointAsync:function(e){if(e=e||this.$E.get_index(),0>e||e>=this.$11.length)throw s._TableauException.createIndexOutOfRange(e);var t=new s._Deferred,i={};i["api.storyPointIndex"]=e;var n=new s._CommandReturnHandler("api.RevertStoryPoint",0,r.Delegate.create(this,function(i){var n=i;this.$14(e,n),t.resolve(this.$11[e])}),function(e,i){t.reject(s._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},$13:function(e){if("api.ActivatePreviousStoryPoint"!==e&&"api.ActivateNextStoryPoint"!==e)throw s._TableauException.createInternalError("commandName '"+e+"' is invalid.");var t=new s._Deferred,i=this.get_activeStoryPointImpl(),n={},a=new s._CommandReturnHandler(e,0,r.Delegate.create(this,function(e){var n=e;this.$15(i,n),t.resolve(this.$E.get_storyPoint())}),function(e,i){t.reject(s._TableauException.createServerError(i))
});return this.sendCommand(n,a),t.get_promise()},$14:function(e,t){var i=this.$11[e]._impl;if(i.storyPointId!==t.storyPointId)throw s._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+i.storyPointId+", newStoryPointID="+t.storyPointId);i.caption=t.caption,i.isUpdated=t.isUpdated,t.storyPointId===this.$E.get_storyPointId()&&this.$E.set_isUpdated(t.isUpdated)},$15:function(e,t){var i=t.index;if(e.get_index()!==i){var n=this.$11[e.get_index()],r=this.$11[i]._impl,a=s._StoryPointImpl.createContainedSheet(t.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$F);r.isActive=!0,this.$E=new s._StoryPointImpl(r,a),e.set_isActive(!1),n._impl.isActive=!1,this.$16(n,this.$E.get_storyPoint())}},$16:function(e,t){null!=this.$12&&this.$12(e,t)}},s._StoryPointImpl=function(e,t){if(this.$2=e.isActive,this.$3=e.isUpdated,this.$0=e.caption,this.$1=e.index,this.$5=e.parentStoryImpl,this.$7=e.storyPointId,this.$4=t,r.isValue(t)&&(this.$4.set_parentStoryPointImpl(this),"dashboard"===t.get_sheetType()))for(var i=this.$4,n=0;n<i.get_worksheets().get__length();n++){var a=i.get_worksheets().get_item(n);a._impl.set_parentStoryPointImpl(this)}},s._StoryPointImpl.createContainedSheet=function(e,t,i,n){var a=e.sheetType,o=-1,l=s.SheetSizeFactory.createAutomatic(),u=!1,h=n(e.name),c=r.isNullOrUndefined(h),p=c?"":h.getUrl(),f=s.$create__SheetInfoImpl(e.name,a,o,l,t.get_workbook(),p,u,c,e.zoneId);if("worksheet"===e.sheetType){var $=null,_=new s._WorksheetImpl(f,t,i,$);return _}if("dashboard"===e.sheetType){var m=new s._DashboardImpl(f,t,i),d=s._WorkbookImpl.$8(e.dashboardZones);return m.$11(d,n),m}throw s._TableauException.createInternalError("story"===e.sheetType?"Cannot have a story embedded within another story.":"Unknown sheet type '"+e.sheetType+"'")},s._StoryPointImpl.prototype={$0:null,$1:0,$2:!1,$3:!1,$4:null,$5:null,$6:null,$7:0,get_caption:function(){return this.$0},get_containedSheetImpl:function(){return this.$4
},get_index:function(){return this.$1},get_isActive:function(){return this.$2},set_isActive:function(e){return this.$2=e,e},get_isUpdated:function(){return this.$3},set_isUpdated:function(e){return this.$3=e,e},get_parentStoryImpl:function(){return this.$5},get_storyPoint:function(){return null==this.$6&&(this.$6=new tableauSoftware.StoryPoint(this)),this.$6},get_storyPointId:function(){return this.$7},$8:function(){return s.$create__StoryPointInfoImpl(this.$0,this.$1,this.$7,this.$2,this.$3,this.$5)}},s.StoryPointInfoImplUtil=function(){},s.StoryPointInfoImplUtil.clone=function(e){return s.$create__StoryPointInfoImpl(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)},s._TableauException=function(){},s._TableauException.create=function(e,t){var i=new Error(t);return i.tableauSoftwareErrorCode=e,i},s._TableauException.createInternalError=function(e){return r.isValue(e)?s._TableauException.create("internalError","Internal error. Please contact Tableau support with the following information: "+e):s._TableauException.create("internalError","Internal error. Please contact Tableau support")},s._TableauException.createInternalNullArgumentException=function(e){return s._TableauException.createInternalError("Null/undefined argument '"+e+"'.")},s._TableauException.createInternalStringArgumentException=function(e){return s._TableauException.createInternalError("Invalid string argument '"+e+"'.")},s._TableauException.createServerError=function(e){return s._TableauException.create("serverError",e)},s._TableauException.createNotActiveSheet=function(){return s._TableauException.create("notActiveSheet","Operation not allowed on non-active sheet")},s._TableauException.createInvalidCustomViewName=function(e){return s._TableauException.create("invalidCustomViewName","Invalid custom view name: "+e)},s._TableauException.createInvalidParameter=function(e){return s._TableauException.create("invalidParameter","Invalid parameter: "+e)},s._TableauException.createInvalidFilterFieldNameOrValue=function(e){return s._TableauException.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+e)
},s._TableauException.createInvalidDateParameter=function(e){return s._TableauException.create("invalidDateParameter","Invalid date parameter: "+e)},s._TableauException.createNullOrEmptyParameter=function(e){return s._TableauException.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+e)},s._TableauException.createMissingMaxSize=function(){return s._TableauException.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},s._TableauException.createMissingMinSize=function(){return s._TableauException.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},s._TableauException.createMissingMinMaxSize=function(){return s._TableauException.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},s._TableauException.createInvalidRangeSize=function(){return s._TableauException.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},s._TableauException.createInvalidSizeValue=function(){return s._TableauException.create("invalidSize","Size value cannot be less than zero")},s._TableauException.createInvalidSheetSizeParam=function(){return s._TableauException.create("invalidSize","Invalid sheet size parameter")},s._TableauException.createSizeConflictForExactly=function(){return s._TableauException.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},s._TableauException.createInvalidSizeBehaviorOnWorksheet=function(){return s._TableauException.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},s._TableauException.createNoUrlForHiddenWorksheet=function(){return s._TableauException.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},s._TableauException.$0=function(e){return s._TableauException.create("invalidAggregationFieldName","Invalid aggregation type for field '"+e+"'")},s._TableauException.createIndexOutOfRange=function(e){return s._TableauException.create("indexOutOfRange","Index '"+e+"' is out of range.")
},s._TableauException.createUnsupportedEventName=function(e){return s._TableauException.create("unsupportedEventName","Unsupported event '"+e+"'.")},s._TableauException.createBrowserNotCapable=function(){return s._TableauException.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")},s._Utility=function(){},s._Utility.hasOwnProperty=function(e,t){return e.hasOwnProperty(t)},s._Utility.isNullOrEmpty=function(e){return r.isNullOrUndefined(e)||(e.length||0)<=0},s._Utility.isString=function(e){return"string"==typeof e},s._Utility.isNumber=function(e){return"number"==typeof e},s._Utility.isDate=function(e){return"object"==typeof e&&e instanceof Date?!0:"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())},s._Utility.isDateValid=function(e){return!isNaN(e.getTime())},s._Utility.indexOf=function(e,t,i){if(r.isValue(Array.prototype.indexOf))return e.indexOf(t,i);i=i||0;var n=e.length;if(n>0)for(var a=i;n>a;a++)if(e[a]===t)return a;return-1},s._Utility.contains=function(e,t,i){var n=s._Utility.indexOf(e,t,i);return n>=0},s._Utility.getTopmostWindow=function(){for(var e=window.self;r.isValue(e.parent)&&e.parent!==e;)e=e.parent;return e},s._Utility.toInt=function(e){return s._Utility.isNumber(e)?e:parseInt(e.toString(),10)},s._Utility.hasClass=function(e,t){var i=new RegExp("[\\n\\t\\r]","g");return r.isValue(e)&&(" "+e.className+" ").replace(i," ").indexOf(" "+t+" ")>-1},s._Utility.findParentWithClassName=function(e,t,i){var n=r.isValue(e)?e.parentNode:null;for(i=i||document.body;null!=n;){if(s._Utility.hasClass(n,t))return n;n=n===i?null:n.parentNode}return n},s._Utility.hasJsonParse=function(){return r.isValue(window.JSON)&&r.isValue(window.JSON.parse)},s._Utility.hasWindowPostMessage=function(){return r.isValue(window.postMessage)},s._Utility.isPostMessageSynchronous=function(){if(s._Utility.isIE()){var e=new RegExp("(msie) ([\\w.]+)"),t=e.exec(window.navigator.userAgent.toLowerCase()),i=t[2]||"0",n=parseInt(i,10);
return 8>=n}return!1},s._Utility.hasDocumentAttachEvent=function(){return r.isValue(document.attachEvent)},s._Utility.hasWindowAddEventListener=function(){return r.isValue(window.addEventListener)},s._Utility.isElementOfTag=function(e,t){return r.isValue(e)&&1===e.nodeType&&e.tagName.toLowerCase()===t.toLowerCase()},s._Utility.elementToString=function(e){var t=new r.StringBuilder;if(t.append(e.tagName.toLowerCase()),s._Utility.isNullOrEmpty(e.id)||t.append("#").append(e.id),!s._Utility.isNullOrEmpty(e.className)){var i=e.className.split(" ");t.append(".").append(i.join("."))}return t.toString()},s._Utility.tableauGCS=function(e){return r.isValue(window.getComputedStyle)?window.getComputedStyle(e):e.currentStyle},s._Utility.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>-1&&r.isNullOrUndefined(window.opera)},s._Utility.isSafari=function(){var e=window.navigator.userAgent,t=e.indexOf("Chrome")>=0;return e.indexOf("Safari")>=0&&!t},s._Utility.mobileDetect=function(){var e=window.navigator.userAgent;return-1!==e.indexOf("iPad")?!0:-1!==e.indexOf("Android")?!0:-1!==e.indexOf("AppleWebKit")&&-1!==e.indexOf("Mobile")?!0:!1},s._Utility.elementOffset=function(e){var t=null;t=e.getBoundingClientRect();var i=t.top,n=t.left,r=new s.WindowHelper(window.self),a=window.document.documentElement,o=n+r.get_pageXOffset()-a.clientLeft,l=i+r.get_pageYOffset()-a.clientTop;return s.$create_Point(o,l)},s._Utility.convertRawValue=function(e,t){if(r.isNullOrUndefined(e))return null;switch(t){case"bool":return e;case"date":return new Date(e);case"number":return null==e?Number.NaN:e;case"string":default:return e}},s._Utility.getDataValue=function(e){return r.isNullOrUndefined(e)?s.$create_DataValue(null,null,null):s.$create_DataValue(s._Utility.convertRawValue(e.value,e.type),e.formattedValue,e.aliasedValue)},s._Utility.serializeDateForServer=function(e){var t="";if(r.isValue(e)&&s._Utility.isDate(e)){var i=e.getUTCFullYear(),n=e.getUTCMonth()+1,a=e.getUTCDate(),o=e.getUTCHours(),l=e.getUTCMinutes(),u=e.getUTCSeconds();
t=i+"-"+n+"-"+a+" "+o+":"+l+":"+u}return t},s._Utility.computeContentSize=function(e){var t=s._Utility.$0(e),i=parseFloat(t.paddingLeft),n=parseFloat(t.paddingTop),r=parseFloat(t.paddingRight),a=parseFloat(t.paddingBottom),o=e.clientWidth-Math.round(i+r),l=e.clientHeight-Math.round(n+a);return s.$create_Size(o,l)},s._Utility.$0=function(e){return r.isValue(window.getComputedStyle)?r.isValue(e.ownerDocument.defaultView.opener)?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null):r.isValue(e.currentStyle)?e.currentStyle:e.style},s.VizImpl=function(e,t,i,n,a){if(!s._Utility.hasWindowPostMessage()||!s._Utility.hasJsonParse())throw s._TableauException.createBrowserNotCapable();this.$D=new s.CrossDomainMessagingOptions(e,this),this.$1=t,(r.isNullOrUndefined(i)||1!==i.nodeType)&&(i=document.body),this.$3=new s._VizParameters(i,n,a),r.isValue(a)&&(this.$7=a.onFirstInteractive,this.$8=a.onFirstVizSizeKnown)},s.VizImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:!1,$A:!1,$B:!1,$C:!1,$D:null,$E:null,$F:null,$10:!1,add_customViewsListLoad:function(e){this.$11=r.Delegate.combine(this.$11,e)},remove_customViewsListLoad:function(e){this.$11=r.Delegate.remove(this.$11,e)},$11:null,add_stateReadyForQuery:function(e){this.$12=r.Delegate.combine(this.$12,e)},remove_stateReadyForQuery:function(e){this.$12=r.Delegate.remove(this.$12,e)},$12:null,add_$13:function(e){this.$14=r.Delegate.combine(this.$14,e)},remove_$13:function(e){this.$14=r.Delegate.remove(this.$14,e)},$14:null,add_$15:function(e){this.$16=r.Delegate.combine(this.$16,e)},remove_$15:function(e){this.$16=r.Delegate.remove(this.$16,e)},$16:null,add_$17:function(e){this.$18=r.Delegate.combine(this.$18,e)},remove_$17:function(e){this.$18=r.Delegate.remove(this.$18,e)},$18:null,add_$19:function(e){this.$1A=r.Delegate.combine(this.$1A,e)},remove_$19:function(e){this.$1A=r.Delegate.remove(this.$1A,e)},$1A:null,add_$1B:function(e){this.$1C=r.Delegate.combine(this.$1C,e)
},remove_$1B:function(e){this.$1C=r.Delegate.remove(this.$1C,e)},$1C:null,add_$1D:function(e){this.$1E=r.Delegate.combine(this.$1E,e)},remove_$1D:function(e){this.$1E=r.Delegate.remove(this.$1E,e)},$1E:null,add_$1F:function(e){this.$20=r.Delegate.combine(this.$20,e)},remove_$1F:function(e){this.$20=r.Delegate.remove(this.$20,e)},$20:null,add_$21:function(e){this.$22=r.Delegate.combine(this.$22,e)},remove_$21:function(e){this.$22=r.Delegate.remove(this.$22,e)},$22:null,add_$23:function(e){this.$24=r.Delegate.combine(this.$24,e)},remove_$23:function(e){this.$24=r.Delegate.remove(this.$24,e)},$24:null,add_$25:function(e){this.$26=r.Delegate.combine(this.$26,e)},remove_$25:function(e){this.$26=r.Delegate.remove(this.$26,e)},$26:null,get_handlerId:function(){return this.$3.handlerId},set_handlerId:function(e){return this.$3.handlerId=e,e},get_iframe:function(){return this.$2},get_instanceId:function(){return this.$5},get_serverRoot:function(){return this.$3.serverRoot},get_$27:function(){return this.$1},get_$28:function(){return this.$A},get_$29:function(){return this.$B},get_$2A:function(){return"none"===this.$2.style.display},get_$2B:function(){return this.$3.parentElement},get_$2C:function(){return this.$3.get_baseUrl()},get_$2D:function(){return this.$6.get_workbook()},get__workbookImpl:function(){return this.$6},get_$2E:function(){return this.$C},get_$2F:function(){return this.$E},getCurrentUrlAsync:function(){var e=new s._Deferred,t=new s._CommandReturnHandler("api.GetCurrentUrlCommand",0,function(t){e.resolve(t)},function(t,i){e.reject(s._TableauException.createInternalError(i))});return this._sendCommand(null,t),e.get_promise()},handleVizLoad:function(){this.$47(),r.isNullOrUndefined(this.$6)?this.$6=new s._WorkbookImpl(this,this.$D,r.Delegate.create(this,function(){this.$54()})):this.$10||this.$6._update(r.Delegate.create(this,function(){this.$54()}))},$30:function(e){var t=this.$E.chromeHeight,i=this.$E.sheetSize,n=0,r=0;if("exactly"===i.behavior)n=i.maxSize.width,r=i.maxSize.height+t;
else{var a,o,l,u;switch(i.behavior){case"range":a=i.minSize.width,o=i.maxSize.width,l=i.minSize.height+t,u=i.maxSize.height+t,n=Math.max(a,Math.min(o,e.width)),r=Math.max(l,Math.min(u,e.height));break;case"atleast":a=i.minSize.width,l=i.minSize.height+t,n=Math.max(a,e.width),r=Math.max(l,e.height);break;case"atmost":o=i.maxSize.width,u=i.maxSize.height+t,n=Math.min(o,e.width),r=Math.min(u,e.height);break;case"automatic":n=e.width,r=Math.max(e.height,t);break;default:throw s._TableauException.createInternalError("Unknown SheetSizeBehavior for viz: "+i.behavior)}}return s.$create_Size(n,r)},$31:function(){var e;return r.isValue(this.$4)?(e=this.$4,this.$4=null):e=s._Utility.computeContentSize(this.get_$2B()),this.$50(e),this.$30(e)},$32:function(){var e=this.$31();this.$42(e.width+"px",e.height+"px");for(var t=10,i=0;t>i;i++){var n=this.$31();if(JSON.stringify(e)===JSON.stringify(n))return;e=n,this.$42(e.width+"px",e.height+"px")}throw s._TableauException.create("maxVizResizeAttempts","Viz resize limit hit. The calculated iframe size did not stabilize after "+t+" resizes.")},handleEventNotification:function(e,t){var i=s._ApiServerNotification.deserialize(t);if("api.FirstVizSizeKnownEvent"===e){var n=JSON.parse(i.get_data());this.$5B(n)}else if("api.VizInteractiveEvent"===e)this.$5=i.get_data(),r.isValue(this.$6)&&this.$6.get_name()===i.get_workbookName()&&this.$54(),this.$4E();else if("api.MarksSelectionChangedEvent"===e){if(null!=this.$14&&this.$6.get_name()===i.get_workbookName()){var a=null,o=this.$6.get_activeSheetImpl();if(o.get_name()===i.get_worksheetName())a=o;else if(o.get_isDashboard()){var l=o;a=l.get_worksheets()._get(i.get_worksheetName())._impl}r.isValue(a)&&(a.set_selectedMarks(null),this.$14(new s.MarksEvent("marksselection",this.$1,a)))}}else if("api.FilterChangedEvent"===e){if(null!=this.$16&&this.$6.get_name()===i.get_workbookName()){var u=null,h=this.$6.get_activeSheetImpl();if(h.get_name()===i.get_worksheetName())u=h;else if(h.get_isDashboard()){var c=h;
u=c.get_worksheets()._get(i.get_worksheetName())._impl}if(r.isValue(u)){var p=JSON.parse(i.get_data()),f=p[0],$=p[1];this.$16(new s.FilterEvent("filterchange",this.$1,u,f,$))}}}else if("api.ParameterChangedEvent"===e){if(null!=this.$18&&this.$6.get_name()===i.get_workbookName()){this.$6.set_$22(null);var _=i.get_data();this.$48(_)}}else if("api.CustomViewsListLoadedEvent"===e){var m=JSON.parse(i.get_data()),d=r.Delegate.create(this,function(){s._CustomViewImpl._processCustomViews(this.$6,this.$D,m)}),g=r.Delegate.create(this,function(){this.$4F(),null==this.$1A||m.customViewLoaded||this.$49(this.$6.get_activeCustomView())});r.isNullOrUndefined(this.$6)?(this.$10=!0,this.$6=new s._WorkbookImpl(this,this.$D,r.Delegate.create(this,function(){d(),this.$54(g),this.$10=!1}))):(d(),this.$55(g))}else if("api.CustomViewUpdatedEvent"===e){var v=JSON.parse(i.get_data());if(r.isNullOrUndefined(this.$6)&&(this.$6=new s._WorkbookImpl(this,this.$D,r.Delegate.create(this,function(){this.$54()}))),r.isValue(this.$6)&&s._CustomViewImpl._processCustomViewUpdate(this.$6,this.$D,v,!0),null!=this.$1C)for(var w=this.$6.get_$18()._toApiCollection(),S=0,E=w.length;E>S;S++)this.$4A(w[S])}else if("api.CustomViewRemovedEvent"===e){if(null!=this.$1E)for(var y=this.$6.get_$19()._toApiCollection(),b=0,I=y.length;I>b;b++)this.$4B(y[b])}else if("api.CustomViewSetDefaultEvent"===e){var C=JSON.parse(i.get_data());if(r.isValue(this.$6)&&s._CustomViewImpl._processCustomViews(this.$6,this.$D,C),null!=this.$20)for(var A=this.$6.get_$18()._toApiCollection(),N=0,D=A.length;D>N;N++)this.$4C(A[N])}else if("api.TabSwitchEvent"===e)this.$6._update(r.Delegate.create(this,function(){if(r.isValue(this.$0)&&this.$0(),this.$6.get_name()===i.get_workbookName()){var e=i.get_worksheetName(),t=i.get_data();this.$4D(e,t)}this.$54()}));else if("api.StorytellingStateChangedEvent"===e){var V=this.$6.get_activeSheetImpl();"story"===V.get_sheetType()&&V.update(JSON.parse(i.get_data()))}},addEventListener:function(e,t){var i=s._Enums.$7(e);
if("marksselection"===i)this.add_$13(t);else if("parametervaluechange"===i)this.add_$17(t);else if("filterchange"===i)this.add_$15(t);else if("customviewload"===i)this.add_$19(t);else if("customviewsave"===i)this.add_$1B(t);else if("customviewremove"===i)this.add_$1D(t);else if("customviewsetdefault"===i)this.add_$1F(t);else if("tabswitch"===i)this.add_$21(t);else if("storypointswitch"===i)this.add_$23(t);else{if("vizresize"!==i)throw s._TableauException.createUnsupportedEventName(e);this.add_$25(t)}},removeEventListener:function(e,t){var i=s._Enums.$7(e);if("marksselection"===i)this.remove_$13(t);else if("parametervaluechange"===i)this.remove_$17(t);else if("filterchange"===i)this.remove_$15(t);else if("customviewload"===i)this.remove_$19(t);else if("customviewsave"===i)this.remove_$1B(t);else if("customviewremove"===i)this.remove_$1D(t);else if("customviewsetdefault"===i)this.remove_$1F(t);else if("tabswitch"===i)this.remove_$21(t);else if("storypointswitch"===i)this.remove_$23(t);else{if("vizresize"!==i)throw s._TableauException.createUnsupportedEventName(e);this.remove_$25(t)}},$33:function(){r.isValue(this.$2)&&(this.$2.parentNode.removeChild(this.$2),this.$2=null),s._VizManagerImpl.$3(this.$1),this.$D.get_router().unregisterHandler(this),this.$5C()},$34:function(){this.$2.style.display="block",this.$2.style.visibility="visible"},$35:function(){this.$2.style.display="none"},$36:function(){this.$2.style.visibility="hidden"},$37:function(){this.$53("showExportImageDialog")},$38:function(e){var t=this.$51(e);this.$53("showExportDataDialog",t)},$39:function(e){var t=this.$51(e);this.$53("showExportCrosstabDialog",t)},$3A:function(){this.$53("showExportPDFDialog")},$3B:function(){var e=new s._Deferred,t=new s._CommandReturnHandler("api.RevertAllCommand",1,function(){e.resolve()},function(t,i){e.reject(s._TableauException.createServerError(i))});return this._sendCommand(null,t),e.get_promise()},$3C:function(){var e=new s._Deferred,t=new s._CommandReturnHandler("api.RefreshDataCommand",1,function(){e.resolve()
},function(t,i){e.reject(s._TableauException.createServerError(i))});return this._sendCommand(null,t),e.get_promise()},$3D:function(){this.$53("showShareDialog")},$3E:function(){if(!this.get__workbookImpl().get_isDownloadAllowed())throw s._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed");this.$53("showDownloadWorkbookDialog")},$3F:function(){return this.$52("pauseAutomaticUpdates")},$40:function(){return this.$52("resumeAutomaticUpdates")},$41:function(){return this.$52("toggleAutomaticUpdates")},$42:function(e,t){this.$3.width=e,this.$3.height=t,this.$2.style.width=this.$3.width,this.$2.style.height=this.$3.height},$43:function(e,t){this.$50(s.$create_Size(-1,-1)),this.$42(e,t),this.$6._updateActiveSheetAsync()},$44:function(e){this.$C=e},$45:function(){return this.$3.parentElement},$46:function(){try{s._VizManagerImpl.$2(this.$1)}catch(e){throw this.$33(),e}this.$3.fixedSize?(this.$2=this.$58(),this.$34()):(this.$4=s._Utility.computeContentSize(this.get_$2B()),this.$4.width&&this.$4.height||(this.$4=s.$create_Size(800,600)),this.$2=this.$58(),this.$36()),s._Utility.hasWindowPostMessage()||(s._Utility.isIE()?this.$2.onreadystatechange=this.$5A():this.$2.onload=this.$5A()),this.$B=!this.$3.toolbar,this.$A=!this.$3.tabs,this.$D.get_router().registerHandler(this),this.$2.src=this.$3.get_url()},$47:function(){if(s._Utility.hasWindowPostMessage()&&!r.isNullOrUndefined(this.$2)&&r.isValue(this.$2.contentWindow)){var e=s._Utility.elementOffset(this.$2),t=[];t.push("vizOffsetResp"),t.push(e.x),t.push(e.y),this.$2.contentWindow.postMessage(t.join(","),"*")}},_sendCommand:function(e,t){this.$D.sendCommand(e,t)},$48:function(e){null!=this.$18&&this.$18(new s.ParameterEvent("parametervaluechange",this.$1,e))},$49:function(e){null!=this.$1A&&this.$1A(new s.CustomViewEvent("customviewload",this.$1,r.isValue(e)?e._impl:null))},$4A:function(e){null!=this.$1C&&this.$1C(new s.CustomViewEvent("customviewsave",this.$1,e._impl))},$4B:function(e){null!=this.$1E&&this.$1E(new s.CustomViewEvent("customviewremove",this.$1,e._impl))
},$4C:function(e){null!=this.$20&&this.$20(new s.CustomViewEvent("customviewsetdefault",this.$1,e._impl))},$4D:function(e,t){null!=this.$22&&this.$22(new s.TabSwitchEvent("tabswitch",this.$1,e,t))},raiseStoryPointSwitch:function(e,t){null!=this.$24&&this.$24(new s.StoryPointSwitchEvent("storypointswitch",this.$1,e,t))},$4E:function(){null!=this.$12&&this.$12(this)},$4F:function(){null!=this.$11&&this.$11(this)},$50:function(e){null!=this.$26&&this.$26(new s.VizResizeEvent("vizresize",this.$1,e))},$51:function(e){if(r.isNullOrUndefined(e))return null;var t=this.$6.$A(e);if(r.isNullOrUndefined(t))throw s._TableauException.createNotActiveSheet();return t.get_name()},$52:function(e){if("pauseAutomaticUpdates"!==e&&"resumeAutomaticUpdates"!==e&&"toggleAutomaticUpdates"!==e)throw s._TableauException.createInternalError(null);var t={};t["api.invokeCommandName"]=e;var i=new s._Deferred,n=new s._CommandReturnHandler("api.InvokeCommandCommand",0,r.Delegate.create(this,function(e){var t=e;r.isValue(t)&&r.isValue(t.isAutoUpdate)&&(this.$C=!t.isAutoUpdate),i.resolve(this.$C)}),function(e,t){i.reject(s._TableauException.createServerError(t))});return this._sendCommand(t,n),i.get_promise()},$53:function(e,t){if("showExportImageDialog"!==e&&"showExportDataDialog"!==e&&"showExportCrosstabDialog"!==e&&"showExportPDFDialog"!==e&&"showShareDialog"!==e&&"showDownloadWorkbookDialog"!==e)throw s._TableauException.createInternalError(null);var i={};i["api.invokeCommandName"]=e,r.isValue(t)&&(i["api.invokeCommandParam"]=t);var n=new s._CommandReturnHandler("api.InvokeCommandCommand",0,null,null);this._sendCommand(i,n)},$54:function(e){if(!this.$9){var t=this.$7;window.setTimeout(r.Delegate.create(this,function(){r.isValue(t)&&t(new s.TableauEvent("firstinteractive",this.$1)),r.isValue(e)&&e()}),0),this.$9=!0}this.$4E()},$55:function(e){var t=new Date,i=null;(i=r.Delegate.create(this,function(){var n=new Date;if(this.$9)e();else{if(n-t>3e5)throw s._TableauException.createInternalError("Timed out while waiting for the viz to become interactive");
window.setTimeout(i,10)}}))()},$56:function(){s._Utility.isIE()?"complete"===this.$2.readyState&&this.handleVizLoad():this.handleVizLoad()},$57:function(){window.setTimeout(r.Delegate.create(this,this.$56),3e3)},$58:function(){if(r.isNullOrUndefined(this.$45()))return null;var e=document.createElement("IFrame");return e.frameBorder="0",e.setAttribute("allowTransparency","true"),e.marginHeight="0",e.marginWidth="0",e.style.display="block",this.$3.fixedSize?(e.style.width=this.$3.width,e.style.height=this.$3.height):(e.style.width="1px",e.style.height="1px",e.setAttribute("scrolling","no")),s._Utility.isSafari()&&e.addEventListener("mousewheel",r.Delegate.create(this,this.$59),!1),this.$45().appendChild(e),e},$59:function(){},$5A:function(){return r.Delegate.create(this,function(){this.$57()})},$5B:function(e){var t=s.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints);this.$E=s.$create_VizSize(t,e.chromeHeight),r.isValue(this.$8)&&this.$8(new s.FirstVizSizeKnownEvent("firstvizsizeknown",this.$1,this.$E)),this.$3.fixedSize||(this.$32(),this.$5D(),this.$34())},$5C:function(){r.isNullOrUndefined(this.$F)||(s._Utility.hasWindowAddEventListener()?window.removeEventListener("resize",this.$F,!1):window.self.detachEvent("onresize",this.$F),this.$F=null)},$5D:function(){r.isValue(this.$F)||(this.$F=r.Delegate.create(this,function(){this.$32()}),s._Utility.hasWindowAddEventListener()?window.addEventListener("resize",this.$F,!1):window.self.attachEvent("onresize",this.$F))}},s._VizManagerImpl=function(){},s._VizManagerImpl.get_$1=function(){return s._VizManagerImpl.$0.concat()},s._VizManagerImpl.$2=function(e){s._VizManagerImpl.$5(e),s._VizManagerImpl.$0.push(e)},s._VizManagerImpl.$3=function(e){for(var t=0,i=s._VizManagerImpl.$0.length;i>t;t++)if(s._VizManagerImpl.$0[t]===e){s._VizManagerImpl.$0.splice(t,1);break}},s._VizManagerImpl.$4=function(){for(var e=0,t=s._VizManagerImpl.$0.length;t>e;e++)s._VizManagerImpl.$0[e]._impl.$47()},s._VizManagerImpl.$5=function(e){for(var t=e.getParentElement(),i=0,n=s._VizManagerImpl.$0.length;n>i;i++)if(s._VizManagerImpl.$0[i].getParentElement()===t){var r="Another viz is already present in element '"+s._Utility.elementToString(t)+"'.";
throw s._TableauException.create("vizAlreadyInManager",r)}},s._VizParameters=function(e,t,i){if(r.isNullOrUndefined(e)||r.isNullOrUndefined(t))throw s._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");r.isNullOrUndefined(i)&&(i={},i.hideTabs=!1,i.hideToolbar=!1,i.onFirstInteractive=null),r.isValue(i.height)||r.isValue(i.width)?(this.fixedSize=!0,s._Utility.isNumber(i.height)&&(i.height=i.height.toString()+"px"),s._Utility.isNumber(i.width)&&(i.width=i.width.toString()+"px"),this.height=r.isValue(i.height)?i.height.toString():null,this.width=r.isValue(i.width)?i.width.toString():null):this.fixedSize=!1,this.tabs=!i.hideTabs,this.toolbar=!i.hideToolbar,this.parentElement=e,this.$1=i,this.toolBarPosition=i.toolbarPosition;var n=t.split("?");this.$0=n[0],this.userSuppliedParameters=2===n.length?n[1]:"";var a=new RegExp(".*?[^/:]/","").exec(this.$0);if(r.isNullOrUndefined(a)||-1===a[0].toLowerCase().indexOf("http://")&&-1===a[0].toLowerCase().indexOf("https://"))throw s._TableauException.create("invalidUrl","Invalid url");this.host_url=a[0].toLowerCase(),this.name=this.$0.replace(a[0],""),this.name=this.name.replace("views/",""),this.serverRoot=decodeURIComponent(this.host_url)},s._VizParameters.prototype={name:"",host_url:null,tabs:!1,toolbar:!1,toolBarPosition:null,handlerId:null,width:null,height:null,serverRoot:null,parentElement:null,userSuppliedParameters:null,fixedSize:!1,$0:null,$1:null,get_url:function(){return this.$2()},get_baseUrl:function(){return this.$0},$2:function(){var e=[];e.push(this.get_baseUrl()),e.push("?"),this.userSuppliedParameters.length>0&&(e.push(this.userSuppliedParameters),e.push("&")),e.push(":embed=y"),e.push("&:showVizHome=n"),this.fixedSize||e.push("&:bootstrapWhenNotified=y"),this.tabs||e.push("&:tabs=n"),this.toolbar?r.isNullOrUndefined(this.toolBarPosition)||(e.push("&:toolbar="),e.push(this.toolBarPosition)):e.push("&:toolbar=n");var t=this.$1,i=t;for(var n in i){var a={key:n,value:i[n]};
"embed"!==a.key&&"height"!==a.key&&"width"!==a.key&&"autoSize"!==a.key&&"hideTabs"!==a.key&&"hideToolbar"!==a.key&&"onFirstInteractive"!==a.key&&"onFirstVizSizeKnown"!==a.key&&"toolbarPosition"!==a.key&&"instanceIdToClone"!==a.key&&(e.push("&"),e.push(encodeURIComponent(a.key)),e.push("="),e.push(encodeURIComponent(a.value.toString())))}return e.push("&:apiID="+this.handlerId),r.isValue(this.$1.instanceIdToClone)&&e.push("#"+this.$1.instanceIdToClone),e.join("")}},s._WorkbookImpl=function(e,t,i){this.$5=new s._Collection,this.$14=new s._Collection,this.$15=new s._Collection,this.$16=new s._Collection,this.$1=e,this.$7=t,this.$F(i)},s._WorkbookImpl.$8=function(e){e=e||[];for(var t=[],i=0;i<e.length;i++){var n=e[i],r=n.zoneType,a=s.$create_Size(n.width,n.height),o=s.$create_Point(n.x,n.y),l=n.name,u=s.$create_JavaScriptApi$0(l,r,o,a,n.zoneId);t.push(u)}return t},s._WorkbookImpl.$9=function(e){if(r.isNullOrUndefined(e))return null;if(s._Utility.isString(e))return e;var t=e,i=r.Delegate.create(t,t.getName);return r.isValue(i)?i():null},s._WorkbookImpl.$D=function(e){return r.isNullOrUndefined(e)?s.SheetSizeFactory.createAutomatic():s.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints)},s._WorkbookImpl.$27=function(e){for(var t=new s._Collection,i=r.IEnumerator.getEnumerator(e.parameters);i.moveNext();){var n=i.current,a=new s._ParameterImpl(n);t._add(a.get_$B(),a.get_$A())}return t},s._WorkbookImpl.$28=function(e,t){for(var i=r.IEnumerator.getEnumerator(t.parameters);i.moveNext();){var n=i.current;if(n.name===e)return new s._ParameterImpl(n)}return null},s._WorkbookImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$6:!1,$7:null,get_workbook:function(){return r.isNullOrUndefined(this.$0)&&(this.$0=new tableauSoftware.Workbook(this)),this.$0},get_viz:function(){return this.$1.get_$27()},get_publishedSheets:function(){return this.$5},get_name:function(){return this.$2},get_activeSheetImpl:function(){return this.$3},get_activeCustomView:function(){return this.$13},get_isDownloadAllowed:function(){return this.$6
},$A:function(e){if(r.isNullOrUndefined(this.$3))return null;var t=s._WorkbookImpl.$9(e);if(r.isNullOrUndefined(t))return null;if(t===this.$3.get_name())return this.$3;if(this.$3.get_isDashboard()){var i=this.$3,n=i.get_worksheets()._get(t);if(r.isValue(n))return n._impl}return null},_setActiveSheetAsync:function(e){if(s._Utility.isNumber(e)){var t=e;if(t<this.$5.get__length()&&t>=0)return this.$B(this.$5.get_item(t).$0);throw s._TableauException.createIndexOutOfRange(t)}var i=s._WorkbookImpl.$9(e),n=this.$5._get(i);if(r.isValue(n))return this.$B(n.$0);if(this.$3.get_isDashboard()){var a=this.$3,o=a.get_worksheets()._get(i);if(r.isValue(o)){this.$4=null;var l="";return o.getIsHidden()?this.$4=o._impl:l=o._impl.get_url(),this.$C(o._impl.get_name(),l)}}throw s._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function(){var e=new s._Deferred,t=new s._CommandReturnHandler("api.RevertAllCommand",1,function(){e.resolve()},function(t,i){e.reject(s._TableauException.createServerError(i))});return this.$E(null,t),e.get_promise()},_update:function(e){this.$F(e)},$B:function(e){return this.$C(e.name,e.url)},$C:function(e,t){var i=new s._Deferred;if(r.isValue(this.$3)&&e===this.$3.get_name())return i.resolve(this.$3.get_sheet()),i.get_promise();var n={};n["api.switchToSheetName"]=e,n["api.switchToRepositoryUrl"]=t,n["api.oldRepositoryUrl"]=this.$3.get_url();var a=new s._CommandReturnHandler("api.SwitchActiveSheetCommand",0,r.Delegate.create(this,function(){this.$1.$0=r.Delegate.create(this,function(){this.$1.$0=null,i.resolve(this.$3.get_sheet())})}),function(e,t){i.reject(s._TableauException.createServerError(t))});return this.$E(n,a),i.get_promise()},_updateActiveSheetAsync:function(){var e=new s._Deferred,t={};t["api.switchToSheetName"]=this.$3.get_name(),t["api.switchToRepositoryUrl"]=this.$3.get_url(),t["api.oldRepositoryUrl"]=this.$3.get_url();var i=new s._CommandReturnHandler("api.UpdateActiveSheetCommand",0,r.Delegate.create(this,function(){e.resolve(this.$3.get_sheet())
}),function(t,i){e.reject(s._TableauException.createServerError(i))});return this.$E(t,i),e.get_promise()},$E:function(e,t){this.$7.sendCommand(e,t)},$F:function(e){var t=new s._CommandReturnHandler("api.GetClientInfoCommand",0,r.Delegate.create(this,function(t){var i=t;this.$10(i),r.isValue(e)&&e()}),null);this.$E(null,t)},$10:function(e){this.$2=e.workbookName,this.$6=e.isDownloadAllowed,this.$1.$44(!e.isAutoUpdate),this.$12(e),this.$11(e)},$11:function(e){var t=e.currentSheetName,i=this.$5._get(t);if(r.isNullOrUndefined(i)&&r.isNullOrUndefined(this.$4))throw s._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!r.isValue(this.$3)||this.$3.get_name()!==t){if(r.isValue(this.$3)){this.$3.set_isActive(!1);var n=this.$5._get(this.$3.get_name());if(r.isValue(n)&&(n.$0.isActive=!1),"story"===this.$3.get_sheetType()){var a=this.$3;a.remove_activeStoryPointChange(r.Delegate.create(this.$1,this.$1.raiseStoryPointSwitch))}}if(r.isValue(this.$4)){var o=s.$create__SheetInfoImpl(this.$4.get_name(),"worksheet",-1,this.$4.get_size(),this.get_workbook(),"",!0,!0,4294967295);this.$4=null,this.$3=new s._WorksheetImpl(o,this,this.$7,null)}else{for(var l=null,u=0,h=e.publishedSheets.length;h>u;u++)if(e.publishedSheets[u].name===t){l=e.publishedSheets[u];break}if(r.isNullOrUndefined(l))throw s._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var c=r.Delegate.create(this,function(e){return this.$5._get(e)});if("dashboard"===l.sheetType){var p=new s._DashboardImpl(i.$0,this,this.$7);this.$3=p;var f=s._WorkbookImpl.$8(e.dashboardZones);p.$11(f,c)}else if("story"===l.sheetType){var $=new s._StoryImpl(i.$0,this,this.$7,e.story,c);this.$3=$,$.add_activeStoryPointChange(r.Delegate.create(this.$1,this.$1.raiseStoryPointSwitch))}else this.$3=new s._WorksheetImpl(i.$0,this,this.$7,null);i.$0.isActive=!0}this.$3.set_isActive(!0)}},$12:function(e){var t=e.publishedSheets;if(!r.isNullOrUndefined(t))for(var i=0;i<t.length;i++){var n=t[i],a=n.name,o=this.$5._get(a),l=s._WorkbookImpl.$D(n);
if(r.isNullOrUndefined(o)){var u=a===e.currentSheetName,h=n.sheetType,c=s.$create__SheetInfoImpl(a,h,i,l,this.get_workbook(),n.repositoryUrl,u,!1,4294967295);o=new tableauSoftware.SheetInfo(c),this.$5._add(a,o)}else o.$0.size=l}},$13:null,get_$17:function(){return this.$14},set_$17:function(e){return this.$14=e,e},get_$18:function(){return this.$15},set_$18:function(e){return this.$15=e,e},get_$19:function(){return this.$16},set_$19:function(e){return this.$16=e,e},get_$1A:function(){return this.$13},set_$1A:function(e){return this.$13=e,e},$1B:function(){return s._CustomViewImpl._getCustomViewsAsync(this,this.$7)},$1C:function(e){if(r.isNullOrUndefined(e)||s._Utility.isNullOrEmpty(e))return s._CustomViewImpl._showCustomViewAsync(this,this.$7,null);var t=this.$14._get(e);if(r.isNullOrUndefined(t)){var i=new s._Deferred;return i.reject(s._TableauException.createInvalidCustomViewName(e)),i.get_promise()}return t._impl._showAsync()},$1D:function(e){if(s._Utility.isNullOrEmpty(e))throw s._TableauException.createNullOrEmptyParameter("customViewName");var t=this.$14._get(e);if(r.isNullOrUndefined(t)){var i=new s._Deferred;return i.reject(s._TableauException.createInvalidCustomViewName(e)),i.get_promise()}return t._impl.$12()},$1E:function(e){if(s._Utility.isNullOrEmpty(e))throw s._TableauException.createInvalidParameter("customViewName");return s._CustomViewImpl._saveNewAsync(this,this.$7,e)},$1F:function(){return s._CustomViewImpl._makeCurrentCustomViewDefaultAsync(this,this.$7)},$20:null,$21:null,get_$22:function(){return this.$21},set_$22:function(e){return this.$21=e,e},get_$23:function(){return this.$20},$24:function(e){var t=new s._Deferred;if(r.isValue(this.$21))return t.resolve(this.$21.get_$A()),t.get_promise();var i={},n=new s._CommandReturnHandler("api.FetchParametersCommand",0,r.Delegate.create(this,function(i){var n=i,r=s._WorkbookImpl.$28(e,n);this.$21=r,t.resolve(r.get_$A())}),function(e,i){t.reject(s._TableauException.createServerError(i))});return this.$E(i,n),t.get_promise()
},$25:function(){var e=new s._Deferred,t={},i=new s._CommandReturnHandler("api.FetchParametersCommand",0,r.Delegate.create(this,function(t){var i=t;this.$20=s._WorkbookImpl.$27(i),e.resolve(this.get_$23()._toApiCollection())}),function(t,i){e.reject(s._TableauException.createServerError(i))});return this.$E(t,i),e.get_promise()},$26:function(e,t){var i=new s._Deferred,n=null;if(r.isValue(this.$20)){if(r.isNullOrUndefined(this.$20._get(e)))return i.reject(s._TableauException.createInvalidParameter(e)),i.get_promise();if(n=this.$20._get(e)._impl,r.isNullOrUndefined(n))return i.reject(s._TableauException.createInvalidParameter(e)),i.get_promise()}var a={};if(a["api.setParameterName"]=r.isValue(this.$20)?n.get_$B():e,r.isValue(t)&&s._Utility.isDate(t)){var o=t,l=s._Utility.serializeDateForServer(o);a["api.setParameterValue"]=l}else a["api.setParameterValue"]=r.isValue(t)?t.toString():null;this.$21=null;var u=new s._CommandReturnHandler("api.SetParameterValueCommand",0,r.Delegate.create(this,function(t){var n=t;if(r.isNullOrUndefined(n))return void i.reject(s._TableauException.create("serverError","server error"));if(!n.isValidPresModel)return void i.reject(s._TableauException.createInvalidParameter(e));var a=new s._ParameterImpl(n);this.$21=a,i.resolve(a.get_$A())}),function(){i.reject(s._TableauException.createInvalidParameter(e))});return this.$E(a,u),i.get_promise()}},s._WorksheetImpl=function(e,t,i,n){this.$14=new s._Collection,this.$26=new s._Collection,s._WorksheetImpl.initializeBase(this,[e,t,i]),this.$F=n},s._WorksheetImpl.$15=function(e){var t=e;if(r.isValue(t)&&r.isValue(t.errorCode)){var i=t.additionalInformation;switch(t.errorCode){case"invalidFilterFieldName":case"invalidFilterFieldValue":return s._TableauException.create(t.errorCode,i);case"invalidAggregationFieldName":return s._TableauException.$0(i);default:return s._TableauException.createServerError(i)}}return null},s._WorksheetImpl.$1D=function(e){if(r.isNullOrUndefined(e))throw s._TableauException.createNullOrEmptyParameter("filterOptions");
if(r.isNullOrUndefined(e.min)&&r.isNullOrUndefined(e.max))throw s._TableauException.create("invalidParameter","At least one of filterOptions.min or filterOptions.max must be specified.");var t={};return r.isValue(e.min)&&(t.min=e.min),r.isValue(e.max)&&(t.max=e.max),r.isValue(e.nullOption)&&(t.nullOption=s._Enums.$5(e.nullOption,"filterOptions.nullOption")),t},s._WorksheetImpl.$1E=function(e){if(r.isNullOrUndefined(e))throw s._TableauException.createNullOrEmptyParameter("filterOptions");var t={};if(t.rangeType=s._Enums.$1(e.rangeType,"filterOptions.rangeType"),t.periodType=s._Enums.$0(e.periodType,"filterOptions.periodType"),"lastn"===t.rangeType||"nextn"===t.rangeType){if(r.isNullOrUndefined(e.rangeN))throw s._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");t.rangeN=s._Utility.toInt(e.rangeN)}if(r.isValue(e.anchorDate)){if(!s._Utility.isDate(e.anchorDate)||!s._Utility.isDateValid(e.anchorDate))throw s._TableauException.createInvalidDateParameter("filterOptions.anchorDate");t.anchorDate=e.anchorDate}return t},s._WorksheetImpl.$1F=function(e,t,i){return new s._CommandReturnHandler(e,1,function(e){var n=s._WorksheetImpl.$15(e);null==n?i.resolve(t):i.reject(n)},function(e,n){if(e)i.reject(s._TableauException.createInvalidFilterFieldNameOrValue(t));else{var r=s._TableauException.create("filterCannotBePerformed",n);i.reject(r)}})},s._WorksheetImpl.$2A=function(e){var t=e;if(r.isValue(t)&&r.isValue(t.errorCode)){var i=t.additionalInformation;switch(t.errorCode){case"invalidSelectionFieldName":case"invalidSelectionValue":case"invalidSelectionDate":return s._TableauException.create(t.errorCode,i)}}return null},s._WorksheetImpl.prototype={$E:null,$F:null,get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){return null==this.$E&&(this.$E=new tableauSoftware.Worksheet(this)),this.$E},get_parentDashboardImpl:function(){return this.$F},get_parentDashboard:function(){return r.isValue(this.$F)?this.$F.get_dashboard():null
},$10:function(){this.$12();var e=new s._Deferred,t={};t["api.worksheetName"]=this.get_name();var i=new s._CommandReturnHandler("api.GetDataSourcesCommand",0,function(t){var i=t,n=s._DataSourceImpl.processDataSourcesForWorksheet(i);e.resolve(n._toApiCollection())},function(t,i){e.reject(s._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},$11:function(e){this.$12();var t=new s._Deferred,i={};i["api.dataSourceName"]=e,i["api.worksheetName"]=this.get_name();var n=new s._CommandReturnHandler("api.GetDataSourceCommand",0,function(i){var n=i,a=s._DataSourceImpl.processDataSource(n);r.isValue(a)?t.resolve(a.get_dataSource()):t.reject(s._TableauException.createServerError("Data source '"+e+"' not found"))},function(e,i){t.reject(s._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},$12:function(){var e=this.get_isActive(),t=r.isValue(this.$F)&&this.$F.get_isActive(),i=r.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!e&&!t&&!i)throw s._TableauException.createNotActiveSheet()},$13:function(e){if(r.isValue(this.get_parentStoryPointImpl())){var t={};t.st=this.get_name(),r.isValue(this.get_parentDashboardImpl())&&(t.su=this.get_parentDashboardImpl().get_name()),t.aa9=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),t.ll=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),t.abq=this.get_parentStoryPointImpl().get_storyPointId(),e["api.visualId"]=t}else e["api.worksheetName"]=this.get_name(),r.isValue(this.get_parentDashboardImpl())&&(e["api.dashboardName"]=this.get_parentDashboardImpl().get_name())},get__filters:function(){return this.$14},set__filters:function(e){return this.$14=e,e},$16:function(e,t,i){if(!s._Utility.isNullOrEmpty(e)&&!s._Utility.isNullOrEmpty(t))throw s._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");i=i||{};var n=new s._Deferred,a={};this.$13(a),!s._Utility.isNullOrEmpty(t)&&s._Utility.isNullOrEmpty(e)&&(a["api.fieldCaption"]=t),s._Utility.isNullOrEmpty(e)||(a["api.fieldName"]=e),a["api.filterHierarchicalLevels"]=0,a["api.ignoreDomain"]=i.ignoreDomain||!1;
var o=new s._CommandReturnHandler("api.GetOneFilterInfoCommand",0,r.Delegate.create(this,function(e){var t=s._WorksheetImpl.$15(e);if(null==t){var i=e,r=tableauSoftware.Filter.$7(this,i);n.resolve(r)}else n.reject(t)}),function(e,t){n.reject(s._TableauException.createServerError(t))});return this.sendCommand(a,o),n.get_promise()},$17:function(e){this.$12(),e=e||{};var t=new s._Deferred,i={};this.$13(i),i["api.ignoreDomain"]=e.ignoreDomain||!1;var n=new s._CommandReturnHandler("api.GetFiltersListCommand",0,r.Delegate.create(this,function(e){var i=e;this.set__filters(tableauSoftware.Filter.$8(this,i)),t.resolve(this.get__filters()._toApiCollection())}),function(e,i){t.reject(s._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},$18:function(e,t,i,n){return this.$21(e,t,i,n)},$19:function(e){return this.$20(e)},$1A:function(e,t){var i=s._WorksheetImpl.$1D(t);return this.$22(e,i)},$1B:function(e,t){var i=s._WorksheetImpl.$1E(t);return this.$23(e,i)},$1C:function(e,t,i,n){if(r.isNullOrUndefined(t)&&"all"!==i)throw s._TableauException.createInvalidParameter("values");return this.$24(e,t,i,n)},$20:function(e){if(this.$12(),s._Utility.isNullOrEmpty(e))throw s._TableauException.createNullOrEmptyParameter("fieldName");var t=new s._Deferred,i={};i["api.fieldCaption"]=e,this.$13(i);var n=s._WorksheetImpl.$1F("api.ClearFilterCommand",e,t);return this.sendCommand(i,n),t.get_promise()},$21:function(e,t,i,n){if(this.$12(),s._Utility.isNullOrEmpty(e))throw s._TableauException.createNullOrEmptyParameter("fieldName");i=s._Enums.$2(i,"updateType");var a=[];if(s._jQueryShim.$12(t))for(var o=0;o<t.length;o++)a.push(t[o].toString());else r.isValue(t)&&a.push(t.toString());var l=new s._Deferred,u={};u["api.fieldCaption"]=e,u["api.filterUpdateType"]=i,u["api.exclude"]=r.isValue(n)&&n.isExcludeMode?!0:!1,"all"!==i&&(u["api.filterCategoricalValues"]=a),this.$13(u);var h=s._WorksheetImpl.$1F("api.ApplyCategoricalFilterCommand",e,l);return this.sendCommand(u,h),l.get_promise()
},$22:function(e,t){if(this.$12(),s._Utility.isNullOrEmpty(e))throw s._TableauException.createNullOrEmptyParameter("fieldName");if(r.isNullOrUndefined(t))throw s._TableauException.createNullOrEmptyParameter("filterOptions");var i={};if(i["api.fieldCaption"]=e,r.isValue(t.min))if(s._Utility.isDate(t.min)){var n=t.min;if(!s._Utility.isDateValid(n))throw s._TableauException.createInvalidDateParameter("filterOptions.min");i["api.filterRangeMin"]=s._Utility.serializeDateForServer(n)}else i["api.filterRangeMin"]=t.min;if(r.isValue(t.max))if(s._Utility.isDate(t.max)){var a=t.max;if(!s._Utility.isDateValid(a))throw s._TableauException.createInvalidDateParameter("filterOptions.max");i["api.filterRangeMax"]=s._Utility.serializeDateForServer(a)}else i["api.filterRangeMax"]=t.max;r.isValue(t.nullOption)&&(i["api.filterRangeNullOption"]=t.nullOption),this.$13(i);var o=new s._Deferred,l=s._WorksheetImpl.$1F("api.ApplyRangeFilterCommand",e,o);return this.sendCommand(i,l),o.get_promise()},$23:function(e,t){if(this.$12(),s._Utility.isNullOrEmpty(e))throw s._TableauException.createInvalidParameter("fieldName");if(r.isNullOrUndefined(t))throw s._TableauException.createInvalidParameter("filterOptions");var i={};if(i["api.fieldCaption"]=e,r.isValue(t)){if(i["api.filterPeriodType"]=t.periodType,i["api.filterDateRangeType"]=t.rangeType,"lastn"===t.rangeType||"nextn"===t.rangeType){if(r.isNullOrUndefined(t.rangeN))throw s._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");i["api.filterDateRange"]=t.rangeN}r.isValue(t.anchorDate)&&(i["api.filterDateArchorValue"]=s._Utility.serializeDateForServer(t.anchorDate))}this.$13(i);var n=new s._Deferred,a=s._WorksheetImpl.$1F("api.ApplyRelativeDateFilterCommand",e,n);return this.sendCommand(i,a),n.get_promise()},$24:function(e,t,i,n){if(this.$12(),s._Utility.isNullOrEmpty(e))throw s._TableauException.createNullOrEmptyParameter("fieldName");i=s._Enums.$2(i,"updateType");var a=null,o=null;
if(s._jQueryShim.$12(t)){a=[];for(var l=t,u=0;u<l.length;u++)a.push(l[u].toString())}else if(s._Utility.isString(t))a=[],a.push(t.toString());else if(r.isValue(t)&&r.isValue(t.levels)){var h=t.levels;if(o=[],s._jQueryShim.$12(h))for(var c=h,p=0;p<c.length;p++)o.push(c[p].toString());else o.push(h.toString())}else if(r.isValue(t))throw s._TableauException.createInvalidParameter("values");var f={};f["api.fieldCaption"]=e,f["api.filterUpdateType"]=i,f["api.exclude"]=r.isValue(n)&&n.isExcludeMode?!0:!1,null!=a&&(f["api.filterHierarchicalValues"]=s.JsonUtil.toJson(a,!1,"")),null!=o&&(f["api.filterHierarchicalLevels"]=s.JsonUtil.toJson(o,!1,"")),this.$13(f);var $=new s._Deferred,_=s._WorksheetImpl.$1F("api.ApplyHierarchicalFilterCommand",e,$);return this.sendCommand(f,_),$.get_promise()},get_selectedMarks:function(){return this.$26},set_selectedMarks:function(e){return this.$26=e,e},$27:function(){this.$12();var e=new s._Deferred,t={};this.$13(t),t["api.filterUpdateType"]="replace";var i=new s._CommandReturnHandler("api.SelectMarksCommand",1,function(){e.resolve()},function(t,i){e.reject(s._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},$28:function(e,t,i){return this.$12(),null==e&&null==t?this.$27():s._Utility.isString(e)&&(s._jQueryShim.$12(t)||s._Utility.isString(t)||!s._Enums.$4(t))?this.$2B(e,t,i):s._jQueryShim.$12(e)?this.$2D(e,t):this.$2C(e,t)},$29:function(){this.$12();var e=new s._Deferred,t={};this.$13(t);var i=new s._CommandReturnHandler("api.FetchSelectedMarksCommand",0,r.Delegate.create(this,function(t){var i=t;this.$26=s._MarkImpl.$6(i),e.resolve(this.$26._toApiCollection())}),function(t,i){e.reject(s._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},$2B:function(e,t,i){var n=[],r=[],a=[],o=[],s=[],l=[];return this.$2E(n,r,a,o,s,l,e,t),this.$30(null,n,r,a,o,s,l,i)},$2C:function(e,t){var i=e,n=[],r=[],a=[],o=[],l=[],u=[],h=i;for(var c in h){var p={key:c,value:h[c]};e.hasOwnProperty(p.key)&&(s._jQueryShim.$11(i[p.key])||this.$2E(n,r,a,o,l,u,p.key,p.value))
}return this.$30(null,n,r,a,o,l,u,t)},$2D:function(e,t){for(var i=[],n=[],a=[],o=[],l=[],u=[],h=[],c=0;c<e.length;c++){var p=e[c];if(r.isValue(p.$0.get_$4())&&p.$0.get_$4()>0)h.push(p.$0.get_$4());else for(var f=p.$0.get_$3(),$=0;$<f.get__length();$++){var _=f.get_item($);_.hasOwnProperty("fieldName")&&_.hasOwnProperty("value")&&!s._jQueryShim.$11(_.fieldName)&&!s._jQueryShim.$11(_.value)&&this.$2E(i,n,a,o,l,u,_.fieldName,_.value)}}return this.$30(h,i,n,a,o,l,u,t)},$2E:function(e,t,i,n,a,o,l,u){var h=u;if(s._WorksheetImpl.$25.test(l))this.$2F(i,n,l,u);else if(r.isValue(h.min)||r.isValue(h.max)){var c={};if(r.isValue(h.min))if(s._Utility.isDate(h.min)){var p=h.min;if(!s._Utility.isDateValid(p))throw s._TableauException.createInvalidDateParameter("options.min");c.min=s._Utility.serializeDateForServer(p)}else c.min=h.min;if(r.isValue(h.max))if(s._Utility.isDate(h.max)){var f=h.max;if(!s._Utility.isDateValid(f))throw s._TableauException.createInvalidDateParameter("options.max");c.max=s._Utility.serializeDateForServer(f)}else c.max=h.max;if(r.isValue(h.nullOption)){var $=s._Enums.$5(h.nullOption,"options.nullOption");c.nullOption=$}else c.nullOption="allValues";var _=s.JsonUtil.toJson(c,!1,"");this.$2F(a,o,l,_)}else this.$2F(e,t,l,u)},$2F:function(e,t,i,n){var r=[];if(s._jQueryShim.$12(n))for(var a=n,o=0;o<a.length;o++)r.push(a[o]);else r.push(n);t.push(r),e.push(i)},$30:function(e,t,i,n,r,a,o,l){var u={};if(this.$13(u),l=s._Enums.$3(l,"updateType"),u["api.filterUpdateType"]=l,s._Utility.isNullOrEmpty(e)||(u["api.tupleIds"]=s.JsonUtil.toJson(e,!1,"")),!s._Utility.isNullOrEmpty(t)&&!s._Utility.isNullOrEmpty(i)){u["api.categoricalFieldCaption"]=s.JsonUtil.toJson(t,!1,"");for(var h=[],c=0;c<i.length;c++){var p=s.JsonUtil.toJson(i[c],!1,"");h.push(p)}u["api.categoricalMarkValues"]=s.JsonUtil.toJson(h,!1,"")}if(!s._Utility.isNullOrEmpty(n)&&!s._Utility.isNullOrEmpty(r)){u["api.hierarchicalFieldCaption"]=s.JsonUtil.toJson(n,!1,"");for(var f=[],$=0;$<r.length;$++){var _=s.JsonUtil.toJson(r[$],!1,"");
f.push(_)}u["api.hierarchicalMarkValues"]=s.JsonUtil.toJson(f,!1,"")}if(!s._Utility.isNullOrEmpty(a)&&!s._Utility.isNullOrEmpty(o)){u["api.rangeFieldCaption"]=s.JsonUtil.toJson(a,!1,"");for(var m=[],d=0;d<o.length;d++){var g=s.JsonUtil.toJson(o[d],!1,"");m.push(g)}u["api.rangeMarkValues"]=s.JsonUtil.toJson(m,!1,"")}if(s._Utility.isNullOrEmpty(u["api.tupleIds"])&&s._Utility.isNullOrEmpty(u["api.categoricalFieldCaption"])&&s._Utility.isNullOrEmpty(u["api.hierarchicalFieldCaption"])&&s._Utility.isNullOrEmpty(u["api.rangeFieldCaption"]))throw s._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var v=new s._Deferred,w=new s._CommandReturnHandler("api.SelectMarksCommand",1,function(e){var t=s._WorksheetImpl.$2A(e);null==t?v.resolve():v.reject(t)},function(e,t){v.reject(s._TableauException.createServerError(t))});return this.sendCommand(u,w),v.get_promise()}},s.JsonUtil=function(){},s.JsonUtil.parseJson=function(e){return s._jQueryShim.parseJSON(e)},s.JsonUtil.toJson=function(e,t,i){t=t||!1,i=i||"";var n=[];return s.JsonUtil.$3(e,t,i,n)},s.JsonUtil.$1=function(e,t,i){if(r.isValue(Array.prototype.indexOf))return e.indexOf(t,i);i=i||0;var n=e.length;if(n>0)for(var a=i;n>a;a++)if(e[a]===t)return a;return-1},s.JsonUtil.$2=function(e,t,i){var n=s.JsonUtil.$1(e,t,i);return n>=0},s.JsonUtil.$3=function(e,t,i,n){if(s.JsonUtil.$2(n,e))throw Error.createError("The object contains recursive reference of sub-objects",null);if(r.isUndefined(e))return"undefined";if(null==e)return"null";var a=s._jQueryShim.$13(e);if("number"===a||"boolean"===a)return e.toString();if("string"===a)return s.JsonUtil.$6(e);n.push(e);var o;i=i||"";var l=t?i+"	":"",u=e.__json__||e.json;if(s._jQueryShim.$11(u)){var h=u;if(o=h(e),e!==o){var c=s.JsonUtil.$3(o,t,l,n);return n.pop(),c}}if(r.isValue(e.nodeType)&&r.isValue(e.cloneNode))throw Error.createError("Can't serialize DOM nodes",null);var p=t?" ":"",f=t?"\n":"";return s._jQueryShim.$12(e)?s.JsonUtil.$5(e,t,i,n,l,f):"function"===a?(n.pop(),null):s.JsonUtil.$4(e,t,i,n,l,f,p)
},s.JsonUtil.$4=function(e,t,i,n,a,o,l){var u=e,h=new r.StringBuilder("{"),c=!1,p=u;for(var f in p){var $,_,m={key:f,value:p[f]};if("number"==typeof m.key)$='"'+m.key+'"';else{if("string"!=typeof m.key)continue;$=s.JsonUtil.$6(m.key)}_=s.JsonUtil.$3(m.value,t,a,n),null!=_&&(c&&h.append(","),h.append(o+a+$+":"+l+_),c=!0)}return h.append(o+i+"}"),n.pop(),h.toString()},s.JsonUtil.$5=function(e,t,i,n,a,o){for(var l=!1,u=new r.StringBuilder("["),h=e,c=0;c<h.length;c++){var p=h[c],f=s.JsonUtil.$3(p,t,a,n);null==f&&(f="undefined"),l&&u.append(","),u.append(o+a+f),l=!0}return u.append(o+i+"]"),n.pop(),u.toString()},s.JsonUtil.$6=function(e){return e='"'+e.replace(/(["\\])/g,"\\$1")+'"',e=e.replace(new RegExp("[\f]","g"),"\\f"),e=e.replace(new RegExp("[\b]","g"),"\\b"),e=e.replace(new RegExp("[\n]","g"),"\\n"),e=e.replace(new RegExp("[	]","g"),"\\t"),e=e.replace(new RegExp("[\r]","g"),"\\r")},a.registerNamespace("tableauSoftware"),s.$create_DataValue=function(e,t,i){var n={};return n.value=e,n.formattedValue=s._Utility.isNullOrEmpty(i)?t:i,n},s.$create_VizSize=function(e,t){var i={};return i.sheetSize=e,i.chromeHeight=t,i},s.$create_Point=function(e,t){var i={};return i.x=e,i.y=t,i},s.$create_Size=function(e,t){var i={};return i.width=e,i.height=t,i},s.$create_SheetSize=function(e,t,i){var n={};return n.behavior=e||"automatic",r.isValue(t)&&(n.minSize=t),r.isValue(i)&&(n.maxSize=i),n},tableauSoftware.CustomView=function(e){this._impl=e},tableauSoftware.CustomView.prototype={_impl:null,getWorkbook:function(){return this._impl.get_$B()},getUrl:function(){return this._impl.get_$C()},getName:function(){return this._impl.get_$D()},setName:function(e){this._impl.set_$D(e)},getOwnerName:function(){return this._impl.get_$E()},getAdvertised:function(){return this._impl.get_$F()},setAdvertised:function(e){this._impl.set_$F(e)},getDefault:function(){return this._impl.get_$10()},saveAsync:function(){return this._impl.$11()}},s.CustomViewEvent=function(e,t,i){s.CustomViewEvent.initializeBase(this,[e,t]),this.$2=new s.JavaScriptApi$3(t._impl.get__workbookImpl(),i)
},s.CustomViewEvent.prototype={$2:null,getCustomViewAsync:function(){var e=new s._Deferred,t=null;return r.isValue(this.$2.get__customViewImpl())&&(t=this.$2.get__customViewImpl().get_$A()),e.resolve(t),e.get_promise()}},s.JavaScriptApi$3=function(e,t){s.JavaScriptApi$3.initializeBase(this,[e,null]),this.$2=t},s.JavaScriptApi$3.prototype={$2:null,get__customViewImpl:function(){return this.$2}},tableauSoftware.Dashboard=function(e){tableauSoftware.Dashboard.initializeBase(this,[e])},tableauSoftware.Dashboard.prototype={_impl:null,getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},tableauSoftware.DashboardObject=function(e,t,i){if("worksheet"===e.$0&&r.isNullOrUndefined(i))throw s._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==e.$0&&r.isValue(i))throw s._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this.$0=e,this.$1=t,this.$2=i},tableauSoftware.DashboardObject.prototype={$0:null,$1:null,$2:null,getObjectType:function(){return this.$0.$0},getDashboard:function(){return this.$1},getWorksheet:function(){return this.$2},getPosition:function(){return this.$0.$2},getSize:function(){return this.$0.$3}},tableauSoftware.DataSource=function(e){this.$0=e},tableauSoftware.DataSource.prototype={$0:null,getName:function(){return this.$0.get_name()},getFields:function(){return this.$0.get_fields()._toApiCollection()},getIsPrimary:function(){return this.$0.get_isPrimary()}},tableauSoftware.Field=function(e,t,i,n){this.$0=e,this.$1=t,this.$2=i,this.$3=n},tableauSoftware.Field.prototype={$0:null,$1:null,$2:null,$3:null,getDataSource:function(){return this.$0},getName:function(){return this.$1},getRole:function(){return this.$2},getAggregation:function(){return this.$3}},tableauSoftware.CategoricalFilter=function(e,t){tableauSoftware.CategoricalFilter.initializeBase(this,[e,t]),this.$C(t)
},tableauSoftware.CategoricalFilter.prototype={$A:!1,$B:null,getIsExcludeMode:function(){return this.$A},getAppliedValues:function(){return this.$B},_updateFromJson:function(e){this.$C(e)},$C:function(e){if(this.$A=e.isExclude,r.isValue(e.appliedValues)){this.$B=[];for(var t=r.IEnumerator.getEnumerator(e.appliedValues);t.moveNext();){var i=t.current;this.$B.push(s._Utility.getDataValue(i))}}}},tableauSoftware.Filter=function(e,t){this.$0=e,this.$9(t)},tableauSoftware.Filter.$7=function(e,t){switch(t.filterType){case"categorical":return new tableauSoftware.CategoricalFilter(e,t);case"relativedate":return new tableauSoftware.RelativeDateFilter(e,t);case"hierarchical":return new tableauSoftware.HierarchicalFilter(e,t);case"quantitative":return new tableauSoftware.QuantitativeFilter(e,t)}return null},tableauSoftware.Filter.$8=function(e,t){for(var i=new s._Collection,n=r.IEnumerator.getEnumerator(t.filters);n.moveNext();){var a=n.current,o=tableauSoftware.Filter.$7(e,a);i._add(a.caption,o)}return i},tableauSoftware.Filter.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,getFilterType:function(){return this.$1},getFieldName:function(){return this.$2},getWorksheet:function(){return this.$0.get_worksheet()},getFieldAsync:function(){var e=new s._Deferred;if(null==this.$3){var t=function(t){return e.reject(t),null},i=r.Delegate.create(this,function(t){return this.$3=new tableauSoftware.Field(t,this.$2,this.$5,this.$6),e.resolve(this.$3),null});this.$0.$11(this.$4).then(i,t)}else window.setTimeout(r.Delegate.create(this,function(){e.resolve(this.$3)}),0);return e.get_promise()},_update:function(e){this.$9(e),this._updateFromJson(e)},_addFieldParams:function(){},$9:function(e){this.$2=e.caption,this.$1=e.filterType,this.$3=null,this.$4=e.dataSourceName,this.$5=e.fieldRole||0,this.$6=e.fieldAggregation||0}},s.FilterEvent=function(e,t,i,n,r){s.FilterEvent.initializeBase(this,[e,t,i]),this.$3=r,this.$4=new s.JavaScriptApi$6(t._impl.get__workbookImpl(),i,n,r)},s.FilterEvent.prototype={$3:null,$4:null,getFieldName:function(){return this.$3
},getFilterAsync:function(){return this.$4.get__worksheetImpl().$16(this.$4.get__filterFieldName(),null,null)}},s.JavaScriptApi$6=function(e,t,i,n){s.JavaScriptApi$6.initializeBase(this,[e,t]),this.$2=i,this.$3=n},s.JavaScriptApi$6.prototype={$2:null,$3:null,get__filterFieldName:function(){return this.$2},get_$4:function(){return this.$3}},tableauSoftware.HierarchicalFilter=function(e,t){tableauSoftware.HierarchicalFilter.initializeBase(this,[e,t]),this.$B(t)},tableauSoftware.HierarchicalFilter.prototype={$A:0,_addFieldParams:function(e){e["api.filterHierarchicalLevels"]=this.$A},_updateFromJson:function(e){this.$B(e)},$B:function(e){this.$A=e.levels}},tableauSoftware.QuantitativeFilter=function(e,t){tableauSoftware.QuantitativeFilter.initializeBase(this,[e,t]),this.$F(t)},tableauSoftware.QuantitativeFilter.prototype={$A:null,$B:null,$C:null,$D:null,$E:!1,getMin:function(){return this.$C},getMax:function(){return this.$D},getIncludeNullValues:function(){return this.$E},getDomainMin:function(){return this.$A},getDomainMax:function(){return this.$B},_updateFromJson:function(e){this.$F(e)},$F:function(e){this.$A=s._Utility.getDataValue(e.domainMinValue),this.$B=s._Utility.getDataValue(e.domainMaxValue),this.$C=s._Utility.getDataValue(e.minValue),this.$D=s._Utility.getDataValue(e.maxValue),this.$E=e.includeNullValues}},tableauSoftware.RelativeDateFilter=function(e,t){tableauSoftware.RelativeDateFilter.initializeBase(this,[e,t]),this.$D(t)},tableauSoftware.RelativeDateFilter.prototype={$A:null,$B:null,$C:0,getPeriod:function(){return this.$A},getRange:function(){return this.$B},getRangeN:function(){return this.$C},_updateFromJson:function(e){this.$D(e)},$D:function(e){r.isValue(e.periodType)&&(this.$A=s._Enums.$0(e.periodType,"periodType")),r.isValue(e.rangeType)&&(this.$B=s._Enums.$1(e.rangeType,"rangeType")),r.isValue(e.rangeN)&&(this.$C=e.rangeN)}},s.FirstVizSizeKnownEvent=function(e,t,i){s.FirstVizSizeKnownEvent.initializeBase(this,[e,t]),this.$2=i},s.FirstVizSizeKnownEvent.prototype={$2:null,getVizSize:function(){return this.$2
}},tableauSoftware.Version=function(e,t,i,n){this.$1=e,this.$2=t,this.$3=i,this.$4=n||null},tableauSoftware.Version.getCurrent=function(){return tableauSoftware.Version.$0},tableauSoftware.Version.prototype={$1:0,$2:0,$3:0,$4:null,getMajor:function(){return this.$1},getMinor:function(){return this.$2},getPatch:function(){return this.$3},getMetadata:function(){return this.$4},toString:function(){var e=this.$1+"."+this.$2+"."+this.$3;return r.isValue(this.$4)&&this.$4.length>0&&(e+="-"+this.$4),e}},s.VizResizeEvent=function(e,t,i){s.VizResizeEvent.initializeBase(this,[e,t]),this.$2=i},s.VizResizeEvent.prototype={$2:null,getAvailableSize:function(){return this.$2}},tableauSoftware.Mark=function(e){this.$0=new s._MarkImpl(e)},tableauSoftware.Mark.prototype={$0:null,getPairs:function(){return this.$0.get_$5()}},s.MarksEvent=function(e,t,i){s.MarksEvent.initializeBase(this,[e,t,i]),this.$3=new s.JavaScriptApi$5(t._impl.get__workbookImpl(),i)},s.MarksEvent.prototype={$3:null,getMarksAsync:function(){var e=this.$3.get__worksheetImpl();if(r.isValue(e.get_selectedMarks())){var t=new s._Deferred;return t.resolve(e.get_selectedMarks()._toApiCollection())}return e.$29()}},s.JavaScriptApi$5=function(e,t){s.JavaScriptApi$5.initializeBase(this,[e,t])},tableauSoftware.Pair=function(e,t){this.fieldName=e,this.value=t,this.formattedValue=r.isValue(t)?t.toString():""},tableauSoftware.Pair.prototype={fieldName:null,value:null,formattedValue:null},tableauSoftware.Parameter=function(e){this._impl=e},tableauSoftware.Parameter.prototype={_impl:null,getName:function(){return this._impl.get_$B()},getCurrentValue:function(){return this._impl.get_$C()},getDataType:function(){return this._impl.get_$D()},getAllowableValuesType:function(){return this._impl.get_$E()},getAllowableValues:function(){return this._impl.get_$F()},getMinValue:function(){return this._impl.get_$10()},getMaxValue:function(){return this._impl.get_$11()},getStepSize:function(){return this._impl.get_$12()},getDateStepPeriod:function(){return this._impl.get_$13()
}},s.ParameterEvent=function(e,t,i){s.ParameterEvent.initializeBase(this,[e,t]),this.$2=new s.JavaScriptApi$4(t._impl.get__workbookImpl(),i)},s.ParameterEvent.prototype={$2:null,getParameterName:function(){return this.$2.get__parameterName()},getParameterAsync:function(){return this.$2.get__workbookImpl().$24(this.$2.get__parameterName())}},s.JavaScriptApi$4=function(e,t){s.JavaScriptApi$4.initializeBase(this,[e,null]),this.$2=t},s.JavaScriptApi$4.prototype={$2:null,get__parameterName:function(){return this.$2}},tableauSoftware.Sheet=function(e){s._Param.verifyValue(e,"sheetImpl"),this._impl=e},tableauSoftware.Sheet.prototype={_impl:null,getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}},tableauSoftware.SheetInfo=function(e){this.$0=e},tableauSoftware.SheetInfo.prototype={$0:null,getName:function(){return this.$0.name},getSheetType:function(){return this.$0.sheetType},getSize:function(){return this.$0.size},getIndex:function(){return this.$0.index},getUrl:function(){return this.$0.url},getIsActive:function(){return this.$0.isActive},getIsHidden:function(){return this.$0.isHidden},getWorkbook:function(){return this.$0.workbook}},s.SheetSizeFactory=function(){},s.SheetSizeFactory.createAutomatic=function(){var e=s.$create_SheetSize("automatic",null,null);return e},s.SheetSizeFactory.fromSizeConstraints=function(e){var t=e.minHeight,i=e.minWidth,n=e.maxHeight,r=e.maxWidth,a="automatic",o=null,l=null;return t||i?n||r?n===t&&r===i?(a="exactly",o=s.$create_Size(i,t),l=s.$create_Size(i,t)):(a="range",o=s.$create_Size(i,t),l=s.$create_Size(r,n)):(a="atleast",o=s.$create_Size(i,t)):(n||r)&&(a="atmost",l=s.$create_Size(r,n)),s.$create_SheetSize(a,o,l)
},tableauSoftware.Story=function(e){tableauSoftware.Story.initializeBase(this,[e])},tableauSoftware.Story.prototype={_impl:null,getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},tableauSoftware.StoryPoint=function(e){this.$0=e},tableauSoftware.StoryPoint.prototype={$0:null,getCaption:function(){return this.$0.get_caption()},getContainedSheet:function(){return r.isValue(this.$0.get_containedSheetImpl())?this.$0.get_containedSheetImpl().get_sheet():null},getIndex:function(){return this.$0.get_index()},getIsActive:function(){return this.$0.get_isActive()},getIsUpdated:function(){return this.$0.get_isUpdated()},getParentStory:function(){return this.$0.get_parentStoryImpl().get_story()}},tableauSoftware.StoryPointInfo=function(e){this._impl=e},tableauSoftware.StoryPointInfo.prototype={_impl:null,getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}},s.StoryPointSwitchEvent=function(e,t,i,n){s.StoryPointSwitchEvent.initializeBase(this,[e,t]),this.$2=i,this.$3=n},s.StoryPointSwitchEvent.prototype={$2:null,$3:null,getOldStoryPointInfo:function(){return this.$2},getNewStoryPoint:function(){return this.$3}},s.TableauEvent=function(e,t){this.$0=t,this.$1=e},s.TableauEvent.prototype={$0:null,$1:null,getViz:function(){return this.$0},getEventName:function(){return this.$1}},s.EventContext=function(e,t){this.$0=e,this.$1=t
},s.EventContext.prototype={$0:null,$1:null,get__workbookImpl:function(){return this.$0},get__worksheetImpl:function(){return this.$1}},s.TabSwitchEvent=function(e,t,i,n){s.TabSwitchEvent.initializeBase(this,[e,t]),this.$2=i,this.$3=n},s.TabSwitchEvent.prototype={$2:null,$3:null,getOldSheetName:function(){return this.$2},getNewSheetName:function(){return this.$3}},tableauSoftware.Viz=function(e,t,i){var n=s._ApiObjectRegistry.getCrossDomainMessageRouter();this._impl=new s.VizImpl(n,this,e,t,i),this._impl.$46()},tableauSoftware.Viz.prototype={_impl:null,getAreTabsHidden:function(){return this._impl.get_$28()},getIsToolbarHidden:function(){return this._impl.get_$29()},getIsHidden:function(){return this._impl.get_$2A()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.get_$2B()},getUrl:function(){return this._impl.get_$2C()},getVizSize:function(){return this._impl.get_$2F()},getWorkbook:function(){return this._impl.get_$2D()},getAreAutomaticUpdatesPaused:function(){return this._impl.get_$2E()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,t){this._impl.addEventListener(e,t)},removeEventListener:function(e,t){this._impl.removeEventListener(e,t)},dispose:function(){this._impl.$33()},show:function(){this._impl.$34()},hide:function(){this._impl.$35()},showExportDataDialog:function(e){this._impl.$38(e)},showExportCrossTabDialog:function(e){this._impl.$39(e)},showExportImageDialog:function(){this._impl.$37()},showExportPDFDialog:function(){this._impl.$3A()},revertAllAsync:function(){return this._impl.$3B()},refreshDataAsync:function(){return this._impl.$3C()},showShareDialog:function(){this._impl.$3D()},showDownloadWorkbookDialog:function(){this._impl.$3E()},pauseAutomaticUpdatesAsync:function(){return this._impl.$3F()},resumeAutomaticUpdatesAsync:function(){return this._impl.$40()},toggleAutomaticUpdatesAsync:function(){return this._impl.$41()},refreshSize:function(){this._impl.$32()
},setFrameSize:function(e,t){var i=e,n=t;s._Utility.isNumber(e)&&(i=e+"px"),s._Utility.isNumber(t)&&(n=t+"px"),this._impl.$43(i,n)}},tableauSoftware.VizManager=function(){},tableauSoftware.VizManager.getVizs=function(){return s._VizManagerImpl.get_$1()},tableauSoftware.Workbook=function(e){this.$0=e},tableauSoftware.Workbook.prototype={$0:null,getViz:function(){return this.$0.get_viz()},getPublishedSheetsInfo:function(){return this.$0.get_publishedSheets()._toApiCollection()},getName:function(){return this.$0.get_name()},getActiveSheet:function(){return this.$0.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this.$0.get_activeCustomView()},activateSheetAsync:function(e){return this.$0._setActiveSheetAsync(e)},revertAllAsync:function(){return this.$0._revertAllAsync()},getCustomViewsAsync:function(){return this.$0.$1B()},showCustomViewAsync:function(e){return this.$0.$1C(e)},removeCustomViewAsync:function(e){return this.$0.$1D(e)},rememberCustomViewAsync:function(e){return this.$0.$1E(e)},setActiveCustomViewAsDefaultAsync:function(){return this.$0.$1F()},getParametersAsync:function(){return this.$0.$25()},changeParameterValueAsync:function(e,t){return this.$0.$26(e,t)}},tableauSoftware.Worksheet=function(e){tableauSoftware.Worksheet.initializeBase(this,[e])},tableauSoftware.Worksheet.prototype={_impl:null,getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl.$10()},getFilterAsync:function(e,t){return this._impl.$16(null,e,t)},getFiltersAsync:function(e){return this._impl.$17(e)},applyFilterAsync:function(e,t,i,n){return this._impl.$18(e,t,i,n)},clearFilterAsync:function(e){return this._impl.$19(e)},applyRangeFilterAsync:function(e,t){return this._impl.$1A(e,t)},applyRelativeDateFilterAsync:function(e,t){return this._impl.$1B(e,t)},applyHierarchicalFilterAsync:function(e,t,i,n){return this._impl.$1C(e,t,i,n)
},clearSelectedMarksAsync:function(){return this._impl.$27()},selectMarksAsync:function(e,t,i){return this._impl.$28(e,t,i)},getSelectedMarksAsync:function(){return this._impl.$29()}},s.WorksheetEvent=function(e,t,i){s.WorksheetEvent.initializeBase(this,[e,t]),this.$2=i},s.WorksheetEvent.prototype={$2:null,getWorksheet:function(){return this.$2.get_worksheet()}},s._jQueryShim=function(){},s._jQueryShim.$11=function(e){return"function"===s._jQueryShim.$13(e)},s._jQueryShim.$12=function(e){return r.isValue(Array.isArray)?Array.isArray(e):"array"===s._jQueryShim.$13(e)},s._jQueryShim.$13=function(e){return null==e?String(e):s._jQueryShim.$8[s._jQueryShim.$A.call(e)]||"object"},s._jQueryShim.$14=function(e){return r.isValue(s._jQueryShim.$9)?null==e?"":s._jQueryShim.$9.call(e):null==e?"":e.replace(s._jQueryShim.$B,"").replace(s._jQueryShim.$C,"")},s._jQueryShim.parseJSON=function(e){if("string"!=typeof e||r.isNullOrUndefined(e))return null;if(e=s._jQueryShim.$14(e),window.JSON&&window.JSON.parse)return window.JSON.parse(e);if(s._jQueryShim.$D.test(e.replace(s._jQueryShim.$E,"@").replace(s._jQueryShim.$F,"]").replace(s._jQueryShim.$10,"")))return new Function("return "+e)();throw new Error("Invalid JSON: "+e)},s._ApiCommand.registerClass("tab._ApiCommand"),s._ApiServerResultParser.registerClass("tab._ApiServerResultParser"),s._ApiServerNotification.registerClass("tab._ApiServerNotification"),s._CommandReturnHandler.registerClass("tab._CommandReturnHandler"),s.JavaScriptApi$1.registerClass("tab.JavaScriptApi$1",null,s.ICrossDomainMessageRouter),s.JavaScriptApi$2.registerClass("tab.JavaScriptApi$2",null,s.ICrossDomainMessageHandler),s.CrossDomainMessagingOptions.registerClass("tab.CrossDomainMessagingOptions"),s._Enums.registerClass("tab._Enums"),s._ApiBootstrap.registerClass("tab._ApiBootstrap"),s._ApiObjectRegistry.registerClass("tab._ApiObjectRegistry"),s._CustomViewImpl.registerClass("tab._CustomViewImpl"),s._SheetImpl.registerClass("tab._SheetImpl"),s._DashboardImpl.registerClass("tab._DashboardImpl",s._SheetImpl),s._DataSourceImpl.registerClass("tab._DataSourceImpl"),s._DeferredUtil.registerClass("tab._DeferredUtil"),s._CollectionImpl.registerClass("tab._CollectionImpl"),s._DeferredImpl.registerClass("tab._DeferredImpl"),s._PromiseImpl.registerClass("tab._PromiseImpl"),s._MarkImpl.registerClass("tab._MarkImpl"),s._Param.registerClass("tab._Param"),s._ParameterImpl.registerClass("tab._ParameterImpl"),s._StoryImpl.registerClass("tab._StoryImpl",s._SheetImpl),s._StoryPointImpl.registerClass("tab._StoryPointImpl"),s.StoryPointInfoImplUtil.registerClass("tab.StoryPointInfoImplUtil"),s._TableauException.registerClass("tab._TableauException"),s._Utility.registerClass("tab._Utility"),s.VizImpl.registerClass("tab.VizImpl",null,s.ICrossDomainMessageHandler),s._VizManagerImpl.registerClass("tab._VizManagerImpl"),s._VizParameters.registerClass("tab._VizParameters"),s._WorkbookImpl.registerClass("tab._WorkbookImpl"),s._WorksheetImpl.registerClass("tab._WorksheetImpl",s._SheetImpl),s.JsonUtil.registerClass("tab.JsonUtil"),tableauSoftware.CustomView.registerClass("tableauSoftware.CustomView"),s.TableauEvent.registerClass("tab.TableauEvent"),s.CustomViewEvent.registerClass("tab.CustomViewEvent",s.TableauEvent),s.EventContext.registerClass("tab.EventContext"),s.JavaScriptApi$3.registerClass("tab.JavaScriptApi$3",s.EventContext),tableauSoftware.Sheet.registerClass("tableauSoftware.Sheet"),tableauSoftware.Dashboard.registerClass("tableauSoftware.Dashboard",tableauSoftware.Sheet),tableauSoftware.DashboardObject.registerClass("tableauSoftware.DashboardObject"),tableauSoftware.DataSource.registerClass("tableauSoftware.DataSource"),tableauSoftware.Field.registerClass("tableauSoftware.Field"),tableauSoftware.Filter.registerClass("tableauSoftware.Filter"),tableauSoftware.CategoricalFilter.registerClass("tableauSoftware.CategoricalFilter",tableauSoftware.Filter),s.WorksheetEvent.registerClass("tab.WorksheetEvent",s.TableauEvent),s.FilterEvent.registerClass("tab.FilterEvent",s.WorksheetEvent),s.JavaScriptApi$6.registerClass("tab.JavaScriptApi$6",s.EventContext),tableauSoftware.HierarchicalFilter.registerClass("tableauSoftware.HierarchicalFilter",tableauSoftware.Filter),tableauSoftware.QuantitativeFilter.registerClass("tableauSoftware.QuantitativeFilter",tableauSoftware.Filter),tableauSoftware.RelativeDateFilter.registerClass("tableauSoftware.RelativeDateFilter",tableauSoftware.Filter),s.FirstVizSizeKnownEvent.registerClass("tab.FirstVizSizeKnownEvent",s.TableauEvent),tableauSoftware.Version.registerClass("tableauSoftware.Version"),s.VizResizeEvent.registerClass("tab.VizResizeEvent",s.TableauEvent),tableauSoftware.Mark.registerClass("tableauSoftware.Mark"),s.MarksEvent.registerClass("tab.MarksEvent",s.WorksheetEvent),s.JavaScriptApi$5.registerClass("tab.JavaScriptApi$5",s.EventContext),tableauSoftware.Pair.registerClass("tableauSoftware.Pair"),tableauSoftware.Parameter.registerClass("tableauSoftware.Parameter"),s.ParameterEvent.registerClass("tab.ParameterEvent",s.TableauEvent),s.JavaScriptApi$4.registerClass("tab.JavaScriptApi$4",s.EventContext),tableauSoftware.SheetInfo.registerClass("tableauSoftware.SheetInfo"),s.SheetSizeFactory.registerClass("tab.SheetSizeFactory"),tableauSoftware.Story.registerClass("tableauSoftware.Story",tableauSoftware.Sheet),tableauSoftware.StoryPoint.registerClass("tableauSoftware.StoryPoint"),tableauSoftware.StoryPointInfo.registerClass("tableauSoftware.StoryPointInfo"),s.StoryPointSwitchEvent.registerClass("tab.StoryPointSwitchEvent",s.TableauEvent),s.TabSwitchEvent.registerClass("tab.TabSwitchEvent",s.TableauEvent),tableauSoftware.Viz.registerClass("tableauSoftware.Viz"),tableauSoftware.VizManager.registerClass("tableauSoftware.VizManager"),tableauSoftware.Workbook.registerClass("tableauSoftware.Workbook"),tableauSoftware.Worksheet.registerClass("tableauSoftware.Worksheet",tableauSoftware.Sheet),s._jQueryShim.registerClass("tab._jQueryShim"),s._ApiCommand.crossDomainEventNotificationId="xdomainSourceId",s._ApiObjectRegistry.$1=null,s._ApiObjectRegistry.$2=null,s._SheetImpl.noZoneId=4294967295,s._VizManagerImpl.$0=[],s._WorksheetImpl.$25=new RegExp("\\[[^\\]]+\\]\\.","g"),tableauSoftware.Version.$0=new tableauSoftware.Version(2,0,0,null),s._jQueryShim.$8={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},s._jQueryShim.$9=String.prototype.trim,s._jQueryShim.$A=Object.prototype.toString,s._jQueryShim.$B=new RegExp("^[\\s\\xA0]+"),s._jQueryShim.$C=new RegExp("[\\s\\xA0]+$"),s._jQueryShim.$D=new RegExp("^[\\],:{}\\s]*$"),s._jQueryShim.$E=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),s._jQueryShim.$F=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),s._jQueryShim.$10=new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),tableauSoftware.Promise=s._PromiseImpl,s._Deferred=s._DeferredImpl,s._Collection=s._CollectionImpl,tableauSoftware.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage"},tableauSoftware.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},tableauSoftware.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},tableauSoftware.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},tableauSoftware.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},tableauSoftware.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},tableauSoftware.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},tableauSoftware.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},tableauSoftware.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},tableauSoftware.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},tableauSoftware.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},tableauSoftware.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet",MAX_VIZ_RESIZE_ATTEMPTS:"maxVizResizeAttempts"},tableauSoftware.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",FIRST_VIZ_SIZE_KNOWN:"firstvizsizeknown",MARKS_SELECTION:"marksselection",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch",VIZ_RESIZE:"vizresize"},tableauSoftware.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},tableauSoftware.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},tableauSoftware.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},n(),s._ApiBootstrap.initialize()
}();