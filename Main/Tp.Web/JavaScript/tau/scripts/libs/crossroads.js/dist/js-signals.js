!function(i){function t(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}var n={VERSION:"0.6"};t.prototype={active:!0,execute:function(i){var t;return this.active&&(t=this._listener.apply(this.context,i),this._isOnce&&this.detach()),t},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach(),this._destroy()},_destroy:function(){delete this._signal,delete this._isOnce,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", active: "+this.active+"]"}},n.Signal=function(){this._bindings=[]},n.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(i,n,e,s){if("function"!=typeof i)throw new Error("listener is a required param of add() and addOnce() and should be a Function.");var r,o=this._indexOfListener(i);if(-1!==o){if(r=this._bindings[o],r.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t(this,i,n,e,s),this._addBinding(r);return r},_addBinding:function(i){var t=this._bindings.length;do--t;while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i){for(var t=this._bindings.length;t--;)if(this._bindings[t]._listener===i)return t;return-1},add:function(i,t,n){return this._registerListener(i,!1,t,n)},addOnce:function(i,t,n){return this._registerListener(i,!0,t,n)},remove:function(i){if("function"!=typeof i)throw new Error("listener is a required param of remove() and should be a Function.");var t=this._indexOfListener(i);return-1!==t&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var i=Array.prototype.slice.call(arguments),t=this._bindings.slice(),n=this._bindings.length;this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(i)!==!1)}},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},i.signals=n}(window||global||this);