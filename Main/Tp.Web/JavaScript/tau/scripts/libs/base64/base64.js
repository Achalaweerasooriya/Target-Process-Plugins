define([],function(){function t(){this.buffer=[]}function e(t){this._input=t,this._index=-1,this._buffer=[]}function r(t){this._input=t,this._index=-1,this._buffer=[]}t.prototype.append=function(t){return this.buffer.push(t),this},t.prototype.toString=function(){return this.buffer.join("")};var i={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(r){for(var i=new t,n=new e(r);n.moveNext();){var h=n.current;n.moveNext();var u=n.current;n.moveNext();var s=n.current,f=h>>2,o=(3&h)<<4|u>>4,c=(15&u)<<2|s>>6,d=63&s;isNaN(u)?c=d=64:isNaN(s)&&(d=64),i.append(this.codex.charAt(f)+this.codex.charAt(o)+this.codex.charAt(c)+this.codex.charAt(d))}return i.toString()},decode:function(e){for(var i=new t,n=new r(e);n.moveNext();){var h=n.current;if(128>h)i.append(String.fromCharCode(h));else if(h>191&&224>h){n.moveNext();var u=n.current;i.append(String.fromCharCode((31&h)<<6|63&u))}else{n.moveNext();var u=n.current;n.moveNext();var s=n.current;i.append(String.fromCharCode((15&h)<<12|(63&u)<<6|63&s))}}return i.toString()}};return e.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var t=this._input.charCodeAt(++this._index);return 13==t&&10==this._input.charCodeAt(this._index+1)&&(t=10,this._index+=2),128>t?this.current=t:t>127&&2048>t?(this.current=t>>6|192,this._buffer.push(63&t|128)):(this.current=t>>12|224,this._buffer.push(t>>6&63|128),this._buffer.push(63&t|128)),!0}},r.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var t=i.codex.indexOf(this._input.charAt(++this._index)),e=i.codex.indexOf(this._input.charAt(++this._index)),r=i.codex.indexOf(this._input.charAt(++this._index)),n=i.codex.indexOf(this._input.charAt(++this._index)),h=t<<2|e>>4,u=(15&e)<<4|r>>2,s=(3&r)<<6|n;return this.current=h,64!=r&&this._buffer.push(u),64!=n&&this._buffer.push(s),!0}},i});