define([],function(){return this.j$=this.jStat=function(n){function t(){return new t.fn.init(arguments)}var r=Array.prototype.slice,e=Object.prototype.toString,o=function(t,r){var e=t>r?t:r;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))},a=Array.isArray||function(n){return"[object Array]"===e.call(n)},u=function(n){return"[object Function]"===e.call(n)},i=function(n){return"[object Number]"===e.call(n)&&!isNaN(n)},f=function(n){return[].concat.apply([],n)};return t.fn=t.prototype={constructor:t,init:function(n){var r=0;if(a(n[0]))if(a(n[0][0])){for(u(n[1])&&(n[0]=t.map(n[0],n[1]));r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=u(n[1])?t.map(n[0],n[1]):n[0],this.length=1;else if(i(n[0]))this[0]=t.seq.apply(null,n),this.length=1;else{if(n[0]instanceof t)return t(n[0].toArray());this[0]=[],this.length=1}return this},length:0,toArray:function(){return this.length>1?r.call(this):r.call(this)[0]},push:[].push,sort:[].sort,splice:[].splice,slice:[].slice},t.fn.init.prototype=t.fn,t.utils={calcRdx:o,isArray:a,isFunction:u,isNumber:i,toVector:f},t.extend=function(n){var e,o=r.call(arguments),a=1;if(1===o.length){for(e in n)t[e]=n[e];return this}for(;a<o.length;a++)for(e in o[a])n[e]=o[a][e];return n},t.extend({rows:function(n){return n.length||1},cols:function(n){return n[0].length||1},dimensions:function(n){return{rows:t.rows(n),cols:t.cols(n)}},row:function(n,t){return n[t]},col:function(n,t){for(var r=new Array(n.length),e=0;e<n.length;e++)r[e]=[n[e][t]];return r},diag:function(n){for(var r=0,e=t.rows(n),o=new Array(e);e>r;r++)o[r]=[n[r][r]];return o},antidiag:function(n){for(var r=t.rows(n)-1,e=new Array(r),o=0;r>=0;r--,o++)e[o]=[n[o][r]];return e},transpose:function(n){var t,r,e,o=[],u=0;for(a(n[0])||(n=[n]),t=n.length,r=n[0].length;r>u;u++)for(o.push(new Array(t)),e=0;t>e;e++)o[u][e]=n[e][u];return 1===o.length?o[0]:o},map:function(n,t,r){var e,o,u,i,f=0;for(a(n[0])||(n=[n]),e=n.length,o=n[0].length,u=r?n:new Array(e);e>f;f++)for(u[f]||(u[f]=new Array(o)),i=0;o>i;i++)u[f][i]=t(n[f][i],f,i);return 1===u.length?u[0]:u},alter:function(n,r){return t.map(n,r,!0)},create:function(n,t,r){var e,o,a=new Array(n);for(u(t)&&(r=t,t=n),e=0;n>e;e++)for(a[e]=new Array(t),o=0;t>o;o++)a[e][o]=r(e,o);return a},zeros:function(n,r){return i(r)||(r=n),t.create(n,r,function(){return 0})},ones:function(n,r){return i(r)||(r=n),t.create(n,r,function(){return 1})},rand:function(r,e){return i(e)||(e=r),t.create(r,e,function(){return n.random()})},identity:function(n,r){return i(r)||(r=n),t.create(n,r,function(n,t){return n===t?1:0})},symmetric:function(n){var t,r=0,e=n.length;if(n.length!==n[0].length)return!1;for(;e>r;r++)for(t=0;e>t;t++)if(n[t][r]!==n[r][t])return!1;return!0},clear:function(n){return t.alter(n,function(){return 0})},seq:function(n,t,r,e){u(e)||(e=!1);for(var a=[],i=o(n,t),f=(t*i-n*i)/((r-1)*i),c=n,s=0;t>=c;s++,c=(n*i+f*i*s)/i)a.push(e?e(c,s):c);return a}}),function(n){for(var r=0;r<n.length;r++)(function(n){t.fn[n]=function(r){var e,o=this;return r?(setTimeout(function(){r.call(o,t.fn[n].call(o))},15),this):(e=t[n](this),a(e)?t(e):e)}})(n[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){t.fn[n]=function(r,e){var o=this;return e?(setTimeout(function(){e.call(o,t.fn[n].call(o,r))},15),this):t(t[n](this,r))}})(n[r])}("row col".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){t.fn[n]=function(){return t(t[n].apply(null,arguments))}})(n[r])}("create zeros ones rand identity".split(" ")),t.extend(t.fn,{map:function(n,r){return t(t.map(this,n,r))},alter:function(n){return t.alter(this,n),this}}),t}(Math),function(n,t){!function(t){for(var r=0;r<t.length;r++)(function(t){n[t]=function(n,t,r){return this instanceof arguments.callee?(this._a=n,this._b=t,this._c=r,this):new arguments.callee(n,t,r)},n.fn[t]=function(r,e,o){var a=n[t](r,e,o);return a.data=this,a},n[t].prototype.sample=function(r){var e=this._a,o=this._b,a=this._c;return r?n.alter(r,function(){return n[t].sample(e,o,a)}):n[t].sample(e,o,a)},function(r){for(var e=0;e<r.length;e++)(function(r){n[t].prototype[r]=function(e){var o=this._a,a=this._b,u=this._c;return e||(e=this.data),"number"!=typeof e?n.fn.map.call(e,function(e){return n[t][r](e,o,a,u)}):n[t][r](e,o,a,u)}})(r[e])}("pdf cdf inv".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){n[t].prototype[r]=function(){return n[t][r](this._a,this._b,this._c)}})(r[e])}("mean median mode variance".split(" "))})(t[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),n.extend(n.beta,{pdf:function(r,e,o){return r>1||0>r?0:t.pow(r,e-1)*t.pow(1-r,o-1)/n.betafn(e,o)},cdf:function(t,r,e){return t>1||0>t?1*(t>1):n.ibeta(t,r,e)},inv:function(t,r,e){return n.ibetainv(t,r,e)},mean:function(n,t){return n/(n+t)},median:function(){},mode:function(n,r){return n*r/(t.pow(n+r,2)*(n+r+1))},sample:function(t,r){var e=n.randg(t);return e/(e+n.randg(r))},variance:function(n,r){return n*r/(t.pow(n+r,2)*(n+r+1))}}),n.extend(n.centralF,{pdf:function(r,e,o){return r>=0?t.sqrt(t.pow(e*r,e)*t.pow(o,o)/t.pow(e*r+o,e+o))/(r*n.betafn(e/2,o/2)):void 0},cdf:function(t,r,e){return n.ibeta(r*t/(r*t+e),r/2,e/2)},inv:function(t,r,e){return e/(r*(1/n.ibetainv(t,r/2,e/2)-1))},mean:function(n,t){return t>2?t/(t-2):void 0},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):void 0},sample:function(t,r){var e=2*n.randg(t/2),o=2*n.randg(r/2);return e/t/(o/r)},variance:function(n,t){return t>4?2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4)):void 0}}),n.extend(n.cauchy,{pdf:function(n,r,e){return e/(t.pow(n-r,2)+t.pow(e,2))/t.PI},cdf:function(n,r,e){return t.atan((n-r)/e)/t.PI+.5},inv:function(n,r,e){return r+e*t.tan(t.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(r,e){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*e+r}}),n.extend(n.chisquare,{pdf:function(r,e){return t.exp((e/2-1)*t.log(r)-r/2-e/2*t.log(2)-n.gammaln(e/2))},cdf:function(t,r){return n.gammap(r/2,t/2)},inv:function(t,r){return 2*n.gammapinv(t,.5*r)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return 2*n.randg(t/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,r){return 0>n?0:r*t.exp(-r*n)},cdf:function(n,r){return 0>n?0:1-t.exp(-r*n)},inv:function(n,r){return-t.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(r,e,o){return t.exp((e-1)*t.log(r)-r/o-n.gammaln(e)-e*t.log(o))},cdf:function(t,r,e){return n.gammap(r,t/e)},inv:function(t,r,e){return n.gammapinv(t,r)*e},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:void 0},sample:function(t,r){return n.randg(t)*r},variance:function(n,t){return n*t*t}}),n.extend(n.invgamma,{pdf:function(r,e,o){return t.exp(-(e+1)*t.log(r)-o/r-n.gammaln(e)+e*t.log(o))},cdf:function(t,r,e){return 1-n.gammap(r,e/t)},inv:function(t,r,e){return e/n.gammapinv(1-t,r)},mean:function(n,t){return n>1?t/(n-1):void 0},mode:function(n,t){return t/(n+1)},sample:function(t,r){return r/n.randg(t)},variance:function(n,t){return n>2?t*t/((n-1)*(n-1)*(n-2)):void 0}}),n.extend(n.kumaraswamy,{pdf:function(n,r,e){return t.exp(t.log(r)+t.log(e)+(r-1)*t.log(n)+(e-1)*t.log(1-t.pow(n,r)))},cdf:function(n,r,e){return 1-t.pow(1-t.pow(n,r),e)},mean:function(t,r){return r*n.gammafn(1+1/t)*n.gammafn(r)/n.gammafn(1+1/t+r)},median:function(n,r){return t.pow(1-t.pow(2,-1/r),1/n)},mode:function(n,r){return n>=1&&r>=1&&1!==n&&1!==r?t.pow((n-1)/(n*r-1),1/n):void 0},variance:function(){}}),n.extend(n.lognormal,{pdf:function(n,r,e){return t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(n)-r,2)/(2*e*e))},cdf:function(r,e,o){return.5+.5*n.erf((t.log(r)-e)/t.sqrt(2*o*o))},inv:function(r,e,o){return t.exp(-1.4142135623730951*o*n.erfcinv(2*r)+e)},mean:function(n,r){return t.exp(n+r*r/2)},median:function(n){return t.exp(n)},mode:function(n,r){return t.exp(n-r*r)},sample:function(r,e){return t.exp(n.randn()*e+r)},variance:function(n,r){return(t.exp(r*r)-1)*t.exp(2*n+r*r)}}),n.extend(n.normal,{pdf:function(n,r,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(n-r,2)/(2*e*e))},cdf:function(r,e,o){return.5*(1+n.erf((r-e)/t.sqrt(2*o*o)))},inv:function(t,r,e){return-1.4142135623730951*e*n.erfcinv(2*t)+r},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(t,r){return n.randn()*r+t},variance:function(n,t){return t*t}}),n.extend(n.pareto,{pdf:function(n,r,e){return n>r?e*t.pow(r,e)/t.pow(n,e+1):void 0},cdf:function(n,r,e){return 1-t.pow(r/n,e)},mean:function(n,r){return r>1?r*t.pow(n,r)/(r-1):void 0},median:function(n,r){return n*r*t.SQRT2},mode:function(n){return n},variance:function(n,r){return r>2?n*n*r/(t.pow(r-1,2)*(r-2)):void 0}}),n.extend(n.studentt,{pdf:function(r,e){return n.gammafn((e+1)/2)/(t.sqrt(e*t.PI)*n.gammafn(e/2))*t.pow(1+r*r/e,-((e+1)/2))},cdf:function(r,e){var o=e/2;return n.ibeta((r+t.sqrt(r*r+e))/(2*t.sqrt(r*r+e)),o,o)},inv:function(r,e){var o=n.ibetainv(2*t.min(r,1-r),.5*e,.5);return o=t.sqrt(e*(1-o)/o),r>0?o:-o},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return n.randn()*t.sqrt(r/(2*n.randg(r/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,r,e){return 0>n?0:e/r*t.pow(n/r,e-1)*t.exp(-t.pow(n/r,e))},cdf:function(n,r,e){return 0>n?0:1-t.exp(-t.pow(n/r,e))},inv:function(n,r,e){return r*t.pow(-t.log(1-n),1/e)},mean:function(t,r){return t*n.gammafn(1+1/r)},median:function(n,r){return n*t.pow(t.log(2),1/r)},mode:function(n,r){return r>1?n*t.pow((r-1)/r,1/r):void 0},sample:function(n,r){return n*t.pow(-t.log(t.random()),1/r)},variance:function(r,e){return r*r*n.gammafn(1+2/e)-t.pow(this.mean(r,e),2)}}),n.extend(n.uniform,{pdf:function(n,t,r){return t>n||n>r?0:1/(r-t)},cdf:function(n,t,r){return t>n?0:r>n?(n-t)/(r-t):1},mean:function(n,t){return.5*(n+t)},median:function(t,r){return n.mean(t,r)},mode:function(){},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*t.random()-1)},variance:function(n,r){return t.pow(r-n,2)/12}}),n.extend(n.binomial,{pdf:function(r,e,o){return 0===o||1===o?e*o===r?1:0:n.combination(e,r)*t.pow(o,r)*t.pow(1-o,e-r)},cdf:function(t,r,e){var o=[],a=0;if(0>t)return 0;if(r>t){for(;t>=a;a++)o[a]=n.binomial.pdf(a,r,e);return n.sum(o)}return 1}}),n.extend(n.negbin,{pdf:function(r,e,o){return r!==r|0?!1:0>r?0:n.combination(r+e-1,r)*t.pow(1-o,e)*t.pow(o,r)},cdf:function(t,r,e){var o=0,a=0;if(0>t)return 0;for(;t>=a;a++)o+=n.negbin.pdf(a,r,e);return o}}),n.extend(n.hypgeom,{pdf:function(t,r,e,o){return t!==t|0?!1:0>t?0:n.combination(e,t)*n.combination(r-e,o-t)/n.combination(r,o)},cdf:function(t,r,e,o){var a=0,u=0;if(0>t)return 0;for(;t>=u;u++)a+=n.hypgeom.pdf(u,r,e,o);return a}}),n.extend(n.poisson,{pdf:function(r,e){return t.pow(e,r)*t.exp(-e)/n.factorial(r)},cdf:function(t,r){var e=[],o=0;if(0>t)return 0;for(;t>=o;o++)e.push(n.poisson.pdf(o,r));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var r=1,e=0,o=t.exp(-n);do e++,r*=t.random();while(r>o);return e-1}}),n.extend(n.triangular,{pdf:function(n,t,r,e){return t>=r||t>e||e>r?void 0:t>n||n>r?0:e>=n?2*(n-t)/((r-t)*(e-t)):2*(r-n)/((r-t)*(r-e))},cdf:function(n,r,e,o){return r>=e||r>o||o>e?void 0:r>n?0:o>=n?t.pow(n-r,2)/((e-r)*(o-r)):1-t.pow(e-n,2)/((e-r)*(e-o))},mean:function(n,t,r){return(n+t+r)/3},median:function(n,r,e){return(n+r)/2>=e?r-t.sqrt((r-n)*(r-e))/t.sqrt(2):e>(n+r)/2?n+t.sqrt((r-n)*(e-n))/t.sqrt(2):void 0},mode:function(n,t,r){return r},sample:function(n,r,e){var o=t.random();return(e-n)/(r-n)>o?n+t.sqrt(o*(r-n)*(e-n)):r-t.sqrt((1-o)*(r-n)*(r-e))},variance:function(n,t,r){return(n*n+t*t+r*r-n*t-n*r-t*r)/18}})}(this.jStat,Math),function(n,t){var r=Array.prototype.push,e=n.utils.isArray;n.extend({add:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n+r[t][e]})):n.map(t,function(n){return n+r})},subtract:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n-r[t][e]||0})):n.map(t,function(n){return n-r})},divide:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.multiply(t,n.inv(r))):n.map(t,function(n){return n/r})},multiply:function(t,r){var o,a,u,i,f=t.length,c=t[0].length,s=n.zeros(f,u=e(r)?r[0].length:c),l=0;if(e(r)){for(;u>l;l++)for(o=0;f>o;o++){for(i=0,a=0;c>a;a++)i+=t[o][a]*r[a][l];s[o][l]=i}return 1===f&&1===l?s[0][0]:s}return n.map(t,function(n){return n*r})},dot:function(t,r){e(t[0])||(t=[t]),e(r[0])||(r=[r]);for(var o,a,u=1===t[0].length&&1!==t.length?n.transpose(t):t,i=1===r[0].length&&1!==r.length?n.transpose(r):r,f=[],c=0,s=u.length,l=u[0].length;s>c;c++){for(f[c]=[],o=0,a=0;l>a;a++)o+=u[c][a]*i[c][a];f[c]=o}return 1===f.length?f[0]:f},pow:function(r,e){return n.map(r,function(n){return t.pow(n,e)})},abs:function(r){return n.map(r,function(n){return t.abs(n)})},norm:function(n,r){var o=0,a=0;for(isNaN(r)&&(r=2),e(n[0])&&(n=n[0]);a<n.length;a++)o+=t.pow(t.abs(n[a]),r);return t.pow(o,1/r)},angle:function(r,e){return t.acos(n.dot(r,e)/(n.norm(r)*n.norm(e)))},aug:function(n,t){for(var e=n.slice(),o=0;o<e.length;o++)r.apply(e[o],t[o]);return e},inv:function(t){for(var r,e=t.length,o=t[0].length,a=n.identity(e,o),u=n.gauss_jordan(t,a),i=[],f=0;e>f;f++)for(i[f]=[],r=o-1;r<u[0].length;r++)i[f][r-o]=u[f][r];return i},det:function(n){var t,r=n.length,e=2*r,o=new Array(e),a=r-1,u=e-1,i=a-r+1,f=u,c=0,s=0;if(2===r)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;e>c;c++)o[c]=1;for(c=0;r>c;c++){for(t=0;r>t;t++)o[0>i?i+r:i]*=n[c][t],o[r>f?f+r:f]*=n[c][t],i++,f--;i=--a-r+1,f=--u}for(c=0;r>c;c++)s+=o[c];for(;e>c;c++)s-=o[c];return s},gauss_elimination:function(r,e){var o,a,u,i,f=0,c=0,s=r.length,l=r[0].length,m=1,g=0,d=[];for(r=n.aug(r,e),o=r[0].length;s>f;f++){for(a=r[f][f],c=f,i=f+1;l>i;i++)a<t.abs(r[i][f])&&(a=r[i][f],c=i);if(c!=f)for(i=0;o>i;i++)u=r[f][i],r[f][i]=r[c][i],r[c][i]=u;for(c=f+1;s>c;c++)for(m=r[c][f]/r[f][f],i=f;o>i;i++)r[c][i]=r[c][i]-m*r[f][i]}for(f=s-1;f>=0;f--){for(g=0,c=f+1;s-1>=c;c++)g=d[c]*r[f][c];d[f]=(r[f][o-1]-g)/r[f][f]}return d},gauss_jordan:function(r,e){for(var o=n.aug(r,e),a=o.length,u=o[0].length,i=0;a>i;i++){for(var f=i,s=i+1;a>s;s++)t.abs(o[s][i])>t.abs(o[f][i])&&(f=s);var l=o[i];o[i]=o[f],o[f]=l;for(var s=i+1;a>s;s++){c=o[s][i]/o[i][i];for(var m=i;u>m;m++)o[s][m]-=o[i][m]*c}}for(var i=a-1;i>=0;i--){c=o[i][i];for(var s=0;i>s;s++)for(var m=u-1;m>i-1;m--)o[s][m]-=o[i][m]*o[s][i]/c;o[i][i]/=c;for(var m=a;u>m;m++)o[i][m]/=c}return o},lu:function(){},cholesky:function(){},gauss_jacobi:function(r,e,o,a){for(var u,i,f,c,s=0,l=0,m=r.length,g=[],d=[],p=[];m>s;s++)for(g[s]=[],d[s]=[],p[s]=[],l=0;m>l;l++)s>l?(g[s][l]=r[s][l],d[s][l]=p[s][l]=0):l>s?(d[s][l]=r[s][l],g[s][l]=p[s][l]=0):(p[s][l]=r[s][l],g[s][l]=d[s][l]=0);for(f=n.multiply(n.multiply(n.inv(p),n.add(g,d)),-1),i=n.multiply(n.inv(p),e),u=o,c=n.add(n.multiply(f,o),i),s=2;t.abs(n.norm(n.subtract(c,u)))>a;)u=c,c=n.add(n.multiply(f,u),i),s++;return c},gauss_seidel:function(r,e,o,a){for(var u,i,f,c,s,l=0,m=r.length,g=[],d=[],p=[];m>l;l++)for(g[l]=[],d[l]=[],p[l]=[],u=0;m>u;u++)l>u?(g[l][u]=r[l][u],d[l][u]=p[l][u]=0):u>l?(d[l][u]=r[l][u],g[l][u]=p[l][u]=0):(p[l][u]=r[l][u],g[l][u]=d[l][u]=0);for(c=n.multiply(n.multiply(n.inv(n.add(p,g)),d),-1),f=n.multiply(n.inv(n.add(p,g)),e),i=o,s=n.add(n.multiply(c,o),f),l=2;t.abs(n.norm(n.subtract(s,i)))>a;)i=s,s=n.add(n.multiply(c,i),f),l+=1;return s},SOR:function(r,e,o,a,u){for(var i,f,c,s,l,m=0,g=r.length,d=[],p=[],v=[];g>m;m++)for(d[m]=[],p[m]=[],v[m]=[],i=0;g>i;i++)m>i?(d[m][i]=r[m][i],p[m][i]=v[m][i]=0):i>m?(p[m][i]=r[m][i],d[m][i]=v[m][i]=0):(v[m][i]=r[m][i],d[m][i]=p[m][i]=0);for(s=n.multiply(n.inv(n.add(v,n.multiply(d,u))),n.subtract(n.multiply(v,1-u),n.multiply(p,u))),c=n.multiply(n.multiply(n.inv(n.add(v,n.multiply(d,u))),e),u),f=o,l=n.add(n.multiply(s,o),c),m=2;t.abs(n.norm(n.subtract(l,f)))>a;)f=l,l=n.add(n.multiply(s,f),c),m++;return l},householder:function(r){for(var e,o,a,u,i,f=r.length,c=r[0].length,s=0,l=[],m=[];f-1>s;s++){for(e=0,u=s+1;c>u;u++)e+=r[u][s]*r[u][s];for(i=r[s+1][s]>0?-1:1,e=i*t.sqrt(e),o=t.sqrt((e*e-r[s+1][s]*e)/2),l=n.zeros(f,1),l[s+1][0]=(r[s+1][s]-e)/(2*o),a=s+2;f>a;a++)l[a][0]=r[a][s]/(2*o);m=n.subtract(n.identity(f,c),n.multiply(n.multiply(l,n.transpose(l)),2)),r=n.multiply(m,n.multiply(r,m))}return r},QR:function(r,e){for(var o,a,u,i,f,c,s=r.length,l=r[0].length,m=0,g=[],d=[],p=[];s-1>m;m++){for(a=0,o=m+1;l>o;o++)a+=r[o][m]*r[o][m];for(f=r[m+1][m]>0?-1:1,a=f*t.sqrt(a),u=t.sqrt((a*a-r[m+1][m]*a)/2),g=n.zeros(s,1),g[m+1][0]=(r[m+1][m]-a)/(2*u),i=m+2;s>i;i++)g[i][0]=r[i][m]/(2*u);d=n.subtract(n.identity(s,l),n.multiply(n.multiply(g,n.transpose(g)),2)),r=n.multiply(d,r),e=n.multiply(d,e)}for(m=s-1;m>=0;m--){for(c=0,o=m+1;l-1>=o;o++)c=p[o]*r[m][o];p[m]=e[m][0]/r[m][m]}return p},jacobi:function(r){for(var e,o,a,u,i,f,c,s,l=1,m=0,g=r.length,d=n.identity(g,g),p=[];1===l;){for(m++,f=r[0][1],u=0,i=1,o=0;g>o;o++)for(a=0;g>a;a++)o!=a&&f<t.abs(r[o][a])&&(f=t.abs(r[o][a]),u=o,i=a);for(c=r[u][u]===r[i][i]?r[u][i]>0?t.PI/4:-t.PI/4:t.atan(2*r[u][i]/(r[u][u]-r[i][i]))/2,s=n.identity(g,g),s[u][u]=t.cos(c),s[u][i]=-t.sin(c),s[i][u]=t.sin(c),s[i][i]=t.cos(c),d=n.multiply(d,s),e=n.multiply(n.multiply(n.inv(s),r),s),r=e,l=0,o=1;g>o;o++)for(a=1;g>a;a++)o!=a&&t.abs(r[o][a])>.001&&(l=1)}for(o=0;g>o;o++)p.push(r[o][o]);return[d,p]},rungekutta:function(n,t,r,e,o,a){var u,i,f,c,s;if(2===a)for(;r>=e;)u=t*n(e,o),i=t*n(e+t,o+u),f=o+(u+i)/2,o=f,e+=t;if(4===a)for(;r>=e;)u=t*n(e,o),i=t*n(e+t/2,o+u/2),c=t*n(e+t/2,o+i/2),s=t*n(e+t,o+c),f=o+(u+2*i+2*c+s)/6,o=f,e+=t;return o},romberg:function(n,r,e,o){for(var a,u,i,f,c,s=0,l=(e-r)/2,m=[],g=[],d=[];o/2>s;){for(c=n(r),i=r,f=0;e>=i;i+=l,f++)m[f]=i;for(a=m.length,i=1;a-1>i;i++)c+=(i%2!==0?4:2)*n(m[i]);c=l/3*(c+n(e)),d[s]=c,l/=2,s++}for(u=d.length,a=1;1!==u;){for(i=0;u-1>i;i++)g[i]=(t.pow(4,a)*d[i+1]-d[i])/(t.pow(4,a)-1);u=g.length,d=g,g=[],a++}return d},richardson:function(n,r,e,o){function a(n,t){for(var r,e=0,o=n.length;o>e;e++)n[e]===t&&(r=e);return r}for(var u,i,f,c,s,l=(n.length,t.abs(e-n[a(n,e)+1])),m=0,g=[],d=[];o>=l;)u=a(n,e+o),i=a(n,e),g[m]=(r[u]-2*r[i]+r[2*i-u])/(o*o),o/=2,m++;for(c=g.length,f=1;1!=c;){for(s=0;c-1>s;s++)d[s]=(t.pow(4,f)*g[s+1]-g[s])/(t.pow(4,f)-1);c=d.length,g=d,d=[],f++}return g},simpson:function(n,t,r,e){for(var o,a=(r-t)/e,u=n(t),i=[],f=t,c=0,s=1;r>=f;f+=a,c++)i[c]=f;for(o=i.length;o-1>s;s++)u+=(s%2!==0?4:2)*n(i[s]);return a/3*(u+n(r))},hermite:function(n,t,r,e){for(var o,a=n.length,u=0,i=0,f=[],c=[],s=[],l=[];a>i;i++){for(f[i]=1,o=0;a>o;o++)i!=o&&(f[i]*=(e-n[o])/(n[i]-n[o]));for(c[i]=0,o=0;a>o;o++)i!=o&&(c[i]+=1/(n[i]-n[o]));s[i]=(1-2*(e-n[i])*c[i])*f[i]*f[i],l[i]=(e-n[i])*f[i]*f[i],u+=s[i]*t[i]+l[i]*r[i]}return u},lagrange:function(n,t,r){for(var e,o,a=0,u=0,i=n.length;i>u;u++){for(o=t[u],e=0;i>e;e++)u!=e&&(o*=(r-n[e])/(n[u]-n[e]));a+=o}return a},cubic_spline:function(t,r,e){for(var o,a=t.length,u=0,i=[],f=[],c=[],s=[],l=[],m=[],g=[];a-1>u;u++)l[u]=t[u+1]-t[u];for(c[0]=0,u=1;a-1>u;u++)c[u]=3/l[u]*(r[u+1]-r[u])-3/l[u-1]*(r[u]-r[u-1]);for(u=1;a-1>u;u++)i[u]=[],f[u]=[],i[u][u-1]=l[u-1],i[u][u]=2*(l[u-1]+l[u]),i[u][u+1]=l[u],f[u][0]=c[u];for(s=n.multiply(n.inv(i),f),o=0;a-1>o;o++)m[o]=(r[o+1]-r[o])/l[o]-l[o]*(s[o+1][0]+2*s[o][0])/3,g[o]=(s[o+1][0]-s[o][0])/(3*l[o]);for(o=0;a>o&&!(t[o]>e);o++);return o-=1,r[o]+(e-t[o])*m[o]+n.sq(e-t[o])*s[o]+(e-t[o])*n.sq(e-t[o])*g[o]},gauss_quadrature:function(){},PCA:function(t){var r,e,o=t.length,a=t[0].length,u=0,i=[],f=[],c=[],s=[],l=[],m=[],g=[],d=[],p=[],v=[];for(u=0;o>u;u++)i[u]=n.sum(t[u])/a;for(u=0;a>u;u++)for(g[u]=[],r=0;o>r;r++)g[u][r]=t[r][u]-i[r];for(g=n.transpose(g),u=0;o>u;u++)for(d[u]=[],r=0;o>r;r++)d[u][r]=n.dot([g[u]],[g[r]])/(a-1);for(c=n.jacobi(d),p=c[0],f=c[1],v=n.transpose(p),u=0;u<f.length;u++)for(r=u;r<f.length;r++)f[u]<f[r]&&(e=f[u],f[u]=f[r],f[r]=e,s=v[u],v[u]=v[r],v[r]=s);for(m=n.transpose(g),u=0;o>u;u++)for(l[u]=[],r=0;r<m.length;r++)l[u][r]=n.dot([v[u]],[m[r]]);return[t,f,v,l]}}),function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(r,e){var o=this;return e?(setTimeout(function(){e.call(o,n.fn[t].call(o,r))},15),this):n(n[t](this,r))}})(t[r])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),jStat.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),t=0;t<arguments.length;t++){var r=[1];n[t]=r.concat(arguments[t])}return jStat(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var r=[1];n[t]=r.concat(arguments[0][t])}return jStat(n)},buildjxmatrix:function(n){for(var t=new Array(n.length),r=0;r<n.length;r++)t[r]=n[r];return jStat.builddxmatrix(t)},buildymatrix:function(n){return jStat(n).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(n,t){if(n.cols()==t.rows()){if(t.rows()>1){for(var r=[],e=0;e<n.rows();e++){r[e]=[];for(var o=0;o<t.cols();o++){for(var a=0,u=0;u<n.cols();u++)a+=n.toArray()[e][u]*t.toArray()[u][o];r[e][o]=a}}return jStat(r)}for(var r=[],e=0;e<n.rows();e++){r[e]=[];for(var o=0;o<t.cols();o++){for(var a=0,u=0;u<n.cols();u++)a+=n.toArray()[e][u]*t.toArray()[o];r[e][o]=a}}return jStat(r)}},regress:function(n,t){var r=jStat.xtranspxinv(n),e=n.transpose(),o=jStat.matrixmult(jStat(r),e);return jStat.matrixmult(o,t)},regresst:function(n,t,r){var e=jStat.regress(n,t),o={};o.anova={};var a=jStat.jMatYBar(n,e);o.yBar=a;var u=t.mean();o.anova.residuals=jStat.residuals(t,a),o.anova.ssr=jStat.ssr(a,u),o.anova.msr=o.anova.ssr/(n[0].length-1),o.anova.sse=jStat.sse(t,a),o.anova.mse=o.anova.sse/(t.length-(n[0].length-1)-1),o.anova.sst=jStat.sst(t,u),o.anova.mst=o.anova.sst/(t.length-1),o.anova.r2=1-o.anova.sse/o.anova.sst,o.anova.r2<0&&(o.anova.r2=0),o.anova.fratio=o.anova.msr/o.anova.mse,o.anova.pvalue=jStat.anovaftest(o.anova.fratio,n[0].length-1,t.length-(n[0].length-1)-1),o.anova.rmse=Math.sqrt(o.anova.mse),o.anova.r2adj=1-o.anova.mse/o.anova.mst,o.anova.r2adj<0&&(o.anova.r2adj=0),o.stats=new Array(n[0].length);for(var i,f,c,s=jStat.xtranspxinv(n),l=0;l<e.length;l++)i=Math.sqrt(o.anova.mse*Math.abs(s[l][l])),f=Math.abs(e[l]/i),c=jStat.ttest(f,t.length-n[0].length-1,r),o.stats[l]=[e[l],i,f,c];return o.regress=e,o},xtranspx:function(n){return jStat.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var t=jStat.matrixmult(n.transpose(),n),r=jStat.inv(t);return r},jMatYBar:function(n,t){var r=jStat.matrixmult(n,t);return new jStat(r)},residuals:function(n,t){return jStat.matrixsubtract(n,t)},ssr:function(n,t){for(var r=0,e=0;e<n.length;e++)r+=Math.pow(n[e]-t,2);return r},sse:function(n,t){for(var r=0,e=0;e<n.length;e++)r+=Math.pow(n[e]-t[e],2);return r},sst:function(n,t){for(var r=0,e=0;e<n.length;e++)r+=Math.pow(n[e]-t,2);return r},matrixsubtract:function(n,t){for(var r=new Array(n.length),e=0;e<n.length;e++){r[e]=new Array(n[e].length);for(var o=0;o<n[e].length;o++)r[e][o]=n[e][o]-t[e][o]}return jStat(r)}}),function(n,t){n.extend({gammaln:function(n){var r,e,o,a=0,u=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(o=(e=r=n)+5.5,o-=(r+.5)*t.log(o);6>a;a++)i+=u[a]/++e;return t.log(2.5066282746310007*i/r)-o},gammafn:function(n){var r,e,o,a,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,s=0,l=0,m=n;if(0>=m){if(a=m%1+3.6e-16,!a)return 1/0;f=(1&m?-1:1)*t.PI/t.sin(t.PI*a),m=1-m}for(o=m,e=1>m?m++:(m-=c=(0|m)-1)-1,r=0;8>r;++r)l=(l+u[r])*e,s=s*e+i[r];if(a=l/s+1,m>o)a/=o;else if(o>m)for(r=0;c>r;++r)a*=m,m++;return f&&(a=f/a),a},gammap:function(r,e){var o,a=n.gammaln(r),u=r,i=1/r,f=i,c=e+1-r,s=1/1e-30,l=1/c,m=l,g=1,d=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(0>e||0>=r)return 0/0;if(r+1>e){for(;d>=g;g++)i+=f*=e/++u;return i*t.exp(-e+r*t.log(e)-a)}for(;d>=g;g++)o=-g*(g-r),c+=2,l=o*l+c,s=c+o/s,l=1/l,m*=l*s;return 1-m*t.exp(-e+r*t.log(e)-a)},factorialln:function(t){return 0>t?0/0:n.gammaln(t+1)},factorial:function(t){return 0>t?0/0:n.gammafn(t+1)},combination:function(r,e){return r>170||e>170?t.exp(n.combinationln(r,e)):n.factorial(r)/n.factorial(e)/n.factorial(r-e)},combinationln:function(t,r){return n.factorialln(t)-n.factorialln(r)-n.factorialln(t-r)},permutation:function(t,r){return n.factorial(t)/n.factorial(t-r)},betafn:function(r,e){return 0>=r||0>=e?void 0:r+e>170?t.exp(n.betaln(r,e)):n.gammafn(r)*n.gammafn(e)/n.gammafn(r+e)},betaln:function(t,r){return n.gammaln(t)+n.gammaln(r)-n.gammaln(t+r)},betacf:function(n,r,e){var o,a,u,i,f,c,s,l,m,g=1e-30,d=1;for(s=r+e,m=r+1,l=r-1,u=1,i=1-s*n/m,t.abs(i)<g&&(i=g),i=1/i,c=i;100>=d&&(o=2*d,a=d*(e-d)*n/((l+o)*(r+o)),i=1+a*i,t.abs(i)<g&&(i=g),u=1+a/u,t.abs(u)<g&&(u=g),i=1/i,c*=i*u,a=-(r+d)*(s+d)*n/((r+o)*(m+o)),i=1+a*i,t.abs(i)<g&&(i=g),u=1+a/u,t.abs(u)<g&&(u=g),i=1/i,f=i*u,c*=f,!(t.abs(f-1)<3e-7));d++);return c},gammapinv:function(r,e){var o,a,u,i,f,c,s,l=0,m=e-1,g=1e-8,d=n.gammaln(e);if(r>=1)return t.max(100,e+100*t.sqrt(e));if(0>=r)return 0;for(e>1?(c=t.log(m),s=t.exp(m*(c-1)-d),f=.5>r?r:1-r,u=t.sqrt(-2*t.log(f)),o=(2.30753+.27061*u)/(1+u*(.99229+.04481*u))-u,.5>r&&(o=-o),o=t.max(.001,e*t.pow(1-1/(9*e)-o/(3*t.sqrt(e)),3))):(u=1-e*(.253+.12*e),o=u>r?t.pow(r/u,1/e):1-t.log(1-(r-u)/(1-u)));12>l;l++){if(0>=o)return 0;if(a=n.gammap(e,o)-r,u=e>1?s*t.exp(-(o-m)+m*(t.log(o)-c)):t.exp(-o+m*t.log(o)-d),i=a/u,o-=u=i/(1-.5*t.min(1,i*((e-1)/o-1))),0>=o&&(o=.5*(o+u)),t.abs(u)<g*o)break}return o},erf:function(n){var r,e,o,a,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],i=u.length-1,f=!1,c=0,s=0;for(0>n&&(n=-n,f=!0),r=2/(2+n),e=4*r-2;i>0;i--)o=c,c=e*c-s+u[i],s=o;return a=r*t.exp(-n*n+.5*(u[0]+e*c)-s),f?a-1:1-a},erfc:function(t){return 1-n.erf(t)},erfcinv:function(r){var e,o,a,u,i=0;if(r>=2)return-100;if(0>=r)return 100;for(u=1>r?r:2-r,a=t.sqrt(-2*t.log(u/2)),e=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a);2>i;i++)o=n.erfc(e)-u,e+=o/(1.1283791670955126*t.exp(-e*e)-e*o);return 1>r?e:-e},ibetainv:function(r,e,o){var a,u,i,f,c,s,l,m,g,d,p,v=1e-8,h=e-1,b=o-1,w=0;if(0>=r)return 0;if(r>=1)return 1;for(e>=1&&o>=1?(i=.5>r?r:1-r,f=t.sqrt(-2*t.log(i)),l=(2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f,.5>r&&(l=-l),m=(l*l-3)/6,g=2/(1/(2*e-1)+1/(2*o-1)),d=l*t.sqrt(m+g)/g-(1/(2*o-1)-1/(2*e-1))*(m+5/6-2/(3*g)),l=e/(e+o*t.exp(2*d))):(a=t.log(e/(e+o)),u=t.log(o/(e+o)),f=t.exp(e*a)/e,c=t.exp(o*u)/o,d=f+c,l=f/d>r?t.pow(e*d*r,1/e):1-t.pow(o*d*(1-r),1/o)),p=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);10>w;w++){if(0===l||1===l)return l;if(s=n.ibeta(l,e,o)-r,f=t.exp(h*t.log(l)+b*t.log(1-l)+p),c=s/f,l-=f=c/(1-.5*t.min(1,c*(h/l-b/(1-l)))),0>=l&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),t.abs(f)<v*l&&w>0)break}return l},ibeta:function(r,e,o){var a=0===r||1===r?0:t.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*t.log(r)+o*t.log(1-r));return 0>r||r>1?!1:(e+1)/(e+o+2)>r?a*n.betacf(r,e,o)/e:1-a*n.betacf(1-r,o,e)/o},randn:function(r,e){var o,a,u,i,f;if(e||(e=r),r)return n.create(r,e,function(){return n.randn()});do o=t.random(),a=1.7156*(t.random()-.5),u=o-.449871,i=t.abs(a)+.386595,f=u*u+i*(.196*i-.25472*u);while(f>.27597&&(f>.27846||a*a>-4*t.log(o)*o*o));return a/o},randg:function(r,e,o){var a,u,i,f,c,s,l=r;if(o||(o=e),r||(r=1),e)return s=n.zeros(e,o),s.alter(function(){return n.randg(r)}),s;1>r&&(r+=1),a=r-1/3,u=1/t.sqrt(9*a);do{do c=n.randn(),f=1+u*c;while(0>=f);f=f*f*f,i=t.random()}while(i>1-.331*t.pow(c,4)&&t.log(i)>.5*c*c+a*(1-f+t.log(f)));if(r==l)return a*f;do i=t.random();while(0===i);return t.pow(i,1/l)*a*f}}),function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(){return n(n.map(this,function(r){return n[t](r)}))}})(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}})(t[r])}("randn".split(" "))}(this.jStat,Math),function(n,t){var r=[].slice,e=n.utils.isNumber;n.extend({zscore:function(){var t=r.call(arguments);return e(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var o=r.call(arguments);if(4===o.length){if(e(o[1])){var a=n.zscore(o[0],o[1],o[2]);return 1===o[3]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}var a=o[0];return 1===o[2]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}var a=n.zscore(o[0],o[1],o[3]);return 1===o[1]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}}),n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(r,e,o){var a=t.abs(this.zscore(r,o));return 1===e?n.normal.cdf(-a,0,1):2*n.normal.cdf(-a,0,1)}}),n.extend({tscore:function(){var e=r.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/t.sqrt(e[3])):(e[0]-n.mean(e[1]))/(n.stdev(e[1],!0)/t.sqrt(e[1].length))},ttest:function(){var o,a=r.call(arguments);return 5===a.length?(o=t.abs(n.tscore(a[0],a[1],a[2],a[3])),1===a[4]?n.studentt.cdf(-o,a[3]-1):2*n.studentt.cdf(-o,a[3]-1)):e(a[1])?(o=t.abs(a[0]),1==a[2]?n.studentt.cdf(-o,a[1]-1):2*n.studentt.cdf(-o,a[1]-1)):(o=t.abs(n.tscore(a[0],a[1])),1==a[2]?n.studentt.cdf(-o,a[1].length-1):2*n.studentt.cdf(-o,a[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,e){return 1===e?1-n.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*n.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),n.extend({anovafscore:function(){var e,o,a,u,i,f,c,s,l=r.call(arguments);if(1===l.length){for(i=new Array(l[0].length),c=0;c<l[0].length;c++)i[c]=l[0][c];l=i}if(2===l.length)return n.variance(l[0])/n.variance(l[1]);for(o=new Array,c=0;c<l.length;c++)o=o.concat(l[c]);for(a=n.mean(o),e=0,c=0;c<l.length;c++)e+=l[c].length*t.pow(n.mean(l[c])-a,2);for(e/=l.length-1,f=0,c=0;c<l.length;c++)for(u=n.mean(l[c]),s=0;s<l[c].length;s++)f+=t.pow(l[c][s]-u,2);return f/=o.length-l.length,e/f},anovaftest:function(){var t,o,a,u,i=r.call(arguments);if(e(i[0]))return 1-n.centralF.cdf(i[0],i[1],i[2]);for(anovafscore=n.anovafscore(i),t=i.length-1,a=0,u=0;u<i.length;u++)a+=i[u].length;return o=a-t-1,1-n.centralF.cdf(anovafscore,t,o)},ftest:function(t,r,e){return 1-n.centralF.cdf(t,r,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftest:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return n.ftest(this.anovafscore(),this.length-1,r-this.length)}}),n.extend({normalci:function(){var e,o=r.call(arguments),a=new Array(2);return e=t.abs(4===o.length?n.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3]):n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},tci:function(){var e,o=r.call(arguments),a=new Array(2);return e=t.abs(4===o.length?n.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3]):n.studentt.inv(o[1]/2,o[2].length)*n.stdev(o[2],!0)/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},significant:function(n,t){return t>n}}),n.extend(n.fn,{normalci:function(t,r){return n.normalci(t,r,this.toArray())},tci:function(t,r){return n.tci(t,r,this.toArray())}})}(this.jStat,Math),function(n,t){var r=n.utils.isFunction,e=function(n,t){return n-t};n.extend({sum:function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r];return t},sumsqrd:function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r]*n[r];return t},sumsqerr:function(t){for(var r,e=n.mean(t),o=0,a=t.length;--a>=0;)r=t[a]-e,o+=r*r;
return o},product:function(n){for(var t=1,r=n.length;--r>=0;)t*=n[r];return t},min:function(n){for(var t=n[0],r=0;++r<n.length;)n[r]<t&&(t=n[r]);return t},max:function(n){for(var t=n[0],r=0;++r<n.length;)n[r]>t&&(t=n[r]);return t},mean:function(t){return n.sum(t)/t.length},meansqerr:function(t){return n.sumsqerr(t)/t.length},geomean:function(r){return t.pow(n.product(r),1/r.length)},median:function(n){var t=n.length,r=n.slice().sort(e);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},cumsum:function(n){var t=n.length,r=new Array(t),e=1;for(r[0]=n[0];t>e;e++)r[e]=r[e-1]+n[e];return r},diff:function(n){var t=[],r=n.length,e=1;for(e=1;r>e;e++)t.push(n[e]-n[e-1]);return t},mode:function(n){for(var t=n.length,r=n.slice().sort(e),o=1,a=0,u=0,i=0,f=[];t>i;i++)r[i]===r[i+1]?o++:(o>a?(f=[r[i]],a=o,u=0):o===a&&(f.push(r[i]),u++),o=1);return 0===u?f[0]:f},range:function(t){return n.max(t)-n.min(t)},variance:function(t,r){return n.sumsqerr(t)/(t.length-(r?1:0))},stdev:function(r,e){return t.sqrt(n.variance(r,e))},meandev:function(r){for(var e=0,o=n.mean(r),a=r.length-1;a>=0;a--)e+=t.abs(r[a]-o);return e/r.length},meddev:function(r){for(var e=0,o=n.median(r),a=r.length-1;a>=0;a--)e+=t.abs(r[a]-o);return e/r.length},coeffvar:function(t){return n.stdev(t)/n.mean(t)},quartiles:function(n){var r=n.length,o=n.slice().sort(e);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(3*r/4)-1]]},covariance:function(t,r){for(var e=n.mean(t),o=n.mean(r),a=t.length,u=new Array(a),i=0;a>i;i++)u[i]=(t[i]-e)*(r[i]-o);return n.sum(u)/(a-1)},corrcoeff:function(t,r){return n.covariance(t,r)/n.stdev(t,1)/n.stdev(r,1)}}),function(t){for(var e=0;e<t.length;e++)(function(t){n.fn[t]=function(e,o){var a=[],u=0,i=this;if(r(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(i,n.fn[t].call(i,e))},15),this;if(this.length>1){for(i=e===!0?this:this.transpose();u<i.length;u++)a[u]=n[t](i[u]);return e===!0?n[t](n.utils.toVector(a)):a}return n[t](this[0],e)}})(t[e])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),n.fn.cumsum=function(t,e){var o=[],a=0,u=this;if(r(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(u,n.fn.cumsum.call(u,t))},15),this;if(this.length>1){for(u=t===!0?this:this.transpose();a<u.length;a++)o[a]=n.cumsum(u[a]);return o}return n.cumsum(this[0],t)}}(this.jStat,Math),this.jStat});