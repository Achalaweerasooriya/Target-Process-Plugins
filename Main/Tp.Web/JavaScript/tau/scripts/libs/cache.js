define(["require","Underscore","jQuery"],function(e){function r(e,r){return function(u,t,i){t=t||1e4;var o={};return function(a){var f=""+(i?i.apply(this,arguments):a),d=n.now();if(n.has(o,f)&&d-o[f].time<t)return e(o[f]);var l=u.apply(this,arguments);return o[f]={time:d},r(o[f],l)}}}var n=e("Underscore"),u=e("jQuery");return{plain:r(function(e){return e.value},function(e,r){return e.value=r,r}),plainClone:r(function(e){return n.deepClone(e.value)},function(e,r){return e.value=r,n.deepClone(r)}),deferred:r(function(e){var r=e.deferred;return r||(r=u.Deferred(),n.defer(r.resolve,e.value)),r.promise()},function(e,r){return e.deferred=r,e.value=void 0,u.when(r).then(function(r){e.deferred=void 0,e.value=r}),r.promise()})}});