define(["libs/jquery/jquery","Underscore"],function(e,t){return e.caretTo=function(e,t,n){if(e.createTextRange){var c=e.createTextRange();n&&t!=n?(c.moveStart("character",t),c.moveEnd("character",n)):c.move("character",t),c.select()}else e.setSelectionRange&&(e.focus(),e.setSelectionRange(t,n||t))},e.caretPos=function(e){if("selection"in document){var t=e.createTextRange();try{t.setEndPoint("EndToStart",document.selection.createRange())}catch(n){return 0}return t.text.length}return null!=e.selectionStart?e.selectionStart:void 0},e.fn.caret=function(t,n){return"undefined"==typeof t?e.caretPos(this.get(0)):this.queue(function(c){if(isNaN(t)){var r=e(this).val().indexOf(t);n===!0?r+=t.length:"undefined"!=typeof n&&(r+=n),e.caretTo(this,r)}else e.caretTo(this,t);c()})},e.fn.caretToStart=function(){return this.caret(0)},e.fn.caretToEnd=function(){return this.queue(function(t){e.caretTo(this,e(this).val().length),t()})},e.fn.caretAll=function(){return this.queue(function(n){e.caretTo(this,0,t.asString(e(this).val()).length),n()})},e.clearSelection=function(){document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},e});