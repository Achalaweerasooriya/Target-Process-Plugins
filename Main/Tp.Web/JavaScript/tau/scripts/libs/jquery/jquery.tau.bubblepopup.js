define(["libs/jquery/jquery.ui"],function(a){(function(a,b){var c={TOP:"top",BOTTOM:"bottom",AUTO:"auto"},d={CONTENT:b+"-content",PLACEHOLDER:b+"-placeholder",ACTIVE:b+"-active"};a.widget("ui."+b,{options:{content:"",position:c.AUTO},_create:function(){this._createFrame(),this.hide(),this.setContent(a(this.options.content)),this.setPosition(this.options.position||c.AUTO),this._initDOM()},_createFrame:function(){var c=a("<div/>").addClass(b),e=a("<div/>").addClass(d.CONTENT);c.append(e),this._$frame=c,this._$contentWrapper=e},show:function(){this.updatePosition(),this.element.addClass(d.ACTIVE),this._trigger("show")},hide:function(){this._trigger("hide"),this.element.removeClass(d.ACTIVE)},setContent:function(b){this._$content=a(b).appendTo(this._$contentWrapper.empty())},getContent:function(){return this._$content},setPosition:function(a){if(this._isValidPosition(a)&&a!=this._$position){var b=this._$position=a;b==c.AUTO&&(b=this._calculatePosition()),this._setPositionMarker(b)}},getPosition:function(){return this._$position},updatePosition:function(){this.getPosition()==c.AUTO&&this._setPositionMarker(this._calculatePosition())},_isValidPosition:function(b){var d=!1;a.each(c,function(a,c){if(b==c){d=!0;return!1}});return d},_setPositionMarker:function(b){var d=a.map(c,function(a){if(a!=b)return a});this._$frame.removeClass(d.join(" ")).addClass(b)},_calculatePosition:function(){var b=a(window).height(),d=this.element.outerHeight(),e=this.element.offset(),f=2*e.top+d<b,g=c.TOP;f&&(g=c.BOTTOM);return g},_initDOM:function(){this.element.addClass(d.PLACEHOLDER).append(this._$frame)},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),this._$frame.remove(),this.element.removeClass(d.PLACEHOLDER)}})})(a,"taububblepopup");return a})