define(["Underscore","libs/jquery/jquery.ui"],function(e,t){t.widget("ui.tauPopup",{options:{appendTo:"body",hideOnEscape:!1,enableClose:!0,className:"",overlayTemplate:'<div class="ui-popup-overlay"></div>',popupTemplate:'<div class="ui-popup"></div>',popupContent:""},_create:function(){var e=this.options,i=t(e.appendTo);this.$overlay=t(e.overlayTemplate).appendTo(i),this.$container=this._createContentContainer().appendTo(i),this.setContent(e.popupContent)},_createContentContainer:function(){var e=this.options,i=t(e.popupTemplate);return i.addClass(e.className),e.enableClose&&i.append('<div class="close"></div>'),i},_hideOverflow:function(e){var t="overflow"+this.widgetName,i=e.data(t);i||(i={value:e[0].style.overflow},e.data(t,i)),e[0].style.overflow="hidden"},_restoreOverflow:function(e){var t="overflow"+this.widgetName,i=e.data(t);i&&(e[0].style.overflow=i.value)},show:function(){var i=t(this.options.appendTo);this._hideOverflow(i),this.$overlay.toggleClass("ui-popup-overlay_active_true",!0),this.$container.toggleClass("ui-popup_active_true",!0),this.options.enableClose&&this.$overlay.on("click",e.bind(function(e){this.$overlay.is(e.target)&&this.hide()},this)),this.$container.children(".close").on("click",e.bind(function(){this.hide()},this)),this.options.hideOnEscape&&t(document).on("keydown"+this.eventNamespace,e.bind(function(e){e.keyCode===t.ui.keyCode.ESCAPE&&this.hide()},this)),this._trigger("show")},hide:function(){this.$overlay.toggleClass("ui-popup-overlay_active_true",!1),this.$container.toggleClass("ui-popup_active_true",!1);var e=t(this.options.appendTo);this._restoreOverflow(e),this.$overlay.off("click"),this.$container.children(".close").off("click"),t(document).off("keydown"+this.eventNamespace),this._trigger("hide")},setContent:function(e){e&&(this.$container.append(e),this._trigger("content.updated"))},clearContent:function(){this.$container.html(""),this.$container=this._createContentContainer().appendTo(this.options.appendTo),this._trigger("content.cleared")
},destroy:function(){this.hide(),this.$overlay.remove(),this.$container.remove(),this._trigger("destroy")},widget:function(){return this.$container}})});