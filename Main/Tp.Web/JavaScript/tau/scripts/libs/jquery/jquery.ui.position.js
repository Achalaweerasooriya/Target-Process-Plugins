/*
 * jQuery UI Position @VERSION
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */

define(["libs/jquery/jquery"],function(jq){(function($,undefined){$.ui=$.ui||{};var rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[+-]\d+%?/,rposition=/^\w+/,rpercent=/%$/,center="center",_position=$.fn.position;$.position={scrollbarWidth:function(){var w1,w2,div=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),w1-w2},getScrollInfo:function(within){var notWindow=within[0]!==window,overflowX=notWindow?within.css("overflow-x"):"",overflowY=notWindow?within.css("overflow-y"):"",scrollbarWidth=overflowX==="auto"||overflowX==="scroll"?$.position.scrollbarWidth():0,scrollbarHeight=overflowY==="auto"||overflowY==="scroll"?$.position.scrollbarWidth():0;return{height:within.height()<within[0].scrollHeight?scrollbarHeight:0,width:within.width()<within[0].scrollWidth?scrollbarWidth:0}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var target=$(options.of),within=$(options.within||window),targetElem=target[0],collision=(options.collision||"flip").split(" "),offsets={},atOffset,targetWidth,targetHeight,basePosition;return targetElem.nodeType===9?(targetWidth=target.width(),targetHeight=target.height(),basePosition={top:0,left:0}):$.isWindow(targetElem)?(targetWidth=target.width(),targetHeight=target.height(),basePosition={top:target.scrollTop(),left:target.scrollLeft()}):targetElem.preventDefault?(options.at="left top",targetWidth=targetHeight=0,basePosition={top:options.of.pageY,left:options.of.pageX}):(targetWidth=target.outerWidth(),targetHeight=target.outerHeight(),basePosition=target.offset()),$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;pos.length===1&&(pos=rhorizontal.test(pos[0])?pos.concat([center]):rvertical.test(pos[0])?[center].concat(pos):[center,center]),pos[0]=rhorizontal.test(pos[0])?pos[0]:center,pos[1]=rvertical.test(pos[1])?pos[1]:center,horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),collision.length===1&&(collision[1]=collision[0]),options.at[0]==="right"?basePosition.left+=targetWidth:options.at[0]===center&&(basePosition.left+=targetWidth/2),options.at[1]==="bottom"?basePosition.top+=targetHeight:options.at[1]===center&&(basePosition.top+=targetHeight/2),atOffset=[parseInt(offsets.at[0],10)*(rpercent.test(offsets.at[0])?targetWidth/100:1),parseInt(offsets.at[1],10)*(rpercent.test(offsets.at[1])?targetHeight/100:1)],basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseInt($.css(this,"marginLeft"))||0,marginTop=parseInt($.css(this,"marginTop"))||0,scrollInfo=$.position.getScrollInfo(within),collisionWidth=elemWidth+marginLeft+(parseInt($.css(this,"marginRight"))||0)+scrollInfo.width,collisionHeight=elemHeight+marginTop+(parseInt($.css(this,"marginBottom"))||0)+scrollInfo.height,position=$.extend({},basePosition),myOffset=[parseInt(offsets.my[0],10)*(rpercent.test(offsets.my[0])?elem.outerWidth()/100:1),parseInt(offsets.my[1],10)*(rpercent.test(offsets.my[1])?elem.outerHeight()/100:1)],collisionPosition;options.my[0]==="right"?position.left-=elemWidth:options.my[0]===center&&(position.left-=elemWidth/2),options.my[1]==="bottom"?position.top-=elemHeight:options.my[1]===center&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],$.support.offsetFractions||(position.left=Math.round(position.left),position.top=Math.round(position.top)),collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),$.fn.bgiframe&&elem.bgiframe(),elem.offset($.extend(position,{using:options.using}))})},$.ui.position={fit:{left:function(position,data){var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?win.scrollLeft():within.offset().left,outerWidth=isWindow?win.width():within.outerWidth(),collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight,newOverLeft;data.collisionWidth>outerWidth?overLeft>0&&overRight<=0?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):overRight>0&&overLeft<=0?position.left=withinOffset:overLeft>overRight?position.left=withinOffset+outerWidth-data.collisionWidth:position.left=withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=Math.max(position.left-collisionPosLeft,position.left)},top:function(position,data){var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?win.scrollTop():within.offset().top,outerHeight=isWindow?win.height():within.outerHeight(),collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverTop,newOverBottom;data.collisionHeight>outerHeight?overTop>0&&overBottom<=0?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):overBottom>0&&overTop<=0?position.top=withinOffset:overTop>overBottom?position.top=withinOffset+outerHeight-data.collisionHeight:position.top=withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=Math.max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){if(data.at[0]===center)return;data.elem.removeClass("ui-flipped-left ui-flipped-right");var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=(isWindow?0:within.offset().left)+within.scrollLeft(),outerWidth=isWindow?within.width():within.outerWidth(),collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-withinOffset,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,left=data.my[0]==="left",myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:-data.targetWidth,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<Math.abs(overLeft))data.elem.addClass("ui-flipped-right"),position.left+=myOffset+atOffset+offset}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-withinOffset;if(newOverLeft>0||Math.abs(newOverLeft)<overRight)data.elem.addClass("ui-flipped-left"),position.left+=myOffset+atOffset+offset}},top:function(position,data){if(data.at[1]===center)return;data.elem.removeClass("ui-flipped-top ui-flipped-bottom");var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=(isWindow?0:within.offset().top)+within.scrollTop(),outerHeight=isWindow?within.height():within.outerHeight(),collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-withinOffset,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:-data.targetHeight,offset=-2*data.offset[1],newOverTop,newOverBottom;overTop<0?(newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset,position.top+myOffset+atOffset+offset>overTop&&(newOverBottom<0||newOverBottom<Math.abs(overTop))&&(data.elem.addClass("ui-flipped-bottom"),position.top+=myOffset+atOffset+offset)):overBottom>0&&(newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-withinOffset,position.top+myOffset+atOffset+offset>overBottom&&(newOverTop>0||Math.abs(newOverTop)<overBottom)&&(data.elem.addClass("ui-flipped-top"),position.top+=myOffset+atOffset+offset))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body"),testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},body&&$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});for(i in testElementStyle)testElement.style[i]=testElementStyle[i];testElement.appendChild(div),testElementParent=body||document.documentElement,testElementParent.insertBefore(testElement,testElementParent.firstChild),div.style.cssText="position: absolute; left: 10.7432222px;",offsetLeft=$(div).offset().left,$.support.offsetFractions=offsetLeft>10&&offsetLeft<11,testElement.innerHTML="",testElementParent.removeChild(testElement)}(),$.uiBackCompat!==!1&&function($){var _position=$.fn.position;$.fn.position=function(options){if(!options||!options.offset)return _position.call(this,options);var offset=options.offset.split(" "),at=options.at.split(" ");return offset.length===1&&(offset[1]=offset[0]),/^\d/.test(offset[0])&&(offset[0]="+"+offset[0]),/^\d/.test(offset[1])&&(offset[1]="+"+offset[1]),at.length===1&&(/left|center|right/.test(at[0])?at[1]="center":(at[1]=at[0],at[0]="center")),_position.call(this,$.extend(options,{at:at[0]+offset[0]+" "+at[1]+offset[1],offset:undefined}))}}(jQuery)})(jQuery)})