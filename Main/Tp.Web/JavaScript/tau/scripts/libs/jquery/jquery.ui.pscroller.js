define(["libs/jquery/jquery.ui"],function(jQuery){(function($,namespace,moduleName){var SCROLL_REFRESH_INTERVAL=50,SCROLL_DETECTION_RATIO=.1,isElementOverflown=function($element,dimension){var e=$element[0],isXOverflown,isYOverflown;return dimension=="x"?isXOverflown=e.scrollWidth>e.clientWidth:dimension=="y"&&(isYOverflown=e.scrollHeight>e.clientHeight),isXOverflown||isYOverflown},getElementClientRect=function($element){var e=$element[0],rect=e.getBoundingClientRect(),w=e.clientWidth,h=e.clientHeight,l=rect.left+e.clientLeft,t=rect.top+e.clientTop,r=l+w,b=t+h;return{left:l,top:t,right:r,bottom:b,width:w,height:h}},squeezeRect=function(rect,ratio){var delta={x:rect.width*ratio,y:rect.height*ratio};return rect.left+=delta.x,rect.right-=delta.x,rect.top+=delta.y,rect.bottom-=delta.y,rect.width-=delta.x*2,rect.height-=delta.x*2,rect},Scroller=function(options){this.__options=options};Scroller.prototype={constructor:Scroller,__scrollLeft:function($element,offset){$element[0].scrollLeft-=offset},__scrollTop:function($element,offset){$element[0].scrollTop-=offset},__scrollRight:function($element,offset){$element[0].scrollLeft+=offset},__scrollDown:function($element,offset){$element[0].scrollTop+=offset},__scroll:function(){var point=this.__options.pointProvider();if(point){var $element=this.__$element,scrollDetectionRect=squeezeRect(getElementClientRect($element),this.__options.detectionRatio);isElementOverflown($element,"x")&&(point.x<scrollDetectionRect.left?this.__scrollLeft($element,scrollDetectionRect.left-point.x):point.x>scrollDetectionRect.right&&this.__scrollRight($element,point.x-scrollDetectionRect.right)),isElementOverflown($element,"y")&&(point.y<scrollDetectionRect.top?this.__scrollTop($element,scrollDetectionRect.top-point.y):point.y>scrollDetectionRect.bottom&&this.__scrollDown($element,point.y-scrollDetectionRect.bottom))}},on:function($element){this.__intervalId||(this.__$element=$element,this.__intervalId=setInterval($.proxy(this,"__scroll"),this.__options.refreshRate))},off:function(){this.__intervalId&&(clearInterval(this.__intervalId),this.__intervalId=null,this.__$element=null)}},$.widget(namespace+"."+moduleName,{options:{disabled:!0,refreshInterval:SCROLL_REFRESH_INTERVAL,detectionRatio:SCROLL_DETECTION_RATIO},__setPoint:function(point){this.__point=point},__getPoint:function(){return this.__point},__pointStart:function(evt,point){this.__setPoint(point)},__pointChange:function(evt,point){this.__setPoint(point)},__pointEnd:function(){this.__setPoint(null)},__on:function(){this.__scroller.on(this.element)},__off:function(){this.__scroller.off()},_create:function(){this.__scroller=new Scroller({refreshRate:this.options.refreshInterval,detectionRatio:this.options.detectionRatio,pointProvider:$.proxy(this,"__getPoint")}),this.__gidObserver=$.gid({dragStart:$.proxy(this,"__pointStart"),drag:$.proxy(this,"__pointChange"),dragEnd:$.proxy(this,"__pointEnd")}).on(this.element),this.options.disabled||this.__on()},_setOption:function(name,value){switch(name){case"disabled":this[value?"disable":"enable"]()}},enable:function(){this.options.disabled&&(this.options.disabled=!1,this.__on())},disable:function(){this.options.disabled||(this.options.disabled=!0,this.__off())},destroy:function(){this.__scroller.off(),this.__gidObserver.off(),this.__scroller=null,this.__gidObserver=null,$.Widget.prototype.destroy.call(this)}})})(jQuery,"ui","pscroller")})