define(["libs/jquery/jquery","libs/jquery/jquery.isSupport"],function(e){return function(e){e.fn.extend({animateWithCss:function(s){var n=function(e,s){var n=["","Moz","Webkit"],t=_.reduce(n,function(n){return n||parseFloat(e.css(s))},0)||1;return t},t={cssClassName:"",complete:e.noop,offsetTimeout:0},o=e.extend(t,s),a=e.Deferred();return a.done(o.complete),this.each(function(){var s=e(this);s.removeClass(o.cssClassName).addClass(o.cssClassName);var t=n(s,"AnimationDuration")*n(s,"AnimationIterationCount")*1e3+o.offsetTimeout;_.delay(_.bind(function(e){e&&e.resolve(),this.removeClass(o.cssClassName)},s,a),t)})}})}(e),e});