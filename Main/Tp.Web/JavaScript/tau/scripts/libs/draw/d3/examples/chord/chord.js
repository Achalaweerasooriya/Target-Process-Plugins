function groupTicks(a){var b=(a.endAngle-a.startAngle)/a.value;return d3.range(0,a.value,1e3).map(function(c,e){return{angle:c*b+a.startAngle,label:e%5?null:c/1e3+"k"}})}function fade(a){return function(b,c){svg.selectAll("g.chord path").filter(function(a){return a.source.index!=c&&a.target.index!=c}).transition().style("opacity",a)}}var chord=d3.layout.chord().padding(.05).sortSubgroups(d3.descending).matrix([[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]]),w=600,h=600,r0=Math.min(w,h)*.41,r1=r0*1.1,fill=d3.scale.ordinal().domain(d3.range(4)).range(["#000000","#FFDD89","#957244","#F26223"]),svg=d3.select("#chart").append("svg").attr("width",w).attr("height",h).append("g").attr("transform","translate("+w/2+","+h/2+")");svg.append("g").selectAll("path").data(chord.groups).enter().append("path").style("fill",function(a){return fill(a.index)}).style("stroke",function(a){return fill(a.index)}).attr("d",d3.svg.arc().innerRadius(r0).outerRadius(r1)).on("mouseover",fade(.1)).on("mouseout",fade(1));var ticks=svg.append("g").selectAll("g").data(chord.groups).enter().append("g").selectAll("g").data(groupTicks).enter().append("g").attr("transform",function(a){return"rotate("+(a.angle*180/Math.PI-90)+")"+"translate("+r1+",0)"});ticks.append("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#000"),ticks.append("text").attr("x",8).attr("dy",".35em").attr("text-anchor",function(a){return a.angle>Math.PI?"end":null}).attr("transform",function(a){return a.angle>Math.PI?"rotate(180)translate(-16)":null}).text(function(a){return a.label}),svg.append("g").attr("class","chord").selectAll("path").data(chord.chords).enter().append("path").style("fill",function(a){return fill(a.target.index)}).attr("d",d3.svg.chord().radius(r0)).style("opacity",1)