var data=[,.187,.198,,.133,.175,.151,,.1,.125,.171,,.172,.133,,.108,.142,.167,.201,.175,.159,.169,.177,.141,.163,.117,.182,.153,.195,.189,.134,.163,.133,.151,.145,.13,.139,.169,.164,.175,.135,.152,.169,,.132,.167,.139,.184,.159,.14,.146,.157,,.139,.183,.16,.143],color=d3.scale.linear().domain([d3.min(data),d3.max(data)]).range(["#aad","#556"]),force=d3.layout.force().charge(0).gravity(0).size([960,500]),svg=d3.select("#chart").append("svg");d3.json("../data/us-state-centroids.json",function(a){var b=d3.geo.albersUsa(),c={},d=[],e=a.features.map(function(a){var d=b(a.geometry.coordinates);return c[a.id]={x:d[0],y:d[1],gravity:{x:d[0],y:d[1]},r:Math.sqrt(data[+a.id]*2500),value:data[+a.id]}});force.nodes(e).links(d).start().on("tick",function(a){var b=a.alpha*.5,c=b*.1;e.forEach(function(a,d){a.x+=(a.gravity.x-a.x)*c,a.y+=(a.gravity.y-a.y)*c,e.slice(d+1).forEach(function(c){var d=a.x-c.x,e=a.y-c.y,f=a.r+c.r,g=Math.abs(d),h=Math.abs(e);g<f&&h<f&&(g=(g-f)/g*b,h=(h-f)/h*b,d*=g,e*=h,a.x-=d,a.y-=e,c.x+=d,c.y+=e)})}),svg.selectAll("rect").attr("x",function(a){return a.x-a.r}).attr("y",function(a){return a.y-a.r})}),svg.selectAll("rect").data(e).enter().append("rect").style("fill",function(a){return color(a.value)}).attr("x",function(a){return a.x-a.r}).attr("y",function(a){return a.y-a.r}).attr("width",function(a){return a.r*2}).attr("height",function(a){return a.r*2})})