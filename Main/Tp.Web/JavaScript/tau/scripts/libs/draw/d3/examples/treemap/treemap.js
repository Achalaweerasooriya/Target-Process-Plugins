function cell(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}var w=960,h=500,color=d3.scale.category20c(),treemap=d3.layout.treemap().size([w,h]).sticky(!0).value(function(a){return a.size}),div=d3.select("#chart").append("div").style("position","relative").style("width",w+"px").style("height",h+"px");d3.json("../data/flare.json",function(a){div.data([a]).selectAll("div").data(treemap.nodes).enter().append("div").attr("class","cell").style("background",function(a){return a.children?color(a.name):null}).call(cell).text(function(a){return a.children?null:a.name}),d3.select("#size").on("click",function(){div.selectAll("div").data(treemap.value(function(a){return a.size})).transition().duration(1500).call(cell),d3.select("#size").classed("active",!0),d3.select("#count").classed("active",!1)}),d3.select("#count").on("click",function(){div.selectAll("div").data(treemap.value(function(a){return 1})).transition().duration(1500).call(cell),d3.select("#size").classed("active",!1),d3.select("#count").classed("active",!0)})})