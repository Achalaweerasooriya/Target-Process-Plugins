function nullGravity(){mouse[0]=mouse[1]=null}var w=960,h=500,mouse=[null,null],fill=d3.scale.linear().domain([0,1e4]).range(["brown","steelblue"]),boids=d3.range(100).map(function(){return boid().position([Math.random()*w,Math.random()*h]).velocity([Math.random()*2-1,Math.random()*2-1]).gravityCenter(mouse)}),vertices=boids.map(function(a){return a(boids)});d3.select(window).on("blur",nullGravity);var svg=d3.select("#vis").append("svg").attr("width",w).attr("height",h).attr("class","PiYG").on("mousemove",function(){var a=d3.mouse(this);mouse[0]=a[0],mouse[1]=a[1]}).on("mouseout",nullGravity);svg.selectAll("path").data(d3.geom.voronoi(vertices)).enter().append("path").attr("class",function(a,b){return b?"q"+b%9+"-9":null}).attr("d",function(a){return"M"+a.join("L")+"Z"}),svg.selectAll("circle").data(vertices).enter().append("circle").attr("transform",function(a){return"translate("+a+")"}).attr("r",2),d3.timer(function(){boids.forEach(function(a,b){vertices[b]=a(boids)}),svg.selectAll("circle").data(vertices).attr("transform",function(a){return"translate("+a+")"}),svg.selectAll("path").data(d3.geom.voronoi(vertices)).attr("d",function(a){return"M"+a.join("L")+"Z"}).style("fill",function(a){return fill(d3.geom.polygon(a).area())})})