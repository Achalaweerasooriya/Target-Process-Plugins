function stash(a){a.x0=a.x,a.dx0=a.dx}function arcTween(a){var b=d3.interpolate({x:a.x0,dx:a.dx0},a);return function(c){var d=b(c);return a.x0=d.x,a.dx0=d.dx,arc(d)}}var w=960,h=700,r=Math.min(w,h)/2,color=d3.scale.category20c(),vis=d3.select("#chart").append("svg").attr("width",w).attr("height",h).append("g").attr("transform","translate("+w/2+","+h/2+")"),partition=d3.layout.partition().sort(null).size([2*Math.PI,r*r]).value(function(a){return 1}),arc=d3.svg.arc().startAngle(function(a){return a.x}).endAngle(function(a){return a.x+a.dx}).innerRadius(function(a){return Math.sqrt(a.y)}).outerRadius(function(a){return Math.sqrt(a.y+a.dy)});d3.json("../data/flare.json",function(a){var b=vis.data([a]).selectAll("path").data(partition.nodes).enter().append("path").attr("display",function(a){return a.depth?null:"none"}).attr("d",arc).attr("fill-rule","evenodd").style("stroke","#fff").style("fill",function(a){return color((a.children?a:a.parent).name)}).each(stash);d3.select("#size").on("click",function(){b.data(partition.value(function(a){return a.size})).transition().duration(1500).attrTween("d",arcTween),d3.select("#size").classed("active",!0),d3.select("#count").classed("active",!1)}),d3.select("#count").on("click",function(){b.data(partition.value(function(a){return 1})).transition().duration(1500).attrTween("d",arcTween),d3.select("#size").classed("active",!1),d3.select("#count").classed("active",!0)})})