function d3_geom_quadtreeNode(){return{leaf:!0,nodes:[],point:null}}function d3_geom_quadtreeVisit(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=(c+e)*.5,h=(d+f)*.5,i=b.nodes;i[0]&&d3_geom_quadtreeVisit(a,i[0],c,d,g,h),i[1]&&d3_geom_quadtreeVisit(a,i[1],g,d,e,h),i[2]&&d3_geom_quadtreeVisit(a,i[2],c,h,g,f),i[3]&&d3_geom_quadtreeVisit(a,i[3],g,h,e,f)}}function d3_geom_quadtreePoint(a){return{x:a[0],y:a[1]}}d3.geom.quadtree=function(a,b,c,d,e){function k(a,b,c,d,e,f){if(isNaN(b.x)||isNaN(b.y))return;if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?l(a,b,c,d,e,f):(a.point=null,l(a,g,c,d,e,f),l(a,b,c,d,e,f)):a.point=b}else l(a,b,c,d,e,f)}function l(a,b,c,d,e,f){var g=(c+e)*.5,h=(d+f)*.5,i=b.x>=g,j=b.y>=h,l=(j<<1)+i;a.leaf=!1,a=a.nodes[l]||(a.nodes[l]=d3_geom_quadtreeNode()),i?c=g:e=g,j?d=h:f=h,k(a,b,c,d,e,f)}var f,g=-1,h=a.length;h&&isNaN(a[0].x)&&(a=a.map(d3_geom_quadtreePoint));if(arguments.length<5)if(arguments.length===3)e=d=c,c=b;else{b=c=Infinity,d=e=-Infinity;while(++g<h)f=a[g],f.x<b&&(b=f.x),f.y<c&&(c=f.y),f.x>d&&(d=f.x),f.y>e&&(e=f.y);var i=d-b,j=e-c;i>j?e=c+i:d=b+j}var m=d3_geom_quadtreeNode();return m.add=function(a){k(m,a,b,c,d,e)},m.visit=function(a){d3_geom_quadtreeVisit(a,m,b,c,d,e)},a.forEach(m.add),m}