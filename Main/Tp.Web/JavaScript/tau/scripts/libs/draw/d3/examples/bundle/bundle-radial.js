var r=480,splines=[],cluster=d3.layout.cluster().size([360,r-120]).sort(null).value(function(a){return a.size}),bundle=d3.layout.bundle(),line=d3.svg.line.radial().interpolate("bundle").tension(.85).radius(function(a){return a.y}).angle(function(a){return a.x/180*Math.PI}),vis=d3.select("#chart").append("svg").attr("width",r*2).attr("height",r*2).append("g").attr("transform","translate("+r+","+r+")");d3.json("../data/flare-imports.json",function(a){var b=cluster.nodes(packages.root(a)),c=packages.imports(b);vis.selectAll("path.link").data(splines=bundle(c)).enter().append("path").attr("class","link").attr("d",line),vis.selectAll("g.node").data(b.filter(function(a){return!a.children})).enter().append("g").attr("class","node").attr("transform",function(a){return"rotate("+(a.x-90)+")translate("+a.y+")"}).append("text").attr("dx",function(a){return a.x<180?8:-8}).attr("dy",".31em").attr("text-anchor",function(a){return a.x<180?"start":"end"}).attr("transform",function(a){return a.x<180?null:"rotate(180)"}).text(function(a){return a.key})}),d3.select(window).on("mousemove",function(){vis.selectAll("path.link").data(splines).attr("d",line.tension(Math.min(1,d3.event.clientX/960)))})