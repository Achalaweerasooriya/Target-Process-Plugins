(function(){function a(a,b){var c=b+1;while(c<a.length&&a[c]===0)c++;return c}function b(b,c,d,e){var f=e[0],g=e[1],h=a(c,g);if(h<b.length&&b[h]-b[d]<b[d]-b[f]){var i=a(c,f);e[0]=i,e[1]=h}}function c(a){return(a=1-a*a*a)*a*a}function d(a){var b=a.length,c=0;while(++c<b)if(a[c-1]>=a[c])return!1;return!0}function e(a){var b=a.length,c=-1;while(++c<b)if(!isFinite(a[c]))return!1;return!0}function f(a,b,c,d){var e=[],f=a+c,g=b.length,h=-1;while(++h<g)e[h]=(a*b[h]+c*d[h])/f;return e}function g(a,b){var c=b.length;if(a>c)return null;var d=[],e=[],f={},g=0,i=0,j,k,l;while(i<a){if(g===c)return null;var m=Math.floor(Math.random()*c);if(m in f)continue;f[m]=1,g++,k=b[m],l=!0;for(j=0;j<i;j++)if(h(k,d[j])){l=!1;break}l&&(d[i]=k,e[i]=m,i++)}return d}function h(a,b){if(!a||!b||a.length!==b.length)return!1;var c=a.length,d=-1;while(++d<c)if(a[d]!==b[d])return!1;return!0}science.stats={},science.stats.bandwidth={nrd0:function(a){var b=Math.sqrt(science.stats.variance(a));return(lo=Math.min(b,science.stats.iqr(a)/1.34))||(lo=b)||(lo=Math.abs(a[1]))||(lo=1),.9*lo*Math.pow(a.length,-0.2)},nrd:function(a){var b=science.stats.iqr(a)/1.34;return 1.06*Math.min(Math.sqrt(science.stats.variance(a)),b)*Math.pow(a.length,-0.2)}},science.stats.distance={euclidean:function(a,b){var c=a.length,d=-1,e=0,f;while(++d<c)f=a[d]-b[d],e+=f*f;return Math.sqrt(e)},manhattan:function(a,b){var c=a.length,d=-1,e=0;while(++d<c)e+=Math.abs(a[d]-b[d]);return e},minkowski:function(a){return function(b,c){var d=b.length,e=-1,f=0;while(++e<d)f+=Math.pow(Math.abs(b[e]-c[e]),a);return Math.pow(f,1/a)}},chebyshev:function(a,b){var c=a.length,d=-1,e=0,f;while(++d<c)f=Math.abs(a[d]-b[d]),f>e&&(e=f);return e},hamming:function(a,b){var c=a.length,d=-1,e=0;while(++d<c)a[d]!==b[d]&&e++;return e},jaccard:function(a,b){var c=a.length,d=-1,e=0;while(++d<c)a[d]===b[d]&&e++;return e/c},braycurtis:function(a,b){var c=a.length,d=-1,e=0,f=0,g,h;while(++d<c)g=a[d],h=b[d],e+=Math.abs(g-h),f+=Math.abs(g+h);return e/f}},science.stats.erf=function(a){var b=.254829592,c=-0.284496736,d=1.421413741,e=-1.453152027,f=1.061405429,g=.3275911,h=a<0?-1:1;a<0&&(h=-1,a=-a);var i=1/(1+g*a);return h*(1-((((f*i+e)*i+d)*i+c)*i+b)*i*Math.exp(-a*a))},science.stats.phi=function(a){return.5*(1+science.stats.erf(a/Math.SQRT2))},science.stats.kernel={uniform:function(a){return a<=1&&a>=-1?.5:0},triangular:function(a){return a<=1&&a>=-1?1-Math.abs(a):0},epanechnikov:function(a){return a<=1&&a>=-1?.75*(1-a*a):0},quartic:function(a){if(a<=1&&a>=-1){var b=1-a*a;return.9375*b*b}return 0},triweight:function(a){if(a<=1&&a>=-1){var b=1-a*a;return 35/32*b*b*b}return 0},gaussian:function(a){return 1/Math.sqrt(2*Math.PI)*Math.exp(-0.5*a*a)},cosine:function(a){return a<=1&&a>=-1?Math.PI/4*Math.cos(Math.PI/2*a):0}},science.stats.kde=function(){function a(a,e){var f=d.call(this,c);return a.map(function(a){var d=-1,e=0,g=c.length;while(++d<g)e+=b((a-c[d])/f);return[a,e/f/g]})}var b=science.stats.kernel.gaussian,c=[],d=science.stats.bandwidth.nrd;return a.kernel=function(c){return arguments.length?(b=c,a):b},a.sample=function(b){return arguments.length?(c=b,a):c},a.bandwidth=function(b){return arguments.length?(d=science.functor(b),a):d},a},science.stats.kmeans=function(){function a(a){var e=a.length,f=[],i=[],j=1,k=0,l=g(d,a),m,n,o,p,q,r,s;while(j&&k<c){o=-1;while(++o<d)i[o]=0;n=-1;while(++n<e){p=a[n],r=Infinity,o=-1;while(++o<d)q=b.call(this,l[o],p),q<r&&(r=q,s=o);i[f[n]=s]++}m=[],n=-1;while(++n<e){p=f[n],q=m[p];if(q==null)m[p]=a[n].slice();else{o=-1;while(++o<q.length)q[o]+=a[n][o]}}o=-1;while(++o<d){p=m[o],q=1/i[o],n=-1;while(++n<p.length)p[n]*=q}j=0,o=-1;while(++o<d)if(!h(m[o],l[o])){j=1;break}l=m,k++}return{assignments:f,centroids:l}}var b=science.stats.distance.euclidean,c=1e3,d=1;return a.k=function(b){return arguments.length?(d=b,a):d},a.distance=function(c){return arguments.length?(b=c,a):b},a},science.stats.hcluster=function(){function a(a){var d=a.length,e=[],g=[],h=[],i=[],j,k,l,m,n,o,p,q;p=-1;while(++p<d){e[p]=0,h[p]=[],q=-1;while(++q<d)h[p][q]=p===q?Infinity:b(a[p],a[q]),h[p][e[p]]>h[p][q]&&(e[p]=q)}p=-1;while(++p<d)i[p]=[],i[p][0]={left:null,right:null,dist:0,centroid:a[p],size:1,depth:0},g[p]=1;for(n=0;n<d-1;n++){j=0;for(p=0;p<d;p++)h[p][e[p]]<h[j][e[j]]&&(j=p);k=e[j],l=i[j][0],m=i[k][0],newCluster={left:l,right:m,dist:h[j][k],centroid:f(l.size,l.centroid,m.size,m.centroid),size:l.size+m.size,depth:1+Math.max(l.depth,m.depth)},i[j].splice(0,0,newCluster),g[j]+=g[k];for(q=0;q<d;q++)switch(c){case"single":h[j][q]>h[k][q]&&(h[q][j]=h[j][q]=h[k][q]);break;case"complete":h[j][q]<h[k][q]&&(h[q][j]=h[j][q]=h[k][q]);break;case"average":h[q][j]=h[j][q]=(g[j]*h[j][q]+g[k]*h[k][q])/(g[j]+g[q])}h[j][j]=Infinity;for(p=0;p<d;p++)h[p][k]=h[k][p]=Infinity;for(q=0;q<d;q++)e[q]==k&&(e[q]=j),h[j][q]<h[j][e[j]]&&(e[j]=q);o=newCluster}return o}var b=science.stats.distance.euclidean,c="simple";return a.distance=function(c){return arguments.length?(b=c,a):b},a},science.stats.iqr=function(a){var b=science.stats.quantiles(a,[.25,.75]);return b[1]-b[0]},science.stats.loess=function(){function a(a,i,j){var k=a.length,l;if(k!==i.length)throw{error:"Mismatched array lengths"};if(k==0)throw{error:"At least one point required."};if(arguments.length<3){j=[],l=-1;while(++l<k)j[l]=1}e(a),e(i),e(j),d(a);if(k==1)return[i[0]];if(k==2)return[i[0],i[1]];var m=Math.floor(f*k);if(m<2)throw{error:"Bandwidth too small."};var n=[],o=[],p=[];l=-1;while(++l<k)n[l]=0,o[l]=0,p[l]=1;var q=-1;while(++q<=g){var r=[0,m-1],s;l=-1;while(++l<k){s=a[l],l>0&&b(a,j,l,r);var t=r[0],u=r[1],v=a[l]-a[t]>a[u]-a[l]?t:u,w=0,x=0,y=0,z=0,A=0,B=Math.abs(1/(a[v]-s));for(var C=t;C<=u;++C){var D=a[C],E=i[C],F=C<l?s-D:D-s,G=c(F*B)*p[C]*j[C],H=D*G;w+=G,x+=H,y+=D*H,z+=E*G,A+=E*H}var I=x/w,J=z/w,K=A/w,L=y/w,M=Math.sqrt(Math.abs(L-I*I))<h?0:(K-I*J)/(L-I*I),N=J-M*I;n[l]=M*s+N,o[l]=Math.abs(i[l]-n[l])}if(q===g)break;var O=o.slice();O.sort();var P=O[Math.floor(k/2)];if(Math.abs(P)<h)break;var Q,G;l=-1;while(++l<k)Q=o[l]/(6*P),p[l]=Q>=1?0:(G=1-Q*Q)*G}return n}var f=.3,g=2,h=1e-12;return a.bandwidth=function(b){return arguments.length?(f=b,a):b},a.robustnessIterations=function(b){return arguments.length?(g=b,a):b},a.accuracy=function(b){return arguments.length?(h=b,a):b},a},science.stats.mean=function(a){var b=a.length;if(b===0)return NaN;var c=0,d=-1;while(++d<b)c+=(a[d]-c)/(d+1);return c},science.stats.median=function(a){return science.stats.quantiles(a,[.5])[0]},science.stats.mode=function(a){a=a.slice().sort(science.ascending);var b,c=a.length,d=-1,e=d,f=null,g=0,h,i;while(++d<c)(i=a[d])!==f&&((h=d-e)>g&&(g=h,b=f),f=i,e=d);return b},science.stats.quantiles=function(a,b){a=a.slice().sort(science.ascending);var c=a.length-1;return b.map(function(b){if(b===0)return a[0];if(b===1)return a[c];var d=1+b*c,e=Math.floor(d),f=d-e,g=a[e-1];return f===0?g:g+f*(a[e]-g)})},science.stats.variance=function(a){var b=a.length;if(b<1)return NaN;if(b===1)return 0;var c=science.stats.mean(a),d=-1,e=0;while(++d<b){var f=a[d]-c;e+=f*f}return e/(b-1)}})()