function pad(a){return a.length<6?(new Array(7-a.length)).join("0")+a:a}require("../../test/env");var fs=require("fs"),util=require("util"),Canvas=require("canvas"),w=1920,h=1080,projection=d3.geo.albersUsa().scale(2e3).translate([w/2,h/2]),path=d3.geo.path().projection(projection),canvas=new Canvas(w,h),context=canvas.getContext("2d");context.antialias="none",context.lineWidth=8,context.lineJoin="round",d3.json(__dirname+"/../data/us-counties.json",function(a){function b(b){a.features.forEach(function(a){function g(a){switch(d.charAt(e)){case"M":var b=d.substring(e+1,a).split(",").map(Number);context.moveTo(b[0],b[1]);break;case"L":var b=d.substring(e+1,a).split(",").map(Number);context.lineTo(b[0],b[1]);break;case"Z":context.closePath()}e=a}var c=/[MLZ]/g,d=path(a),e=0,f;context[b+"Style"]="#"+pad((+a.id).toString(16)),context.beginPath(),c.lastIndex=1;while(f=c.exec(d))g(f.index);g(),context[b]()})}b("stroke"),b("fill"),fs.writeFile("us-counties.png",canvas.toBuffer())})