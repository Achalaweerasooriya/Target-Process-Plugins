/*!!
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license <http://www.opensource.org/licenses/mit-license.php>
 * @author Miller Medeiros <http://millermedeiros.com/>
 * @version 0.6
 * @build 174 (04/09/2011 05:27 PM)
 */
/*!!
 * Crossroads - JavaScript Routes
 * Released under the MIT license <http://www.opensource.org/licenses/mit-license.php>
 * @author Miller Medeiros
 * @version 0.4
 * @build 31 (06/07/2011 12:15 AM)
 * ----------------------------------
 *
 * !!! WARNING: Patch for getParamIds method is added. Take into account when update to new version.
 *
 * ----------------------------------
 */
/**
 * @version: 1.0 Alpha-1
 * @author: Coolite Inc. http://www.coolite.com/
 * @date: 2008-05-13
 * @copyright: Copyright (c) 2006-2008, Coolite Inc. (http://www.coolite.com/). All rights reserved.
 * @license: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 * @website: http://www.datejs.com/
 */
/*!
     * Nodeunit
     * Copyright (c) 2010 Caolan McMahon
     * MIT Licensed
     *
     * THIS FILE SHOULD BE BROWSER-COMPATIBLE JS!
     * You can use @REMOVE_LINE_FOR_BROWSER to remove code from the browser build.
     * Only code on that line will be removed, it's mostly to avoid requiring code
     * that is node specific
     */
/*!
 * Nodeunit
 * Copyright (c) 2010 Caolan McMahon
 * MIT Licensed
 *
 * THIS FILE SHOULD BE BROWSER-COMPATIBLE JS!
 * You can use @REMOVE_LINE_FOR_BROWSER to remove code from the browser build.
 * Only code on that line will be removed, its mostly to avoid requiring code
 * that is node specific
 */
/*!
 * Nodeunit
 * Copyright (c) 2010 Caolan McMahon
 * MIT Licensed
 *
 * THIS FILE SHOULD BE BROWSER-COMPATIBLE JS!
 * You can use @REMOVE_LINE_FOR_BROWSER to remove code from the browser build.
 * Only code on that line will be removed, it's mostly to avoid requiring code
 * that is node specific
 */
define("tau/core/class",[],function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,c=function(){},d=0,e=function(a,b){return b};return c.extend=function(c){function j(){!a&&this.init&&(this.__objectId=d++,this.init.apply(this,arguments))}var f=this.prototype;a=!0;var g=new this;a=!1,g.__profiler=g.__profiler||e;for(var h in c){if(h==="__profiler")continue;var i=typeof c[h]=="function"&&typeof f[h]=="function"&&b.test(c[h])?function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);return this._super=c,d}}(h,c[h]):c[h];g[h]=g.__profiler(h,i)}return j.prototype=g,j.constructor=j,j.extend=arguments.callee,j},c}),define("tau/core/event",["Underscore"],function(_){var a=function(){};a.implementOn=function(b){var c=a.prototype;for(var d in c)b[d]==undefined&&(b[d]=c[d]);return b};var b=function(a){var b={},c=a.split(":");return b.name=c[0],c.length>1&&(b.rule=c[1]),b};return a.signUpOnEvents=function(a,c,d,e,f){var g={},h=[],i={},j=function(a){g[a.name]=a;if(_(g).keys().length===h.length){var b={};for(var e=0,f=h.length;e<f;e++){var j=i[h[e]];b[j.name]=g[j.name];if(j.rule==="last")continue;delete g[j.name]}c[d].call(c,b)}};for(var k=0,l=a.length;k<l;k++){var m=b(a[k]),n=m.name;i[n]=m,h.push(n),e.on(n,j,c,null,f)}},a.subscribeOn=function(b){var c=_(b);_.each(c.keys(),function(c){var d=b[c];if(!d)return;if(_.isFunction(d.on)){var e=_(b).functionsExt();for(var f=0,g=e.length;f<g;f++){var h=e[f],i=h.split(" "),j=i[1],k=i[0],l;if(i.length<2)continue;i.length>2&&!isNaN(i[2])&&(l=i[2]);var m=j.split("+");k==c&&(m.length>1?a.signUpOnEvents(m,b,h,d,l):d.on(j,b[h],b,null,l))}}})},a.unSubscribe=function(a){var b=_(a);_.each(b.keys(),function(b){var c=a[b];c&&_.isFunction(c.removeAllListeners)&&c.removeAllListeners(a)})},a.prototype=function(){var b=function(a){var _=a.getPrivate&&a.getPrivate()||a._||(a._={});return _.events||(_.events={})},c=function(a){this.name=a,this.listeners=[]};return c.prototype={getListenerIndex:function(a,b){for(var c=0,d=this.listeners;c<d.length;c++)if(d[c].fn==a&&(d[c].scopeObj===b||!d[c].scopeObj&&(arguments.length==1||!b)))return c;return-1}},{on:function(d,e,f,g,h){if(_.isString(d)&&d.indexOf("+")>0){var i=d.split("+");a.signUpOnEvents(i,this,e,this,h);return}if(_.isArray(d)){var j=arguments.callee,k=this;_.each(d,function(a){j.call(k,a,e,f,g,h)});return}var l=b(this),m=l[d]||(l[d]=new c(d));if(m.getListenerIndex(e,f)<0){var n=m.listeners;f||(f=this),isNaN(h)&&(h=10);var o=this,p=function(a,b,c,h){var i={name:d,sender:this,caller:a,data:b,listenerData:g,stop:c,cancel:h,removeListener:function(){o.removeListener(d,e,f)}};return e.call(f,i),i.data};p.fn=e,p.scopeObj=f,p.priority=h;for(var q=n.length-1;q>=0;q--)if(n[q].priority<=h){n.splice(q+1,0,p);return}n.unshift(p)}return this},fire:function(){var a=!1,c=function(){a=!0},d=!1,e=function(){d=!0};return function(f,g,h){var i=b(this)[f],j=a,k=d;a=d=!1;if(i){var l=i.listeners;if(l.length){l=l.slice(0);for(var m=0;m<l.length;m++){var n=l[m].call(this,h,g,c,e);typeof n!="undefined"&&(g=n);if(a||d)break}}}var o=d||(typeof g=="undefined"?!1:g);return a=j,d=k,o}}(),fireOnce:function(a,c,d){var e=this.fire(a,c,d);return delete b(this)[a],e},removeListener:function(a,c,d){var e=b(this)[a];if(e){var f=e.getListenerIndex(c,d);f>=0&&e.listeners.splice(f,1)}},removeAllListeners:function(a){var c=b(this);for(var d in c)if(c[d].listeners)if(!a)delete c[d].listeners,delete c[d];else{var e=c[d].listeners,f=[];for(var g=0;g<e.length;g++)e[g].scopeObj!=a&&f.push(e[g]);c[d].listeners=f}},hasListeners:function(a){var c=b(this)[a];return c&&c.listeners.length>0},getListeners:function(){var a=b(this),c=[];for(var d in a){var e=a[d].listeners;if(e&&e.length>0){var f=[];for(var g=0;g<e.length;g++){var h=e[g],i={name:"unknown",item:h};h.scopeObj&&h.scopeObj.bus&&h.scopeObj.bus.name?i.name=h.scopeObj.bus.name:h.scopeObj&&h.scopeObj.name&&(i.name=h.scopeObj.name),f.push(i)}c.push({name:d,items:e,count:e.length,listeners:f})}}return c},getListenersCount:function(){var a=b(this),c=0;for(var d in a)a[d].listeners&&(c+=a[d].listeners.length);return c}}}(),a}),define("tau/core/profile.methods",[],function(){var a=0,b=function(b,c){return typeof c!="function"?c:function(){var d=this,e=(d.name||d.__objectId)+"/"+b;++a;var f=(new Array(a)).join("    ");console.log(f,e);var g=+(new Date),h=c.apply(d,arguments),i=+(new Date);return console.log(f,i-g),--a,h}},c=1,d=[],e=function(a,b){return typeof b!="function"?b:function(){var e=this,f=(e.name||e.__objectId)+"/"+a,g={name:f,level:c};d.push(g),++c;var h=+(new Date),i=b.apply(e,arguments),j=+(new Date);return--c,g.value=j-h,i}},f=function(){var a={name:"root",stack:[]},b=[a];for(var c=0;c<d.length;c++){var e=d[c],f=e.level,g={name:e.name,value:e.value,stack:[]};b[f-1].stack.push(g),b[f]=g}var h=0;for(var i=0;i<a.stack.length;i++)h+=a.stack[i].value;return a.value=h,{tree:a,plain:d}};return{console:b,accumulate:{method:e,result:f}}}),define("tau/core/event.emitter",["tau/core/class","tau/core/event","tau/core/profile.methods"],function(a,b,c){var d=function(){},e=a.extend({init:function(a){this.bus=a.bus,b.subscribeOn(this)},"bus refresh":function(a){this.lifeCycleCleanUp()},lifeCycleCleanUp:d,on:function(){this.bus.on.apply(this.bus,arguments)},fire:function(){return this.bus.fire.apply(this.bus,arguments)},"bus destroy":function(){this.on=d,this.fire=d,this.destroy()},destroy:function(){var a=this.bus.getGlobalBus();a&&a.removeAllListeners(this),b.unSubscribe(this),delete this.bus}});return window.appIsInDebugMode!==!0,e}),define("tau/store/typesClass",["Underscore","tau/core/class"],function(_,a){return a.extend({init:function(){this._dictionary={}},registerType:function(a,b){b[a.name]=a,a.aliases=a.aliases||[],a.refs=a.refs||{},_.each(a.aliases,function(c){b[c]=b[c.toLowerCase()]=a})},register:function(a){var b=this,c=b._dictionary;this.registerType(a,c)},findByKeyword:function(a){return this._dictionary[a]||null},getDictionary:function(){return this._dictionary}})}),define("tau/store/types",["tau/store/typesClass"],function(a){return new a}),define("tau/store/types.targetprocess.generated",["tau/store/types"],function(a){return[{name:"context"},{name:"process",parent:null,resource:"processes",aliases:["Process","processes","Processes"],fields:["id","name"],simpleFields:["id","name","description","entityStates-count","projects-count","practices-count","customFields-count"],refs:{entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"process"},projects:{list:!0,name:"project",multiplicity:"one",relationProperty:"process"},practices:{list:!0,name:"practice",multiplicity:"",relationProperty:""},customFields:{list:!0,name:"customField",multiplicity:"one",relationProperty:"process"}}},{name:"practice",parent:null,resource:"practices",aliases:["Practice","practices","Practices"],fields:["id","name"],simpleFields:["id","name","description","processes-count"],refs:{processes:{list:!0,name:"process",multiplicity:"",relationProperty:""}}},{name:"entityType",parent:null,resource:"entityTypes",aliases:["EntityType","entityTypes","EntityTypes"],fields:["id","name"],simpleFields:["id","name","isExtendable","entityStates-count"],refs:{entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"entityType"}}},{name:"priority",parent:null,resource:"priorities",aliases:["Priority","priorities","Priorities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"priorities"}}},{name:"severity",parent:null,resource:"severities",aliases:["Severity","severities","Severities"],fields:["id","name"],simpleFields:["id","name","importance","isDefault"],refs:{}},{name:"entityState",parent:null,resource:"entityStates",aliases:["EntityState","entityStates","EntityStates"],fields:["id","name"],simpleFields:["id","name","isInitial","isFinal","isPlanned","isCommentRequired","numericPriority","nextStates-count","previousStates-count"],refs:{role:{name:"role",multiplicity:"",relationProperty:"entityStates"},nextStates:{list:!0,name:"entityState",multiplicity:"",relationProperty:""},previousStates:{list:!0,name:"entityState",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"entityStates"},process:{name:"process",multiplicity:"",relationProperty:"entityStates"}}},{name:"general",parent:null,resource:"generals",aliases:["General","generals","Generals"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"assignable",parent:"general",resource:"assignables",aliases:["Assignable","assignables","Assignables"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},release:{name:"release",multiplicity:"",relationProperty:"assignables"},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"generalUser",parent:null,resource:"generalUsers",aliases:["GeneralUser","generalUsers","GeneralUsers"],fields:["id","firstName","lastName"],simpleFields:["id","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","assignables-count","comments-count","requests-count"],refs:{assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"user",parent:"generalUser",resource:"users",aliases:["User","users","Users"],fields:["id","firstName","lastName"],simpleFields:["id","weeklyAvailableHours","currentAllocation","currentAvailableHours","availableFrom","availableFutureAllocation","availableFutureHours","isObserver","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","times-count","impediments-count","customActivities-count","revisions-count","teamMembers-count","assignables-count","comments-count","requests-count"],refs:{role:{name:"role",multiplicity:"",relationProperty:""},times:{list:!0,name:"time",multiplicity:"one",relationProperty:"user"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"responsible"},customActivities:{list:!0,name:"customActivity",multiplicity:"one",relationProperty:"user"},revisions:{list:!0,name:"revision",multiplicity:"one",relationProperty:"author"},teamMembers:{list:!0,name:"teamMember",multiplicity:"one",relationProperty:"user"},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"requester",parent:"generalUser",resource:"requesters",aliases:["Requester","requesters","Requesters"],fields:["id","firstName","lastName"],simpleFields:["id","phone","notes","sourceType","firstName","lastName","email","login","createDate","modifyDate","deleteDate","isActive","isAdministrator","kind","password","assignables-count","comments-count","requests-count"],refs:{company:{name:"company",multiplicity:"",relationProperty:""},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"owner"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""}}},{name:"project",parent:"general",resource:"projects",aliases:["Project","projects","Projects"],fields:["id","name"],simpleFields:["id","isActive","isProduct","abbreviation","mailReplyAddress","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","generals-count","features-count","releases-count","iterations-count","userStories-count","tasks-count","bugs-count","testCases-count","testPlans-count","builds-count","times-count","revisions-count","customActivities-count","projectMembers-count","teamProjects-count","requests-count","testPlanRuns-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{generals:{list:!0,name:"general",multiplicity:"one",relationProperty:"project"},program:{name:"program",multiplicity:"",relationProperty:"projects"},process:{name:"process",multiplicity:"",relationProperty:"projects"},features:{list:!0,name:"feature",multiplicity:"one",relationProperty:"project"},releases:{list:!0,name:"release",multiplicity:"one",relationProperty:"project"},iterations:{list:!0,name:"iteration",multiplicity:"one",relationProperty:"project"},userStories:{list:!0,name:"userStory",multiplicity:"one",relationProperty:"project"},tasks:{list:!0,name:"task",multiplicity:"one",relationProperty:"project"},bugs:{list:!0,name:"bug",multiplicity:"one",relationProperty:"project"},testCases:{list:!0,name:"testCase",multiplicity:"one",relationProperty:"project"},testPlans:{list:!0,name:"testPlan",multiplicity:"one",relationProperty:"project"},builds:{list:!0,name:"build",multiplicity:"one",relationProperty:"project"},times:{list:!0,name:"time",multiplicity:"one",relationProperty:"project"},revisions:{list:!0,name:"revision",multiplicity:"one",relationProperty:"project"},customActivities:{list:!0,name:"customActivity",multiplicity:"one",relationProperty:"project"},company:{name:"company",multiplicity:"",relationProperty:"projects"},projectMembers:{list:!0,name:"projectMember",multiplicity:"one",relationProperty:"project"},teamProjects:{list:!0,name:"teamProject",multiplicity:"one",relationProperty:"project"},requests:{list:!0,name:"request",multiplicity:"one",relationProperty:"project"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"one",relationProperty:"project"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"program",parent:"general",resource:"programs",aliases:["Program","programs","Programs"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","projects-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{projects:{list:!0,name:"project",multiplicity:"zeroOrOne",relationProperty:"program"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"release",parent:"general",resource:"releases",aliases:["Release","releases","Releases"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","iterations-count","assignables-count","features-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"releases"},iterations:{list:!0,name:"iteration",multiplicity:"one",relationProperty:"release"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"release"},features:{list:!0,name:"feature",multiplicity:"zeroOrOne",relationProperty:"release"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"release"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"release"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"release"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"release"},requests:{list:!0,name:"request",multiplicity:"zeroOrOne",relationProperty:"release"},builds:{list:!0,name:"build",multiplicity:"one",relationProperty:"release"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"iteration",parent:"general",resource:"iterations",aliases:["Iteration","iterations","Iterations"],fields:["id","name"],simpleFields:["id","velocity","duration","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","assignables-count","userStories-count","tasks-count","bugs-count","testPlanRuns-count","requests-count","builds-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"iterations"},release:{name:"release",multiplicity:"",relationProperty:"iterations"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"iteration"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"iteration"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"iteration"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"iteration"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"iteration"},requests:{list:!0,name:"request",multiplicity:"zeroOrOne",relationProperty:"iteration"},builds:{list:!0,name:"build",multiplicity:"zeroOrOne",relationProperty:"iteration"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"teamIteration",parent:"general",resource:"teamIterations",aliases:["TeamIteration","teamIterations","TeamIterations"],fields:["id","name"],simpleFields:["id","velocity","duration","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","assignables-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamIterations"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"teamIteration"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"team",parent:"general",resource:"teams",aliases:["Team","teams","Teams"],fields:["id","name"],simpleFields:["id","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","teamMembers-count","teamProjects-count","assignables-count","teamIterations-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{teamMembers:{list:!0,name:"teamMember",multiplicity:"one",relationProperty:"team"},teamProjects:{list:!0,name:"teamProject",multiplicity:"one",relationProperty:"team"},assignables:{list:!0,name:"assignable",multiplicity:"zeroOrOne",relationProperty:"team"},teamIterations:{list:!0,name:"teamIteration",multiplicity:"one",relationProperty:"team"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"feature",parent:"assignable",resource:"features",aliases:["Feature","features","Features"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","userStories-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"features"},release:{name:"release",multiplicity:"",relationProperty:"features"},userStories:{list:!0,name:"userStory",multiplicity:"zeroOrOne",relationProperty:"feature"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},iteration:{name:"iteration",multiplicity:"",relationProperty:"assignables"},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"userStory",parent:"assignable",resource:"userStories",aliases:["UserStory","userStories","UserStories"],fields:["id","name"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","tasks-count","bugs-count","testCases-count","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"userStories"},feature:{name:"feature",multiplicity:"",relationProperty:"userStories"},tasks:{list:!0,name:"task",multiplicity:"zeroOrOne",relationProperty:"userStory"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"userStory"},testCases:{list:!0,name:"testCase",multiplicity:"zeroOrOne",relationProperty:"userStory"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"userStory"},release:{name:"release",multiplicity:"",relationProperty:"userStories"},iteration:{name:"iteration",multiplicity:"",relationProperty:"userStories"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"task",parent:"assignable",resource:"tasks",aliases:["Task","tasks","Tasks"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"tasks"},userStory:{name:"userStory",multiplicity:"",relationProperty:"tasks"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"task"},release:{name:"release",multiplicity:"",relationProperty:"tasks"},iteration:{name:"iteration",multiplicity:"",relationProperty:"tasks"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"bug",parent:"assignable",resource:"bugs",aliases:["Bug","bugs","Bugs"],fields:["id","name"],simpleFields:["id","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","times-count","requests-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"bugs"},build:{name:"build",multiplicity:"",relationProperty:"bugs"},userStory:{name:"userStory",multiplicity:"",relationProperty:"bugs"},severity:{name:"severity",multiplicity:"",relationProperty:"bugs"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"bug"},release:{name:"release",multiplicity:"",relationProperty:"bugs"},iteration:{name:"iteration",multiplicity:"",relationProperty:"bugs"},requests:{list:!0,name:"request",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testCase",parent:"general",resource:"testCases",aliases:["TestCase","testCases","TestCases"],fields:["id","name"],simpleFields:["id","steps","success","lastStatus","lastFailureComment","lastRunDate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testPlans-count","testCaseRuns-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"testCases"},userStory:{name:"userStory",multiplicity:"",relationProperty:"testCases"},priority:{name:"priority",multiplicity:"",relationProperty:"testCases"},testPlans:{list:!0,name:"testPlan",multiplicity:"",relationProperty:""},testCaseRuns:{list:!0,name:"testCaseRun",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testCaseRun",parent:null,resource:"testCaseRuns",aliases:["TestCaseRun","testCaseRuns","TestCaseRuns"],fields:["id"],simpleFields:["id","executed","passed","comment","runDate","testCases-count"],refs:{testPlanRun:{name:"testPlanRun",multiplicity:"",relationProperty:"testCaseRuns"},testCases:{list:!0,name:"testCase",multiplicity:"",relationProperty:""}}},{name:"testPlan",parent:"general",resource:"testPlans",aliases:["TestPlan","testPlans","TestPlans"],fields:["id","name"],simpleFields:["id","initialEstimate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testCases-count","testPlanRuns-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"testPlans"},testCases:{list:!0,name:"testCase",multiplicity:"",relationProperty:""},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"one",relationProperty:"testPlan"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"testPlanRun",parent:"assignable",resource:"testPlanRuns",aliases:["TestPlanRun","testPlanRuns","TestPlanRuns"],fields:["id","name"],simpleFields:["id","passedCount","failedCount","notRunCount","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","testCaseRuns-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{release:{name:"release",multiplicity:"",relationProperty:"testPlanRuns"},build:{name:"build",multiplicity:"",relationProperty:"testPlanRuns"},iteration:{name:"iteration",multiplicity:"",relationProperty:"testPlanRuns"},testPlan:{name:"testPlan",multiplicity:"",relationProperty:"testPlanRuns"},project:{name:"project",multiplicity:"",relationProperty:"testPlanRuns"},testCaseRuns:{list:!0,name:"testCaseRun",multiplicity:"one",relationProperty:"testPlanRun"},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"time",parent:null,resource:"times",aliases:["Time","times","Times"],fields:["id"],simpleFields:["id","description","spent","remain","isEstimation","date","createDate"],refs:{project:{name:"project",multiplicity:"",relationProperty:"times"},user:{name:"user",multiplicity:"",relationProperty:"times"},assignable:{name:"assignable",multiplicity:"",relationProperty:"times"},role:{name:"role",multiplicity:"",relationProperty:"times"},customActivity:{name:"customActivity",multiplicity:"",relationProperty:"times"}}},{name:"revision",parent:null,resource:"revisions",aliases:["Revision","revisions","Revisions"],fields:["id"],simpleFields:["id","sourceControlId","description","commitDate","revisionFiles-count","assignables-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"revisions"},revisionFiles:{list:!0,name:"revisionFile",multiplicity:"one",relationProperty:"revision"},author:{name:"user",multiplicity:"",relationProperty:"revisions"},assignables:{list:!0,name:"assignable",multiplicity:"",relationProperty:""}}},{name:"revisionFile",parent:null,resource:"revisionFiles",aliases:["RevisionFile","revisionFiles","RevisionFiles"],fields:["id","fileName"],simpleFields:["id","fileName","fileAction"],refs:{revision:{name:"revision",multiplicity:"",relationProperty:"revisionFiles"}}},{name:"customActivity",parent:null,resource:"customActivities",aliases:["CustomActivity","customActivities","CustomActivities"],fields:["id","name"],simpleFields:["id","name","created","estimate","times-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"customActivities"},user:{name:"user",multiplicity:"",relationProperty:"customActivities"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"customActivity"}}},{name:"request",parent:"assignable",resource:"requests",aliases:["Request","requests","Requests"],fields:["id","name"],simpleFields:["id","sourceType","isReplied","isPrivate","effort","effortCompleted","effortToDo","timeSpent","timeRemain","leadTime","cycleTime","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","tasks-count","features-count","userStories-count","bugs-count","requesters-count","relatedEntities-count","assignedUser-count","assignments-count","impediments-count","times-count","roleEfforts-count","revisions-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"requests"},release:{name:"release",multiplicity:"",relationProperty:"requests"},iteration:{name:"iteration",multiplicity:"",relationProperty:"requests"},requestType:{name:"requestType",multiplicity:"",relationProperty:"requests"},tasks:{list:!0,name:"task",multiplicity:"",relationProperty:""},features:{list:!0,name:"feature",multiplicity:"",relationProperty:""},userStories:{list:!0,name:"userStory",multiplicity:"",relationProperty:""},bugs:{list:!0,name:"bug",multiplicity:"",relationProperty:""},requesters:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},relatedEntities:{list:!0,name:"general",multiplicity:"",relationProperty:""},assignedUser:{list:!0,name:"generalUser",multiplicity:"",relationProperty:""},teamIteration:{name:"teamIteration",multiplicity:"",relationProperty:"assignables"},team:{name:"team",multiplicity:"",relationProperty:"assignables"},priority:{name:"priority",multiplicity:"",relationProperty:"assignables"},entityState:{name:"entityState",multiplicity:"",relationProperty:"assignables"},assignments:{list:!0,name:"assignment",multiplicity:"one",relationProperty:"assignable"},impediments:{list:!0,name:"impediment",multiplicity:"zeroOrOne",relationProperty:"assignable"},times:{list:!0,name:"time",multiplicity:"zeroOrOne",relationProperty:"assignable"},roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"assignable"},revisions:{list:!0,name:"revision",multiplicity:"",relationProperty:""},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"requestType",parent:null,resource:"requestTypes",aliases:["RequestType","requestTypes","RequestTypes"],fields:["id","name"],simpleFields:["id","name","requests-count"],refs:{requests:{list:!0,name:"request",multiplicity:"one",relationProperty:"requestType"}}},{name:"build",parent:"general",resource:"builds",aliases:["Build","builds","Builds"],fields:["id","name"],simpleFields:["id","buildDate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","bugs-count","testPlanRuns-count","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{project:{name:"project",multiplicity:"",relationProperty:"builds"},release:{name:"release",multiplicity:"",relationProperty:"builds"},iteration:{name:"iteration",multiplicity:"",relationProperty:"builds"},bugs:{list:!0,name:"bug",multiplicity:"zeroOrOne",relationProperty:"build"},testPlanRuns:{list:!0,name:"testPlanRun",multiplicity:"zeroOrOne",relationProperty:"build"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"comment",parent:null,resource:"comments",aliases:["Comment","comments","Comments"],fields:["id"],simpleFields:["id","description","parentId","createDate"],refs:{general:{name:"general",multiplicity:"",relationProperty:"comments"},owner:{name:"generalUser",multiplicity:"",relationProperty:"comments"}}},{name:"assignment",parent:null,resource:"assignments",aliases:["Assignment","assignments","Assignments"],fields:["id"],simpleFields:["id"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"assignments"},generalUser:{name:"user",multiplicity:"",relationProperty:"assignments"},role:{name:"role",multiplicity:"",relationProperty:"assignments"}}},{name:"role",parent:null,resource:"roles",aliases:["Role","roles","Roles"],fields:["id","name"],simpleFields:["id","name","isPair","hasEffort","roleEfforts-count","entityStates-count"],refs:{roleEfforts:{list:!0,name:"roleEffort",multiplicity:"one",relationProperty:"role"},entityStates:{list:!0,name:"entityState",multiplicity:"one",relationProperty:"role"}}},{name:"impediment",parent:"general",resource:"impediments",aliases:["Impediment","impediments","Impediments"],fields:["id","name"],simpleFields:["id","isPrivate","name","description","startDate","endDate","createDate","modifyDate","lastCommentDate","tags","numericPriority","comments-count","messages-count","relatedRequests-count","attachments-count"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"impediments"},entityState:{name:"entityState",multiplicity:"",relationProperty:"impediments"},priority:{name:"priority",multiplicity:"",relationProperty:"impediments"},responsible:{name:"user",multiplicity:"",relationProperty:"impediments"},entityType:{name:"entityType",multiplicity:"",relationProperty:"generals"},owner:{name:"generalUser",multiplicity:"",relationProperty:"generals"},project:{name:"project",multiplicity:"",relationProperty:"generals"},comments:{list:!0,name:"comment",multiplicity:"one",relationProperty:"general"},messages:{list:!0,name:"message",multiplicity:"",relationProperty:""},relatedRequests:{list:!0,name:"request",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"one",relationProperty:"general"}}},{name:"company",parent:null,resource:"companies",aliases:["Company","companies","Companies"],fields:["id","name"],simpleFields:["id","name","url","description","projects-count"],refs:{projects:{list:!0,name:"project",multiplicity:"zeroOrOne",relationProperty:"company"}}},{name:"roleEffort",parent:null,resource:"roleEfforts",aliases:["RoleEffort","roleEfforts","RoleEfforts"],fields:["id"],simpleFields:["id","initialEstimate","effort","effortCompleted","effortToDo","timeSpent","timeRemain"],refs:{assignable:{name:"assignable",multiplicity:"",relationProperty:"roleEfforts"},role:{name:"role",multiplicity:"",relationProperty:"roleEfforts"}}},{name:"projectMember",parent:null,resource:"projectMembers",aliases:["ProjectMember","projectMembers","ProjectMembers"],fields:["id"],simpleFields:["id","weeklyAvailableHours","membershipStartDate","membershipEndDate","allocation"],refs:{project:{name:"project",multiplicity:"",relationProperty:"projectMembers"},user:{name:"user",multiplicity:"",relationProperty:""},role:{name:"role",multiplicity:"",relationProperty:""}}},{name:"teamMember",parent:null,resource:"teamMembers",aliases:["TeamMember","teamMembers","TeamMembers"],fields:["id"],simpleFields:["id","startDate","endDate"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamMembers"},user:{name:"user",multiplicity:"",relationProperty:"teamMembers"},role:{name:"role",multiplicity:"",relationProperty:""}}},{name:"teamProject",parent:null,resource:"teamProjects",aliases:["TeamProject","teamProjects","TeamProjects"],fields:["id"],simpleFields:["id","startDate","endDate"],refs:{team:{name:"team",multiplicity:"",relationProperty:"teamProjects"},project:{name:"project",multiplicity:"",relationProperty:"teamProjects"}}},{name:"message",parent:null,resource:"messages",aliases:["Message","messages","Messages"],fields:["id"],simpleFields:["id","subject","recipients","body","isRead","isProcessed","createDate","sendDate","messageType","contentType","generals-count","attachments-count"],refs:{from:{name:"generalUser",multiplicity:"",relationProperty:"messagesFrom"},to:{name:"generalUser",multiplicity:"",relationProperty:"messagesTo"},messageUid:{name:"messageUid",multiplicity:"",relationProperty:""},generals:{list:!0,name:"general",multiplicity:"",relationProperty:""},attachments:{list:!0,name:"attachment",multiplicity:"zeroOrOne",relationProperty:"message"}}},{name:"messageUid",parent:null,resource:"messageUids",aliases:["MessageUid","messageUids","MessageUids"],fields:["id"],simpleFields:["id","uid","mailServer","mailLogin"],refs:{}},{name:"customField",parent:null,resource:"customFields",aliases:["CustomField","customFields","CustomFields"],fields:["id","name","entityFieldName"],simpleFields:["id","name","value","entityFieldName","fieldType","enabledForFilter","required"],refs:{entityType:{name:"entityType",multiplicity:"",relationProperty:"customFields"},process:{name:"process",multiplicity:"",relationProperty:"customFields"}}},{name:"resourceBase",parent:"resource",resource:"resourceBases",aliases:["ResourceBase","resourceBases","ResourceBases"],fields:["id"],simpleFields:["id","actions-count"],refs:{actions:{list:!0,name:"action",multiplicity:"one",relationProperty:"entity"}}},{name:"attachment",parent:null,resource:"attachments",aliases:["Attachment","attachments","Attachments"],fields:["id","name"],simpleFields:["id","name","description","date","mimeType","uri","thumbnailUri","size"],refs:{owner:{name:"generalUser",multiplicity:"",relationProperty:"attachments"},general:{name:"general",multiplicity:"",relationProperty:"attachments"},message:{name:"message",multiplicity:"",relationProperty:"attachments"}}},{name:"history",parent:"resource",resource:"histories",aliases:["History","histories","Histories"],fields:["id"],simpleFields:["id","date","description","modification"],refs:{entity:{name:"general",multiplicity:"",relationProperty:"histories"},innerEntity:{name:"general",multiplicity:"",relationProperty:""},modifier:{name:"generalUser",multiplicity:"",relationProperty:""}}},{name:"change",parent:"resource",resource:"changes",aliases:["Change","changes","Changes"],fields:["id"],simpleFields:["id","field","oldValue","newValue"],refs:{history:{name:"history",multiplicity:"",relationProperty:"changes"}}},{name:"action",parent:"resource",resource:"actions",aliases:["Action","actions","Actions"],fields:["id","name"],simpleFields:["id","name","uri"],refs:{entity:{name:"resourceBase",multiplicity:"",relationProperty:"actions"}}},{name:"context",parent:null,resource:"contexts",aliases:["Context","contexts","Contexts"],fields:["id"],simpleFields:["id","acid","edition","selectedProjects-count","processes-count"],refs:{loggedUser:{name:"user",multiplicity:"",relationProperty:""},culture:{name:"culture",multiplicity:"",relationProperty:""},selectedProjects:{list:!0,name:"projectInfo",multiplicity:"",relationProperty:""},processes:{list:!0,name:"processInfo",multiplicity:"",relationProperty:""}}},{name:"culture",parent:null,resource:"cultures",aliases:["Culture","cultures","Cultures"],fields:["id","name"],simpleFields:["id","name","decimalSeparator","shortDateFormat","longDateFormat","timePattern"],refs:{}},{name:"processInfo",parent:null,resource:"processInfos",aliases:["ProcessInfo","processInfos","ProcessInfos"],fields:["id","name"],simpleFields:["id","name","terms-count","customFields-count","practices-count"],refs:{terms:{list:!0,name:"term",multiplicity:"",relationProperty:""},customFields:{list:!0,name:"customFieldInfo",multiplicity:"",relationProperty:""},practices:{list:!0,name:"practice",multiplicity:"",relationProperty:""}}},{name:"term",parent:null,resource:"terms",aliases:["Term","terms","Terms"],fields:["id","name"],simpleFields:["id","name","value"],refs:{}},{name:"customFieldInfo",parent:null,resource:"customFieldInfos",aliases:["CustomFieldInfo","customFieldInfos","CustomFieldInfos"],fields:["id","name"],simpleFields:["id","entityKind","name","type","required","listed"],refs:{}},{name:"projectInfo",parent:null,resource:"projectInfos",aliases:["ProjectInfo","projectInfos","ProjectInfos"],fields:["id","name"],simpleFields:["id","name"],refs:{process:{name:"processInfo",multiplicity:"",relationProperty:""},program:{name:"programInfo",multiplicity:"",relationProperty:""}}},{name:"programInfo",parent:null,resource:"programInfos",aliases:["ProgramInfo","programInfos","ProgramInfos"],fields:["id","name"],simpleFields:["id","name"],refs:{}}]}),define("tau/store/types.targetprocess",["Underscore","tau/store/types","tau/store/types.targetprocess.generated"],function(_,a,b){var c=function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a.charAt(c);c===0?e=e.toUpperCase():e===e.toUpperCase()&&b.push(" "),b.push(e)}return b.join("")},d=function(a){return{key:a,val:a}},e=function(a){var b=a.length-1;if(a.charAt(b)==="y"){var c=a.substring(0,b),d="ies";a=c+d}else a+="s";return{key:a,val:a}},f=function(a){var b=a.split(" "),c=b.length,d=c-1||0,e=b[d];return{key:a+" Big Icon Text",val:e}},g=function(a){var b=a.split(" "),c=b.length,d=c-1||0,e=b[d];return{key:a+" Small Icon Text",val:e.charAt(0)}},h=function(a){if(a&&a.entityType&&a.entityType.name)return a.entityType.name;throw"type of entity is not detected"},i=function(a){var b=c(a);return{name:d(b),names:e(b),iconBig:f(b),iconSmall:g(b)}};return _.each(b,function(b){b.name==="userStory"&&(b.aliases.unshift("story","stories","us"),b.simpleFields.push("tasks-effort-sum","tasks-effortToDo-sum"));if(b.name==="general"||b.name==="assignable")b.isParentType=!0,b.discriminator={entityType:["id","name"]},b.detectType=h;(b.parent==="general"||b.parent==="assignable")&&b.simpleFields.push("customFields"),b.terms=i(b.name),b.name==="processInfo"&&b.refs&&(b.refs={}),b.name==="context"&&(b.refs||(b.refs={}),b.refs.culture&&delete b.refs.culture,b.refs.selectedProjects={list:!0,name:"project"},b.simpleFields=["id","acid"]),a.register(b)}),a.register({name:"implementationHistory",aliases:["stats"]}),a.register({name:"prioritizer",fields:["id"],refs:[]}),a}),define("tau/core/termProcessor",["Underscore","tau/core/class","tau/store/types.targetprocess"],function(_,a,b){var c=a.extend({init:function(a){a=a||[],this.mapping={};for(var b=0,c=a.length;b<c;b++){var d=a[b];this.mapping[d.name]=this.mapping[d.name.toLowerCase()]=d.value}},resolve:function(a,b){var c=b||a;return a&&this.mapping.hasOwnProperty(a)&&(c=this.mapping[a]),c},getTerms:function(a){var c=this,d=b.findByKeyword(a),e=d.terms,f=_(e).keys(),g={};return _(f).each(function(a){g[a]=c.resolve(e[a].key,e[a].val)}),g}});return c}),define("tau/ui/templateRenderer.extensions",["Underscore","tau/core/class","tau/core/termProcessor"],function(_,a,b){var c=a.extend({init:function(a){this.termProc=new b(a.terms)},terms:function(a){return this.termProc.getTerms(a)},text_implode:function(a){var b=new String(a);if(_.isString(a))b=a;else if(_.isArray(a)){var c=_.clone(a),d=c.pop();b=_.filter([c.join(", "),d],function(a){return a!=0}).join(" &amp; ")}return b},key:function(a,b){}});return c}),define("tau/core/templates-factory",["Underscore","jQuery"],function(_,$){var a={sub:function(a,c){var d=_.isArray(c)?c:[c],e=[];for(var f=0,g=d.length;f<g;f++)e.push(b.get(a).render(null,d[f]));return e.join("")}},b={templates:{},initialized:{},get:function(a){var b=this,c=b.templates[a];if(!c)throw["Template '",a,"' was not registered."].join("");return b[c.engine+".get"](a)},"jquery.get":function(a){var b=this;if(!$.template.hasOwnProperty(a))throw["jQuery template '",a,"' was not found."].join("");return{bind:function(c,d){var e={},f=b.templates[a],g=f.tags||[];for(var h=0;h<g.length;h++){var i=g[h];i.register(c,e)}var j=$.template[a];return $.tmpl(j,d,e)}}},"jqote2.get":function(b){var c=this,d=c.templates[b];if(!d.jqotecmpl)throw["Template '",b,"' was not compiled."].join("");return{render:function(b,c){var e=d.customFunctions||{};return _(e).extend(a),d.jqotecmpl.call(c,0,0,[c],e)},bind:function(a,b){var c=this.render(a,b);return $(c)},bindPure:function(a,b){return this.render(a,b)}}},registerRecursively:function(a,b){var c=this;b=b||{tags:[]};var d=null;if(!$.template.hasOwnProperty(a)){d=this.templates[a];if(!d)throw["Template '",a,"' was not found."].join("");d.tags&&(b.tags=b.tags.concat(d.tags)),$.each(d.dependencies,function(a,d){c.registerRecursively(d,b)}),d.tags=b.tags;var e=d.markup;$.template(a,e)}else d=d||this.templates[a],d.tags&&(b.tags=b.tags.concat(d.tags))},"jquery.register":function(a){var b=this;b.registerRecursively(a.name)},"jqote2.register":function(a){a.jqotecmpl=$.jqotec(a.markup)},register:function(a){var b=this;return a.dependencies=a.dependencies||[],a.markup=_.isArray(a.markup)?a.markup.join(""):a.markup,a.engine=a.engine||"jquery",b.templates[a.name]=a,b[a.engine+".register"](a),{name:a.name,options:a.options||{},get:function(){return b.get(a.name)}}}};return b}),define("tau/ui/templateRenderer",["Underscore","jQuery"],function(_,$){return $.extend($.tmpl.tag,{"@":{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while(!$__t.$tau && $__t.parent){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")},tauKey:{_default:{$1:"id",$2:"null"},open:['_=_.concat(new String(window._.complexKey($2["data"], $1) || "").toString());'].join("")}}),$}),define("tau/core/view-base",["Underscore","jQuery","tau/core/event.emitter","tau/ui/templateRenderer.extensions","tau/core/templates-factory","tau/ui/templateRenderer"],function(_,$,a,b,c){var d=a.extend({name:"view-base",init:function(a){this._super(a),this.config=a||{}},destroy:function(){this._super(),this.element&&this.element.remove(),delete this.element,delete this.config},merge:function(a,b){var c=this;if(b&&c.element){$.isArray(b)||(b=[b]);var d=_(b).isArray()?b:[b],e=this.element;_(d).each(function(b){var c=e.find(b),d=a.find(b);c.each(function(a){$(this).replaceWith(d.eq(a))})})}},bindTemplate:function(a){var b=this.config.template.name,d=c.get(b).bind(this.config,a);return d},prepareElement:function(a){var b=this.config.template.name,c=("tmpl-"+b).replace(/\./g,"-");return a.addClass(c),a.addClass("ui-placeholder"),a},updateElement:function(a,b){var c=this;c.element&&b?c.merge(a,b):(c.element&&(a.length?c.element.replaceWith(a):c.element.remove()),c.element=a)},doRender:function(a,b){var c=this.bindTemplate(a);c=this.prepareElement(c),this.updateElement(c,b),!this.config.visible&&this.hide()},fireAfterInit:function(a){this.fire("afterInit",{config:this.config,refreshSelector:a})},initialize:function(a){var b=this;this.fireAfterInit(a)},setDefaultConfig:function(){var a=this;_.defaults(a.config,{visible:!0})},"bus refreshData":function(a){this.doRender(a.data),this.fire("elementRefreshedWithData",{element:this.element})},"bus refresh":function(a){this._super();var b=a.data||{},c=b.refreshSelector;this.startLifeCycle(a,c)},"bus initialize":function(a){this.startLifeCycle(a)},startLifeCycle:function(a,b){var c=this;c.setDefaultConfig(),_.extend(c.config,a.data),c.fire("beforeInit",{config:c.config}),this.initialize(b)},"bus show":function(){this.show()},"bus hide":function(){},"bus show+afterRender:last":function(a){var b=a.afterRender.data.element},"bus hide+afterRender:last":function(a){var b=a.afterRender.data.element;b.hide(),this.config.visible=!1},showElement:function(){this.element.show()},show:function(){this.showElement(),this.config.visible=!0},hideElement:function(){this.element.hide()},hide:function(){this.hideElement(),this.config.visible=!1},"bus applyTo":function(a){this.element=a.data.element},"bus afterInit+dataBind":function(a){this.render(a.dataBind.data,a.afterInit.data)},render:function(a,b){this.fireBeforeRender({data:a}),this.doRender(a,b.refreshSelector),this.fireAfterRender({data:a})},fireBeforeRender:function(a){a=a||{},this.fire("beforeRender",{data:a.data,view:this,element:this.element})},fireAfterRender:function(a){a=a||{},this.fire("afterRender",{data:a.data,view:this,element:this.element})}});return d}),define("tau/core/event-dispatcher",["Underscore","tau/core/class"],function(_,a){var b=a.extend({init:function(a){this.components=a,this.eventArgsQueue={},this.dictionaryQueue={}},listen:function(a,b){var c=this;c.dictionaryQueue.hasOwnProperty(a)||(c.dictionaryQueue[a]=_(c.components).clone(),c.eventArgsQueue[a]=[]);var d=function(a){var d=a.sender;a.removeListener();var e=_(c.components).indexOf(d);c.eventArgsQueue[a.name][e]=a.data,c.dictionaryQueue[a.name]=_(c.dictionaryQueue[a.name]).without(d);if(_.isEmpty(c.dictionaryQueue[a.name])){var f={eventName:a.name,argsArr:c.eventArgsQueue[a.name]};b(f)}};_(c.components).each(function(b){b.on(a,d,null,{},1e3)})}});return b}),define("tau/ui/templates/container/ui.template.container.list",["tau/core/templates-factory"],function(a){var b={name:"container.list",markup:['<div class="tau-container ${cssClass}"></div>'],dependencies:[]};return a.register(b)}),define("tau/components/extensions/component.extension.base",["Underscore","tau/core/event.emitter"],function(_,a){var b=function(a){return a!=="bus"&&!_.isFunction(this[a])},c=function(a){delete this[a]},d=a.extend({init:function(a){this._super(a),this.config=a},"bus beforeInit":function(a){this.config||console.log("config is null "+this.category),_(this.config).extend((a.data||{}).config),a.data&&a.data.config&&(this.config.store=a.data.config.store||this.config.store)},"bus afterRender":function(a){this.element=a.data.element},createComponents:function(a,b){var c={bus:this.bus,config:a,create:function(){this.bus.on("componentsCreated",this.onComponentCreated,this),this.bus.fire("createComponents",this.config,this)},onComponentCreated:function(a){if(a.caller!==this)return;a.removeListener(),b(a.data)}};c.create()},isEntityInContext:function(a){var b=this.config.context.entity.id,c=b==(a.data.entity||a.data.assignable).id;return c},destroy:function(){delete this.config;var a=_.keys(this);_(a).chain().select(b,this).each(c,this).value(),this._super()}});return d}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.editable",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({category:"edit",editableIndexes:null,init:function(){this._super.apply(this,arguments),this.onRowClickProxy=$.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(a){this.editableIndexes=[],this.createComponentList(a.data),this.attachListeners()},"bus afterRender":function(a){this.$el=a.data.element,this.addEditableBehaviour()},"bus refresh":function(){this.clearComponent()},createComponentList:function(a){this.components=[];for(var b=1;b<a.length;b+=2)this.components.push(a[b].component)},addEditableBehaviour:function(){for(var a=0;a<this.editableIndexes.length;a++)this.doEditableRow(this.editableIndexes[a])},attachListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].on("permissionsReady",this.onPermissionsReady,this,{index:b})},removeListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(a){var b=$(a.target);if(b.is("a")==1||b.parent().is("a")==1)return!0;a.stopPropagation(),a.data.component.fire("edit")},doEditableRow:function(a){var b=this.$el.find(" > tbody > tr").eq(a),c=this.onRowClickProxy;b.unbind("click",c),b.bind("click",{component:this.components[a]},c),b.addClass("ui-additionalinfo_editable_true")},onPermissionsReady:function(a){if(a.data.editable){var b=a.listenerData.index;this.$el?this.doEditableRow(b):this.editableIndexes.push(b)}},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})}),define("tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({category:"edit",editableIndexes:null,init:function(){this._super.apply(this,arguments),this.onRowClickProxy=$.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(a){this.editableIndexes=[],this.createComponentList(a.data),this.attachListeners()},"bus afterRender":function(a){this.$el=a.data.element},"bus refresh":function(){this.clearComponent()},createComponentList:function(a){this.components=[];for(var b=1;b<a.length;b+=2)this.components.push(a[b].component)},attachListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].on("beforeChangeProperty",this.onBeforeChangeProperty,this,{index:b}),a[b].on("propertyChanged",this.onPropertyChanged,this,{index:b,component:a[b]},1)},removeListeners:function(){var a=this.components;if(a)for(var b=0;b<a.length;b++)a[b].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(a){a.stopPropagation(),a.data.component.fire("edit")},onPropertyChanged:function(a){var b=a.listenerData.index,c=a.listenerData.component,d=this;c.on("afterRender",function(a){a.removeListener();var c=d.$el.find(" > tbody > tr").eq(b).find(">td");d.fire("updateElement",{element:c})},c)},markRowAsUpdating:function(a){var b=this.$el.find(" > tbody > tr").eq(a).find(">td");this.fire("markElementToBeUpdated",{element:b})},onBeforeChangeProperty:function(a){var b=a.listenerData.index;this.markRowAsUpdating(b)},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})}),define("tau/components/extensions/component.creator.extension",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){var b=a.extend({getDependencies:function(a){var b=[];return _(a).each(function(a){if(a.path)b.push(a.path);else{if(!a.type)throw"Configuration error: type or path is missing";var c="tau/components/component."+a.type;b.push(c)}}),b},childrenLoadedCallback:function(a,b){var c=this,d=[];_(a).each(function(a){a.name||(a.name="",a.type&&(a.name=a.type),a.id&&(a.name+=":"+a.id));var b=a.component.create(a);c.fire("componentCreated",{component:b}),d.push({config:a,component:b})}),c.fire("componentsCreated",d,b)},createDependenciesLoadedCallback:function(a,b){var c=this,d=a.components,e=a.context;return function(){var a=arguments;_(d).each(function(b,c){b.component=a[c],b.context=e}),c.childrenLoadedCallback(d,b)}},"bus createComponents":function(a){var b=a.data,c=a.caller,d=b.components;d=b.components=_.isArray(d)?d:[d];var e=this.getDependencies(d);require(e,this.createDependenciesLoadedCallback(b,c))}});return b}),define("tau/ui/templates/container/ui.template.container.table",["tau/core/templates-factory"],function(a){var b={name:"container.table",markup:['<table class="${cssClass} container-table">',"   <tr></tr>","</table>"],dependencies:[]};return a.register(b)}),define("tau/views/view.container",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/ui/templates/container/ui.template.container.list","tau/ui/templates/container/ui.template.container.table"],function(_,$,a,b){var c=a.extend({init:function(a){this._loaded=!1,this._super(a)},completeInitializationWithoutChildren:function(){var a=this;a.fire("afterInit"),a._fireChildrenRendered({children:[],childrenEvtArgs:[]})},setDefaultConfig:function(){var a=this;a._super(),_.defaults(a.config,{template:{name:"container."+(a.config.layout||"list")}})},"bus componentCreated":function(a){var b=a.data.component;this.fire("childComponentCreated",b),this.children.push(b)},_fireChildrenRendered:function(a){this.fire("internalChildrenRendered",a)},"bus afterInit+internalChildrenRendered":function(a){var b=this._getRenderConfig();this.fireBeforeRender({data:b}),this.doRender(b);var c=a.internalChildrenRendered.data;_.extend(c,{config:this.config}),this.fire("childrenRendered",c),this.fireAfterRender({data:b})},initializeComponents:function(a){var c=this;c.dispatcher=new b(c.children);var d=["afterInit"],e=function(a){c.fire(a.eventName)};_(d).each(function(a){c.dispatcher.listen(a,e)}),c.dispatcher.listen("afterRender",function(a){var b=a.argsArr,d={children:c.children,childrenEvtArgs:b};c._fireChildrenRendered(d)});var f=_(a.data).pluck("config");_(c.children).each(function(a,b){a.fire("initialize",f[b])})},"bus componentsCreated:last+sendEventToComponents":function(a){var b=a.componentsCreated.data,c=a.sendEventToComponents.data;_.each(b,function(a){a.component.fire(c.name,c.data)})},"bus componentsCreated":function(a){this.fire("beforeComponentsInitialize",a.data),this.initializeComponents(a),this.fire("afterComponentsInitialize",a.data)},lifeCycleCleanUp:function(){this.destroyChildren()},"bus refresh":function(a){this.startLifeCycle()},startLifeCycle:function(a){var b=this;b.setDefaultConfig(),_.extend(b.config,(a||{}).data),b.fire("beforeInit",{config:b.config});var c=b.config.children;b.children=[];var d=_.size(c)>0&&b.config.visible;if(d){var e=b.config.children,f=b.config.context||{};this.fire("createComponents",{components:e,context:f})}else b.completeInitializationWithoutChildren()},"bus initialize":function(a){this.startLifeCycle(a)},hideElement:function(){var a=this.element.parents(".tau-bubble:first").length>0;if(a==0&&this._loaded&&!$.fx.off){this.element.slideUp(200);return}this._super()},showElement:function(){var a=this.element.parents(".tau-bubble:first").length>0;if(a==0&&!$.fx.off){this.element.slideDown(200);return}this._super()},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},_getRenderConfig:function(){var a=this.config;return a.visible&&(this._loaded=!0),a},destroyChildren:function(){var a=null;if(this.children&&this.children.length)while(a=this.children.pop())a.destroy();this.children=null},destroy:function(){this.dispatcher=null,this.destroyChildren(),this._super()}});return c}),define("tau/ui/extensions/layout/ui.extension.layout",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus childrenRendered+afterRender":function(a){var b=this;b.element=a.afterRender.data.element;var c=a.childrenRendered.data.childrenEvtArgs;b.config.layout=b.config.layout||"list";var d=b.config,e=["_add",d.layout,"item"].join(" ");d.childrenContainerSelector=d.childrenContainerSelector||(d.layout==="list"?null:"> tbody > tr"),_.each(c,function(a){var c=a.element;b[e](c,a.view?a.view.config:{})})},"_add list item":function(a){var b=a.jquery?a:a.element,c=this.config.childrenContainerSelector?this.element.find(this.config.childrenContainerSelector):this.element;c.append(b)},getTableItemContainer:function(){var a=this,b=a.config,c=a.element.find(b.childrenContainerSelector+":last");if(b.hasOwnProperty("columnCount")){var d=c.children("td").size();d>=b.columnCount&&(c=$("<tr></tr>"),a.element.children("tbody").append(c))}return c},"_add table item":function(a){var b=this,c=a.jquery?a:a.element,d=b.config,e=this.getTableItemContainer(),f=e.children("td").length,g=d.cellsCssClass&&d.cellsCssClass[f]||"";$("<td></td>").addClass(g).append(c).appendTo(e)},"_add selectable item":function(a,b){var c=a,d=this.element,e=b.selector||"[role=main]",f=d.filter(e);f.length==0&&(f=d.find(e)),f.length==0?(console.log(d),console.error('No element for selector "'+e+'"')):f.eq(0).append(c)}})}),define("tau/ui/extensions/spinner/ui.extension.spinner",["tau/components/extensions/component.extension.base"],function(a){return a.extend({options:{spinnerClass:"ui-spinner"},"bus beforeInit":function(a){var b=this;b.element&&b.element.addClass(b.options.spinnerClass)},"bus afterRender":function(a){var b=this;b.element=a.data.element,b.element.removeClass(b.options.spinnerClass)}})}),define("tau/core/bus.reg",["Underscore","tau/core/event"],function(_,a){var b={buses:{},onCreate:function(a){var b=this;b.buses[a.id]=a,b.fire("create",{bus:a})},onDestroy:function(a){if(a.id==="global")return;delete this.buses[a.id],this.fire("destroy",{bus:a})},logCount:function(){console.log("#count: "+this.count())},count:function(a){var b=_(this.buses).keys();return a&&(b=_(b).without("global")),b.length},stats:function(){var a={},b=this;_.each(_(b.buses).keys(),function(c){var d=b.buses[c];a.hasOwnProperty(d.name)||(a[d.name]=0),a[d.name]++}),_.each(_(a).keys(),function(b){console.log(b+" : "+a[b])})}};return a.implementOn(b),window.tau=window.tau||{},_.extend(window.tau,{buses:b}),b}),define("tau/core/bus",["Underscore","tau/core/class","tau/core/bus.reg","tau/core/event"],function(_,a,b,c){function e(a,b,c){var d=b[1],e=b[0];a.name.match(/(diagnostics)/)&&console.log(a.name,"["+a.id+"]",":",e,d||"")}var d=a.extend({globalBus:null,init:function(a){a=a||{},this.globalBus=a&&a.globalBus?a.globalBus:null,this.name=a&&a.name?a.name:_.uniqueId()+"",_.defaults(a,{id:_.uniqueId("bus_")}),this.id=a.id,b.onCreate(this)},initialize:function(a){this.fire("initialize",a)},destroy:function(){this.fire("destroy"),delete this.globalBus},getGlobalBus:function(){return this.globalBus}});return c.implementOn(d.prototype),d.prototype.fire=function(a,d,e){this.globalBus&&this.globalBus.fire(a,d,this);var f=c.prototype.fire.apply(this,arguments);return a==="destroy"&&(b.onDestroy(this),delete this.globalBus),f},d}),define("tau/core/Class",[],function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,c=function(){},d=0,e=function(a,b){return b};return c.extend=function(c){function j(){!a&&this.init&&(this.__objectId=d++,this.init.apply(this,arguments))}var f=this.prototype;a=!0;var g=new this;a=!1,g.__profiler=g.__profiler||e;for(var h in c){if(h==="__profiler")continue;var i=typeof c[h]=="function"&&typeof f[h]=="function"&&b.test(c[h])?function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);return this._super=c,d}}(h,c[h]):c[h];g[h]=g.__profiler(h,i)}return j.prototype=g,j.constructor=j,j.extend=arguments.callee,j},c}),define("app.path",["jQuery"],function($){var a=null,b=function(a){var b=null,c=window.location,d=c.search,e=c.href,f=d?e.indexOf(d):e.length,g=e.substr(0,f),h=g.split("/");h.pop();var i=$(document).find('script[src*="/require.js"]').attr("src"),j=i.split("/");j.pop();var k=a.split("/");while(".."===j[0])j.shift(),h.pop();if(j.length===0)for(var l=0;l<k.length;l++)h.pop();else if(j.join("/").toLowerCase()!==k.join("/").toLowerCase())throw"Can't determine application root";return b=h.join("/"),b};return{get:function(){return a||(a=b("javascript/tau/scripts"))}}}),Function.prototype.tauCreateDelegate=function(a){var b=this,c=(a.bus||{name:""}).name;return c==="entity component"&&console.log(c),function(){b.apply(a,arguments)}},String.prototype.trim=function(a){return function(){var b=this,c=/^\s+/,d=/\s+$/,e=a?a.call(b):b.toString().replace(c,"").replace(d,"");return e}}(String.prototype.trim),Date.prototype.setISO8601=function(a){var b="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",c=a.match(new RegExp(b)),d=0,e=new Date(c[1],0,1);c[3]&&e.setMonth(c[3]-1),c[5]&&e.setDate(c[5]),c[7]&&e.setHours(c[7]),c[8]&&e.setMinutes(c[8]),c[10]&&e.setSeconds(c[10]),c[12]&&e.setMilliseconds(Number("0."+c[12])*1e3),c[14]&&(d=Number(c[16])*60+Number(c[17]),d*=c[15]=="-"?1:-1),d-=e.getTimezoneOffset(),time=Number(e)+d*60*1e3,this.setTime(Number(time))},Date.prototype.toISO8601String=function(a,b){if(!a)var a=6;if(!b)var b="Z",c=this;else{var d=b.match(/([-+])([0-9]{2}):([0-9]{2})/),e=Number(d[2])*60+Number(d[3]);e*=d[1]=="-"?-1:1;var c=new Date(Number(Number(this)+e*6e4))}var f=function(a){return(a<10?"0":"")+a},g="";g+=c.getUTCFullYear(),a>1&&(g+="-"+f(c.getUTCMonth()+1)),a>2&&(g+="-"+f(c.getUTCDate())),a>3&&(g+="T"+f(c.getUTCHours())+":"+f(c.getUTCMinutes()));if(a>5){var h=Number(c.getUTCSeconds()+"."+(c.getUTCMilliseconds()<100?"0":"")+f(c.getUTCMilliseconds()));g+=":"+f(h)}else a>4&&(g+=":"+f(c.getUTCSeconds()));return a>3&&(g+=b),g},define("tau/extensions/extension.javascript",function(){}),define("tau/core/tau",["tau/extensions/extension.javascript"],function(){var a=a||{};return a.empty=function(){},a.ns=function(a){var b=a.split("."),c=window;for(var d=0,e=b.length;d<e;d++){var f=b[d];typeof c[f]=="undefined"&&(c[f]={}),c=c[f]}},a.getQueryValueFromUrl=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+b+"=([^&#]*)",d=new RegExp(c,"i"),e=d.exec(a);return e==null?"":e[1]},a.getValueFromQueryString=function(b){var c=window.location.href;return a.getQueryValueFromUrl(c,b)},a.extendArgs=function(a,b){var c=a;return c=[].slice.call(a),c.unshift(b),c},a.concat=function(){return String.prototype.concat.apply("",arguments)},a.createScopedCallbackIfRequired=function(b){return typeof b=="function"?b:a.createScopedCallback(b.fn,b.scope)},a.createScopedCallback=function(a,b){return typeof a!="function"&&typeof a.fn=="function"&&(a=a.fn,a.scope&&(b=a.scope)),typeof a=="function"&&b&&(a=a.tauCreateDelegate(b)),a},a.getCallbacks=function(b){b=b||{},b.success||(b.success=a.empty),b.failure||(b.failure=a.empty);var c=a.createScopedCallback(b.success,b.scope),d=a.createScopedCallback(b.failure,b.scope);return{success:c,failure:d}},a}),define("tau/store/store",["Underscore","tau/core/class","tau/core/tau","tau/store/types","tau/store/typesClass"],function(_,a,b,c,d){var e={_processCommand:function(a,b,c,d){d=d||{};var e=this.types[b];e&&(b=e.name);var f={type:b,name:a,config:c,callbacks:d};return this.commands.push(f),this}},f=function(){var a=this;if(_.isEmpty(a._frozenPromises)){var b=[].concat(a._frozenCommandsQueue);a._frozenCommandsQueue=[],a.config.proxy.execute(b)}};return a.extend({init:function(a){var f=this;f.id=_.uniqueId("store_"),f._frozenCommandsQueue=[],f._frozenPromises={},f.config=a,f.eventEmitter=f.config.eventEmitter||{fire:function(){},on:function(){},removeAllListeners:function(){}};var g=a.types||a.proxy.types;if(g){var h=new d;_(g).each(function(a){h.register(a)}),e.types=h.getDictionary()}else e.types=c.getDictionary();var i=_.functionsExt(a.proxy);_.each(i,function(a){var c=a.split("api ");if(c.length!==2)return;var d=c[1];e[d]=function(){var a=b.extendArgs(arguments,d);return this._processCommand.apply(this,a)}}),f._extendWithCommonAPI(f,f)},_extendWithCommonAPI:function(a,b){_.each(_.functionsExt(e),function(c){if(c[0]=="_")return;a[c]=function(){var d=_.extend({},e);return d.commands=a.commands||[],d[c].apply(d,arguments),d.done=function(a){b._done(d.commands,a)},d}})},freeze:function(){var a=this,c=_.uniqueId(),d={id:c,unfreeze:function(){this.unfreeze=b.empty,delete a._frozenPromises[c],f.call(a)}};return a._frozenPromises[d.id]=d,d},register:function(a,b){this.config.proxy.registerData(a,b)},on:function(a,b){return this.config.proxy.on(a,b),this.eventEmitter.fire("afterStoreOn",a),this},unbind:function(a){return this.config.proxy.unbind(a),this.eventEmitter.fire("afterStoreUnbind",a),this},_processChain:function(a,c){c=b.getCallbacks(c);var d=[].concat(a);_.each(a,function(e){var f=b.getCallbacks(e.callbacks),g=function(b,g){d[_.indexOf(d,e)]=b;var h=_.select(a,function(a){return a.executed!==!0});f[g](b);if(h.length===0){var i=_.select(a,function(a){return a.failed===!0});c[i.length>0?"failure":"success"](d)}};e.callbacks={success:function(a){g(a,"success")},failure:function(a){g(a,"failure")}}})},done:function(a){b.getCallbacks(a).success([])},evictProperties:function(a,b,c){this.config.proxy.evictProperties(a,b,c)},evictData:function(){this.config.proxy.evictData()},isPropertyInitialized:function(a,b,c){return this.config.proxy.isPropertyInitialized(a,b,c)},_done:function(a,b){var c=this;c._processChain(a,b),_.isEmpty(c._frozenPromises)?c.config.proxy.execute(a):c._frozenCommandsQueue=[].concat(c._frozenCommandsQueue,a)}})}),define("tau/store/header",["Underscore","tau/core/tau"],function(_,tau){var tauExtension=_.extend(tau,{ref:function(a,b){var c={};return c[a]=b,c},list:function(a,b){var c=tau.ref(a,b);return c.list=!0,c},getNextPage:function(a,b,c){c=c||[];var d={holder:a,url:b,fields:c};return a.getNextPage=function(){return d},d},parseFieldsFromString:function(value){var self=this;value=value.replace(/([\w-]+)\[+/ig,'{"$1":['),value=value.replace(/(\])/ig,"]}"),value=value.substr(0,value.length-1),value=value.replace(/([\w-]+)(,|\])/ig,"'$1'$2");var fields=eval("(function () { return "+value+";})();"),toLowerCase=function(a){var b=a.split("-");if(b.length>1){var c=[];return _.each(b,function(a){c.push(toLowerCase(a))}),c.join("-")}return a.charAt(0).toLowerCase()+a.substr(1)},formatFields=function(a){var b=[];return _.each(a,function(a){if(self.header.isSimple(a)){b.push(toLowerCase(a));return}var c={},d=self.header.getFieldName(a);c[toLowerCase(d)]=formatFields(a[d]),b.push(c)}),b};return formatFields(fields)},formatObject:function(a,b){var c=this,d={data:[],nextPages:[]};if(_.isUndefined(a)||_.isNull(a))return d.data=null,d;if(typeof a!="object")return d.data=a,d;b=b?b:"Lower";var e=function(a){return a.charAt(0)["to"+b+"Case"]()+a.substr(1)};if(a&&(a.hasOwnProperty("Items")||a.hasOwnProperty("items"))){var f=a.next||a.Next;f&&d.nextPages.push(c.getNextPage(d.data,f,[])),a=a.Items||a.items}if(_.isArray(a))return _.each(a,function(a){var e=c.formatObject(a,b);d.nextPages=d.nextPages.concat(e.nextPages||[]),d.data.push(e.data)}),d;var g={};return _.each(_.keys(a),function(f){var h=e(f),i=h.split("-");if(i.length>1){var j=[];_.each(i,function(a){j.push(e(a))}),h=j.join("-")}var k=c.formatObject(a[f],b);d.nextPages=d.nextPages.concat(k.nextPages||[]),g[h]=k.data}),d.data=g,d},header:{getFieldName:function(a){return _.getFieldName(a)},isSimple:function(a){return _.isString(a)},isList:function(a){return a.list===!0}}});return tauExtension}),define("tau/core/comparer",["Underscore"],function(_){return{isEqualIncluded:function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;if(_.isDate(a)&&_.isDate(b))return a.getTime()===b.getTime();if(_.isNaN(a)&&_.isNaN(b))return!1;if(_.isRegExp(a)&&_.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(_.isArray(a)&&_.isArray(b)&&a.length!==b.length)return!1;var e=_.keys(b);for(var f=0;f<e.length;f++){var g=e[f];if(a.hasOwnProperty(g)&&!this.isEqualIncluded(a[g],b[g]))return!1}return!0},compare:function(a,b){var c=this,d={changes:{}};return a?(_.each(_(b).keys(),function(e){var f={value:b[e]};if(!a.hasOwnProperty(e)){d.changes[e]=f;return}c.isEqualIncluded(a[e],b[e])||(d.changes[e]=f)}),d):d}}}),define("tau/store/db",["Underscore","tau/core/class","tau/store/header","tau/core/comparer"],function(_,a,b,c){return a.extend({init:function(a){this.__data={},this.__types=a.types||{}},_getTypeHolder:function(a,b){var c=a[b]||{};return a.hasOwnProperty(b)||(a[b]=c),c},_getTypeDictionary:function(a){return this._getTypeHolder(this.__data,a)},getPersistedNode:function(a,b){var c=this,d=c.__data[b];if(!d)return null;if(!a)return d;var e=d[a];return e?e:null},_getRefsArray:function(a){return!a||!a.refs?[]:(a.hasOwnProperty("refsArray")||(a.refsArray=_(a.refs).keys()),a.refsArray)},_registerReference:function(a,b,d,e,f){var g=this,h=d.refs[b];if(_.isUndefined(a)||a===null||a.id===null)return h.list?[]:null;a.__type=h.name;var i=g.__types[h.name],j=g._register(a,function(a){if(!i.refs)return;var b=h.relationProperty;if(!b)return;var d=i.refs[b];if(!d)return;var j=a.data.hasOwnProperty(b),k=a.data[b],l=d.list,m=g._getReferenceObject(e.id,e.__type),n=function(b){var c={};c[h.relationProperty]=b,f.diffs.push({id:a.id,type:g._getOriginType(a),changes:c})};if(l&&!j)return;l?_(k).any(function(a){return a.id===e.id})?m=k:(m=k.concat([m]),n(m)):c.isEqualIncluded(m,k)||n(m),a.data[b]=m});_.mergeArrayObjects(f,j,["diffs"]);var k={isReference:!0,type:h.name,list:!0};return h.list?_.extend(j.refs,k):j.refs[0]},_removeCascadeObjects:function(a,b){var c=this,d=c._getRegisterTemplate();return _.each(c._getRefsArray(a),function(e){var f=a.refs[e];f.cascade&&(f.list?_.each(b[e],function(a){c._extendRegister(d,c.remove(a.id,a.type))}):c._extendRegister(d,c.remove(b[e].id,b[e].type)))}),d},_getOriginType:function(a){var b=a.__type;return a.origin&&(b=a.origin.type),b},_removeRefFromObj:function(a,b,c,d,e){var f=this,g=a.data;if(!g.hasOwnProperty(b))return;var h=g[b];if(!h)return;var i=d.refs[b];if(!i.relationProperty)return;var j=f.__types[i.name];_.isArray(h)||(h=[h]);for(var k=0,l=h.length;k<l;k++){var m=h[k];if(e&&e!==m.id)continue;var n=f.getPersistedNode(m.id,m.type);if(!n)return;if(!n.data.hasOwnProperty(i.relationProperty))return;c.nodes.push(n);var o={};o[i.relationProperty]=null,j.refs&&j.refs[i.relationProperty]&&j.refs[i.relationProperty].list?(n.data[i.relationProperty]=_(n.data[i.relationProperty]).select(function(b){return b.id!=a.id}),o[i.relationProperty]=n.data[i.relationProperty]):n.data[i.relationProperty]=null,c.diffs.push({id:n.id,type:f._getOriginType(n),changes:o})}},_removeObjectFromRefs:function(a,b){var c=this,d=c._getRegisterTemplate();return _(c._getRefsArray(a)).each(function(e){c._removeRefFromObj(b,e,d,a)}),d},removeProperties:function(a,b,c){var d=this,e=d.getPersistedNode(a,b);if(!e)return;var f=e.data;_(c).each(function(a){delete f[a]})},removeFromList:function(a,c,d){var e=this,f=e._getRegisterTemplate(),g=e.getPersistedNode(a,c);if(!g)return f;var h=e.__types[c],i=b.header.getFieldName(d),j=g.data[i];if(!j)return f;var k=[],l=d[i].id;_.each(j,function(a){a.id!=l?k.push({id:a.id}):e._removeRefFromObj(g,i,f,h,l)});var m={id:a,__type:c};m[i]=k;var n=e.register(m);return e._extendRegister(n,f),n},remove:function(a,b){var c=this,d=c._getRegisterTemplate(),e=c.getPersistedNode(a,b);if(!e)return d;var f=c.__types[b],g=e.data;return d.deletedData.push(_(g).defaults({id:a,type:b})),delete c.__data[b][a],c._extendRegister(d,c._removeCascadeObjects(f,g)),c._extendRegister(d,c._removeObjectFromRefs(f,e)),d},isPropertyInitialized:function(a,b,c){var d=this.getPersistedNode(a,b);return d?d.data?d.data.hasOwnProperty(c):!1:!1},_getReferenceObject:function(a,b){return{isReference:!0,id:a,type:b}},_attachReference:function(a,b,c){var d=this._getReferenceObject(b,c);return a.push(d),d},_getParentTypeNames:function(a){var b=this;if(!a.__parents){a.__parents=[];var c=a.parent;while(c){a.__parents.push(c);var d=b.__types[c];if(!d)break;c=d.parent}}return a.__parents},_registerParentNodes:function(a,b,c){var d=this,e=d.__types[a],f={data:c.data,id:b,origin:{id:b,type:a}},g=d._getParentTypeNames(e);for(var h=0;h<g.length;h++){var i=g[h],j=d._getTypeDictionary(i);j[b]=j[b]||{},_.extend(j[b],f)}},_getRegisterTemplate:function(){return{refs:[],nodes:[],diffs:[],tree:{},deletedData:[]}},_registerObjectInTree:function(a,b){var c=this,d=c._getTypeHolder(a,b.type);if(!d.hasOwnProperty(b.id)){var e={},f=c.__types[b.type],g={id:b.id,changes:e},h=c._getParentTypeNames(f);for(var i=0;i<h.length;i++){var j=c.__types[h[i]],k=c._getTypeHolder(a,j.name);k[b.id]=g}d[b.id]=g}_.extend(d[b.id].changes,b.changes)},_extendTree:function(a,b){var c=this;_.each(b,function(b){c._registerObjectInTree(a,b)})},_extendRegister:function(a,b){this._extendTree(a.tree,b.diffs),_.mergeArrayObjects(a,b,["diffs","deleteData"])},register:function(a,b,c){return this._register(a,b,c)},isTypeDetectionRequired:function(a){var b=this.__types[a];return b.isParentType},getTypeDetectionForNode:function(a,b){if(!this.isTypeDetectionRequired(b))return{required:!1};var c=this.getPersistedNode(a,b),d={required:!0};return c?c.origin?!c.origin.id||!c.origin.type?d:{required:!1,type:c.origin.type}:d:d},_getTypeDefinitionForRegistration:function(a,b,c){var d=this,e=d.__types[b];e||(e=d.__types[b.toLowerCase()]);if(e.isParentType){var f=d.getTypeDetectionForNode(a,e.name);b=f.required?e.detectType(c):f.type,e=d.__types[b]}return e},_register:function(a,b,c){var d=this;c=c||"__type";var e=d._getRegisterTemplate();if(_.isEmpty(a))return e;_.isArray(a)||(a=_.isArray(a.items)?a.items:[a]);var f=a[c];for(var g=0,h=a.length;g<h;g++){var i=a[g];i.hasOwnProperty(c)||(i[c]=f),d._registerObject(i,e,b,c)}return e},_registerObject:function(a,b,d,e){var f=this,g=a[e],h=a.id;if(!g||!h)throw new Error("properties __type and id are required for data registration");var i=f._getTypeDefinitionForRegistration(h,g,a),j={id:h,type:i.name,changes:{}},k=f._getTypeDictionary(i.name),l=k[h];l||(k[h]=l={__type:i.name,data:{id:h},id:h},f._registerParentNodes(i.name,h,l,k));var m=l.data,n=i.refs,o=f._getRegisterTemplate();for(var p in a){if(p==="__type"||p==="id")continue;var q=a[p],r=m[p];n.hasOwnProperty(p)&&(q=f._registerReference(q,p,i,l,o)),l.data[p]=q,c.isEqualIncluded(r,q)||(j.changes[p]=q)}f._extendRegister(b,o),l.data.hasOwnProperty("__type")&&delete l.data.__type,b.nodes.push(l),f._extendTree(b.tree,[j]),b.diffs.push(j),f._attachReference(b.refs,h,i.name),d&&d(l)},get:function(a,b,c){var d=this;if(!a){var e={data:[],notInitializedFields:[],all:!0};return _.each(_(this._getTypeDictionary(b)).keys(),function(a){var f=d._get(a,b,c);e.data.push(f.data),d.mergeFields(e.notInitializedFields,f.notInitializedFields)}),e}return this._get(a,b,c)},_get:function(a,c,d){var e=this;d=d||{};var f=e.getPersistedNode(a,c),g=e.__types[c]||{},h=g.refs||{},i=d.$fields||d.fields||[],j={data:null,type:g,notInitializedFields:i};if(!f)return j;var k={},l=[],m=function(a,b,c){var d=e._get(a.id,a.type,{fields:b||[]});return d.notInitializedFields.length&&c.push(d.notInitializedFields),d.data},n=f.data;return _.each(i,function(a){var c=b.header.getFieldName(a),d=n[c];if(_.isUndefined(d)){l.push(a);return}k[c]=d;if(h.hasOwnProperty(c)&&d){var f=[];if(_.isArray(d)){var g=d;d=[],_.each(g,function(b){d.push(m(b,a[c],f))})}else d=m(d,a[c],f);if(f.length>0){var i={};i[c]=[],_(f).each(function(a){e.mergeFields(i[c],a)}),i[c].length>0&&l.push(i)}}k[c]=d}),f.origin&&(c=f.origin.type),{type:g,data:_(k).defaults({id:a,__type:c}),notInitializedFields:l}},mergeFields:function(a,b,c){return _.mergeFields(a,b,c)},destroy:function(){delete this.__data,delete this.__types}})}),define("tau/store/repository",["Underscore","tau/core/class","tau/core/event","tau/core/tau","tau/store/header","tau/core/comparer","tau/store/types","tau/store/db"],function(_,a,b,c,d,e,f,g){var h=a.extend({init:function(a){if(!a.service)throw"rest service should be defined";this.__listenerObjects={objects:[],holders:[]},this.__subscriptions={},this.types=a.types||f.getDictionary(),this._initDb(),this.service=a.service},_initDb:function(){this.__allTypeLoadMarkers={},this.db=new g({types:this.types})},mergeCommands:function(a){var b={},d=this;return _.each(a,function(a){a=_.defaults(a,{name:"get",config:{},callbacks:{}}),a.callbacks=c.getCallbacks(a.callbacks),d._processFieldsConfig(a,a.name==="get"?null:"_getEmptyArray");var e=[a.type,a.config.id||"_",a.name,a.config.nested===!0?_.uniqueId():""].join("_");if(!b.hasOwnProperty(e))b[e]=a,a.commands=[];else{var f=b[e];d.db.mergeFields(f.config.fields,a.config.fields),f.commands.push(a)}}),b},execute:function(a){var b=this;_.isArray(a)||(a=[a]);var c=b.mergeCommands(a);_.each(_.values(c),function(a){if(a.executed===!0)throw"command is already executed. the same command can not be used twice";b["api "+a.name](a)})},_registerListener:function(a,b,d){var e=a||{},f=b.eventName;e.hasOwnProperty(f)||(e[f]={});var g=_.uniqueId(f),h={id:g,config:b,callback:c.createScopedCallbackIfRequired(d)},i=e[f],j=b.listener;if(j){if(!j.__getRepositorySubscriberId){var k=_.uniqueId("repository_");j.__getRepositorySubscriberId=function(){return k},this.__listenerObjects[k]={listener:j,holders:[]}}var l={id:g,holder:i};this.__listenerObjects[j.__getRepositorySubscriberId()].holders.push(l)}return i[g]=h,h},unbind:function(a){if(!a.__getRepositorySubscriberId)return;var b=this,c=a.__getRepositorySubscriberId(),d=b.__listenerObjects[c];if(!d)return;var e=d.holders;if(!e)return;_(e).each(function(a){var b=a.holder[a.id];b.callback=function(){},delete a.holder[a.id]}),delete a.__getRepositorySubscriberId,delete b.__listenerObjects[c]},_getListeners:function(a){var b=this,c=b._getSubscriptions(a.type);if(!c)return[];var d=c[a.eventName];if(!d)return[];var f=[];return _.each(_(d).values(),function(c){var d=c.config.filter,g=c.config.hasChanges||[];if(d){var h=b.db.getPersistedNode(a.obj.id,a.obj.type),i=a.obj;h&&h.data?i=h.data:a.nodeEvent.changes&&!_.isEmpty(a.nodeEvent.changes)&&(i=a.nodeEvent.changes);var j=e.compare(i,d);if(_(j.changes).keys().length>0)return}if(a.nodeEvent&&g.length>0){var k=a.nodeEvent.changes||{},l=_(g).all(function(a){var b=a.split("|"),c=!1;return b.length>1?c=0<_(k).chain().keys().intersection(b).size().value():c=k.hasOwnProperty(a),c});if(!l)return}f.push(c)}),f},on:function(a,b){var c=this,d=a.type?c.types[a.type].name:"_all_",e=c._getSubscriptions(d);return c._registerListener(e,a,b)},_getSubscriptions:function(a){return this.__subscriptions.hasOwnProperty(a)||(this.__subscriptions[a]={}),this.__subscriptions[a]},_autoAppend:function(a,b,c){_.each(b,function(b){_.any(a,function(a){return d.header.getFieldName(a)===d.header.getFieldName(b)})||a[c?c:"unshift"](b)})},registerData:function(a,b){this.db.register(a,null,b)},_getEmptyArray:function(){return[]},_getDefaultFields:function(a){var b=this.types[a.type];return _.clone(b?b.fields||[]:[])},_processFieldsConfig:function(a,b){var c=this;b=b||"_getDefaultFields";if(!a.config.fields||a.config.fields.length===0)a.config.fields=c[b](a);var d=a.config.fields;c._autoAppend(d,["id"]);for(var e=d.length;e>0;e--){var f=d[e-1];if(_.isSimple(f))continue;var g=_.getFieldName(f),h=a.type?c.types[a.type]:null,i=null,j=[];if(h&&h.refs&&h.refs[g]){var k=h.refs[g];k.list===!0&&(f.list=!0),j=k.fields,i=k.name}var l={type:i,config:{fields:f[g]||j}};f[g]=c._processFieldsConfig(l,b)}var m=d.length;for(e=0;e<m;e++){var n=_.getFieldName(d[e]);for(var o=e+1;o<m;o++)_.getFieldName(d[o])===n&&(_.isSimple(d[e])||_.mergeFields(d[e][n],d[o][n]),d.splice(o,1),m--,o--)}return d},_invokeCommandCallback:function(a,b,c,d){var e=this;e._invokeCommandCallbackR(a,b,c,d);if(c.config.silent===!0)return;if(!e.__subscriptions._all_||_.isEmpty(e.__subscriptions._all_))return;var f=_.values(e.__subscriptions._all_[a]||[]),g={name:a,data:{cmd:c,data:d}};_(f).each(function(a){a.callback(g)})},_invokeCommandCallbackR:function(a,b,c,d){var e=this;c.executed=!0,b[a]({command:c,data:d}),c.hasOwnProperty("commands")&&_.each(c.commands,function(b){b.executed=!0,b.failed=c.failed,e._invokeCommandCallbackR(a,b.callbacks,b,d)})},"api removeFromList":function(a){var b=this,c=a.callbacks;a.config.$set=a.config.$set||{},a.callbacks={success:function(d){var e=_.extend(_.extend({},a.config.$set),d),f=b.db.removeFromList(a.config.id,a.type,a.config.$set);b._invokeCommandCallback("success",c,a,{}),b._notifyAboutNewsAndChanges(f,a)},failure:function(d){a.failed=!0,b._invokeCommandCallback("failure",c,a,d)}},b._populateBeforeSaveEvent(a),b._processFieldsConfig(a,"_getEmptyArray"),b.service.removeFromList(a)},"api remove":function(a){var b=this,c=a.callbacks;a.callbacks={success:function(d){var e=b.evictPersistedObject(a.config.id,a.type);b._populateAfterRemoveEvent(a,e),b._invokeCommandCallback("success",c,a,a.callbacks)},failure:function(d){a.failed=!0,b._invokeCommandCallback("failure",c,a,d)}},b._populateBeforeRemoveEvent(a),b.service.remove(a)},evictPersistedObject:function(a,b){return this.db.remove(a,this.types[b].name)},evictProperties:function(a,b,c){this.db.removeProperties(a,this.types[b].name,c)},evictData:function(){this._initDb()},isPropertyInitialized:function(a,b,c){return this.db.isPropertyInitialized(a,b,c)},"api save":function(a){var b=this,c=a.callbacks;a.config.$set=a.config.$set||{},a.callbacks={success:function(d){_.extend(d,{__type:a.type});var e=_.extend(_.extend({},a.config.$set),d),f=b.db.register(e);b._notifyAboutNewsAndChanges(f,a),b._invokeCommandCallback("success",c,a,e)},failure:function(d){a.failed=!0,b._invokeCommandCallback("failure",c,a,d)}},b._populateBeforeSaveEvent(a),b._processFieldsConfig(a,"_getEmptyArray"),b.service.save(a)},_notifyAboutNewsAndChanges:function(a,b){var c=this;_.each(_.keys(a.tree),function(d){_.each(_(a.tree[d]).values(),function(a){c._populateEvent(b,"afterSave",a,{id:a.id,type:d})})})},_populateEvent:function(a,b,c,d){var e=_.uniqueId("repositoryEvent"),f=this._getListeners({type:d.type,eventName:b,nodeEvent:c,obj:d});if(f.length!==0){var g={id:e,name:b,data:{id:d.id,type:d.type,cmd:a,obj:d,changes:c.changes}};_(f).each(function(a){a.callback(g)})}},_populateBeforeRemoveEvent:function(a){this._populateEvent(a,"beforeRemove",{},{id:a.config.id,type:a.type})},_populateAfterRemoveEvent:function(a,b){var c=this;_.each(b.deletedData,function(b){c._populateEvent(a,"afterRemove",{},b)}),c._notifyAboutNewsAndChanges(b,a)},_populateBeforeSaveEvent:function(a){this._populateEvent(a,"beforeSave",{changes:a.config.$set||{}},{id:a.config.id,type:a.type})},markRecordSetAsCompleteLoaded:function(a){this.__allTypeLoadMarkers[a]=!0},isTypeMarkedAsCompleteLoaded:function(a){return this.__allTypeLoadMarkers[a]===!0},_appendDiscriminator:function(a,b){var c=this;a.isParentType&&_.indexOf(b,"id")>=0&&c._autoAppend(b,[a.discriminator],"push"),_.each(b,function(b){if(d.header.isSimple(b))return;var e=d.header.getFieldName(b),f=a.refs[e];f&&c._appendDiscriminator(c.types[f.name],b[e])})},_processCommandForGet:function(a){var b=this,c=b.db.get(a.config.id,a.type,a.config),d=a.config.fields;if(c.notInitializedFields.length===0)if(!c.all||!!b.isTypeMarkedAsCompleteLoaded(a.type))return a.config.fields=d,b._invokeCommandCallback("success",a.callbacks,a,c.data),{isInvoked:!0};var e=c.notInitializedFields;return c.all&&!b.isTypeMarkedAsCompleteLoaded(a.type)&&(e=_.clone(d)),{isInvoked:!1,fields:e}},_runReadCommand:function(a,b,c,d){var e=this;e._appendDiscriminator(e.types[a.type],c),_.extend(a.config,{fields:c}),e._processFieldsConfig(a);var f=a.callbacks;a.callbacks={success:function(c){a.config.fields=b,_.defaults(c,{__type:a.type});var g=e.db.register(c),h=d(c,g);e._invokeCommandCallback("success",f,a,h),a.callbacks=f},failure:function(c){a.config.fields=b,a.failed=!0,e._invokeCommandCallback("failure",f,a,c),a.callbacks=f}},this.service[a.name](a)},"api refresh":function(a){var b=this,c=a.config.fields,d=function(d,e){return b._notifyAboutNewsAndChanges(e,a),b.db.get(a.config.id,a.type,{fields:c}).data};this._runReadCommand(a,c,_.clone(c),d)},"api turboGet":function(a){var b=this,c=a.config.fields||[];b._autoAppend(c,["id"]);var d=a.callbacks;a.callbacks={success:function(c){_.defaults(c,{__type:a.type}),b._invokeCommandCallback("success",d,a,c),a.callbacks=d},failure:function(c){a.failed=!0,b._invokeCommandCallback("failure",d,a,c),a.callbacks=d}},this.service[a.name](a)},"api find":function(a){var b=this,c=a.config.fields,d=function(d){var e=[];_.each(d,function(d){e.push(b.db.get(d.id,a.type,{fields:c}).data)});if(d.hasOwnProperty("getNextPage")){e.isNextPageAvailable=function(){return!0};var f=_.clone(a);f.config=_.clone(f.config),f.config.$skip=f.config.$skip+f.config.$limit,e.getNextPageCommand=function(){return f}}else e.isNextPageAvailable=function(){return!1};return e};this._runReadCommand(a,c,_.clone(c),d)},"api get":function(a){var b=this,c=a.config.fields,d=b._processCommandForGet(a);if(d.isInvoked)return;var e=function(d){return a.config.id||b.markRecordSetAsCompleteLoaded(a.type),b.db.get(a.config.id,a.type,{fields:c}).data};this._runReadCommand(a,c,d.fields,e)}});return h}),define("tau/store/services/formatProperties",[],function(){return{customFields:{}}}),define("tau/store/services/service.arrayToJsonConverter",["Underscore","tau/store/header","tau/store/services/formatProperties"],function(_,a,b){return{convertArray:function(b,c){var d=this,e=[],f=[];return c.next&&f.push(a.getNextPage(e,c.next,b.header)),c=c.items?c.items:c,_.each(c,function(a){var c=d.convert(b,a);e.push(c.data),f=f.concat(c.nextPages)}),{data:e,nextPages:f}},convert:function(c,d){var e={},f=this,g=[];for(var h=0,i=c.header.length;h<i;h++){var j=d[h];_.isUndefined(j)&&(j=null);var k=c.header[h];if(a.header.isSimple(k)){b.hasOwnProperty(k)&&(j=a.formatObject(j).data),e[k]=j;continue}var l=a.header.getFieldName(k),m=k.list===!0;!_.isNull(j)&&(j.hasOwnProperty("items")||j.hasOwnProperty("Items"))&&(m=!0);if(_.isEmpty(j)&&!m){e[l]=null;continue}if(!_.isNull(j)){var n={header:k[l]},o=j;if(j.hasOwnProperty("items")||j.hasOwnProperty("Items"))j=j.items||j.Items;if(m){var p=[];_.each(j,function(a){var b=f.convert(n,a);g=g.concat(b.nextPages),p.push(b.data)}),j=p,o.next&&g.push(a.getNextPage(p,o.next,n.header))}else{var q=f.convert(n,j);g=g.concat(q.nextPages),j=q.data}}_.isNull(j)&&m&&(j=[]),e.hasOwnProperty(l)?_.extend(e[l],j):e[l]=j}return{data:e,nextPages:g}}}});var JSON;JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("libs/json2",function(){}),define("tau/store/services/service.rest",["Underscore","jQuery","tau/core/Class","tau/store/types","tau/store/services/service.arrayToJsonConverter","tau/store/header","tau/core/tau","libs/json2"],function(_,$,a,b,c,d,e){var f=a.extend({init:function(a){a=a||{},_.defaults(a,{api:$,types:b.getDictionary()}),this.config=a},removeFromList:function(a){var b=this,c=d.header.getFieldName(a.config.$set),e={url:b.getUrl(a)+"/"+c+"/"+a.config.$set[c].id,contentType:"application/json; charset=utf-8",type:"DELETE",processData:!1,dataType:"json"},f=this.getErrorCallback(a);b.config.api.ajax(e).success(function(){a.callbacks.success({id:a.config.id})}).error(f)},remove:function(a){var b=this,c={Id:a.config.id},d={url:b.getUrl(a),contentType:"application/json; charset=utf-8",type:"DELETE",processData:!1,data:JSON.stringify(c),dataType:"json"},e=this.getErrorCallback(a);b.config.api.ajax(d).success(function(){a.callbacks.success({id:a.config.id})}).error(e)},save:function(a){var b={$set:a.config.$set||{}};if(a.type==="prioritizer"){_.extend(b,{$include:this._formIncludes(a.config.fields)}),this.executeCrudCommandViaPageService(a,b,"save");return}this.executeCrudCommand(a,b,"save")},getErrorCallback:function(a){var b=this.config.appPath,c=function(c){if(c.status===401){document.location.href=b+"/login.aspx?ReturnUrl="+document.location.href;return}try{c.response=$.parseJSON(c.responseText)}catch(d){}finally{a.callbacks.failure(c)}};return c},executeCrudCommandViaPageService:function(a,b,c){var e=this,f={id:a.config.id,type:a.type};_.extend(f,b);var g=JSON.stringify({json:JSON.stringify(f)}),h={url:[e.config.appPath,"PageServices/RESTCrud.asmx",c].join("/"),contentType:"application/json; charset=utf-8",type:"POST",data:g,dataType:"json"},i=this.getErrorCallback(a);e.config.api.ajax(h).success(function(b){var c={id:b.d.id};if(b.d.isError===!0){a.callbacks.failure({Message:b.d.errorMessage,CRUD:!0});return}if(b.d.jsonToReturn&&b.d.jsonToReturn.length>0){var e=$.parseJSON(b.d.jsonToReturn);e=d.formatObject(e),_.extend(c,e.data)}a.callbacks.success(c)}).error(i)},executeCrudCommand:function(a,b){var c=this;_.defaults(a.config,{format:"json"});var d={id:a.config.id};_.extend(d,b.$set);var e=c.getUrl(a,"resultInclude"),f=a.config.format,g=c._getFields(a),h=c._getApiConfig(e,f,"convert",g);_.extend(h,{url:e,contentType:"application/json; charset=utf-8",type:"POST",processData:!1,data:JSON.stringify(d),dataType:"json"}),c._executeApiCall(a,"json",h)},find:function(a){this.get(a)},refresh:function(a){this.get(a)},getCompleteCallback:function(a){var b=this,c=function(c){if(a.type==="context"||a.type==="implementationHistory")c.id=a.config.id;if(a.config.nested===!0){var e=b._getNestedObject(a),f=d.header.getFieldName(e),g={id:a.config.id};g[f]=c,c=g}a.callbacks.success(c)};return c},_getArrayConverter:function(a,b){var d=this;return function(e){var f=d.config.api.parseJSON(e);return c[a]({header:b},f)}},_getJsonConverter:function(){var a=this;return function(b){var c=a.config.api.parseJSON(b);return d.formatObject(c)}},_getApiConfig:function(a,b,c,d){var e=this;return{url:a,accepts:{array:"application/x-array"},dataType:b,converters:{"text array":e._getArrayConverter(c,d),"text json":e._getJsonConverter()}}},_getNextPageFields:function(a){var b=a.fields,c=e.getQueryValueFromUrl(a.url,"include");return c&&c.length>0&&(b=d.parseFieldsFromString(c)),b},_executeApiCall:function(a,b,c){var d=this,e=d.getErrorCallback(a),f=d.getCompleteCallback(a),g=null,h=[],i=function(){var a=h.length===0;return a&&f(g),a},j=function(a){for(var b=0,c=a.nextPages.length;b<c;b++){var d=a.nextPages[b];k(d)}},k=function(a){var c=d._getNextPageFields(a),f=d._getApiConfig(a.url,b,"convertArray",c);d.config.api.ajax(f).success(function(b){h=h.concat(b.nextPages||[]);var c=a.holder;_.each(b.data,function(a){c.push(a)}),b.data.getNextPage&&(b.data.getNextPage().holder=a.holder),j(b);var d=_.indexOf(h,a);h.splice(d,1),i()}).error(e)},l=function(b){g=b.data;if(a.name==="find"){f(g);return}h=h.concat(b.nextPages||[]),i(),j(b)};d.config.api.ajax(c).success(l).error(e)},get:function(a){var b=this;_.defaults(a.config,{format:"array"});var c=a.config.nested===!0||!a.config.id?"convertArray":"convert",d=b.getUrl(a),e=a.config.format,f=b._getFields(a),g=b._getApiConfig(d,e,c,f);b._executeApiCall(a,e,g)},turboGet:function(a){this.get(a)},_formIncludes:function(a){var b=[],c=this;return _.each(a,function(a){if(d.header.isSimple(a)){var e=a;a.indexOf("$ref")===0&&(e=a.replace("$ref:","")),b.push(e);return}var f=d.header.getFieldName(a);b.push(f+c._formIncludes(a[f]))}),["[",b.join(","),"]"].join("")},_getQueryOperators:function(){var a=function(a,b){var c=this,d=[];return _.isArray(b)||(b=[b]),_.each(b,function(b){d.push("("+a+" "+c.name+" "+JSON.stringify(b)+")")}),d},b=function(a){return["("+a+" "+this.name+")"]},c=function(a,b){var c=this,d=[];_.isArray(b)||(b=[b]);var e=[];return _(b).each(function(a){e.push(JSON.stringify(a))}),d.push("("+a+" "+c.name+" ("+e.join(",")+"))"),d};return{$in:{name:"in",render:c},$ne:{name:"ne",render:a},$gt:{name:"gt",render:a},$gte:{name:"gte",render:a},$lt:{name:"lt",render:a},$lte:{name:"lte",render:a},$contains:{name:"contains",render:a},$eq:{name:"eq",render:a},$isNull:{name:"is null",render:b},$isNotNull:{name:"is not null",render:b}}},_isQueryValueWithOperator:function(a,b){var c=_(a).keys();if(c.length===0)return!1;var d=b||this._getQueryOperators();return d.hasOwnProperty(c[0])},_formWhere:function(a,b){var c=[],d=this;b=b||"";var e=d._getQueryOperators();return _.each(_(a).keys(),function(f){var g=a[f],h=b+f;if(_.isString(g)||_.isNumber(g)||_.isDate(g)||_.isArray(g)||_.isBoolean(g)||_.isNull(g)){var i=g===null?"$isNull":"$eq";c=c.concat(e[i].render(h,g));return}if(d._isQueryValueWithOperator(g,e)){_.each(_(g).keys(),function(a){c=c.concat(e[a].render(h,g[a]))});return}c.push(d._formWhere(g,f+"."))}),c},_getWhere:function(a){var b=this._formWhere(a);return b.length===0?"":"&where="+encodeURIComponent(b.join(" and "))},_getNestedObject:function(a){var b=null;return _.each(a.config.fields,function(a){d.header.isSimple(a)||(b=a)}),b},_getFields:function(a){if(a.config.nested!==!0)return a.config.fields;var b=this._getNestedObject(a),c=d.header.getFieldName(b);return b[c]},_getOrderBy:function(a){return!a.config.$orderBy||a.config.$orderBy===""?"":"&orderBy="+a.config.$orderBy},_getOrderByDesc:function(a){return!a.config.$orderByDesc||a.config.$orderByDesc===""?"":"&orderByDesc="+a.config.$orderByDesc},getUrl:function(a,b){var c=this,e={$skip:0,$limit:999,$query:{}};_.defaults(a.config,e);if(a.type==="context")return a.config.format="json",[c.config.path,"context.asmx","?ids="+a.config.id].join("/");if(a.type==="implementationHistory")return a.config.format="json",[c.config.appPath,"Reports/ImplementationHistory.ashx?id="+a.config.id+"&"+(new Date).valueOf()].join("/");var f=c.config.types[a.type]||{resource:a.type},g=a.config.fields,h=[c.config.path,f.resource+".asmx",a.config.id].join("/");if(a.config.nested===!0){var i=c._getNestedObject(a),j=d.header.getFieldName(i);g=i[j],h=[h,j].join("/")}return a.name&&a.name.indexOf("remove")>=0?h:(h=[h,"?skip=",a.config.$skip,"&take=",a.config.$limit,"&",b?b:"include","=",c._formIncludes(g),a.name==="find"||a.name==="turboGet"?c._getWhere(a.config.$query):"",c._getOrderBy(a),c._getOrderByDesc(a)].join(""),h)}});return f}),define("tau/rules/auto-include-beforeSave",["Underscore"],function(_){return{"auto include beforeSave":function(a,b){var c=this,d=a.data.obj;for(var e=0;e<b.fields.length;e++){var f=b.fields[e];(c.store.isPropertyInitialized(d.id,d.type,_.getFieldName(f))||b.force)&&_.mergeFields(a.data.cmd.config.fields,[f])}}}}),define("tau/rules/core",["Underscore","tau/core/class","tau/rules/auto-include-beforeSave"],function(_,a,b){return a.extend({init:function(a){var c=this;c.store=a.store||{},a.rulesImpl=a.rulesImpl||{},_.extend(c,b),_.extend(c,{name:"rules engine"}),_(a.rulesImpl).each(function(a){_.extend(c,a)}),c.register(a.rules||[])},register:function(a){var c=this;_.isArray(a)||(a=[a]),_(a).each(function(a){_.defaults(a,{name:_(b).keys()[0],fields:[],changes:[]});if(!a.hasOwnProperty("type"))throw"type should be configured for rule";if(a.fields.length===0)return;_.each(a.changes,function(b){var d=function(b){c[a.name](b,a)},e=a.name.split(" ");c.store.on({eventName:e[e.length-1],type:a.type,listener:c,hasChanges:[b]},d)})})},registerRule:function(a){var b=this;_.defaults(a,{fields:[],changes:[]});if(!a.hasOwnProperty("name"))throw'"name" field should be configured for rule';if(!a.hasOwnProperty("type"))throw'"type" field should be configured for rule';if(!b.hasOwnProperty(a.name))throw"unknown rule name ["+a.name+"]";b[a.name].call(b,a)},destroy:function(){var a=this.store;delete this.store,a.unbind(this)}})}),define("tau/rules/rule.auto-include-before-save",["Underscore"],function(_){var a=function(a,b){var c=this,d=a.data.obj;for(var e=0;e<b.fields.length;e++){var f=b.fields[e];(d.id&&c.store.isPropertyInitialized(d.id,d.type,_.getFieldName(f))||b.force)&&_.mergeFields(a.data.cmd.config.fields,[f])}};return{"auto-include-before-save":function(b){var c=this;if(b.fields.length===0)return;_.each(b.changes,function(d){var e=[d],f=function(d){a.call(c,d,b)};c.store.on({eventName:"beforeSave",type:b.type,listener:c,hasChanges:e},f)})}}}),define("tau/rules/rule.auto-action-after-save",["Underscore"],function(_){var a=function(a,b){var c=this,d=a.data,e={store:c.store,data:d};b.action(e)};return{"auto-action-after-save":function(b){var c=this,d=function(d){a.call(c,d,b)},e={eventName:"afterSave",type:b.type,listener:c};b.hasOwnProperty("changes")&&b.changes.length&&(e.hasChanges=[b.changes.join("|")]),c.store.on(e,d)}}}),define("tau/rules/rule.auto-include-before-remove",["Underscore"],function(_){var a=function(a,b){var c=this,d=a.data.obj;for(var e=0;e<b.fields.length;e++){var f=b.fields[e];_.mergeFields(a.data.cmd.config.fields,[f])}};return{"auto-include-before-remove":function(b){var c=this;if(b.fields.length===0)return;var d=function(d){a.call(c,d,b)};c.store.on({eventName:"beforeRemove",type:b.type,listener:c},d)}}}),define("tau/target.process.rules.registrator",["Underscore","tau/store/types.targetprocess"],function(_,a){return{typeContainSimpleField:function(a,b){return _.find(a.simpleFields,function(a){return a===b})},registerRules:function(b,c){this.registeredEntityTypes={},this.rules=b,_.each(a.getDictionary(),this.registerType,this),b.register({type:"feature",changes:["initialEstimate"],fields:["timeRemain"]}),b.register({type:"iteration",changes:["startDate"],fields:["endDate"]}),b.register({type:"iteration",changes:["endDate"],fields:["startDate"]}),b.register({type:"testPlanRun",changes:["release"],fields:[{build:["id","name"]}]}),b.register({type:"testPlanRun",changes:["iteration"],fields:[{build:["id","name"]}]}),b.registerRule({name:"auto-include-before-save",type:"roleEffort",changes:["effort"],fields:[{assignable:["id","effort","effortToDo","effortCompleted","timeSpent","timeRemain"]}]}),b.registerRule({name:"auto-include-before-save",type:"userStory",changes:["release","iteration"],fields:[{tasks:[{release:["id","name"]},{iteration:["id","name"]}]}]}),b.registerRule({name:"auto-include-before-save",type:"task",changes:["entityState"],fields:[{release:["id","name"]},{iteration:["id","name"]}]}),b.registerRule({name:"auto-action-after-save",type:"assignable",changes:["times"],action:function(a){a.store.refresh("assignable",{id:a.data.id,fields:["effortCompleted","effortToDo","timeSpent","timeRemain",{roleEfforts:["id","effort","effortToDo"]}]}).done()}}),b.registerRule({name:"auto-action-after-save",type:"feature",changes:["userStories"],action:function(a){a.store.refresh("feature",{id:a.data.id,fields:["effortCompleted","effortToDo","timeSpent","timeRemain","userStories-count","effort",{roleEfforts:["id","effort","effortToDo"]}]}).done()}}),b.registerRule({name:"auto-action-after-save",type:"iteration",changes:["userStories|bugs"],action:function(a){a.store.refresh("iteration",{id:a.data.id,fields:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"]}).done()}}),b.registerRule({name:"auto-action-after-save",type:"release",changes:["userStories"],action:function(a){a.store.refresh("release",{id:a.data.id,fields:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}]}).done()}}),b.registerRule({name:"auto-action-after-save",type:"userStory",changes:["tasks"],action:function(a){a.data.cmd.type==="task"&&!a.data.cmd.config.id?a.store.refresh("userStory",{id:a.data.id,fields:["tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:["id","name"]}]}).done():a.store.refresh("userStory",{id:a.data.id,fields:["effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]}).done()}}),b.registerRule({name:"auto-include-before-save",type:"task",changes:["entityState"],fields:[{userStory:["id","tasks-effort-sum","tasks-effortToDo-sum","effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count",{entityState:["id","name","isInitial","isFinal","isPlanned","isCommentRequired"]}]}]}),b.registerRule({name:"auto-include-before-save",type:"userStory",changes:["entityState"],fields:["tasks-effortToDo-sum",{feature:["effortToDo","effortCompleted","userStories-count"]},{iteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{release:["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}]}]}),b.registerRule({name:"auto-action-after-save",type:"feature",changes:["userStories"],action:function(a){a.store.refresh("feature",{id:a.data.obj.id,fields:["effortToDo","effortCompleted","userStories-count"]}).done()}}),b.registerRule({name:"auto-include-before-save",type:"bug",changes:["entityState"],fields:[{iteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]}]}),b.registerRule({name:"auto-action-after-save",type:"roleEffort",changes:["effort"],action:function(a){var b=a.store,c=a.data.obj;b.get(c.type,{id:c.id,fields:[{assignable:["id"]}]}).done({success:function(a){a=a[0];var c=a.data.assignable.id,d=a.data.assignable.__type,e={task:[{userStory:["id","effort","effortToDo","effortCompleted","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]}],userStory:[{iteration:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{release:["userStories-effortToDo-sum","userStories-effortCompleted-sum"]},{feature:["userStories-count","effort","effortToDo","effortCompleted","timeSpent","timeRemain"]}],bug:[{iteration:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]},{release:["bugs-effortToDo-sum","bugs-effortCompleted-sum"]}]},f=e[d];if(f){var g=_(f).filter(function(a){var e=_.getFieldName(a);return b.isPropertyInitialized(c,d,e)});g.length&&b.refresh(d,{id:c,fields:g}).done()}}})}}),b.registerRule({name:"auto-action-after-save",type:"comment",action:function(a){var b=a.data,d=b.cmd["comment-practices-notification-opts"];if(d&&_(d).keys().length){var e=c.getNotificationService();e.notifyComment(b.id,d)}}})},registerType:function(a){var b=this.registeredEntityTypes,c=this.rules;if(!b.hasOwnProperty(a.name)){b[a.name]=!0,_.each(a.aliases,function(a){b[a]=!0});var d="endDate";a.refs.hasOwnProperty("entityState")&&this.typeContainSimpleField(a,d)&&(c.register({type:a.name,changes:["entityState"],fields:["endDate","leadTime","cycleTime"]}),c.register({type:a.name,changes:["entityState"],fields:[{roleEfforts:["effort","effortToDo"]}]}))}}}}),define("tau/core/keyboard.manager",["Underscore","jQuery"],function(_,$){function a(){}function b(){$(document).keydown(_.bind(c,this))}function c(){if(this.keyboardHandlers.length==0)return;var a=this.keyboardHandlers[this.keyboardHandlers.length-1];a&&a.handleKeyDown.apply(a,arguments)}function d(){this.keyboardHandlers=[],this.pushHandler=f,b.call(this),this.pushHandler.apply(this,arguments)}function e(){this.keyboardHandlers.pop()}function f(a){this.keyboardHandlers.push(a)}return a.prototype={pushHandler:d,popHandler:e},a}),define("tau/core/global.bus",["tau/core/bus"],function(a){return{bus:null,reset:function(){this.bus&&this.bus.removeAllListeners(),delete this.bus},get:function(){return this.bus=this.bus||new a({id:"global",name:"globalBus"}),this.bus}}}),define("tau/store/factory",["app.path","tau/core/class","tau/store/store","tau/store/repository","tau/store/services/service.rest","tau/core/global.bus","tau/rules/core","tau/rules/rule.auto-include-before-save","tau/rules/rule.auto-action-after-save","tau/rules/rule.auto-include-before-remove","tau/target.process.rules.registrator","tau/store/types.targetprocess"],function(a,b,c,d,e,f,g,h,i,j,k,l){return b.extend({rulesDisabled:!1,clearSingles:function(){this.rulesEngine&&(this.rulesEngine.destroy&&this.rulesEngine.destroy(),delete this.rulesEngine),delete this.proxy,delete this.service,delete this.store},clear:function(){this.clearSingles(),delete this.initialData,delete this.appPath,delete this.rulesDisabled},setApplicationPath:function(a){if(this.appPath===a)return;this.appPath=a},getApplicationPath:function(){if(!this.appPath){var b=a.get();return b}return this.appPath},setInitialData:function(a){this.initialData=a},setService:function(a){if(this.service===a)return;this.clearSingles(),this.service=a},getService:function(){return this.service||(this.service=new e({appPath:this.getApplicationPath(),path:this.getRestPath()})),this.service},getRestPath:function(){return this.getApplicationPath()+"/api/v1"},setProxy:function(a){this.proxy=a},getProxy:function(){return this.proxy||(this.proxy=new d({service:this.getService()})),this.initialData&&(this.proxy.registerData(this.initialData),delete this.initialData),this.proxy},disableRules:function(){this.rulesDisabled=!0},enableRules:function(){this.rulesDisabled=!1},initRules:function(a){if(this.rulesDisabled===!0)return;this.rulesEngine=new g({store:this.store,rules:[],rulesImpl:[h,i,j]}),k.registerRules(this.rulesEngine,a)},getStore:function(a){return a=a||{},this.store||(a.proxy=this.getProxy(),_.defaults(a,{eventEmitter:f.get()}),this.store=new c(a),this.initRules(a.services)),this.store}})}),define("tau/core/external",["Underscore","jQuery","tau/core/class","libs/json2"],function(_,$,a){var b=function(a,b,c){a=a.charAt(0)!=="&"?"&"+a:a;var d=a.indexOf("&"+b+"="),e=d!==-1?d:a.length;d=a.indexOf("&",1+e);var f=d!==-1?d:a.length,g="";if(c!==null){var h=_.isString(c)?c:JSON.stringify(c),i=a==="&"?"":"&";g=i+b+"="+h}var j=a.substring(0,e),k=a.substring(f),l=j+g+k;return l=l.charAt(0)!=="&"?l:l.substring(1),l},c=function(a){var b=a;try{b=decodeURIComponent(a)}catch(c){}return b};return a.extend({init:function(a){this.external=_.defaults(a,{location:{hash:""}})},getHash:function(){var a=this.external.location.hash;while(a.indexOf("#")===0)a=a.substr(1);return c(a)},setHash:function(a){this.external.location.hash="#"+a},hashParams:function(){var a={},b=this.getHash(),c=b.split("&");for(var d=0,e=c.length;d<e;d++){var f=c[d],g=f.indexOf("=");if(g!==-1){var h=f.substr(0,g),i=f.substr(g+1),j=i;i.charAt(0)==="{"&&i.charAt(i.length-1)==="}"&&(j=JSON.parse(i)),a[h]=j}}return a},getHashParam:function(a,b){var c=this.hashParams(),d=c[a]||(arguments.length>1?b:{});return d},setHashParam:function(a,c){var d=this.getHash(),e=b(d,a,c);this.setHash(e)},onHashChange:function(a){var b=this,c=function(c){c.stopPropagation(),c.preventDefault(),a(b)};$(this.external).bind("hashchange",c)},triggerHashChange:function(a){$(this.external).trigger("hashchange",{hash:a})}})}),define("tau/core/state.manager",["Underscore","tau/core/class"],function(_,a){var b=function(){},c=a.extend({init:function(a){a=a||{};var b=[];a.state||b.push("state"),a.service||b.push("service");if(b.length>0)throw"State manager should be initialized with following parameters: ["+b.join(",")+"]";this.subscriptions={},this.cfg=a},get:function(a){var c=this;if(!a.id)throw"StateManager.get operation requires parameter [id]";var d=_.defaults(a,{fields:[],callback:b}),e=this.cfg.service;return e.get(d),c},set:function(a){var c=this;if(!a.id)throw"StateManager.set operation requires parameter [id]";var d=_.defaults(a,{set:{},callback:b}),e=this.cfg.service;return e.set(d),c},update:function(a){var b=this,c=this.cfg.state,d=[];_(a).chain().keys().each(function(e){d.push(e);var f=c[e]||{},g=a[e];if(_.isString(g)||_.isString(f))return;var h=_(f).keys(),i=_(g).keys();_(_.union(h,i)).each(function(a){if(g[a]!==f[a]){var c=f.hasOwnProperty(a)?f[a]:null,d=g.hasOwnProperty(a)?g[a]:null;b.applyChanges({paramId:e,fieldName:a,value:d,delta:{prev:c,curr:d}})}})}),_(c).chain().keys().difference(d).each(function(a){var d=c[a];if(_.isString(d))return;_(d).chain().keys().each(function(c){b.applyChanges({paramId:a,fieldName:c,value:null,delta:{prev:d[c],curr:null}})})}),b.cfg.state=a},applyChanges:function(a){var b=this.subscriptions,c=(b[a.paramId]||{})[a.fieldName]||[];for(var d=0,e=c.length;d<e;d++){var f=c[d];f.callback.call(f.scope,a)}},bind:function(a){var b=a.paramId,c=a.fieldName,d=a.callback,e=a.listener,f=this.subscriptions;return f[b]=f[b]||{},f[b][c]=f[b][c]||[],f[b][c].push({callback:d,scope:e}),this},unbind:function(a){var b=this.subscriptions,c=_(b).keys();for(var d=0,e=c.length;d<e;d++){var f=c[d],g=_(b[f]).keys();for(var h=0,i=g.length;h<i;h++){var j=g[h],k=b[f][j];for(var l=0;l<k.length;)k[l].scope===a?k.splice(l,1):++l;b[f][j].length===0&&delete b[f][j]}_(b[f]).keys()===0&&delete b[f]}}});return c}),define("tau/services/service.routing",["Underscore","tau/core/Class"],function(_,a){var b=a.extend({init:function(a){a=a||{},this.config=a,this.external=a.external},get:function(a){var b={},c=a.id,d=a.fields,e=d.length,f=this.external.getHashParam(c);for(var g=0;g<e;g++){var h=d[g];b[h]=f.hasOwnProperty(h)?f[h]:null}a.callback(b)},set:function(a){var b=a.id,c=a.set,d=this.external.getHashParam(b),e=_(d).extend(c);this.external.setHashParam(b,e),a.callback(e)}});return b}),define("tau/utils/utils.storage",[],function(){var a=typeof window.localStorage!="undefined"&&window.localStorage!==null&&!!window.localStorage.getItem&&!!window.localStorage.setItem,b={set:function(a,b){return localStorage.setItem(a,JSON.stringify(b)),!0},get:function(a){var b=localStorage.getItem(a);if(b)try{b=JSON.parse(b)}catch(c){}return b},remove:function(a){return localStorage.removeItem(a)}},c={set:function(a,b,c){var d=new Date;d.setTime(d.getTime()+31536e6),c=c||d.toGMTString();var e="expires="+c,f=[a+"="+JSON.stringify(b),e,"path=/"].join("; ");document.cookie=f},get:function(a){a+="=";var b=document.cookie.split(";"),c;for(i=0;i<b.length;i++){var d=b[i];while(d.charAt(0)===" ")d=d.substring(1,d.length);d.indexOf(a)===0&&(c=d.substring(a.length,d.length),c=JSON.parse(c))}return c},remove:function(a){return c.set(a,"",-1)}};return a?storage=b:storage=c,storage}),function(){function a(a){var b=a.currentTarget||a.srcElement,c;if(a.type==="load"||f.test(b.readyState)){a=b.getAttribute("data-requiremodule"),h[a]=!0;for(a=0;c=g[a];a++)if(h[c.name])c.req([c.name],c.onLoad);else break;a>0&&g.splice(0,a),setTimeout(function(){b.parentNode.removeChild(b)},15)}}function b(a){var b,c;a.setAttribute("data-orderloaded","loaded");for(a=0;c=j[a];a++)if((b=i[c])&&b.getAttribute("data-orderloaded")==="loaded")delete i[c],require.addScriptToDom(b);else break;a>0&&j.splice(0,a)}var c=typeof document!="undefined"&&typeof window!="undefined"&&document.createElement("script"),d=c&&(c.async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),e=c&&c.readyState==="uninitialized",f=/^(complete|loaded)$/,g=[],h={},i={},j=[],c=null;define("order",{version:"1.0.5",load:function(c,f,h,l){var p;f.nameToUrl?(p=f.nameToUrl(c,null),require.s.skipAsync[p]=!0,d||l.isBuild?f([c],h):e?(l=require.s.contexts._,!l.urlFetched[p]&&!l.loaded[c]&&(l.urlFetched[p]=!0,require.resourcesReady(!1),l.scriptCount+=1,p=require.attach(p,l,c,null,null,b),i[c]=p,j.push(c)),f([c],h)):f.specified(c)?f([c],h):(g.push({name:c,req:f,onLoad:h}),require.attach(p,null,c,a,"script/cache"))):f([c],h)}})}(),function(a){function c(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}var b={VERSION:"0.6"};c.prototype={active:!0,execute:function(a){var b;return this.active&&(b=this._listener.apply(this.context,a),this._isOnce&&this.detach()),b},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach(),this._destroy()},_destroy:function(){delete this._signal,delete this._isOnce,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", active: "+this.active+"]"}},b.Signal=function(){this._bindings=[]},b.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(a,b,d,e){if(typeof a!="function")throw new Error("listener is a required param of add() and addOnce() and should be a Function.");var f=this._indexOfListener(a),g;if(f!==-1){g=this._bindings[f];if(g.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else g=new c(this,a,b,d,e),this._addBinding(g);return g},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a){var b=this._bindings.length;while(b--)if(this._bindings[b]._listener===a)return b;return-1},add:function(a,b,c){return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return this._registerListener(a,!0,b,c)},remove:function(a){if(typeof a!="function")throw new Error("listener is a required param of remove() and should be a Function.");var b=this._indexOfListener(a);return b!==-1&&(this._bindings[b]._destroy(),this._bindings.splice(b,1)),a},removeAll:function(){var a=this._bindings.length;while(a--)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(!this.active)return;var b=Array.prototype.slice.call(arguments),c=this._bindings.slice(),d=this._bindings.length;this._shouldPropagate=!0;do d--;while(c[d]&&this._shouldPropagate&&c[d].execute(b)!==!1)},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},a.signals=b}(window||global||this),define("libs/crossroads.js/dist/js-signals",function(){}),function(a){function g(a,b){var c=a.length;while(c--)if(a[c]===b)return c;return-1}function h(a,b){return"[object "+a+"]"===e.call(b)}function i(a){return h("RegExp",a)}function j(a){return h("Array",a)}function k(a){return h("Function",a)}function l(a){return a}var b,c,d,e=Object.prototype.toString,f=/^(true|false)$/i;b=function(){function f(a,b,d){var e=new c(a,b,d,p);return h(e),e}function h(b){var c=i();do--c;while(a[c]&&b._priority<=a[c]._priority);a.splice(c+1,0,b)}function i(){return a.length}function j(b){var c=k(b);c>=0&&a.splice(c,1),b._destroy()}function k(b){return g(a,b)}function l(){var b=i();while(b--)a[b]._destroy();a.length=0}function m(a){a=a||"";var c=n(a),d=c?o(a,c):null;c?(d?c.matched.dispatch.apply(c.matched,d):c.matched.dispatch(),e.dispatch(a,c,d)):b.dispatch(a)}function n(b){var c=i(),d;while(d=a[--c])if(d.match(b))return d;return null}function o(a,b){return d.getParamValues(a,b._matchRegexp)}var a=[],b=new signals.Signal,e=new signals.Signal,p={_routes:a,addRoute:f,removeRoute:j,removeAllRoutes:l,parse:m,bypassed:b,routed:e,getNumRoutes:i,toString:function(){return"[crossroads numRoutes:"+i()+"]"}};return p},c=function(a,b,c,e){var f=i(a);this._crossroads=e,this._pattern=a,this._paramsIds=f?null:d.getParamIds(this._pattern),this._matchRegexp=f?a:d.compilePattern(a),this.matched=new signals.Signal,b&&this.matched.add(b,this),this._priority=c||0},c.prototype={rules:void 0,match:function(a){return this._matchRegexp.test(a)&&this._validateParams(a)},_validateParams:function(a){var b=this.rules,c;for(c in b)if(b.hasOwnProperty(c)&&!this._isValidParam(a,c))return!1;return!0},_isValidParam:function(a,b){var c=this.rules[b],d=this._getParamValuesObject(a),e=d[b],f;return i(c)?f=c.test(e):j(c)?f=g(c,e)!==-1:k(c)&&(f=c(e,a,d)),f||!1},_getParamValuesObject:function(a){var b=this._paramsIds,c=d.getParamValues(a,this._matchRegexp),e={},f=b?b.length:0;while(f--)e[b[f]]=c[f];return e.request_=l(a),e},dispose:function(){this._crossroads.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.matched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},d=function(){function f(a){var b=[],d,e=new RegExp(c);while(d=e.exec(a))b.push(d[1]);return b}function g(a){return a=a?h(a):"",a=a.replace(/\/$/,""),a=j(a),a=i(a),new RegExp("^"+a+"/?$")}function h(a){return a.replace(c,d)}function i(a){return a.replace(e,b.source)}function j(b){return b.replace(a,"\\$&")}function k(a,b){var c=b.exec(a);return c&&(c.shift(),c=m(c)),c}function m(a){var b=a.length,c=[];while(b--)c[b]=l(a[b]);return c}var a=/[\\\.\+\*\?\^\$\[\]\(\)\{\}\/\'\#]/g,b=/([^\/]+)/,c=/\{([^\}]+)\}/g,d="___CR_PARAM___",e=new RegExp(d,"g");return{getParamIds:f,getParamValues:k,compilePattern:g}}(),a.crossroads=b}(window||this),define("libs/crossroads.js/dist/crossroads",function(){}),define("tau/utils/utils.history",["Underscore","tau/core/class","tau/core/event","order!libs/crossroads.js/dist/js-signals","order!libs/crossroads.js/dist/crossroads"],function(_,a,b){var c=a.extend({init:function(){this.stack=[],this.current=null},size:function(){return this.stack.length},push:function(a){var b=a;return b.index=this.stack.length,this.stack.push(b),this},pop:function(){var a=this.stack.pop();return a},rewindTo:function(a){var b=this.stack.length;for(var c=b-1;c>=0;c--){var d=this.stack[c];d.index>a&&this.stack.pop()}return this.fire("changed"),this},setCurrent:function(a){this.current=a,this.fire("setCurrent")},getCurrent:function(){return this.current},process:function(){this.current&&this.stack.push(_.clone(this.current)),this.current=null},updateCurrent:function(a){this.current&&(this.current.url=a.url||this.current.url,this.current.title=a.title||this.current.title,this.current.id=a.id||this.current.id,this.fire("setCurrent"))},exclude:function(a,b){this.stack=_.reject(this.stack,function(b,c){return b.id&&b.id==a}),this.current.id==a&&(this.current=null),b!==!1&&this.fire("changed")}});return b.implementOn(c.prototype),c}),define("libs/parseUri",[],function(){function a(b){var c=a.options,d=c.parser[c.strictMode?"strict":"loose"].exec(b),e={},f=14;while(f--)e[c.key[f]]=d[f]||"";return e[c.q.name]={},e[c.key[12]].replace(c.q.parser,function(a,b,d){b&&(e[c.q.name][b]=d)}),e}return a.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a}),define("tau/utils/utils.routing/utils.routing.store.hash",["Underscore","jQuery","tau/core/external","tau/core/class","tau/core/event","libs/parseUri"],function(_,$,a,b,c,d){var e=b.extend({init:function(b){this.config=_.defaults(b,{window:window,v2:!1,safe:!1,encodeBy:function(a){return a},decodeBy:function(a){try{a=decodeURIComponent(a)}catch(b){}return a}}),this.window=this.config.window||window,this.config.v2&&(this.config.external=new a(this.window)),this.params=[];var c=this;this.hashChangeHandler=function(a){a.stopPropagation(),a.preventDefault();var b=a.hash||a.target.location.hash;c.fire("urlChanged",{url:c.parseUrl(b)})},$(this.window).bind("hashchange",this.hashChangeHandler),this.destroyHandler=function(a){c.fire("destroyed",{})},$(this.window).bind("unload",this.destroyHandler)},_extract:function(a){var b=a;if(this.config.safe){a="?"+a;var c=d(a);this.params=c.queryKey,b=this.params[this.config.safeParameterName]||""}return b},_generateV2:function(b,c){var d="||legacystate",e=this.config.external,f=e.getHash(),g=new a({location:{hash:f}}),h=!_.isEmpty(b.states)&&c?b.states:{};return g.setHashParam(d,h),g.getHash()},_generate:function(a,b){b=!!b;var c="";if(this.config.v2)return c=this._generateV2(a,b),c;var d=a.url;return!_.isEmpty(a.states)&&b&&(d+="||"+JSON.stringify(a.states)),c=d,this.config.safe&&(this.params[this.config.safeParameterName]=d,c=$.param(this.params)),this.config.encodeBy(c)},_parseUrlV2:function(b){var c={},d=new a({location:{hash:b}});return c.source="#"+d.getHash(),c.states=d.getHashParam("||legacystate"),c.url=d.getHashParam(this.config.safeParameterName),c},parseUrl:function(a){if(this.config.v2){var b=this._parseUrlV2(a);return b}a&&a[0]=="#"&&(a=a.slice(1));var c=this._extract(a);try{c=this.config.decodeBy(c)}catch(d){}var e={url:null,states:{},source:"#"+a},f=c.split("||");e.url=f[0];if(f[1])try{e.states=JSON.parse(f[1])}catch(d){}return e},generateUrl:function(a,b){return this._generate(a,b)},setUrl:function(a){var b="#";_.isObject(a)&&a.hasOwnProperty("url")&&a.hasOwnProperty("states")?b=this._generate(a,!0):_.isString(a)&&(b=a),this.window.location.hash=b},getUrl:function(){return this.parseUrl(this.window.location.hash)}});return c.implementOn(e.prototype),e}),define("tau/utils/utils.routing",["Underscore","jQuery","tau/core/class","tau/core/event","tau/utils/utils.routing/utils.routing.store.hash","tau/utils/utils.storage","order!libs/crossroads.js/dist/js-signals","order!libs/crossroads.js/dist/crossroads"],function(_,$,a,b,c,d){var e=a.extend({init:function(a){var b=window.crossroads;return this.backend=b(),this.options=a,this.window=this.options.window||window,this.store=new c(this.options),this.v2=a.v2===!0,this.current={url:"",states:{},source:""},this.processed={url:"",states:{},source:""},this.referer=this.restoreReferer(),this.reset(),this},register:function(a,b,c){var d=a;arguments.length>1&&(d={pattern:a,callback:b});var e=this,f=this.backend.addRoute(d.pattern,function(){var a=Array.prototype.slice.call(arguments),b=this,c={};_.forEach(b._paramsIds,function(b,d){c[b]=a[d]});var f=e.processed.states;d.callback.apply(this,_.union([c,f],a))});return this},register404:function(a){return this.backend.bypassed.add(a),this},_applyRouter:function(a){this.backend.parse(a)},start:function(){var a=this,b=_.bind(this._applyRouter,this),c=function(c){this.processed=c;if(this.processed.url!==this.current.url){this.setReferer(_.clone(this.current)),this.current=this.processed,b(this.current.url);return}var d=this.current.states,e=this.processed.states,f=_.union(_.keys(d),_.keys(e)),g={};_.forEach(f,function(a){d[a]!=e[a]&&(g[a]=e[a]||null)}),_.forEach(g,function(b,c){a.fire("stateChanged",{name:c,value:b})}),this.current=this.processed};this.setChangeListener(_.bind(c,this));var d=function(){this.setReferer(_.clone(this.current))};return this.setDestroyListener(_.bind(d,this)),this},redirect:function(a){this.window.open(a,"_self")},setInternalUrl:function(a){this.setUrl({url:a,states:{}})},getUrl:function(){return this.store.getUrl()},setUrl:function(a){this.store.setUrl(a)},generateUrl:function(a){return typeof a=="undefined"&&(a=this.current),this.store.generateUrl(a,!0)},setChangeListener:function(a){this.changeListener=function(b){a(b.data.url)},this.store.on("urlChanged",this.changeListener,this)},setDestroyListener:function(a){this.destroyListener=function(b){a(b.data.url)},this.store.on("destroyed",this.destroyListener,this)},reset:function(){return this.backend.removeAllRoutes(),this.backend.bypassed.removeAll(),this},execute:function(a){var b=this.store.parseUrl(a);return this.current=b,this._applyRouter(b.url),this},stop:function(){this.changeListener&&(this.store.removeListener("urlChanged",this.changeListener,this),delete this.changeListener),this.destroyListener&&(this.store.removeListener("destroy",this.destroyListener,this),delete this.destroyListener)},getStateParameter:function(a){return this.current.states[a]},setStateParameter:function(a,b,c){this.current.states[a]=b,this.setUrl(this.current),c&&this.fire("stateChanged",{name:a,value:b})},getReferer:function(){return this.referer},setReferer:function(a){this.referer=a,d.set("utils.routing.referer",this.referer)},restoreReferer:function(){var a=d.get("utils.routing.referer");return a}});return b.implementOn(e.prototype),e}),define("tau/store/services/service.globalSettings",["tau/core/class"],function(a){var b=null,c=a.extend({init:function(a){this.config=a},resetSettings:function(){b=null},getGlobalSettings:function(a){var c=function(a,b){a.success&&a.success.call(a.scope,b.d)};if(b){c(a,b);return}this.sendRequest("GlobalSettingsService","GetGlobalSettings",null,function(d){b=d,c(a,d)},function(b){a.failure&&a.failure.call(a.scope,b)})},sendRequest:function(a,b,c,d,e){var f=this.config.appPath+"/PageServices/"+a+".asmx/"+b,g={contentType:"application/json",type:"POST",success:d,error:e};c&&(g.data=JSON.stringify(c)),$.ajax(f,g)}});return c}),define("tau/store/services/service.notifications",["tau/core/class"],function(a){var b=a.extend({init:function(a){this.config=a},notifyComment:function(a,b,c){c=c||{},this.sendRequest("CommentsNotificationService","Notify",{commentId:a,options:b},function(a){c.success&&c.success.call(c.scope,a.d)},function(a){c.failure&&c.failure.call(c.scope,a)})},sendRequest:function(a,b,c,d,e){var f=this.config.appPath+"/PageServices/"+a+".asmx/"+b,g={contentType:"application/json",type:"POST",success:d,error:e};c&&(g.data=JSON.stringify(c)),$.ajax(f,g)}});return b}),define("tau/store/services/service.actions",["Underscore","tau/core/class"],function(_,a){var b=a.extend({init:function(a){this.config=a},getActionUrl:function(a){return this.config.appPath+"/PageServices/ActionsService.asmx/"+a},getActiveProjectForEntity:function(a,b,c){var d={generalId:a};this.sendRequest("GetActiveProjectForEntity",d,b,c)},copyGeneralToProject:function(a,b,c,d){var e={generalId:a,projectId:b};this.sendRequest("CopyGeneralToProject",e,c,d)},getProjectIds:function(a,b){var c={};this.sendRequest("GetProjectIds",c,a,b)},moveGeneralToProject:function(a,b,c,d){var e={generalId:a,projectId:b};this.sendRequest("MoveGeneralToProject",e,c,d)},attachGeneralToRequest:function(a,b,c,d){var e={generalId:a,requestId:b};this.sendRequest("AttachGeneralToRequest",e,c,d)},detachRequest:function(a){var b=function(){},c={generalId:a.generalId,requestId:a.requestId};a=_(a).defaults({success:b,error:b}),this.sendRequest("DetachRequestFromGeneral",c,a.success,a.error)},generalCanConvertTo:function(a,b,c){var d={generalId:a};this.sendRequest("GeneralCanConvertTo",d,b,c)},convertGeneralToTask:function(a,b,c,d){var e={generalId:a,userStoryId:b};this.sendRequest("ConvertGeneralToTask",e,c,d)},convertGeneralToType:function(a,b,c,d){var e={generalId:a,entityTypeId:b};this.sendRequest("ConvertGeneralToType",e,c,d)},splitUserStory:function(a,b,c){var d={generalId:a};this.sendRequest("SplitUserStory",d,b,c)},sendRequest:function(a,b,c,d){$.ajax(this.getActionUrl(a),{contentType:"application/json",type:"POST",data:JSON.stringify(b),success:c,error:d})}});return b}),define("tau/store/factory.instance",["tau/store/factory"],function(a){return new a}),define("tau/components/extensions/application/extension.routing",["Underscore","jQuery","tau/core/event.emitter","tau/core/event","tau/store/types"],function(_,$,a,b,c){return a.extend({init:function(a){this._super(a),this.config=a,this.routing=a.context.configurator.getRouting(a.applicationId);var b=this.routing.getUrl().source;this.defaultHash=b!=="#"?b:"#__"+_.uniqueId()},"bus registerRoute":function(a){var b=a.data;this.routing.register(b.pattern,b.callback)},"bus registerRouteNotFound":function(a){var b=a.data;this.routing.register404(b.callback)},"bus afterInit":function(a){this.fire("routing.registered",{})},"bus controller.ready":function(){this.routing.start();var a=this.routing.getUrl();this.config.startUrl?a.url===this.config.startUrl?this.routing.execute(this.config.startUrl):(this.routing.execute(this.config.startUrl),this.routing.setInternalUrl(this.config.startUrl)):this.config.executeOnStart!==!1&&this.routing.execute(a.source)},destroy:function(){this._super(),this.routing.reset(),this.routing.stop(),this.routing.removeAllListeners(this),!this.config.applicationId&&this.config.integration&&this.config.integration.showInPopup&&this.routing.setUrl(this.defaultHash),delete this.config,delete this.routing,delete this.defaultHash}})}),define("tau/components/extensions/application/extension.routing.patterns",["Underscore","tau/core/event.emitter","tau/core/tau"],function(_,a,b){return a.extend({init:function(a){this._super(a),this.config=a},parseQueryParams:function(){var a=b.getValueFromQueryString("type").split("."),c=/\/(\w+?).aspx$/.exec(window.location.pathname);return{id:b.getValueFromQueryString("id"),entity:a[a.length-1],type:a[a.length-1],action:c&&c.length?c[1]:null}},normalizeUrl:function(){var a=this;if(a.config.applicationId){var b=a.config.context.configurator.getExternal(),c=b.getHashParam(a.config.applicationId,null);c||(c=a.config.pageType+"/"+a.config.pageId,b.setHashParam(a.config.applicationId,c))}},"bus routing.registered":function(a){var b=this,c=this.parseQueryParams();b.normalizeUrl();var d=_.bind(this.execute,this);this.fire("registerRoute",{pattern:/board\/([\w|0-9]+)/,callback:function(a,b,c){d("board",{id:c,entity:"board"})}}),this.fire("registerRoute",{pattern:"",callback:function(a){d("entity",c)}});var e;this.fire("registerRoute",{pattern:/(\w+)\/([0-9]+)($|\s|&)/,callback:function(a,b,c,f){f=parseInt(f);if(e!=f){var g={entity:c,id:f,action:"show"};e=f,d("entity",g)}}}),this.fire("registerRoute",{pattern:"{entity}/{id}/{action}",callback:function(a){a.id=parseInt(a.id),d("entity",a)}}),this.fire("registerRouteNotFound",{callback:function(a){b.fire("error",{message:"URL is not found"})}}),this.fire("dataBind",{})},execute:function(a,b){this.fire("application.navigate."+a,b)},"bus afterRender":function(a){this.fire("controller.ready")},destroy:function(){var a=this;if(a.config.applicationId){var b=a.config.context.configurator.getExternal();b.setHashParam(a.config.applicationId,null)}delete a.config,this._super()}})}),define("tau/components/extensions/application/extension.navigation",["Underscore","jQuery","tau/core/event.emitter"],function(_,$,a){return a.extend({init:function(a){this._super(a),this.config=a},"bus innerContentRendered":function(a){var b=this,c=b.config;if(!c.applicationId)return;a.data.element.delegate("a","click",function(a){if(a.ctrlKey||a.metaKey)return;var b=$(a.currentTarget),d=b.attr("href")||"";if(d.charAt(0)==="#"){a.preventDefault(),a.stopPropagation();if(d==="#")return;var e=c.context.configurator.getExternal();d.indexOf("=")===-1&&d.indexOf("&")===-1?e.setHashParam(c.applicationId,d.substring(1)):e.setHash(d.substring(1))}})},destroy:function(){this._super(),delete this.config}})}),define("tau/components/extensions/error/extension.errorBar",["jQuery","tau/components/extensions/component.extension.base"],function($,a){var b=a.extend({"bus initialize":function(a){if(document.documentMode==7){var b={message:"TargetProcess does not support Compatibility View for Internet Explorer 7. Please, turn it off."};throw this.fire("error",b),b}},"bus error":function(a){var b=a.data.message;$.notifyBar({cls:"error",html:b,delay:6e6})}});return b}),define("tau/components/extensions/application/extension.controller.board.entity",["Underscore","tau/core/event.emitter"],function(_,a){return a.extend({init:function(a){this._super(a),this.config=a},"bus application.navigate.entity":function(a){this._initGlobalEvents()},_initGlobalEvents:function(){var a=this,b=function(b){var c=b.data,d={project:{id:c.project.id}},e={id:c.entity.id,changes:d,cmd:{config:{$set:d}}};a.bus.fire("application.reload",e)},c=function(b){var c=b.data,d={},e={id:c.bugId,changes:d,cmd:{config:{$set:d}}};a.fire("application.reload",e)};a.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",c,a),a.bus.getGlobalBus().on("entityWasMovedToProject",b,a),a.bus.getGlobalBus().on("processChanged",b,a);var d=["general","assignment","roleEffort"],e=a.config.context.configurator.getStore(),f=function(b){a.fire("application.reload",b.data)};_.each(d,function(b){e.on({type:b,eventName:"afterSave",listener:a},f),e.on({type:b,eventName:"afterRemove",listener:a},f)})},destroy:function(){this._super(),this.config.context.configurator.getStore().unbind(this),delete this.config}})}),define("tau/ui/templates/application/ui.template.application.boardPlus",["tau/core/templates-factory"],function(a){var b={name:"application.board",markup:['<div class="tau-app">',"</div>"]};return a.register(b)}),define("tau/ui/templates/application/ui.template.application",["tau/core/templates-factory"],function(a){var b={name:"application",markup:['<div class="ui-application-viewport">',"</div>"]};return a.register(b)}),define("tau/core/model-base",["Underscore","tau/core/event.emitter"],function(_,a){var b=a.extend({init:function(a){this._super(a),this.store=a.store,this.config=a},onInit:function(a){},isCommandForEntityInContext:function(a){return a.data.cmd.config.id===this.config.context.entity.id},isPropertyChanged:function(a,b){var c=b.changes,d=b.cmd.config.$set||{};return _.any(a,function(a){return c.hasOwnProperty(a)||d.hasOwnProperty(a)})},attachToChangePropertiesOfCurrentEntity:function(a){var b=_.isArray(a)?a:[a],c=this.config.context.entity.id,d=this,e=function(a){var c=a.data;d.isPropertyChanged(b,c)&&d.fire("propertyChanged",c)},f=function(a){var c=a.data;d.isPropertyChanged(b,c)&&d.fire("beforeChangeProperty",c)},g=this.config.context.entity.entityType.name||"general";d.store.on({type:g,eventName:"afterSave",filter:{id:c},listener:d},e),d.store.on({type:g,eventName:"beforeSave",filter:{id:c},listener:d},f),a[this.propertyName]=[this.displayField,this.valueField]},"bus beforeInit":function(a){this.config=a.data?a.data.config:{},this.store=this.config.store?this.config.store:this.store,this.onInit()},"bus evictData":function(){var a=this.config.entity||this.config.context.entity,b=a.id;this.store.config.proxy.evictPersistedObject(b,"context"),this.store.config.proxy.evictPersistedObject(b,a.type||a.entityType.name)},destroy:function(){this.store.unbind(this),delete this.config,delete this.store,this._super()}});return b}),define("tau/models/model.iteration.progressBar",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({name:"Iteration Progress Bar",afterSaveRoleEffort:function(a){var b=this;b.fire("roleEffortChanged")},onDataUpdate:function(a){var b=this;b.fire("refresh")},floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onInit:function(){var a=this,b=this.config.context,c=b.entity.entityType.name,d=b.entity.id,e=["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"];a.store.unbind(a),a.store.on({eventName:"afterSave",type:"roleEffort",listener:a,filter:{assignable:{id:d}}},_.bind(a.afterSaveRoleEffort,a)),a.store.on({eventName:"afterSave",type:c,listener:a,filter:{id:d},hasChanges:[e.join("|")]},_.bind(a.onDataUpdate,a)),a.store.get(c,{id:d,fields:e},{success:a.onEntityRetrieved,scope:a}).done({success:a.done,scope:a})},onEntityRetrieved:function(a){var b=a.data,c=b["bugs-effortToDo-sum"]+b["userStories-effortToDo-sum"],d=b["bugs-effortCompleted-sum"]+b["userStories-effortCompleted-sum"],e=Math.round(100*parseFloat(c)+100*parseFloat(d))/100,f=Math.round(1e4*(d/e))/100;f=isNaN(f)?0:f,f=f>100?100:f,this.effortToDo=c,this.effortCompleted=d,this.percentCompleted=f},done:function(){this.fire("dataBind",{effortToDo:this.floatToString(this.effortToDo),effortCompleted:this.floatToString(this.effortCompleted),percentCompleted:this.percentCompleted,totalEffort:this.floatToString(this.effortToDo+this.effortCompleted),point:this._getEffortPoints()})}});return b}),define("tau/ui/templates/label/ui.template.assignmentEffort.label",["tau/core/templates-factory"],function(a){var b={name:"assignment-effort-label",markup:['<div><span class="property"><span class="effort">${totalEffort}&nbsp;${point}</span></span>']};return a.register(b)}),define("tau/models/extension.model.base",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({category:"extension model base",floatToString:function(a){return a||(a=0),a.toFixed(2).replace(".00","")},destroy:function(){this._super(),this.destroy=function(){}}})}),define("tau/models/assignmentsList/extension.model.effortRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model effort retriver","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:["effort","effortToDo"]},callback:{scope:this,success:this.onEffortRetrieved}})},"bus extendDataToBind":function(a){var b=a.data||{},c=this.entity||{};b.totalEffort={effort:this.floatToString(c.effort),remain:this.floatToString(c.effortToDo)}},onEffortRetrieved:function(a){this.entity=a.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/models/assignmentsList/extension.model.store.operations",["Underscore","tau/core/model-base","tau/core/event"],function(_,a){var b=a.extend({category:"store operations","bus commitTransaction":function(a){var b=this.transaction||this.store;delete this.transaction,b.done(a.data)},"bus get":function(a){var b=this.transaction=this.transaction||this.store,c=a.data||{};this.transaction=b.get(c.type,c.query,c.callback)},"bus find":function(a){var b=this.transaction=this.transaction||this.store,c=a.data||{};this.transaction=b.find(c.type,c.query,c.callback)},destroy:function(){this._super.apply(this,arguments),this.destroy=function(){}}});return b}),define("tau/models/assignmentsList/extension.model.effortPointsRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model effort points extension",_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},"bus extendDataToBind":function(a){var b=a.data||{};b.effortPoints=this._getEffortPoints()}})}),define("tau/models/assignmentsList/extension.model.assignmentsRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model extension assignments retriever","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",{role:["id","name"]},b],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},onAssignmentsRetrieved:function(a){var b=a.data.assignments;this.fire("assignmentsReady",b)}})}),define("tau/models/assignmentsList/extension.model.entityRolesRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model entity roles retriever extension","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={role:["id","name","isPair","hasEffort"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{roleEfforts:["id","effort","effortToDo",b,{assignable:["id"]}],list:!0}]},callback:{scope:this,success:this.onRoleEffortsRetrieved}})},"bus userGroupWasCreated":function(a){var b=a.data||{},c=b.role||{};if(c.hasEffort){var d=this.entity.roleEfforts;_.each(d,function(a){if(a.role.id==c.id)return b.roleEffort={effort:this.floatToString(a.effort),remain:this.floatToString(a.effortToDo),id:a.id},!0},this),this.fire("roleEffortsReady",d)}else b.roleEffort=null},getRoles:function(){var a=this.entity.roleEfforts,b=[],c=a.length;for(var d=0;d<c;d++)b.push(a[d].role);return b},onRoleEffortsRetrieved:function(a){this.entity=a.data;var b=this.getRoles();this.fire("rolesReady",b)},"bus extendDataToBind":function(a){var b=a.data||{}}})}),define("tau/models/assignmentsList/extension.model.featureRolesRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model feature roles retriever extension","bus registerStoreRequest":function(){var a=this.config.context.getProcessId();this.fire("get",{type:"process",query:{id:a,nested:!0,fields:[{entityStates:["id",{role:["id","name","hasEffort","isPair"]},{entityType:["id","name"]}],list:!0}]},callback:{scope:this,success:this.onEntityStatesRetrieved}})},onEntityStatesRetrieved:function(a){var b=a.data.entityStates,c=this.roles=[],d={},e=this.config.context.entity.entityType.name.toLocaleLowerCase();_.each(b,function(a){var b=a.role;b&&a.entityType.name.toLowerCase()===e&&(d.hasOwnProperty(b.id)||(d[b.id]=!0,c.push(b)))}),this.fire("rolesReady",c)}})}),define("tau/models/assignmentsList/extension.model.taskEffortRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model task EffortRetriever","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:["tasks-count","tasks-effort-sum","tasks-effortToDo-sum"]},callback:{scope:this,success:this.onTaskEffortRetrieved}})},"bus extendDataToBind":function(a){var b=a.data||{},c=this.entity||{};c["tasks-count"]>0&&(b.tasksEffort={effort:this.floatToString(c["tasks-effort-sum"]),remain:this.floatToString(c["tasks-effortToDo-sum"])})},onTaskEffortRetrieved:function(a){this.entity=a.data},destroy:function(){delete this.entity,this._super()}})}),define("tau/core/model.editable.base",["tau/core/model-base"],function(a){var b=a.extend({"bus save":function(a){var b=this,c=b.config.context?b.config.context.entity:{},d=a.data||{},e=d.$set||d,f=d.$include,g=d.hasOwnProperty("id")?d.id:c.id,h=d.typeName||c.entityType.name,i={$set:e,fields:f};g&&(i.id=g);var j={type:h,cmd:i,validation:{isValid:!0,isError:function(){return!1}}};b.fire("validate",j),b.fire("afterValidate",j);if(j.validation.isValid===!1||j.validation.isError&&j.validation.isError()==1){b.fire("validationFailed",j);return}b.fire("beforeSave",j),b.store.save(h,i,{success:function(a){b.fire("afterSave",{type:a.command.type,cmd:i})},failure:function(a){b.fire("saveFailed",{type:a.command.type,cmd:i})}}).done()},"bus remove":function(a){var b=this,c=b.config.context.entity,d=a.data||{},e=d.typeName||c.entityType.name;b.fire("beforeRemove",d),b.store.remove(e,{id:d.id},{success:function(a){b.fire("afterRemove",a.data)},failure:function(){}}).done()}});return b}),define("tau/models/model.assignmentsList.editable",["tau/core/model.editable.base"],function(a){var b=a.extend({"bus dataBind":function(a){this.fire("permissionsReady",{editable:!0})}});return b}),define("tau/models/userList/extension.model.unassignAction",["Underscore","tau/core/model-base"],function(_,a){return a.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(a){var b=a.data;b.headerActions.push({id:"unassign",title:"Unassign"})}})}),define("tau/models/userList/extension.model.showMore",["Underscore","tau/core/model-base"],function(_,a){return a.extend({name:"Model Extension Unassign Action","bus extendDataToBind":function(a){var b=a.data;b.moreAvailable=this.isMoreAvailable()},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var a=this.config.data;return this.filterIsEmpty()&&a.showMore!==!0&&(a.hasOwnProperty("roleId")||a.hasOwnProperty("role"))},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length}})}),define("tau/components/extensions/assignmentsList/extension.assignmentsList.editable",["Underscore","jQuery","tau/core/model-base"],function(_,$,a){return a.extend({category:"edit",init:function(){var a=this;a._super.apply(a,arguments),a.animations=[]},"bus dataBind":function(a){this.bindedData=a.data},"bus afterRender":function(a){this.refresh=this._innerRefresh,this.$el=a.data.element,this.startAnimations()},"bus permissionsReady+afterRender":function(a){var b=a.permissionsReady.data;if(b.editable){var c=this;c.$el.removeClass("assignments-table-readonly"),c.$el.find(".group .effort").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(a){var b=this.$element.parents(".group").tmplItem().data,d=c.normalizeEffort(b.roleEffort.effort),e=c.normalizeEffort(a);if(d===e)return this.restoreInitialText(),!1;var f={typeName:"roleEffort",$include:["id"],id:b.roleEffort.id,$set:{effort:e}};c.bus.fire("save",f)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))}})}},"bus beforeSaveAssignment":function(a){var b=this,c=a.data.assignmentId,d,e;c&&(d=this.getAssignmentSelector(c),e=this.$el.find(d),e&&(this.fire("markElementToBeUpdated",{element:e}),this.addAnimation(function(){b.fire("updateElement",{element:b.$el.find(d)})})))},"bus beforeStateChanged":function(a){var b=this;b.fire("markElementToBeUpdated",{element:this.$el}),b.addAnimation(function(){b.fire("updateElement",{element:b.$el})})},"bus dataDidUpdated":function(){this.refresh()},"bus afterSaveRoleEffort":function(a){var b=a.data.roleEffortId,c=this;c.addAnimation(function(){var a=c.findRoleEffortElementByRoleEffortId(b);c.fire("updateElement",{element:a}),c.fire("updateElement",{element:c.$el.find(".total-row .effort-cell span")})}),this.refresh()},"bus afterAssignmentSaved":function(){this.refresh()},"bus afterAssignmentRemoved":function(){this.refresh()},"bus afterStateChanged":function(a){this.refresh()},"bus afterAssignmentAdded":function(a){this.refresh()},"bus beforeAddAssignment":function(a){var b=a.data,c=this,d=c.generateAssignmentIdForNewAssignment(b),e={name:"",role:{},assignmentId:d};$.tmpl("user",e).appendTo(c.$el.find(".group[roleId="+b.role.id+"]"));var f=c.getUserSelector({roleId:b.role.id,id:b.generalUser.id});c.addAnimation(function(){c.fire("updateElement",{element:c.$el.find(f)})})},"bus beforeRemoveAssignment":function(a){var b=a.assignmentId,c=this.$el.find(this.getAssignmentSelector(b));this.fire("markElementToBeDeleted",{element:c})},"bus beforeSaveRoleEffort":function(a){var b=a.data,c=b.roleEffortId,d=this.findRoleEffortElementByRoleEffortId(c);this.fire("markElementToBeUpdated",{element:d})},getUserSelector:function(a){return".group[roleId="+a.roleId+"] .user[userId="+a.id+"]"},getAssignmentSelector:function(a){var b=this,c=".user",d=b.$el.find(c),e;return d.each(function(b){var f=d.eq(b);if(f.tmplItem().data.assignmentId==a)return e=f,c+=":eq("+b+")",!1}),c},generateAssignmentIdForNewAssignment:function(a){return[this.config.context.entity.id,a.role.id,a.generalUser.id].join(",")},findRoleEffortElementByRoleEffortId:function(a){var b=this.$el.find(".role-effort .effort"),c=$();return b.each(function(){var b=$(this),d=b.parents(".group"),e=d.tmplItem().data;e.roleEffort=e.roleEffort||{};if(e.roleEffort.id===a)return c=b,!1}),c},addAnimation:function(a){this.animations.push(a)},startAnimations:function(){_.each(this.animations,function(a){a()}),this.animations=[]},_innerRefresh:function(){this.refresh=function(){},this.fire("refresh")},refresh:function(){},normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},destroy:function(){delete this.$el,delete this.bindedData,delete this.animations,this._super()}})}),define("tau/ui/extensions/editable-base",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(!c.editable)return;b.onEditActivated({element:a.afterRender.data.element})},onEditActivated:function(a){}})}),define("tau/ui/behaviour/common/ui.behaviour.tauBubble",["Underscore","jQuery"],function(_,$){var a=[];return $.widget("ui.tauBubble",{_isInit:!1,$popup:null,$closeEl:null,$arrows:{top:null,bottom:null},$target:null,$alignTo:null,options:{viewport:"body",alignTo:null,collision:"fit flip",onShow:$.noop,showOnCreation:!1,closeOnEscape:!0},_create:function(){this.$target=this.element,this.options.alignTo&&(this.$alignTo=$(this.options.alignTo)),this.$alignTo=this.$alignTo&&this.$alignTo.length?this.$alignTo:this.$target;if(this.options.showOnCreation==1)this.show();else{var a=this.onTargetClickDelegate=$.proxy(this._onTargetClick,this);this.$target.bind("click",a)}},_onTargetClick:function(a){var b=$(a.target);if(b.is("a")||b.parent().is("a"))return!0;a.preventDefault(),a.stopPropagation(),this.toggle()},_initInstance:function(b){var c=this,d,e=this.$target.parents(".ui-popup-content:first"),f=null;e.length?(d=e,f=d.parent()):(d=$("body"),f=d);var g=$('<div class="tau-bubble popup-container"><div class="tau-bubble__inner" role="content"></div></div>');g.appendTo(f),this.$popup=g,c.$arrows={top:$('<div class="tau-bubble__arrow-top"></div>'),bottom:$('<div class="tau-bubble__arrow-bottom"></div>')},c.$arrows.top.prependTo(g),c.$arrows.bottom.prependTo(g),_(a).include(c)||a.push(c);var h=$.proxy(this.hide,this);g.mouseenter(function(a){g.data("focus",!0)}),g.mouseleave(function(a){g.data("focus",!1)}),d.scroll(function(){h(),c.$target.trigger("externalClose",{})}),this._initInstance=function(){}},show:function(){this._initInstance();var b=this;b.$popup.zIndex(b.$target.zIndex()+1),b.$target.trigger("show.before",{}),b.adjustPosition(),b.options.onShow.call(b,b.$popup);for(var c=0;c<a.length;c++){var d=a[c];d!=b&&(d.$target.trigger("externalClose",{}),d.hide())}b._signUpForCloseEvents(),b._windowResizeDelegate||(b._windowResizeDelegate=_.bind(function(){this.adjustPosition()},this)),$(window).bind("resize",b._windowResizeDelegate);var e={api:b,target:b.$target,popup:b.$popup};b.$target.trigger("show",e),b.$popup.trigger("show",e)},hide:function(a){var b=this,c=b.$popup;if(!c.is(":visible"))return;c.hide(),b._documentKeyDown&&($(document).unbind("keydown",b._documentKeyDown),delete b._documentKeyDown),b._documentClickDelegate&&($(document).unbind("click",b._documentClickDelegate),delete b._documentClickDelegate),b._windowResizeDelegate&&($(window).unbind("resize",b._windowResizeDelegate),delete b._windowResizeDelegate),b.$target.trigger("close",{event:a})},_onKeyDown:function(a){if(a.keyCode!=$.ui.keyCode.ESCAPE)return;this.$target.trigger("externalClose",{}),this.hide(a)},_signUpForCloseEvents:function(){var a=this;a.options.closeOnEscape&&!a._documentKeyDown&&(a._documentKeyDown=function(b){a._onKeyDown(b)},$(document).keydown(a._documentKeyDown)),a._documentClickDelegate||(a._documentClickDelegate=function(b){a._onDocumentClick(b)},$(document).click(a._documentClickDelegate))},_processArrows:function(){var a=this,b=a.$alignTo,c=a.$popup;a.$arrows.top.hide(),a.$arrows.bottom.hide();var d=a.$arrows.top,e=b.offset(),f=c.offset();f.top<e.top&&(d=a.$arrows.bottom);if(f.left<e.left){var g=b.width(),h=e.left-f.left-($.browser.webkit?17:24)+g/2;d.css("left",h+"px")}this.options.adjustArrow&&this.options.adjustArrow(d,c),d.show()},toggle:function(){var a=this;!a.$popup||!a.$popup.is(":visible")?a.show():a.hide()},widget:function(){return this.$popup||$()},adjustPosition:function(){var a=this,b=a.$alignTo,c=a.$popup;c.show();var d="-20 9";b.width()>=20&&(d="0 9");var e={of:b,my:"left top",at:"left bottom",offset:d,collision:a.options.collision};a.options.onPosition&&a.options.onPosition(e),c.position(e);var f=b.position(),g=c.position();g.top<0&&(e.collision="none",c.position(e),g=c.position()),a._processArrows();var h=a.element},_onDocumentClick:function(a){var b=this,c=$(a.target);if(!b.$popup.is(":visible"))return;if(c.hasClass("tau-bubble-target")||c.parents(".tau-bubble-target,.ui-menu-item").length>0)return;if(c.hasClass("tau-bubble")||c.parents("div.tau-bubble").length>0)return;if(b._justActivated){b._justActivated=!1;return}b._trigger("hide"),b.$target.trigger("externalClose",{}),b.hide()},activate:function(){this._justActivated=!0,this.show()},destroy:function(){var b=this,c=b.element;b.$popup&&(b.hide(),b.$popup.remove(),b.$arrows.top.remove(),b.$arrows.bottom.remove()),c.unbind("click",b.onTargetClickDelegate),a=_(a).without(b),$.Widget.prototype.destroy.apply(this,arguments)},empty:function(){var a=this;a.hide(),a.$popup.find(".tau-bubble__inner").empty()}}),$.fn.tauBubble}),define("tau/ui/extensions/popupEditorContainer.extension",["Underscore","jQuery","tau/ui/extensions/editable-base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function(_,$,a,b){return a.extend({category:"edit",init:function(a){this._super(a),this.containers=[]},destroy:function(){this.destroyContainers(),this._super()},onEditActivated:function(a){this.destroyContainers();var c=this,d=this.element=a.element;for(var e=0;e<c.config.popupEditorContainer.length;e++){var f=c.config.popupEditorContainer[e],g=d.find(f.targetSelector);g.find(".external-view,.ui-type-icon").click(function(a){a.stopPropagation()}),g.each(function(){var a=$(this);f.component.data=a.tmplItem().data;var e={components:_.clone(f.component),context:c.config.context,store:c.config.store};a.addClass("tau-bubble-target"),f.targetCssClass&&a.addClass(f.targetCssClass);var g=!1;f.alignmentSelector&&(f.alignmentSelectorFrom=="target"?g=a.find(f.alignmentSelector):g=d.find(f.alignmentSelector));if(!g||!g.length)g=a;g.addClass("ui-link");var h=function(a){return function(){c.initializeContainer(this.$target,this.$popup,a)}}(e);b.call(a,{alignTo:g,onShow:h})})}},initializeContainer:function(a,b,c){var d=this,e=b.find(".tau-bubble__inner");d.$popupInner=e,d.$target=a;if(a.data("bubbleLoaded")===!0){a.trigger("taububbleloadcontent");return}e.find("div.ui-loading-message").remove(),e.append("<div class='ui-loading-message'>Loading...</div>"),d.createComponents(c,function(b){var f=b[0].component;f.on("afterRender",function(b){e.find(".ui-loading-message").remove();var c=b.data.element;c.appendTo(e),a.data("bubbleLoaded",!0),a.trigger("taububbleloadcontent"),b.removeListener(),a.tauBubble("adjustPosition"),a.tauBubble("adjustPositionStart"),a.tauBubble("adjustPosition"),a.bind("close",function(){f.fire("blur",{})}),a.bind("show",function(){f.fire("focus.before",{}),f.fire("focus",{}),f.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition")}),f.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition"),a.tauBubble("adjustPosition"),setTimeout(function(){f.fire("focus",{})},500)}),d.addContainer(f),f.initialize({store:c.store,context:c.context});var g=function(){a.data("bubbleLoaded",!1),a.tauBubble("empty")},h=function(){a.tauBubble("hide")},i=function(){a.tauBubble("destroy"),f.destroy()},j=function(){a.tauBubble("hide"),a.data("bubbleLoaded",!1),f.destroy()};f.on("beforeSave",g),f.on("beforeRemove",g),f.on("reset",h),f.on("afterSave",i),f.on("afterRemove",i),f.on("close",g)})},addContainer:function(a){this.containers.push(a)},destroyContainers:function(){var a=this.containers;_.each(a,function(a){a.destroy()}),this.containers=[]}})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn",["tau/core/templates-factory"],function(a){var b={name:"assignments-add-btn",markup:['<button class="add-btn',"{{if allowAdd == false}}"," disabled","{{/if}}",'" type="button"><div>AddAssignment</div></button>'].join(""),dependencies:[]};return a.register(b)}),define("tau/ui/templates/common/ui.template.userName",["tau/core/templates-factory"],function(a){return a.register({name:"user-name",markup:"<span class='user-name' role='username'>${name}</span><br/>"})}),define("tau/ui/templates/common/ui.template.user",["tau/core/templates-factory","tau/ui/templates/common/ui.template.userName"],function(a){return a.register({name:"user",markup:["<table class='user' role='user' userId='${id}'><tr>","<td class='user-avatar-container'>","{{if avatar}}<img src='${avatar}' class='user-avatar'/>{{/if}}","</td>","<td class='user-info'>","   {{tmpl 'user-name'}}","{{if role}}","<span class='user-role'>${role.name}</span>","{{/if}}","</td>","</tr></table>"].join(""),dependencies:["user-name"]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a){var b={name:"assignments-user-list",markup:['<div class="group" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>",'   <td class="role-effort">',"{{if roleEffort}}",'       <div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div>',"{{/if}}","   </td>",'   <td class="role-effort">',"{{if roleEffort}}",'       <div class="remain">${roleEffort.remain}<span class="point">${$item.effortPoints}</span></div>',"{{/if}}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','   <tr class="title">','       <td class="assignments-title"></td>','       <td class="effort title-cell">Effort</td>','       <td class="effort title-cell">Remain</td>',"    </tr>",'    <tr class="title-row">','       <td class="user-list" colspan="3">','               {{tmpl(assignments.groups, {effortPoints: effortPoints}) "assignments-user-list"}}',"       </td>","   </tr>",'   <tr class="head-row">',"       <td></td>","       <td></td>","       <td></td>","   </tr>","{{if tasksEffort}}",'   <tr class="tasks-row">','       <td class="task-title">Tasks</td>','       <td class="effort-cell">${tasksEffort.effort} h</td>','       <td class="effort-cell">${tasksEffort.remain} h</td>',"   </tr>","{{/if}}",'   <tr class="total-row">','       <td class="total-title">Total</td>','       <td class="effort-cell"><span>${totalEffort.effort} ${effortPoints}</span></td>','       <td class="effort-cell"><span>${totalEffort.remain} ${effortPoints}</span></td>',"   </tr>",'   <tr class="title-row" style="display: none;">','       <td class="owner title-cell">Owner</td>',"       <td></td>","   </tr>","</table>"].join(""),dependencies:["assignments-user-list","user"]};return a.register(b)}),define("tau/utils/utils.date/utils.date.formats",[],function(){var a={};return a={date:{"short":"d-MMM-yyyy"},time:{"short":"HH:mm"},datetime:{"short":"d-MMM-yyyy HH:mm"}},a}),define("tau/utils/utils.translation",["Underscore"],function(_){var a={pluralize:function(a,b){var c=_.isArray(a)?a:a.split("|"),d=function(a){return a===1?0:1},e=d(b);return c[e]?c[e]:c[0]}};return a}),Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a,b){return b||(b=2),("000"+a).slice(b*-1)};b.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},b.setTimeToNow=function(){var a=new Date;return this.setHours(a.getHours()),this.setMinutes(a.getMinutes()),this.setSeconds(a.getSeconds()),this.setMilliseconds(a.getMilliseconds()),this},a.today=function(){return(new Date).clearTime()},a.compare=function(a,b){if(isNaN(a)||isNaN(b))throw new Error(a+" - "+b);if(a instanceof Date&&b instanceof Date)return a<b?-1:a>b?1:0;throw new TypeError(a+" - "+b)},a.equals=function(a,b){return a.compareTo(b)===0},a.getDayNumberFromName=function(a){var b=c.dayNames,d=c.abbreviatedDayNames,e=c.shortestDayNames,f=a.toLowerCase();for(var g=0;g<b.length;g++)if(b[g].toLowerCase()==f||d[g].toLowerCase()==f||e[g].toLowerCase()==f)return g;return-1},a.getMonthNumberFromName=function(a){var b=c.monthNames,d=c.abbreviatedMonthNames,e=a.toLowerCase();for(var f=0;f<b.length;f++)if(b[f].toLowerCase()==e||d[f].toLowerCase()==e)return f;return-1},a.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},a.getDaysInMonth=function(b,c){return[31,a.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]},a.getTimezoneAbbreviation=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].offset===a)return b[e].name;return null},a.getTimezoneOffset=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].name===a.toUpperCase())return b[e].offset;return null},b.clone=function(){return new Date(this.getTime())},b.compareTo=function(a){return Date.compare(this,a)},b.equals=function(a){return Date.equals(this,a||new Date)},b.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()},b.isAfter=function(a){return this.compareTo(a||new Date)===1},b.isBefore=function(a){return this.compareTo(a||new Date)===-1},b.isToday=function(){return this.isSameDay(new Date)},b.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())},b.addMilliseconds=function(a){return this.setMilliseconds(this.getMilliseconds()+a),this},b.addSeconds=function(a){return this.addMilliseconds(a*1e3)},b.addMinutes=function(a){return this.addMilliseconds(a*6e4)},b.addHours=function(a){return this.addMilliseconds(a*36e5)},b.addDays=function(a){return this.setDate(this.getDate()+a),this},b.addWeeks=function(a){return this.addDays(a*7)},b.addMonths=function(b){var c=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+b),this.setDate(Math.min(c,a.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},b.addYears=function(a){return this.addMonths(a*12)},b.add=function(a){if(typeof a=="number")return this._orient=a,this;var b=a;return b.milliseconds&&this.addMilliseconds(b.milliseconds),b.seconds&&this.addSeconds(b.seconds),b.minutes&&this.addMinutes(b.minutes),b.hours&&this.addHours(b.hours),b.weeks&&this.addWeeks(b.weeks),b.months&&this.addMonths(b.months),b.years&&this.addYears(b.years),b.days&&this.addDays(b.days),this};var e,f,g;b.getWeek=function(){var a,b,c,d,h,i,j,k,l,m;return e=e?e:this.getFullYear(),f=f?f:this.getMonth()+1,g=g?g:this.getDate(),f<=2?(a=e-1,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=0,i=g-1+31*(f-1)):(a=e,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=l+1,i=g+(153*(f-3)+2)/5+58+l),j=(a+b)%7,d=(i+j-h)%7,k=i+3-d|0,k<0?m=53-((j-l)/5|0):k>364+l?m=1:m=(k/7|0)+1,e=f=g=null,m},b.getISOWeek=function(){return e=this.getUTCFullYear(),f=this.getUTCMonth()+1,g=this.getUTCDate(),d(this.getWeek())},b.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())},a._validate=function(a,b,c,d){if(typeof a=="undefined")return!1;if(typeof a!="number")throw new TypeError(a+" is not a Number.");if(a<b||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0},a.validateMillisecond=function(b){return a._validate(b,0,999,"millisecond")},a.validateSecond=function(b){return a._validate(b,0,59,"second")},a.validateMinute=function(b){return a._validate(b,0,59,"minute")},a.validateHour=function(b){return a._validate(b,0,23,"hour")},a.validateDay=function(b,c,d){return a._validate(b,1,a.getDaysInMonth(c,d),"day")},a.validateMonth=function(b){return a._validate(b,0,11,"month")},a.validateYear=function(b){return a._validate(b,0,9999,"year")},b.set=function(b){return a.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds()),a.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds()),a.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes()),a.validateHour(b.hour)&&this.addHours(b.hour-this.getHours()),a.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth()),a.validateYear(b.year)&&this.addYears(b.year-this.getFullYear()),a.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate()),b.timezone&&this.setTimezone(b.timezone),b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset),b.week&&a._validate(b.week,0,53,"week")&&this.setWeek(b.week),this},b.moveToFirstDayOfMonth=function(){return this.set({day:1})},b.moveToLastDayOfMonth=function(){return this.set({day:a.getDaysInMonth(this.getFullYear(),this.getMonth())})},b.moveToNthOccurrence=function(a,b){var c=0;if(b>0)c=b-1;else if(b===-1)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(c)},b.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(c===0?c+=7*(b||1):c)},b.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(c===0?c+=12*(b||1):c)},b.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},b.getTimezone=function(){return a.getTimezoneAbbreviation(this.getUTCOffset())},b.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=Number(a)*-6/10;return this.addMinutes(c-b)},b.setTimezone=function(b){return this.setTimezoneOffset(a.getTimezoneOffset(b))},b.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},b.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()},b.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;return a<0?(b=(a-1e4).toString(),b.charAt(0)+b.substr(2)):(b=(a+1e4).toString(),"+"+b.substr(1))},b.getElapsed=function(a){return(a||new Date)-this},b.toISOString||(b.toISOString=function(){function a(a){return a<10?"0"+a:a}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}),b._toString=b.toString,b.toString=function(a){var b=this;if(a&&a.length==1){var e=c.formatPatterns;b.t=b.toString;switch(a){case"d":return b.t(e.shortDate);case"D":return b.t(e.longDate);case"F":return b.t(e.fullDateTime);case"m":return b.t(e.monthDay);case"r":return b.t(e.rfc1123);case"s":return b.t(e.sortableDateTime);case"t":return b.t(e.shortTime);case"T":return b.t(e.longTime);case"u":return b.t(e.universalSortableDateTime);case"y":return b.t(e.yearMonth)}}var f=function(a){switch(a*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return a?a.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(a){if(a.charAt(0)==="\\")return a.replace("\\","");b.h=b.getHours;switch(a){case"hh":return d(b.h()<13?b.h()===0?12:b.h():b.h()-12);case"h":return b.h()<13?b.h()===0?12:b.h():b.h()-12;case"HH":return d(b.h());case"H":return b.h();case"mm":return d(b.getMinutes());case"m":return b.getMinutes();case"ss":return d(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return d(b.getFullYear(),4);case"yy":return d(b.getFullYear());case"dddd":return c.dayNames[b.getDay()];case"ddd":return c.abbreviatedDayNames[b.getDay()];case"dd":return d(b.getDate());case"d":return b.getDate();case"MMMM":return c.monthNames[b.getMonth()];case"MMM":return c.abbreviatedMonthNames[b.getMonth()];case"MM":return d(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.h()<12?c.amDesignator.substring(0,1):c.pmDesignator.substring(0,1);case"tt":return b.h()<12?c.amDesignator:c.pmDesignator;case"S":return f(b.getDate());default:return a}}):this._toString()}}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=Number.prototype;b._orient=1,b._nth=null,b._is=!1,b._same=!1,b._isSecond=!1,d._dateElement="day",b.next=function(){return this._orient=1,this},a.next=function(){return a.today().next()},b.last=b.prev=b.previous=function(){return this._orient=-1,this},a.last=a.prev=a.previous=function(){return a.today().last()},b.is=function(){return this._is=!0,this},b.same=function(){return this._same=!0,this._isSecond=!1,this},b.today=function(){return this.same().day()},b.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},b.at=function(b){return typeof b=="string"?a.parse(this.toString("d")+" "+b):this.set(b)},d.fromNow=d.after=function(a){var b={};return b[this._dateElement]=this,(a?a.clone():new Date).add(b)},d.ago=d.before=function(a){var b={};return b[this._dateElement]=this*-1,(a?a.clone():new Date).add(b)};var e="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),f="january february march april may june july august september october november december".split(/\s/),g="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),h="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),i="final first second third fourth fifth".split(/\s/),j;b.toObject=function(){var a={};for(var b=0;b<g.length;b++)a[g[b].toLowerCase()]=this["get"+h[b]]();return a},a.fromObject=function(a){return a.week=null,Date.today().set(a)};var k=function(b){return function(){if(this._is)return this._is=!1,this.getDay()==b;if(this._nth!==null){this._isSecond&&this.addSeconds(this._orient*-1),this._isSecond=!1;var c=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(b,c);if(this>d)throw new RangeError(a.getDayName(b)+" does not occur "+c+" times in the month of "+a.getMonthName(d.getMonth())+" "+d.getFullYear()+".");return this}return this.moveToDayOfWeek(b,this._orient)}},l=function(b){return function(){var d=a.today(),e=b-d.getDay();return b===0&&c.firstDayOfWeek===1&&d.getDay()!==0&&(e+=7),d.addDays(e)}};for(var m=0;m<e.length;m++)a[e[m].toUpperCase()]=a[e[m].toUpperCase().substring(0,3)]=m,a[e[m]]=a[e[m].substring(0,3)]=l(m),b[e[m]]=b[e[m].substring(0,3)]=k(m);var n=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},o=function(b){return function(){return a.today().set({month:b,day:1})}};for(var p=0;p<f.length;p++)a[f[p].toUpperCase()]=a[f[p].toUpperCase().substring(0,3)]=p,a[f[p]]=a[f[p].substring(0,3)]=o(p),b[f[p]]=b[f[p].substring(0,3)]=n(p);var q=function(a){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var b=this.toObject(),c=(arguments[0]||new Date).toObject(),d="",e=a.toLowerCase();for(var f=g.length-1;f>-1;f--){d=g[f].toLowerCase();if(b[d]!=c[d])return!1;if(e==d)break}return!0}return a.substring(a.length-1)!="s"&&(a+="s"),this["add"+a](this._orient)}},r=function(a){return function(){return this._dateElement=a,this}};for(var s=0;s<g.length;s++)j=g[s].toLowerCase(),b[j]=b[j+"s"]=q(g[s]),d[j]=d[j+"s"]=r(j);b._ss=q("Second");var t=function(a){return function(b){return this._same?this._ss(arguments[0]):b||b===0?this.moveToNthOccurrence(b,a):(this._nth=a,a!==2||b!==undefined&&b!==null?this:(this._isSecond=!0,this.addSeconds(this._orient)))}};for(var u=0;u<i.length;u++)b[i[u]]=u===0?t(-1):t(u)}(),function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var a=Date.Parsing,_=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(a){return function(a){return _.rtoken(new RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return _.rtoken(new RegExp("^"+a))},until:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1),c=[];for(var d=0;d<a.length;d++)c.push(_.each(a[d],b));return c},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(f){d=c[e]=f}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){var d=null;for(var e=0;e<b.length;e++){if(b[e]==null)continue;try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){var d=[],e=null;for(var f=0;f<b.length;f++){if(b[f]==null)continue;try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,_=_;return _.each(_.optional(a))},sequence:function(b,c,d){return c=c||_.rtoken(/^\s*/),d=d||null,b.length==1?b[0]:function(e){var f=null,g=null,h=[];for(var i=0;i<b.length;i++){try{f=b[i].call(this,e)}catch(j){break}h.push(f[0]);try{g=c.call(this,f[1])}catch(k){g=null;break}e=g[1]}if(!f)throw new a.Exception(e);if(g)throw new a.Exception(g[1]);if(d)try{f=d.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:e]}},between:function(a,b,c){c=c||a;var d=_.each(_.ignore(a),b,_.ignore(c));return function(a){var b=d.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,b,c){return b=b||_.rtoken(/^\s*/),c=c||null,a instanceof Array?_.each(_.product(a.slice(0,-1),_.ignore(b)),a.slice(-1),_.ignore(c)):_.each(_.many(_.each(a,_.ignore(b))),px,_.ignore(c))},set:function(b,c,d){return c=c||_.rtoken(/^\s*/),d=d||null,function(e){var f=null,g=null,h=null,i=null,j=[[],e],k=!1;for(var l=0;l<b.length;l++){h=null,g=null,f=null,k=b.length==1;try{f=b[l].call(this,e)}catch(m){continue}i=[[f[0]],f[1]];if(f[1].length>0&&!k)try{h=c.call(this,f[1])}catch(n){k=!0}else k=!0;!k&&h[1].length===0&&(k=!0);if(!k){var o=[];for(var p=0;p<b.length;p++)l!=p&&o.push(b[p]);g=_.set(o,c).call(this,h[1]),g[0].length>0&&(i[0]=i[0].concat(g[0]),i[1]=g[1])}i[1].length<j[1].length&&(j=i);if(j[1].length===0)break}if(j[0].length===0)return j;if(d){try{h=d.call(this,j[1])}catch(q){throw new a.Exception(j[1])}j[1]=h[1]}return j}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},b=function(a){return function(){var b=null,c=[];arguments.length>1?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(b=arguments[0]);if(!b)return a.apply(null,arguments);for(var d=0,e=b.shift();d<e.length;d++)return b.unshift(e[d]),c.push(a.apply(null,b)),b.shift(),c}},c="optional not ignore cache".split(/\s/);for(var d=0;d<c.length;d++)_[c[d]]=b(_[c[d]]);var e=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},f="each any all".split(/\s/);for(var g=0;g<f.length;g++)_[f[g]]=e(_[f[g]])}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a){var b=[];for(var c=0;c<a.length;c++)a[c]instanceof Array?b=b.concat(d(a[c])):a[c]&&b.push(a[c]);return b};a.Grammar={},a.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=a.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<c.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(b){b=b instanceof Array?b:[b];for(var c=0;c<b.length;c++)b[c]&&b[c].call(this);var d=new Date;(this.hour||this.minute)&&!this.month&&!this.year&&!this.day&&(this.day=d.getDate()),this.year||(this.year=d.getFullYear()),!this.month&&this.month!==0&&(this.month=d.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.day>a.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?e.set({timezone:this.timezone}):this.timezoneOffset&&e.set({timezoneOffset:this.timezoneOffset}),e},finish:function(b){b=b instanceof Array?d(b):[b];if(b.length===0)return null;for(var c=0;c<b.length;c++)typeof b[c]=="function"&&b[c].call(this);var e=a.today();if(this.now&&!this.unit&&!this.operator)return new Date;this.now&&(e=new Date);var f=!!(this.days&&this.days!==null||this.orient||this.operator),g,h,i;i=this.orient=="past"||this.operator=="subtract"?-1:1,!this.now&&"hour minute second".indexOf(this.unit)!=-1&&e.setTimeToNow(),(this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1&&(this.value=this.month+1,this.month=null,f=!0);if(!f&&this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),this.month||(this.month=j.getMonth()),this.year=j.getFullYear()}f&&this.weekday&&this.unit!="month"&&(this.unit="day",g=a.getDayNumberFromName(this.weekday)-e.getDay(),h=7,this.days=g?(g+i*h)%h:i*h),this.month&&this.unit=="day"&&this.operator&&(this.value=this.month+1,this.month=null),this.value!=null&&this.month!=null&&this.year!=null&&(this.day=this.value*1),this.month&&!this.day&&this.value&&(e.set({day:this.value*1}),f||(this.day=this.value*1)),!this.month&&this.value&&this.unit=="month"&&!this.now&&(this.month=this.value,f=!0),f&&(this.month||this.month===0)&&this.unit!="year"&&(this.unit="month",g=this.month-e.getMonth(),h=12,this.months=g?(g+i*h)%h:i*h,this.month=null),this.unit||(this.unit="day");if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*i;else if(this[this.unit+"s"]==null||this.operator!=null)this.value||(this.value=1),this[this.unit+"s"]=this.value*i;this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),j.getMonth()!==e.getMonth()&&(this.month=j.getMonth())}return(this.month||this.month===0)&&!this.day&&(this.day=1),!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month?Date.today().setWeek(this.value):(f&&this.timezone&&this.day&&this.days&&(this.day=this.days),f?e.add(this):e.set(this))}};var _=a.Parsing.Operators,e=a.Grammar,f=a.Translator,g;e.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/),e.timePartDelimiter=_.stoken(":"),e.whiteSpace=_.rtoken(/^\s*/),e.generalDelimiter=_.rtoken(/^(([\s\,]|at|@|on)+)/);var h={};e.ctoken=function(a){var b=h[a];if(!b){var d=c.regexPatterns,e=a.split(/\s+/),f=[];for(var g=0;g<e.length;g++)f.push(_.replace(_.rtoken(d[e[g]]),e[g]));b=h[a]=_.any.apply(null,f)}return b},e.ctoken2=function(a){return _.rtoken(c.regexPatterns[a])},e.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),f.hour)),e.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),f.hour)),e.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),f.hour)),e.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),f.hour)),e.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),f.minute)),e.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),f.minute)),e.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),f.second)),e.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),f.second)),e.hms=_.cache(_.sequence([e.H,e.m,e.s],e.timePartDelimiter)),e.t=_.cache(_.process(e.ctoken2("shortMeridian"),f.meridian)),e.tt=_.cache(_.process(e.ctoken2("longMeridian"),f.meridian)),e.z=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),f.timezone)),e.zz=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),f.timezone)),e.zzz=_.cache(_.process(e.ctoken2("timezone"),f.timezone)),e.timeSuffix=_.each(_.ignore(e.whiteSpace),_.set([e.tt,e.zzz])),e.time=_.each(_.optional(_.ignore(_.stoken("T"))),e.hms,e.timeSuffix),e.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(e.ctoken2("ordinalSuffix"))),f.day)),e.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(e.ctoken2("ordinalSuffix"))),f.day)),e.ddd=e.dddd=_.cache(_.process(e.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),e.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),f.month)),e.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/),f.month)),e.MMM=e.MMMM=_.cache(_.process(e.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),f.month)),e.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),f.year)),e.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),f.year)),e.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),f.year)),e.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),f.year)),g=function(){return _.each(_.any.apply(null,arguments),_.not(e.ctoken2("timeContext")))},e.day=g(e.d,e.dd),e.month=g(e.M,e.MMM),e.year=g(e.yyyy,e.yy),e.orientation=_.process(e.ctoken("past future"),function(a){return function(){this.orient=a}}),e.operator=_.process(e.ctoken("add subtract"),function(a){return function(){this.operator=a}}),e.rday=_.process(e.ctoken("yesterday tomorrow today now"),f.rday),e.unit=_.process(e.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}}),e.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),e.expression=_.set([e.rday,e.operator,e.value,e.unit,e.orientation,e.ddd,e.MMM]),g=function(){return _.set(arguments,e.datePartDelimiter)},e.mdy=g(e.ddd,e.month,e.day,e.year),e.ymd=g(e.ddd,e.year,e.month,e.day),e.dmy=g(e.ddd,e.day,e.month,e.year),e.date=function(a){return(e[c.dateElementOrder]||e.mdy).call(this,a)},e.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(e[b])return e[b];throw a.Parsing.Exception(b)}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(a){return _.ignore(_.stoken(a))}))),function(a){return _.process(_.each.apply(null,a),f.finishExact)});var i={},j=function(a){return i[a]=i[a]||e.format(a)[0]};e.formats=function(a){if(a instanceof Array){var b=[];for(var c=0;c<a.length;c++)b.push(j(a[c]));return _.any.apply(null,b)}return j(a)},e._formats=e.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),e._start=_.process(_.set([e.date,e.time,e.expression],e.generalDelimiter,e.whiteSpace),f.finish),e.start=function(a){try{var b=e._formats.call({},a);if(b[1].length===0)return b}catch(c){}return e._start.call({},a)},a._parse=a.parse,a.parse=function(b){var c=null;if(!b)return null;if(b instanceof Date)return b;try{c=a.Grammar.start.call({},b.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(d){return null}return c[1].length===0?c[0]:null},a.getParseFunction=function(b){var c=a.Grammar.formats(b);return function(a){var b=null;try{b=c.call({},a)}catch(d){return null}return b[1].length===0?b[0]:null}},a.parseExact=function(b,c){return a.getParseFunction(c)(b)}}(),define("libs/date.js/build/date",function(){}),TimeSpan=function(a,b){this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0;var c=a<0?-1:1;return this.milliseconds=Math.abs(a),b=b||Math.floor,this.days=b(this.milliseconds/864e5)*c,this.milliseconds=this.milliseconds%864e5,this.hours=b(this.milliseconds/36e5)*c,this.milliseconds=this.milliseconds%36e5,this.minutes=b(this.milliseconds/6e4)*c,this.milliseconds=this.milliseconds%6e4,this.seconds=b(this.milliseconds/1e3)*c,this.milliseconds=this.milliseconds%1e3,this.milliseconds=this.milliseconds*c,this},TimeSpan.prototype.compare=function(a){var b=new Date(1970,1,1,this.hours(),this.minutes(),this.seconds()),c;return a===null?c=new Date(1970,1,1,0,0,0):c=new Date(1970,1,1,a.hours(),a.minutes(),a.seconds()),b>c?1:b<c?-1:0},TimeSpan.prototype.add=function(a){return a===null?this:this.addSeconds(a.getTotalMilliseconds()/1e3)},TimeSpan.prototype.subtract=function(a){return a===null?this:this.addSeconds(-a.getTotalMilliseconds()/1e3)},TimeSpan.prototype.addDays=function(a){return new TimeSpan(this.getTotalMilliseconds()+a*24*60*60*1e3)},TimeSpan.prototype.addHours=function(a){return new TimeSpan(this.getTotalMilliseconds()+a*60*60*1e3)},TimeSpan.prototype.addMinutes=function(a){return new TimeSpan(this.getTotalMilliseconds()+a*60*1e3)},TimeSpan.prototype.addSeconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+a*1e3)},TimeSpan.prototype.addMilliseconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+a)},TimeSpan.prototype.getTotalMilliseconds=function(){return this.days()*864e5+this.hours()*36e5+this.minutes()*6e4+this.seconds()*1e3},TimeSpan.prototype.get12HourHour=function(){return(h=this.hours()%12)?h:12},TimeSpan.prototype.getDesignator=function(){return this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator},TimeSpan.prototype.toString=function(a){function b(){return this.days()!==null&&this.days()>0?this.days()+"."+this.hours()+":"+c(this.minutes())+":"+c(this.seconds()):this.hours()+":"+c(this.minutes())+":"+c(this.seconds())}function c(a){return a.toString().length<2?"0"+a:a}var d=this;return a?a.replace(/d|dd|HH|H|hh|h|mm|m|ss|s|tt|t/g,function(a){switch(a){case"d":return d.days();case"dd":return c(d.days());case"H":return d.hours();case"HH":return c(d.hours());case"h":return d.get12HourHour();case"hh":return c(d.get12HourHour());case"m":return d.minutes();case"mm":return c(d.minutes());case"s":return d.seconds();case"ss":return c(d.seconds());case"t":return(this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return this.hours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()};var TimePeriod=function(a,b,c){this.years=0,this.months=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0;var d=a.clone(),e=b.clone(),f=d.clone(),g=d>e?-1:1;this.years=e.getFullYear()-d.getFullYear(),f.addYears(this.years),g==+1?f>e&&this.years!==0&&this.years--:f<e&&this.years!==0&&this.years++,d.addYears(this.years);if(g==+1)while(d<e&&d.clone().addDays(d.getDaysInMonth())<=e)d.addMonths(1),this.months++;else while(d>e&&d.clone().addDays(-d.getDaysInMonth())>=e)d.addMonths(-1),this.months--;var h=e-d;if(h!==0){var i=new TimeSpan(h,c);this.days=i.days,this.hours=i.hours,this.minutes=i.minutes,this.seconds=i.seconds,this.milliseconds=i.milliseconds}return this.years>=1&&(this.months>0||this.days>0)&&(this.years+=1),this.months>=1&&this.months<11&&this.days>0&&(this.months+=1),this};define("libs/date.js/build/time.special",function(){}),define("tau/models/model.attachments.editable",["Underscore","tau/core/model.editable.base"],function(_,a){return a.extend({category:"edit",name:"Editable attachment","bus dataBind":function(a){this.bus.fire("permissionsReady",{editable:!0,deletable:!0}),this._attachments||(this._attachments=a.data.items)},"bus attachmentUploaded":function(a){this._addAttachment(a.data.data)},onInit:function(){var a=this;this.store.on({eventName:"afterRemove",listener:a,type:"attachment"},function(b){var c=parseInt(b.data.cmd.config.id);a._isValidAttachmentId(c)&&(a._removeAttachment(c),a.bus.fire("afterAttachmentRemove",{id:c}))})},_addAttachment:function(a){this._attachments.push(a)},_removeAttachment:function(a){this._attachments=_.reject(this._attachments,function(b){return a===b.id})},_isValidAttachmentId:function(a){return _.any(this._attachments,function(b){return b.id===a})}})}),function(a){typeof define=="function"&&define.amd?define("libs/jquery/jquery.iframe-transport",["jQuery"],a):a(window.jQuery)}(function($){var a=0;$.ajaxTransport("iframe",function(b){if(b.async&&(b.type==="POST"||b.type==="GET")){var c,d;return{send:function(_,e){c=$('<form style="display:none;"></form>'),d=$('<iframe src="javascript:false;" name="iframe-transport-'+(a+=1)+'"></iframe>').bind("load",function(){var a;d.unbind("load").bind("load",function(){var a;try{a=d.contents();if(!a.length||!a[0].firstChild)throw new Error}catch(b){a=undefined}e(200,"success",{iframe:a}),$('<iframe src="javascript:false;"></iframe>').appendTo(c),c.remove()}),c.prop("target",d.prop("name")).prop("action",b.url).prop("method",b.type),b.formData&&$.each(b.formData,function(a,b){$('<input type="hidden"/>').prop("name",b.name).val(b.value).appendTo(c)}),b.fileInput&&b.fileInput.length&&b.type==="POST"&&(a=b.fileInput.clone(),b.fileInput.after(function(b){return a[b]}),b.paramName&&b.fileInput.each(function(){$(this).prop("name",b.paramName)}),c.append(b.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),c.submit(),a&&a.length&&b.fileInput.each(function(b,c){var d=$(a[b]);$(c).prop("name",d.prop("name")),d.replaceWith(c)})}),c.append(d).appendTo(document.body)},abort:function(){d&&d.unbind("load").prop("src","javascript".concat(":false;")),c&&c.remove()}}}}),$.ajaxSetup({converters:{"iframe text":function(a){return $(a[0].body).text()},"iframe json":function(a){return $.parseJSON($(a[0].body).text())},"iframe html":function(a){return $(a[0].body).html()},"iframe script":function(a){return $.globalEval($(a[0].body).text())}}})}),function(a){typeof define=="function"&&define.amd?define("libs/jquery/jquery.fileupload",["jQuery","./jquery.iframe-transport"],a):a(window.jQuery)}(function($){$.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:$(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,formData:function(a){return a.serializeArray()},add:function(a,b){b.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","dropZone","fileInput"],_isXHRUpload:function(a){var b="undefined";return!a.forceIframeTransport&&typeof XMLHttpRequestUpload!==b&&typeof File!==b&&(!a.multipart||typeof FormData!==b)},_getFormData:function(a){var b;return typeof a.formData=="function"?a.formData(a.form):$.isArray(a.formData)?a.formData:a.formData?(b=[],$.each(a.formData,function(a,c){b.push({name:a,value:c})}),b):[]},_getTotal:function(a){var b=0;return $.each(a,function(a,c){b+=c.size||1}),b},_onProgress:function(a,b){if(a.lengthComputable){var c=b.total||this._getTotal(b.files),d=parseInt(a.loaded/a.total*(b.chunkSize||c),10)+(b.uploadedBytes||0);this._loaded+=d-(b.loaded||b.uploadedBytes||0),b.lengthComputable=!0,b.loaded=d,b.total=c,this._trigger("progress",a,b),this._trigger("progressall",a,{lengthComputable:!0,loaded:this._loaded,total:this._total})}},_initProgressListener:function(a){var b=this,c=a.xhr?a.xhr():$.ajaxSettings.xhr();c.upload&&($(c.upload).bind("progress",function(c){var d=c.originalEvent;c.lengthComputable=d.lengthComputable,c.loaded=d.loaded,c.total=d.total,b._onProgress(c,a)}),a.xhr=function(){return c})},_initXHRData:function(a){var b,c=a.files[0];if(!a.multipart||a.blob)a.headers=$.extend(a.headers,{"X-File-Name":c.name,"X-File-Type":c.type,"X-File-Size":c.size}),a.blob?a.multipart||(a.contentType="application/octet-stream",a.data=a.blob):(a.contentType=c.type,a.data=c);a.multipart&&typeof FormData!="undefined"&&(a.postMessage?(b=this._getFormData(a),a.blob?b.push({name:a.paramName,value:a.blob}):$.each(a.files,function(c,d){b.push({name:a.paramName,value:d})})):(a.formData instanceof FormData?b=a.formData:(b=new FormData,$.each(this._getFormData(a),function(a,c){b.append(c.name,c.value)})),a.blob?b.append(a.paramName,a.blob):$.each(a.files,function(c,d){d instanceof Blob&&b.append(a.paramName,d)})),a.data=b),a.blob=null},_initIframeSettings:function(a){a.dataType="iframe "+(a.dataType||""),a.formData=this._getFormData(a)},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a,"iframe")},_initFormSettings:function(a){if(!a.form||!a.form.length)a.form=$(a.fileInput.prop("form"));a.paramName||(a.paramName=a.fileInput.prop("name")||"files[]"),a.url||(a.url=a.form.prop("action")||location.href),a.type=(a.type||a.form.prop("method")||"").toUpperCase(),a.type!=="POST"&&a.type!=="PUT"&&(a.type="POST")},_getAJAXSettings:function(a){var b=$.extend({},this.options,a);return this._initFormSettings(b),this._initDataSettings(b),b},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(a,b,c){var d=$.Deferred(),e=d.promise();return b=b||this.options.context||e,a===!0?d.resolveWith(b,c):a===!1&&d.rejectWith(b,c),e.abort=d.promise,this._enhancePromise(e)},_chunkedUpload:function(a,b){var c=this,d=a.files[0],e=d.size,f=a.uploadedBytes=a.uploadedBytes||0,g=a.maxChunkSize||e,h=d.webkitSlice||d.mozSlice||d.slice,i,j,k,l;return!(this._isXHRUpload(a)&&h&&(f||g<e))||a.data?!1:b?!0:f>=e?(d.error="uploadedBytes",this._getXHRPromise(!1,a.context,[null,"error",d.error])):(j=Math.ceil((e-f)/g),i=function(b){return b?i(b-=1).pipe(function(){var e=$.extend({},a);return e.blob=h.call(d,f+b*g,f+(b+1)*g),e.chunkSize=e.blob.size,c._initXHRData(e),c._initProgressListener(e),k=($.ajax(e)||c._getXHRPromise(!1,e.context)).done(function(){e.loaded||c._onProgress($.Event("progress",{lengthComputable:!0,loaded:e.chunkSize,total:e.chunkSize}),e),a.uploadedBytes=e.uploadedBytes+=e.chunkSize}),k}):c._getXHRPromise(!0,a.context)},l=i(j),l.abort=function(){return k.abort()},this._enhancePromise(l))},_beforeSend:function(a,b){this._active===0&&this._trigger("start"),this._active+=1,this._loaded+=b.uploadedBytes||0,this._total+=this._getTotal(b.files)},_onDone:function(a,b,c,d){this._isXHRUpload(d)||this._onProgress($.Event("progress",{lengthComputable:!0,loaded:1,total:1}),d),d.result=a,d.textStatus=b,d.jqXHR=c,this._trigger("done",null,d)},_onFail:function(a,b,c,d){d.jqXHR=a,d.textStatus=b,d.errorThrown=c,this._trigger("fail",null,d),d.recalculateProgress&&(this._loaded-=d.loaded||d.uploadedBytes||0,this._total-=d.total||this._getTotal(d.files))},_onAlways:function(a,b,c,d){this._active-=1,d.textStatus=b,c&&c.always?(d.jqXHR=c,d.result=a):(d.jqXHR=a,d.errorThrown=c),this._trigger("always",null,d),this._active===0&&(this._trigger("stop"),this._loaded=this._total=0)},_onSend:function(a,b){var c=this,d,e,f,g=c._getAJAXSettings(b),h=function(b,e){return c._sending+=1,d=d||(b!==!1&&c._trigger("send",a,g)!==!1&&(c._chunkedUpload(g)||$.ajax(g))||c._getXHRPromise(!1,g.context,e)).done(function(a,b,d){c._onDone(a,b,d,g)}).fail(function(a,b,d){c._onFail(a,b,d,g)}).always(function(a,b,d){c._sending-=1,c._onAlways(a,b,d,g);if(g.limitConcurrentUploads&&g.limitConcurrentUploads>c._sending){var e=c._slots.shift();while(e){if(!e.isRejected()){e.resolve();break}e=c._slots.shift()}}}),d};return this._beforeSend(a,g),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(e=$.Deferred(),this._slots.push(e),f=e.pipe(h)):f=this._sequence=this._sequence.pipe(h,h),f.abort=function(){var a=[undefined,"abort","abort"];return d?d.abort():(e&&e.rejectWith(a),h(!1,a))},this._enhancePromise(f)):h()},_onAdd:function(a,b){var c=this,d=!0,e=$.extend({},this.options,b),f=e.limitMultiFileUploads,g,h;if(!e.singleFileUploads&&!f||!this._isXHRUpload(e))g=[b.files];else if(!e.singleFileUploads&&f){g=[];for(h=0;h<b.files.length;h+=f)g.push(b.files.slice(h,h+f))}return b.originalFiles=b.files,$.each(g||b.files,function(e,f){var h=g?f:[f],i=$.extend({},b,{files:h});return i.submit=function(){return i.jqXHR=this.jqXHR=c._trigger("submit",a,this)!==!1&&c._onSend(a,this),this.jqXHR},d=c._trigger("add",a,i)}),d},_normalizeFile:function(a,b){b.name===undefined&&b.size===undefined&&(b.name=b.fileName,b.size=b.fileSize)},_replaceFileInput:function(a){var b=a.clone(!0);$("<form></form>").append(b)[0].reset(),a.after(b).detach(),$.cleanData(a.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(c,d){return d===a[0]?b[0]:d}),a[0]===this.element[0]&&(this.element=b)},_onChange:function(a){var b=a.data.fileupload,c={files:$.each($.makeArray(a.target.files),b._normalizeFile),fileInput:$(a.target),form:$(a.target.form)};c.files.length||(c.files=[{name:a.target.value.replace(/^.*\\/,"")}]),b.options.replaceFileInput&&b._replaceFileInput(c.fileInput);if(b._trigger("change",a,c)===!1||b._onAdd(a,c)===!1)return!1},_onPaste:function(a){var b=a.data.fileupload,c=a.originalEvent.clipboardData,d=c&&c.items||[],e={files:[]};$.each(d,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&e.files.push(c)});if(b._trigger("paste",a,e)===!1||b._onAdd(a,e)===!1)return!1},_onDrop:function(a){var b=a.data.fileupload,c=a.dataTransfer=a.originalEvent.dataTransfer,d={files:$.each($.makeArray(c&&c.files),b._normalizeFile)};if(b._trigger("drop",a,d)===!1||b._onAdd(a,d)===!1)return!1;a.preventDefault()},_onDragOver:function(a){var b=a.data.fileupload,c=a.dataTransfer=a.originalEvent.dataTransfer;if(b._trigger("dragover",a)===!1)return!1;c&&(c.dropEffect=c.effectAllowed="copy"),a.preventDefault()},_initEventHandlers:function(){var a=this.options.namespace;this.options.dropZone.bind("dragover."+a,{fileupload:this},this._onDragOver).bind("drop."+a,{fileupload:this},this._onDrop).bind("paste."+a,{fileupload:this},this._onPaste),this.options.fileInput.bind("change."+a,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var a=this.options.namespace;this.options.dropZone.unbind("dragover."+a,this._onDragOver).unbind("drop."+a,this._onDrop).unbind("paste."+a,this._onPaste),this.options.fileInput.unbind("change."+a,this._onChange)},_beforeSetOption:function(a,b){this._destroyEventHandlers()},_afterSetOption:function(a,b){var c=this.options;c.fileInput||(c.fileInput=$()),c.dropZone||(c.dropZone=$()),this._initEventHandlers()},_setOption:function(a,b){var c=$.inArray(a,this._refreshOptionsList)!==-1;c&&this._beforeSetOption(a,b),$.Widget.prototype._setOption.call(this,a,b),c&&this._afterSetOption(a,b)},_create:function(){var a=this.options;a.namespace=a.namespace||this.widgetName,a.fileInput===undefined?a.fileInput=this.element.is("input:file")?this.element:this.element.find("input:file"):a.fileInput||(a.fileInput=$()),a.dropZone||(a.dropZone=$()),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},destroy:function(){this._destroyEventHandlers(),$.Widget.prototype.destroy.call(this)},enable:function(){$.Widget.prototype.enable.call(this),this._initEventHandlers()},disable:function(){this._destroyEventHandlers(),$.Widget.prototype.disable.call(this)},add:function(a){if(!a||this.options.disabled)return;a.files=$.each($.makeArray(a.files),this._normalizeFile),this._onAdd(null,a)},send:function(a){if(a&&!this.options.disabled){a.files=$.each($.makeArray(a.files),this._normalizeFile);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})}),define("tau/components/extensions/attachments/component.attachments.selectable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element;b.delegate("[role=attachment]","click",$.proxy(this,"_onAttachmentClick"))},_onAttachmentClick:function(a){var b=$(a.target),c=b.closest(".toolbar").size()!=0;if(!c){a.preventDefault();var d=b.closest(".ui-attach");this.bus.fire("attachmentSelected",{attachment:d.data().tmplItem.data,index:d.index()})}}})}),define("tau/components/extensions/attachments/component.attachments.showPreview",["Underscore","tau/components/extensions/component.creator.extension"],function(_,a){var b=a.extend({"bus initialize":function(a){var b=a.data.context,c=b.assignable;this.contextForPreview={applicationContext:b.applicationContext};var d={entityType:c.entityType,id:c.id};_(this.contextForPreview).extend({assignable:d,general:d,entity:d})},"bus attachmentSelected":function(a){var b=a.data.attachment;b.mimeType=b.mimeType||"";if(b.mimeType.indexOf("image/")==0){var c={components:[{type:"attachmentsPreview",selected:{id:b.id}}],context:this.contextForPreview};this.createComponents(c,function(a){var b=a[0],c=b.component;c.on("afterRender",function(a){a.removeListener(),a.data.element.appendTo($("body"))}),c.fire("initialize")})}else window.location.assign(b.uri)}});return b}),define("tau/components/extensions/attachments/component.attachments.thumbProxy",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element.find(".ui-attach .preview img");b.each(function(){var a=$(this);if(!a.prop("complete")){var b=a.parent();b.addClass("loading"),a.load(function(){b.removeClass("loading")})}})}})}),define("tau/components/extensions/attachments/component.attachments.deletable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus permissionsReady+afterRender":function(a){this.$element=a.afterRender.data.element;var b=a.permissionsReady.data;b.deletable&&this._createDeleteTriggers()},"bus attachmentUploaded":function(a){this._createDeleteTriggers()},"bus afterAttachmentRemove":function(a){var b=this,c=a.data.id,d=this.$element.find("#attach-"+c);this.bus.fire("deleteElement",{element:d,callback:function(){$(this).remove()}})},_getDeleteTriggerProto:function(){return this._deleteTriggerProto||(this._deleteTriggerProto=$('<button class="delete" type="button">delete</button>').click($.proxy(this,"_onAttachmentDelete"))),this._deleteTriggerProto},_createDeleteTriggers:function(){var a=this;this.$element.find(".ui-attach:not(.deletable)").each(function(b,c){$(c).addClass("deletable").find(".toolbar").append(a._getDeleteTriggerProto().clone(!0))})},_onAttachmentDelete:function(a){var b=this._findUpConfirmationPlaceholder($(a.target));b.data("confirmation")||this._createConfirmation(b),this._showConfirmation(b)},_findUpConfirmationPlaceholder:function(a){return a.closest(".ui-attach").children(".inner")},_findUpAttachElement:function(a){return a.closest(".ui-attach")},_createConfirmation:function(a){a.confirmation({message:"Delete attachment?",ok:$.proxy(this,"_deleteAttachment"),cancel:$.proxy(this,"_cancelAttachmentDelete")})},_showConfirmation:function(a){a.confirmation("show")},_hideConfirmation:function(a){a.confirmation("hide")},_deleteAttachment:function(a){var b=$(a.target);this._hideConfirmation(this._findUpConfirmationPlaceholder(b));var c=this._findUpAttachElement(b);this.bus.fire("markElementToBeDeleted",{element:c}),this.bus.fire("remove",{id:c.attr("id").replace(/[^\d]/g,""),typeName:"attachment"})},_cancelAttachmentDelete:function(a){this._hideConfirmation(this._findUpConfirmationPlaceholder($(a.target)))}})}),define("tau/ui/templates/attachments/ui.template.attachments.attachment",["tau/core/tau","tau/core/templates-factory"],function(a,b){var c={name:"attachments-attachment",markup:a.concat('<div id="attach-${id}" class="ui-attach">','<div class="inner" role="attachment">','<a class="preview" href="${uri}">','<img src="${thumbnailUri}" />',"</a>",'<p class="name">${name}</p>','<p class="owner">by ${ownerName}</p>','<p class="date">on ${date}</p>','<p class="toolbar">','<a class="download" href="${uri}" target="_blank">download</a>',"</p>","</div>","</div>")};return b.register(c)}),define("tau/ui/templates/attachments/ui.template.attachments",["tau/core/templates-factory","tau/ui/templates/attachments/ui.template.attachments.attachment"],function(a){var b={name:"attachments",options:{contentSelector:".ui-attachments-content"},dependencies:["attachments-attachment"],markup:['<div class="box ui-attachments-control">','   <div class="ui-attachments-content">','       {{tmpl(items) "attachments-attachment"}}',"   </div>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.attachmentThumbnail",["tau/core/templates-factory"],function(a){var b={name:"attachments-preview-attachment-thumbnail",markup:["<li>",'   <img class="ui-attach-thumbnail{{if selected}} selected{{/if}}" src="${thumbnailUri}"   />',"</li>"].join("")};return a.register(b)}),define("tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview",["tau/core/templates-factory","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview.attachmentThumbnail"],function(a){var b={name:"attachments-preview",markup:['<div class="ui-attachments-preview-control">','<div class="toolbar">','<button class="close" type="button">X</button>','<button class="prev" type="button">&larr;</button>','<button class="next" type="button">&rarr;</button>',"</div>",'   <div class="swap-view">','    <div class="image-view">','       <div class="ui-attachment-wait"></div>','       <img class="ui-attachment-view-image" src="${selected.uri}">',"    </div>","   </div>",'   <ul class="thumbnail-nav">','       {{tmpl(items) "attachments-preview-attachment-thumbnail"}}',"   </ul>","</div>"].join(""),dependencies:["attachments-preview-attachment-thumbnail"]};return a.register(b)}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=this;b.element=a.data.element,$(window).bind("resize",function(){b._resizeImage()});var c=b.element.find(".ui-attachment-wait"),d=b.element.find(".ui-attachment-view-image");d.hide(),c.show(),this.element.find(".ui-attachment-view-image").bind("load",function(){b._onImageLoad()});var e=function(){$(this).parent().removeClass("ui-thumbnail-loading"),$(this).unbind("load",e),$(this).fadeIn("slow")};this.element.find(".thumbnail-nav li").addClass("ui-thumbnail-loading"),this.element.find(".thumbnail-nav li > img").each(function(){this.complete?e.call(this):$(this).bind("load",e).hide()})},_onImageLoad:function(){var a=this,b=a.element.find(".ui-attachment-wait"),c=a.element.find(".ui-attachment-view-image");a._resizeImage(),c.fadeIn("slow",function(){b.hide()})},_resizeImage:function(){var a=this,b=a.element;if(!b)return;var c=a.element.find(".ui-attachment-wait"),d=a.element.find(".ui-attachment-view-image"),e=b.find(".image-view");d.width(""),d.height("");var f=e.width(),g=e.height(),h=d.width(),i=d.height();if(h>f||i>g){var j=g/i*h,k=f/h*i;j<f?(d.width(j),d.height(g)):(d.width(f),d.height(k))}return{$wait:c,$image:d}},"bus beforeChangeImage":function(a){var b=this,c=b.element.find(".ui-attachment-wait"),d=b.element.find(".ui-attachment-view-image");c.show();var e=a.data;d.fadeOut("slow",function(){d.attr("src",e)}),a.data=!1}})}),define("tau/models/model.label",["Underscore","tau/core/model-base"],function(_,a){var b=function(a,b){},c=a.extend({onInit:function(){this.store.unbind(this);var a={text:this.config.text};this.config.cssClass&&(a.cssClass=this.config.cssClass),this.bus.fire("dataBind",a);var b=this.config.getBadgeText;typeof b=="function"&&(this.fire("beforeGetBadgeText",{prevValue:this.badgeText}),b.call(this,{callback:this.onBadgeTextRetrieved,scope:this}));var c=this.getCollectionFileds();if(_.isArray(c)&&c.length>0){var d=this.config.context.entity.id,e=this.config.context.entity.entityType.name||"general",f=c.join("|");this.config.store.on({type:e,eventName:"afterSave",hasChanges:[f],filter:{id:d},listener:this},_.bind(this.onEntityChanged,this)),this.calculateCount()}},onEntityChanged:function(){var a=this.config.context.entity.id,b=this.config.context.entity.entityType.name||"general";this.config.store.evictProperties(a,b,_.map(this.getCollectionFileds(),function(a){return a+"-count"})),this.calculateCount()},calculateCount:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=[],e=this.config.countFieldNames;for(var f=0;f<e.length;f++)d.push(e[f]+"-count");var g={id:b.entity.id,fields:d};a.store.get(c,g,{success:this.countersRetreived,scope:this}).done()},getCollectionFileds:function(){var a=_.reject(this.config.countFieldNames,function(a){return a=="id"});return a},countersRetreived:function(a){var b=this.getCollectionFileds(),c=a.data,d=0;for(var e=0;e<b.length;e++)d+=c[b[e]+"-count"];this.fire("setBadgeText",{text:d})},onBadgeTextRetrieved:function(a){var b=a[this.config.badgeFieldName];this.badgeText=b,this.bus?this.bus.fire("setBadgeText",{text:b}):this.fire("badgeTextChanged",{text:b})}});return c}),define("tau/ui/templates/auditHistory/ui.template.auditHistory",["tau/core/templates-factory"],function(a){var b={name:"audit-history",markup:['<div class="tau-audit-history-placeholder"><span class="ui-empty-data-msg">loading history...</span></div>'],dependencies:[]};return a.register(b)}),define("tau/components/extensions/board.container/extension.board.container",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus boardSettings.ready+componentsCreated":function(a){var b=a["boardSettings.ready"].data,c=b.boardSettings,d=a.componentsCreated.data,e=d.length;for(var f=0;f<e;f++){var g=d[f].component;g.fire("boardSettings.ready",{boardSettings:c})}},"bus boardSettings.ready+destroy":function(a){var b=a["boardSettings.ready"].data,c=b.boardSettings;c.dispose()}})}),define("tau/models/model.board.grid",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus afterInit":function(a){this.fire("dataBind",{data:[1,2,3]})},"bus afterRender":function(a){this.fire("component.ready",a.data)}});return b}),define("tau/ui/templates/board.grid/ui.template.board.grid",["tau/core/templates-factory"],function(a){var b={name:"board.grid",markup:["<div>BOAAARRDD</div>"],dependencies:[]};return a.register(b)}),define("tau/models/model.board.header",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus afterInit":function(a){this.fire("dataBind",{})}});return b}),define("tau/ui/templates/board.header/ui.template.board.header",["tau/core/templates-factory"],function(a){var b={name:"board.header",markup:['<img style="float: left; position: relative; top: 50%; margin: -16px 0 0 1em;" src="../JavaScript/tau/css.board/prototypes/_master/img/mock-header-left.png">','<img style="float: right; position: relative; top: 50%; margin: -15px 1em 0 0;" src="../JavaScript/tau/css.board/prototypes/_master/img/mock-header-right.png">'],dependencies:[]};return a.register(b)}),define("tau/models/model.board.overview",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus boardSettings.ready":function(a){var b=a.data.boardSettings,c=this;b.bind({fields:["focus"],listener:c,callback:function(a){c.fire("output.changed",{})}}),b.bind({fields:["collapse"],callback:function(a){c.fire("output.changed",{})}}),b.bind({fields:["zoomLevel"],callback:function(a){c.fire("output.changed",{})}})},"bus afterInit":function(a){this.fire("dataBind",{})}});return b}),function(){function e(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function g(a){var b=-1,c=a.length,d=[];while(++b<c)d.push(a[b]);return d}function h(a){return Array.prototype.slice.call(a)}function k(){}function n(){return this}function o(a,b,c){return function(){var d=c.apply(b,arguments);return arguments.length?a:d}}function p(a){return a!=null&&!isNaN(a)}function q(a){return a.length}function s(a){return a==null}function t(a){return a.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," ")}function u(a){var b=1;while(a*b%1)b*=10;return b}function x(){}function y(a){function d(){var c=b,d=-1,e=c.length,f;while(++d<e)(f=c[d].on)&&f.apply(this,arguments);return a}var b=[],c=new k;return d.on=function(d,e){var f=c.get(d),g;return arguments.length<2?f&&f.on:(f&&(f.on=null,b=b.slice(0,g=b.indexOf(f)).concat(b.slice(g+1)),c.remove(d)),e&&b.push(c.set(d,{on:e})),a)},d}function B(a,b){return b-(a?1+Math.floor(Math.log(a+Math.pow(10,1+Math.floor(Math.log(a)/Math.LN10)-b))/Math.LN10):1)}function C(a){return a+""}function D(a){var b=a.lastIndexOf("."),c=b>=0?a.substring(b):(b=a.length,""),d=[];while(b>0)d.push(a.substring(b-=3,b+3));return d.reverse().join(",")+c}function F(a,b){return{scale:Math.pow(10,(8-b)*3),symbol:a}}function L(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function M(a){return function(b){return 1-a(1-b)}}function N(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function O(a){return a}function P(a){return function(b){return Math.pow(b,a)}}function Q(a){return 1-Math.cos(a*Math.PI/2)}function R(a){return Math.pow(2,10*(a-1))}function S(a){return 1-Math.sqrt(1-a*a)}function T(a,b){var c;return arguments.length<2&&(b=.45),arguments.length<1?(a=1,c=b/4):c=b/(2*Math.PI)*Math.asin(1/a),function(d){return 1+a*Math.pow(2,10*-d)*Math.sin((d-c)*2*Math.PI/b)}}function U(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function V(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function W(){d3.event.stopPropagation(),d3.event.preventDefault()}function X(){var a=d3.event,b;while(b=a.sourceEvent)a=b;return a}function Y(a){var b=new x,c=0,d=arguments.length;while(++c<d)b[arguments[c]]=y(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=d3.event;e.target=a,d3.event=e,b[e.type].apply(c,d)}finally{d3.event=f}}},b}function $(a){return a=="transform"?d3.interpolateTransform:d3.interpolate}function _(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function ba(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function bb(a,b,c){return new bc(a,b,c)}function bc(a,b,c){this.r=a,this.g=b,this.b=c}function bd(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function be(a,b,c){var d=0,e=0,f=0,g,h,i;g=/([a-z]+)\((.*)\)/i.exec(a);if(g){h=g[2].split(",");switch(g[1]){case"hsl":return c(parseFloat(h[0]),parseFloat(h[1])/100,parseFloat(h[2])/100);case"rgb":return b(bg(h[0]),bg(h[1]),bg(h[2]))}}return(i=bh.get(a))?b(i.r,i.g,i.b):(a!=null&&a.charAt(0)==="#"&&(a.length===4?(d=a.charAt(1),d+=d,e=a.charAt(2),e+=e,f=a.charAt(3),f+=f):a.length===7&&(d=a.substring(1,3),e=a.substring(3,5),f=a.substring(5,7)),d=parseInt(d,16),e=parseInt(e,16),f=parseInt(f,16)),b(d,e,f))}function bf(a,b,c){var d=Math.min(a/=255,b/=255,c/=255),e=Math.max(a,b,c),f=e-d,g,h,i=(e+d)/2;return f?(h=i<.5?f/(e+d):f/(2-e-d),a==e?g=(b-c)/f+(b<c?6:0):b==e?g=(c-a)/f+2:g=(a-b)/f+4,g*=60):h=g=0,bi(g,h,i)}function bg(a){var b=parseFloat(a);return a.charAt(a.length-1)==="%"?Math.round(b*2.55):b}function bi(a,b,c){return new bj(a,b,c)}function bj(a,b,c){this.h=a,this.s=b,this.l=c}function bk(a,b,c){function f(a){return a>360?a-=360:a<0&&(a+=360),a<60?d+(e-d)*a/60:a<180?e:a<240?d+(e-d)*(240-a)/60:d}function g(a){return Math.round(f(a)*255)}var d,e;return a%=360,a<0&&(a+=360),b=b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,e=c<=.5?c*(1+b):c+b-c*b,d=2*c-e,bb(g(a+120),g(a),g(a-120))}function bl(a){return j(a,br),a}function bs(a){return function(){return bm(a,this)}}function bt(a){return function(){return bn(a,this)}}function bv(a,b){function f(){if(b=this.classList)return b.add(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;c.lastIndex=0,c.test(e)||(e=t(e+" "+a),d?b.baseVal=e:this.className=e)}function g(){if(b=this.classList)return b.remove(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;e=t(e.replace(c," ")),d?b.baseVal=e:this.className=e}function h(){(b.apply(this,arguments)?f:g).call(this)}var c=new RegExp("(^|\\s+)"+d3.requote(a)+"(\\s+|$)","g");if(arguments.length<2){var d=this.node();if(e=d.classList)return e.contains(a);var e=d.className;return c.lastIndex=0,c.test(e.baseVal!=null?e.baseVal:e)}return this.each(typeof b=="function"?h:b?f:g)}function bw(a){return{__data__:a}}function bx(a){return function(){return bq(this,a)}}function by(a){return arguments.length||(a=d3.ascending),function(b,c){return a(b&&b.__data__,c&&c.__data__)}}function bA(a){return j(a,bB),a}function bC(a,b,c){j(a,bG);var d=new k,e=d3.dispatch("start","end"),f=bO;return a.id=b,a.time=c,a.tween=function(b,c){return arguments.length<2?d.get(b):(c==null?d.remove(b):d.set(b,c),a)},a.ease=function(b){return arguments.length?(f=typeof b=="function"?b:d3.ease.apply(d3,arguments),a):f},a.each=function(b,c){return arguments.length<2?bP.call(a,b):(e.on(b,c),a)},d3.timer(function(g){return a.each(function(h,i,j){function p(a){return o.active>b?r():(o.active=b,d.forEach(function(a,b){(tween=b.call(l,h,i))&&k.push(tween)}),e.start.call(l,h,i),q(a)||d3.timer(q,0,c),1)}function q(a){if(o.active!==b)return r();var c=(a-m)/n,d=f(c),g=k.length;while(g>0)k[--g].call(l,d);if(c>=1)return r(),bI=b,e.end.call(l,h,i),bI=0,1}function r(){return--o.count||delete l.__transition__,1}var k=[],l=this,m=a[j][i].delay,n=a[j][i].duration,o=l.__transition__||(l.__transition__={active:0,count:0});++o.count,m<=g?p(g):d3.timer(p,m,c)}),1},0,c),a}function bE(a,b,c){return c!=""&&bD}function bF(a,b){function d(a,d,e){var f=b.call(this,a,d);return f==null?e!=""&&bD:e!=f&&c(e,f)}function e(a,d,e){return e!=b&&c(e,b)}var c=$(a);return typeof b=="function"?d:b==null?bE:(b+="",e)}function bP(a){var b=bI,c=bO,d=bM,e=bN;bI=this.id,bO=this.ease();for(var f=0,g=this.length;f<g;f++)for(var h=this[f],i=0,j=h.length;i<j;i++){var k=h[i];k&&(bM=this[f][i].delay,bN=this[f][i].duration,a.call(k=k.node,k.__data__,i,f))}return bI=b,bO=c,bM=d,bN=e,this}function bT(){var a,b=Date.now(),c=bQ;while(c)a=b-c.then,a>=c.delay&&(c.flush=c.callback(a)),c=c.next;var d=bU()-b;d>24?(isFinite(d)&&(clearTimeout(bS),bS=setTimeout(bT,d)),bR=0):(bR=1,bV(bT))}function bU(){var a=null,b=bQ,c=Infinity;while(b)b.flush?b=a?a.next=b.next:bQ=b.next:(c=Math.min(c,b.then+b.delay),b=(a=b).next);return c}function bW(a){var b=[a.a,a.b],c=[a.c,a.d],d=bY(b),e=bX(b,c),f=bY(bZ(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*b$,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*b$:0}function bX(a,b){return a[0]*b[0]+a[1]*b[1]}function bY(a){var b=Math.sqrt(bX(a,a));return b&&(a[0]/=b,a[1]/=b),b}function bZ(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function ca(a,b){var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(b_<0&&(window.scrollX||window.scrollY)){c=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var e=c[0][0].getScreenCTM();b_=!e.f&&!e.e,c.remove()}return b_?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function cb(){}function cc(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function cd(a){return a.rangeExtent?a.rangeExtent():cc(a.range())}function ce(a,b){var c=0,d=a.length-1,e=a[c],f=a[d],g;f<e&&(g=c,c=d,d=g,g=e,e=f,f=g);if(g=f-e)b=b(g),a[c]=b.floor(e),a[d]=b.ceil(f);return a}function cf(){return Math}function cg(a,b,c,d){function g(){var g=Math.min(a.length,b.length)>2?cn:cm,i=d?ba:_;return e=g(a,b,i,c),f=g(b,a,i,d3.interpolate),h}function h(a){return e(a)}var e,f;return h.invert=function(a){return f(a)},h.domain=function(b){return arguments.length?(a=b.map(Number),g()):a},h.range=function(a){return arguments.length?(b=a,g()):b},h.rangeRound=function(a){return h.range(a).interpolate(d3.interpolateRound)},h.clamp=function(a){return arguments.length?(d=a,g()):d},h.interpolate=function(a){return arguments.length?(c=a,g()):c},h.ticks=function(b){return ck(a,b)},h.tickFormat=function(b){return cl(a,b)},h.nice=function(){return ce(a,ci),g()},h.copy=function(){return cg(a,b,c,d)},g()}function ch(a,b){return d3.rebind(a,b,"range","rangeRound","interpolate","clamp")}function ci(a){return a=Math.pow(10,Math.round(Math.log(a)/Math.LN10)-1),{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}}function cj(a,b){var c=cc(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+e*.5,c[2]=e,c}function ck(a,b){return d3.range.apply(d3,cj(a,b))}function cl(a,b){return d3.format(",."+Math.max(0,-Math.floor(Math.log(cj(a,b)[2])/Math.LN10+.01))+"f")}function cm(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function cn(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());while(++g<=h)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=d3.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function co(a,b){function d(c){return a(b(c))}var c=b.pow;return d.invert=function(b){return c(a.invert(b))},d.domain=function(e){return arguments.length?(b=e[0]<0?cr:cq,c=b.pow,a.domain(e.map(b)),d):a.domain().map(c)},d.nice=function(){return a.domain(ce(a.domain(),cf)),d},d.ticks=function(){var d=cc(a.domain()),e=[];if(d.every(isFinite)){var f=Math.floor(d[0]),g=Math.ceil(d[1]),h=c(d[0]),i=c(d[1]);if(b===cr){e.push(c(f));for(;f++<g;)for(var j=9;j>0;j--)e.push(c(f)*j)}else{for(;f<g;f++)for(var j=1;j<10;j++)e.push(c(f)*j);e.push(c(f))}for(f=0;e[f]<h;f++);for(g=e.length;e[g-1]>i;g--);e=e.slice(f,g)}return e},d.tickFormat=function(a,e){arguments.length<2&&(e=cp);if(arguments.length<1)return e;var f=a/d.ticks().length,g=b===cr?(h=-1e-12,Math.floor):(h=1e-12,Math.ceil),h;return function(a){return a/c(g(b(a)+h))<f?e(a):""}},d.copy=function(){return co(a.copy(),b)},ch(d,a)}function cq(a){return Math.log(a<0?0:a)/Math.LN10}function cr(a){return-Math.log(a>0?0:-a)/Math.LN10}function cs(a,b){function e(b){return a(c(b))}var c=ct(b),d=ct(1/b);return e.invert=function(b){return d(a.invert(b))},e.domain=function(b){return arguments.length?(a.domain(b.map(c)),e):a.domain().map(d)},e.ticks=function(a){return ck(e.domain(),a)},e.tickFormat=function(a){return cl(e.domain(),a)},e.nice=function(){return e.domain(ce(e.domain(),ci))},e.exponent=function(a){if(!arguments.length)return b;var f=e.domain();return c=ct(b=a),d=ct(1/b),e.domain(f)},e.copy=function(){return cs(a.copy(),b)},ch(e,a)}function ct(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function cu(a,b){function f(b){return d[((c.get(b)||c.set(b,a.push(b)))-1)%d.length]}function g(b,c){return d3.range(a.length).map(function(a){return b+c*a})}var c,d,e;return f.domain=function(d){if(!arguments.length)return a;a=[],c=new k;var e=-1,g=d.length,h;while(++e<g)c.has(h=d[e])||c.set(h,a.push(h));return f[b.t](b.x,b.p)},f.range=function(a){return arguments.length?(d=a,e=0,b={t:"range",x:a},f):d},f.rangePoints=function(c,h){arguments.length<2&&(h=0);var i=c[0],j=c[1],k=(j-i)/(a.length-1+h);return d=g(a.length<2?(i+j)/2:i+k*h/2,k),e=0,b={t:"rangePoints",x:c,p:h},f},f.rangeBands=function(c,h){arguments.length<2&&(h=0);var i=c[1]<c[0],j=c[i-0],k=c[1-i],l=(k-j)/(a.length+h);return d=g(j+l*h,l),i&&d.reverse(),e=l*(1-h),b={t:"rangeBands",x:c,p:h},f},f.rangeRoundBands=function(c,h){arguments.length<2&&(h=0);var i=c[1]<c[0],j=c[i-0],k=c[1-i],l=Math.floor((k-j)/(a.length+h)),m=k-j-(a.length-h)*l;return d=g(j+Math.round(m/2),l),i&&d.reverse(),e=Math.round(l*(1-h)),b={t:"rangeRoundBands",x:c,p:h},f},f.rangeBand=function(){return e},f.rangeExtent=function(){return cc(b.x)},f.copy=function(){return cu(a,b)},f.domain(a)}function cz(a,b){function d(){var d=0,f=a.length,g=b.length;c=[];while(++d<g)c[d-1]=d3.quantile(a,d/g);return e}function e(a){return isNaN(a=+a)?NaN:b[d3.bisect(c,a)]}var c;return e.domain=function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(d3.ascending),d()):a},e.range=function(a){return arguments.length?(b=a,d()):b},e.quantiles=function(){return c},e.copy=function(){return cz(a,b)},d()}function cA(a,b,c){function f(b){return c[Math.max(0,Math.min(e,Math.floor(d*(b-a))))]}function g(){return d=c.length/(b-a),e=c.length-1,f}var d,e;return f.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],g()):[a,b]},f.range=function(a){return arguments.length?(c=a,g()):c},f.copy=function(){return cA(a,b,c)},g()}function cB(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return ck(a,b)},b.tickFormat=function(b){return cl(a,b)},b.copy=function(){return cB(a)},b}function cE(a){return a.innerRadius}function cF(a){return a.outerRadius}function cG(a){return a.startAngle}function cH(a){return a.endAngle}function cI(a){function g(d){return d.length<1?null:"M"+e(a(cJ(this,d,b,c)),f)}var b=cK,c=cL,d=cM,e=cN.get(d),f=.7;return g.x=function(a){return arguments.length?(b=a,g):b},g.y=function(a){return arguments.length?(c=a,g):c},g.interpolate=function(a){return arguments.length?(cN.has(a+="")||(a=cM),e=cN.get(d=a),g):d},g.tension=function(a){return arguments.length?(f=a,g):f},g}function cJ(a,b,c,d){var e=[],f=-1,g=b.length,h=typeof c=="function",i=typeof d=="function",j;if(h&&i)while(++f<g)e.push([c.call(a,j=b[f],f),d.call(a,j,f)]);else if(h)while(++f<g)e.push([c.call(a,b[f],f),d]);else if(i)while(++f<g)e.push([c,d.call(a,b[f],f)]);else while(++f<g)e.push([c,d]);return e}function cK(a){return a[0]}function cL(a){return a[1]}function cO(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("L",(d=a[b])[0],",",d[1]);return e.join("")}function cP(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function cQ(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function cR(a,b){return a.length<4?cO(a):a[1]+cU(a.slice(1,a.length-1),cV(a,b))}function cS(a,b){return a.length<3?cO(a):a[0]+cU((a.push(a[0]),a),cV([a[a.length-2]].concat(a,[a[1]]),b))}function cT(a,b,c){return a.length<3?cO(a):a[0]+cU(a,cV(a,b))}function cU(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return cO(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;c&&(d+="Q"+(f[0]-g[0]*2/3)+","+(f[1]-g[1]*2/3)+","+f[0]+","+f[1],e=a[1],i=2);if(b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+h[0]*2/3)+","+(f[1]+h[1]*2/3)+","+k[0]+","+k[1]}return d}function cV(a,b){var c=[],d=(1-b)/2,e,f=a[0],g=a[1],h=1,i=a.length;while(++h<i)e=f,f=g,g=a[h],c.push([d*(g[0]-e[0]),d*(g[1]-e[1])]);return c}function cW(a){if(a.length<3)return cO(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f];dc(i,g,h);while(++b<c)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),dc(i,g,h);b=-1;while(++b<2)g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),dc(i,g,h);return i.join("")}function cX(a){if(a.length<4)return cO(a);var b=[],c=-1,d=a.length,e,f=[0],g=[0];while(++c<3)e=a[c],f.push(e[0]),g.push(e[1]);b.push(c$(db,f)+","+c$(db,g)),--c;while(++c<d)e=a[c],f.shift(),f.push(e[0]),g.shift(),g.push(e[1]),dc(b,f,g);return b.join("")}function cY(a){var b,c=-1,d=a.length,e=d+4,f,g=[],h=[];while(++c<4)f=a[c%d],g.push(f[0]),h.push(f[1]);b=[c$(db,g),",",c$(db,h)],--c;while(++c<e)f=a[c%d],g.shift(),g.push(f[0]),h.shift(),h.push(f[1]),dc(b,g,h);return b.join("")}function cZ(a,b){var c=a.length-1,d=a[0][0],e=a[0][1],f=a[c][0]-d,g=a[c][1]-e,h=-1,i,j;while(++h<=c)i=a[h],j=h/c,i[0]=b*i[0]+(1-b)*(d+j*f),i[1]=b*i[1]+(1-b)*(e+j*g);return cW(a)}function c$(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function dc(a,b,c){a.push("C",c$(c_,b),",",c$(c_,c),",",c$(da,b),",",c$(da,c),",",c$(db,b),",",c$(db,c))}function dd(a,b){return(b[1]-a[1])/(b[0]-a[0])}function de(a){var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=dd(e,f);while(++b<c)d[b]=g+(g=dd(e=f,f=a[b+1]));return d[b]=g,d}function df(a){var b=[],c,d,e,f,g=de(a),h=-1,i=a.length-1;while(++h<i)c=dd(a[h],a[h+1]),Math.abs(c)<1e-6?g[h]=g[h+1]=0:(d=g[h]/c,e=g[h+1]/c,f=d*d+e*e,f>9&&(f=c*3/Math.sqrt(f),g[h]=f*d,g[h+1]=f*e));h=-1;while(++h<=i)f=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),b.push([f||0,g[h]*f||0]);return b}function dg(a){return a.length<3?cO(a):a[0]+cU(a,df(a))}function dh(a){var b,c=-1,d=a.length,e,f;while(++c<d)b=a[c],e=b[0],f=b[1]+cC,b[0]=e*Math.cos(f),b[1]=e*Math.sin(f);return a}function di(a){function j(f){if(f.length<1)return null;var j=cJ(this,f,b,d),k=cJ(this,f,b===c?dj(j):c,d===e?dk(j):e);return"M"+g(a(k),i)+"L"+h(a(j.reverse()),i)+"Z"}var b=cK,c=cK,d=0,e=cL,f,g,h,i=.7;return j.x=function(a){return arguments.length?(b=c=a,j):c},j.x0=function(a){return arguments.length?(b=a,j):b},j.x1=function(a){return arguments.length?(c=a,j):c},j.y=function(a){return arguments.length?(d=e=a,j):e},j.y0=function(a){return arguments.length?(d=a,j):d},j.y1=function(a){return arguments.length?(e=a,j):e},j.interpolate=function(a){return arguments.length?(cN.has(a+="")||(a=cM),g=cN.get(f=a),h=g.reverse||g,j):f},j.tension=function(a){return arguments.length?(i=a,j):i},j.interpolate("linear")}function dj(a){return function(b,c){return a[c][0]}}function dk(a){return function(b,c){return a[c][1]}}function dl(a){return a.source}function dm(a){return a.target}function dn(a){return a.radius}function dp(a){return a.startAngle}function dq(a){return a.endAngle}function dr(a){return[a.x,a.y]}function ds(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+cC;return[c*Math.cos(d),c*Math.sin(d)]}}function dt(){return 64}function du(){return"circle"}function dv(a){var b=Math.sqrt(a/Math.PI);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+ -b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function dz(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function dA(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function dB(a,b,c){e=[];if(c&&b.length>1){var d=cc(a.domain()),e,f=-1,g=b.length,h=(b[1]-b[0])/++c,i,j;while(++f<g)for(i=c;--i>0;)(j=+b[f]-i*h)>=d[0]&&e.push(j);for(--f,i=0;++i<c&&(j=+b[f]+i*h)<d[1];)e.push(j)}return e}function dG(){dE||(dE=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var a=d3.event,b;try{dE.scrollTop=1e3,dE.dispatchEvent(a),b=1e3-dE.scrollTop}catch(c){b=a.wheelDelta||-a.detail*5}return b}function dH(a){var b=a.source,c=a.target,d=dJ(b,c),e=[b];while(b!==d)b=b.parent,e.push(b);var f=e.length;while(c!==d)e.splice(f,0,c),c=c.parent;return e}function dI(a){var b=[],c=a.parent;while(c!=null)b.push(a),a=c,c=c.parent;return b.push(a),b}function dJ(a,b){if(a===b)return a;var c=dI(a),d=dI(b),e=c.pop(),f=d.pop(),g=null;while(e===f)g=e,e=c.pop(),f=d.pop();return g}function dM(a){a.fixed|=2}function dN(a){a!==dL&&(a.fixed&=1)}function dO(){dL.fixed&=1,dK=dL=null}function dP(){dL.px=d3.event.x,dL.py=d3.event.y,dK.resume()}function dQ(a,b,c){var d=0,e=0;a.charge=0;if(!a.leaf){var f=a.nodes,g=f.length,h=-1,i;while(++h<g){i=f[h];if(i==null)continue;dQ(i,b,c),a.charge+=i.charge,d+=i.charge*i.cx,e+=i.charge*i.cy}}if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function dR(a){return 20}function dS(a){return 1}function dU(a){return a.x}function dV(a){return a.y}function dW(a,b,c){a.y0=b,a.y=c}function dZ(a){return d3.range(a.length)}function d$(a){var b=-1,c=a[0].length,d=[];while(++b<c)d[b]=0;return d}function d_(a){var b=1,c=0,d=a[0][1],e,f=a.length;for(;b<f;++b)(e=a[b][1])>d&&(c=b,d=e);return c}function ea(a){return a.reduce(eb,0)}function eb(a,b){return a+b[1]}function ec(a,b){return ed(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function ed(a,b){var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];while(++c<=b)f[c]=e*c+d;return f}function ee(a){return[d3.min(a),d3.max(a)]}function ef(a,b){return d3.rebind(a,b,"sort","children","value"),a.links=ej,a.nodes=function(b){return ek=!0,(a.nodes=a)(b)},a}function eg(a){return a.children}function eh(a){return a.value}function ei(a,b){return b.value-a.value}function ej(a){return d3.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function el(a,b){return a.value-b.value}function em(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function en(a,b){a._pack_next=b,b._pack_prev=a}function eo(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return e*e-c*c-d*d>.001}function ep(a){function l(a){b=Math.min(a.x-a.r,b),c=Math.max(a.x+a.r,c),d=Math.min(a.y-a.r,d),e=Math.max(a.y+a.r,e)}var b=Infinity,c=-Infinity,d=Infinity,e=-Infinity,f=a.length,g,h,i,j,k;a.forEach(eq),g=a[0],g.x=-g.r,g.y=0,l(g);if(f>1){h=a[1],h.x=h.r,h.y=0,l(h);if(f>2){i=a[2],eu(g,h,i),l(i),em(g,i),g._pack_prev=i,em(i,h),h=g._pack_next;for(var m=3;m<f;m++){eu(g,h,i=a[m]);var n=0,o=1,p=1;for(j=h._pack_next;j!==h;j=j._pack_next,o++)if(eo(j,i)){n=1;break}if(n==1)for(k=g._pack_prev;k!==j._pack_prev;k=k._pack_prev,p++)if(eo(k,i))break;n?(o<p||o==p&&h.r<g.r?en(g,h=j):en(g=k,h),m--):(em(g,i),h=i,l(i))}}}var q=(b+c)/2,r=(d+e)/2,s=0;for(var m=0;m<f;m++){var t=a[m];t.x-=q,t.y-=r,s=Math.max(s,t.r+Math.sqrt(t.x*t.x+t.y*t.y))}return a.forEach(er),s}function eq(a){a._pack_next=a._pack_prev=a}function er(a){delete a._pack_next,delete a._pack_prev}function es(a){var b=a.children;b&&b.length?(b.forEach(es),a.r=ep(b)):a.r=Math.sqrt(a.value)}function et(a,b,c,d){var e=a.children;a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d;if(e){var f=-1,g=e.length;while(++f<g)et(e[f],b,c,d)}}function eu(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=Math.sqrt(e*e+f*f),i=Math.max(-1,Math.min(1,(d*d+h*h-g*g)/(2*d*h))),j=Math.acos(i),k=i*(d/=h),l=Math.sin(j)*d;c.x=a.x+k*e+l*f,c.y=a.y+k*f-l*e}else c.x=a.x+d,c.y=a.y}function ev(a){return 1+d3.max(a,function(a){return a.y})}function ew(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function ex(a){var b=a.children;return b&&b.length?ex(b[0]):a}function ey(a){var b=a.children,c;return b&&(c=b.length)?ey(b[c-1]):a}function ez(a,b){return a.parent==b.parent?1:2}function eA(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function eB(a){var b=a.children,c;return b&&(c=b.length)?b[c-1]:a._tree.thread}function eC(a,b){var c=a.children;if(c&&(e=c.length)){var d,e,f=-1;while(++f<e)b(d=eC(c[f],b),a)>0&&(a=d)}return a}function eD(a,b){return a.x-b.x}function eE(a,b){return b.x-a.x}function eF(a,b){return a.depth-b.depth}function eG(a,b){function c(a,d){var e=a.children;if(e&&(i=e.length)){var f,g=null,h=-1,i;while(++h<i)f=e[h],c(f,g),g=f}b(a,d)}c(a,null)}function eH(a){var b=0,c=0,d=a.children,e=d.length,f;while(--e>=0)f=d[e]._tree,f.prelim+=b,f.mod+=b,b+=f.shift+(c+=f.change)}function eI(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function eJ(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function eK(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function eL(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function eM(a){return a.map(eN).join(",")}function eN(a){return/[",\n]/.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}function eP(a,b){return function(c){return c&&a.hasOwnProperty(c.type)?a[c.type](c):b}}function eQ(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+ -2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function eR(a,b){eS.hasOwnProperty(a.type)&&eS[a.type](a,b)}function eT(a,b){eR(a.geometry,b)}function eU(a,b){for(var c=a.features,d=0,e=c.length;d<e;d++)eR(c[d].geometry,b)}function eV(a,b){for(var c=a.geometries,d=0,e=c.length;d<e;d++)eR(c[d],b)}function eW(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)b.apply(null,c[d])}function eX(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)for(var f=c[d],g=0,h=f.length;g<h;g++)b.apply(null,f[g])}function eY(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)for(var f=c[d][0],g=0,h=f.length;g<h;g++)b.apply(null,f[g])}function eZ(a,b){b.apply(null,a.coordinates)}function e$(a,b){for(var c=a.coordinates[0],d=0,e=c.length;d<e;d++)b.apply(null,c[d])}function e_(a){return a.source}function fa(a){return a.target}function fb(a,b){function q(a){var b=Math.sin(o-(a*=o))/p,c=Math.sin(a)/p,f=b*g*d+c*m*j,i=b*g*e+c*m*k,l=b*h+c*n;return[Math.atan2(i,f)/eO,Math.atan2(l,Math.sqrt(f*f+i*i))/eO]}var c=a[0]*eO,d=Math.cos(c),e=Math.sin(c),f=a[1]*eO,g=Math.cos(f),h=Math.sin(f),i=b[0]*eO,j=Math.cos(i),k=Math.sin(i),l=b[1]*eO,m=Math.cos(l),n=Math.sin(l),o=q.d=Math.acos(Math.max(-1,Math.min(1,h*n+g*m*Math.cos(i-c)))),p=Math.sin(o);return q}function fe(a){var b=0,c=0;for(;;){if(a(b,c))return[b,c];b===0?(b=c+1,c=0):(b-=1,c+=1)}}function ff(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function fg(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function fh(a,b,c,d){var e=a[0],f=b[0],g=c[0],h=d[0],i=a[1],j=b[1],k=c[1],l=d[1],m=e-g,n=f-e,o=h-g,p=i-k,q=j-i,r=l-k,s=(o*p-r*m)/(r*n-o*q);return[e+s*n,i+s*q]}function fj(a,b){var c={list:a.map(function(a,b){return{index:b,x:a[0],y:a[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null},d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l"),d.rightEnd=d.createHalfEdge(null,"l"),d.leftEnd.r=d.rightEnd,d.rightEnd.l=d.leftEnd,d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(a,b){return{edge:a,side:b,vertex:null,l:null,r:null}},insert:function(a,b){b.l=a,b.r=a.r,a.r.l=b,a.r=b},leftBound:function(a){var b=d.leftEnd;do b=b.r;while(b!=d.rightEnd&&e.rightOf(b,a));return b=b.l,b},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[fi[a.side]]}},e={bisect:function(a,b){var c={region:{l:a,r:b},ep:{l:null,r:null}},d=b.x-a.x,e=b.y-a.y,f=d>0?d:-d,g=e>0?e:-e;return c.c=a.x*d+a.y*e+(d*d+e*e)*.5,f>g?(c.a=1,c.b=e/d,c.c/=d):(c.b=1,c.a=d/e,c.c/=e),c},intersect:function(a,b){var c=a.edge,d=b.edge;if(!c||!d||c.region.r==d.region.r)return null;var e=c.a*d.b-c.b*d.a;if(Math.abs(e)<1e-10)return null;var f=(c.c*d.b-d.c*c.b)/e,g=(d.c*c.a-c.c*d.a)/e,h=c.region.r,i=d.region.r,j,k;h.y<i.y||h.y==i.y&&h.x<i.x?(j=a,k=c):(j=b,k=d);var l=f>=k.region.r.x;return l&&j.side==="l"||!l&&j.side==="r"?null:{x:f,y:g}},rightOf:function(a,b){var c=a.edge,d=c.region.r,e=b.x>d.x;if(e&&a.side==="l")return 1;if(!e&&a.side==="r")return 0;if(c.a===1){var f=b.y-d.y,g=b.x-d.x,h=0,i=0;!e&&c.b<0||e&&c.b>=0?i=h=f>=c.b*g:(i=b.x+b.y*c.b>c.c,c.b<0&&(i=!i),i||(h=1));if(!h){var j=d.x-c.region.l.x;i=c.b*(g*g-f*f)<j*f*(1+2*g/j+c.b*c.b),c.b<0&&(i=!i)}}else{var k=c.c-c.a*b.x,l=b.y-k,m=b.x-d.x,n=k-d.y;i=l*l>m*m+n*n}return a.side==="l"?i:!i},endPoint:function(a,c,d){a.ep[c]=d;if(!a.ep[fi[c]])return;b(a)},distance:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}},f={list:[],insert:function(a,b,c){a.vertex=b,a.ystar=b.y+c;for(var d=0,e=f.list,g=e.length;d<g;d++){var h=e[d];if(a.ystar>h.ystar||a.ystar==h.ystar&&b.x>h.vertex.x)continue;break}e.splice(d,0,a)},del:function(a){for(var b=0,c=f.list,d=c.length;b<d&&c[b]!=a;++b);c.splice(b,1)},empty:function(){return f.list.length===0},nextEvent:function(a){for(var b=0,c=f.list,d=c.length;b<d;++b)if(c[b]==a)return c[b+1];return null},min:function(){var a=f.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return f.list.shift()}};d.init(),c.bottomSite=c.list.shift();var g=c.list.shift(),h,i,j,k,l,m,n,o,p,q,r,s,t;for(;;){f.empty()||(h=f.min());if(g&&(f.empty()||g.y<h.y||g.y==h.y&&g.x<h.x))i=d.leftBound(g),j=d.right(i),n=d.rightRegion(i),s=e.bisect(n,g),m=d.createHalfEdge(s,"l"),d.insert(i,m),q=e.intersect(i,m),q&&(f.del(i),f.insert(i,q,e.distance(q,g))),i=m,m=d.createHalfEdge(s,"r"),d.insert(i,m),q=e.intersect(m,j),q&&f.insert(m,q,e.distance(q,g)),g=c.list.shift();else if(!f.empty())i=f.extractMin(),k=d.left(i),j=d.right(i),l=d.right(j),n=d.leftRegion(i),o=d.rightRegion(j),r=i.vertex,e.endPoint(i.edge,i.side,r),e.endPoint(j.edge,j.side,r),d.del(i),f.del(j),d.del(j),t="l",n.y>o.y&&(p=n,n=o,o=p,t="r"),s=e.bisect(n,o),m=d.createHalfEdge(s,t),d.insert(k,m),e.endPoint(s,fi[t],r),q=e.intersect(k,m),q&&(f.del(k),f.insert(k,q,e.distance(q,n))),q=e.intersect(m,l),q&&f.insert(m,q,e.distance(q,n));else break}for(i=d.right(d.leftEnd);i!=d.rightEnd;i=d.right(i))b(i.edge)}function fk(){return{leaf:!0,nodes:[],point:null}}function fl(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=(c+e)*.5,h=(d+f)*.5,i=b.nodes;i[0]&&fl(a,i[0],c,d,g,h),i[1]&&fl(a,i[1],g,d,e,h),i[2]&&fl(a,i[2],c,h,g,f),i[3]&&fl(a,i[3],g,h,e,f)}}function fm(a){return{x:a[0],y:a[1]}}function fo(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function fq(a,b,c,d){var e,f,g=0,h=b.length,i=c.length;while(g<h){if(d>=i)return-1;e=b.charCodeAt(g++);if(e==37){f=fw[b.charAt(g++)];if(!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function fx(a,b,c){return fz.test(b.substring(c,c+=3))?c:-1}function fy(a,b,c){fA.lastIndex=0;var d=fA.exec(b.substring(c,c+10));return d?c+=d[0].length:-1}function fB(a,b,c){var d=fC.get(b.substring(c,c+=3).toLowerCase());return d==null?-1:(a.m=d,c)}function fD(a,b,c){fE.lastIndex=0;var d=fE.exec(b.substring(c,c+12));return d?(a.m=fF.get(d[0].toLowerCase()),c+=d[0].length):-1}function fH(a,b,c){return fq(a,fv.c.toString(),b,c)}function fI(a,b,c){return fq(a,fv.x.toString(),b,c)}function fJ(a,b,c){return fq(a,fv.X.toString(),b,c)}function fK(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+=d[0].length):-1}function fL(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.y=fM()+ +d[0],c+=d[0].length):-1}function fM(){return~~((new Date).getFullYear()/1e3)*1e3}function fN(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+=d[0].length):-1}function fO(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+=d[0].length):-1}function fP(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+=d[0].length):-1}function fQ(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+=d[0].length):-1}function fR(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+=d[0].length):-1}function fS(a,b,c){fT.lastIndex=0;var d=fT.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+=d[0].length):-1}function fU(a,b,c){var d=fV.get(b.substring(c,c+=2).toLowerCase());return d==null?-1:(a.p=d,c)}function fW(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(Math.abs(b)/60),e=Math.abs(b)%60;return c+fr(d)+fr(e)}function fY(a){return a.toISOString()}function fZ(a,b,c){function d(b){var c=a(b),d=f(c,1);return b-c<d-b?c:d}function e(c){return b(c=a(new fn(c-1)),1),c}function f(a,c){return b(a=new fn(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)while(g<d)c(g)%f||h.push(new Date(+g)),b(g,1);else while(g<d)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{fn=fo;var d=new fo;return d._=a,g(d,b,c)}finally{fn=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=f$(a);return i.floor=i,i.round=f$(d),i.ceil=f$(e),i.offset=f$(f),i.range=h,a}function f$(a){return function(b,c){try{fn=fo;var d=new fo;return d._=b,a(d,c)._}finally{fn=Date}}}function f_(a,b,c){function d(b){return a(b)}return d.invert=function(b){return gb(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(gb)},d.nice=function(a){var b=ga(d.domain());return d.domain([a.floor(b[0]),a.ceil(b[1])])},d.ticks=function(c,e){var f=ga(d.domain());if(typeof c!="function"){var g=f[1]-f[0],h=g/c,i=d3.bisect(gf,h);if(i==gf.length)return b.year(f,c);if(!i)return a.ticks(c).map(gb);Math.log(h/gf[i-1])<Math.log(gf[i]/h)&&--i,c=b[i],e=c[1],c=c[0].range}return c(f[0],new Date(+f[1]+1),e)},d.tickFormat=function(){return c},d.copy=function(){return f_(a.copy(),b,c)},d3.rebind(d,a,"range","rangeRound","interpolate","clamp")}function ga(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function gb(a){return new Date(a)}function gc(a){return function(b){var c=a.length-1,d=a[c];while(!d[1](b))d=a[--c];return d[0](b)}}function gd(a){var b=new Date(a,0,1);return b.setFullYear(a),b}function ge(a){var b=a.getFullYear(),c=gd(b),d=gd(b+1);return b+(a-c)/(d-c)}function gn(a){var b=new Date(Date.UTC(a,0,1));return b.setUTCFullYear(a),b}function go(a){var b=a.getUTCFullYear(),c=gn(b),d=gn(b+1);return b+(a-c)/(d-c)}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(a){var b=CSSStyleDeclaration.prototype,c=b.setProperty;b.setProperty=function(a,b,d){c.call(this,a,b+"",d)}}d3={version:"2.8.1"};var f=h;try{f(document.documentElement.childNodes)[0].nodeType}catch(i){f=g}var j=[].__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]};d3.map=function(a){var b=new k;for(var c in a)b.set(c,a[c]);return b},e(k,{has:function(a){return l+a in this},get:function(a){return this[l+a]},set:function(a,b){return this[l+a]=b},remove:function(a){return a=l+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===m&&a.call(this,b.substring(1),this[b])}});var l="\0",m=l.charCodeAt(0);d3.functor=function(a){return typeof a=="function"?a:function(){return a}},d3.rebind=function(a,b){var c=1,d=arguments.length,e;while(++c<d)a[e=arguments[c]]=o(a,b,b[e]);return a},d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3.mean=function(a,b){var c=a.length,d,e=0,f=-1,g=0;if(arguments.length===1)while(++f<c)p(d=a[f])&&(e+=(d-e)/++g);else while(++f<c)p(d=b.call(a,a[f],f))&&(e+=(d-e)/++g);return g?e:undefined},d3.median=function(a,b){return arguments.length>1&&(a=a.map(b)),a=a.filter(p),a.length?d3.quantile(a.sort(d3.ascending),.5):undefined},d3.min=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&e>f&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&e>f&&(e=f)}return e},d3.max=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&f>e&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&f>e&&(e=f)}return e},d3.extent=function(a,b){var c=-1,d=a.length,e,f,g;if(arguments.length===1){while(++c<d&&((e=g=a[c])==null||e!=e))e=g=undefined;while(++c<d)(f=a[c])!=null&&(e>f&&(e=f),g<f&&(g=f))}else{while(++c<d&&((e=g=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&(e>f&&(e=f),g<f&&(g=f))}return[e,g]},d3.random={normal:function(a,b){return arguments.length<2&&(b=1),arguments.length<1&&(a=0),function(){var c,d,e;do c=Math.random()*2-1,d=Math.random()*2-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}}},d3.sum=function(a,b){var c=0,d=a.length,e,f=-1;if(arguments.length===1)while(++f<d)isNaN(e=+a[f])||(c+=e);else while(++f<d)isNaN(e=+b.call(a,a[f],f))||(c+=e);return c},d3.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=a[d-1],f=c-d;return f?e+f*(a[d]-e):e},d3.transpose=function(a){return d3.zip.apply(d3,a)},d3.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=d3.min(arguments,q),c=new Array(b);++a<b;)for(var d=-1,e,f=c[a]=new Array(e);++d<e;)f[d]=arguments[d][a];return c},d3.bisector=function(a){return{left:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>1;a.call(b,b[f],f)<c?d=f+1:e=f}return d},right:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>1;c<a.call(b,b[f],f)?e=f:d=f+1}return d}}};var r=d3.bisector(function(a){return a});d3.bisectLeft=r.left,d3.bisect=d3.bisectRight=r.right,d3.first=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])>0&&(e=f);return e},d3.last=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])<=0&&(e=f);return e},d3.nest=function(){function f(c,g){if(g>=b.length)return e?e.call(a,c):d?c.sort(d):c;var h=-1,i=c.length,j=b[g++],l,m,n=new k,o,p={};while(++h<i)(o=n.get(l=j(m=c[h])))?o.push(m):n.set(l,[m]);return n.forEach(function(a){p[a]=f(n.get(a),g)}),p}function g(a,d){if(d>=b.length)return a;var e=[],f=c[d++],h;for(h in a)e.push({key:h,values:g(a[h],d)});return f&&e.sort(function(a,b){return f(a.key,b.key)}),e}var a={},b=[],c=[],d,e;return a.map=function(a){return f(a,0)},a.entries=function(a){return g(f(a,0),0)},a.key=function(c){return b.push(c),a},a.sortKeys=function(d){return c[b.length-1]=d,a},a.sortValues=function(b){return d=b,a},a.rollup=function(b){return e=b,a},a},d3.keys=function(a){var b=[];for(var c in a)b.push(c);return b},d3.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},d3.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},d3.permute=function(a,b){var c=[],d=-1,e=b.length;while(++d<e)c[d]=a[b[d]];return c},d3.merge=function(a){return Array.prototype.concat.apply([],a)},d3.split=function(a,b){var c=[],d=[],e,f=-1,g=a.length;arguments.length<2&&(b=s);while(++f<g)b.call(d,e=a[f],f)?d=[]:(d.length||c.push(d),d.push(e));return c},d3.range=function(a,b,c){arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0));if((b-a)/c===Infinity)throw new Error("infinite range");var d=[],e=u(Math.abs(c)),f=-1,g;a*=e,b*=e,c*=e;if(c<0)while((g=a+c*++f)>b)d.push(g/e);else while((g=a+c*++f)<b)d.push(g/e);return d},d3.requote=function(a){return a.replace(v,"\\$&")};var v=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)},d3.xhr=function(a,b,c){var d=new XMLHttpRequest;arguments.length<3?(c=b,b=null):b&&d.overrideMimeType&&d.overrideMimeType(b),d.open("GET",a,!0),b&&d.setRequestHeader("Accept",b),d.onreadystatechange=function(){d.readyState===4&&c(d.status<300?d:null)},d.send(null)},d3.text=function(a,b,c){function d(a){c(a&&a.responseText)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)},d3.json=function(a,b){d3.text(a,"application/json",function(a){b(a?JSON.parse(a):null)})},d3.html=function(a,b){d3.text(a,"text/html",function(a){if(a!=null){var c=document.createRange();c.selectNode(document.body),a=c.createContextualFragment(a)}b(a)})},d3.xml=function(a,b,c){function d(a){c(a&&a.responseXML)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)};var w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:w,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),w.hasOwnProperty(c)?{space:w[c],local:a}:a}},d3.dispatch=function(){var a=new x,b=-1,c=arguments.length;while(++b<c)a[arguments[b]]=y(a);return a},x.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},d3.format=function(a){var b=z.exec(a),c=b[1]||" ",d=b[3]||"",e=b[5],f=+b[6],g=b[7],h=b[8],i=b[9],j=1,k="",l=!1;h&&(h=+h.substring(1)),e&&(c="0",g&&(f-=Math.floor((f-1)/4)));switch(i){case"n":g=!0,i="g";break;case"%":j=100,k="%",i="f";break;case"p":j=100,k="%",i="r";break;case"d":l=!0,h=0;break;case"s":j=-1,i="r"}return i=="r"&&!h&&(i="g"),i=A.get(i)||C,function(a){if(l&&a%1)return"";var b=a<0&&(a=-a)?"−":d;if(j<0){var m=d3.formatPrefix(a,h);a*=m.scale,k=m.symbol}else a*=j;a=i(a,h);if(e){var n=a.length+b.length;n<f&&(a=(new Array(f-n+1)).join(c)+a),g&&(a=D(a)),a=b+a}else{g&&(a=D(a)),a=b+a;var n=a.length;n<f&&(a=(new Array(f-n+1)).join(c)+a)}return a+k}};var z=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,A=d3.map({g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return d3.round(a,b=B(a,b)).toFixed(Math.max(0,Math.min(20,b)))}}),E=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(F);d3.formatPrefix=function(a,b){var c=0;return a&&(a<0&&(a*=-1),b&&(a=d3.round(a,B(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,Math.floor((c<=0?c+1:c-1)/3)*3))),E[8+c/3]};var G=P(2),H=P(3),I=function(){return O},J=d3.map({linear:I,poly:P,quad:function(){return G},cubic:function(){return H},sin:function(){return Q},exp:function(){return R},circle:function(){return S},elastic:T,back:U,bounce:function(){return V}}),K=d3.map({"in":O,out:M,"in-out":N,"out-in":function(a){return N(M(a))}});d3.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=J.get(c)||I,d=K.get(d)||O,L(d(c.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.interpolate=function(a,b){var c=d3.interpolators.length,d;while(--c>=0&&!(d=d3.interpolators[c](a,b)));return d},d3.interpolateNumber=function(a,b){return b-=a,function(c){return a+b*c}},d3.interpolateRound=function(a,b){return b-=a,function(c){return Math.round(a+b*c)}},d3.interpolateString=function(a,b){var c,d,e,f=0,g=0,h=[],i=[],j,k;Z.lastIndex=0;for(d=0;c=Z.exec(b);++d)c.index&&h.push(b.substring(f,g=c.index)),i.push({i:h.length,x:c[0]}),h.push(null),f=Z.lastIndex;f<b.length&&h.push(b.substring(f));for(d=0,j=i.length;(c=Z.exec(a))&&d<j;++d){k=i[d];if(k.x==c[0]){if(k.i)if(h[k.i+1]==null){h[k.i-1]+=k.x,h.splice(k.i,1);for(e=d+1;e<j;++e)i[e].i--}else{h[k.i-1]+=k.x+h[k.i+1],h.splice(k.i,2);for(e=d+1;e<j;++e)i[e].i-=2}else if(h[k.i+1]==null)h[k.i]=k.x;else{h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1);for(e=d+1;e<j;++e)i[e].i--}i.splice(d,1),j--,d--}else k.x=d3.interpolateNumber(parseFloat(c[0]),parseFloat(k.x))}while(d<j)k=i.pop(),h[k.i+1]==null?h[k.i]=k.x:(h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1)),j--;return h.length===1?h[0]==null?i[0].x:function(){return b}:function(a){for(d=0;d<j;++d)h[(k=i[d]).i]=k.x(a);return h.join("")}},d3.interpolateTransform=function(a,b){var c=[],d=[],e,f=d3.transform(a),g=d3.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(c.push("translate(",null,",",null,")"),d.push({i:1,x:d3.interpolateNumber(h[0],i[0])},{i:3,x:d3.interpolateNumber(h[1],i[1])})):i[0]||i[1]?c.push("translate("+i+")"):c.push(""),j!=k?d.push({i:c.push(c.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(j,k)}):k&&c.push(c.pop()+"rotate("+k+")"),l!=m?d.push({i:c.push(c.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(l,m)}):m&&c.push(c.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(e=c.push(c.pop()+"scale(",null,",",null,")"),d.push({i:e-4,x:d3.interpolateNumber(n[0],o[0])},{i:e-2,x:d3.interpolateNumber(n[1],o[1])})):(o[0]!=1||o[1]!=1)&&c.push(c.pop()+"scale("+o+")"),e=d.length,function(a){var b=-1,f;while(++b<e)c[(f=d[b]).i]=f.x(a);return c.join("")}},d3.interpolateRgb=function(a,b){a=d3.rgb(a),b=d3.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+bd(Math.round(c+f*a))+bd(Math.round(d+g*a))+bd(Math.round(e+h*a))}},d3.interpolateHsl=function(a,b){a=d3.hsl(a),b=d3.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return function(a){return bk(c+f*a,d+g*a,e+h*a).toString()}},d3.interpolateArray=function(a,b){var c=[],d=[],e=a.length,f=b.length,g=Math.min(a.length,b.length),h;for(h=0;h<g;++h)c.push(d3.interpolate(a[h],b[h]));for(;h<e;++h)d[h]=a[h];for(;h<f;++h)d[h]=b[h];return function(a){for(h=0;h<g;++h)d[h]=c[h](a);return d}},d3.interpolateObject=function(a,b){var c={},d={},e;for(e in a)e in b?c[e]=$(e)(a[e],b[e]):d[e]=a[e];for(e in b)e in a||(d[e]=b[e]);return function(a){for(e in c)d[e]=c[e](a);return d}};var Z=/[-+]?(?:\d*\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(a,b){return b instanceof Array&&d3.interpolateArray(a,b)},function(a,b){return(typeof a=="string"||typeof b=="string")&&d3.interpolateString(a+"",b+"")},function(a,b){return(typeof b=="string"?bh.has(b)||/^(#|rgb\(|hsl\()/.test(b):b instanceof bc||b instanceof bj)&&d3.interpolateRgb(a,b)},function(a,b){return!isNaN(a=+a)&&!isNaN(b=+b)&&d3.interpolateNumber(a,b)}],d3.rgb=function(a,b,c){return arguments.length===1?a instanceof bc?bb(a.r,a.g,a.b):be(""+a,bb,bk):bb(~~a,~~b,~~c)},bc.prototype.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?bb(e,e,e):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),bb(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a))))},bc.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),bb(Math.floor(a*this.r),Math.floor(a*this.g),Math.floor(a*this.b))},bc.prototype.hsl=function(){return bf(this.r,this.g,this.b)},bc.prototype.toString=function(){return"#"+bd(this.r)+bd(this.g)+bd(this.b)};var bh=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});bh.forEach(function(a,b){bh.set(a,be(b,bb,bk))}),d3.hsl=function(a,b,c){return arguments.length===1?a instanceof bj?bi(a.h,a.s,a.l):be(""+a,bf,bi):bi(+a,+b,+c)},bj.prototype.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),bi(this.h,this.s,this.l/a)},bj.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),bi(this.h,this.s,a*this.l)},bj.prototype.rgb=function(){return bk(this.h,this.s,this.l)},bj.prototype.toString=function(){return this.rgb().toString()};var bm=function(a,b){return b.querySelector(a)},bn=function(a,b){return b.querySelectorAll(a)},bo=document.documentElement,bp=bo.matchesSelector||bo.webkitMatchesSelector||bo.mozMatchesSelector||bo.msMatchesSelector||bo.oMatchesSelector,bq=function(a,b){return bp.call(a,b)};typeof Sizzle=="function"&&(bm=function(a,b){return Sizzle(a,b)[0]},bn=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))},bq=Sizzle.matchesSelector);var br=[];d3.selection=function(){return bz},d3.selection.prototype=br,br.select=function(a){var b=[],c,d,e,f;typeof a!="function"&&(a=bs(a));for(var g=-1,h=this.length;++g<h;){b.push(c=[]),c.parentNode=(e=this[g]).parentNode;for(var i=-1,j=e.length;++i<j;)(f=e[i])?(c.push(d=a.call(f,f.__data__,i)),d&&"__data__"in f&&(d.__data__=f.__data__)):c.push(null)}return bl(b)},br.selectAll=function(a){var b=[],c,d;typeof a!="function"&&(a=bt(a));for(var e=-1,g=this.length;++e<g;)for(var h=this[e],i=-1,j=h.length;++i<j;)if(d=h[i])b.push(c=f(a.call(d,d.__data__,i))),c.parentNode=d;return bl(b)},br.attr=function(a,b){function d(){this.removeAttribute(a)}function e(){this.removeAttributeNS(a.space,a.local)}function f(){this.setAttribute(a,b)}function g(){this.setAttributeNS(a.space,a.local,b)}function h(){var c=b.apply(this,arguments);c==null?this.removeAttribute(a):this.setAttribute(a,c)}function i(){var c=b.apply(this,arguments);c==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}a=d3.ns.qualify(a);if(arguments.length<2){var c=this.node();return a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}return this.each(b==null?a.local?e:d:typeof b=="function"?a.local?i:h:a.local?g:f)},br.classed=function(a,b){var c=a.split(bu),d=c.length,e=-1;if(arguments.length>1){while(++e<d)bv.call(this,c[e],b);return this}while(++e<d)if(!bv.call(this,c[e]))return!1;return!0};var bu=/\s+/g;br.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);d==null?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return arguments.length<3&&(c=""),arguments.length<2?window.getComputedStyle(this.node(),null).getPropertyValue(a):this.each(b==null?d:typeof b=="function"?f:e)},br.property=function(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);c==null?delete this[a]:this[a]=c}return arguments.length<2?this.node()[a]:this.each(b==null?c:typeof b=="function"?e:d)},br.text=function(a){return arguments.length<1?this.node().textContent:this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.textContent=b==null?"":b}:a==null?function(){this.textContent=""}:function(){this.textContent=a})},br.html=function(a){return arguments.length<1?this.node().innerHTML:this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.innerHTML=b==null?"":b}:a==null?function(){this.innerHTML=""}:function(){this.innerHTML=a})},br.append=function(a){function b(){return this.appendChild(document.createElementNS(this.namespaceURI,a))}function c(){return this.appendChild(document.createElementNS(a.space,a.local))}return a=d3.ns.qualify(a),this.select(a.local?c:b)},br.insert=function(a,b){function c(){return this.insertBefore(document.createElementNS(this.namespaceURI,a),bm(b,this))}function d(){return this.insertBefore(document.createElementNS(a.space,a.local),bm(b,this))}return a=d3.ns.qualify(a),this.select(a.local?d:c)},br.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},br.data=function(a,b){function g(a,c){var d,e=a.length,f=c.length,g=Math.min(e,f),l=Math.max(e,f),m=[],n=[],o=[],p,q;if(b){var r=new k,s=[],t,u=c.length;for(d=-1;++d<e;)t=b.call(p=a[d],p.__data__,d),r.has(t)?o[u++]=p:r.set(t,p),s.push(t);for(d=-1;++d<f;)t=b.call(c,q=c[d],d),r.has(t)?(m[d]=p=r.get(t),p.__data__=q,n[d]=o[d]=null):(n[d]=bw(q),m[d]=o[d]=null),r.remove(t);for(d=-1;++d<e;)r.has(s[d])&&(o[d]=a[d])}else{for(d=-1;++d<g;)p=a[d],q=c[d],p?(p.__data__=q,m[d]=p,n[d]=o[d]=null):(n[d]=bw(q),m[d]=o[d]=null);for(;d<f;++d)n[d]=bw(c[d]),m[d]=o[d]=null;for(;d<l;++d)o[d]=a[d],n[d]=m[d]=null}n.update=m,n.parentNode=m.parentNode=o.parentNode=a.parentNode,h.push(n),i.push(m),j.push(o)}var c=-1,d=this.length,e,f;if(!arguments.length){a=new Array(d=(e=this[0]).length);while(++c<d)if(f=e[c])a[c]=f.__data__;return a}var h=bA([]),i=bl([]),j=bl([]);if(typeof a=="function")while(++c<d)g(e=this[c],a.call(e,e.parentNode.__data__,c));else while(++c<d)g(e=this[c],a);return i.enter=function(){return h},i.exit=function(){return j},i},br.datum=br.map=function(a){return arguments.length<1?this.property("__data__"):this.property("__data__",a)},br.filter=function(a){var b=[],c,d,e;typeof a!="function"&&(a=bx(a));for(var f=0,g=this.length;f<g;f++){b.push(c=[]),c.parentNode=(d=this[f]).parentNode;for(var h=0,i=d.length;h<i;h++)(e=d[h])&&a.call(e,e.__data__,h)&&c.push(e)}return bl(b)},br.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c=this[a],d=c.length-1,e=c[d],f;--d>=0;)if(f=c[d])e&&e!==f.nextSibling&&e.parentNode.insertBefore(f,e),e=f;return this},br.sort=function(a){a=by.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},br.on=function(a,b,c){arguments.length<3&&(c=!1);var d="__on"+a,e=a.indexOf(".");return e>0&&(a=a.substring(0,e)),arguments.length<2?(e=this.node()[d])&&e._:this.each(function(e,f){function i(a){var c=d3.event;d3.event=a;try{b.call(g,g.__data__,f)}finally{d3.event=c}}var g=this,h=g[d];h&&(g.removeEventListener(a,h,h.$),delete g[d]),b&&(g.addEventListener(a,g[d]=i,i.$=c),i._=b)})},br.each=function(a){for(var b=-1,c=this.length;++b<c;)for(var d=this[b],e=-1,f=d.length;++e<f;){var g=d[e];g&&a.call(g,g.__data__,e,b)}return this},br.call=function(a){return a.apply(this,(arguments[0]=this,arguments)),this},br.empty=function(){return!this.node()},br.node=function(a){for(var b=0,c=this.length;b<c;b++)for(var d=this[b],e=0,f=d.length;e<f;e++){var g=d[e];if(g)return g}return null},br.transition=function(){var a=[],b,c;for(var d=-1,e=this.length;++d<e;){a.push(b=[]);for(var f=this[d],g=-1,h=f.length;++g<h;)b.push((c=f[g])?{node:c,delay:bM,duration:bN}:null)}return bC(a,bI||++bH,Date.now())};var bz=bl([[document]]);bz[0].parentNode=bo,d3.select=function(a){return typeof a=="string"?bz.select(a):bl([[a]])},d3.selectAll=function(a){return typeof a=="string"?bz.selectAll(a):bl([f(a)])};var bB=[];d3.selection.enter=bA,d3.selection.enter.prototype=bB,bB.append=br.append,bB.insert=br.insert,bB.empty=br.empty,bB.node=br.node,bB.select=function(a){var b=[],c,d,e,f,g;for(var h=-1,i=this.length;++h<i;){e=(f=this[h]).update,b.push(c=[]),c.parentNode=f.parentNode;for(var j=-1,k=f.length;++j<k;)(g=f[j])?(c.push(e[j]=d=a.call(f.parentNode,g.__data__,j)),d.__data__=g.__data__):c.push(null)}return bl(b)};var bD={},bG=[],bH=0,bI=0,bJ=0,bK=250,bL=d3.ease("cubic-in-out"),bM=bJ,bN=bK,bO=bL;bG.call=br.call,d3.transition=function(a){return arguments.length?bI?a.transition():a:bz.transition()},d3.transition.prototype=bG,bG.select=function(a){var b=[],c,d,e;typeof a!="function"&&(a=bs(a));for(var f=-1,g=this.length;++f<g;){b.push(c=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(e=h[i])&&(d=a.call(e.node,e.node.__data__,i))?("__data__"in e.node&&(d.__data__=e.node.__data__),c.push({node:d,delay:e.delay,duration:e.duration})):c.push(null)}return bC(b,this.id,this.time).ease(this.ease())},bG.selectAll=function(a){var b=[],c,d,e;typeof a!="function"&&(a=bt(a));for(var f=-1,g=this.length;++f<g;)for(var h=this[f],i=-1,j=h.length;++i<j;)if(e=h[i]){d=a.call(e.node,e.node.__data__,i),b.push(c=[]);for(var k=-1,l=d.length;++k<l;)c.push({node:d[k],delay:e.delay,duration:e.duration})}return bC(b,this.id,this.time).ease(this.ease())},bG.attr=function(a,b){return this.attrTween(a,bF(a,b))},bG.attrTween=function(a,b){function d(a,d){var e=b.call(this,a,d,this.getAttribute(c));return e===bD?(this.removeAttribute(c),null):e&&function(a){this.setAttribute(c,e(a))}}function e(a,d){var e=b.call(this,a,d,this.getAttributeNS(c.space,c.local));return e===bD?(this.removeAttributeNS(c.space,c.local),null):e&&function(a){this.setAttributeNS(c.space,c.local,e(a))}}var c=d3.ns.qualify(a);return this.tween("attr."+a,c.local?e:d)},bG.style=function(a,b,c){return arguments.length<3&&(c=""),this.styleTween(a,bF(a,b),c)},bG.styleTween=function(a,b,c){return arguments.length<3&&(c=""),this.tween("style."+a,function(d,e){var f=b.call(this,d,e,window.getComputedStyle(this,null).getPropertyValue(a));return f===bD?(this.style.removeProperty(a),null):f&&function(b){this.style.setProperty(a,f(b),c)}})},bG.text=function(a){return this.tween("text",function(b,c){this.textContent=typeof a=="function"?a.call(this,b,c):a})},bG.remove=function(){return this.each("end.transition",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})},bG.delay=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].delay=a.apply(this,arguments)|0}:(a|=0,function(c,d,e){b[e][d].delay=a}))},bG.duration=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].duration=Math.max(1,a.apply(this,arguments)|0)}:(a=Math.max(1,a|0),function(c,d,e){b[e][d].duration=a}))},bG.transition=function(){return this.select(n)};var bQ=null,bR,bS;d3.timer=function(a,b,c){var d=!1,e,f=bQ;if(arguments.length<3){if(arguments.length<2)b=0;else if(!isFinite(b))return;c=Date.now()}while(f){if(f.callback===a){f.then=c,f.delay=b,d=!0;break}e=f,f=f.next}d||(bQ={callback:a,then:c,delay:b,next:bQ}),bR||(bS=clearTimeout(bS),bR=1,bV(bT))},d3.timer.flush=function(){var a,b=Date.now(),c=bQ;while(c)a=b-c.then,c.delay||(c.flush=c.callback(a)),c=c.next;bU()};var bV=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,17)};d3.transform=function(a){var b=document.createElementNS(d3.ns.prefix.svg,"g"),c={a:1,b:0,c:0,d:1,e:0,f:0};return(d3.transform=function(a){b.setAttribute("transform",a);var d=b.transform.baseVal.consolidate();return new bW(d?d.matrix:c)})(a)},bW.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var b$=180/Math.PI;d3.mouse=function(a){return ca(a,X())};var b_=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(a,b){return arguments.length<2&&(b=X().touches),b?f(b).map(function(b){var c=ca(a,b);return c.identifier=b.identifier,c}):[]},d3.scale={},d3.scale.linear=function(){return cg([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return co(d3.scale.linear(),cq)};var cp=d3.format(".0e");cq.pow=function(a){return Math.pow(10,a)},cr.pow=function(a){return-Math.pow(10,-a)},d3.scale.pow=function(){return cs(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return cu([],{t:"range",x:[]})},d3.scale.category10=function(){return d3.scale.ordinal().range(cv)},d3.scale.category20=function(){return d3.scale.ordinal().range(cw)},d3.scale.category20b=function(){return d3.scale.ordinal().range(cx)},d3.scale.category20c=function(){return d3.scale.ordinal().range(cy)};var cv=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],cw=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],cx=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],cy=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return cz([],[])},d3.scale.quantize=function(){return cA(0,1,[0,1])},d3.scale.identity=function(){return cB([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=a.apply(this,arguments),f=b.apply(this,arguments),g=c.apply(this,arguments)+cC,h=d.apply(this,arguments)+cC,i=(h<g&&(i=g,g=h,h=i),h-g),j=i<Math.PI?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=cD?e?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":e?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+e*m+","+e*n+"A"+e+","+e+" 0 "+j+",0 "+e*k+","+e*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0"+"Z"}var a=cE,b=cF,c=cG,d=cH;return e.innerRadius=function(b){return arguments.length?(a=d3.functor(b),e):a},e.outerRadius=function(a){return arguments.length?(b=d3.functor(a),e):b},e.startAngle=function(a){return arguments.length?(c=d3.functor(a),e):c},e.endAngle=function(a){return arguments.length?(d=d3.functor(a),e):d},e.centroid=function(){var e=(a.apply(this,arguments)+b.apply(this,arguments))/2,f=(c.apply(this,arguments)+d.apply(this,arguments))/2+cC;return[Math.cos(f)*e,Math.sin(f)*e]},e};var cC=-Math.PI/2,cD=2*Math.PI-1e-6;d3.svg.line=function(){return cI(Object)};var cM="linear",cN=d3.map({linear:cO,"step-before":cP,"step-after":cQ,basis:cW,"basis-open":cX,"basis-closed":cY,bundle:cZ,cardinal:cT,"cardinal-open":cR,"cardinal-closed":cS,monotone:dg}),c_=[0,2/3,1/3,0],da=[0,1/3,2/3,0],db=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var a=cI(dh);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},cP.reverse=cQ,cQ.reverse=cP,d3.svg.area=function(){return di(Object)},d3.svg.area.radial=function(){var a=di(dh);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},d3.svg.chord=function(){function f(c,d){var e=g(this,a,c,d),f=g(this,b,c,d);return"M"+e.p0+i(e.r,e.p1,e.a1-e.a0)+(h(e,f)?j(e.r,e.p1,e.r,e.p0):j(e.r,e.p1,f.r,f.p0)+i(f.r,f.p1,f.a1-f.a0)+j(f.r,f.p1,e.r,e.p0))+"Z"}function g(a,b,f,g){var h=b.call(a,f,g),i=c.call(a,h,g),j=d.call(a,h,g)+cC,k=e.call(a,h,g)+cC;return{r:i,a0:j,a1:k,p0:[i*Math.cos(j),i*Math.sin(j)],p1:[i*Math.cos(k),i*Math.sin(k)]}}function h(a,b){return a.a0==b.a0&&a.a1==b.a1}function i(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Math.PI)+",1 "+b}function j(a,b,c,d){return"Q 0,0 "+d}var a=dl,b=dm,c=dn,d=cG,e=cH;return f.radius=function(a){return arguments.length?(c=d3.functor(a),f):c},f.source=function(b){return arguments.length?(a=d3.functor(b),f):a},f.target=function(a){return arguments.length?(b=d3.functor(a),f):b},f.startAngle=function(a){return arguments.length?(d=d3.functor(a),f):d},f.endAngle=function(a){return arguments.length?(e=d3.functor(a),f):e},f},d3.svg.diagonal=function(){function d(d,e){var f=a.call(this,d,e),g=b.call(this,d,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(c),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var a=dl,b=dm,c=dr;return d.source=function(b){return arguments.length?(a=d3.functor(b),d):a},d.target=function(a){return arguments.length?(b=d3.functor(a),d):b},d.projection=function(a){return arguments.length?(c=a,d):c},d},d3.svg.diagonal.radial=function(){var a=d3.svg.diagonal(),b=dr,c=a.projection;return a.projection=function(a){return arguments.length?c(ds(b=a)):b},a},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function c(c,d){return(dw.get(a.call(this,c,d))||dv)(b.call(this,c,d))}var a=du,b=dt;return c.type=function(b){return arguments.length?(a=d3.functor(b),c):a},c.size=function(a){return arguments.length?(b=d3.functor(a),c):b},c};var dw=d3.map({circle:dv,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+ -3*b+","+ -b+"H"+ -b+"V"+ -3*b+"H"+b+"V"+ -b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+ -b+"V"+b+"H"+ -3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*dy)),c=b*dy;return"M0,"+ -b+"L"+c+",0"+" 0,"+b+" "+ -c+",0"+"Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+ -b+","+ -b+"L"+b+","+ -b+" "+b+","+b+" "+ -b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/dx),c=b*dx/2;return"M0,"+c+"L"+b+","+ -c+" "+ -b+","+ -c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/dx),c=b*dx/2;return"M0,"+ -c+"L"+b+","+c+" "+ -b+","+c+"Z"}});d3.svg.symbolTypes=dw.keys();var dx=Math.sqrt(3),dy=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function k(k){k.each(function(){var k=d3.select(this),l=h==null?a.ticks?a.ticks.apply(a,g):a.domain():h,m=i==null?a.tickFormat?a.tickFormat.apply(a,g):String:i,n=dB(a,l,j),o=k.selectAll(".minor").data(n,String),p=o.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),q=d3.transition(o.exit()).style("opacity",1e-6).remove(),r=d3.transition(o).style("opacity",1),s=k.selectAll("g").data(l,String),t=s.enter().insert("g","path").style("opacity",1e-6),u=d3.transition(s.exit()).style("opacity",1e-6).remove(),v=d3.transition(s).style("opacity",1),w,x=cd(a),y=k.selectAll(".domain").data([0]),z=y.enter().append("path").attr("class","domain"),A=d3.transition(y),B=a.copy(),C=this.__chart__||B;this.__chart__=B,t.append("line").attr("class","tick"),t.append("text"),v.select("text").text(m);switch(b){case"bottom":w=dz,p.attr("y2",d),r.attr("x2",0).attr("y2",d),t.select("line").attr("y2",c),t.select("text").attr("y",Math.max(c,0)+f),v.select("line").attr("x2",0).attr("y2",c),v.select("text").attr("x",0).attr("y",Math.max(c,0)+f).attr("dy",".71em").attr("text-anchor","middle"),A.attr("d","M"+x[0]+","+e+"V0H"+x[1]+"V"+e);break;case"top":w=dz,p.attr("y2",-d),r.attr("x2",0).attr("y2",-d),t.select("line").attr("y2",-c),t.select("text").attr("y",-(Math.max(c,0)+f)),v.select("line").attr("x2",0).attr("y2",-c),v.select("text").attr("x",0).attr("y",-(Math.max(c,0)+f)).attr("dy","0em").attr("text-anchor","middle"),A.attr("d","M"+x[0]+","+ -e+"V0H"+x[1]+"V"+ -e);break;case"left":w=dA,p.attr("x2",-d),r.attr("x2",-d).attr("y2",0),t.select("line").attr("x2",-c),t.select("text").attr("x",-(Math.max(c,0)+f)),v.select("line").attr("x2",-c).attr("y2",0),v.select("text").attr("x",-(Math.max(c,0)+f)).attr("y",0).attr("dy",".32em").attr("text-anchor","end"),A.attr("d","M"+ -e+","+x[0]+"H0V"+x[1]+"H"+ -e);break;case"right":w=dA,p.attr("x2",d),r.attr("x2",d).attr("y2",0),t.select("line").attr("x2",c),t.select("text").attr("x",Math.max(c,0)+f),v.select("line").attr("x2",c).attr("y2",0),v.select("text").attr("x",Math.max(c,0)+f).attr("y",0).attr("dy",".32em").attr("text-anchor","start"),A.attr("d","M"+e+","+x[0]+"H0V"+x[1]+"H"+e)}if(a.ticks)t.call(w,C),v.call(w,B),u.call(w,B),p.call(w,C),r.call(w,B),q.call(w,B);else{var D=B.rangeBand()/2,E=function(a){return B(a)+D};t.call(w,E),v.call(w,E)}})}var a=d3.scale.linear(),b="bottom",c=6,d=6,e=6,f=3,g=[10],h=null,i,j=0;return k.scale=function(b){return arguments.length?(a=b,k):a},k.orient=function(a){return arguments.length?(b=a,k):b},k.ticks=function(){return arguments.length?(g=arguments,k):g},k.tickValues=function(a){return arguments.length?(h=a,k):h},k.tickFormat=function(a){return arguments.length?(i=a,k):i},k.tickSize=function(a,b,f){if(!arguments.length)return c;var g=arguments.length-1;return c=+a,d=g>1?+b:c,e=g>0?+arguments[g]:c,k},k.tickPadding=function(a){return arguments.length?(f=+a,k):f},k.tickSubdivide=function(a){return arguments.length?(j=+a,k):j},k},d3.svg.brush=function(){function g(a){a.each(function(){var a=d3.select(this),e=a.selectAll(".background").data([0]),f=a.selectAll(".extent").data([0]),l=a.selectAll(".resize").data(d,String),m;a.style("pointer-events","all").on("mousedown.brush",k).on("touchstart.brush",k),e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.enter().append("rect").attr("class","extent").style("cursor","move"),l.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return dC[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",g.empty()?"none":null),l.exit().remove(),b&&(m=cd(b),e.attr("x",m[0]).attr("width",m[1]-m[0]),i(a)),c&&(m=cd(c),e.attr("y",m[0]).attr("height",m[1]-m[0]),j(a)),h(a)})}function h(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+e[+/e$/.test(a)][0]+","+e[+/^s/.test(a)][1]+")"})}function i(a){a.select(".extent").attr("x",e[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",e[1][0]-e[0][0])}function j(a){a.select(".extent").attr("y",e[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",e[1][1]-e[0][1])}function k(){function x(){var a=d3.event.changedTouches;return a?d3.touches(d,a)[0]:d3.mouse(d)}function y(){d3.event.keyCode==32&&(q||(r=null,s[0]-=e[1][0],s[1]-=e[1][1],q=2),W())}function z(){d3.event.keyCode==32&&q==2&&(s[0]+=e[1][0],s[1]+=e[1][1],q=0,W())}function A(){var a=x(),d=!1;t&&(a[0]+=t[0],a[1]+=t[1]),q||(d3.event.altKey?(r||(r=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]),s[0]=e[+(a[0]<r[0])][0],s[1]=e[+(a[1]<r[1])][1]):r=null),o&&B(a,b,0)&&(i(m),d=!0),p&&B(a,c,1)&&(j(m),d=!0),d&&(h(m),l({type:"brush",mode:q?"move":"resize"}))}function B(a,b,c){var d=cd(b),g=d[0],h=d[1],i=s[c],j=e[1][c]-e[0][c],k,l;q&&(g-=i,h-=j+i),k=Math.max(g,Math.min(h,a[c])),q?l=(k+=i)+j:(r&&(i=Math.max(g,Math.min(h,2*r[c]-k))),i<k?(l=k,k=i):l=i);if(e[0][c]!==k||e[1][c]!==l)return f=null,e[0][c]=k,e[1][c]=l,!0}function C(){A(),m.style("pointer-events","all").selectAll(".resize").style("display",g.empty()?"none":null),d3.select("body").style("cursor",null),u.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),l({type:"brushend"}),W()}var d=this,k=d3.select(d3.event.target),l=a.of(d,arguments),m=d3.select(d),n=k.datum(),o=!/^(n|s)$/.test(n)&&b,p=!/^(e|w)$/.test(n)&&c,q=k.classed("extent"),r,s=x(),t,u=d3.select(window).on("mousemove.brush",A).on("mouseup.brush",C).on("touchmove.brush",A).on("touchend.brush",C).on("keydown.brush",y).on("keyup.brush",z);if(q)s[0]=e[0][0]-s[0],s[1]=e[0][1]-s[1];else if(n){var v=+/w$/.test(n),w=+/^n/.test(n);t=[e[1-v][0]-s[0],e[1-w][1]-s[1]],s[0]=e[v][0],s[1]=e[w][1]}else d3.event.altKey&&(r=s.slice());m.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",k.style("cursor")),l({type:"brushstart"}),A(),W()}var a=Y(g,"brushstart","brush","brushend"),b=null,c=null,d=dD[0],e=[[0,0],[0,0]],f;return g.x=function(a){return arguments.length?(b=a,d=dD[!b<<1|!c],g):b},g.y=function(a){return arguments.length?(c=a,d=dD[!b<<1|!c],g):c},g.extent=function(a){var d,h,i,j,k;return arguments.length?(f=[[0,0],[0,0]],b&&(d=a[0],h=a[1],c&&(d=d[0],h=h[0]),f[0][0]=d,f[1][0]=h,b.invert&&(d=b(d),h=b(h)),h<d&&(k=d,d=h,h=k),e[0][0]=d|0,e[1][0]=h|0),c&&(i=a[0],j=a[1],b&&(i=i[1],j=j[1]),f[0][1]=i,f[1][1]=j,c.invert&&(i=c(i),j=c(j)),j<i&&(k=i,i=j,j=k),e[0][1]=i|0,e[1][1]=j|0),g):(a=f||e,b&&(d=a[0][0],h=a[1][0],f||(d=e[0][0],h=e[1][0],b.invert&&(d=b.invert(d),h=b.invert(h)),h<d&&(k=d,d=h,h=k))),c&&(i=a[0][1],j=a[1][1],f||(i=e[0][1],j=e[1][1],c.invert&&(i=c.invert(i),j=c.invert(j)),j<i&&(k=i,i=j,j=k))),b&&c?[[d,i],[h,j]]:b?[d,h]:c&&[i,j])},g.clear=function(){return f=null,e[0][0]=e[0][1]=e[1][0]=e[1][1]=0,g},g.empty=function(){return b&&e[0][0]===e[1][0]||c&&e[0][1]===e[1][1]},d3.rebind(g,a,"on")};var dC={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},dD=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function c(){this.on("mousedown.drag",d).on("touchstart.drag",d)}function d(){function j(){var a=c.parentNode,b=d3.event.changedTouches;return b?d3.touches(a,b)[0]:d3.mouse(a)}function k(){if(!c.parentNode)return l();var a=j(),b=a[0]-g[0],e=a[1]-g[1];h|=b|e,g=a,W(),d({type:"drag",x:a[0]+f[0],y:a[1]+f[1],dx:b,dy:e})}function l(){d({type:"dragend"}),h&&(W(),d3.event.target===e&&i.on("click.drag",m,!0)),i.on("mousemove.drag",null).on("touchmove.drag",null).on("mouseup.drag",null).on("touchend.drag",null)}function m(){W(),i.on("click.drag",null)}var c=this,d=a.of(c,arguments),e=d3.event.target,f,g=j(),h=0,i=d3.select(window).on("mousemove.drag",k).on("touchmove.drag",k).on("mouseup.drag",l,!0).on("touchend.drag",l,!0);b?(f=b.apply(c,arguments),f=[f.x-g[0],f.y-g[1]]):f=[0,0],d({type:"dragstart"})}var a=Y(c,"drag","dragstart","dragend"),b=null;return c.origin=function(a){return arguments.length?(b=a,c):b},d3.rebind(c,a,"on")},d3.behavior.zoom=function(){function l(){this.on("mousedown.zoom",r).on("mousewheel.zoom",s).on("mousemove.zoom",t).on("DOMMouseScroll.zoom",s).on("dblclick.zoom",u).on("touchstart.zoom",v).on("touchmove.zoom",w).on("touchend.zoom",v)}function m(b){return[(b[0]-a[0])/c,(b[1]-a[1])/c]}function n(b){return[b[0]*c+a[0],b[1]*c+a[1]]}function o(a){c=Math.max(e[0],Math.min(e[1],a))}function p(b,c){c=n(c),a[0]+=b[0]-c[0],a[1]+=b[1]-c[1]}function q(b){h&&h.domain(g.range().map(function(b){return(b-a[0])/c}).map(g.invert)),j&&j.domain(i.range().map(function(b){return(b-a[1])/c}).map(i.invert)),d3.event.preventDefault(),b({type:"zoom",scale:c,translate:a})}function r(){function h(){d=1,p(d3.mouse(a),g),q(b)}function i(){d&&W(),e.on("mousemove.zoom",null).on("mouseup.zoom",null),d&&d3.event.target===c&&e.on("click.zoom",j)}function j(){W(),e.on("click.zoom",null)}var a=this,b=f.of(a,arguments),c=d3.event.target,d=0,e=d3.select(window).on("mousemove.zoom",h).on("mouseup.zoom",i),g=m(d3.mouse(a));window.focus(),W()}function s(){b||(b=m(d3.mouse(this))),o(Math.pow(2,dG()*.002)*c),p(d3.mouse(this),b),q(f.of(this,arguments))}function t(){b=null}function u(){var a=d3.mouse(this),b=m(a);o(d3.event.shiftKey?c/2:c*2),p(a,b),q(f.of(this,arguments))}function v(){var a=d3.touches(this),e=Date.now();d=c,b={},a.forEach(function(a){b[a.identifier]=m(a)}),W();if(a.length===1&&e-k<500){var g=a[0],h=m(a[0]);o(c*2),p(g,h),q(f.of(this,arguments))}k=e}function w(){var a=d3.touches(this),c=a[0],e=b[c.identifier];if(g=a[1]){var g,h=b[g.identifier];c=[(c[0]+g[0])/2,(c[1]+g[1])/2],e=[(e[0]+h[0])/2,(e[1]+h[1])/2],o(d3.event.scale*d)}p(c,e),q(f.of(this,arguments))}var a=[0,0],b,c=1,d,e=dF,f=Y(l,"zoom"),g,h,i,j,k;return l.translate=function(b){return arguments.length?(a=b.map(Number),l):a},l.scale=function(a){return arguments.length?(c=+a,l):c},l.scaleExtent=function(a){return arguments.length?(e=a==null?dF:a.map(Number),l):e},l.x=function(a){return arguments.length?(h=a,g=a.copy(),l):h},l.y=function(a){return arguments.length?(j=a,i=a.copy(),l):j},d3.rebind(l,f,"on")};var dE,dF=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(a){var b=[],c=-1,d=a.length;while(++c<d)b.push(dH(a[c]));return b}},d3.layout.chord=function(){function j(){var a={},j=[],l=d3.range(e),m=[],n,o,p,q,r;b=[],c=[],n=0,q=-1;while(++q<e){o=0,r=-1;while(++r<e)o+=d[q][r];j.push(o),m.push(d3.range(e)),n+=o}g&&l.sort(function(a,b){return g(j[a],j[b])}),h&&m.forEach(function(a,b){a.sort(function(a,c){return h(d[b][a],d[b][c])})}),n=(2*Math.PI-f*e)/n,o=0,q=-1;while(++q<e){p=o,r=-1;while(++r<e){var s=l[q],t=m[s][r],u=d[s][t],v=o,w=o+=u*n;a[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}c.push({index:s,startAngle:p,endAngle:o,value:(o-p)/n}),o+=f}q=-1;while(++q<e){r=q-1;while(++r<e){var x=a[q+"-"+r],y=a[r+"-"+q];(x.value||y.value)&&b.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}}i&&k()}function k(){b.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var a={},b,c,d,e,f=0,g,h,i;return a.matrix=function(f){return arguments.length?(e=(d=f)&&d.length,b=c=null,a):d},a.padding=function(d){return arguments.length?(f=d,b=c=null,a):f},a.sortGroups=function(d){return arguments.length?(g=d,b=c=null,a):g},a.sortSubgroups=function(c){return arguments.length?(h=c,b=null,a):h},a.sortChords=function(c){return arguments.length?(i=c,b&&k(),a):i},a.chords=function(){return b||j(),b},a.groups=function(){return c||j(),c},a},d3.layout.force=function(){function r(a){return function(b,c,d,e,f){if(b.point!==a){var g=b.cx-a.x,h=b.cy-a.y,i=1/Math.sqrt(g*g+h*h);if((e-c)*i<k){var j=b.charge*i*i;return a.px-=g*j,a.py-=h*j,!0}if(b.point&&isFinite(i)){var j=b.pointCharge*i*i;a.px-=g*j,a.py-=h*j}}return!b.charge}}function s(b){dM(dL=b),dK=a}var a={},b=d3.dispatch("start","tick","end"),c=[1,1],d,e,f=.9,g=dR,h=dS,i=-30,j=.1,k=.8,l,m=[],n=[],o,p,q;return a.tick=function(){if((e*=.99)<.005)return b.end({type:"end",alpha:e=0}),!0;var a=m.length,d=n.length,g,h,k,l,s,t,u,v,w;for(h=0;h<d;++h){k=n[h],l=k.source,s=k.target,v=s.x-l.x,w=s.y-l.y;if(t=v*v+w*w)t=e*p[h]*((t=Math.sqrt(t))-o[h])/t,v*=t,w*=t,s.x-=v*(u=l.weight/(s.weight+l.weight)),s.y-=w*u,l.x+=v*(u=1-u),l.y+=w*u}if(u=e*j){v=c[0]/2,w=c[1]/2,h=-1;if(u)while(++h<a)k=m[h],k.x+=(v-k.x)*u,k.y+=(w-k.y)*u}if(i){dQ(g=d3.geom.quadtree(m),e,q),h=-1;while(++h<a)(k=m[h]).fixed||g.visit(r(k))}h=-1;while(++h<a)k=m[h],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*f,k.y-=(k.py-(k.py=k.y))*f);b.tick({type:"tick",alpha:e})},a.nodes=function(b){return arguments.length?(m=b,a):m},a.links=function(b){return arguments.length?(n=b,a):n},a.size=function(b){return arguments.length?(c=b,a):c},a.linkDistance=function(b){return arguments.length?(g=d3.functor(b),a):g},a.distance=a.linkDistance,a.linkStrength=function(b){return arguments.length?(h=d3.functor(b),a):h},a.friction=function(b){return arguments.length?(f=b,a):f},a.charge=function(b){return arguments.length?(i=typeof b=="function"?b:+b,a):i},a.gravity=function(b){return arguments.length?(j=b,a):j},a.theta=function(b){return arguments.length?(k=b,a):k},a.alpha=function(c){return arguments.length?(e?c>0?e=c:e=0:c>0&&(b.start({type:"start",alpha:e=c}),d3.timer(a.tick)),a):e},a.start=function(){function s(a,c){var d=t(b),e=-1,f=d.length,g;while(++e<f)if(!isNaN(g=d[e][a]))return g;return Math.random()*c}function t(){if(!l){l=[];for(d=0;d<e;++d)l[d]=[];for(d=0;d<f;++d){var a=n[d];l[a.source.index].push(a.target),l[a.target.index].push(a.source)}}return l[b]}var b,d,e=m.length,f=n.length,j=c[0],k=c[1],l,r;for(b=0;b<e;++b)(r=m[b]).index=b,r.weight=0;o=[],p=[];for(b=0;b<f;++b)r=n[b],typeof r.source=="number"&&(r.source=m[r.source]),typeof r.target=="number"&&(r.target=m[r.target]),o[b]=g.call(this,r,b),p[b]=h.call(this,r,b),++r.source.weight,++r.target.weight;for(b=0;b<e;++b)r=m[b],isNaN(r.x)&&(r.x=s("x",j)),isNaN(r.y)&&(r.y=s("y",k)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);q=[];if(typeof i=="function")for(b=0;b<e;++b)q[b]=+i.call(this,m[b],b);else for(b=0;b<e;++b)q[b]=i;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){d||(d=d3.behavior.drag().origin(Object).on("dragstart",s).on("drag",dP).on("dragend",dO)),this.on("mouseover.force",dM).on("mouseout.force",dN).call(d)},d3.rebind(a,b,"on")};var dK,dL;d3.layout.partition=function(){function c(a,b,d,e){var f=a.children;a.x=b,a.y=a.depth*e,a.dx=d,a.dy=e;if(f&&(h=f.length)){var g=-1,h,i,j;d=a.value?d/a.value:0;while(++g<h)c(i=f[g],b,j=i.value*d,e),b+=j}}function d(a){var b=a.children,c=0;if(b&&(f=b.length)){var e=-1,f;while(++e<f)c=Math.max(c,d(b[e]))}return 1+c}function e(e,f){var g=a.call(this,e,f);return c(g[0],0,b[0],b[1]/d(g[0])),g}var a=d3.layout.hierarchy(),b=[1,1];return e.size=function(a){return arguments.length?(b=a,e):b},ef(e,a)},d3.layout.pie=function(){function f(g,h){var i=g.map(function(b,c){return+a.call(f,b,c)}),j=+(typeof c=="function"?c.apply(this,arguments):c),k=((typeof e=="function"?e.apply(this,arguments):e)-c)/d3.sum(i),l=d3.range(g.length);b!=null&&l.sort(b===dT?function(a,b){return i[b]-i[a]}:function(a,c){return b(g[a],g[c])});var m=[];return l.forEach(function(a){m[a]={data:g[a],value:d=i[a],startAngle:j,endAngle:j+=d*k}}),m}var a=Number,b=dT,c=0,e=2*Math.PI;return f.value=function(b){return arguments.length?(a=b,f):a},f.sort=function(a){return arguments.length?(b=a,f):b},f.startAngle=function(a){return arguments.length?(c=a,f):c},f.endAngle=function(a){return arguments.length?(e=a,f):e},f};var dT={};d3.layout.stack=function(){function g(h,i){var j=h.map(function(b,c){return a.call(g,b,c)}),k=j.map(function(a,b){return a.map(function(a,b){return[e.call(g,a,b),f.call(g,a,b)]})}),l=b.call(g,k,i);j=d3.permute(j,l),k=d3.permute(k,l);var m=c.call(g,k,i),n=j.length,o=j[0].length,p,q,r;for(q=0;q<o;++q){d.call(g,j[0][q],r=m[q],k[0][q][1]);for(p=1;p<n;++p)d.call(g,j[p][q],r+=k[p-1][q][1],k[p][q][1])}return h}var a=Object,b=dZ,c=d$,d=dW,e=dU,f=dV;return g.values=function(b){return arguments.length?(a=b,g):a},g.order=function(a){return arguments.length?(b=typeof a=="function"?a:dX.get(a)||dZ,g):b},g.offset=function(a){return arguments.length?(c=typeof a=="function"?a:dY.get(a)||d$,g):c},g.x=function(a){return arguments.length?(e=a,g):e},g.y=function(a){return arguments.length?(f=a,g):f},g.out=function(a){return arguments.length?(d=a,g):d},g};var dX=d3.map({"inside-out":function(a){var b=a.length,c,d,e=a.map(d_),f=a.map(ea),g=d3.range(b).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(c=0;c<b;++c)d=g[c],h<i?(h+=f[d],j.push(d)):(i+=f[d],k.push(d));return k.reverse().concat(j)},reverse:function(a){return d3.range(a.length).reverse()},"default":dZ}),dY=d3.map({silhouette:function(a){var b=a.length,c=a[0].length,d=[],e=0,f,g,h,i=[];for(g=0;g<c;++g){for(f=0,h=0;f<b;f++)h+=a[f][g][1];h>e&&(e=h),d.push(h)}for(g=0;g<c;++g)i[g]=(e-d[g])/2;return i},wiggle:function(a){var b=a.length,c=a[0],d=c.length,e=0,f,g,h,i,j,k,l,m,n,o=[];o[0]=m=n=0;for(g=1;g<d;++g){for(f=0,i=0;f<b;++f)i+=a[f][g][1];for(f=0,j=0,l=c[g][0]-c[g-1][0];f<b;++f){for(h=0,k=(a[f][g][1]-a[f][g-1][1])/(2*l);h<f;++h)k+=(a[h][g][1]-a[h][g-1][1])/l;j+=k*a[f][g][1]}o[g]=m-=i?j/i*l:0,m<n&&(n=m)}for(g=0;g<d;++g)o[g]-=n;return o},expand:function(a){var b=a.length,c=a[0].length,d=1/b,e,f,g,h=[];for(f=0;f<c;++f){for(e=0,g=0;e<b;e++)g+=a[e][f][1];if(g)for(e=0;e<b;e++)a[e][f][1]/=g;else for(e=0;e<b;e++)a[e][f][1]=d}for(f=0;f<c;++f)h[f]=0;return h},zero:d$});d3.layout.histogram=function(){function e(e,f){var g=[],h=e.map(b,this),i=c.call(this,h,f),j=d.call(this,i,h,f),k,f=-1,l=h.length,m=j.length-1,n=a?1:1/l,o;while(++f<m)k=g[f]=[],k.dx=j[f+1]-(k.x=j[f]),k.y=0;f=-1;while(++f<l)o=h[f],o>=i[0]&&o<=i[1]&&(k=g[d3.bisect(j,o,1,m)-1],k.y+=n,k.push(e[f]));return g}var a=!0,b=Number,c=ee,d=ec;return e.value=function(a){return arguments.length?(b=a,e):b},e.range=function(a){return arguments.length?(c=d3.functor(a),e):c},e.bins=function(a){return arguments.length?(d=typeof a=="number"?function(b){return ed(b,a)}:d3.functor(a),e):d},e.frequency=function(b){return arguments.length?(a=!!b,e):a},e},d3.layout.hierarchy=function(){function e(f,h,i){var j=b.call(g,f,h),k=ek?f:{data:f};k.depth=h,i.push(k);if(j&&(m=j.length)){var l=-1,m,n=k.children=[],o=0,p=h+1;while(++l<m)d=e(j[l],p,i),d.parent=k,n.push(d),o+=d.value;a&&n.sort(a),c&&(k.value=o)}else c&&(k.value=+c.call(g,f,h)||0);return k}function f(a,b){var d=a.children,e=0;if(d&&(i=d.length)){var h=-1,i,j=b+1;while(++h<i)e+=f(d[h],j)}else c&&(e=+c.call(g,ek?a:a.data,b)||0);return c&&(a.value=e),e}function g(a){var b=[];return e(a,0,b),b}var a=ei,b=eg,c=eh;return g.sort=function(b){return arguments.length?(a=b,g):a},g.children=function(a){return arguments.length?(b=a,g):b},g.value=function(a){return arguments.length?(c=a,g):c},g.revalue=function(a){return f(a,0),a},g};var ek=!1;d3.layout.pack=function(){function c(c,d){var e=a.call(this,c,d),f=e[0];f.x=0,f.y=0,es(f);var g=b[0],h=b[1],i=1/Math.max(2*f.r/g,2*f.r/h);return et(f,g/2,h/2,i),e}var a=d3.layout.hierarchy().sort(el),b=[1,1];return c.size=function(a){return arguments.length?(b=a,c):b},ef(c,a)},d3.layout.cluster=function(){function d(d,e){var f=a.call(this,d,e),g=f[0],h,i=0,j,k;eG(g,function(a){var c=a.children;c&&c.length?(a.x=ew(c),a.y=ev(c)):(a.x=h?i+=b(a,h):0,a.y=0,h=a)});var l=ex(g),m=ey(g),n=l.x-b(l,m)/2,o=m.x+b(m,l)/2;return eG(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=(1-(g.y?a.y/g.y:1))*c[1]}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=ez,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},ef(d,a)},d3.layout.tree=function(){function d(d,e){function h(a,c){var d=a.children,e=a._tree;if(d&&(f=d.length)){var f,g=d[0],i,k=g,l,m=-1;while(++m<f)l=d[m],h(l,i),k=j(l,i,k),i=l;eH(a);var n=.5*(g._tree.prelim+l._tree.prelim);c?(e.prelim=c._tree.prelim+b(a,c),e.mod=e.prelim-n):e.prelim=n}else c&&(e.prelim=c._tree.prelim+b(a,c))}function i(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(e=c.length)){var d=-1,e;b+=a._tree.mod;while(++d<e)i(c[d],b)}}function j(a,c,d){if(c){var e=a,f=a,g=c,h=a.parent.children[0],i=e._tree.mod,j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m;while(g=eB(g),e=eA(e),g&&e)h=eA(h),f=eB(f),f._tree.ancestor=a,m=g._tree.prelim+k-e._tree.prelim-i+b(g,e),m>0&&(eI(eJ(g,a,d),a,m),i+=m,j+=m),k+=g._tree.mod,i+=e._tree.mod,l+=h._tree.mod,j+=f._tree.mod;g&&!eB(f)&&(f._tree.thread=g,f._tree.mod+=k-j),e&&!eA(h)&&(h._tree.thread=e,h._tree.mod+=i-l,d=a)}return d}var f=a.call(this,d,e),g=f[0];eG(g,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),h(g),i(g,-g._tree.prelim);var k=eC(g,eE),l=eC(g,eD),m=eC(g,eF),n=k.x-b(k,l)/2,o=l.x+b(l,k)/2,p=m.depth||1;return eG(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=a.depth/p*c[1],delete a._tree}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=ez,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},ef(d,a)},d3.layout.treemap=function(){function i(a,b){var c=-1,d=a.length,e,f;while(++c<d)f=(e=a[c]).value*(b<0?0:b),e.area=isNaN(f)||f<=0?0:f}function j(a){var b=a.children;if(b&&b.length){var c=e(a),d=[],f=b.slice(),g,h=Infinity,k,n=Math.min(c.dx,c.dy),o;i(f,c.dx*c.dy/a.value),d.area=0;while((o=f.length)>0)d.push(g=f[o-1]),d.area+=g.area,(k=l(d,n))<=h?(f.pop(),h=k):(d.area-=d.pop().area,m(d,n,c,!1),n=Math.min(c.dx,c.dy),d.length=d.area=0,h=Infinity);d.length&&(m(d,n,c,!0),d.length=d.area=0),b.forEach(j)}}function k(a){var b=a.children;if(b&&b.length){var c=e(a),d=b.slice(),f,g=[];i(d,c.dx*c.dy/a.value),g.area=0;while(f=d.pop())g.push(f),g.area+=f.area,f.z!=null&&(m(g,f.z?c.dx:c.dy,c,!d.length),g.length=g.area=0);b.forEach(k)}}function l(a,b){var c=a.area,d,e=0,f=Infinity,g=-1,i=a.length;while(++g<i){if(!(d=a[g].area))continue;d<f&&(f=d),d>e&&(e=d)}return c*=c,b*=b,c?Math.max(b*e*h/c,c/(b*f*h)):Infinity}function m(a,c,d,e){var f=-1,g=a.length,h=d.x,i=d.y,j=c?b(a.area/c):0,k;if(c==d.dx){if(e||j>d.dy)j=d.dy;while(++f<g)k=a[f],k.x=h,k.y=i,k.dy=j,h+=k.dx=Math.min(d.x+d.dx-h,j?b(k.area/j):0);k.z=!0,k.dx+=d.x+d.dx-h,d.y+=j,d.dy-=j}else{if(e||j>d.dx)j=d.dx;while(++f<g)k=a[f],k.x=h,k.y=i,k.dx=j,i+=k.dy=Math.min(d.y+d.dy-i,j?b(k.area/j):0);k.z=!1,k.dy+=d.y+d.dy-i,d.x+=j,d.dx-=j}}function n(b){var d=g||a(b),e=d[0];return e.x=0,e.y=0,e.dx=c[0],e.dy=c[1],g&&a.revalue(e),i([e],e.dx*e.dy/e.value),(g?k:j)(e),f&&(g=d),d}var a=d3.layout.hierarchy(),b=Math.round,c=[1,1],d=null,e=eK,f=!1,g,h=.5*(1+Math.sqrt(5));return n.size=function(a){return arguments.length?(c=a,n):c},n.padding=function(a){function b(b){var c=a.call(n,b,b.depth);return c==null?eK(b):eL(b,typeof c=="number"?[c,c,c,c]:c)}function c(b){return eL(b,a)}if(!arguments.length)return d;var f;return e=(d=a)==null?eK:(f=typeof a)==="function"?b:f==="number"?(a=[a,a,a,a],c):c,n},n.round=function(a){return arguments.length?(b=a?Math.round:Number,n):b!=Number},n.sticky=function(a){return arguments.length?(f=a,g=null,n):f},n.ratio=function(a){return arguments.length?(h=a,n):h},ef(n,a)},d3.csv=function(a,b){d3.text(a,"text/csv",function(a){b(a&&d3.csv.parse(a))})},d3.csv.parse=function(a){var b;return d3.csv.parseRows(a,function(a,c){if(c){var d={},e=-1,f=b.length;while(++e<f)d[b[e]]=a[e];return d}return b=a,null})},d3.csv.parseRows=function(a,b){function j(){if(f.lastIndex>=a.length)return d;if(i)return i=!1,c;var b=f.lastIndex;if(a.charCodeAt(b)===34){var e=b;while(e++<a.length)if(a.charCodeAt(e)===34){if(a.charCodeAt(e+1)!==34)break;e++}f.lastIndex=e+2;var g=a.charCodeAt(e+1);return g===13?(i=!0,a.charCodeAt(e+2)===10&&f.lastIndex++):g===10&&(i=!0),a.substring(b+1,e).replace(/""/g,'"')}var h=f.exec(a);return h?(i=h[0].charCodeAt(0)!==44,a.substring(b,h.index)):(f.lastIndex=a.length,a.substring(b))}var c={},d={},e=[],f=/\r\n|[,\r\n]/g,g=0,h,i;f.lastIndex=0;while((h=j())!==d){var k=[];while(h!==c&&h!==d)k.push(h),h=j();if(b&&!(k=b(k,g++)))continue;e.push(k)}return e},d3.csv.format=function(a){return a.map(eM).join("\n")},d3.geo={};var eO=Math.PI/180;d3.geo.azimuthal=function(){function i(b){var f=b[0]*eO-e,i=b[1]*eO,j=Math.cos(f),k=Math.sin(f),l=Math.cos(i),m=Math.sin(i),n=a!=="orthographic"?h*m+g*l*j:null,o,p=a==="stereographic"?1/(1+n):a==="gnomonic"?1/n:a==="equidistant"?(o=Math.acos(n),o?o/Math.sin(o):0):a==="equalarea"?Math.sqrt(2/(1+n)):1,q=p*l*k,r=p*(h*l*j-g*m);return[c*q+d[0],c*r+d[1]]}var a="orthographic",b,c=200,d=[480,250],e,f,g,h;return i.invert=function(b){var f=(b[0]-d[0])/c,i=(b[1]-d[1])/c,j=Math.sqrt(f*f+i*i),k=a==="stereographic"?2*Math.atan(j):a==="gnomonic"?Math.atan(j):a==="equidistant"?j:a==="equalarea"?2*Math.asin(.5*j):Math.asin(j),l=Math.sin(k),m=Math.cos(k);return[(e+Math.atan2(f*l,j*g*m+i*h*l))/eO,Math.asin(m*h-(j?i*l*g/j:0))/eO]},i.mode=function(b){return arguments.length?(a=b+"",i):a},i.origin=function(a){return arguments.length?(b=a,e=b[0]*eO,f=b[1]*eO,g=Math.cos(f),h=Math.sin(f),i):b},i.scale=function(a){return arguments.length?(c=+a,i):c},i.translate=function(a){return arguments.length?(d=[+a[0],+a[1]],i):d},i.origin([0,0])},d3.geo.albers=function(){function i(a){var b=f*(eO*a[0]-e),i=Math.sqrt(g-2*f*Math.sin(eO*a[1]))/f;return[c*i*Math.sin(b)+d[0],c*(i*Math.cos(b)-h)+d[1]]}function j(){var c=eO*b[0],d=eO*b[1],j=eO*a[1],k=Math.sin(c),l=Math.cos(c);return e=eO*a[0],f=.5*(k+Math.sin(d)),g=l*l+2*f*k,h=Math.sqrt(g-2*f*Math.sin(j))/f,i}var a=[-98,38],b=[29.5,45.5],c=1e3,d=[480,250],e,f,g,h;return i.invert=function(a){var b=(a[0]-d[0])/c,i=(a[1]-d[1])/c,j=h+i,k=Math.atan2(b,j),l=Math.sqrt(b*b+j*j);return[(e+k/f)/eO,Math.asin((g-l*l*f*f)/(2*f))/eO]},i.origin=function(b){return arguments.length?(a=[+b[0],+b[1]],j()):a},i.parallels=function(a){return arguments.length?(b=[+a[0],+a[1]],j()):b},i.scale=function(a){return arguments.length?(c=+a,i):c},i.translate=function(a){return arguments.length?(d=[+a[0],+a[1]],i):d},j()},d3.geo.albersUsa=function(){function e(e){var f=e[0],g=e[1];return(g>50?b:f<-140?c:g<21?d:a)(e)}var a=d3.geo.albers(),b=d3.geo.albers().origin([-160,60]).parallels([55,65]),c=d3.geo.albers().origin([-160,20]).parallels([8,18]),d=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(f){return arguments.length?(a.scale(f),b.scale(f*.6),c.scale(f),d.scale(f*1.5),e.translate(a.translate())):a.scale()},e.translate=function(f){if(!arguments.length)return a.translate();var g=a.scale()/1e3,h=f[0],i=f[1];return a.translate(f),b.translate([h-400*g,i+170*g]),c.translate([h-190*g,i+200*g]),d.translate([h+580*g,i+430*g]),e},e.scale(a.scale())},d3.geo.bonne=function(){function g(g){var h=g[0]*eO-c,i=g[1]*eO-d;if(e){var j=f+e-i,k=h*Math.cos(i)/j;h=j*Math.sin(k),i=j*Math.cos(k)-f}else h*=Math.cos(i),i*=-1;return[a*h+b[0],a*i+b[1]]}var a=200,b=[480,250],c,d,e,f;return g.invert=function(d){var g=(d[0]-b[0])/a,h=(d[1]-b[1])/a;if(e){var i=f+h,j=Math.sqrt(g*g+i*i);h=f+e-j,g=c+j*Math.atan2(g,i)/Math.cos(h)}else h*=-1,g/=Math.cos(h);return[g/eO,h/eO]},g.parallel=function(a){return arguments.length?(f=1/Math.tan(e=a*eO),g):e/eO},g.origin=function(a){return arguments.length?(c=a[0]*eO,d=a[1]*eO,g):[c/eO,d/eO]},g.scale=function(b){return arguments.length?(a=+b,g):a},g.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],g):b},g.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function c(c){var d=c[0]/360,e=-c[1]/360;return[a*d+b[0],a*e+b[1]]}var a=500,b=[480,250];return c.invert=function(c){var d=(c[0]-b[0])/a,e=(c[1]-b[1])/a;return[360*d,-360*e]},c.scale=function(b){return arguments.length?(a=+b,c):a},c.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],c):b},c},d3.geo.mercator=function(){function c(c){var d=c[0]/360,e=-(Math.log(Math.tan(Math.PI/4+c[1]*eO/2))/eO)/360;return[a*d+b[0],a*Math.max(-0.5,Math.min(.5,e))+b[1]]}var a=500,b=[480,250];return c.invert=function(c){var d=(c[0]-b[0])/a,e=(c[1]-b[1])/a;return[360*d,2*Math.atan(Math.exp(-360*e*eO))/eO-90]},c.scale=function(b){return arguments.length?(a=+b,c):a},c.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],c):b},c},d3.geo.path=function(){function d(c,d){return typeof a=="function"&&(b=eQ(a.apply(this,arguments))),f(c)||null}function e(a){return c(a).join(",")}function h(a){var b=k(a[0]),c=0,d=a.length;while(++c<d)b-=k(a[c]);return b}function i(a){var b=d3.geom.polygon(a[0].map(c)),d=b.area(),e=b.centroid(d<0?(d*=-1,1):-1),f=e[0],g=e[1],h=d,i=0,j=a.length;while(++i<j)b=d3.geom.polygon(a[i].map(c)),d=b.area(),e=b.centroid(d<0?(d*=-1,1):-1),f-=e[0],g-=e[1],h-=d;return[f,g,6*h]}function k(a){return Math.abs(d3.geom.polygon(a.map(c)).area())}var a=4.5,b=eQ(a),c=d3.geo.albersUsa(),f=eP({FeatureCollection:function(a){var b=[],c=a.features,d=-1,e=c.length;while(++d<e)b.push(f(c[d].geometry));return b.join("")},Feature:function(a){return f(a.geometry)},Point:function(a){return"M"+e(a.coordinates)+b},MultiPoint:function(a){var c=[],d=a.coordinates,f=-1,g=d.length;while(++f<g)c.push("M",e(d[f]),b);return c.join("")},LineString:function(a){var b=["M"],c=a.coordinates,d=-1,f=c.length;while(++d<f)b.push(e(c[d]),"L");return b.pop(),b.join("")},MultiLineString:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i;while(++d<f){g=c[d],h=-1,i=g.length,b.push("M");while(++h<i)b.push(e(g[h]),"L");b.pop()}return b.join("")},Polygon:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i;while(++d<f){g=c[d],h=-1;if((i=g.length-1)>0){b.push("M");while(++h<i)b.push(e(g[h]),"L");b[b.length-1]="Z"}}return b.join("")},MultiPolygon:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i,j,k,l;while(++d<f){g=c[d],h=-1,i=g.length;while(++h<i){j=g[h],k=-1;if((l=j.length-1)>0){b.push("M");while(++k<l)b.push(e(j[k]),"L");b[b.length-1]="Z"}}}return b.join("")},GeometryCollection:function(a){var b=[],c=a.geometries,d=-1,e=c.length;while(++d<e)b.push(f(c[d]));return b.join("")}}),g=d.area=eP({FeatureCollection:function(a){var b=0,c=a.features,d=-1,e=c.length;while(++d<e)b+=g(c[d]);return b},Feature:function(a){return g(a.geometry)},Polygon:function(a){return h(a.coordinates)},MultiPolygon:function(a){var b=0,c=a.coordinates,d=-1,e=c.length;while(++d<e)b+=h(c[d]);return b},GeometryCollection:function(a){var b=0,c=a.geometries,d=-1,e=c.length;while(++d<e)b+=g(c[d]);return b}},0),j=d.centroid=eP({Feature:function(a){return j(a.geometry)},Polygon:function(a){var b=i(a.coordinates);return[b[0]/b[2],b[1]/b[2]]},MultiPolygon:function(a){var b=0,c=a.coordinates,d,e=0,f=0,g=0,h=-1,j=c.length;while(++h<j)d=i(c[h]),e+=d[0],f+=d[1],g+=d[2];return[e/g,f/g]}});return d.projection=function(a){return c=a,d},d.pointRadius=function(c){return typeof c=="function"?a=c:(a=+c,b=eQ(a)),d},d},d3.geo.bounds=function(a){var b=Infinity,c=Infinity,d=-Infinity,e=-Infinity;return eR(a,function(a,f){a<b&&(b=a),a>d&&(d=a),f<c&&(c=f),f>e&&(e=f)}),[[b,c],[d,e]]};var eS={Feature:eT,FeatureCollection:eU,GeometryCollection:eV,LineString:eW,MultiLineString:eX,MultiPoint:eW,MultiPolygon:eY,Point:eZ,Polygon:e$};d3.geo.circle=function(){function e(){}function f(a){return d.distance(a)<c}function h(a){var b=-1,e=a.length,f=[],g,h,j,k,l;while(++b<e)l=d.distance(j=a[b]),l<c?(h&&f.push(fb(h,j)((k-c)/(k-l))),f.push(j),g=h=null):(h=j,!g&&f.length&&(f.push(fb(f[f.length-1],h)((c-k)/(l-k))),g=h)),k=l;return h&&f.length&&(l=d.distance(j=f[0]),f.push(fb(h,j)((k-c)/(k-l)))),i(f)}function i(a){var b=0,c=a.length,e,f,g=c?[a[0]]:a,h,i=d.source();while(++b<c){h=d.source(a[b-1])(a[b]).coordinates;for(e=0,f=h.length;++e<f;)g.push(h[e])}return d.source(i),g}var a=[0,0],b=89.99,c=b*eO,d=d3.geo.greatArc().target(Object);e.clip=function(b){return d.source(typeof a=="function"?a.apply(this,arguments):a),g(b)};var g=eP({FeatureCollection:function(a){var b=a.features.map(g).filter(Object);return b&&(a=Object.create(a),a.features=b,a)},Feature:function(a){var b=g(a.geometry);return b&&(a=Object.create(a),a.geometry=b,a)},Point:function(a){return f(a.coordinates)&&a},MultiPoint:function(a){var b=a.coordinates.filter(f);return b.length&&{type:a.type,coordinates:b}},LineString:function(a){var b=h(a.coordinates);return b.length&&(a=Object.create(a),a.coordinates=b,a)},MultiLineString:function(a){var b=a.coordinates.map(h).filter(function(a){return a.length});return b.length&&(a=Object.create(a),a.coordinates=b,a)},Polygon:function(a){var b=a.coordinates.map(h);return b[0].length&&(a=Object.create(a),a.coordinates=b,a)},MultiPolygon:function(a){var b=a.coordinates.map(function(a){return a.map(h)}).filter(function(a){return a[0].length});return b.length&&(a=Object.create(a),a.coordinates=b,a)},GeometryCollection:function(a){var b=a.geometries.map(g).filter(Object);return b.length&&(a=Object.create(a),a.geometries=b,a)}});return e.origin=function(b){return arguments.length?(a=b,e):a},e.angle=function(a){return arguments.length?(c=(b=+a)*eO,e):b},e.precision=function(a){return arguments.length?(d.precision(a),e):d.precision()},e},d3.geo.greatArc=function(){function d(){var d=typeof a=="function"?a.apply(this,arguments):a,e=typeof b=="function"?b.apply(this,arguments):b,f=fb(d,e),g=c/f.d,h=0,i=[d];while((h+=g)<1)i.push(f(h));return i.push(e),{type:"LineString",coordinates:i}}var a=e_,b=fa,c=6*eO;return d.distance=function(){var c=typeof a=="function"?a.apply(this,arguments):a,d=typeof b=="function"?b.apply(this,arguments):b;return fb(c,d).d},d.source=function(b){return arguments.length?(a=b,d):a},d.target=function(a){return arguments.length?(b=a,d):b},d.precision=function(a){return arguments.length?(c=a*eO,d):c/eO},d},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(a,b){var c=b||fe(a),d=[],e=c[0],f=c[1],g=0,h=0,i=NaN,j=NaN,k=0;do k=0,a(e-1,f-1)&&(k+=1),a(e,f-1)&&(k+=2),a(e-1,f)&&(k+=4),a(e,f)&&(k+=8),k===6?(g=j===-1?-1:1,h=0):k===9?(g=0,h=i===1?-1:1):(g=fc[k],h=fd[k]),g!=i&&h!=j&&(d.push([e,f]),i=g,j=h),e+=g,f+=h;while(c[0]!=e||c[1]!=f);return d};var fc=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],fd=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(a){if(a.length<3)return[];var b=a.length,c=b-1,d=[],e=[],f,g,h=0,i,j,k,l,m,n,o,p;for(f=1;f<b;++f)a[f][1]<a[h][1]?h=f:a[f][1]==a[h][1]&&(h=a[f][0]<a[h][0]?f:h);for(f=0;f<b;++f){if(f===h)continue;j=a[f][1]-a[h][1],i=a[f][0]-a[h][0],d.push({angle:Math.atan2(j,i),index:f})}d.sort(function(a,b){return a.angle-b.angle}),o=d[0].angle,n=d[0].index,m=0;for(f=1;f<c;++f)g=d[f].index,o==d[f].angle?(i=a[n][0]-a[h][0],j=a[n][1]-a[h][1],k=a[g][0]-a[h][0],l=a[g][1]-a[h][1],i*i+j*j>=k*k+l*l?d[f].index=-1:(d[m].index=-1,o=d[f].angle,m=f,n=g)):(o=d[f].angle,m=f,n=g);e.push(h);for(f=0,g=0;f<2;++g)d[g].index!==-1&&(e.push(d[g].index),f++);p=e.length;for(;g<c;++g){if(d[g].index===-1)continue;while(!ff(e[p-2],e[p-1],d[g].index,a))--p;e[p++]=d[g].index}var q=[];for(f=0;f<p;++f)q.push(a[e[f]]);return q},d3.geom.polygon=function(a){return a.area=function(){var b=0,c=a.length,d=a[c-1][0]*a[0][1],e=a[c-1][1]*a[0][0];while(++b<c)d+=a[b-1][0]*a[b][1],e+=a[b-1][1]*a[b][0];return(e-d)*.5},a.centroid=function(b){var c=-1,d=a.length,e=0,f=0,g,h=a[d-1],i;arguments.length||(b=-1/(6*a.area()));while(++c<d)g=h,h=a[c],i=g[0]*h[1]-h[0]*g[1],e+=(g[0]+h[0])*i,f+=(g[1]+h[1])*i;return[e*b,f*b]},a.clip=function(b){var c,d=-1,e=a.length,f,g,h=a[e-1],i,j,k;while(++d<e){c=b.slice(),b.length=0,i=a[d],j=c[(g=c.length)-1],f=-1;while(++f<g)k=c[f],fg(k,h,i)?(fg(j,h,i)||b.push(fh(j,k,h,i)),b.push(k)):fg(j,h,i)&&b.push(fh(j,k,h,i)),j=k;h=i}return b},a},d3.geom.voronoi=function(a){var b=a.map(function(){return[]});return fj(a,function(a){var c,d,e,f,g,h;a.a===1&&a.b>=0?(c=a.ep.r,d=a.ep.l):(c=a.ep.l,d=a.ep.r),a.a===1?(g=c?c.y:-1e6,e=a.c-a.b*g,h=d?d.y:1e6,f=a.c-a.b*h):(e=c?c.x:-1e6,g=a.c-a.a*e,f=d?d.x:1e6,h=a.c-a.a*f);var i=[e,g],j=[f,h];b[a.region.l.index].push(i,j),b[a.region.r.index].push(i,j)}),b.map(function(b,c){var d=a[c][0],e=a[c][1];return b.forEach(function(a){a.angle=Math.atan2(a[0]-d,a[1]-e)}),b.sort(function(a,b){return a.angle-b.angle}).filter(function(a,c){return!c||a.angle-b[c-1].angle>1e-10})})};var fi={l:"r",r:"l"};d3.geom.delaunay=function(a){var b=a.map(function(){return[]}),c=[];return fj(a,function(c){b[c.region.l.index].push(a[c.region.r.index])}),b.forEach(function(b,d){var e=a[d],f=e[0],g=e[1];b.forEach(function(a){a.angle=Math.atan2(a[0]-f,a[1]-g)}),b.sort(function(a,b){return a.angle-b.angle});for(var h=0,i=b.length-1;h<i;h++)c.push([e,b[h],b[h+1]])}),c},d3.geom.quadtree=function(a,b,c,d,e){function k(a,b,c,d,e,f){if(isNaN(b.x)||isNaN(b.y))return;if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?l(a,b,c,d,e,f):(a.point=null,l(a,g,c,d,e,f),l(a,b,c,d,e,f)):a.point=b}else l(a,b,c,d,e,f)}function l(a,b,c,d,e,f){var g=(c+e)*.5,h=(d+f)*.5,i=b.x>=g,j=b.y>=h,l=(j<<1)+i;a.leaf=!1,a=a.nodes[l]||(a.nodes[l]=fk()),i?c=g:e=g,j?d=h:f=h,k(a,b,c,d,e,f)}var f,g=-1,h=a.length;h&&isNaN(a[0].x)&&(a=a.map(fm));if(arguments.length<5)if(arguments.length===3)e=d=c,c=b;else{b=c=Infinity,d=e=-Infinity;while(++g<h)f=a[g],f.x<b&&(b=f.x),f.y<c&&(c=f.y),f.x>d&&(d=f.x),f.y>e&&(e=f.y);var i=d-b,j=e-c;i>j?e=c+i:d=b+j}var m=fk();return m.add=function(a){k(m,a,b,c,d,e)},m.visit=function(a){fl(a,m,b,c,d,e)},a.forEach(m.add),m},d3.time={};var fn=Date;fo.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){fp.setUTCDate.apply(this._,arguments)},setDay:function(){fp.setUTCDay.apply(this._,arguments)},setFullYear:function(){fp.setUTCFullYear.apply(this._,arguments)},setHours:function(){fp.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){fp.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){fp.setUTCMinutes.apply(this._,arguments)},setMonth:function(){fp.setUTCMonth.apply(this._,arguments)},setSeconds:function(){fp.setUTCSeconds.apply(this._,arguments)},setTime:function(){fp.setTime.apply(this._,arguments)}};var fp=Date.prototype;d3.time.format=function(a){function c(c){var d=[],e=-1,f=0,g,h;while(++e<b)a.charCodeAt(e)==37&&(d.push(a.substring(f,e),(h=fv[g=a.charAt(++e)])?h(c):g),f=e+1);return d.push(a.substring(f,e)),d.join("")}var b=a.length;return c.parse=function(b){var c={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},d=fq(c,a,b,0);if(d!=b.length)return null;"p"in c&&(c.H=c.H%12+c.p*12);var e=new fn;return e.setFullYear(c.y,c.m,c.d),e.setHours(c.H,c.M,c.S,c.L),e},c.toString=function(){return a},c};var fr=d3.format("02d"),fs=d3.format("03d"),ft=d3.format("04d"),fu=d3.format("2d"),fv={a:function(a){return d3_time_weekdays[a.getDay()].substring(0,3)},A:function(a){return d3_time_weekdays[a.getDay()]},b:function(a){return fG[a.getMonth()].substring(0,3)},B:function(a){return fG[a.getMonth()]},c:d3.time.format("%a %b %e %H:%M:%S %Y"),d:function(a){return fr(a.getDate())},e:function(a){return fu(a.getDate())},H:function(a){return fr(a.getHours())},I:function(a){return fr(a.getHours()%12||12)},j:function(a){return fs(1+d3.time.dayOfYear(a))},L:function(a){return fs(a.getMilliseconds())},m:function(a){return fr(a.getMonth()+1)},M:function(a){return fr(a.getMinutes())},p:function(a){return a.getHours()>=12?"PM":"AM"},S:function(a){return fr(a.getSeconds())},U:function(a){return fr(d3.time.sundayOfYear(a))},w:function(a){return a.getDay()},W:function(a){return fr(d3.time.mondayOfYear(a))},x:d3.time.format("%m/%d/%y"),X:d3.time.format("%H:%M:%S"),y:function(a){return fr(a.getFullYear()%100)},Y:function(a){return ft(a.getFullYear()%1e4)},Z:fW,"%":function(a){return"%"}},fw={a:fx,A:fy,b:fB,B:fD,c:fH,d:fO,e:fO,H:fP,I:fP,L:fS,m:fN,M:fQ,p:fU,S:fR,x:fI,X:fJ,y:fL,Y:fK},fz=/^(?:sun|mon|tue|wed|thu|fri|sat)/i,fA=/^(?:Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday)/i;d3_time_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var fC=d3.map({jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}),fE=/^(?:January|February|March|April|May|June|July|August|September|October|November|December)/ig,fF=d3.map({january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11}),fG=["January","February","March","April","May","June","July","August","September","October","November","December"],fT=/\s*\d+/,fV=d3.map({am:0,pm:1});d3.time.format.utc=function(a){function c(a){try{fn=fo;var c=new fn;return c._=a,b(c)}finally{fn=Date}}var b=d3.time.format(a);return c.parse=function(a){try{fn=fo;var c=b.parse(a);return c&&c._}finally{fn=Date}},c.toString=b.toString,c};var fX=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?fY:fX,fY.parse=function(a){return new Date(a)},fY.toString=fX.toString,d3.time.second=fZ(function(a){return new fn(Math.floor(a/1e3)*1e3)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*1e3)},function(a){return a.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=fZ(function(a){return new fn(Math.floor(a/6e4)*6e4)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*6e4)},function(a){return a.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=fZ(function(a){var b=a.getTimezoneOffset()/60;return new fn((Math.floor(a/36e5-b)+b)*36e5)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*36e5)},function(a){return a.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=fZ(function(a){return new fn(a.getFullYear(),a.getMonth(),a.getDate())},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(a){var b=d3.time.year(a);return Math.floor((a-b)/864e5-(a.getTimezoneOffset()-b.getTimezoneOffset())/1440)},d3_time_weekdays.forEach(function(a,b){a=a.toLowerCase(),b=7-b;var c=d3.time[a]=fZ(function(a){return(a=d3.time.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+Math.floor(b)*7)},function(a){var c=d3.time.year(a).getDay();return Math.floor((d3.time.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});d3.time[a+"s"]=c.range,d3.time[a+"s"].utc=c.utc.range,d3.time[a+"OfYear"]=function(a){var c=d3.time.year(a).getDay();return Math.floor((d3.time.dayOfYear(a)+(c+b)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=fZ(function(a){return new fn(a.getFullYear(),a.getMonth(),1)},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=fZ(function(a){return new fn(a.getFullYear(),0,1)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var gf=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],gg=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],gh=[[d3.time.format("%Y"),function(a){return!0}],[d3.time.format("%B"),function(a){return a.getMonth()}],[d3.time.format("%b %d"),function(a){return a.getDate()!=1}],[d3.time.format("%a %d"),function(a){return a.getDay()&&a.getDate()!=1}],[d3.time.format("%I %p"),function(a){return a.getHours()}],[d3.time.format("%I:%M"),function(a){return a.getMinutes()}],[d3.time.format(":%S"),function(a){return a.getSeconds()}],[d3.time.format(".%L"),function(a){return a.getMilliseconds()}]],gi=d3.scale.linear(),gj=gc(gh);gg.year=function(a,b){return gi.domain(a.map(ge)).ticks(b).map(gd)},d3.time.scale=function(){return f_(d3.scale.linear(),gg,gj)};var gk=gg.map(function(a){return[a[0].utc,a[1]]}),gl=[[d3.time.format.utc("%Y"),function(a){return!0}],[d3.time.format.utc("%B"),function(a){return a.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(a){return a.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(a){return a.getUTCDay()&&a.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(a){return a.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(a){return a.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(a){return a.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(a){return a.getUTCMilliseconds()}]],gm=gc(gl);gk.year=function(a,b){return gi.domain(a.map(go)).ticks(b).map(gn)},d3.time.scale.utc=function(){return f_(d3.scale.linear(),gk,gm)}}(),define("libs/draw/d3/d3.v2",function(){}),define("tau/ui/extensions/board.overview/ui.extension.board.overview",["Underscore","jQuery","tau/core/event.emitter","libs/draw/d3/d3.v2"],function(_,$,a,b){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=b.find("[role=holder]");this.isVisible=!1;var d=this;b.delegate("[role=action-switch]","click",function(){var a=$(".i-role-board-body");d.isVisible?(d.clean(c,a),c.hide()):(c.show(),c.detach(),d.draw(c,a),c.appendTo(b)),d.isVisible=!d.isVisible,b.toggleClass("tau-boardoverview_active_true",d.isVisible)})},"bus afterRender:last+output.changed:last":function(a){var b=a.afterRender.data.element;if(this.isVisible==0)return;var c=this,d=b.find("[role=holder]");d.addClass("tau-boardoverview__holder_state_redraw");var e=$(".i-role-board-body");setTimeout(function(){c.clean(d,e),c.draw(d,e),d.removeClass("tau-boardoverview__holder_state_redraw")},10)},clean:function(a,b){a.find("svg").remove(),b.find(".i-role-grid").unbind("scroll.overview")},draw:function(a,b){var c=b.find(".i-role-grid"),d=c[0],e=c.find("table"),f=e[0],g=this.getData(b),h,i;g.colNum>10||g.rowNum>10?i={w:400,h:400}:i={w:200,h:200};var j={w:e.width(),h:e.height()};j.w>j.h?h=i.w:h=i.w*j.w/j.h;var k={gridReal:j.w,gridClient:Math.min(d.clientWidth,f.clientWidth),overReal:h,overClient:null},l=k.gridReal/h;k.overClient=k.gridClient/k.gridReal*k.overReal;var m={gridReal:j.h,gridClient:Math.min(d.clientHeight,f.clientHeight),overReal:null,overClient:null},n=m.gridReal/l;m.overReal=n,m.overClient=m.gridClient/m.gridReal*m.overReal,a.height(n),a.width(h);var o=a[0],p=d3.select(o).append("svg").attr("class","chart").attr("width",h).attr("height",n),q=0,r=0;_.forEach(g.rows,function(a,b){var c=a.height/l;q=0,_.forEach(a.cells,function(a,b){var d=a.width/l,e=p.append("rect").attr("class","cell").attr("width",d).attr("height",c).attr("x",q).attr("y",r);_.forEach(a.cards,function(a,b){var c="card-us",d=a.width/l,e=a.height/l,f=p.append("rect").attr("class","card "+c).attr("width",d).attr("height",e).attr("x",a.offsetLeft/l).attr("y",a.offsetTop/l)}),q+=d}),r+=a.height/l});var s={x:d.scrollLeft/l,y:d.scrollTop/l},t=p.append("rect").data([{x:s.x,y:s.y}]).attr("class","visibler").attr("width",k.overClient).attr("height",m.overClient).attr("x",function(a){return a.x}).attr("y",function(a){return a.y}),u=function(){var a=d3.mouse(p[0][0]),b=Math.max(0,Math.min(h-k.overClient,a[0]-k.overClient/2)),c=Math.max(0,Math.min(n-m.overClient,a[1]-m.overClient/2));t.attr("x",b).attr("y",c).data([{x:b,y:c}]);var e=b*l,f=c*l;d.scrollLeft=e,d.scrollTop=f};p.on("click",u);var v=function(a){var b=Math.max(0,Math.min(h-k.overClient,d3.event.x)),c=Math.max(0,Math.min(n-m.overClient,d3.event.y));t.attr("x",a.x=b).attr("y",a.y=c)},w=function(){var a=t.attr("x"),b=t.attr("y"),c=a*l,e=b*l;d.scrollLeft=c,d.scrollTop=e},x=d3.behavior.drag().origin(Object).on("drag",v).on("dragend",w);t.call(x);var y=function(){var a={x:c.scrollLeft(),y:c.scrollTop()},b=Math.max(0,Math.min(h-k.overClient,a.x/l)),d=Math.max(0,Math.min(n-m.overClient,a.y/l));t.attr("x",b).attr("y",d).data([{x:b,y:d}])};c.bind("scroll.overview",y)},getData:function(a){var b=function(a,b){return parseInt(getComputedStyle(a)[b],10)},c={rows:[],colNum:0,rowNum:0},d=a.find(".i-role-grid");return d.find("tr").each(function(){var a={height:this.clientHeight||$(this).height(),cells:[]};c.rows.push(a),$(".i-role-cellholder",this).each(function(){if(this.getAttribute("data-is-hidden"))return;var c=b(this,"width");if(_.isNaN(c))return;var d={width:c+1,cards:[]};a.cells.push(d),$(".i-role-card",this).each(function(){d.cards.push({id:this.id,offsetLeft:this.offsetLeft,offsetTop:this.offsetTop,width:b(this,"width"),height:b(this,"height")})})})}),c.rows.length&&(c.colNum=a.find(".i-role-header[data-dimension=x] .i-role-cellholder:not([data-is-hidden=1])").length,c.rowNum=a.find(".i-role-header[data-dimension=y] .i-role-cellholder:not([data-is-hidden=1])").length),c}})}),define("tau/ui/templates/board.overview/ui.template.board.overview",["tau/core/templates-factory"],function(a){var b={name:"board.overview",markup:['<div class="tau-boardoverview">','<button role="action-switch" class="tau-btn tau-boardoverview__switcher" data-texthide="hide navigation" data-textshow="show navigation"></button>','<div role="holder" class="tau-boardoverview__holder">',"</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/core/bus.profiler",["Underscore","tau/core/class"],function(_,a){var b=a.extend({init:function(a){var b=this;b.stream=[],b.stopped=!1;var c=a.fire;a.fire=function(){var a=arguments;!b.stopped&&b.registerEvent(a),c.apply(this,a)}},stop:function(){this.stopped=!0},registerEvent:function(a){var b=+(new Date),c={tick:b,name:a[0],data:a[1]||{}};this.stream.push(c)},data:function(){return this.stream}});return b}),define("tau/ui/extensions/board.plus/ui.board.plus.utils",["Underscore"],function(_){var a={};return{generateId:function(a){var b=[];return a.hasOwnProperty("x")&&(b.push("x"),b.push(a.x),b.push("-")),a.hasOwnProperty("y")&&(b.push("y"),b.push(a.y),b.push("-")),b.join("")},generateElementData:function(a){var b=[];return _(a).each(function(a,c){b.push("data-"+c+'="'+a+'"')}),b.join(" ")},generateCardId:function(a){return a.type.toLowerCase()+"-"+a.id},dimension:function(b,c){var d=b.attr("id");a[d]||(a[d]={});var e=a[d],f={x:c.attr("data-x"),y:c.attr("data-y")},g=c.attr("role");e.all||(e.all=b.find("td.i-role-"+g));var h=function(){return!1};f.x&&(h=function(){return this.getAttribute("data-x")==f.x}),f.y&&(h=function(){return this.getAttribute("data-y")==f.y});var i=c.attr("id");return e[i]||(e[i]=e.all.filter(h)),e[i]},isHidden:function(a){return a.attr("data-is-hidden")||!1},isCollapsed:function(a){return a.attr("data-is-collapsed")||!1}}}),define("tau/views/view.board.plus",["jQuery","tau/core/event.emitter","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,a,b){return a.extend({name:"view.board.plus","bus view.build.skeleton":function(a){var b=a.data;this.fire("template.bind",{name:"boardplus.skeleton",data:b})},"bus template.boardplus.skeleton.bound":function(a){var b=this,c=a.data.element;this.fire("view.skeleton.built",{element:c});var d=c.find(".i-role-cell");b.fire("view.cellSlot.built.start",{cells:d}),d.each(function(){b.fire("view.cellSlot.built",{element:this,data:{x:this.getAttribute("data-x")||null,y:this.getAttribute("data-y")||null}})}),b.fire("view.cellSlot.built.end",{cells:d})},"bus view.build.cell.skeleton":function(a){var b=a.data,c=b.hasOwnProperty("x"),d=b.hasOwnProperty("y"),e=c&&d?"boardplus.cell.grid.skeleton":"boardplus.cell.axis.skeleton";this.bindCellTemplate(e,b)},bindCellTemplate:function(a,b){this.fire("template.bind",{name:a,data:b})},appendCellToBoardSkeleton:function(a,c){var d=a.data,e=a.element,f=b.generateId(d),g=c.find("#"+f);g.append(e),this.fireCellSkeletonBuilt({element:g,data:d})},fireCellSkeletonBuilt:function(a){this.fire("view.cell.skeleton.built",a)},"bus view.skeleton.built:last+template.boardplus.cell.grid.skeleton.bound":function(a){var b=a["view.skeleton.built"].data.element,c=a["template.boardplus.cell.grid.skeleton.bound"].data;this.appendCellToBoardSkeleton(c,b)},"bus view.skeleton.built:last+template.boardplus.cell.axis.skeleton.bound":function(a){var b=a["view.skeleton.built"].data.element,c=a["template.boardplus.cell.axis.skeleton.bound"].data;this.appendCellToBoardSkeleton(c,b)},"bus view.cell.skeleton.built":function(a){var b=this,c=a.data,d=c.data,e=d.hasOwnProperty("x"),f=d.hasOwnProperty("y");if(e&&f){var g=c.element;g.find(".i-role-card").each(function(){var a=$(this);b.fire("view.card.skeleton.built",{element:a,data:{id:a.attr("data-id"),type:a.attr("data-type")}})})}}})}),define("tau/core/query",["jQuery","Underscore","libs/json2"],function($,_){return{find:function(a,b){var c=[],d=this,e=d._formWhere(b,"",function(a,b,c){return{operator:a,key:b,value:c}});return _.each(a,function(a){var b=!1;_.each(e,function(c){if(b)return;var e=d._getObjectValue(a,c.key);_.isUndefined(e)&&(b=!0),c.operator.compare(e,c.value)||(b=!0)}),b||c.push(a)}),c},render:function(a,b){return this._getWhere(a,b)},_initializeDefaultRenders:function(a){_.defaults(a,{defaultRenderer:function(a,b){var c=this,d=[];return _.isArray(b)||(b=[b]),_.each(b,function(b){d.push("("+a+c.name+JSON.stringify(b)+")")}),d},$in:function(a,b){var c=this,d=[];_.isArray(b)||(b=[b]);var e=[];return _(b).each(function(a){e.push(JSON.stringify(a))}),d.push("("+a+" "+c.name+" ["+e.join(",")+"])"),d}})},_getObjectValue:function(a,b){var c=b.split("."),d=a;for(var e=0;e<c.length;e++){if(!a.hasOwnProperty(c[e]))return undefined;d=a[c[e]]}return d},_getQueryOperators:function(){var a={};this._initializeDefaultRenders(a);var b={$in:{name:"in",compare:function(a,b){return _.any(b,function(b){return b==a})}},$ne:{name:"!=",compare:function(a,b){return a!=b}},$eq:{name:"==",compare:function(a,b){return a==b}}};return _.each(_(b).keys(),function(c){var d=b[c];d.render=a.hasOwnProperty(c)?a[c]:a.defaultRenderer}),b},_isQueryValueWithOperator:function(a,b){var c=_(a).keys();if(c.length===0)return!1;var d=b||this._getQueryOperators();return d.hasOwnProperty(c[0])},_formWhere:function(a,b,c){var d=[];c=c||function(a,b,c){return a.render(b,c)};var e=this;b=b||"";var f=e._getQueryOperators();return _.each(_(a).keys(),function(g){if(g[0]==="$")return;var h=a[g],i=b+g;if(_.isString(h)||_.isNumber(h)||_.isDate(h)||_.isArray(h)||_.isBoolean(h)||_.isNull(h)){var j=h===null?"$isNull":"$eq";d=d.concat(c(f[j],i,h));return}if(e._isQueryValueWithOperator(h,f)){_.each(_(h).keys(),function(a){d=d.concat(c(f[a],i,h[a]))});return}var k=e._formWhere(h,g+".",c);_.each(k,function(a){d.push(a)})}),d},_getWhere:function(a,b){b=b||function(a){return"("+c.join("and")+")"};var c=this._formWhere(a);return c.length===0?"":b(c)}}}),define("tau/slice/url.resolver",["jQuery","Underscore","app.path","tau/core/query"],function($,_,a,b){var c=a.get(),d=c+"/slice/v1/";return{resolve:function(a,c){var e=a.global.acid;if(!e)throw"acid should be defined";var f=[d,c.method,"?type=matrix&definition={","cells:{"," items: [{ id:'"+a.cells.types[0]+"'}]",",filter: '"+(a.cells.filter||"")+"'","}",",x:{ id:'"+a.x.types[0]+"', filter:'"+(a.x.filter||"")+"'}",",y:{ id: '"+a.y.types[0]+"', filter:'"+(a.y.filter||"")+"'}",",global: {acid:'"+e+"'}","}"].join(""),g=_.clone(c.config||{});_.defaults(g,{$take:999}),f+="&take="+g.$take,g.$skip&&(f+="&skip="+g.$skip);var h=b.render(g);return h&&(f+="&where="+h),g.$set&&_.each(_.keys(g.$set),function(a){f+="&"+a+"="+g.$set[a]}),encodeURI(f)}}}),define("tau/slice/url.resolver.proto",["jQuery","Underscore","app.path","tau/core/query"],function($,_,a,b){var c=a.get(),d=c+"/slice/v1/";return{resolve:function(a,c){var e=a.global.acid;if(!e)throw"acid should be defined";var f=d+c.method+"?type=matrix_proto&definition={cells:'"+a.cells.types[0]+"',x:'"+a.x.types[0]+"',y:'"+a.y.types[0]+"',global: {acid:'"+e+"'}}",g=_.clone(c.config||{});_.defaults(g,{$take:999,$innerTake:999}),f+="&take="+g.$take,f+="&innerTake="+g.$innerTake,g.$skip&&(f+="&skip="+g.$skip);var h=b.render(g);return h&&(f+="&where="+h),g.$set&&_.each(_.keys(g.$set),function(a){f+="&"+a+"="+g.$set[a]}),encodeURI(f)}}}),define("tau/slice/api",["tau/core/Class","jQuery","Underscore","./url.resolver","./url.resolver.proto"],function(a,$,_,b,c){return a.extend({config:null,init:function(a){this.config=a||{},_.defaults(this.config,{service:$.ajax})},_deferredResolved:function(a,b){a.$deferred.resolve(b)},_deferredRejected:function(a,b){a.$deferred.reject(b)},resolve:function(a){a=a||{};var c=a.command||{},d=c.config||{},e=b,f=d.hasOwnProperty("$url")?d.$url:e.resolve(this.config.definition,c),g={url:f,dataType:"json",$scope:a},h={ajaxConfig:g,command:c},i=this;return this.config.service(g).done(function(b){h.data=b,i._deferredResolved(a,h)}).fail(function(b){h.data=b,i._deferredRejected(a,h)}),a.$deferred},url:function(a){return this.resolveDeferred("url",a)},x:function(a){return this.resolveDeferred("xaxis",a)},y:function(a){return this.resolveDeferred("yaxis",a)},move:function(a){return this.resolveDeferred("move",a)},axes:function(){var a=this.createDeferredCall("axes"),b={command:a.command};return $.when(this.x(),this.y()).done(function(c,d){b.data={x:c.data.items,y:d.data.items},a.$deferred.resolve(b)}).fail(function(c){b.data=c,a.$deferred.reject(b)}),a.$deferred},size:function(){var a=this.createDeferredCall("size"),b={command:a.command};return $.when(this.x(),this.y()).done(function(c,d){b.data={x:c.data.items.length,y:d.data.items.length},a.$deferred.resolve(b)}).fail(function(c){b.data=c,a.$deferred.reject(b)}),a.$deferred},cell:function(a){return this.resolveDeferred("cells",a)},list:function(a){return this.resolveDeferred("list",a)},createDeferredCall:function(a,b){var c=$.Deferred(),d={config:b,method:a};return{$deferred:c,command:d}},resolveDeferred:function(a,b){return this.resolve(this.createDeferredCall(a,b))}})}),define("tau/models/board.plus/model.board.plus",["Underscore","tau/core/event.emitter","tau/slice/api"],function(_,a,b){return a.extend({"bus initialize+boardSettings.ready:last":function(a){var c=this,d=a.initialize.data,e=a["boardSettings.ready"].data.boardSettings;e.get({fields:["x","y","cells","zoomLevel"],callback:function(a){var e={definition:{global:{acid:d.context.acid},x:a.x,y:a.y,cells:a.cells},service:d.sliceService},f=new b(e);c.fire("slice.ready",{slice:f})}})},"bus slice.ready:last+model.get.sliceInfo":function(a){var b=this;b.onGetSliceInfo(a["slice.ready"].data.slice)},onGetSliceInfo:function(a){var b=this;a.axes().done(function(a){var c=a.data,d={marksX:c.x,marksY:c.y};b.onSliceInfoRetrieved(d)})},onSliceInfoRetrieved:function(a){this.fire("model.sliceInfo.retrieved",a)},"bus boardSettings.ready":function(a){var b=this,c=a.data.boardSettings;c.bind({fields:["zoomLevel"],listener:b,callback:_.bind(b.onZoomLevelUpdated,b)}),c.get({fields:["zoomLevel"],callback:_.bind(b.onZoomLevelReady,b)})},onZoomLevelUpdated:function(a){this.fire("model.zoomLevelChanged",a)},onZoomLevelReady:function(a){this.fire("model.zoomLevelChanged",a)}})}),define("tau/models/board.plus/model.board.cell",["Underscore","tau/core/event.emitter"],function(_,a){return a.extend({"bus slice.ready:last+model.get.cell.content":function(a){var b=this,c=a["slice.ready"].data.slice,d=a["model.get.cell.content"].data;b.onGetCellContent(c,d)},onGetCellContent:function(a,b){var c=this;a.cell({x:b.x,y:b.y}).done(function(a){var d=a.data.items.length>0?a.data.items[0]:{};_(d).defaults({x:b.x,y:b.y,dynamic:{items:[]},fixed:{items:[]}}),c.fireCellBasicInfoRetrieved(d)})},"bus model.get.cell.basicInfo":function(a){var b=this,c=a.data;c.x=c.x||null,c.y=c.y||null,c.x&&c.y?b.fire("model.get.cell.content",{x:c.x.toString(),y:c.y.toString()}):b.fire("model.get.axisCell.basicInfo",c)},"bus model.sliceInfo.retrieved:last+model.get.axisCell.basicInfo":function(a){var b=this,c=a["model.get.axisCell.basicInfo"].data,d=a["model.sliceInfo.retrieved"].data,e=c.hasOwnProperty("x"),f=c.hasOwnProperty("y"),g=c.x?"X":"Y",h=d["marks"+g],i=_(h).find(function(a){var b=g.toLowerCase();return a[b]==c[b]});b.fireCellBasicInfoRetrieved(i)},fireCellBasicInfoRetrieved:function(a){var b=this;b.fire("model.cell.basicInfo.retrieved",a)}})}),define("tau/models/board.plus/model.board.cell.freezable",["Underscore","./model.board.cell"],function(_,a){return a.extend({"bus model.get.cell.basicInfo.start":function(a){this.fire("model.get.cell.basicInfo.dump",{dump:{}})},processResponse:function(a,b,c){var d=a.data.items;for(var e=0,f=d.length;e<f;e++){var g=d[e],h=this.getKey(g);b.hasOwnProperty(h)&&_.extend(b[h],g)}var i=[];for(var j=0;j<c.length;j++){var k=c[j];this.fireCellBasicInfoRetrieved(k),i=i.concat(k.dynamic.items)}this.fire("model.cards.data.ready",{cards:i})},getKey:function(a){return a.x+"_"+a.y},"bus slice.ready:last+model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo.end":function(a){var b=a["model.get.cell.basicInfo.dump"].data.dump,c=_.values(b),d=a["slice.ready"].data.slice,e=_(c).pluck("x"),f=_(c).pluck("y"),g=this;d.cell({x:{$in:e},y:{$in:f}}).done(function(a){g.processResponse(a,b,c)})},"bus slice.ready:last+model.get.cell.content":function(a){},"bus model.get.cell.basicInfo.dump:last+model.get.cell.content":function(a){var b=a["model.get.cell.basicInfo.dump"].data.dump,c=a["model.get.cell.content"].data,d={x:c.x.toString(),y:c.y.toString(),dynamic:{items:[]},fixed:{items:[]}};b[this.getKey(d)]=d}})}),define("tau/models/board.plus/model.board.cell.preloadable",["Underscore","./model.board.cell.freezable"],function(_,a){return a.extend({"bus model.cells.content.loaded:last+model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo.end":function(a){var b=a["model.get.cell.basicInfo.dump"].data.dump,c=_.values(b),d=a["model.cells.content.loaded"].data;this.processResponse(d,b,c)},"bus slice.ready:last+model.get.cell.basicInfo.dump:last+model.get.cell.basicInfo.end":function(a){},"bus slice.ready":function(a){var b=this,c=a.data.slice;c.cell({x:{$ne:null},y:{$ne:null}}).done(function(a){b.fire("model.cells.content.loaded",a)})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.controller",["Underscore","jQuery","tau/core/event.emitter"],function(_,$,a){return a.extend({"bus initialize":function(a){var b=this;b.fire("model.get.sliceInfo")},"bus view.skeleton.built":function(a){var b=this;b.fire("afterInit",{}),b.fire("afterRender",a.data)},"bus model.sliceInfo.retrieved":function(a){var b=this,c=a.data;b.fire("view.build.skeleton",c)},"bus model.cell.basicInfo.retrieved":function(a){var b=a.data;this.fire("view.build.cell.skeleton",b)},"bus view.cellSlot.built.start":function(){this.fire("model.get.cell.basicInfo.start",{})},"bus view.cellSlot.built.end":function(){this.fire("model.get.cell.basicInfo.end",{})},"bus view.cellSlot.built":function(a){var b=a.data.data;this.fire("model.get.cell.basicInfo",b)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.layout",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,a,b){return a.extend({"bus afterRender+model.zoomLevelChanged":function(a){var c=_.values(a)[0].data.element;this.zoomLevel=_.values(a)[1].data.zoomLevel,c.css("visibility","hidden");var d=$("html"),e=c.find(".i-role-grid"),f=c.find(".i-role-header[data-dimension=x]"),g=f.find("ul"),h=c.find(".i-role-header[data-dimension=y]"),i=h.find("ul"),j=this.scroll=function(){var a={x:e.scrollLeft(),y:e.scrollTop()};g.css("margin-left",-1*a.x),i.css("margin-top",-1*a.y)};e.bind({scroll:j});var k={width:330,height:250},l=function(a,c){var d=_.capitalize(c),f=e[c]()-e[0]["client"+d],g=a[c]()-f-1,h=a.find(".i-role-cellholder"),i=h.length;h.each(function(a){var d=$(this);(b.isHidden(d)||b.isCollapsed(d))&&i--,b.isHidden(d)==0&&b.isCollapsed(d)&&(g=g-d[c]()-1)});var j=g/i;h.each(function(a){var f=$(this);if(b.isHidden(f)||b.isCollapsed(f))return;var g=f.children(),h=f["outer"+d]()-g[c](),i=j-h,k=f.attr("data-"+c)||!1;k!=i&&(g.css(c,i),b.dimension(e,f,a).children().css(c,i)),f.attr("data-"+c,i)})},m=function(a){switch(a){case 1:case 2:return 6;case 3:case 4:case 5:return 4;case 6:return 3;default:return 2}},n=function(a,d,g,h){var i=_.capitalize(d),j=e[d]()-e[0]["client"+i],k=a[d]()-j-1,l=a.find(".i-role-cellholder"),n=l.length;l.each(function(a){var c=$(this),e=b.isHidden(c),f=b.isHidden(c);(f||e)&&n--,f&&!e&&(k-=c[d]())});var o=m(g),p=Math.min(n,o);h&&(l=l.filter(h));var q=c[d]()-f[d]()-j-1-100,r=Math.floor(q/p),s=16;l.each(function(){var a=$(this);if(b.isHidden(a)||b.isCollapsed(a))return;var c=a.children(),f=b.dimension(e,a).children().add(c);f.css("max"+i,r-s),f.each(function(){this.style[d]=""});var g=_.map(f.toArray(),function(a){return a["scroll"+i]-s}),h=Math.max.apply(null,g);f.css(d,h)});var t=Math.max(0,q-e.children().get(0).getBoundingClientRect().height-2);t>0&&l.each(function(){var a=$(this);if(b.isHidden(a)||b.isCollapsed(a))return;var c=a.children(),d=b.dimension(e,a).children().add(c);d.css("maxHeight",r+t)})},o=this.equalWidth=function(a){l(f,"width")},p=this,q=this.equalHeight=function(a){n(h,"height",p.zoomLevel,a)},r=function(){},s={height:window.innerHeight,width:window.innerWidth},t=!1;$(window).resize(function(a){setTimeout(function(){if(t)return;t=!0;var a={height:window.innerHeight,width:window.innerWidth};Math.abs(a.height-s.height)>20&&(r(),q(),s.height=a.height),Math.abs(a.width-s.width)>20&&(o(),s.width=a.width),t=!1},100)}),setTimeout(function(){r(),o(),q(),j(),c.fadeOut(0),c.css("visibility",""),c.fadeIn("fast")},500)},"bus model.zoomLevelChanged":function(a){if(!this.zoomLevel)return;var b=a.data.zoomLevel;this.zoomLevel=b;var c=this;setTimeout(function(){c.equalHeight(),c.equalWidth()},2e3)},"bus view.axis.collapser.executed.after":function(a){var b=a.data;b.x&&(this.equalWidth(),this.scroll()),b.y&&(this.equalHeight(),this.scroll())},"bus view.axis.focus.executed.after":function(a){var b=a.data;b.x&&(this.equalWidth(),this.scroll()),b.y&&(this.equalHeight(),this.scroll())},"bus view.card.batch.move":function(a){var b=a.data,c=[],d=[];_.forEach(b,function(a){c.push(a.sourceData.y,a.cellData.y)}),_.forEach(b,function(a){d.push(a.sourceData.x,a.cellData.x)}),c=_.uniq(c),d=_.uniq(d),this.equalHeight(function(a,b){return _.indexOf(c,parseInt(b.getAttribute("data-y")))>-1}),this.equalWidth(function(a,b){return _.indexOf(d,parseInt(b.getAttribute("data-x")))>-1})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.selection",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus afterRender":function(a){var b=this,c=a.data.element;b.counter=0,b.subscribeCards(c)},"bus view.card.selected":function(a){var b=a.data,c=b.element,d=b.selected;d?c.addClass("tau-selected"):c.removeClass("tau-selected"),d?++this.counter:--this.counter,this.counter=this.counter<0?0:this.counter},subscribeCards:function(a){var b=this;a.find(".i-role-grid").delegate(".i-role-card","mousedown",function(){var a=$(this),c=a.hasClass("tau-selected");b.fireCardSelected(a,!c)})},fireCardSelected:function(a,b){this.fire("view.card.selected",{element:a,selected:b})}})}),define("tau/models/board.plus/model.board.dragndrop",["Underscore","tau/core/event.emitter"],function(_,a){return a.extend({"bus slice.ready:last+view.card.batch.move:last":function(a){var b=_.values(a)[0].data.slice,c=_.values(a)[1].data,d=this,e=[];_.forEach(c,function(a){e.push(function(a){return function(c){b.move({$set:{x:a.cellData.x,y:a.cellData.y,itemId:a.entityId}}).done(function(b){c(null,{elementId:a.elementId,success:!0})}).fail(function(b){c(null,{elementId:a.elementId,success:!1})})}}(a))}),_.parallel(e,function(a,b){d.fire("view.card.batch.move.after",b)})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({classes:{DRAG_SOURCE:"tau-drag-source",DRAG_HELPER:"tau-drag-helper"},"bus afterRender":function(a){this.selectedCards={};var b=a.data.element.find(".i-role-grid"),c=b.find("tbody");this.$grid=b,this.cardOptions={addClasses:!1,appendTo:b,containment:c,cursor:"move",helper:"clone",distance:8,scrollSensitivity:100,start:_.bind(this.onDragStart,this),drag:_.bind(this.onDrag,this),stop:_.bind(this.onDragStop,this)},this.__options={},this.__options.sortItemsSelector=".i-role-card",this.__options.dropTargetSelector=".i-role-cell",this.__options.dragZone=b;var d=this;b.delegate(".i-role-card","mouseenter",function(){$(this).draggable(d.cardOptions)})},onDragStart:function(a,b){var c=this.classes,d=$(a.target);d.addClass(c.DRAG_SOURCE),b.helper.addClass(c.DRAG_HELPER),this.__dropTarget=d.parentsUntil(this.__options.dragZone,this.__options.dropTargetSelector),this.__intervalId=setInterval(_.bind(this.__updateDragSourceLocation,this,d),50),this.fire("view.card.drag.start",{element:d,helper:b.helper})},onDrag:function(a,b){this.__cursorPosition={x:a.pageX,y:a.pageY}},onDragStop:function(a,b){var c=this.classes,d=$(a.target);clearInterval(this.__intervalId),this.__intervalId=null,d.removeClass(c.DRAG_SOURCE),this.fire("view.card.drag.stop",{element:d})},__updateDragSourceLocation:function(a){this.__updateDropTarget(a),this.__sortItems(a)},__updateDropTarget:function(a){if(!this.__isElementUnderCursor(this.__dropTarget.get(0))){var b=this.__getDropTargetUnderCursor(this.__dropTarget);b.size()>0&&(this.__dropTarget=b.append(a))}},__sortItems:function(a){var b=this.__getSortItemUnderCursor(a);b.size()>0&&(a.index()<b.index()?a.insertAfter(b):a.insertBefore(b))},__isPointInRect:function(a,b,c,d,e,f){return a>=c&&b>=d&&a<=e&&b<=f},__isElementUnderCursor:function(a){var b=a.getBoundingClientRect();return this.__isPointInRect(this.__cursorPosition.x,this.__cursorPosition.y,b.left,b.top,b.right,b.bottom)},__getDropTargetUnderCursor:function(a){return $(_.find(this.__options.dragZone.find(this.__options.dropTargetSelector).not(a),function(a){return this.__isElementUnderCursor(a)},this))},__getSortItemUnderCursor:function(a){return $(_.find(a.siblings(this.__options.sortItemsSelector),function(a){return this.__isElementUnderCursor(a)},this))}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.batch",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus afterRender":function(a){this.$selectedCards=$()},"bus view.card.selected":function(a){var b=a.data.element;a.data.selected?this.$selectedCards=this.$selectedCards.add(b):this.$selectedCards=this.$selectedCards.not(b)},"bus view.card.drag.start":function(a){var b=a.data.helper,c=a.data.element;this.$selectedCards=this.$selectedCards.add(c),c.toggleClass("tau-selected",!0);var d=this.$selectedCards;d.each(function(){var a=$(this),b=a.parent();a.data("prevPosition",{cardId:a.prev().attr("id"),cellId:b.attr("id"),sourceData:{x:b.data("x")||null,y:b.data("y")||null}})}),d.length>1&&(b.attr("data-batch_count",d.length+""),b.addClass("tau-drag-helper_batch"),d.not(c).detach())},"bus view.card.drag.stop":function(a){var b=a.data.element,c=this.$selectedCards;c.length>1&&c.not(b).insertAfter(b).show(),b.removeAttr("data-batch_count"),b.removeClass("tau-drag-helper_batch");var d=this;c.each(function(){d.fire("view.card.selected",{element:$(this),selected:!1})}),c.addClass("tau-highlighted"),c.draggable("disable");var e=[],f=b.parents(".i-role-cell:first").data();f={x:f.x,y:f.y},c.each(function(){var a=$(this);e.push({entityId:a.data("id"),elementId:a.attr("id"),cellData:f,sourceData:b.data("prevPosition").sourceData})}),this.fire("view.card.batch.move",e),this.$selectedCards=$()},"bus afterRender:last+view.card.batch.move.after:last":function(a){var b=_.values(a)[0].data.element,c=_.values(a)[1].data||{};_.forEach(c,function(a){var c=b.find("#"+a.elementId);c.draggable("enable").removeClass("tau-highlighted");if(!a.success){var d=c.data("prevPosition")||{};d.cardId?c.insertAfter("#"+d.cardId):d.cellId&&c.appendTo("#"+d.cellId)}})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.requestIndicator",["jQuery","app.path","tau/components/extensions/component.extension.base"],function($,a,b){return b.extend({"bus afterRender":function(b){this.fire("template.bind",{name:"boardplus.request.indicator",data:{imageSrc:a.get()+"/JavaScript/tau/css/images/loader-yellow.gif"}})},"bus template.boardplus.request.indicator.bound+afterRender":function(a){var b=a["template.boardplus.request.indicator.bound"].data.element;a.afterRender.data.element.append(b)},"bus template.boardplus.request.indicator.bound:last+model.requestBegin":function(a){var b=a["template.boardplus.request.indicator.bound"].data.element;b.show()},"bus template.boardplus.request.indicator.bound:last+model.requestCompleted":function(a){var b=a["template.boardplus.request.indicator.bound"].data.element;b.hide()}})}),define("tau/models/board.plus/model.board.collapse",["Underscore","tau/core/event.emitter"],function(_,a){return a.extend({"bus boardSettings.ready":function(a){var b=a.data.boardSettings,c=this;b.get({fields:["collapse"],callback:function(a){c.fire("settings.collapse.provided",a.collapse)}}),b.bind({fields:["collapse"],listener:c,callback:function(a){c.fire("settings.collapse.provided",a.collapse)}})},"bus boardSettings.ready:last+view.axis.collapser.executed:last":function(a){var b=_.values(a)[0].data.boardSettings,c=_.values(a)[1].data;b.get({fields:["collapse"],callback:function(a){var d=a.collapse||{};d[c]=!d[c],b.set({set:{collapse:d},callback:function(a){}})}})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.collapse",["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,_,a,b){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=this,d=b.find(".i-role-header");d.delegate(".i-role-collapser","click",function(a){var b=$(this).parents(".i-role-cellholder:first");c.fire("view.axis.collapser.executed",b.attr("id"))})},"bus afterRender:last+settings.collapse.provided:last":function(a){var c=_.values(a)[0].data.element,d=_.values(a)[1].data||{},e=this,f={},g=c.find(".i-role-grid"),h=c.find(".i-role-header .i-role-cellholder");h.each(function(){var a=$(this),c=d[this.id]||!1,e=b.isCollapsed(a);if(c==e)return;a.attr("data-is-collapsed",c?"1":""),a.toggleClass("tau-collapsed",c);var h=a.attr("data-x")?"x":"y";f[h]=!0;var i=b.dimension(g,a);i.toggleClass("tau-collapsed_"+h,c),a.toggleClass("tau-collapsed_"+h,c),i.each(function(){var a=$(this),b=a.hasClass("tau-collapsed_x")||a.hasClass("tau-collapsed_y");a.toggleClass("tau-collapsed",b)})}),e.fire("view.axis.collapser.executed.after",f)}})}),define("tau/models/board.plus/model.board.focus",["Underscore","tau/core/event.emitter"],function(_,a){return a.extend({"bus boardSettings.ready":function(a){var b=a.data.boardSettings,c=this;b.get({fields:["focus"],callback:function(a){c.fire("settings.focus.provided",a.focus)}}),b.bind({fields:["focus"],listener:c,callback:function(a){c.fire("settings.focus.provided",a.focus)}})},"bus boardSettings.ready:last+view.axis.focus.executed:last":function(a){var b=_.values(a)[0].data.boardSettings,c=_.values(a)[1].data;b.set({set:{focus:c},callback:function(a){}})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.focus",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,a,b){return a.extend({"bus afterRender":function(a){var c=a.data.element,d=this,e=c.find(".i-role-grid"),f=c.find(".i-role-header"),g=f.find(".i-role-cellholder"),h=c.find("[role=action-focus]"),i=c.find("[role=action-unfocus]");f.delegate("[name=focus]","change",function(){var a=$(this).parents(".i-role-cellholder:first"),c=a.parents(".i-role-header:first").data("dimension"),d=b.dimension(e,a).add(a);d.toggleClass("tau-selected_"+c),d.each(function(){var a=$(this);a.toggleClass("tau-selected",a.hasClass("tau-selected_x")||a.hasClass("tau-selected_y"))});var g=f.find("[name=focus]:checked");g.length?h.prop("disabled",!1):h.prop("disabled",!0)}),h.on("click",function(){var a={};f.each(function(){var b=$(this),c=a[b.data("dimension")]=[];b.find(".i-role-cellholder:has([name=focus]:checked)").each(function(){c.push(this.id)})}),d.fire("view.axis.focus.executed",{focus:!0,values:a})}),i.on("click",function(){d.fire("view.axis.focus.executed",{focus:!1,values:[]})})},"bus afterRender:last+settings.focus.provided:last":function(a){var c=_.values(a)[0].data.element,d=_.values(a)[1].data||{},e=this,f=c.find(".i-role-grid"),g=c.find(".i-role-header");c.find(".i-role-cellholder").removeClass("tau-selected").removeClass("tau-selected_x").removeClass("tau-selected_y"),g.find("input[name=focus]").prop("checked",!1);var h=c.find("[role=action-focus]"),i=c.find("[role=action-unfocus]");if(!d.focus){var j={};g.each(function(){var a=$(this),c=a.attr("data-dimension"),d=a.find(".i-role-cellholder");d.each(function(){var a=$(this),d=b.isHidden(a);if(!d)return;a.attr("data-is-hidden",""),j[c]=!0;var e=b.dimension(f,a).add(a);e.show()})}),i.prop("disabled",!0),h.prop("disabled",!0),e.fire("view.axis.focus.executed.after",j)}else if(d.focus===!0){var j={},k=d.values;g.each(function(){var a=$(this),c=a.attr("data-dimension"),d=k[c];if(d&&d.length){var e=a.find(".i-role-cellholder");e.each(function(){var a=$(this),e=b.isHidden(a);if(!_.inArray(this.id,d)){a.attr("data-is-hidden","1"),j[c]=!0;var g=b.dimension(f,a).add(a);g.hide()}else if(e){a.attr("data-is-hidden",""),j[c]=!0;var g=b.dimension(f,a).add(a);g.show()}})}}),i.prop("disabled",!1),h.prop("disabled",!0),e.fire("view.axis.focus.executed.after",j)}}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.name",["jQuery","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,a,b){return a.extend({"bus boardSettings.ready":function(a){var b=a.data.boardSettings,c=this;b.get({fields:["name"],callback:function(a){c.fire("board.name.ready",{name:a.name})}})},"bus afterRender:last+board.name.ready:last":function(a){var b=_.values(a)[0].data.element,c=_.values(a)[1].data.name;b.find(".i-role-name").text(c)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer",["jQuery","app.path","tau/components/extensions/component.extension.base"],function($,a,b){return b.extend({childApplicationId:"popup","bus view.skeleton.built":function(a){var b=a.data.element;b.delegate(".tau-id","mousedown",$.proxy(this.onCardIdMouseDown,this)),this.subscribe(b,$.proxy(this.loadCardDetails,this)),this.restore(b)},onCardIdMouseDown:function(a){a.stopPropagation()},restore:function(a){var b=this,c=b.config.context.configurator.getExternal(),d=c.getHashParam(b.childApplicationId,null);if(d!==null){var e=d.split("/");b.builtInCardDetails(a,{type:e[0],id:e[1]})}},subscribe:function(a,b){a.delegate(".i-role-card","dblclick",function(a){var c=$(a.currentTarget).data();b(c)})},loadCardDetails:function(a){this.fire("view.load.cardDetails",a)},"bus view.skeleton.built:last+view.load.cardDetails":function(a){var b=a["view.skeleton.built"].data.element,c=a["view.load.cardDetails"].data;this.builtInCardDetails(b,c)},builtInCardDetails:function(a,b){var c=this;require(["tau/components/component.application","tau/configurator"],function(a,d){var e=d;e.pushRouting(),e.isBoardEdition=!0;var f=a.create({applicationId:c.childApplicationId,pageType:b.type,pageId:b.id,integration:{showInPopup:!0},context:{configurator:d}});f.on("destroy",function(){e.popRouting()}),c.on("destroy",function(){f.fire("destroy")}),f.initialize()})}})}),define("tau/models/board.plus/model.dataUpdater",["Underscore","tau/core/event.emitter"],function(_,a){var b={},c=0;return a.extend({dataSchema:{1:{query:{userstory:[]},dataFields:{userstory:[]}},2:{query:{userstory:[]},dataFields:{userstory:[]}},3:{query:{userstory:[]},dataFields:{userstory:[]}},4:{query:{userstory:["tags"]},dataFields:{userstory:["tags"]}},5:{query:{userstory:[]},dataFields:{userstory:[]}},6:{query:{userstory:[{assignments:[{generalUser:["id","firstName","lastName"]}]},"effort",{impediments:[{entityState:["isFinal"]}]},{bugs:[{entityState:["isFinal","isInitial","isPlanned"]}]},{tasks:[{entityState:["isFinal","isInitial","isPlanned"]}]}]},dataFields:{userstory:["assignments","effort","impediments","bugs","tasks"]}}},init:function(a){this._super(a),this.config=a,this.reguestsCount=0},"bus model.data.loader.registerItems":function(a){var b=[];this.registerItems=this.registerItems||{};var c=a.data.items;for(var d=0;d<c.length;d++){var e=c[d],f=this.registerItems[e.id]=this.registerItems[e.id]||{};_.extend(f,e),b.push(f)}this.fire("model.data.loader.itemsUpdated",{items:f})},handleOperations:function(a,b,c){var d=100,e=0,f=Math.min(e+d,a.length),g=this,h=function(){var i=b,j={};for(;e<f;e++){var k=a[e],l=k.type,m=j[l]=j[l]||{$in:[],fields:[],type:l};m.$in.push(k.id),m.fields=_.union(m.fields,k.fields)}_.each(j,function(a){i=i.turboGet(l,{$query:{id:{$in:a.$in}},fields:a.fields})}),g.beforeRequest(),i.done({success:function(){g.requestComplete(),c.apply(this,arguments)},failed:function(){g.requestComplete()}}),f!=a.length&&(f=Math.min(e+d,a.length),h())};h()},beforeRequest:function(){this.reguestsCount++,this.reguestsCount==1&&this.fire("model.requestBegin")},requestComplete:function(){--this.reguestsCount==0&&this.fire("model.requestCompleted")},getDataForZoomLevel:function(a,b){var c=this.getStoreOperationsForZoomLevel(a,_.map(this.registerItems,function(a){return a}));this.executeStoreOperations(c,b)},"bus initialize:last+model.zoomLevelChanged":function(a){var b=a["model.zoomLevelChanged"].data.zoomLevel,c=a.initialize.data.context.configurator.storeFactory.getStore();this.getDataForZoomLevel(b,c)},executeStoreOperations:function(a,b){var c=_.bind(this.dataRetrieved,this);a.length>0&&(this.fire("model.data.loader.willRegisterDataRequests"),this.handleOperations(a,b,c),this.fire("model.data.loader.didRegisterDataRequests"))},"bus model.data.loader.registerItems+initialize+model.zoomLevelChanged":function(a){var b=a.initialize.data.context.configurator.storeFactory.getStore(),c=this,d=a["model.zoomLevelChanged"].data.zoomLevel+1;d<7&&(d=7,c.getDataForZoomLevel(d,b))},"bus initialize:last+model.zoomLevelChanged:last+model.data.loader.registerItems":function(a){var b=a["model.zoomLevelChanged"].data.zoomLevel,c=this.getStoreOperationsForZoomLevel(b,a["model.data.loader.registerItems"].data.items),d=this.config.context.configurator.getStore();this.executeStoreOperations(c,d)},dataRetrieved:function(a){var b=a[0].data,c=[],d=this.registerItems||{};_.each(b,function(a){_.extend(d[a.id],a),_.extend(d[a.id],this.extractCountFields(a)),_.extend(d[a.id],this.splitTags(a));var b=d[a.id];c.push(b)},this),this.fire("model.dataUpdated",{items:c})},getCollectionInfo:function(a){var b={plannedCount:_.filter(a,function(a){var b=a.entityState;return b.isPlanned||b.isInitial}).length,inProgressCount:_.filter(a,function(a){var b=a.entityState;return!b.isPlanned&&!b.isInitial&&!b.isFinal}).length};return b},addCollectionInfo:function(a,b,c){if(_.isArray(a)){var d=this.getCollectionInfo(a);if(d.plannedCount||d.inProgressCount)c[b]=d}},extractCountFields:function(a){var b={};return _.isArray(a.impediments)&&(b.openImpedimentsCount=_.filter(a.impediments,function(a){return!a.entityState.isFinal}).length),this.addCollectionInfo(a.tasks,"tasksInfo",b),this.addCollectionInfo(a.bugs,"bugsInfo",b),b},splitTags:function(a){return _.isString(a.tags)&&a.tags.length>0?{tags:a.tags.split(",")}:{}},getStoreOperationsForZoomLevel:function(a,c){var d=new Date,e=[],f=[];for(var g=0;g<c.length;g++){var h=c[g],i=_.map(h,function(a,b){return b}),j,k=this.dataSchema;for(var l=1;l<=a;l++){if(!k.hasOwnProperty(l))break;var m=k[l],n=h.type.toLowerCase(),o=m.query[n]||[],p=m.dataFields[n]||[];if(p.length>0){var q=_.intersection(i,p),r=q.length===p.length;_.chain().difference(i,q).each(function(a){h[a]==b}),r||(j=j||{type:h.type,fields:[],id:h.id},j.fields=_.union(j.fields,o))}}j&&(f.push(j.id),e.push(j)),j=null}return e}})}),define("tau/models/model.board.zoomLevel",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus boardSettings.ready":function(a){var b=this,c=a.data.boardSettings;c.bind({fields:["zoomLevel"],listener:b,callback:_.bind(b.onZoomLevelUpdated,b)}),c.get({fields:["zoomLevel"],callback:_.bind(b.onDataReady,b)})},onDataReady:function(a){var b=this,c={zoomLevel:a.zoomLevel};b.bus.fire("zoomLevelReady",c),this.config.bindData&&b.bus.fire("dataBind",c),!this.validateZoomLevel(a.zoomLevel)&&this.normalizeZoomLevel(a.zoomLevel)&&this.fire("updateZoomLevel",{zoomLevel:this.normalizeZoomLevel(a.zoomLevel)})},validateZoomLevel:function(a){return this.config.hasOwnProperty("min")&&a<this.config.min?!1:this.config.hasOwnProperty("max")&&a>this.config.max?!1:a!=undefined},normalizeZoomLevel:function(a){if(this.config.hasOwnProperty("min")&&this.config.hasOwnProperty("max")){if(a==undefined)return this.config.defaultValue;if(a<this.config.min)return this.config.min;if(a>this.config.max)return this.config.max}return a},onZoomLevelUpdated:function(a){var b=this;if(!this.validateZoomLevel(a.zoomLevel))return;b.bus.fire("zoomLevelUpdated",a)},"bus boardSettings.ready:last+updateZoomLevel":function(a){var b=a["boardSettings.ready"].data.boardSettings,c=a.updateZoomLevel.data,d=c.zoomLevel;this.validateZoomLevel(d)||(d=this.normalizeZoomLevel(d)),b.set({set:{zoomLevel:d}})}});return b}),define("tau/ui/extensions/board.zoomLevel/ui.extension.board.zoomLevel.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender+zoomLevelReady":function(a){var b=a.afterRender.data.element,c=a.zoomLevelReady.data,d={max:this.config.max,min:this.config.min,animate:!0,change:_.bind(this.onSliderChange,this),value:c.zoomLevel};this.config.bindData||(b=b.find(".tau-zoomer")),b.slider(d)},onSliderChange:function(a,b){this.updateZoomLevel(b.value)},updateZoomLevel:function(a){var b=this;b.bus.fire("updateZoomLevel",{zoomLevel:a})},"bus zoomLevelUpdated+afterRender:last":function(a){var b=a.afterRender.data.element,c=a.zoomLevelUpdated.data;this.config.bindData||(b=b.find(".tau-zoomer")),b.slider({value:c.zoomLevel})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.viewMode",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus afterRender+boardSettings.ready":function(a){var b=this,c=a.afterRender.data.element,d=a["boardSettings.ready"].data.boardSettings,e=$('<button class="tau-btn">List</button>').click(function(){d.set({set:{viewMode:"list"}})}),f=$('<button class="tau-btn">Board</button>').click(function(){d.set({set:{viewMode:"board"}})}),g=$('<span class="tau-btn-group" style="float:right;margin:0.5em 0;"></span>');g.append(e).append(f),c.find(".tau-board-header").append(g)}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.profiler",["Underscore","jQuery","tau/core/event.emitter"],function(_,$,a){var b=function(a,b){var c=_(a).chain().find(function(a){return a.name===b}).value();return c},c=function(a,b){var c=_(a).chain().select(function(a){return a.name===b}).value();return c},d=function(a,c,d){var e=b(a,c),f=b(a,d);return f.tick-e.tick},e=function(a){var b=a[0],c=a[a.length-1];return c.tick-b.tick},f=function(a){var b=d(a,"initialize","view.skeleton.built"),c=d(a,"model.get.sliceInfo","model.sliceInfo.retrieved");return{client:b-c,server:c,total:b}},g=function(a,b,c,d,e){var f={};for(var g=0;g<a.length;g++){var h=a[g],i=e(h),j=_(b).find(function(a){var b=e(a);return b==i});if(!j)console.log("pair event ["+d+"] is not found for ["+c+"]"),console.log("cell group: "+i);else{var k={id:i,orig:h,pair:j};f[k.id]=k}}return f},h=function(a){var b=_(a).max(function(a){return a}),c=0;_(a).each(function(a){c+=a});var d=c/a.length;return{avg:d.toFixed(2),max:b.toFixed(2),total:c.toFixed(2)}},i=function(a){var d=b(a,"view.cellSlot.built.start"),e=c(a,"view.cellSlot.built"),f=c(a,"view.cell.skeleton.built"),i=d,j=f[f.length-1],k=j.tick-i.tick,l=c(a,"model.get.cell.basicInfo"),m=c(a,"model.cell.basicInfo.retrieved"),n=g(l,m,"model.get.cell.basicInfo","model.cell.basicInfo.retrieved",function(a){return["x",a.data.x,"y",a.data.y].join("")}),o=g(e,f,"view.cellSlot.built","view.cell.skeleton.built",function(a){return["x",a.data.data.x,"y",a.data.data.y].join("")}),p=[],q=[];return _(o).each(function(a,b){var c=a.pair.tick-a.orig.tick,d=n[b],e=0;d.orig.data.hasOwnProperty("x")&&d.orig.data.hasOwnProperty("y")&&(e=d.pair.tick-d.orig.tick,p.push(e));var f=c-e;q.push(f)}),{total:k,client:h(q),server:h(p)}},j=function(a){var b=$("<div></div>");b.width(375),b.height(225),b.empty().append("<p><b>Performance statistics:</b></p>");for(var c=0;c<arguments.length;c++){b.append("<hr />");if(_.isArray(arguments[c]))for(var d=0;d<arguments[c].length;d++)b.append("<p style='padding:1;margin:0;'>"+arguments[c][d]+"</p>");else b.append("<p style='padding:1;margin:0;'>"+arguments[c]+"</p>")}return b};return a.extend({init:function(a){this._super(a),this.expected=0,this.actual=0},"bus model.sliceInfo.retrieved":function(a){var b=a.data,c=b.marksX.length,d=b.marksY.length,e=b.marksX.length!==1||b.marksX[0].x!=="-1",f=b.marksY.length!==1||b.marksY[0].x!=="-1";this.expected=c*d,e&&f&&(this.expected+=c+d)},"bus profiler.ready:last+afterRender:last+view.cell.skeleton.built":function(a){++this.actual;var b=this.actual===this.expected;if(b){var c=a["profiler.ready"].data.profiler,d=a.afterRender.data.element;c.stop();var e=c.data(),f=e[0],g=e[e.length-1],h=g.tick-f.tick,i=["D",'<sup style="background-color:rgba(255, 25, 0, 0.5);font-size:9px;border:1px solid;color:#000;padding:0 1px 0 1px;">',h,"</sup>"].join("");this.buildDiagnostics(c,d,i)}},buildDiagnostics:function(a,b,c){var d=$("<div></div>");d.css("padding","4px").css("background","rgba(125, 125, 125, 0.7)").css("font-size","10px").css("color","#ffffff").css("width","20px").css("height","20px").css("z-index","100").css("margin-top","3px").css("margin-left","3px").css("position","absolute");var g=function(){var c=a.data(),g=b.find("[role=header]"),h=g.filter("[data-dimension=x]").find("[role=cell]").size(),k=g.filter("[data-dimension=y]").find("[role=cell]").size(),l=b.find("[role=grid]").find("[role=card]").size(),m="Slice: "+h+" x "+k+" ["+l+" cards]",n="Overall time: ["+e(c)+"] ms",o=f(c),p=["Basic skeleton: ["+o.total+"] ms","> Client: ["+o.client+"] ms","> Server: ["+o.server+"] ms"],q=i(c),r="Cells skeletons build process has taken ["+q.total+"] ms",s=["> Server: ","[","AVG:"+q.server.avg," / ","MAX: "+q.server.max,"] ms"].join(""),t=["> Client: ","[","AVG:"+q.client.avg," / ","MAX: "+q.client.max," / ","SUM: "+q.client.total,"] ms"].join(""),u=j(m,n,p,[r,s,t]);u.css("padding","4px").css("background","rgba(125, 125, 125, 0.7)").css("font-size","10px").css("color","#ffffff").css("z-index","100").css("position","absolute").css("top","29px").css("left",0).appendTo(d),d.children().eq(0).toggle(function(){u.hide()},function(){u.show()})},h=$("<div title='diagnostics'>"+c+"</div>");h.css("color","#A9D975").css("font-size","18px").css("font-family","Tahoma").css("text-align","center").css("width","100%").css("height","100%").css("line-height","100%").css("cursor","pointer").one("click",g),d.append(h),b.append(d)}})}),define("tau/ui/extensions/ui.extension.templateBinder",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/core/templates-factory"],function(_,$,a,b){return a.extend({"bus template.bind":function(a){var c=a.data,d=c.name,e=c.data,f=c.config||{},g=b.get(d),h=g.bind(f,e);c.element=h,this.fire("template."+d+".bound",c)},"bus template.pure.bind":function(a){var c=a.data,d=c.name,e=c.data,f=c.config||{},g=b.get(d),h=g.bindPure(f,e);c.html=h,this.fire("template."+d+".pure.bound",c)}})}),define("tau/ui/templates/board.plus/ui.template.boardplus.skeleton",["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(_,a,b){var c={name:"boardplus.skeleton",engine:"jqote2",customFunctions:{generateId:b.generateId,generateCellData:b.generateElementData},markup:['<% var hasX = !(this.marksX.length === 1 && this.marksX[0].x === "-1"); %>','<% var hasY = !(this.marksY.length === 1 && this.marksY[0].y === "-1"); %>','<div class="tau-board tau-board_animate_false <% if (!hasX && !hasY) { %> tau-board-list<% } %>">','<div class="tau-board-header">','<div class="i-role-name tau-board-name"><%= this.name %></div>','<span class="tau-btn-group tau-focuser">','<button role="action-focus" disabled=""    class="tau-btn tau-focus-in">focus</button>','<button role="action-unfocus" disabled=""  class="tau-btn tau-close tau-focus-out"></button>',"</span>",'<span class="tau-zoomer ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">','<a href="#" class="ui-slider-handle ui-state-default ui-corner-all" style="left: 100%;"></a>',"</span>","</div>",'<div class="tau-board-body">','<div class="tau-board-grid-view">','<div role="board-body" class="i-role-board-body">',"<% if (hasX && hasY) { %>",'<div class="tau-x-header">',"</div>","<% } %>","<% if (hasY) { %>",'<div role="header" data-dimension="y" class="i-role-header tau-rows-header">',"<ul>","<% for (var y = 0; y < this.marksY.length; y++) { %>","<% var m = this.marksY[y]; %>",'<li role="cellholder" class="i-role-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>","<% if (hasX) { %>",'<div role="header" data-dimension="x" class="i-role-header tau-cols-header">',"<ul>","<% for (var x = 0; x < this.marksX.length; x++) { %>","<% var m = this.marksX[x]; %>",'<li role="cellholder" class="i-role-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>",'<div role="grid" class="i-role-grid tau-grid" id="grid_<%= _.uniqueId() %>">',"<table>","<tbody>","<% for (var y = 0; y < this.marksY.length; y++) { %>","<% var rowCoords = { y: this.marksY[y].y }; %>","<tr>","<% for (var x = 0; x < this.marksX.length; x++) { %>","<% var coords = { x: this.marksX[x].x, y: this.marksY[y].y }; %>",'<td role="cellholder" class="i-role-cellholder" id="ch_<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %> >','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %>>',"</div>","</td>","<% } %>","</tr>","<% } %>","</tbody>","</table>","</div>","</div>","</div>","</div>","</div>"],dependencies:[]};return a.register(c)}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.id",["tau/core/templates-factory"],function(a){var b={name:"boardplus.card.id",engine:"jqote2",customFunctions:{generateCardRef:function(a){return["#",a.type.toLowerCase(),"/",a.id].join("")}},markup:['<a class="tau-id" href="<%= fn.generateCardRef(this) %>"><%= this.id %></a>'].join("")};return a.register(b)}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.skeleton",["tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/templates/board.plus/ui.template.boardplus.card.id"],function(a,b){var c={name:"boardplus.card.skeleton",engine:"jqote2",customFunctions:{generateCardData:b.generateElementData,generateCardId:b.generateCardId},markup:[['<div role="card" class="tau-card i-role-card tau-<%= this.type.toLowerCase()%>" id="<%= fn.generateCardId(this) %>" <%= fn.generateCardData({ id: this.id, type: this.type }) %>>',"   <div>",'       <%= fn.sub("boardplus.card.id", this) %>',"   </div>","   <div>",'       <div class="tau-name"><%= this.name %></div>',"   </div>","   <div>","   </div>","</div>"].join("")]};return a.register(c)}),define("tau/ui/templates/board.plus/ui.template.boardplus.cell.grid.skeleton",["tau/core/templates-factory","tau/ui/templates/board.plus/ui.template.boardplus.card.skeleton"],function(a){var b={name:"boardplus.cell.grid.skeleton",engine:"jqote2",markup:[["<% for(var itemIndex = 0; itemIndex < this.dynamic.items.length; itemIndex++) { %>","<%      var dataItem = this.dynamic.items[itemIndex]; %>",'<%=     fn.sub("boardplus.card.skeleton", dataItem.data) %>',"<% } %>"].join("")]};return a.register(b)}),define("tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton",["tau/core/templates-factory"],function(a){var b={name:"boardplus.cell.axis.skeleton",engine:"jqote2",markup:[['<div class="tau-label"><%= this.dynamic.items[0].data.name %></div>','<label class="tau-selector"><input type="checkbox" name="focus"></label>','<div class="tau-collapser">','<button  role="collapser" class="i-role-collapser tau-v-collapser"></button>',"</div>"].join("")],dependencies:[]};return a.register(b)}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.assignments",["tau/core/templates-factory","app.path"],function(a,b){var c={name:"boardplus.card.assignments",engine:"jqote2",customFunctions:{getAppPath:function(){return b.get()}},markup:[['<span class="tau-avatar"><img  alt="<%= this.generalUser.firstName + \' \' + this.generalUser.lastName %>" title="<%= this.generalUser.firstName + \' \' + this.generalUser.lastName %>"  src="<%= fn.getAppPath() %>/Avatar.ashx?UserID=<%= this.generalUser.id%>&size=24" /></span>'].join("")]};return a.register(c)}),define("tau/ui/templates/board.plus/ui.template.boardplus.request.indicator",["tau/core/templates-factory"],function(a){var b={name:"boardplus.request.indicator",engine:"jqote2",markup:['<div style="display:none;" role="status" aria-hidden="true">','<div class="loadBar" id="loadDiv">','<img class="icon" src="<%= this.imageSrc %>">&nbsp;<span>Loading</span>',"</div>","</div>"].join("")};return a.register(b)}),define("tau/models/board.plus/model.board.plus.list",["Underscore","tau/models/board.plus/model.board.plus"],function(_,a){return a.extend({onGetSliceInfo:function(a){var b={marksX:[{x:"-1",dynamic:{items:[{id:"-1",type:null,data:{id:-1,name:"",type:null}}]},fixed:{items:[]}}],marksY:[{y:"-1",dynamic:{items:[{id:"-1",type:null,data:{id:-1,name:"",type:null}}]},fixed:{items:[]}}]};this.onSliceInfoRetrieved(b)}})}),define("tau/models/board.plus/model.board.cell.list",["Underscore","tau/models/board.plus/model.board.cell"],function(_,a){return a.extend({onGetCellContent:function(a,b){var c=this;a.cell({x:{$ne:null},y:{$ne:null}}).done(function(a){var d={dynamic:{items:[]},fixed:{items:[]},x:b.x,y:b.y};d.dynamic.items=_.reduce(a.data.items,function(a,b){return a.concat(b.dynamic.items)},[]),c.fireCellBasicInfoRetrieved(d)})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.selection.list",["jQuery","tau/ui/extensions/board.plus/ui.extension.board.plus.selection"],function($,a){return a.extend({subscribeCards:function(a){var b=this,c=a.find(".i-role-grid");c.delegate(".i-role-card","click",function(a){var d=$(this),e=a.ctrlKey||a.metaKey;e||c.find(".i-role-card.tau-selected").each(function(){b.fireCardSelected($(this),!1)});var f=d.hasClass("tau-selected");b.fireCardSelected(d,!f)})}})}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.list",["jQuery","app.path","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer"],function($,a,b){return b.extend({subscribe:function(a,b){a.delegate(".i-role-card","click",function(a){if($(a.target).hasClass("tau-id"))return;var c=$(a.currentTarget).data();b(c)});var c=a.find('[role="board-body"]'),d=c.children('[role="grid"]'),e=$("<div role='card-details-holder' class='tau-grid-view-details'></div>");e.addClass("tau-page-entity"),e.width(c.width()-d.width()-10),e.css("padding","5px"),c.append(e)},builtInCardDetails:function(a,b){var c=this;require(["tau/components/component.application","tau/configurator"],function(d,e){var f=e;c.current&&c.current.destroy(),f.pushRouting(),f.isBoardEdition=!0;var g=d.create({applicationId:c.childApplicationId,pageType:b.type,pageId:b.id,context:{configurator:e}});g.on("afterRender",function(b){var c=b.data.element;a.find('[role="card-details-holder"]').append(c)}),g.on("destroy",function(){f.popRouting()}),c.current=g,g.initialize()})},destroy:function(){var a=this;a.current&&a.current.fire("destroy"),delete a.current,this._super()}})}),define("tau/storage/url.resolver",["jQuery","Underscore","app.path","tau/core/query"],function($,_,a,b){var c=a.get(),d=c+"/storage/v1/";return{resolve:function(a){a=_.clone(a||{});var c=d+a.$group||"common";a.$key&&(c+="/"+a.$key),c+="?";var e=b.render(a.$where||{});return e&&(c+="&where="+e),a.$fields&&a.$fields.length&&(c+="&select=new("+a.$fields.join(",")+")"),encodeURI(c)}}}),define("tau/storage/api",["tau/core/Class","jQuery","Underscore","./url.resolver"],function(a,$,_,b){var c=function(a){a=a||{};var b=["key","ownerId","scope","id","group","data","userData","publicData"],d=_.difference(_.keys(a),b);return _.each(d,function(b){a[b]=JSON.parse(a[b])}),a.publicData&&(a.publicData=c(a.publicData)),a.userData&&(a.userData=c(a.userData)),a},d=function(a){a=a||{};var b={};return _.each(_.keys(a),function(c){b[c]=JSON.stringify(a[c])}),b},e=function(a){if(!a)return null;var b=(a?JSON.parse(a):null)||{},d=[];return b.items?(_.each(b.items,function(a){d.push(c(a))}),d):c(b)};return a.extend({config:null,init:function(a){this.config=a||{},_.defaults(this.config,{service:$.ajax})},resolve:function(a){var c=c||a.$config,f=b.resolve(a.$config),g={url:f,dataType:"json",$scope:c,converters:{"text json":e}};if(c.$value){var h=_.clone(c.$value);h.userData=d(h.userData),h.publicData=d(h.publicData),g.type="POST",g.contentType="application/json; charset=utf-8",g.data=JSON.stringify(h)}var i={ajaxConfig:g,config:c};return this.config.service(g).done(function(b){i.data=b,b&&(b.publicData||b.userData)&&(i.value=_.extend(b.publicData||{},b.userData||{})),a.resolve(i)}).fail(function(b){i.data=b,a.reject(i)}),a},select:function(a,b){return b.$group=a,this.resolveDeferred(b)},data:function(a,b,c){_.isObject(b)&&(c=b,b=null),c&&!c.hasOwnProperty("publicData")&&!c.hasOwnProperty("userData")&&(c={userData:c});var d={$group:a,$key:b,$value:c};return this.resolveDeferred(d)},createDeferredCall:function(a){var b=$.Deferred();return b.$config=a,b},resolveDeferred:function(a){return this.resolve(this.createDeferredCall(a))}})}),define("tau/models/model.board.selector",["Underscore","tau/core/model-base","tau/storage/api"],function(_,a,b){var c=a.extend({"bus afterInit":function(a){var c=this,d=new b;d.select("boards",{$fields:["key","userData.id","userData.name"]}).done(function(a){var b=_.map(a.data,function(a){return{id:a.id||a.key,slug:a.id||a.key,name:a.name||a.id||a.key}});c.fire("dataBind",{boards:b})})}});return c}),define("tau/ui/templates/board.selector/ui.template.board.selector",["tau/core/templates-factory"],function(a){var b={name:"board.selector",engine:"jqote2",markup:['<ul class="tau-board-list">',"<% _.forEach(this.boards, function(board){ %>","<li>",'<a href="#board/<%= board.slug %>"><%= board.name %></a>',"</li>","<% }); %>","</ul>"],dependencies:[]};return a.register(b)}),define("tau/models/orm/board",[],function(a){var b={};return b}),define("tau/models/model.board.settings",["Underscore","tau/core/model-base","tau/models/orm/board"],function(_,a,b){var c=a.extend({"bus board.dataProvided":function(a){var c=a.data,d=this;b.create({_id:c.name,"userData.name":c.name,"userData.slug":c.slug},function(a,b){})},"bus afterInit":function(a){this.fire("dataBind")}});return c}),define("tau/ui/extensions/board.settings/ui.extension.board.settings.create",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=this;b.delegate("[role=action-add]","click",function(){var a=window.prompt("WHAT?");if(!a)return;c.fire("board.dataProvided",{name:a,slug:a})})}})}),define("tau/ui/templates/board.settings/ui.template.board.settings",["tau/core/templates-factory"],function(a){var b={name:"board.settings",engine:"jqote2",markup:['<div class="tau-board-settings">','<div class="tau-rows-settings">',"<h4>Rows</h4>",'<p class="tau-entity-selector">','<select class="tau-select"><option>Teams</option></select>','<input type="text" placeholder="Filter" class="tau-in-text tau-filter">',"</p>","</div>",'<div class="tau-cols-settings">',"<h4>Cols</h4>",'<p class="tau-entity-selector">','<select class="tau-select"><option>Projects</option></select>','<input type="text" placeholder="Filter" class="tau-in-text tau-filter">',"</p>","</div>",'<div class="tau-content-settings">','<div class="tau-displayed-entities">',"<h4>What you want to see?</h4>","<p>",'<button class="tau-btn">Feature</button>','<button class="tau-btn">User Story</button>','<button class="tau-btn">Task</button>','<button class="tau-btn">Bug</button>','<button class="tau-btn">Project</button>','<button class="tau-btn">Release</button>','<button class="tau-btn">Iteration</button>','<button class="tau-btn">Person</button>','<button class="tau-btn">Time</button>','<button class="tau-btn">Request</button>','<button class="tau-btn">Test Case</button>','<button class="tau-btn">Test Plan</button>','<button class="tau-btn">Test Plan Run</button>',"</p>",'<input type="text" placeholder="Filter" class="tau-in-text tau-filter" />',"</div>",'<div class="tau-entity-hierarchy">',"<h4>How to show entities hierarchy?</h4>","<p>",'<label><input type="radio" checked="" name="tau-board-settings-entity-hierarchy">Inside a card</label>','<label><input type="radio" name="tau-board-settings-entity-hierarchy">As separate cards</label>',"</p>","</div>","</div>",'<div class="tau-settings-detalizator"><button class="tau-btn">More settings</button></div>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/board.zoomLevel/ui.template.board.zoomLevel",["tau/core/templates-factory"],function(a){var b={name:"ui.template.board.zoomLevel",engine:"jqote2",markup:['<div class="tau-zoom-level">',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/breadcrumbs/ui.template.breadcrumbs.item",["tau/core/templates-factory"],function(a){var b={name:"breadcrumbs-item",markup:['   <li class="ui-breadcrumbs__item"><a href="${url}">${title}</a></li>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/breadcrumbs/ui.template.breadcrumbs",["tau/core/templates-factory","tau/ui/templates/breadcrumbs/ui.template.breadcrumbs.item"],function(a){var b={name:"breadcrumbs",markup:["{{if items.length}}",'   <ul class="ui-breadcrumbs">','       {{tmpl(items) "breadcrumbs-item"}}',"   </ul>","{{/if}}"],dependencies:["breadcrumbs-item"]};return a.register(b)}),define("tau/views/view.collapsible",["tau/views/view.container"],function(a){var b=a.extend({"bus beforeInit":function(a){var b=a.data.config,c=b.collapsed,d=this.bus.name||"unknown";b.children=[{id:"header",type:"collapsibleHeader",name:d+" header",collapsed:c,children:b.header||[]},{id:"inners",type:"container",name:d+" inner",visible:!c,children:b.items||[]}]},"bus childrenRendered":function(a){var b=a.data.children,c=b[0],d=b[1];c.on("expanded",function(a){d.fire("show")}),c.on("collapsed",function(a){d.fire("hide")})},"bus expand+childrenRendered:last":function(a){var b=a.childrenRendered.data.children;b[0].fire("expand")},"bus collapse+childrenRendered:last":function(a){var b=a.childrenRendered.data.children;b[0].fire("collapse")}});return b}),define("tau/ui/extensions/collapsible/ui.extension.collapsible",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){this.element=a.data.element,a.data.data.collapsed&&this._collapse()},"bus expand":function(){this._expand()},"bus collapse":function(){this._collapse()},_collapse:function(){this.element.addClass("closed")},_expand:function(){this.element.removeClass("closed")}})}),define("tau/ui/extensions/collapsible/ui.extension.collapsible.state",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus beforeInit":function(a){var b=this.config=a.data.config;if(b.hasOwnProperty("stateName")){var c=b[b.stateName];if(_.isNull(c)||_.isUndefined(c))return;var d=c.toString().toLowerCase()=="true";b.collapsed=d,this.collapsed=d}},getStateName:function(){return this.config.stateName},onStateChanged:function(a){var b=a[this.getStateName()];if(_.isNull(b)||_.isUndefined(b))b=this.collapsed;var c=b.toString().toLowerCase()=="true",d=c?"collapse":"expand",e=this.config;e.collapsed=c;var f=e.stateName;f&&(e[f]=c),this.fire(d)},"bus childrenRendered":function(a){var b=a.data.children,c=b[0],d=b[1],e=this;c.on("expanded",this.onExpanded,this),c.on("collapsed",this.onCollapsed,this)},onCollapsed:function(){this.saveState(!0)},onExpanded:function(){this.saveState(!1)},saveState:function(a){var b=this.getStateName();if(b&&this.config[b]!=a){var c=this,d=c.config.context.componentSettings;if(d){var e={};e[b]=a,d.set({set:e})}}},"bus destroy+childrenRendered":function(a){var b=a.childrenRendered.data.children,c=b[0],d=b[1],e=this},"bus initialize":function(a){var b=this,c=b.config.context.componentSettings;c&&c.bind({fields:[this.getStateName()],listener:b,callback:b.onStateChanged})}})}),define("tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=this;b.element=a.data.element;var c=a.data.data,d=c.collapsed;b.collapsed=d;var e=d?"collapsed":"expanded";b.element.addClass(e),b.element.bind("click",$.proxy(b._onClickHandler,b))},"bus collapse":function(){var a=this;a.collapsed||a._onClickHandler()},"bus expand":function(){var a=this;a.collapsed&&a._onClickHandler()},_onClickHandler:function(){var a=this;a.collapsed=!a.collapsed;var b=a.collapsed,c=b?"expanded":"collapsed",d=b?"collapsed":"expanded",e=a.element;e.removeClass(c),e.addClass(d),this.fire(d)}})}),define("tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader",["tau/core/templates-factory"],function(a){var b={name:"collapsibleHeader",markup:['<div class="ui-collapsible-header">','    <div class="ui-children-container"></div>',"</div>"]};return a.register(b)}),define("tau/ui/templates/comments/ui.template.comments.comment",["tau/core/templates-factory"],function(a){var b={name:"comments-comment",markup:['<div class="ui-comment comment-id-${id}">','   <div class="ui-comment-body{{if isOwnerComment }} ui-commets-comment-owner{{/if}}{{if isRequester }} tau-comments-requester{{/if}}" >',"      {{if deleted}}","      DELETED","      {{else}}",'      <div class="ui-comment-heading">','         <li class="ui-comment-avatar" style=\'background-image:url("${avatar}")\'></li>','         <li class="ui-comment-name">${name}</li>','         <li class="ui-comment-ago"><span title="${createDate}">(${age})</span></li>',"      </div>",'      <div class="ui-comment-text">{{html description}}</div>',"      {{/if}}","   </div>",'   <div class="ui-comments">',"       {{if comments }}",'           {{tmpl(comments) "comments-comment"}}',"       {{/if}}","   </div>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/comments/ui.template.comments.comment.new.editor",["tau/core/templates-factory"],function(a){var b={name:"comments-comment-new-editor",markup:['<div class="ui-comment-new">','    <div class="ui-comment-heading">',"        <div class=\"ui-comment-avatar\" style='background:url(${avatar}) top left no-repeat;width:32px; height:32px;'></div>","    </div>",'    <div class="ui-comment-editor-placeholder">','        <div class="ui-comment-text"></div>',"    </div>","</div>"].join("")};return a.register(b)}),define("tau/models/model.comments.editable",["Underscore","tau/core/model.editable.base"],function(_,a){var b=a.extend({name:"Editable Comments",_signUpEventsIfRequired:function(){var a=this;if(a._signedUp)return;a._signedUp=!0;var b=function(b){b.data.cmd.guid=+(new Date),a.fire("prepareUpdate",b.data)},c=function(b){a.fire("applyUpdate",b.data)},d=function(b){b.data.cmd.guid=+(new Date),a.fire("prepareRemove",b.data)},e=function(b){var c=b.data.obj.parentId,d=a.getComment(c);d&&d.deleted&&d.comments.length===1?a.store.remove("comment",{id:c}).done():a.fire("applyRemove",b.data)};a.store.unbind(a),a.store.on({eventName:"beforeSave",type:"comment",listener:a},b).on({eventName:"afterSave",type:"comment",listener:a},c).on({eventName:"beforeRemove",type:"comment",listener:a},d).on({eventName:"afterRemove",type:"comment",listener:a},e)},"bus dataBind":function(a){var b=a.data.items;this.commentsList=this.getPlainList(b);var c=_(this.commentsList).pluck("id"),d={editable:!0,editableItems:c,deletable:!0,deletableItems:c},e=this;e._signUpEventsIfRequired(),e.fire("permissionsReady",d)},getComment:function(a){var b=a?_(this.commentsList).detect(function(b){return b.id===a}):null;return b},getPlainList:function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.push(e);var f=arguments.callee.call(this,a[c].comments);b=b.concat(f)}return b}});return b}),define("tau/ui/extensions/ui.extension.shortcutProcessor",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data,c=this.$element=b.element,d=this.config.shortcutProcessorTarget,e=[],f=c.find(d),g=/\b(?:id):(?:\W|&nbsp;){0,5}(\d+)\b/gi;f.each(function(a,b){var c=$(b),d=c.html(),f=!1;d=d.replace(g,function(){f=!0;var a=arguments[1];return e.push(a),"<span class='tau-shortcut-loading' entity_ref='"+a+"'>id:"+a+"</span>"}),f&&c.html(d)}),e=_(e).uniq();var h=e.length;if(h){var i=this,j=this.config.store;for(var k=0;k<h;k++){var l=e[k],m={id:l,fields:["id","name",{entityType:["id","name"]}],silent:!0};j=j.get("general",m,{success:i.replaceShortcut,scope:i})}j.done()}},replaceShortcut:function(a){var b=a.data,c=$('<a href="#'+b.entityType.name+"/"+b.id+'">#'+b.id+"&nbsp;"+b.name+"</a>");this.$element.find("[entity_ref='"+b.id+"']").each(function(a,b){var d=$(b);d.replaceWith(c.clone())})}})}),define("tau/ui/templates/comments/ui.template.comments",["tau/core/templates-factory","tau/ui/templates/comments/ui.template.comments.comment"],function(a){var b={name:"comments",options:{contentSelector:".ui-comments-content"},markup:['<div class="box ui-comments-control">','   <div class="ui-all-comments ui-comments-content">','       {{tmpl(items) "comments-comment"}}',"   </div>","</div>"].join(""),dependencies:["comments-comment"]};return a.register(b)}),define("tau/ui/extensions/ui.extension.domOperationsBase",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({name:"ui.extension.domOperationsBase","bus markElementToBeDeleted":function(a){var b=a.data,c=b.element;c.addClass("deleting")},"bus deleteElement":function(a){var b=a.data.element,c=a.data.callback;b.fadeOut(750,c)},"bus markElementToBeUpdated":function(a){var b=a.data,c=b.element;c.addClass("updating")},"bus cancelUpdateElement":function(a){var b=a.data.element;this._highlightElement(b,"#EE5757",1500)},"bus updateElement":function(a){var b=this,c=a.data.element;c.each(function(){var a=$(this);b._highlightElement(a,"#FFFFD3",1500)})},_highlightElement:function(a,b,c){a.stop(!0,!0),a.removeClass("updating"),a.addClass("before-animate");var d=this._getElementBgColor(a),e=a.css("backgroundColor"),f=function(){a.css("backgroundColor","")};a.removeClass("before-animate"),a.css({backgroundColor:b}).animate({backgroundColor:d},c,f)},_getElementBgColor:function(a){var b="transparent";while(a.length>0&&a.parent()&&((b=a.css("backgroundColor"))=="transparent"||b==undefined||b=="rgba(0, 0, 0, 0)"||b.length==0)){a=a.parent();if(a.is("body"))break}if(b=="transparent"||b.length==0)b="#ffffff";return b}})}),define("tau/models/model.customField.editable",["Underscore","tau/core/model.editable.base"],function(_,a){var b=a.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(a){var b=a.data.cmd.$set.customFields[0].value;a.data.cmd.$set.customFields[0].value=b?b:null,a.data.cmd.$set.customFields[0].type=="URL"&&b.label==null&&b.url==null&&(a.data.cmd.$set.customFields[0].value=null)},"bus beforeInit+configurationProvided":function(a){var b=a.beforeInit.data.config.context.entity,c=a.configurationProvided.data;this.configuration=c,this.beforeSaveHandler||(this.beforeSaveHandler=_.bind(this._beforeSave,this),this.store.on({eventName:"beforeSave",type:b.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:b.id}},this.beforeSaveHandler)),this.afterSaveHandler||(this.afterSaveHandler=_.bind(this._afterSave,this),this.store.on({eventName:"afterSave",type:b.entityType.name,listener:this,filter:{id:b.id}},this.afterSaveHandler))},_beforeSave:function(a){var b=a.data.changes.customFields[0];_.mergeFields(a.data.cmd.config.fields,["customFields"]);var c=this.configuration;b.name==c.name&&b.type==c.type&&this.bus.fire("preRefreshRow",{data:b})},_afterSave:function(a){this.bus.fire("refreshRow",{})},destroy:function(){this.beforeSaveHandler=null,this.afterSaveHandler=null,this._super()}});return b}),define("tau/core/tau-widget",["Underscore","jQuery","tau/core/event"],function(_,$,a){var b=function(b,c){var d=c._create||function(){};c._create=function(){var b=this;d.apply(b,arguments),b.bus=b.options.bus||b.element.data("bus"),a.subscribeOn(b)},_.extend(c,{_fire:function(){this.bus.fire.apply(this.bus,arguments)}}),$.widget(b,c)};return{widget:b}}),define("tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle",["jQuery","tau/core/tau-widget"],function($,a){a.widget("ui.checkboxToggle",{options:{onSave:function(){},classNames:{checked:"checked",unchecked:"unchecked"}},_create:function(){this.init()},init:function(){var a=this.element,b=this,c=this.options.classNames;this.toggleProxy=$.proxy(this.onClick,this),a.click(this.toggleProxy)},activate:function(){var a=this.options.classNames;this._toggle(this.element,a.checked,a.unchecked),this.options.onSave(this.element.hasClass(a.checked))},onClick:function(a){a.stopPropagation(),this.toggle()},toggle:function(){var a=this.element,b=this.options.classNames;this._toggle(a,b.checked,b.unchecked),this.options.onSave(a.hasClass(b.checked))},_toggle:function(a,b,c){var d=a;d.hasClass(b)?(d.removeClass(b),d.addClass(c)):d.hasClass(c)?(d.removeClass(c),d.addClass(b)):d.addClass(b)},destroy:function(){delete this.toggleProxy}})}),define("tau/ui/behaviour/customField/ui.behaviour.customField.row",["Underscore","jQuery"],function(_,$){$.widget("ui.behaviourCustomFieldRow",{options:{onActivate:$.noop},_create:function(){var a=this.element;this.$element=a;var b=this;a.click(function(a){a.preventDefault(),b.options.onActivate.call(this,a)})},setValidationErrors:function(a){var b=this.$element;_.each(a,function(a,c){b.find("[name="+c+"]").addClass("ui-editableText-validationerror").attr("title",a)})},resetValidationErrors:function(a){this.$element.find(":text").removeClass("ui-editableText-validationerror").attr("title",null)},setValue:function(a){var b=this.$element;_.each(a,function(a,c){b.find("[name="+c+"]").val(a)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.checkbox.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");f.checkboxToggle({classNames:{checked:"ui-customfield__value_checked",unchecked:"ui-customfield__value_unchecked"},onSave:function(a){f.removeClass("ui-validationerror"),b.bus.fire("elementUpdated"),b.bus.fire("save",{customFields:[{name:c.name,type:c.type,value:a}]})}}),e.behaviourCustomFieldRow({onActivate:function(a){a.stopPropagation(),$(a.target).hasClass("ui-customfield__value")==0&&f.checkboxToggle("activate")}}),e.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/extensions/customField/ui.extension.customField.required",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){var b=a.extend({category:"view",name:"Required custom field","bus afterRender+beforeInit+dataBind":function(a){var b=a.dataBind.data;if(a.beforeInit.data.config.customField&&a.beforeInit.data.config.customField.required){var c=b.value;c&&(c.hasOwnProperty("url")?c=c.url:c.hasOwnProperty("id")&&(c=c.id)),!_.isBoolean(c)&&!_.isNumber(c)&&_.isEmpty(c)&&(a.afterRender.data.element.find(".ui-customfield__value").addClass("ui-validationerror"),a.afterRender.data.element.attr("title","Required field"))}}});return b}),define("tau/ui/templates/customField/ui.template.customField.checkbox",["tau/core/templates-factory"],function(a){var b={name:"customField-checkbox",markup:['<div class="ui-customfield ui-customfield-checkbox">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value ui-customfield__value_{{if value}}checked{{else}}unchecked{{/if}}">&nbsp;</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("libs/schema.js/lib/utils",["require","exports","module"],function(require,exports,module){var a=Array.prototype.slice,b=Object.hasOwnProperty;Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new Error("Invalid object");var c=[];for(var d in a)b.call(a,d)&&(c[c.length]=d);return c}),exports.extend=function(b){var c=a.call(arguments,1),d;for(var e=0,f=c.length;e<f;e++){d=c[e];for(var g in d)b[g]=d[g]}return b},exports.locale=function(a,b){if(a instanceof Object){b=""+b||"en";if(a[b]!==undefined)return a[b];parts=b.split("_");while(parts.pop()){b=parts.join("_");if(a[b]!==undefined)return a[b]}return a.en}return a}}),define("libs/schema.js/lib/objecttools",["require","exports","module"],function(require,exports,module){typeof global=="undefined"&&typeof window=="object"&&(window.global=window),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)a.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b});var a=0,b=["$ref","$refs","$$refs"],c={},d=c.find=function(a,b){var c,d=a;for(var e=b.length,f=0;f<e;f++){if((c=b[f])===undefined)break;if((d instanceof Object||d instanceof Array)&&c in d)d=d[c];else return}return d},e={},f=c.id=function(b){if(b instanceof Object)return b.hasOwnProperty("__id")||(b.__id=a++),b.__id;return},g=c.resetRefs=function(a){if(a instanceof Object){var b=h(a);return b?(b.splice(0),b):(b=[],a instanceof Array?a.push({$$refs:b}):a.$refs=b,b)}return null},h=c.getRefs=function(a){if(a instanceof Object)return a instanceof Array&&a[a.length-1]&&a[a.length-1].$$refs instanceof Array?a[a.length-1].$$refs:a.hasOwnProperty("$refs")?a.$refs:null;return null},i=c.addRef=function(a,b,c){var d=h(a);if(!d)throw new Error("You need to call resetRefs(object) first!");return d.push(b),d.push(c),d},j=c.findRefs=function(a){var c={},d=[],e=g(a),h=function(g){if(!(g instanceof Object))return;var i=f(g);if(c[i]!==undefined){e.push([].concat(d)),e.push(c[i]);return}c[i]=["#"].concat(d);if(a instanceof Array){for(var j=a.length,k=0;k<j;k++)d.push(k),h(g[k]),d.pop();return}for(var l=Object.keys(g),j=l.length,k=0,m;m=l[k],k<j;k++){if(b.indexOf(m)>-1)continue;d.push(m),h(g[m]),d.pop()}};return h(a),a},k=c.resolveRefs=function(a,b){var c,e=a instanceof Array;if(e){var f=a[a.length-1];f instanceof Object&&f.$refs instanceof Array&&(c=f.$refs)}else a instanceof Object&&a.$refs instanceof Array&&(c=a.$refs);if(!c)return a;var g,h,i,j,k;for(var l=c.length,m=0;m<l;m+=2){g=[].concat(c[m]),i=[].concat(c[m+1]),h=g.pop(),j=i.shift();if(h===undefined||j===undefined)continue;k=d(a,g);if(!k)continue;j!=="#"&&i.unshift(j);if(j!=="#"&&!b)continue;k[h]=d(j==="#"?a:global,i),c.splice(m,2),m-=2,l-=2}return a};module.exports={},typeof module=="object"&&module.exports&&(module.exports=c)}),define("libs/schema.js/lib/validation",["require","exports","module","./utils","./objecttools"],function(require,exports,module){var a=require("./utils"),b=require("./objecttools"),c=a.locale,d=Array.prototype.slice;module.exports=function(){var e=this,f=this.detectRecursion,g=this.Validation=function(b,d,h){h=h||{},this._flags={},this._errors={},this._wasError=0,this._stack=[],this.path=[],this.id=g._id++,this.schema,this.push(b),this.instance=d,this.locale=e.locale||"en",this.detectRecursion=h.detectRecursion||f,this.errors=[];var i=this,j=this.Error=function(b,d,e){this.schema=i.schema,this.path=i.path?[].concat(i.path):[],this.attribute=b||"",this.description=typeof d=="object"?c(d,i.locale)(this):d||"",e&&a.extend(this,e),i._errors[this.id()]||(i._errors[this.id()]=!0,i.errors.push(this)),i._wasError++};j.prototype.toJSON=function(){return{path:this.path,name:this.attribute,description:this.description}},j.prototype.id=function(){return[this.path,undefined,this.attribute]+""},this.instance=this.start(d),delete this._flags,this._errors,this._wasError,this._stack,this.path,this.id};a.extend(g.prototype,{isError:function(){return this.errors.length>0},getError:function(){if(this.errors.length===0)return null;var a=new Error(c(e.i18n("validation_error"),this.locale)(this));return a.errors=this.errors,a.toJSON=function(){return{message:this.message,errors:this.errors}},a},wasError:function(){var a=this._wasError;return this._wasError=0,a},push:function(a,b){this.schema=a,this._stack.push(a),b!==undefined&&this.path.push(b)},pop:function(a){var b=[this._stack.pop(),a?undefined:this.path.pop()],c=this._stack.length;return this.schema=c?this._stack[c-1]:null,b},getFlag:function(a){return b.id(a)+"_"+this.schema.id},flagObject:function(a){return this._flags[this.getFlag(a)]=!0,a},isObjectFlagged:function(a){return this.getFlag(a)in this._flags},callPlugin:function(a,b){var c=arguments.length>2?d.call(arguments,1):[b];return typeof a!="function"&&(a=g.plugins[a]||g.plugins.addError),a.apply(this,c)}}),a.extend(g,{_id:1,registerPlugins:function(b){a.extend(g.plugins,b)},plugins:{addError:function(a,b){return new this.Error(b,e.i18n["validation_error_"+b]),a}}}),require("./"+this.v+"/validation").call(this)}}),define("libs/schema.js/lib/schema",["require","exports","module","./utils","./objecttools"],function(require,exports,module){var a=require("./utils"),b=require("./objecttools");module.exports=function(){var c=this,d=this.Schema=function(b){typeof b=="string"&&(b=JSON.parse(b));if(b instanceof d)return b;a.extend(this,b),this.id===undefined&&(this.id=""+d._id++),d.instances[this.id]=this};a.extend(d.prototype,{validate:function(a,b){var d=new c.Validation(this,a,b);return delete d.instance.__id,d},setFallbacks:function(b){return typeof b=="string"?this.fallbacks=c.Validation[b]:b===undefined?this.fallbacks=c.fallbacks:this.fallbacks=a.extend({},c.fallbacks,b),this}}),a.extend(d,{_id:1,create:function(a){if(typeof a=="string")var a=JSON.parse(a);var b=c.schemaSchema.validate(a);if(b.isError())throw console.log(b.getError()),b.getError();return b.instance},createSeveral:function(a){for(var b in a)a[b].id===undefined&&(a[b].id=b),a[b]=this.create(a[b]);return a},instances:{},resolveRefs:function(){for(var a in this.instances)b.resolveRefs(this.instances[a],!0)}})}}),define("libs/schema.js/lib/environment",["require","exports","module","./objecttools","./utils","./schema","./validation"],function(require,exports,module){var a=require("./objecttools"),b=require("./utils"),c=Array.prototype.slice,d=b.extend,e=b.locale,f=function(a,b){var c;if(typeof a=="object")b=a;else{if(f.instances[a])return f.instances[a];c=this,this.id=a,f.instances[a]=this}b=b||{};var e=b.i18n||["../i18n/default"];e instanceof Array||(e=[e]);var g=this.i18n=function(a){return g[a]||{en:function(){return""}}},h;for(var i=0,j=e.length;i<j;i++)h=e[i],typeof h=="object"?d(g,h):d(g,require(h));delete b.i18n,this.locale=b.locale||"en",delete b.locale,this.v="draft-02",delete b.v,this.detectRecursion=b.detectRecursion===undefined?!0:b.detectRecursion,delete b.detectRecursion,require("./schema").call(this);var k=this.Schema;k.v=this.v,require("./validation").call(this);var l=this.Validation,m=b.fallbacks||"TOLERANT_FALLBACKS";typeof m=="object"?this.fallbacks=d(l.STRICT_FALLBACKS,m):this.fallbacks=l[m],delete b.fallbacks,d(this,b),require("./"+this.v+"/setupSchemaSchema").call(this);var n=this.schemaSchema.validate(this.schemaSchema,{detectRecursion:!0});if(n.isError())throw console.log("The core schema is not valid!"),n.getError()};d(f.prototype,{validateCall:function(a,b){if(a.SCHEMA instanceof this.Schema){var d=a.SCHEMA.validate(c.call(arguments,2)),e=d.instance;if(d.isError())throw d.getError();return a.apply(b,e)}throw"No SCHEMA defined"},validateCallAsync:function(a,b){if(!(a.SCHEMA instanceof this.Schema))throw"No SCHEMA defined";var d=c.call(arguments,2),e=d.pop(),f=a.SCHEMA.validate(d),d=f.instance;if(f.isError())return e(f.getError());d.push(e),a.apply(b,d)},f:function(a,b,d,e){var f=c.call(arguments),e=f.pop();if(f.length===0)return e.IS_ASYNC=!1,e;if(a instanceof Object){var b=!!f[1],a=this.Schema.create(a),d=!!f[2],g,h,i=this;return d?g=function(){return i.validateCallAsync.apply(i,[e,this].concat(c.call(arguments)))}:g=function(){return i.validateCall.apply(i,[e,this].concat(c.call(arguments)))},e.SCHEMA=a,e.IS_VALIDATING=b,e.IS_ASYNC=d,g.SCHEMA=a,g.IS_VALIDATING=b,g.IS_ASYNC=d,h=b?g:e,b||(h.validate=g),h}return e.IS_ASYNC=!!f[0],e}}),f.instances={};var g=function(a,b){return new f(a,b)};return module.exports={},typeof module=="object"&&module.exports?module.exports=g:window.createEnvironment=g,module.exports}),define("libs/schema.js/i18n/default",["require","exports","module"],function(require,exports,module){module.exports={validation_error:{de:function(){return"Diese Instanz ist nicht gültig"},en:function(){return"This instance is not valid"}},validation_error_type:{de:function(a){return"Ungültiger Typ"},en:function(a){return"Invalid type"}},validation_error_minLength:{de:function(a){return"Der Text muss mindestens "+a.schema.minLength+" Zeichen haben."},en:function(a){return"Text must be longer than "+a.schema.minLength+" symbols"}},validation_error_maxLength:{en:function(a){return"Text must be shorter than "+a.schema.maxLength+" symbols"}},validation_error_minimum:{en:function(a){return"Number must be greater than "+a.schema.minimum+""}},validation_error_maximum:{en:function(a){return"Number must be less than "+a.schema.maximum+""}},validation_error_pattern:{en:function(a){return"Incorrect value"}},validation_error_optional:{en:function(a){return"Required field"}}}}),define("libs/schema.js/lib/draft-02/validation",["require","exports","module","Underscore","../utils","../objecttools"],function(require,exports,module){var _=require("Underscore"),a=require("../utils"),b=require("../objecttools");module.exports=function(){var c=this,d=this.Schema;a.extend(this.Validation.prototype,{start:function(a){if(this.detectRecursion&&a instanceof Object){if(this.isObjectFlagged(a))return a;this.flagObject(a)}return a=this["extends"](a),this.wasError()?a:(a=this.adapters(a,"pre"),this.wasError()?a:(a=this.optional(a),this.wasError()||a===undefined?a:(a=this.empty(a),this.wasError()||a===""||a===null?a:(a=this.type(a),this.wasError()?a:(a=this.requires(a),this.wasError()?a:(a=this.adapters(a,"post"),a))))))},"extends":function(a){return this.schema["extends"]?(this.push(this.schema["extends"]),a=this.start(a),this.pop(!0),a):a},optional:function(a){return this.schema.optional||a!==undefined?a:this.callPlugin(this.schema.fallbacks.optional,a,"optional")},empty:function(a){return this.schema.empty||a!==undefined&&a!==""&&a!==null?a:this.callPlugin(this.schema.fallbacks.optional,a,"empty")},adapters:function(a,b){if(!this.schema[b])return a;var c=this.schema[b];c instanceof Array||(c=[c]);var d=this.errors.length,e;for(var f=c.length,g=0;g<f;g++){e=c[g],a=this.callPlugin(e,a);if(this.errors.length>d)return a}return a},type:function(a,b,c){c=c===!1?!1:!0;var d=b||this.schema.type;if(!(d instanceof Array)){var e=typeof a,f=function(){if(d==="any")return!0;if(d==="null")return a===null;if(d==="array")return a instanceof Array;if(d==="object")return a instanceof Object&&!(a instanceof Array);if(d==="number")return e==="number";if(d==="integer")return e==="number"&&Math.round(a)===a;if(d==="string")return e==="string";if(d==="boolean")return e==="boolean"}();if(!f){a=this.callPlugin(this.schema.fallbacks.type,a,"type");if(this.wasError())return a}var b=typeof a;return b==="number"?(a=this.minimum(a),this.wasError()?a:(a=this.maximum(a),this.wasError()?a:(a=this.maxDecimal(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)))):b==="string"?(a=this.pattern(a),this.wasError()?a:(a=this.minLength(a),this.wasError()?a:(a=this.maxLength(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)))):a instanceof Array?(a=this.minItems(a),this.wasError()?a:(a=this.maxItems(a),this.wasError()?a:(a=this.items(a),this.wasError()?a:(a=this.additionalProperties(a),this.wasError()?a:(c&&(a=this["enum"](a)),a))))):a instanceof Object?(a=this.properties(a),a=this.additionalProperties(a),this.wasError()?a:(c&&(a=this["enum"](a)),a)):a}var g,h=this.errors.length;for(var i=d.length,j=0;j<i;j++){g=this.type(a,d[j],j===0);if(this.errors.length===h){a=g;break}j+1<i&&(this.errors.splice(h,1),this.wasError())}return a},"enum":function(a){return"enum"in this.schema?_.indexOf(this.schema["enum"],a)>-1?a:this.callPlugin(this.schema.fallbacks["enum"],a,"enum"):a},requires:function(a){if(this.schema.requires!==undefined&&this.parentInstance){var b;typeof this.schema.requires=="string"?(b={properties:{}},b.properties[this.schema.requires]={type:"any"}):b={properties:this.schema.requires},b=d.create(b);var c=this.pop();this.push(b),this.properties(this.parentInstance),this.pop(!0),this.push.apply(this,c)}return a},properties:function(a){if("properties"in this.schema){var b=this.schema.properties,c,d;this.parentInstance=a;var e,d;for(var f in b){this.push(b[f],f),e=f in a,f!="__id"?d=this.start(a[f]):(d=undefined,e=!1);if(e||d!==undefined)a[f]=d;this.pop()}this.parentInstance=null}return this.wasError(),a},additionalProperties:function(a){if("additionalProperties"in this.schema)if(a instanceof Object&&!(a instanceof Array)){var b=this.schema.properties||{};if(!this.schema.additionalProperties){for(var c=Object.keys(a),d=c.length,e=0,f;f=c[e],e<d;e++)if(!(f in b)&&f!="__id")return this.callPlugin(this.schema.fallbacks.additionalProperties,a,"additionalProperties")}else if(this.schema.additionalProperties!==!0)for(var c=Object.keys(a),d=c.length,e=0,f;f=c[e],e<d;e++)f in b||(this.push(this.schema.additionalProperties,f),f!=="__id"&&(a[f]=this.start(a[f])),this.pop())}else if(this.schema.items instanceof Array)if(!this.schema.additionalProperties){if(a.length>this.schema.items.length)return this.callPlugin(this.schema.fallbacks.additionalProperties,a,"additionalProperties")}else if(this.schema.additionalProperties!==!0)for(var d=a.length,e=this.schema.items.length;e<d;e++)this.push(this.schema.additionalProperties,e),a[e]=this.start(a[e]),this.pop();return a},items:function(a){if("items"in this.schema)if(this.schema.items instanceof Array){var b,c;for(var d=this.schema.items.length,e=0;e<d;e++){this.push(this.schema.items[e],e),b=e in a,e!="__id"?c=this.start(a[e]):(b=!1,c=undefined);if(b||c!==undefined)a[e]=c;this.pop()}}else for(var d=a.length,e=0;e<d;e++)this.push(this.schema.items,e),e!="__id"&&(a[e]=this.start(a[e])),this.pop();return a},maxItems:function(a){return this.schema.maxItems&&a.length>this.schema.maxItems?this.callPlugin(this.schema.fallbacks.maxItems,a,"maxItems"):a},minItems:function(a){return this.schema.minItems&&a.length<this.schema.minItems?this.callPlugin(this.schema.fallbacks.minItems,a,"minItems"):a},minimum:function(a){if("minimum"in this.schema){var b="minimumCanEqual"in this.schema?this.schema.minimumCanEqual:!0;return(b?a>=this.schema.minimum:a>this.schema.minimum)?a:this.callPlugin(this.schema.fallbacks.minimum,a,"minimum")}return a},maximum:function(a){if("maximum"in this.schema){var b="maximumCanEqual"in this.schema?this.schema.maximumCanEqual:!0;return(b?a<=this.schema.maximum:a<this.schema.maximum)?a:this.callPlugin(this.schema.fallbacks.maximum,a,"maximum")}return a},maxDecimal:function(a){if("maxDecimal"in this.schema){var b=Math.pow(10,this.schema.maxDecimal);return Math.round(a*b)/b===a?a:this.callPlugin(this.schema.fallbacks.maxDecimal,a,"maxDecimal")}return a},pattern:function(a){return this.schema.pattern?this.schema.pattern.test(a)?a:this.callPlugin(this.schema.fallbacks.pattern,a,"pattern"):a},minLength:function(a){return this.schema.minLength===undefined?a:a.length>=this.schema.minLength?a:this.callPlugin(this.schema.fallbacks.minLength,a,"minLength")},maxLength:function(a){return this.schema.maxLength===undefined?a:a.length<=this.schema.maxLength?a:this.callPlugin(this.schema.fallbacks.maxLength,a,"maxLength")}}),a.extend(this.Validation,{TOLERANT_FALLBACKS:{optional:"setDefault",type:"castTolerantlyToType","enum":"setDefault",requires:"addError",additionalProperties:"removeAdditionalProperties",maxItems:"sliceToMaxItems",minItems:"addError",maximum:"setMaximum",minimum:"setMinimum",maxDecimal:"roundToMaxDecimal",pattern:"addError",minLength:"addError",maxLength:"addError"},STRICT_FALLBACKS:{optional:"addError",type:"addError","enum":"addError",requires:"addError",additionalProperties:"addError",maxItems:"addError",minItems:"addError",maximum:"addError",minimum:"addError",maxDecimal:"addError",pattern:"addError",minLength:"addError",maxLength:"addError"}}),this.Validation.registerPlugins({addToRefs:function(a){if(a instanceof Object&&!(a instanceof Array)&&typeof a.$ref=="string"){var c=this.path,d=a.$ref.split(".");b.addRef(this.instance,[].concat(c),d[0]==="#"?[].concat(d):["#","constructor","instances"].concat(d))}return a},instantiateSchema:function(a){if(!(a instanceof Object)||a instanceof Array)return a;var c=a===this.instance;a instanceof d||(a=new d(a)),c&&(this.instance=a);if(a.properties instanceof Object){var e=a.properties||{};for(var f in e)e[f]instanceof Object&&!(e[f]instanceof d)&&(e[f]=new d(e[f]))}if(a.items instanceof Array){var g=a.items;for(var h=g.length,i=0;i<h;i++)g[i]instanceof Object&&!(g[i]instanceof d)&&(g[i]=new d(g[i]))}else a.items instanceof Object&&(a.items instanceof d||(a.items=new d(a.items)));if(a.requires&&a.requires instanceof Object&&!(a.requires instanceof Array)){var e=a.requires;for(var f in e)e[f]=new d(e[f])}return a.additionalProperties instanceof Object&&!(a.additionalProperties instanceof d)&&(a.additionalProperties=new d(a.additionalProperties)),a["extends"]instanceof Object&&(a["extends"]instanceof d||(a["extends"]=new d(a["extends"]))),a.setFallbacks(a.fallbacks),b.resetRefs(a),a},castTolerantlyToType:function(a,b){b=b||"type";var d=this.schema.type,e=typeof a,f;if(d==="string")return e==="object"?a!==null&&typeof a.toString=="function"&&a.toString!==Object.prototype.toString&&a.toString!==Array.prototype.toString?""+a:(new this.Error(b,c.i18n["validation_error_"+b]),a):""+a;if(d==="number"){if(e!=="boolean")return f=parseFloat(a),isNaN(f)&&a!=0?(new this.Error(b,c.i18n["validation_error_"+b]?c.i18n["validation_error_"+b]:"validation_error_"+b),a):isNaN(f)?a:f;if(a===!1)return 0;if(a===!0)return 1}if(d==="integer"){if(e!=="boolean")return f=parseInt(a,10),isNaN(f)?(new this.Error(b,c.i18n["validation_error_"+b]),a):f;if(a===!1)return 0;if(a===!0)return 1}if(d==="boolean")return e==="string"?a.trim().toLowerCase()==="false"?!1:(f=parseFloat(a),isNaN(f)?!0:!!f):!!a;if(d==="object")return a instanceof Array&&a.length===0?{}:((e!=="object"||a===null||a instanceof Array)&&new this.Error(b,c.i18n["validation_error_"+b]),a);if(d==="array"){if(!a)return[];if(a instanceof Object){var f=[],g,h=!0;if(Object.keys(a).length===0)return f;for(var i in a){g=parseInt(i,10),""+g===i?f[g]=a[i]:h=!1;break}}return new this.Error(b,c.i18n["validation_error_"+b]),a}if(d==="null")return new this.Error(b,c.i18n["validation_error_"+b]),a},roundToMaxDecimal:function(a,b){if(this.schema.maxDecimal===undefined)return new this.Error(b,c.i18n["validation_error_"+b]),a;var d=Math.pow(10,this.schema.maxDecimal);return Math[a<0?"ceil":"floor"](a*d)/d},setMinimum:function(a,b){return this.schema.minimum===undefined?(new this.Error(b,c.i18n["validation_error_"+b]),a):this.schema.minimum},setMaximum:function(a,b){return this.schema.maximum===undefined?(new this.Error(b,c.i18n["validation_error_"+b]),a):this.schema.maximum},truncateToMaxLength:function(a,b){return this.schema.maxLength===undefined?(new this.Error(b,c.i18n["validation_error_"+b]),a):a.substr(0,this.schema.maxLength)},setDefault:function(a,b){if("default"in this.schema)return this.schema["default"];new this.Error(b,c.i18n["validation_error_"+b])},removeAdditionalProperties:function(a,b){if(this.schema.type==="object"){var c=this.schema.properties||{};for(var d=Object.keys(a),e=d.length,f=0,g;g=d[f],f<e;f++)c[g]===undefined&&delete a[g];return a}if(this.schema.items&&this.schema.items instanceof Array)for(var e=a.length,f=this.schema.items.length;f<e;f++)delete a[f];return a},sliceToMaxItems:function(a,b){return this.schema.maxItems!==undefined?a.length>this.schema.maxItems&&a.splice(this.schema.maxItems):new this.Error(b,c.i18n["validation_error_"+b]),a},deleteInstance:function(a){return undefined}})}}),define("libs/schema.js/lib/draft-02/setupSchemaSchema",["require","exports","module"],function(require,exports,module){module.exports=function(){var a=this.Schema,b=this.Validation,c={id:"jsonSchemaCore",title:"JSON Schema Core Schema",description:"This is the JSON Schema for JSON Schemas.",type:"object",properties:{type:{type:["string","array"],items:{type:"string","enum":{$ref:"#.properties.type.enum"}},uniqueItems:!0,description:"This is a type definition value. This can be a simple type, or a union type","enum":["string","object","array","boolean","number","integer","null","any"],minItems:2,optional:!0,"default":"any",pre:"addToRefs",labels:{de:{string:"Text",object:"Objekt",array:"Liste","boolean":"wahr/falsch",number:"Zahl",integer:"ganze Zahl","null":"undefiniert"},en:{}}},id:{type:"string",optional:!0,minLength:1,pattern:"[^\\.#]",description:"A globally unique ID for this schema. It can be used to reference the schema from another one."},optional:{type:"boolean",description:"This indicates that the instance property in the instance object is not required.",optional:!0,"default":!1,pre:"addToRefs"},empty:{type:"boolean",description:"This indicates that the instance property in the instance object can be empty.",optional:!0,"default":!1,pre:"addToRefs"},"enum":{type:"array",optional:!0,description:"This provides an enumeration of possible values that are valid for the instance property. It goes only for the first type, if type is an array of types.",minItems:1,uniqueItems:!0},description:{type:"string",optional:!0,description:"This provides a description of the purpose the instance property. The value can be a string or it can be an object with properties corresponding to various different instance languages (with an optional default property indicating the default description).",pre:"addToRefs"},title:{type:"string",optional:!0,description:"This provides the title of the property",pre:"addToRefs"},"default":{type:"any",optional:!0,description:"This indicates the default for the instance property.",pre:"addToRefs"},options:{type:"array",optional:!0,items:{type:"object",properties:{label:{type:"string",optional:!0},value:{type:"any"}}},pre:"addToRefs"},"extends":{type:"object",optional:!0,pre:"addToRefs"},requires:{type:["string","object"],additionalProperties:{$ref:"#"},optional:!0,description:"indicates a required property or a schema that must be validated if this property is present",pre:"addToRefs"},nonStandard:{type:"boolean",optional:!0,"default":!1,nonStandard:!0},pre:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several prefix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},post:{type:["string","array","any"],items:{type:["string","any"]},optional:!0,description:"One or several postfix adapters identified by plugin IDs",nonStandard:!0,pre:"addToRefs"},fallbacks:{type:"object",additionalProperties:{type:["string","object"],description:"Identifier for a adapter function that will be executed if a constraint is violated"},description:"Fallback object, with property names = schema property names",nonStandard:!0,pre:"addToRefs"},properties:{type:"object",additionalProperties:{$ref:"#"},description:"This is a definition for the properties of an object value",optional:!0,"default":{},pre:"addToRefs"},items:{type:["object","array"],properties:{$ref:"#.properties"},items:{$ref:"#"},description:"When the value is an array, this indicates the schema to use to validate each item in an array",optional:!0,pre:["instantiateSchema","addToRefs"]},maxItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates maximum number of items.",minimum:0,pre:"addToRefs"},minItems:{type:"integer",optional:!0,description:"When the instance value is an array, this indicates minimum number of items.",minimum:0,pre:"addToRefs"},additionalProperties:{type:["boolean","object"],properties:{$ref:"#.properties"},description:"This provides a default property definition for all properties that are not explicitly defined in an object type definition.",optional:!0,"default":!0,pre:["instantiateSchema","addToRefs"]},minimum:{type:"number",optional:!0,description:"This indicates the minimum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},minimumCanEqual:{type:"boolean",optional:!0,description:"If the minimum is defined, this indicates whether or not the instance property value can equal the minimum.","default":!0,pre:"addToRefs"},maximum:{type:"number",optional:!0,description:"This indicates the maximum value for the instance property when the type of the instance value is a number.",pre:"addToRefs"},maximumCanEqual:{type:"boolean",optional:!0,description:"If the maximum is defined, this indicates whether or not the instance property value can equal the maximum.","default":!0,pre:"addToRefs"},maxDecimal:{type:"integer",optional:!0,description:"This indicates the maximum number of decimal places in a floating point number.",pre:"addToRefs"},pattern:{type:["string","object"],format:"regex",description:"When the instance value is a string, this provides a regular expression that a instance string value should match in order to be valid.",optional:!0,pre:["addToRefs",function(a,b){return a instanceof RegExp?a:typeof a=="string"?new RegExp(a):a}]},maxLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates maximum length of the string.",pre:"addToRefs"},minLength:{type:"number",optional:!0,description:"When the instance value is a string, this indicates minimum length of the string.",pre:"addToRefs"},format:{type:"string",optional:!0,description:"This indicates what format the data is among some predefined formats which may include:\n\ndate - a string following the ISO format \naddress \nschema - a schema definition object \nperson \npage \nhtml - a string representing HTML",pre:"addToRefs"}},pre:["instantiateSchema","addToRefs"]};(jsonSchemaCore=new a(c)).setFallbacks(b.STRICT_FALLBACKS);for(var d in jsonSchemaCore.properties)(jsonSchemaCore.properties[d]=new a(jsonSchemaCore.properties[d])).setFallbacks(b.STRICT_FALLBACKS);(jsonSchemaCore.properties.type.items=new a(jsonSchemaCore.properties.type.items)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.type.items["enum"]=jsonSchemaCore.properties.type["enum"],jsonSchemaCore.properties.id.pattern=new RegExp(jsonSchemaCore.properties.id.pattern),(jsonSchemaCore.properties.options.items=new a(jsonSchemaCore.properties.options.items)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.requires.additionalProperties=jsonSchemaCore,(jsonSchemaCore.properties.pre.items=new a(jsonSchemaCore.properties.pre.items)).setFallbacks(b.STRICT_FALLBACKS),(jsonSchemaCore.properties.post.items=new a(jsonSchemaCore.properties.post.items)).setFallbacks(b.STRICT_FALLBACKS),(jsonSchemaCore.properties.fallbacks.additionalProperties=new a(jsonSchemaCore.properties.fallbacks.additionalProperties)).setFallbacks(b.STRICT_FALLBACKS),jsonSchemaCore.properties.properties.additionalProperties=jsonSchemaCore,jsonSchemaCore.properties.items.properties=jsonSchemaCore.properties,jsonSchemaCore.properties.items.items=jsonSchemaCore,jsonSchemaCore.properties.additionalProperties.properties=jsonSchemaCore.properties,this.schemaSchema=jsonSchemaCore}}),define("tau/utils/utils.jsonSchema",["Underscore","jQuery","libs/schema.js/lib/environment","libs/schema.js/lib/utils","libs/schema.js/lib/objecttools","libs/schema.js/lib/schema","libs/schema.js/i18n/default","libs/schema.js/lib/draft-02/validation","libs/schema.js/lib/draft-02/setupSchemaSchema"],function(_,$,a,b,c,d,e,f){var g=a("prod",{fallbacks:"STRICT_FALLBACKS"});return g.PATTERN_DATE=/^([0-1]{0,1}[0-9]{1})\/([0-3]{0,1}[0-9]{1})\/([0-9]{4})$/,g.PATTERN_URL=/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/,g.Validation.registerPlugins({trim:function(a){return $.trim(a)}}),g.Validation.prototype.optional=function(a){return this.schema.optional||a!==undefined&&a!==null&&a!==""?a:this.callPlugin(this.schema.fallbacks.optional,a,"optional")},g}),define("tau/ui/behaviour/overlay/ui.behaviour.overlay",["Underscore","jQuery"],function(_,$){$.widget("ui.tauOverlay",{options:{showOnCreation:!0},_create:function(){this.$target=this.element,this.options.showOnCreation&&this.show()},showLarge:function(){this._show("ui-spinner-centered")},show:function(){this._show("ui-overlay")},_show:function(a){var b=this;b.$overlay=b.overlay||$(['<div class="',a,'"></div>'].join("")),b.$overlay.detach(),b.$target.addClass("ui-overlay-container");var c=$("body");b.$target.css("position")==="relative"?c=b.$target:c=b.$target.offsetParent(),c.append(b.$overlay)},hide:function(){var a=this;a.destroy()},destroy:function(){var a=this;a.$target.removeClass("ui-overlay-container"),a.$overlay&&a.$overlay.remove(),$.Widget.prototype.destroy.apply(this,arguments)}})}),define("tau/ui/extensions/customField/ui.extension.customField.editable",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(a){var b=a.extend({"bus afterRender":function(a){this.element=a.data.element},"bus preRefreshRow":function(a){this.element.tauOverlay(),this.fire("markElementToBeUpdated",{element:this.element})},"bus refreshRow":function(a){if(!this.element.hasClass("updating"))return;this.element.parents(".tmpl-container-list:first").tauOverlay("hide");var b=this;this.on("afterRender",function(a){a.removeListener(),b.fire("updateElement",{element:b.element})}),this.fire("refresh")}});return b}),define("tau/ui/templates/customField/ui.template.customField.date",["tau/core/templates-factory"],function(a){var b={name:"customField-date",markup:['<div class="ui-customfield {{if !output}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'<td class="ui-customfield__label">${name}</td>','<td class="ui_custom_field_value_container">','<div class="ui-customfield__value">${output}</div>',"</td>","   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/components/extensions/customField/extension.customField.url.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");this.$widget=f,e.find(".ui-customfield__label").behaviourCustomFieldRow({}),e.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/templates/customField/ui.template.customField.dropdown",["tau/core/templates-factory"],function(a){var b={name:"customField-dropdown",markup:['<div class="ui-customfield ui-customfield-dropdown {{if !value}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container">','<div class="ui-customfield__value">',"${value}","</div>","</td>","   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/models/customField/model.customField.dropdown.editable",["Underscore","tau/models/model.customField.editable"],function(_,a){var b=a.extend({"bus beforeInit":function(a){this.store=a.data.config.store;if(this.config.data){var b=this.config.data.value,c=[];_.map(this.config.data.options,function(a){b!==a&&c.push({id:a,name:a})});var d=b?!this.config.data.required:!1;this.fire("dataBind",{states:c,nullableValue:d})}},"bus updateState":function(a){var b=null;a.data&&a.data.id&&(b=a.data.id);var c={customFields:[{name:this.config.data.name,type:this.config.data.type,value:b}]};this.fire("save",c)}});return b}),define("tau/utils/utils.textsearch",["Underscore","tau/core/class"],function(_,a){var b=a.extend({data:[],load:function(a){var b=this;_.forEach(a,function(a){a.normalizeData=b._normalize(a.data)}),this.data=a},_createRegex:function(a){var b=_.trim(a);b=b.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),b=b.replace(/[ ]+/g,"([-[\\]{}()*+?.,\\\\^$|#:;! ]+|\\s+|\\s+[ \\S]*?\\s+)");var c=new RegExp(b,"i");return c},_normalize:function(a){return _.trim(a)},search:function(a){var b=[],c=this._createRegex(a);return _.forEach(this.data,function(a){var d=a.normalizeData,e=d.match(c);if(e){var f={_id:a._id,data:a.data,entry:{from:e.index,len:e[0].length}};b.push(f)}}),b},match:function(a,b){var c=null,d=this._normalize(a).match(this._createRegex(b));return d&&(c={from:d.index,len:d[0].length}),c}});return b}),define("tau/ui/templates/state/ui.template.state.option",["tau/core/templates-factory"],function(a){var b={name:"state-option",markup:["{{if items}}",'<div class="drop-down-group i-group"><span class="i-group-name">${name}</span>','{{tmpl(items) "state-option"}}',"</div>","{{else}}",'<div role="option" class="drop-down-option" {{if description}}title="${description}"{{/if}}>${name}</div>',"{{/if}}"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/state/ui.template.state-list.dropdown",["tau/core/templates-factory","tau/ui/templates/state/ui.template.state.option"],function(a){var b={name:"state-list-dropdown",markup:['<div class="ui-drop-down">',"{{if states.length}}",'<div class="drop-down-list">','<div class="drop-down-list__inner i-inner">','{{tmpl(states) "state-option"}}',"</div>","</div>","{{else}}",'<div class="drop-down-list">','<div role="placeholder-empty">No items found</div>',"</div>","{{/if}}","</div>"],dependencies:["state-option"]};return a.register(b)}),define("tau/ui/templates/common/ui.template.entityLink.full",["tau/core/templates-factory"],function(a){var b={name:"entity-link-full",markup:['<a href="#${__type.toLowerCase()}/${id}" class="tau-linkentity tau-linkentity_type_full">','<em class="ui-type-icon ui-type-icon-${__type.toLowerCase()} tau-linkentity__icon">${id}</em>','<span class="tau-linkentity__inner">',"{{if text}}","${text}","{{else}}","${name}","{{/if}}","</span>","</a>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/customField/ui.template.customField.entity",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.full"],function(a){var b={name:"customField-entity",markup:['<div class="ui-customfield">',"<table>","<tbody>",'<tr class="{{if !value.id }}ui-customfield_empty_true{{/if}}">','<td class="ui-customfield__label">${name}</td>','<td class="ui_custom_field_value_container">',"{{if value.id }}",'<span class="ui-customfield__value">{{tmpl(value) "entity-link-full"}}</span>',"{{else}}",'<span class="entity-custom-field-link property-text ui-customfield__value">${value.name}</span>',"{{/if}}","</td>","</tr>","</tbody>","</table>","</div>"],dependencies:["entity-link-full"]};return a.register(b)}),define("tau/models/customField/model.customField.entity.editable",["Underscore","tau/models/model.customField.editable"],function(_,a){return a.extend({"bus entitySelected":function(a){var b={},c={name:this.config.data.name,type:"Entity",value:null};b.customFields=[c];var d=a.data.entity;d&&d.id&&(c.value={id:d.id,kind:d.__type,name:d.name}),this.fire("save",{$set:b})}})}),define("tau/components/extensions/customField/extension.customField.multiselect.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");this.$widget=f,e.find(".ui-customfield__label").behaviourCustomFieldRow({}),e.addClass("ui-customfield_editable_true")}}})}),define("tau/ui/templates/customField/ui.template.customField.multiselect",["tau/core/templates-factory"],function(a){var b={name:"customField-multiselect",markup:['<div class="ui-customfield ui-customfield-multiselect {{if !output}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${output}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/models/customField/model.customField.multiselect.editable",["Underscore","tau/models/model.customField.editable"],function(_,a){var b=a.extend({onInit:function(){if(this.config.data){var a=this.config.data.value,b=[];_.map(this.config.data.options,function(c){b.push({id:c,name:c,selected:_.include(a,c)})});var c=a?!this.config.data.required&&b.length:!1;this.fire("dataBind",{states:b,nullableValue:c})}},"bus updateState":function(a){var b=null;a.data&&a.data.id&&(b=a.data.id);var c={customFields:[{name:this.config.data.name,type:this.config.data.type,value:_.toArray(b).join(",")}]};this.fire("save",c)}});return b}),define("tau/ui/templates/state/ui.template.state.option.multiselect",["tau/core/templates-factory"],function(a){var b={name:"state-option-multiselect",markup:["{{if items}}",'<div class="drop-down-group i-group">','<span class="i-group-name">${name}</span>','{{tmpl(items) "state-option"}}',"</div>","{{else}}",'<div role="option" class="drop-down-option tau-option{{if selected}} tau-option_selected_true{{/if}}" {{if description}}title="${description}"{{/if}}>',"${name}","</div>","{{/if}}"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/state/ui.template.state-list.multiselect",["tau/core/templates-factory","tau/ui/templates/state/ui.template.state.option.multiselect"],function(a){var b={name:"state-list-multiselect",markup:['<div class="ui-drop-down">',"{{if states.length}}",'<div class="drop-down-list drop-down-list_type_multiselect">','<div class="drop-down-list__inner i-inner">','{{tmpl(states) "state-option-multiselect"}}',"</div>","</div>",'<div class="ui-drop-down__actions ui-form__row ui-form__row-controls button-group">','<input type="button" role="action-save" class="button" value="Save" />','<input type="button" role="action-cancel" class="button" value="Cancel" />',"</div>","{{else}}",'<div class="drop-down-list drop-down-list_type_multiselect">','<div role="placeholder-empty">No items found</div>',"</div>","{{/if}}","</div>"],dependencies:["state-option-multiselect"]};return a.register(b)}),define("tau/models/customField/model.customField.number.editable",["Underscore","tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(_,a,b){var c=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"number",optional:!1,minimum:0,maximum:_.MAX_INT,pre:["trim","castTolerantlyToType"],"default":0,fallbacks:{type:"setDefault"}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.empty,b.validation=this.schema.validate(c)}});return c}),define("libs/jquery/jquery.textEditor",["jQuery"],function(a){return function($,a){if(a in $)throw new Error('jQuery already has the "'+a+'" property.');var b=function(b,c){for(var d in c)b.bind(d+"."+a,c[d])},c=function(a,b){this.initElement(a),this.setOptions(b),this.bindEvents(b)};c.prototype={constructor:c,initElement:function(a){this.$element=a.addClass("editableText")},setOptions:function(a){var b=a||{};this.onSave=$.isFunction(b.onSave)?b.onSave:$.noop,this.onEditStart=$.isFunction(b.onEditStart)?b.onEditStart:$.noop,this.onEditEnd=$.isFunction(b.onEditEnd)?b.onEditEnd:$.noop,this.maxLength=b.maxLength||255,this.mask=b.mask?new RegExp(b.mask):!1,this.restoreText=typeof b.restoreText=="undefined"?!0:b.restoreText},bindEvents:function(a){a=a||{};var c=this;a.resetOnBlur&&(c.onBlur=function(){this._cancelEdit()}),b(c.$element,{blur:$.proxy(c,"onBlur"),keydown:$.proxy(c,"mapKeys"),keypress:$.proxy(c,"mapKeys"),click:$.proxy(c,"onFocus")}),$.browser.msie||$(window).blur(function(){c.$element.blur()})},onFocus:function(a){a&&a.stopPropagation(),this.isActive()||(this.activate(),this.onEditStart(),this.storeInitialText())},_performSave:function(a){if(!a&&!this.isActive())return;this.deactivate(),this.saveText(),this.onEditEnd()},_cancelEdit:function(){if(!this.isActive())return;this.deactivate(),this.restoreInitialText(),this.onEditEnd()},onBlur:function(){this._performSave()},onEnter:function(a){a.preventDefault(),this._performSave(!0),this.$element.blur()},onEscape:function(a){a.preventDefault(),this._cancelEdit(),this.$element.blur()},onKeyDefault:function(a){if(a.charCode!=0){var b=String.fromCharCode(a.charCode||a.keyCode),c=this.$element.text()+b;this.mask.test(c)||a.preventDefault()}},activate:function(){this.$element.prop("contentEditable",!0).addClass("active").focus()},deactivate:function(){this.$element.removeClass("active").removeProp("contentEditable")},isActive:function(){return this.$element.hasClass("active")},setInitialText:function(a){this.initialText=a},getInitialText:function(){return this.initialText},storeInitialText:function(){this.setInitialText(this.$element.text())},restoreInitialText:function(){this.$element.text(this.getInitialText())},trimText:function(a){return _.trim(a)},normalizeText:function(a){var b=this.trimText(a);return b.length==0&&this.restoreText===!0&&(b=this.getInitialText()),b},saveText:function(){var a=this.normalizeText(this.$element.text());this.$element.text(a),a!=this.getInitialText()&&this.onSave(a)},mapKeys:function(a){switch(a.which){case 13:this.onEnter(a);break;case 27:this.onEscape(a);break;default:a.type=="keypress"&&this.mask&&this.onKeyDefault(a)}}},$.fn[a]=function(b){return this.each(function(d,e){var f=$(e);f.data(a,new c(f,b))})},$[a]=function(b,c){return $(b)[a](c)}}(a,"textEditor"),a.fn.textEditor}),define("tau/ui/behaviour/common/ui.behaviour.editableText",["Underscore","jQuery","libs/jquery/jquery.textEditor"],function(_,$){$.widget("ui.editableText",{_create:function(){this.element.textEditor(this.options)},activate:function(){this.element.data("textEditor").isActive()?this.element.data("textEditor").onBlur():this.element.data("textEditor").onFocus()},setValidationErrors:function(a){this.element.addClass("ui-validationerror"),_.isString(a)&&this.element.attr("title",a)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title",a)},setValue:function(a){this.element.text(a)},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.number.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a){return a.extend({category:"edit",$widget:null,fieldData:null,"bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f,f.editableText({mask:"^[0-9]*$",restoreText:!1,onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,type:c.type,value:a}]})}}),e.behaviourCustomFieldRow({onActivate:function(){f.editableText("activate"),f.focus()}}),e.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.editableText("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/templates/customField/ui.template.customField.text",["tau/core/templates-factory"],function(a){var b={name:"customField-text",markup:['<div class="ui-customfield  {{if !value}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container"><div class="ui-customfield__value">${value}</div></td>',"   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/ui/templates/customField/ui.template.customField.richtext",["tau/core/templates-factory"],function(a){var b={name:"customField-richtext",markup:['<div class="ui-customfield ui-customfield-richtext">','   <div class="ui-customfield__value value">{{html value}}</div>',"</div>"]};return a.register(b)}),define("tau/models/customField/model.customField.text.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"string",optional:!0,maxLength:50,minLength:0,pre:["trim"]}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,b.validation=this.schema.validate(c)}});return c}),define("tau/components/extensions/customField/extension.customField.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f,f.editableText({restoreText:!1,onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,type:c.type,value:a}]})}}),e.behaviourCustomFieldRow({onActivate:function(){f.editableText("activate"),f.focus()}}),e.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.editableText("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/models/customField/model.customField.url.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"object",optional:!1,properties:{label:{type:"string",optional:!1,maxLength:30,pre:["trim"]},url:{type:"string",optional:!1,pattern:b.PATTERN_URL,pre:["trim",function(a){return a.length==0&&this.schema.optional&&(this._wasError=1),a}]}},post:function(a){if(a.label==0||a.url==0)a={label:null,url:null};return a}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0],d=this.config.customField||this.config.data;this.schema.properties.value.properties.label.optional=!d.required,this.schema.properties.value.properties.label.empty=!d.required,this.schema.properties.value.properties.url.optional=!d.required,this.schema.properties.value.properties.url.empty=!d.required,b.validation=this.schema.validate(c),delete b.validation.instance.value.__id}});return c}),define("tau/models/customField/model.customField.url.editable.editor",["tau/models/customField/model.customField.url.editable"],function(a,b){var c=a.extend({onInit:function(){this.beforeSaveHandler=!0,this.afterSaveHandler=!0,this.config.data&&this.fire("dataBind",this.config.data)}});return c}),define("tau/ui/behaviour/customField/ui.behaviour.customField.url.editor",["Underscore","jQuery"],function(_,$){$.widget("ui.behaviourUrlEditor",{options:{onSave:$.noop},_create:function(){var a=this.element;this.$element=a;var b=this;a.find(":button:first").click(function(a){a.preventDefault(),_.bind(b._save,b)()}),a.find(":input").keyup(function(a){a.keyCode==jQuery.ui.keyCode.ENTER&&(a.preventDefault(),_.bind(b._save,b)())})},_save:function(){var a=this.element;this.options.onSave({url:a.find("[name=url]").val(),label:a.find("[name=label]").val()})},setValidationErrors:function(a){var b=this.$element;_.each(a,function(a,c){b.find("[name="+c+"]").addClass("ui-validationerror").attr("title",a)})},resetValidationErrors:function(a){this.$element.find(":text").removeClass("ui-validationerror").attr("title",null)},setValue:function(a){var b=this.$element;_.each(a,function(a,c){b.find("[name="+c+"]").val(a)})},destroy:function(){}})}),define("tau/components/extensions/customField/extension.customField.url.editor",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/customField/ui.behaviour.customField.url.editor"],function(_,$,a){return a.extend({category:"edit","bus dataBind+afterRender":function(a){var b=this,c=a.dataBind.data,d=a.afterRender.data.element;this.$widget=d,d.find("[name=url]").val(c.value.url),d.find("[name=label]").val(c.value.label),d.behaviourUrlEditor({onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,type:"URL",value:a}]})}}),d.find(":button:eq(1)").click(function(){b.bus.fire("reset")})},"bus validate":function(){this.$widget.behaviourUrlEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.behaviourUrlEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){var b={};_.each(a.data.validation.errors,function(a){_.each(["url","label"],function(c){_.indexOf(a.path,c)!==-1&&(b[c]=a.description)})}),this.$widget.behaviourUrlEditor("setValidationErrors",b)}})}),define("tau/ui/templates/customField/ui.template.customField.url.editor",["tau/core/templates-factory"],function(a){var b={name:"customField-url-editor",markup:['<div class="ui-form">','   <div class="ui-form__row"><label for="url">Url</label><input type="text" name="url" /></div>','   <div class="ui-form__row"><label for="label">Description</label><input type="text" name="label" /></div>','   <div class="ui-form__row ui-form__row-controls button-group"><input type="button" value="save" class="button" /><input type="button" value="cancel" class="button" /></div>',"</div>"]};return a.register(b)}),define("tau/models/customField/model.customField.url.editable.row",["tau/models/customField/model.customField.url.editable"],function(a,b){var c=a.extend({onInit:function(){var a=this,b=this.config.context,c=b.entity.entityType.name},"bus afterSaveToStore":function(){this.bus.fire("refreshRow",{})}});return c}),define("tau/ui/templates/customField/ui.template.customField.url",["tau/core/templates-factory"],function(a){var b={name:"customField-url",markup:['<div class="ui-customfield ui-customfield-url {{if !value.url}}ui-customfield_empty_true{{/if}}">',"   <table>","   <tbody>","   <tr>",'       <td class="ui-customfield__label">${name}</td>','       <td class="ui_custom_field_value_container">','           <span class="ui-customfield__value popup-target">${value.label}</span>',"           {{if value.label}}",'               <a class="ui-customfield__value-url external-view south url" href="${value.url}" title="${value.url}" target="_blank"></a>',"           {{/if}}","       </td>","   </tr>","   </tbody>","   </table>","</div>"]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details",["tau/core/templates-factory"],function(a){var b={name:"diagnostics.globalListeners.details",markup:['<span class="tau-global-listener ui-link">${name}</span><br/>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners.details"],function(a){var b={name:"diagnostics.globalListeners",markup:['<div class="tau-diagnostics-globalListeners">',,"<table>",'{{each data}}<tr class="tau-diagnostics-row"><td>${count}</td><td>${name}</td><td>{{tmpl(listeners) "diagnostics.globalListeners.details"}}</td></tr>{{/each}}',"</table>","</div>"],dependencies:["diagnostics.globalListeners.details"]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics",["tau/core/templates-factory"],function(a){var b={name:"diagnostics",markup:['<div class="tau-diagnostics-box">',,'<span class="ui-diag-label">Buses</span><span class="ui-diag-quantity">${countOfBuses}</span>','<span class="ui-diag-label">GB</span><span class="ui-diag-quantity">${globalBusListeners}</span>','<span class="ui-diag-label">Store</span><span class="ui-diag-quantity">${storeListeners}</span>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details",["tau/core/templates-factory"],function(a){var b={name:"diagnostics.storeListeners.details",markup:['<span class="tau-store-listener ui-link">${name}</span><br/>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/diagnostics/ui.template.diagnostics.store",["tau/core/templates-factory","tau/ui/templates/diagnostics/ui.template.diagnostics.storeListeners.details"],function(a){var b={name:"diagnostics.storeListeners",markup:['<div class="tau-diagnostics-storeListeners">',,"<table>",'{{each data}}<tr class="tau-diagnostics-row"><td>${items.length}</td><td>${name}</td><td>{{tmpl(items) "diagnostics.storeListeners.details"}}</td></tr>{{/each}}',"</table>","</div>"],dependencies:["diagnostics.storeListeners.details"]};return a.register(b)}),define("tau/models/model.duplicateBugList",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({_retrieveEntity:function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d={id:c,fields:["id"]};this.store.get(b,d,{scope:this,success:this.onEntityRetrieved}).done()},convertServerDataModelData:function(a){return{__type:a.__type,id:a.id,name:a.name,state:{name:a.entityState.name}}},onEntityRetrieved:function(a){this.fire("registerStoreRequest"),this.fire("commitTransaction")},"bus duplicateBugRetrieved":function(a){var b=a.data.items,c=_.map(b,this.convertServerDataModelData,this);c=_.compact(c);var d={items:c};this.bus.fire("dataBind",d)},onInit:function(){if(this.config.disableModel)return;this._retrieveEntity()}});return b}),define("tau/models/model.duplicateBugRetriever",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({init:function(){this._super.apply(this,arguments)},convertServerDataModelData:function(a){return{__type:a.__type,id:a.id,name:a.name,state:{name:a.entityState.name}}},"bus registerStoreRequest":function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d={fields:["id","name",{entityState:["name"]}],$query:{tags:{$contains:"duplicateOf#"+c}}};this.fire("find",{type:b,query:d,callback:{scope:this,success:this.onDuplicateBugsRetrieved}})},onDuplicateBugsRetrieved:function(a){var b=_.sortBy(a.data,function(a){return a.id}),c={items:b};this.fire("duplicateBugRetrieved",c)}});return b}),define("tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController",["jQuery","tau/components/extensions/component.extension.base"],function(jQuery,a){return a.extend({"bus afterRender":function(a){a.data.element.hide()},"bus componentsCreated+duplicateBugCountRetrieved":function(a){var b=a.duplicateBugCountRetrieved.data.count,c=a.componentsCreated.data,d=c[0].component;d.fire("sendEventToComponents",{name:"setBadgeText",data:{text:b}})},"bus componentsCreated+duplicateBugRetrieved":function(a){var b=a.duplicateBugRetrieved.data.items,c=a.componentsCreated.data,d=c[1].component;if(d.name=="duplicateBugListPanel inner")return;d.fire("duplicateBugRetrieved",{items:b})},"bus afterRender+duplicateBugCountRetrieved":function(a){if(a.duplicateBugCountRetrieved.data.count>0){var b=a.afterRender.data.element;this.config.disableAnimation?b.show():b.slideDown("slow")}}})}),define("tau/models/model.duplicateBugCountCalculator",["tau/models/model.duplicateBugList"],function(a){var b=a.extend({"bus duplicateBugRetrieved":function(a){var b=a.data.items;this.fire("duplicateBugCountRetrieved",{count:b.length})}});return b}),define("tau/models/model.extensions",["Underscore"],function(_){var a=function(a,b){var c=this,d=c.config.context,e=d.entity.entityType.name,f=[];for(var g=0;g<a.length;g++)f.push(a[g]);var h={id:d.entity.id,fields:a},i={innerCallback:function(a){var c=a.data,d=0;for(var e=0;e<f.length;e++)d+=c[f[e]];b.callback.call(b.scope,{count:d})}};c.store.get(e,h,{success:i.innerCallback,scope:i}).done()};return{calculateTagsCount:function(b){a.call(this,["tags-count"],b)},calculateBugsAndTasksCount:function(b){var c=[];this.config.context.isPracticeAvailable("Planning")&&c.push("tasks-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&c.push("bugs-count"),a.call(this,c,b)},calculateTasksCount:function(b){a.call(this,["tasks-count"],b)},calculateBugsCount:function(b){a.call(this,["bugs-count"],b)},calculateUserStoriesAndBugsCount:function(b){var c=[];c.push("userStories-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&c.push("bugs-count"),a.call(this,c,b)},calculateIterationsCount:function(b){a.call(this,["iterations-count"],b)},calculateReleasesCount:function(b){a.call(this,["releases-count"],b)},calculateFeaturesCount:function(b){a.call(this,["features-count"],b)},calculateRequestsCount:function(b){a.call(this,["requests-count"],b)},calculateImpedimentsCount:function(b){a.call(this,["impediments-count"],b)},calculateTimesCount:function(b){a.call(this,["times-count"],b)},calculateAttachmentsCount:function(b){a.call(this,["attachments-count"],b)},calculateCommentsCount:function(b){a.call(this,["comments-count"],b)},calculateTesCasesCount:function(b){a.call(this,["testCases-count"],b)},calculateTestPlanRunsCount:function(b){a.call(this,["testPlanRuns-count"],b)},calculateUserStoriesCount:function(b){a.call(this,["userStories-count"],b)},calculateTestCaseRunsCount:function(b){a.call(this,["testCaseRuns-count"],b)},calculateRelatedEntitiesCount:function(b){a.call(this,["relatedEntities-count"],b)},calculateRequestersCount:function(b){a.call(this,["requesters-count"],b)}}}),define("tau/ui/extensions/ui.extensions.onMarkAsDuplicate",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus beforeInit":function(a){this.config=a.data.config,this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},onBugWasMarkedAsDuplicate:function(a){var b=this.config?this.config.context.entity.id:null;if(b==a.data.duplicateBugId||b==a.data.bugId)this.fire("evict"),this.fire("refresh")}})}),function(){var a=function(a){return Object.prototype.toString.call(a)==="[object Object]"},b=function(a){return Object.prototype.toString.call(a)==="[object Array]"},c=function(c){if(b(c)||typeof c=="string")return c.length===0;if(a(c))for(var d in c)if(c.hasOwnProperty(d))return!1;return!0},d=function(a,b){for(var c in b)b.hasOwnProperty(c)&&!a.hasOwnProperty(c)&&(a[c]=b[c]);return a},e=function(d,e,f){var g=function(d,e){if(b(d)&&!c(d))for(var f=0,g=d.length;f<g;f++)e.apply(d,[f,d[f]]);if(a(d)&&!c(d))for(var h in d)d.hasOwnProperty(h)&&e.apply(d,[h,d[h]])},h=function(d,e,f){var g=[],h=function(a,b){var c=g.length+1;g.push(function(){var d=function(a){var b=g[c];return!a&&b?b():!a&&!b?f():f(a)};return e(a,b,d)})};if(b(d)&&!c(d))for(var i=0,j=d.length;i<j;i++)h(i,d[i]);else{if(!a(d)||!!c(d))return f();for(var k in d)d.hasOwnProperty(k)&&h(k,d[k])}return g[0]()};return typeof f=="undefined"?g.apply(this,arguments):h.apply(this,arguments)},f=function(a,b){var c=[];for(var d=0,e=a.length;d<e;d++){var f=a[d][b];c.indexOf(f)===-1&&c.push(f)}return c},g=function(){this.length=0};g.prototype.addError=function(a){this[this.length]=a,this.length++},e({getProperties:"property",getMessages:"message"},function(a,b){g.prototype[a]=function(){return f(this,b)}});var h={required:"The ‘{{property}}’ property is required.",minLength:"The ‘{{property}}’ property must be at least {{validator}} characters.",maxLength:"The ‘{{property}}’ property must not exceed {{validator}} characters.",length:"The ‘{{property}}’ property must be exactly {{validator}} characters.",format:"The ‘{{property}}’ property must be a/an {{validator}}.",type:"The ‘{{property}}’ property must be a/an {{validator}}.",except:"The ‘{{property}}’ property must not be {{propertyValue}}",minimum:"The minimum value of the ‘{{property}}’ must be {{validator}}",maximum:"The maximum value of the ‘{{property}}’ must be {{validator}}",pattern:"The `{{property}}` does not match the ‘{{validator}}’ pattern.",maxItems:"The `{{property}}` property must not contain more than {{validator}} items.",minItems:"The `{{property}}` property must contain at least {{validator}} items.",divisibleBy:"The ‘{{property}}’ property is not divisible by {{validator}}.",uniqueItems:"All items in the ‘{{property}}’ property must be unique.","enum":function(a,b,c){return"Value of the ‘"+a+"’ must be "+c.join(" or ")+"."}},i=function(a){var b=this;this.singleError=a.hasOwnProperty("singleError")?a.singleError:!0,this.validators=j,this.messages=a.messages?d(a.messages,h):h,this.Errors=new g};i.prototype.renderErrorMessage=function(a,b){var c=this.messages[a];return typeof c=="function"?c(b.property,b.propertyValue,b.validator):typeof c=="string"?(e(b,function(a,b){c=c.replace(new RegExp("{{"+a+"}}","g"),b)}),c.replace(/\s+/g," ")):""},i.prototype.validateProperty=function(a,b,c,d){var f=this,g=function(d,e,g){var h=function(e){if(!e)return g();var h=f.renderErrorMessage(d,{property:a,propertyValue:b,validator:c[d]});return f.Errors.addError({property:a,propertyValue:b,validator:d,validatorValue:c[d],message:h}),g(f.singleError?!0:null)};return c[d]?e(a,b,c[d],c,h):g()};return c.required!==!0&&typeof b=="undefined"?d():e(f.validators,g,d)},i.prototype.validate=function(a,b,c){var d=this;return this.Errors=new g,this.validateSchema(a,b,"",function(a){return c(d.Errors.length>0?d.Errors:undefined)})},i.prototype.validateProperties=function(a,b,c,d){var f=this;return e(b.properties,function(d,e,g){var h=e.type==="object"&&e.properties,i=e.type==="array",j=f.getProperty(a,d),k=d.indexOf(" ")!==-1?"['"+d+"']":"."+d,l=c.length===0?d:c+k;return h||i?f.validateSchema(j,b.properties[d],l,g):f.validateProperty(l,j,e,g)},d)},i.prototype.validateItems=function(a,b,d,f){var g=this;return a&&!c(a)?["object","array"].indexOf(b.items.type)!==-1?e(a,function(a,c,e){var f=d+"["+a+"]";return g.validateSchema(c,b.items,f,e)},f):e(a,function(a,c,e){var f=d+"["+a+"]";return g.validateProperty(f,c,b.items,e)},f):f()},i.prototype.validateSchema=function(a,b,c,d){var e=this;return["object","array"].indexOf(b.type)!==-1?e.validateProperty(c,a,b,function(f){return b.properties?e.validateProperties(a,b,c,d):b.items?e.validateItems(a,b,c,d):d()}):e.validateProperty(c,a,b,d)},i.prototype.getProperty=function(a,b){return a?a[b]:undefined};var j={required:function(a,b,c,d,e){return c&&b===undefined?e(!0):e()},type:function(){var a={object:function(a){return Object.prototype.toString.call(a)==="[object Object]"},array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},integer:function(a){return typeof a=="number"&&a%1===0}},b=["string","number","function","boolean"];for(var c=0,d=b.length;c<d;c++)a[b[c]]=function(a){return function(){return typeof arguments[0]===a}}(b[c]);return function(b,c,d,e,f){if(Object.prototype.toString.call(d)==="[object Array]"){var g=d.some(function(b){return a[b](c)});return g?f():f(!0)}return a[d](c)?f():f(!0)}}(),format:function(){var a={alpha:function(a){return typeof a=="string"&&a.match(/^[a-zA-Z]+$/)},alphanumeric:function(a){return typeof a=="string"&&/^[a-zA-Z0-9]+$/.test(a)||typeof a=="number"},ipv4:function(a){return typeof a=="string"&&a.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)},ipv6:function(a){return typeof a=="string"&&a.match(/(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:(?:[a-f\d]{1,4}:)*[a-f\d]{1,4})?::(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?)/)},ip:function(b){return a.ipv4(b)||a.ipv6},email:function(a){return typeof a=="string"&&a.match(/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/)},url:function(a){return typeof a=="string"&&a.match(/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|cat|coop|int|pro|tel|xxx|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2})?)|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/)},date:function(a){return Object.prototype.toString.call(a)==="[object Date]"},decimal:function(a){return/^[0-9]+(\.[0-9]{1,2})?$/.test(a)},"int":function(a){return/^-?[0-9]+$/.test(a)},percentage:function(a){return typeof a=="string"&&a.match(/^-?[0-9]{0,2}(\.[0-9]{1,2})?$|^-?(100)(\.[0]{1,2})?$/)||a>=-100&&a<=100},port:function(a){return/\:\d+/.test(a)},regexp:function(a){return a&&a.test&&a.exec},unsignedInt:function(a){return/^[0-9]+$/.test(a)}};return function(b,c,d,e,f){return a[d](c)?f():f(!0)}}(),minLength:function(a,b,c,d,e){return typeof b=="string"&&b.length>=c?e():e(!0)},maxLength:function(a,b,c,d,e){return typeof b=="string"&&b.length<=c?e():e(!0)},length:function(a,b,c,d,e){return typeof b=="string"&&b.length===c?e():e(!0)},"enum":function(a,b,c,d,e){return c.indexOf(b)===-1?e(!0):e()},except:function(a,b,c,d,e){return c.indexOf(b)!==-1?e(!0):e()},minimum:function(a,b,c,d,e){if(typeof b=="number"){var f=d.exclusiveMinimum?b>c:b>=c;return f?e():e(!0)}return e(!0)},maximum:function(a,b,c,d,e){if(typeof b=="number"){var f=d.exclusiveMaximum?b<c:b<=c;return f?e():e(!0)}return e(!0)},pattern:function(a,b,c,d,e){return typeof b=="string"&&!b.match(c)?e(!0):e()},minItems:function(a,c,d,e,f){return b(c)&&c.length>=d?f():f(!0)},maxItems:function(a,c,d,e,f){return b(c)&&c.length<=d?f():f(!0)},uniqueItems:function(a,b,c,d,f){return e(b,function(a,c,d){return b.indexOf(c)<a?d(!0):d()},f)},divisibleBy:function(a,b,c,d,e){var f=typeof b=="number",g=b%c===0;return f&&g?e():e(!0)}},k={validate:function(a,b,c,d){return typeof c=="function"&&(d=c,c={}),(new i(c)).validate(a,b,d)},addValidator:function(a,b){j[a]=b},getVersion:function(){return[0,3,0].join(".")},getValidators:function(){return j}};typeof module!="undefined"&&module.exports?module.exports=k:typeof define!="undefined"?define("libs/amanda/amanda",[],function(){return i}):this.amanda=k}(),define("tau/models/model.requester",["Underscore","tau/core/model-base","libs/amanda/amanda"],function(_,a,b){var c=a.extend({"bus afterInit":function(){this.fire("dataBind",{}),this.validation=new b({singleError:!1});var a=this.config.store,c=function(b,c,d,e,f){if(!d||!c)return f();a.find("requester",{$query:{email:c,deleteDate:null}}).done({success:function(a){a[0].data.length==1?f("uniqueEmail"):f()}})};this.validation.validators.uniqueEmail=c,_.extend(this.validation.messages,{required:function(a,b,c){var d={firstName:"First Name",lastName:"Last Name",email:"email"};return"Please enter "+d[a]},uniqueEmail:"Requester with the same email already exists",format:"Please enter valid {{validator}}"})},"bus form.parametersBound":function(a){var b=a.data,c=this.config.store,d={type:"object",properties:{firstName:{required:!0,type:"string"},lastName:{required:!0,type:"string"},email:{required:!0,type:"string",format:"email",uniqueEmail:!0}}},e=this;this.validation.validate(b.parameters,d,function(a){a?e.fire("form.validationFailed",{errors:a}):e.fire("form.validationPassed",{data:b.parameters})})},"bus form.validationPassed":function(a){var b=a.data.data,c=this.config.store,d=this,e=this.config.context.entity;c.save("Requester",{$set:{email:b.email,login:b.email,firstName:b.firstName,lastName:b.lastName},fields:["id"]}).done({success:function(a){var b=a[0].data;c.save(e.entityType.name,{id:e.id,$set:{requesters:[{id:b.id}]},fields:["id"]}).done({success:function(a){}})}})}});return c}),define("tau/ui/extensions/editor.requester/ui.extension.editor.requester.form",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element;this.$element=b;var c=b.find("[role=form]"),d=c.find(":input"),e=c.find(":button");e.eq(0).prop("disabled","disabled"),e.eq(0).addClass("disable");var f=this;e.eq(0).click(function(){var a={};d.each(function(){var b=$(this),c=_.trim(b.val());c!=""&&(a[b.attr("name")]=c)}),a.action="search",f.bus.fire("form.parametersBound",{parameters:a})}),d.bind("keyup",function(){d.filter(function(){return $(this).val().length>0}).length==d.length?(e.eq(0).prop("disabled",!1),e.eq(0).removeClass("disable")):(e.eq(0).prop("disabled","disabled"),e.eq(0).addClass("disable"))})},"bus form.validationFailed":function(a){this.$element.find(".ui-validationerror").removeClass("ui-validationerror");var b=_.uniq(a.data.errors,!1,function(a){return a.property}),c=this.$element.find(":input");_.forEach(b,function(a){c.filter("[name="+a.property+"]").toggleClass("ui-validationerror",!0).attr("title",a.message)})},"bus form.validationPassed":function(){this.$element.find(".ui-validationerror").removeClass("ui-validationerror")}})}),define("tau/ui/templates/editor.requester/ui.template.editor.requester",["tau/core/templates-factory"],function(a){var b={name:"editor-requester",markup:["<div>",'<div class="ui-form" role="form">','<div class="ui-form__row">','<label for="url">First Name</label><input type="text" data-autofocus class="user-search-box" name="firstName" />',"</div>",'<div class="ui-form__row">','<label for="label">Last Name</label><input type="text" class="user-search-box" name="lastName" />',"</div>",'<div class="ui-form__row">','<label for="label">Email</label><input type="text" class="user-search-box" name="email" />',"</div>",'<div class="ui-form__row ui-form__row-controls button-group">','<input type="button" name="action" value="Add requester" class="button" />','<input type="button" name="cancel" value="Cancel" role="action-cancel" class="button" />',"</div>","</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/extensions/bubble/extensions.bubble.creator",["tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function(a,b){return a.extend({category:"edit",initBubble:function(a){var c=this;c.destroyContainer();var d=a.target;d.addClass("tau-bubble-target");var e=a.alignTo;if(!e||!e.length)e=d;e.addClass&&e.addClass("ui-link");var f=function(){c.initializeContainer(a.target,this.$popup,a.componentsConfig)};this.target=d,b.call(d,{alignTo:e,onShow:f})},destroy:function(){this.destroyContainer(),this._super()},destroyContainer:function(){this.container&&(this.container.destroy(),delete this.container)},"bus initBubble":function(a){this.initBubble(a.data)},"bus toggleBubble":function(){b.call(this.target,"toggle")},initializeContainer:function(a,b,c){var d=this,e=b.find(".tau-bubble__inner");d.$popupInner=e,d.$target=a;if(a.data("bubbleLoaded")===!0)return;e.find("div.ui-loading-message").remove(),e.append("<div class='ui-loading-message'>Loading...</div>"),d.createComponents(c,function(b){var c=d.container=b[0].component;c.on("afterRender",function(b){e.find(".ui-loading-message").remove();var d=b.data.element;d.appendTo(e),a.data("bubbleLoaded",!0),b.removeListener(),a.tauBubble("adjustPosition"),a.tauBubble("adjustPositionStart"),a.tauBubble("adjustPosition"),a.bind("close",function(){c.fire("blur",{})}),a.bind("externalClose",function(){c.fire("blur",{})}),a.bind("show.before",function(){c.fire("focus.before",{})}),a.bind("show",function(){c.fire("focus",{}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition")}),c.fire("popupResize",a.tauBubble("getMaxSize")),a.tauBubble("adjustPosition"),setTimeout(function(){a.tauBubble("adjustPosition")},10),setTimeout(function(){c.fire("focus",{})},500)}),c.initialize();var f=function(){a.data("bubbleLoaded",!1),a.tauBubble("empty")},g=function(){a.tauBubble("destroy"),d.destroyContainer()};c.on("beforeSave",f),c.on("beforeRemove",f),c.on("reset",g),c.on("afterSave",g),c.on("afterRemove",g)})}})}),define("tau/components/extensions/comments/extensions.comments.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var a=this.config.context.entity;this.config.store.evictProperties(a.id,a.entityType.name,["comments"]),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;(b===a.data.bugId||b===a.data.duplicateBugId)&&this.refresh()}})}),define("tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){this.element=a.data.element;var b=this.action||function(){};b.call(this),this.action=function(){}},getWidget:function(){return this.element.parents(".ui-placeholder:first")},showOverlay:function(){this.getWidget().tauOverlay()},hideOverlay:function(){this.getWidget().tauOverlay("hide")},"bus markElementToBeUpdated":function(a){this.showOverlay()},"bus updateElement":function(a){this.action=function(){this.hideOverlay()}},"bus markElementToBeDeleted":function(a){this.showOverlay()},"bus afterAssignmentRemoved":function(a){this.hideOverlay()},"bus beforeSaveAssignment":function(a){this.showOverlay()},"bus beforeAddAssignment":function(a){this.showOverlay()}})}),define("tau/components/extensions/progressBar/extensions.progressBar.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b==a.data.duplicateBugId&&a.data.stateId!=-1&&(this.fire("evictState"),this.fire("refresh"))}})}),define("tau/components/extensions/extension.labelRefresher.base",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({eventName:null,propertyListForEvict:[],init:function(){var a=this;a._super.apply(a,arguments),_.isArray(a.eventName)||(a.eventName=[a.eventName]);var b=a.bus.getGlobalBus();_(a.eventName).each(function(c){b.on(c,a.eventHandler,a)}),b.on("bugWasMarkedAsDuplicate",a.onBugWasMarkedAsDuplicate,a)},destroy:function(){var a=this,b=a.bus.getGlobalBus();_(a.eventName).each(function(c){b.removeListener(c,a.eventHandler,a)}),b.removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refresh:function(){var a=this.config.context.entity;this.config.store.evictProperties(a.id,a.entityType.name,this.propertyListForEvict),this.fire("refresh")},onBugWasMarkedAsDuplicate:function(a){var b=this.config?this.config.context.entity.id:null;b===a.data.bugId&&this.refresh()},eventHandler:function(a){this.isEntityInContext(a)&&this.refresh()}})}),define("tau/components/extensions/requestsList/extensions.requestList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(a){return a.extend({eventName:["requestWasAttachedToEntity","requestIsDetachedFromEntity"],propertyListForEvict:["requests-count"]})}),define("tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher",["tau/components/extensions/extension.labelRefresher.base"],function(a){return a.extend({eventName:"testCaseWasAdded",propertyListForEvict:["testCases-count"]})}),define("tau/models/dataprocessor/model.processor.assignments",["Underscore"],function(_){var a={getAssignmentsForRole:function(a,b){var c=_(b.assignments).select(function(b){return b.role.id==a.id});return c},getAssignments:function(a){var b={groups:[]},c=a.roleEfforts;for(var d=0;d<c.length;d++){var e=c[d].role,f={role:{id:e.id,name:e.name.substring(0,3)},users:[]},g=this.getAssignmentsForRole(e,a);for(var h=0;h<g.length;h++){var i=g[h].generalUser;f.users.push({id:i.id,name:[i.firstName," ",i.lastName.substring(0,1),"."].join(""),assignmentId:g[h].id})}b.groups.push(f)}return b}};return a}),define("tau/models/dataprocessor/model.processor.importance",["Underscore","tau/core/class"],function(_,a){var b=a.extend({init:function(a,b){this.min=a,this.max=b},getKind:function(a){var b="medium";return a==this.min?b="high":a==this.max&&(b="low"),b}});return b}),define("tau/models/dataProviders/model.provider.groups.base",["Underscore","tau/core/class"],function(_,a){return a.extend({init:function(a){this.config=a},_mergeGroups:function(a){var b=null;return a.length&&(b={key:[],items:[],title:[],isInitial:!1,isPlanned:!1,isFinal:!1,realGroups:[]},_.forEach(a,function(a){b.key.push(a.key),b.title.push(a.title?a.title:a.key),b.isInitial=!!a.isInitial,b.isPlanned=!!a.isPlanned,b.isFinal=!!a.isFinal,b.realGroups=b.realGroups.concat(a.realGroups)})),b},_fetchState:function(a,b,c){var d=this,e=_(b).isFunction()?b:function(a){var c=d.config.context.getProcess(),e=a.entityType.name.toLowerCase();return a.process.id===c.id&&_.indexOf(b,e)>-1},f=this.config.store,g=["id","name","isFinal","isInitial","isPlanned","isCommentRequired","numericPriority",{entityType:["id","name"]},{process:["id"]},{nextStates:["id"]}],h={list:!0,fields:g};f=f.get("entityStates",h),f.done({success:function(a){var b=a[0].data;b=_(b).filter(e);var f=_.groupBy(b,function(a){return a.name});f=this._sortByState(f),_.forEach(f,function(a){a.collapsed=!!a.items[0].isFinal,a.isFinal=!!a.items[0].isFinal,a.isInitial=!!a.items[0].isInitial,a.isPlanned=!!a.items[0].isPlanned,a.realGroups=_.clone(a.items),a.items=[],delete a.stateWeight});var g=_.select(f,function(a){return a.isInitial}),h=_.select(f,function(a){return!a.isInitial&&a.isPlanned}),i=_.select(f,function(a){return!a.isInitial&&!a.isFinal&&!a.isPlanned}),j=_.select(f,function(a){return!a.isInitial&&a.isFinal&&!a.isPlanned});f=[];var k=null;g.length&&(k=d._mergeGroups(g),f.push(k)),h.length&&(k=d._mergeGroups(h),f.push(k)),f=f.concat(i),j.length&&(k=d._mergeGroups(j),f.push(k)),_.forEach(f,function(a){a.collapsed=!!a.isFinal,a.title&&_.isArray(a.title)&&(a.title=a.title.join(", ")),_.isArray(a.key)&&a.key.length==1&&(a.key=a.key.pop()),delete a.isFinal,delete a.isInitial,delete a.isPlanned}),c(f)},scope:this})},_sortByState:function(a){return _.forEach(a,function(a){var b=[];_.forEach(a.items,function(a){b.push(a.numericPriority)});var c=_.reduce(b,function(a,b){return a+b},0),d=c?c/b.length:0;a.stateWeight=d}),a=_.sortBy(a,function(a){return a.stateWeight}),a},moveToGroup:function(a,b,c,d){},_moveToGroupByState:function(a,b,c,d){var e=this.config.store,f=_.find(c.realGroups,function(b){return b.id==a.entityState.id}),g=_.find(b.realGroups,function(b){return b.entityType.name.toLowerCase()==a.__type.toLowerCase()&&b.process.id==f.process.id});if(!g||g.id==f.id){d.call(null);return}var h=[];h.push(function(b){e.save(a.__type,{id:a.id,$set:{entityState:{id:g.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){b(null,arguments)}})}),h.push(function(b){e.get(a.__type,{id:a.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(a){b(null,a[0].data)}})}),_.series(h,function(a,b){_.isFunction(d)&&d.call(null,{changed:b[1]})})},isAvailableForItem:function(a,b){return!0},getCommentRequirements:function(a,b){return[]}})}),define("tau/models/dataProviders/model.provider.groups.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(_,a){return a.extend({fetch:function(a,b,c){var d={tasks:[],bugs:[]},e=[],f=[],g=_(b).select(function(a){return a.__type==="task"}),h=_(b).select(function(a){return a.__type==="bug"});d.tasks=_(g).chain().pluck("projectId").uniq().value(),this.config.context.isPracticeAvailable("Bug Tracking")&&(d.bugs=_(h).chain().pluck("projectId").uniq().value());var i=this.config.store,j=this;i.get("projects",{fields:[{process:["id"]}],list:!0}).done({success:function(b){var e=b[0].data,f={tasks:[],bugs:[]};_.forEach(d,function(a,b){f[b]=_(e).chain().select(function(b){return _(a).include(b.id)}).map(function(a){return a.process.id}).uniq().value()});var g=function(a){var b=(a.entityType.name||"").toLowerCase(),c=a.process.id;return b==="task"&&_(f.tasks).include(c)||b==="bug"&&_(f.bugs).include(c)};return j._fetchState(a,g,c)}})},moveToGroup:function(a,b,c,d){return this._moveToGroupByState(a,b,c,d)},isAvailableForItem:function(a,b,c){var d=_.find(c.realGroups,function(b){return b.id==a.entityState.id}),e=_.find(b.realGroups,function(b){return b.entityType.name.toLowerCase()==a.__type.toLowerCase()&&b.process.id==d.process.id}),f=_.pluck(d.nextStates,"id");return f.push(d.id),e&&_.include(f,e.id)},getCommentRequirements:function(a,b,c){var d=_.find(c.realGroups,function(b){return b.id==a.entityState.id}),e=[];return _.forEach(b,function(b){var c=_.find(b.realGroups,function(b){return b.entityType.name.toLowerCase()==a.__type.toLowerCase()&&b.process.id==d.process.id});e.push({isCommentRequired:c?c.isCommentRequired:!1})}),e}})}),define("tau/ui/extensions/list/extension.list.refresher",["tau/components/extensions/component.extension.base"],function(a,b){return a.extend({"bus afterInit":function(){if(this.signedUp)return;this.signedUp=!0;var a=this.config.context.entity,b=a.entityType.name,c=this.config.store,d=this;this._refresher||(this._refresher=function(){c.evictProperties(a.id,b,["tasks","bugs"]),d.fire("refresh")},c.unbind(this),c.on({eventName:"afterSave",type:"userStory",listener:this,filter:{id:a.id},hasChanges:["entityState"]},this._refresher))},"bus destroy":function(){this.config.store.unbind(this),delete this._refresher,this._super.apply(this,arguments)}})}),define("tau/ui/tags/ui.tag.term",["Underscore","jQuery","tau/core/termProcessor"],function(_,$,a){return $.extend($.tmpl.tag,{term:{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while($__t.parent && !$__t.$tau){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")}}),{register:function(b,c){var d=b.context?b.context.getTerms():[];c.$tau=c.$tau||{};var e=new a(d);c.$tau.terms=function(a){return e.getTerms(a)}}}}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.progress",["tau/core/templates-factory"],function(a){var b=["{{if !$item.parent.parent.data.config.currentView.timeTrackingPolicies.disableSpentRemain}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}  ","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}  ","{{/if}}","Percent complete: ${percentComplete}%"].join(""),c={name:"cell-progress",markup:['<div{{if percentFromMaximum == 0}} class="tau-extension-tooltip" title="'+b+'"{{/if}}>',"{{if percentFromMaximum > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${percentFromMaximum}%;" title="'+b+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentComplete}%;{{if percentComplete == 0}}display:none;{{/if}}"></span>',"    </div>","{{/if}}","</div>"]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.assignments",["tau/core/templates-factory"],function(a){var b={name:"cell-assignments",markup:['<span class="ui-assignment__group">','   <span class="ui-assignment__group__title">${role.name}</span><span class="tau-assignment__group__dot">.</span>',"   {{if users.length}}",'   <span class="ui-assignment__group__users">',"   {{each users}}",'       <span class="ui-assignment__user">','           <img style="width:24px; height:24px;" src="${avatarUrl}" alt="${name}" title="${name}" />',"       </span>","   {{/each}}","   </span>","   {{else}}",'   <span class="ui-assignment__group__unassigned">Unassigned</span>',"   {{/if}}","</span>"]};return a.register(b)}),define("tau/ui/templates/title/ui.template.title.simple",["tau/core/templates-factory"],function(a){var b={name:"ui.template.title.simple",markup:['<div class="ui-title-simple">','   <div class="entity-title">${entity.name}</div>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.cell.name",["tau/core/templates-factory","tau/ui/templates/title/ui.template.title.simple"],function(a){var b={name:"cell-name",markup:['<span class="tau-title-container">','<div class="tau-title tau-list-field-slot" title="${name}" runas="title" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.title.simple">${name}</div>',"</span>","{{if tags && tags.length}}",'   <span class="tau-tags">${tags[0]}</span>','   {{if tags.length > 1}}<span class="tau-tags">&#133;</span>{{/if}}',"{{/if}}"]};return a.register(b)}),define("tau/ui/tags/ui.tag.abbr",["Underscore","jQuery"],function(_,$){return{register:function(a,b){b.$tau=b.$tau||{},b.$tau.abbr=function(a,b){var c=a||"",d=c.substr(0,b);return $.trim(d)}}}}),define("tau/ui/templates/common/ui.template.userIcon",["tau/core/templates-factory"],function(a){return a.register({name:"ui.template.userIcon",markup:['<span class="ui-assignment__user user" userId="${id}">','   <img src="${avatar}" style="width:24px; height:24px;" alt="${name}" title="${name}" class="user-name" />',"</span>"].join(""),dependencies:[]})}),define("tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini",["tau/core/templates-factory","tau/ui/tags/ui.tag.abbr","tau/ui/templates/common/ui.template.userIcon","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a,b){var c={name:"ui.template.assignmentsList.userList.mini",tags:[b],markup:['<div class="ui-assignment__group group" roleId="${role.id}">','   <span class="ui-assignment__group__title">',"       <span>${$item.parent.$tau.abbr(role.name, 3)}</span>","   </span>","   {{if users.length}}",'   <span class="ui-assignment__group__users">','   {{tmpl(users) "ui.template.userIcon"}}',"   {{/if}}","   </span>","   {{if allowAdd}}",'   <span class="ui-assignment__group__unassigned">{{tmpl "assignments-add-btn"}}</span>',"   {{/if}}","</div>"].join(""),dependencies:["assignments-add-btn","ui.template.userIcon"]};return a.register(c)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.mini",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignmentsList.userList.mini"],function(a){var b={name:"ui.template.assignments.mini",markup:['<div class="assignments-table-readonly">','<div class="user-list">{{tmpl(assignments.groups) "ui.template.assignmentsList.userList.mini"}}</div>',"</div>"].join(""),dependencies:["ui.template.assignmentsList.userList.mini"]};return a.register(b)}),define("tau/ui/templates/property.effort/ui.template.property.effort.content",["tau/core/templates-factory"],function(a){var b="Estimated effort: ${effort}{{if effort}}${unit.shortName}{{/if}}",c={name:"ui.template.property.effort.content",markup:[' <div class="tau-extension-tooltip" title="'+b+'">','   <div class="entity-effort">${effort}<span class="entity-effort-info">${unit.shortName}</span></div>',"</div>"],dependencies:[]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"list-grid-entity__row",markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"   <tbody>",'       <tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a href="#${__type}/${id}"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>","{{if $item.parent.data.config.currentView.multiprojects}}","   {{if project}}",'   <td class="tau-list__table__cell tau-list__table__cell-project">${project.abbreviation}</td>',"   {{else}}",'   <td class="tau-list__table__cell  tau-list__table__cell-project">&nbsp;</td>',"   {{/if}}","{{/if}}","{{if visibleEntityState}}",'   <td class="tau-list__table__cell tau-list__table__cell-state">','       <div runas="property.entityState" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${visibleEntityState.name}</div>',"   </td>","{{/if}}","{{if severity}}",'   <td class="tau-list__table__cell tau-list__table__cell-severity">','       <span runas="property.severity" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" class="tau-list-severity-${severity.kind}">${severity.name}</span>',"   </td>","{{else priority}}",'   <td class="tau-list__table__cell tau-list__table__cell-priority">','       <span class="tau-list-priority-${priority.kind}" runas="property.priority" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${priority.name}</span>',"   </td>","{{/if}}","{{if effort}}",'   <td class="tau-list__table__cell tau-list__table__cell-effort">','      <div class="tau-list-field-slot" runas="property.effort" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-entities-count="${entitiesCount}">','        {{tmpl({effort: effort.estimated, unit: effort.unit}) "ui.template.property.effort.content"}}',"      </div>","   </td>",'   <td class="tau-list__table__cell tau-list__table__cell-progress" >','       <div runas="progressBar.small" data-items-count="${effort.percentFromCount}" data-max-width-percents="${effort.percentFromMaximum}" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">','           {{tmpl(effort) "cell-progress"}}',"       </div>","   </td>","{{/if}}","{{if assignments}}",'<td class="tau-list__table__cell tau-list__table__cell-assignments" >','   <div class="tau-list-field-slot" runas="assignmentsList" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.assignments.mini">{{tmpl(assignments.groups) "cell-assignments"}}</div>',"</td>","{{/if}}","{{if velocity}}",'   <td class="tau-list__table__cell tau-list__table__cell-velocity" >',"       ${velocity.value}&nbsp;${velocity.unit.shortName} ","   </td>","{{/if}}","{{if assignedEffort}}",'   <td class="tau-list__table__cell tau-list__table__cell-assignedEffort" >','   <div class="tau-extension-tooltip" title="Assigned Effort: ${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}">',"       <div>${assignedEffort.value}&nbsp;${assignedEffort.unit.shortName}</div>","   </div>","   </td>","{{/if}}","{{if startDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date" >',"       ${startDate}","   </td>","{{/if}}","{{if endDate}}",'   <td class="tau-list__table__cell tau-list__table__cell-date" >',"       ${endDate}","   </td>","{{/if}}",'   <td class="tau-list__table__cell tau-list__table__cell-actions" >','       <div class="tau-list-field-slot" runas="entity.actions" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}"></div>',"   </td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a,b){var c={name:"list-grid-entity__rowtestplanrun",tags:[b],markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="#${__type}/${id}" title="${name}"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-stat">','<div class="tau-testCasesRunResults">','<div class="tau-testCasesRunResults-container">','<span title="Passed" class="tau-testCasesRunResults-item tau-testCasesRunResults-passed">${passedCount}</span>','<span title="Failed" class="tau-testCasesRunResults-item tau-testCasesRunResults-failed">${failedCount}</span>','<span title="Not Run" class="tau-testCasesRunResults-item tau-testCasesRunResults-notRun">${notRunCount}</span>',"</div>","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-release">','<div runas="property.release" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false" data-placeholder-text="assign to {{term("release") "name"}}">',"{{if release}}","${release.name}","{{/if}}","</div>","</td>","{{if isAvailableIteration}}",'<td class="tau-list__table__cell tau-list__table__cell-iteration">','<div runas="property.iteration" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false"  data-placeholder-text="assign to {{term("iteration") "name"}}">',"{{if iteration}}","${iteration.name}","{{/if}}","</div>","</td>","{{/if}}",'<td class="tau-list__table__cell tau-list__table__cell-build">','<div runas="property.build.testPlanRun" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-show-url="false"  data-placeholder-text="assign to {{term("build") "name"}}">',"{{if build}}","${build.name}","{{/if}}","</div>","</td>","{{if assignments}}",'<td class="tau-list__table__cell tau-list__table__cell-assignments" >','   <div runas="assignmentsList" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}" data-template:name="ui.template.assignments.mini">{{tmpl(assignments.groups) "cell-assignments"}}</div>',"</td>","{{/if}}",'<td class="tau-list__table__cell tau-list__table__cell-additionalactions" >','<div runas="menu.testPlanRun" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}"></div>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-actions" >','<div runas="entity.actions" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}"></div>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"list-grid-entity__rowtestcaserun",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${testcase.id} tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="#testcase/${testcase.id}" title="${testcase.name}"><em class="ui-type-icon ui-type-icon-testcase">${testcase.id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','{{tmpl($item.data.testcase) "cell-name"}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-priority">','<span class="tau-list-priority-${testcase.priority.kind}" runas="property.priority" data-context:general:id="${testcase.id}" data-context:general:entity-type:name="${testcase.__type}">',"${testcase.priority.name}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">',"<div>",'<div class="ui-status {{if passed === true}}ui-status_type_passed green{{/if}}{{if passed === false}}ui-status_type_failed red{{/if}}{{if passed === null}}ui-status_type_na grey{{/if}}">',"{{if runDate !== null}}","{{if passed === true}}","Passed","{{/if}}","{{if passed === false}}","Failed","{{/if}}","{{if passed === null}}","Skipped","{{/if}}","{{/if}}","</div>","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-actions" >','<div runas="entity.actions" data-context:general:id="${testcase.id}" data-context:general:entity-type:name="testcase"></div>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun"],function(a){var b={name:"list-grid-entity__group",markup:['<div class="tau-list__group {{if collapsed}} tau-list__group_collapsed_true{{/if}}" role="group">','   <div class="tau-list__group__header tau-list__group__collapse" role="expander">',"       {{if realGroup}}","           {{if realGroup.__type && realGroup.id}}",'           <a class="tau-list__group__id" href="#${realGroup.__type}/${realGroup.id}"><em class="ui-type-icon ui-type-icon-${realGroup.__type}">${realGroup.id}</em></a>',"           {{/if}}","       {{/if}}",'       <span class="tau-list__group__title" role="title">${title}</span>','       {{if subtitle}}<span class="tau-list__group__subtitle" >${subtitle}</span>{{/if}}','       <span class="tau-list__group__counter{{if items.length == 0}} tau-list__group__counter__empty{{/if}}" role="counter">${items.length}</span>',"   </div>",'${$item.data.config=$item.parent.data.config,""}','   <ul class="tau-list__list" role="list">',"      {{tmpl(items) $item.parent.data.config.currentView.rowTemplateName }}","   </ul>","</div>"],dependencies:["list-grid-entity__row","list-grid-entity__rowtestplanrun"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a,b){var c={tags:[b],name:"list-grid-entity__rowtestcase",markup:["",'<li class="tau-list__list__item" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-expander tau-list__itemexpander tau-list__itemexpander_state_closed"  role="item-expander" ><div class="tau-list__itemexpander__indicator "></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a class="tau-entitylink" href="#${__type}/${id}" title="${name}"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-lastrundate">','<div runas="property.lastRunDate.list" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${lastRunDate}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">','<div runas="property.lastStatus" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${lastStatus}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-testcaseactions">','<div class="button-group">','<button class="button success" role="action-pass">Pass</button>','<button class="button danger" role="action-fail">Fail</button>',"</div>","</td>","</tr>","</tbody>","</table>",'<table class="tau-list__table tau-list__table-additional tau-list__table-additional_state_closed">',"<tbody>","<tr>",'<td class="tau-list__table__cell tau-list__table__cell-dragdrop"></td>','<td class="tau-list__table__cell tau-list__table__cell-expander-additional"></td>','<td class="tau-list__table__cell tau-list__table__cell-steps">','<div class="tau-steps">','<h4 class="tau-steps__header">Steps</h4>','<div class="tau-steps__content">','<div runas="steps" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${steps}","</div>","</div>","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-success">','<div class="tau-success">','<h4 class="tau-success__header">Success</h4>','<div class="tau-success__content">','<div runas="success" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"${success}","</div>","</div>","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(c)}),define("tau/ui/templates/list_/ui.template.list.comment",["tau/core/templates-factory"],function(a){var b={name:"list-grid__comment",markup:['<div class="ui-entity-state-comment" role="comment-form" style="display:none;">','<div class="ui-state-comment-header">Please, provide comment</div>','<div class="ui-state-comment-field-container">','<textarea rows="5" class="ui-state-comment-field"></textarea>',"</div>",'<div class="button-group">','<button type="button" class="save button">Save</button>','<button type="button" class="save button">Cancel</button>',"</div>","</div>"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase","tau/ui/templates/list_/ui.template.list.comment"],function(a,b){var c={tags:[b],name:"list-grid-entity-testcase",markup:['<div class="tau-list tau-list-testcases">',"   {{if isEmpty === true}}",'<table class="tau-list__table tau-list__table-header">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-header">','<button type="button" role="action-add" class="tau-add-testCase tau-button-addtestcase">${labelAdd} {{term("TestCase") "name"}}</button>',"</td>","</tr>","</tbody>","</table>",'      <div class="tau-list__empty-message">${config.currentView.emptyMessage}</div>',"   {{else}}",'     <div class="tau-list__content">',"       {{if groups && groups.length}}",'          {{tmpl(groups) "list-grid-entity__group"}}',"       {{/if}}","       {{if items && items.length}}",'           <div class="tau-list__group tau-list__group_flat_true"  role="group">','<table class="tau-list__table tau-list__table-header">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"></td>','<td class="tau-list__table__cell tau-list__table__cell-expander tau-list__table__cell-header-expander" >','<div class="tau-list__itemexpander tau-list__itemexpander_state_closed"  role="item-expander-all">','<div class="tau-list__itemexpander__indicator "></div>',"</div>",'<div class="tau-list__itemexpander tau-list__itemexpander_state_open"  role="item-collapser-all">','<div class="tau-list__itemexpander__indicator "></div>',"</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-header">','<button type="button" role="action-add" class="tau-add-testCase tau-button-addtestcase">${labelAdd} {{term("TestCase") "name"}}</button>',"</td>","</tr>","</tbody>","</table>",'               <ul class="tau-list__list"  role="list">',"                   {{tmpl(items) $item.data.config.currentView.rowTemplateName }}","               </ul>","           </div>","       {{/if}}","     </div>","   {{/if}}",'   <div class="tau-list__comment-holder">','          {{tmpl({}) "list-grid__comment"}}',"   </div>","</div>"],dependencies:["list-grid-entity__group","list-grid-entity__row","list-grid-entity__rowtestplanrun","list-grid-entity__rowtestcaserun","list-grid-entity__rowtestcase","list-grid__comment"]};return a.register(c)}),define("tau/ui/extensions/list/request/extension.list.entityState",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterInit+dataBind+afterRender":function(a){var b=a.afterInit.data.config.store,c=a.dataBind.data.items,d=a.afterRender.data.element,e=_.pluck(c,"id");b.on({eventName:"afterSave",type:"general",listener:this,hasChanges:["entityState"]},function(a){var c=a.data.id;if(_.indexOf(e,c)==-1)return;b.get(a.data.cmd.type,{id:c,fields:["id",{entityState:["id","isFinal"]}]}).done({success:function(a){var b=a[0].data.entityState.isFinal;d.find(".i-item-"+c).toggleClass("tau-list__table__row_isfinalstate_true",b)}})})}})}),define("tau/ui/extensions/list/external.refresh.extension",["tau/components/extensions/component.extension.base","tau/core/global.bus"],function(a,b){return a.extend({"bus afterInit":function(){var a=this;if(a.signedUp)return;a.signedUp=!0;var c=function(){a.bus.fire("refresh")};_.each(a.config.externalRefreshEvents,function(d){b.get().on(d,c,a)})},"bus destroy":function(){b.get().removeAllListeners(this)}})}),define("tau/components/extensions/requestsList/extension.requestList.refresher",["tau/components/extensions/component.extension.base"],function(a){return a.extend({init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on("requestWasAttachedToEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().on("requestIsDetachedFromEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this)},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().removeListener("requestIsDetachedFromEntity",this.onRequestsUpdates,this),this.bus.getGlobalBus().removeListener("bugWasMarkedAsDuplicate",this.onBugWasMarkedAsDuplicate,this),this._super.apply(this,arguments)},refreshComponentIfEntityFromCurrentContext:function(a){this.isEntityInContext(a)&&this.refresh()},onRequestsUpdates:function(a){this.refreshComponentIfEntityFromCurrentContext(a)},onBugWasMarkedAsDuplicate:function(a){var b=this.config.context.entity.id;b===a.data.bugId&&this.refresh()},refresh:function(){this.fire("evictProperty"),this.fire("refresh")}})}),define("tau/ui/extensions/list/request/extension.related_entities.action.detach",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=this.config.store,d=this.config.context.entity,e=this.bus;b.delegate("[role=action-detach]","click",function(a){var b=$(a.target).parents("[role=item]:first"),f=b.data("tmplItem").data;c.removeFromList(f.__type,{id:f.id,$set:{relatedRequests:{id:d.id}}}).done({success:function(){c.save("request",{id:d.id,$set:{relatedEntities:[]}}).done(),c.evictProperties(d.id,d.entityType.name,["relatedEntities","relatedEntities-count"]),e.fire("refresh")}})})}})}),define("tau/ui/extensions/list/testplan/extension.list.editableCells",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender+component.ready":function(a){var b=a.afterRender.data.element;b.find(".tau-list__table__cell:has(.tau-property_editable_true)").addClass("tau-list__table__cell_editable_true"),b.delegate(".tau-list__table__cell:has(.tau-property_editable_true)","click",function(a){$(a.currentTarget).hasClass("tau-property__value")==0&&(a.stopPropagation(),$(this).find(".tau-property__value").click())})}})}),define("tau/ui/extensions/list/request/extension.requesters.tabs",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus afterRender":function(a){var b=this.$el=a.data.element;setTimeout(function(){b.find(":input[data-autofocus]:visible").focus()},10)},"bus tabs.switched":function(){var a=this;setTimeout(function(){a.$el.find(":input[data-autofocus]:visible").focus()},10)}})}),define("tau/ui/extensions/list/request/extension.requesters.action.add",["tau/components/extensions/component.extension.base","tau/components/extensions/bubble/extensions.bubble.creator","tau/ui/extensions/list/request/extension.requesters.tabs","tau/components/extensions/component.creator.extension"],function(a,b,c,d){return a.extend({"bus afterInit":function(a){var c=a.data.config.bus,e=new b({bus:c}),f=new d({bus:c}),g=a.data.config.store,h=a.data.config.context.entity;g.unbind(this),g.on({eventName:"afterSave",type:h.entityType.name,listener:this,filter:{id:h.id},hasChanges:["requesters"]},function(){g.evictProperties(h.id,h.entityType.name,["requesters"]),c.fire("refresh")})},"bus afterRender":function(a){var b=a.data.element.find("[role=action-add]"),d={actionOnBlur:"destroy",target:b,alignTo:b,componentsConfig:{components:[{type:"tabs",cssClass:"tau-tabs-small",extensions:[c],tabs:[{label:"select",header:[{type:"label",text:"Select requester"}],items:[{type:"finder.requesters"}],selected:!0},{label:"add",header:[{type:"label",text:"Add new"}],items:[{type:"editor.requester"}]}]}],context:this.config.context}};this.fire("initBubble",d);var e=function(){b.tauBubble("empty"),b.data("bubbleLoaded",!1)};b.bind("externalClose",e),b.bind("close",e),b.on("show",function(){var a=b.tauBubble("widget");a.delegate("[role=action-cancel]","click",e)})}})}),define("tau/ui/extensions/list/request/extension.requesters.action.detach",["tau/components/extensions/component.extension.base","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension"],function(a,b,c){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=this.config.store,d=this.config.context.entity,e=this.bus;b.delegate("[role=action-detach]","click",function(a){var b=$(a.target).parents("[role=item]:first"),f=b.data("tmplItem").data;c.removeFromList("request",{id:d.id,$set:{requesters:{id:f.id}}}).done({success:function(){e.fire("refresh")}})})}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.base",["Underscore","tau/core/class"],function(_,a){return a.extend({fetch:function(a,b,c){},moveToGroup:function(a,b,c,d){},isAvailableForItem:function(a,b){},getCommentRequirements:function(a,b){}})}),define("tau/models/dataProviders/strategies/model.provider.groups.strategy.states",["Underscore","tau/models/dataProviders/strategies/model.provider.groups.strategy.base"],function(_,a){return a.extend({fetch:function(a,b,c){},moveToGroup:function(a,b,c,d,e){var f=_.find(d.realGroups,function(a){return a.id==b.entityState.id}),g=_.find(c.realGroups,function(a){return a.entityType.name.toLowerCase()==b.__type.toLowerCase()&&a.process.id==f.process.id});if(!g||g.id==f.id){e.call(null);return}var h=[];h.push(function(c){a.save(b.__type,{id:b.id,$set:{entityState:{id:g.id}},fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(){c(null,arguments)}})}),h.push(function(c){a.get(b.__type,{id:b.id,fields:["id",{entityState:["id","name","isFinal"]}]}).done({success:function(a){c(null,a[0].data)}})}),_.series(h,function(a,b){_.isFunction(e)&&e.call(null,{changed:b[1]})})},isAvailableForItem:function(a,b,c){var d=_.find(c.realGroups,function(b){return b.id==a.entityState.id}),e=_.find(b.realGroups,function(b){return b.entityType.name.toLowerCase()==a.__type.toLowerCase()&&b.process.id==d.process.id}),f=_.pluck(d.nextStates,"id");return f.push(d.id),e&&_.include(f,e.id)},getCommentRequirements:function(a,b,c){var d=_.find(c.realGroups,function(b){return b.id==a.entityState.id}),e=[];return _.forEach(b,function(b){var c=_.find(b.realGroups,function(b){return b.entityType.name.toLowerCase()==a.__type.toLowerCase()&&b.process.id==d.process.id});e.push({isCommentRequired:c?c.isCommentRequired:!1})}),e}})}),define("tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states"],function(_,a,b){return a.extend({init:function(a){this._super(a),this.strategy=new b},fetch:function(a,b,c){var d=_(b).pluck("projectId"),e=this.config.store,f={fields:[{process:["id"]}],list:!0};e.get("projects",f,{scope:this,success:this.onProjects(d,a,c)}).done()},onProjects:function(a,b,c){return function(d){var e=_(d.data).chain().select(function(b){return _(a).include(b.id)}).map(function(a){return a.process.id}).uniq().value(),f=function(a){var b=(a.entityType.name||"").toLowerCase();return b==="testplanrun"&&_(e).include(a.process.id)};return this._fetchState(b,f,c)}},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/models/dataProviders/model.provider.groups.user_stories",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(_,a){return a.extend({fetch:function(a,b,c){var d=_(b).pluck("projectId"),e=this.config.store,f={fields:[{process:["id"]}],list:!0};e.get("projects",f,{scope:this,success:this.onProjects(d,a,c)}).done()},onProjects:function(a,b,c){return function(d){var e=_(d.data).chain().select(function(b){return _(a).include(b.id)}).map(function(a){return a.process.id}).uniq().value(),f=function(a){var b=(a.entityType.name||"").toLowerCase();return b==="userstory"&&_(e).include(a.process.id)};return this._fetchState(b,f,c)}},fetchForGroup:function(a,b){},moveToGroup:function(a,b,c,d){return this._moveToGroupByState(a,b,c,d)}})}),define("tau/ui/extensions/list/iterations/extension.list.release_iterations",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus preDataBind":function(a){var b=a.data;b.groups.length<=1?b.isEmpty=!0:b.isEmpty=!1}})}),define("tau/ui/extensions/list/extension.list.checkEmpty",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus preDataBind":function(a){var b=a.data;b.groups.length==0?b.isEmpty=!0:b.isEmpty=!1}})}),define("tau/ui/templates/container/ui.template.container.boardPlus",["tau/core/templates-factory"],function(a){var b={name:"container.boardPlus",engine:"jqote2",markup:['<header role="header" class="tau-app-header">',"</header>",'<div class="tau-app-body">','<div role="main" class="tau-app-main-pane">',"</div>",'<aside role="aside" class="tau-app-secondary-pane">',"</aside>","</div>"],dependencies:[]};return a.register(b)}),define("tau/configurations/board.container.config",["Underscore","tau/core/class","tau/ui/templates/container/ui.template.container.boardPlus"],function(_,a,b){var c=a.extend({getDefaultBoardSettings:function(a){return{id:a,name:"anonymous",zoomLevel:3,viewMode:"board",x:{types:["Release"],filter:""},y:{types:["Feature"],filter:""},cells:{types:["UserStory"],filter:""}}},getConfig:function(a){var c=a.viewMode==="list"?".list":"";return{layout:"selectable",template:b,children:[{type:"board.header",selector:"[role=header]"},{type:"board.selector",selector:"[role=aside]"},{type:"board.overview",selector:"[role=aside]"},{type:"board.settings",selector:"[role=main]"},{type:"board.plus"+c,selector:"[role=main]",min:1,max:6,defaultValue:3}]}}});return new c}),define("tau/configurations/converters/converter.context",["Underscore"],function(_){var a=function(a,b){var c=[],d=[];_.forEach(a,function(a){a[0]=="~"?c.push(a.slice(1)):d.push(a)});var e=!0;d.length&&(e=_.intersect(b,d).length>0);var f=!1;return c.length&&(f=_.intersect(b,c).length>0),e&&!f},b=function(c,d,e){return _.forEach(c,function(f,g){if(f.type=="tabs")_.forEach(f.tabs,function(a,c){a.header=b(a.header,d,e),f.tabs[c].items=b(a.items,d,e),f.tabs[c].items.length==0&&(f.tabs[c]=!1)}),f.tabs=_.filter(f.tabs,function(a,b){return a!==!1}),f.additionalHeaders=b(f.additionalHeaders,d,e),f.tabs.length==0&&(c[g]=!1);else if(f.type=="additionalInfo")f.children=b(f.children,d,e),f.children.length==0&&(c[g]=!1);else if(f.type=="label"&&_.isArray(f.text))f.text=b(f.text,d,e),f.text.length==0?c[g]=!1:c[g]=f;else if(f.practices||f.editions){var h=f.practices&&f.practices.length&&!a(f.practices,d),i=f.editions&&f.editions.length&&!a(f.editions,e);if(h||i)c[g]=!1}else if(f.children)c[g].children=b(f.children,d,e);else if(typeof f.items!="undefined")c[g].items=b(f.items,d,e),f.items.length==0&&(c[g]=!1);else if(g=="children"||g=="items")c[g]=b(f,d,e)}),c=_.filter(c,function(a,b){return a!==!1}),c};return{convert:function(a,c,d){return a=b(a,c,d),a}}}),define("tau/ui/templates/menu/ui.template.menu.actions.item",["tau/core/templates-factory"],function(a){var b={name:"menu-actions-item",markup:["           {{if url}}",'               <div class="ui-menu__item ui-menu__item-action ui-menu__item-action-link ${className}">','                  <a class="drop-down-option" href="${url}">${label}</a>',"               </div>","           {{else label}}",'               <div class="ui-menu__item ui-menu__item-action ${className}">','                   <span class="drop-down-option">${label}</span>',"               </div>","           {{else}}",'               <div class="ui-menu__item-separator">-----</div>',"           {{/if}}"]};return a.register(b)}),define("tau/ui/templates/menu/ui.template.menu.actions.list",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.item"],function(a){var b={name:"menu-actions-list",markup:['<div class="ui-menu-actions">','   <div class=" ui-drop-down drop-down-list">','   {{tmpl(items) "menu-actions-item"}}',"   </div>","</div>"],dependencies:["menu-actions-item"]};return a.register(b)}),define("tau/ui/extensions/entity/actions/extension.entity.actions.editable",["tau/components/extensions/component.extension.base","tau/ui/templates/menu/ui.template.menu.actions.list"],function(a,b){return a.extend({category:"edit","bus permissionsReady+dataBind+afterRender":function(a){var c=this,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=a.afterRender.data.element,g=f.find(".tau-entity-actions-target"),h={components:[{type:"menu.actions",template:b,items:e.items}],context:c.config.context},i={target:g,componentsConfig:h};c.fire("initBubble",i)}}})}),define("tau/ui/templates/entity/ui.template.entity.actions",["tau/core/templates-factory"],function(a){var b={name:"ui.template.entity.actions",markup:['<div class="tau-entity-actions">','   <span class="tau-entity-actions-target"></span>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/models/propertyLists/model.propertyList.base",["Underscore","tau/core/model.editable.base"],function(_,a){return a.extend({getAssignable:function(a){var b=this,c=b.config.context.entity,d=c.entityType.name,e=c.id,f={id:e,fields:this.getRequiredFields()};return b.store.get(d,f).done({success:a}),b},sortProjects:function(a){var b=this.config.context.applicationContext,c=_.pluck(b.selectedProjects,"id"),d=a.sort(function(a,b){var d=_.indexOf(c,a.id),e=_.indexOf(c,b.id);return d>=0&&e>=0||d<0&&e<0?a.id-b.id:-1*d+e});return d},getCurrentEntityId:function(){if(!this.config.data)return null;var a=this.config.data.value;return this.config.data.id||a&&a.id},getRequiredFields:function(){return["id"]},onDataRetrieved:function(a){var b=_.pluck(a,"data");this.processData.apply(this,b)},propertyIsNotEmpty:function(){return _.isNumber(this.config.data.id)},"bus updateState":function(a){var b={},c=null;a.data&&a.data.id&&(c={id:a.data.id}),b[this.propertyType]=c,this.fire("save",b)}})}),define("tau/models/propertyLists/model.entityStateList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({name:"states-list",propertyType:"entityState",onInit:function(){var a=this,b=function(b){var c=b[0].data;a.store.get(a.propertyType,a.createGetStateForAssignableCommand(c)).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};this.getAssignable(b)},getRequiredFields:function(){return[{entityState:["id"]}]},createGetStateForAssignableCommand:function(a){return{id:a.entityState.id,fields:["id","name","isCommentRequired",{nextStates:["id","name","isCommentRequired","numericPriority"]}]}},processData:function(a){var b=[];a.nextStates=_.sortBy(a.nextStates,function(a){return a.numericPriority}),_.each(a.nextStates,function(a){b.push({id:a.id,name:a.name,isCommentRequired:a.isCommentRequired})}),this.fire("dataBind",{states:b,completed:!0,nullableValue:!1})}})}),define("tau/ui/templates/state/ui.template.state-list",["tau/core/templates-factory","tau/ui/templates/state/ui.template.state.option"],function(a){var b={name:"state-list",markup:['<div class="ui-drop-down">','<div class="drop-down-list">','<div class="drop-down-list__inner i-inner">','{{tmpl(states) "state-option"}}',"</div>","</div>","</div>"],dependencies:["state-option"]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user","tau/ui/templates/assignmentsList/ui.template.assignmentsList.addBtn"],function(a){var b={name:"feature-assignments-user-list",markup:['<div class="group" roleId="${role.id}">','<table class="role-header">',"   <tr>",'   <td class="role-title">','   {{tmpl "assignments-add-btn"}}',"&nbsp;${role.name}","   </td>","</tr>","</table>",'{{tmpl(users) "user"}}',"</div>"].join(""),dependencies:["user","assignments-add-btn"]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList.userList","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"feature-assignments-list",markup:['<table class="box assignments-table-readonly assignments-table">','   <tr class="title-row">','      <td class="user-list">','      {{tmpl(assignments.groups, {effortPoints: effortPoints}) "feature-assignments-user-list"}}',"      </td>","   </tr>","</table>"].join(""),dependencies:["feature-assignments-user-list","user"]};return a.register(b)}),define("tau/models/model.feature.totalEffort",["tau/core/model-base","tau/core/termProcessor"],function(a,b){var c=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;a.store.unbind(a),a.store.on({eventName:"afterSave",type:c,filter:{id:d},hasChanges:["userStories|effort"],listener:a},_.bind(a.onDataUpdated,a)),a.store.get(c,{id:d,fields:["id","userStories-count","effort"]},{scope:this,success:this.onGetEntity}).done({scope:this,success:this.onRequestCompleted})},onDataUpdated:function(){this.fire("refresh")},floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onGetEntity:function(a){var c=a.data,d=this.config.context.getTerms(),e=new b(d),f=c["userStories-count"];f>0?(this.userStoriesCount=f,this.featureTerm=e.getTerms("feature").name,this.userStoriesTerm=e.getTerms("userStory").names,this.effort=this.floatToString(c.effort),this.point=this._getEffortPoints(),this.hidden=!1):(this.label="",this.hidden=!0)},onRequestCompleted:function(){this.fire("dataBind",{userStoriesCount:this.userStoriesCount,featureTerm:this.featureTerm,userStoriesTerm:this.userStoriesTerm,effort:this.effort,point:this.point,hidden:this.hidden})}});return c}),define("tau/ui/templates/feature/ui.template.totalEffort",["tau/core/templates-factory"],function(a){var b={name:"total-effort",markup:['<div style="',"{{if hidden}}","display:none","{{/if}}",'">',"{{if !hidden }}",'<div class="ui-total-effort">${featureTerm} has <span class="user-story-count">${userStoriesCount}</span> ${userStoriesTerm} with total effort <span class="effort">${effort}</span> ${point}</div>',"{{/if}}","</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/field/ui.template.field.richText",["tau/core/templates-factory"],function(a){var b={name:"description",markup:['<div class="ui-description {{if !html}}ui-field_empty_true{{/if}}">','   <div class="ui-description__inner tau-clientinput">',"      {{html html}}","   </div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/models/finder/model.entity.finder",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus loadMore+nextPageCommandFormed":function(a){var b=this,c=a.nextPageCommandFormed.data;b.fire("partialDataRequest",{type:c.type,config:c.config})},"bus dataRequestCompleted":function(a){var b=a.data,c=this,d=b.data.isNextPageAvailable();d||c.fire("nextPageIsNotAvailable");var e=b.data.length===0?this.config.emptyDataMessage:null;c.fire("dataLoaded",{data:{emptyMessage:e,items:b.data}}),d&&(c.fire("nextPageCommandFormed",b.data.getNextPageCommand()),c.fire("nextPageAvailable",{}))},getFields:function(){var a=this.config.fields||["id","name",{project:["id","abbreviation"]},{entityState:["id","name"]}];return a},"bus newSearchQuery":function(a){this.processSearchQuery(a)},processSearchQuery:function(a){var b=a.data,c=this;_.extend(b.config,{fields:c.getFields()}),c.fire("partialDataRequest",{type:b.type,config:b.config})},"bus searchConfigFormed":function(a){this.processSearchQuery(a)},onInit:function(){var a=this,b=this.config.actions||[];this.config.emptyDataMessage=this.config.emptyDataMessage||"No data found",a.fire("dataBind",{actions:b,data:{items:[]}}),a.config.context&&a.config.context.entity?a.fire("dataRequest",{type:"general",config:{id:a.config.context.entity.id,fields:[{project:["id","name"]}]},callback:function(b){a.fire("requireSearchConfig",{project:b.data.project})}}):a.fire("requireSearchConfig",{})}});return b}),define("tau/ui/templates/finder/ui.template.finder.resultList.row",["tau/core/templates-factory"],function(a){var b={name:"resultList-row",markup:['<tr class="tau-result-list-row">','   <td class="id" style="width:10px; padding-left:10px;"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></td>',"   <td>${name}</td>",'   <td style="white-space: nowrap;">{{if entityState }}${entityState.name} {{/if}}</td>','   <td style="white-space: nowrap; width:10px;  padding-right:10px;" >${project.abbreviation}</td>',"</tr>"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.finder.resultList",["tau/core/templates-factory","tau/ui/templates/finder/ui.template.finder.resultList.row"],function(a){var b={name:"resultList",markup:['<div class="ui-resultList">','<div class="tau-no-results">${emptyMessage}</div>','<table cellspacing="0" cellpadding="4" class="tau-result-list">',"<tbody>",'{{tmpl(items) "resultList-row"}}',"</tbody>","</table>",'<div class="tau-resultList-load-more">loading items...</div>',"</div>"],dependencies:["resultList-row"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.finder.action",["tau/core/templates-factory"],function(a){var b={name:"finder-action",markup:["<span id='${id}' class='action-link tau-finder-action'>${name}</span>"]};return a.register(b)}),define("tau/ui/templates/finder/ui.template.finder",["tau/core/templates-factory","tau/ui/templates/finder/ui.template.finder.resultList","tau/ui/templates/finder/ui.template.finder.action"],function(a){var b={name:"finder",markup:['<div class="ui-finder-placeHolder">','<div class="ui-drop-down drop-down-actions tau-finder-actions">','{{tmpl(actions) "finder-action"}}',,"</div>",'<div class="ui-finder-header">','<div class="visual-search ui-drop-down">','<div class="filter-field-wrapper"><input type="text" class="filter-field"></div>',"</div>","</div>",'{{tmpl(data) "resultList"}}',"</div>"],dependencies:["resultList","finder-action"]};return a.register(b)}),define("tau/models/finder/model.assignable.search",["Underscore","tau/core/model-base","tau/core/termProcessor"],function(_,a,b){return a.extend({init:function(a){this._super(a);var c=function(a,b,c){a.hasOwnProperty(b)||(a[b]={}),a[b].$contains=c},d=function(a,b,c){if(c==="All uncompleted"){a[b]={isFinal:0};return}if(!a.hasOwnProperty(b)||_.isNull(a[b]))a[b]={name:{$in:[]}};if(c==="Backlog"){a[b]=null;return}a[b].name&&a[b].name.$in&&a[b].name.$in.push(c)},e=function(a,b,c){a.hasOwnProperty(b)||(a[b]={$in:[0]});var d=parseInt(c);_.isNumber(d)&&!_.isNaN(d)&&a[b].$in.push(d)};a.context&&a.context.applicationContext&&a.context.getTerms?this.terms=new b(a.context.getTerms()):this.terms=new b;var f=this.terms;this.properties={id:{autoCompletable:!1,statement:e},text:{name:"name",autoCompletable:!1,statement:c},name:{autoCompletable:!1,statement:c},description:{autoCompletable:!1,statement:c},tag:{name:"tags",autoCompletable:!1,statement:c},project:{label:f.resolve("project"),autoCompletable:!0,statement:d},state:{name:"entityState",autoCompletable:!0,fields:[{entityType:["id"]}],items:[{label:"All uncompleted",value:"All uncompleted",id:0}],statement:d},iteration:{label:f.resolve("iteration"),autoCompletable:!0,category:"project",items:[{label:"Backlog",value:"Backlog",id:0}],fields:[{project:["id","abbreviation"]}],statement:d},release:{label:f.resolve("release"),autoCompletable:!0,category:"project",items:[{label:"Backlog",value:"Backlog",id:0}],fields:[{project:["id","abbreviation"]}],statement:d},priority:{autoCompletable:!0,fields:[{entityType:["id","name"]}],statement:d}}},getType:function(){return"assignable"},"bus autoCompleteRequest":function(a){var b=a.data,c=this,d=c.properties[b.property];if(!d)return;if(d.autoCompletable!==!0)return;if(d.autoCompleteValues){var e={config:b,data:d.autoCompleteValues};c["bus autoComplete"]({data:e});return}var f=d.hasOwnProperty("name")?d.name:b.property,g=["id","name"];d.hasOwnProperty("fields")&&_.mergeFields(g,d.fields);var h=function(a){var d={data:a.data,config:b};c.fire("autoComplete",d)};c.bus.fire("dataRequest",{type:f,config:{fields:g},callback:h})},_isEqualByCategory:function(a,b,c){return b.hasOwnProperty("category")?a[b.category]?a[b.category].name===c.category:!0:!0},"bus autoComplete":function(a){var b=a.data,c=b.config,d=[],e=this,f=this.properties[c.property];f.hasOwnProperty("items")&&(d=d.concat(f.items)),_.each(b.data,function(a){if(a.name===""||a.name==="-")return;if(_(d).any(function(b){return b.value.toLowerCase()===a.name.toLocaleLowerCase()&&e._isEqualByCategory(a,f,b)}))return;var b={label:a.name,value:a.name,id:a.id,dataItem:a},g=function(){return!0};f.hasOwnProperty("filter")&&(g=f.filter);if(!g.call(this,b,f,c))return;if(f.hasOwnProperty("category")){var h=a[f.category].abbreviation||a[f.category].name;_.extend(b,{category:h,label:a.name+" ["+h+"]"})}d.push(b)});var g=_(d).select(function(a){return!c.term||c.term==""?!0:a.value.toLowerCase().indexOf(c.term.toLowerCase())>=0});c.callback(g)},"bus search":function(a){var b=a.data,c=this,d=b.collection,e={};_.each(d,function(a){var b=c.properties[a.property];if(!b)return;var d=b.name?b.name:a.property;b.statement(e,d,a.value)}),c.bus.fire("newSearchQuery",{type:c.getType(),config:{$orderBy:"name",$query:e,$skip:0,$limit:20}})},getInitialQueryConfig:function(){var a={$skip:0,$limit:20,$query:{}};return a},getInitialQueryString:function(){return""},"bus requireSearchConfig":function(a){var b=this,c=a.data.project,d=b.getInitialQueryConfig();_.defaults(d,{$orderBy:"name"});var e=b.getInitialQueryString();b.fire("searchConfigFormed",{type:b.getType(),config:d,properties:b.properties,searchQuery:e})}})}),define("tau/models/finder/model.general.search",["Underscore","tau/models/finder/model.assignable.search"],function(_,a){return a.extend({init:function(a){var b=this;b._super(a),delete b.properties.release,delete b.properties.iteration,delete b.properties.state,delete b.properties.priority;var c=function(a,c,d){var e=_(b.properties.type.autoCompleteValues).select(function(a){return a.name.indexOf(d.toLowerCase())>=0});a.hasOwnProperty(c)||(a[c]={id:{$in:[0]}}),_.each(e,function(b){a[c].id.$in.push(b.id)})};b.properties.type={name:"entityType",autoCompletable:!0,statement:c,autoCompleteValues:[{id:2,name:b.terms.resolve("release")},{id:3,name:b.terms.resolve("iteration")},{id:4,name:b.terms.resolve("story")},{id:5,name:b.terms.resolve("task")},{id:8,name:b.terms.resolve("bug")},{id:9,name:b.terms.resolve("feature")},{id:11,name:b.terms.resolve("build")},{id:12,name:b.terms.resolve("test case")},{id:13,name:b.terms.resolve("test plan")},{id:14,name:b.terms.resolve("test run")},{id:16,name:b.terms.resolve("impediment")},{id:17,name:b.terms.resolve("request")},{id:21,name:b.terms.resolve("solution")}]}},getInitialQueryConfig:function(){return{$skip:0,$limit:20,$query:{}}},getInitialQueryString:function(){return""},getType:function(){return"general"}})}),define("tau/models/finder/model.data",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus dataRequest":function(a){this.config.store.get(a.data.type,a.data.config,{success:a.data.callback}).done()},"bus partialDataRequest":function(a){var b=this,c=function(a){b.fire("dataRequestCompleted",a)};b.config.store.find(a.data.type,a.data.config,{success:c,failure:function(){}}).done()}})}),define("tau/ui/extensions/finder/ui.extension.finder.list",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/finder/ui.template.finder.resultList"],function(_,$,a,b){return a.extend({appendData:function(a,c){var d=this;d.getShowMoreElement(a).hide();var e=b.get().bind(d.config,c),f=c.emptyMessage||"";d._setNoResultsMessage(a,f);var g=$(".tau-result-list>tbody>tr",e);g.appendTo($(".ui-resultList>table>tbody",a)),d.bus.fire("dataRendered",{element:a})},_setScrollingMode:function(a,b){this.getList(a).data("noScrolling",!b)},_setNoResultsMessage:function(a,b){var c=$(".tau-no-results",a);c.text(b),b===""||_.isNull(b)||_.isUndefined(b)?c.hide():c.show()},"bus elementReady+dataLoaded":function(a){var b=a.elementReady.data.element,c=a.dataLoaded.data.data;this.appendData(b,c)},"bus dataRendered+nextPageAvailable":function(a){var b=a.dataRendered.data.element;this._setScrollingMode(b,!0)},"bus search+dataLoaded":function(a){var b=this,c=a.search.data.element;this.bus.fire("elementReady",{element:c})},"bus loadMore+dataLoaded":function(a){var b=this,c=a.loadMore.data.element;this.bus.fire("elementReady",{element:c})},getList:function(a){return $(".ui-resultList",a)},attachScrollingEvents:function(a){var b=this,c=b.getList(a).scroll(function(d){c.data("noScrolling")!=1&&c.scrollTop()+c.innerHeight()>=c[0].scrollHeight&&b.bus.fire("scrollToEnd",{element:a})})},"bus search":function(a){var b=a.data.element;$(".tau-result-list>tbody",b).html(""),this.getShowMoreElement(b).show(),this._setNoResultsMessage(b,""),this._setScrollingMode(b,!1);var c=this.getList(b);c.prop({scrollTop:c.get(0).scrollHeight})},_signUpOnActionsAndSelection:function(a){var b=this;b.getList(a).click(function(a){var c=$(a.target).parents("tr.tau-result-list-row:first");if(!c.data)return;var d=c.data();if(!d)return;if(!d.tmplItem)return;d=d.tmplItem.data;if(!d)return;b.bus.fire("entitySelected",{entity:d})}),$(".action-link",a).click(function(){var a=$(this).data().tmplItem.data;a.fn.call(b)})},"bus afterRender":function(a){var b=a.data.element,c=this;c.bus.fire("elementReady",{element:b}),c.attachScrollingEvents(b),c._setScrollingMode(b,!1),this._signUpOnActionsAndSelection(b)},getShowMoreElement:function(a){return $(".tau-resultList-load-more",a)},"bus scrollToEnd+nextPageAvailable":function(a){var b=this,c=a.scrollToEnd.data.element,d=b.getList(c);b._setScrollingMode(c,!1),b.getShowMoreElement(c).show(),d.prop({scrollTop:d.get(0).scrollHeight}),b.bus.fire("loadMore",{element:c})}})}),define("tau/models/finder.requesters/model.generalUser.finder",["Underscore","tau/core/class","tau/core/model-base"],function(_,a,b){var c=a.extend({init:function(){this._collection=null,this._parameters=[],this._values={},this._fields=[],this._page=1,this._onPage=10,this._orderBy=null,this._orderDir="asc"},setFields:function(a){this._fields=a},setCollection:function(a){this._collection=a},registerParameters:function(a){this._parameters=_.toArray(a)},setParameter:function(a,b){if(_.indexOf(this._parameters,a)==-1)throw new Error('No "'+a+'" parameter for query');this._values[a]=b},setOnPage:function(a){this._onPage=a},setPage:function(a){this._page=a||1},setOrderBy:function(a){this._orderBy=a},setOrderDir:function(a){this._orderDir=a},create:function(){var a={};a.collection=this.createCollection();var b={};b.fields=this._fields,b.$query=this.createWhere();var c=this.createPaging();b.$skip=c.skip,b.$limit=c.limit;var d=this._orderDir=="asc"?"$orderBy":"$orderByDesc";return b[d]=this.createOrderBy(),a.request=b,a},createCollection:function(){return this._collection},createWhere:function(){var a={};return _.forEach(this._values,function(b,c){a[c]=b}),a},createOrderBy:function(){return this._orderBy||"id"},createPaging:function(){var a={limit:this._onPage,skip:0};return a.skip=(this._page-1)*this._onPage,a}}),d=c.extend({init:function(){this._super(),this.registerParameters(["name","email","type","projectId","companyId","action"])},createCollection:function(){var a=this._super();if(this._values.type){var b=this._values.type;b=="User"?a="User":b=="Requester"&&(a="Requester")}return this._values.companyId&&(a="Requester"),a},createWhere:function(){var a={};return this._values.type||(a.kind={$in:["User","Requester"]}),a.isActive=1,a.deleteDate={$isNull:!0},this._values["action"]=="reset"?a:(this._values.name!==undefined&&(a.lastName={$contains:this._values.name}),this._values.email!==undefined&&(a.email={$contains:this._values.email}),this._values.companyId&&this.createCollection()=="Requester"&&(a["company.id"]=this._values.companyId),a)}}),e=a.extend({init:function(a){this.items=a.data;var b=a.command,c=a.data.length;this.paging={start:b.config.$skip,end:b.config.$skip+c,count:c,hasNext:a.data.isNextPageAvailable()}}}),f=b.extend({"bus beforeInit":function(a){this.config=a.data.config;var b=this.config.store,c=this,e=this.config.actions||[];this.config.emptyDataMessage=this.config.emptyDataMessage||"No data found",b.get("company",{fields:["id","name"]}).done({success:function(a){c.fire("dataBind",{actions:e,result:null,filter:{companies:a[0].data}})}});var f=new d;f.setCollection("generalUser"),f.setOnPage(15),f.setFields(["id","firstName","lastName","email","login"]),f.setOrderBy("id"),f.setOrderDir("desc"),this.builder=f,c.fire("search.parametersBound",{parameters:{}})},"bus search.readyToExecute":function(a){var b=this.builder.create(),c=this;this.config.store.find(b.collection,b.request).done({success:function(a){var b=new e(a[0]);c.fire("search.completed",{result:b})}})},"bus search.completed":function(a){this.fire("result.ready",{data:{result:a.data.result}})},"bus search.parametersBound":function(a){var b=a.data.parameters,c=this.builder;_.forEach(b,function(a,b){a?c.setParameter(b,a):c.setParameter(b,undefined)}),c.setPage(0),this.fire("search.readyToExecute")},"bus search.pagingBound":function(a){var b=this.builder;b.setPage(b._page+1),this.fire("search.readyToExecute")},"bus search.orderBound":function(a){var b=this.builder;b.setOrderBy(a.data.value),b.setOrderDir(a.data.dir),b.setPage(1),this.fire("search.readyToExecute")}});return f}),define("tau/models/finder.requesters/model.generalUser.editor",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus entitySelected":function(a){var b=a.data.entity,c=this.config.store,d=this,e=this.config.context.entity;c.save(e.entityType.name,{id:e.id,$set:{requesters:[{id:b.id}]},fields:["id"]}).done({success:function(a){}})}});return b}),define("tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.filter",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=b.find("[role=filter]"),d=c.find(":input"),e=c.find(":button"),f=this;this.state="clear",e.prop("disabled","disabled"),e.addClass("disable"),d.bind("change keyup",function(){f.state="dirty",e.prop("disabled",!1),e.removeClass("disable")});var g=function(a){var b={};d.each(function(){var a=$(this),c=_.trim(a.val());b[a.attr("name")]=c}),b.action=a,f.bus.fire("search.parametersBound",{parameters:b})};d.bind("keydown",function(a){switch(a.keyCode){case $.ui.keyCode.ENTER:g("search"),a.stopPropagation(),a.preventDefault();break;case $.ui.keyCode.DOWN:$(this).is("input")?$(this).blur():(a.stopPropagation(),a.preventDefault())}}),e.eq(0).click(function(){g($(this).val())}),e.eq(1).click(function(){var a={};d.each(function(){var b=$(this);b.val(null);var c=_.trim(b.val());a[b.attr("name")]=c}),a.action=$(this).val(),f.bus.fire("search.parametersBound",{parameters:a}),e.prop("disabled","disabled"),e.addClass("disable"),d.filter("[data-autofocus]").focus()});var h=d.filter("[name=companyId]"),i=d.filter("[name=type]"),j=function(){i.val()=="User"?(h.val(null),h.prop("disabled","disabled")):h.prop("disabled",!1)};j(),i.on("change",j)}})}),define("tau/ui/templates/finder.requesters/ui.template.finder.action",["tau/core/templates-factory"],function(a){var b={name:"finder-requesters-action",markup:["<span id='${id}' class='action-link tau-finder-action'>${name}</span>"]};return a.register(b)}),define("tau/ui/templates/finder.requesters/ui.template.finder.filter",["tau/core/templates-factory"],function(a){var b={name:"finder-requesters-filter",markup:['<div class="ui-form">','<div class="ui-form__group">','<div class="ui-form__cols">','<label for="name">Last Name</label>','<input type="text" name="name" />',"</div>",'<div class="ui-form__cols">','<label for="email">Email</label>','<input data-autofocus type="text" name="email" />',"</div>","</div>",'<div class="ui-form__group">','<div class="ui-form__cols">','<label for="type">User Type</label>','<select name="type">','<option value="">All</option>','<option value="Requester">Requesters</option>','<option value="User">Users</option>',"</select>","</div>",'<div class="ui-form__cols">','<label for="type">Company</label>','<select name="companyId">','<option value="">All</option>',"{{each(i, company) filter.companies}}",'<option value="${company.id}">${company.name}</option>',"{{/each}}","</select>","</div>","</div>",'<div class="ui-form__group">','<div class="ui-form__row ui-form__row-controls button-group">','<button name="action" value="search" class="button" >Filter</button>','<button name="action" value="reset" class="button" >Clear</button>',"</div>","</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/finder.requesters/ui.template.finder.resultList.row",["tau/core/templates-factory"],function(a){var b={name:"finder-requesters-resultList-row",markup:['<tr class="tau-result-list-row" role="option">','<td class="tau-finder__cell tau-finder__cell-name">',"{{if firstName || lastName}}","${firstName} ${lastName}","{{else}}","${email}","{{/if}}","</td>",'<td class="tau-finder__cell tau-finder__cell-email">${email}</td>','<td class="tau-finder__cell tau-finder__cell-login">${login}</td>',"</tr>"]};return a.register(b)}),define("tau/ui/templates/finder.requesters/ui.template.finder.resultList",["tau/core/templates-factory","tau/ui/templates/finder.requesters/ui.template.finder.resultList.row"],function(a){var b={name:"finder-requesters-resultList",markup:['<table class="tau-finder__table">',"<thead>",'<tr role="list-sorting">','<th class="tau-finder__cell tau-finder__cell-name">','<button class="tau-finder__sorttrigger" role="sorting" value="firstName">Name</button>',"</th>",'<th class="tau-finder__cell tau-finder__cell-email">','<button class="tau-finder__sorttrigger" role="sorting" value="email">Email</button>',"</th>",'<th class="tau-finder__cell tau-finder__cell-login">','<button class="tau-finder__sorttrigger" role="sorting" value="login">Login</button>',"</th>","</tr>","</tbody>","</table>",'<div class="ui-resultList tau-finder__result tau-finder__result_state_loading" role="list-placeholder">','<div class="tau-no-results  tau-finder__result__empty">No requesters found.</div>','<table class="tau-finder__table">','<tbody role="list">',"{{if items}}",'{{tmpl(items) "finder-requesters-resultList-row"}}',"{{/if}}","</tbody>","</table>",'<div class="tau-resultList-load-more tau-finder__result__loader">loading users...</div>',"</div>"],dependencies:["finder-requesters-resultList-row"]};return a.register(b)}),define("tau/ui/templates/finder.requesters/ui.template.finder",["tau/core/templates-factory","tau/ui/templates/finder.requesters/ui.template.finder.resultList","tau/ui/templates/finder.requesters/ui.template.finder.action","tau/ui/templates/finder.requesters/ui.template.finder.filter"],function(a){var b={name:"finder-requesters",markup:['<div class="ui-finder-placeHolder">','<div class="ui-finder-header">','<div class="visual-search ui-drop-down" role="filter">','{{tmpl() "finder-requesters-filter"}}',"</div>","</div>",'{{tmpl(result) "finder-requesters-resultList"}}',"</div>"],dependencies:["finder-requesters-resultList","finder-requesters-action","finder-requesters-filter"]};return a.register(b)}),define("tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter",["Underscore","tau/models/extension.model.base"],function(_,a){var b=a.extend({"bus extendGetEntityQuery":function(a){var b=a.data.fields,c=["id"];b=a.data.fields=_.uniq(_.union(b,[{owner:c},{responsible:c},"isPrivate"])),_.each(b,function(a){a.hasOwnProperty("entityState")&&(a.entityState=_.uniq(_.union(a.entityState,["isFinal"])))})},"bus filterEntities":function(a){var b=a.data;b.entities=_.select(b.entities,function(a){if(a.entityState.isFinal)return!1;if(!a.isPrivate)return!0;var b=this.config.context.getLoggedUser().id;return(a.owner||{}).id==b||(a.responsible||{}).id==b},this)}});return b}),define("tau/components/extensions/impedimentList/extension.impedimentList.visibilityController",["jQuery","tau/components/extensions/component.extension.base"],function(jQuery,a){return a.extend({"bus afterRender":function(a){a.data.element.hide()},"bus componentsCreated+impedimentsCountRetrieved":function(a){var b=a.impedimentsCountRetrieved.data.count,c=a.componentsCreated.data,d=c[0].component;d.fire("sendEventToComponents",{name:"setBadgeText",data:{text:b}})},"bus componentsCreated+impedimentsRetrieved":function(a){var b=a.impedimentsRetrieved.data.items,c=a.componentsCreated.data,d=c[1].component;if(d.name=="impedimentListPanel inner")return;d.fire("dataBind",{items:b})},"bus afterRender+impedimentsCountRetrieved":function(a){if(a.impedimentsCountRetrieved.data.count>0){var b=a.afterRender.data.element;this.config.disableAnimation?b.show():b.slideDown("slow")}}})}),define("tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter",["jQuery","tau/components/extensions/component.extension.base"],function(jQuery,a){return a.extend({"bus afterRender+impedimentsCountRetrieved":function(a){var b=a.impedimentsCountRetrieved.data.count;b>0&&this.fire("setBadgeText",{text:b})}})}),define("tau/models/baseInfoList/extension.model.entityIdRetriever",["tau/models/extension.model.base"],function(a){var b=a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={};b[this.config.propertyName]=["id"];var c=[b];this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:c},callback:{success:this.onEntityRetrieved,scope:this}})},onEntityRetrieved:function(a){var b=a.data[this.config.propertyName];this.fire("entityIdsRetrieved",b)}});return b}),define("tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever",["Underscore","tau/models/extension.model.base"],function(_,a){var b=a.extend({"bus entityIdsRetrieved":function(a){var b=a.data,c=b.length;for(var d=0;d<c;d++){var e={id:b[d].id,fields:["id","name",{entityState:["name"]}]};this.fire("extendGetEntityQuery",e),this.fire("get",{type:this.config.typeName,query:e})}this.fire("commitTransaction",{scope:this,success:this.onEntitiesRetrieved})},convertServerDataModelData:function(a){return a=a,{__type:a.__type,id:a.id,name:a.name,state:{name:a.entityState.name}}},onEntitiesRetrieved:function(a){var b={entities:_.pluck(a,"data")};this.fire("filterEntities",b),a=b.entities;var c=_.map(a,this.convertServerDataModelData,this);c=_.compact(c),this.fire("entitiesRetrieved",c)}});return b}),define("tau/models/model.list.baseInfo",["tau/core/model-base","tau/models/baseInfoList/extension.model.entityIdRetriever","tau/models/baseInfoList/extension.model.additionalInfoEntityRetriever"],function(a,b,c){var d=a.extend({init:function(a){this._super.apply(this,arguments),this.propertyName=a.propertyName,this.typeName=a.typeName,new b(a),new c(a)},onInit:function(){if(this.config.disableModel)return;this.fire("registerStoreRequest"),this.fire("commitTransaction")},"bus entitiesRetrieved":function(a){var b={items:a.data};this.bus.fire("dataBind",b)},"bus evictProperty":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,[this.propertyName])}});return d}),define("tau/models/model.impedimentsCountCalculator",["tau/models/model.list.baseInfo","tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter"],function(a,b){var c=a.extend({init:function(a){a.propertyName="impediments",a.typeName="impediment",this._super.apply(this,arguments),new b(a)},"bus entitiesRetrieved":function(a){this.fire("impedimentsCountRetrieved",{count:a.data.length}),this.fire("impedimentsRetrieved",{items:a.data})},onGetEntity:function(a){var b=a.data,c=b["impediments-count"];this.fire("impedimentsCountRetrieved",{count:c})}});return c}),define("tau/models/dataprocessor/model.processor.implementationHistory",["Underscore","tau/core/termProcessor"],function(_,a){var b=function(a,b,c){return _.each(c,function(c){c in b&&(a[c]=b[c])}),a},c=function(a){this._historyItems=a};c.enhance=function(a){return(new this(a)).enhance()},c.prototype={constructor:c,enhance:function(){var a=this._historyItems;return a=this._addDateSpan(a),a},_addDateSpan:function(a){var b=this._createItemStateGroups(a);return _.each(b,function(a){var b=_.first(a).state;b.dateSpan=a.length}),a},_createItemStateGroups:function(a){var b=[],c=null,d=null;return _.each(a,function(a){c!=a.state.name&&(c=a.state.name,d&&b.push(d),d=[]),d.push(a)}),b.push(d),b}};var d=function(a){this._historyItems=a};d.compress=function(a){return(new this(a)).compress()},d.prototype={constructor:d,compress:function(){var a=this._historyItems;return a=this._compressAssignments(a),a=this._compressStates(a),a},_compressStates:function(a){var b=_.select(a,function(b,c){var d=!0;return this._isItemStateNeedsCompression(b.state)&&this._isItemNeedsCompression(b,c,a)&&(d=!1),d},this);return b},_isItemStateNeedsCompression:function(a){return a.isInitial||a.isFinal||a.isPlanned},_isItemNeedsCompression:function(a,b,c){var d=!1,e=c[b-1],f=!e;if(!f){var g=e.state.name!=a.state.name,h=a.transitions>1,i=a.assignments,j=a.relatedEntities,k=a.spentTime>0;g||!h&&!i&&!j&&!k&&(d=!0)}return d},_compressAssignments:function(a){return this._clearDublicatedAssignmentsForState(a),this._mergeIdenticalAssignmentsForItem(a),a},_clearDublicatedAssignmentsForState:function(a){var b=_.select(a,function(b,c){var d=!1;if(b.assignments){var e=a[c-1];e&&e.state.name==b.state.name&&this._areAssignmentsTheSame(e.assignments,b.assignments)&&(d=!0)}return d},this);_.each(b,function(a){delete a.assignments})},_mergeIdenticalAssignmentsForItem:function(a){_.each(a,function(a){if(a.assignments){var b=[],c={};_.each(a.assignments,function(a){a.id in c?c[a.id].roles.push(a.role):(c[a.id]=a,a.roles=[a.role],delete a.role,b.push(a))}),a.assignments=b}})},_areAssignmentsTheSame:function(a,b){var c=_.pluck(a,"id").join(""),d=_.pluck(b,"id").join("");return c==d}};var e=function(b){this._inputData=b,this._termProcessor=new a(b.terms)};return e.transform=function(a){return(new this(a)).transform()},e.prototype={constructor:e,transform:function(){var a={entityStates:this._getEntityStateNames(),historyItems:this._getHistoryItems(),leadTime:this._getLeadTime(),cycleTime:this._getCycleTime()};return a},_getLeadTime:function(){return this._inputData.leadTime},_getCycleTime:function(){return this._inputData.cycleTime},_getHistoryEntries:function(){return this._inputData.response[0].data.statistics.entries},_getAllEntityStatesForProcess:function(){return this._inputData.response[1].data.entityStates},_getAllUsers:function(){return this._inputData.response[2].data},_getAllRoles:function(){return this._inputData.response[3].data},_getEntityStateNames:function(){var a=this._getEntityStates(),b=this._sortEntityStates(a),c=_.map(b,function(a){return a.name});return c},_getEntityStates:function(){var a=this._inputData.entityTypeName,b=_.select(this._getAllEntityStatesForProcess(),function(b){return a.toLowerCase()==b.entityType.name.toLowerCase()});return b},_sortEntityStates:function(a){var b=_.sortBy(a,function(a){var b=a.numericPriority;return a.isInitial?b=Number.NEGATIVE_INFINITY:a.isFinal&&(b=Number.POSITIVE_INFINITY),b}).reverse();return b},_getHistoryItems:function(){var a=[];return _.each(this._getHistoryEntries(),function(b){a.push(this._createHistoryItem(b))},this),a=this._sortHistoryItems(a),a=this._enhanceHistoryItems(a),a=this._compressHistoryItems(a),a},_createHistoryItem:function(a){var b={date:new Date(Date.parse(a.date)),spentTime:parseFloat(a.time),transitions:parseFloat(a.transitions),state:this._getHistoryEntryState(a)},c=this._getHistoryEntryRelatedEntities(a);return _.isEmpty(c)||(b.relatedEntities=c),a.assignments&&(b.assignments=this._getHistoryEntryAssignments(a)),b},_getHistoryEntryState:function(a){var c=this._getEntityStateInfo(a.stateId),d=b({},c,["name","isInitial","isFinal","isPlanned"]);return c.role&&(d.roleId=c.role.id),d},_getEntityStateInfo:function(a){var b=_.detect(this._getAllEntityStatesForProcess(),function(b){return a==b.id});return b},_getHistoryEntryRelatedEntities:function(a){var c=b({},a,["opened","closed"]);return this._setEntityAlias(c.opened),this._setEntityAlias(c.closed),c},_setEntityAlias:function(a){_.each(a,function(a){var b=this._getEntityAlias(a.type);b&&(a.alias=b)},this)},_getEntityAlias:function(a){var b=this._termProcessor.getTerms(a);return b?b.name:null},_getHistoryEntryAssignments:function(a){var b=[];return _.each(a.assignments,function(a){var c=this._getUserInfo(a.userId);c&&b.push({id:a.userId,firstName:c.firstName,lastName:c.lastName,role:{id:parseInt(a.roleId),name:this._roleIdToName(a.roleId)}})},this),b},_getUserInfo:function(a){var c=null,d=_.detect(this._getAllUsers(),function(b){return a==b.id});return d&&(c=b({},d,["firstName","lastName"])),c},_roleIdToName:function(a){var b=_.detect(this._getAllRoles(),function(b){return a==b.id});return b.name},_sortHistoryItems:function(a){return _.sortBy(a,function(a){return new Date(Date.parse(a.date))})},_enhanceHistoryItems:function(a){return c.enhance(a)},_compressHistoryItems:function(a){return d.compress(a)}},e}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){this._createFlowIndicators(),this._connectMarkers(),this.fire("stateProgressRendered")},_createFlowIndicators:function(){var a=this._$element.find(".tau-historyGrid .tau-historyItem");_.each(this._data.historyItems,function(b,c){this._markProgressStep(a.eq(c),b)},this)},_getHistoryItemStateIndex:function(a){return _.indexOf(this._data.entityStates,a)},_getFlowType:function(a){var b="NORMAL";return a.state.isFinal?b="DONE":this._isUnderImpediment(a)?b="IMPEDIMENT":a.transitions>1&&(b="MULTITRANS"),b},_isUnderImpediment:function(a){var b=_.any(this._getImpedimentRangeList(),function(b){return this._isInImpedimentRange(a,b)},this);return b},_getImpedimentRangeList:function(){if(!this._impedimentRangeList){this._impedimentRangeList=[];var a=this._getAllImpediments();_.each(a.opened,function(b,c){this._impedimentRangeList.push({start:b,end:a.closed[c]||Number.POSITIVE_INFINITY})},this),this._impedimentRangeList.sort(function(a,b){return b.end-b.start-(a.end-a.start)})}return this._impedimentRangeList},_getAllImpediments:function(){var a={opened:{},closed:{}};return _.each(this._data.historyItems,function(b){b.relatedEntities&&(_.each(b.relatedEntities.opened,function(c){this._isImpediment(c)&&(a.opened[c.id]=b.date)},this),_.each(b.relatedEntities.closed,function(c){this._isImpediment(c)&&(a.closed[c.id]=b.date)},this))},this),a},_isImpediment:function(a){return a.type.toLowerCase()=="impediment"},_isInImpedimentRange:function(a,b){return a.date>=b.start&&a.date<=b.end},_markProgressStep:function(a,b){var c=this._getHistoryItemStateIndex(b.state.name),d=this._getFlowType(b),e=this._createFlowIndicator(d),f=b.state.dateSpan;f&&!b.state.isFinal&&$("<span/>").addClass("datespan").text(f).attr("title",f+" consecutive days in this state").appendTo(e),a.find(".tau-progressSteps .tau-step:nth-child("+(c+1)+") .tau-marker").append(e)},_createFlowIndicator:function(a){var b=$("<div/>").addClass("tau-flow");switch(a){case"NORMAL":b.addClass("tau-normal");break;case"MULTITRANS":b.addClass("tau-transitions");break;case"IMPEDIMENT":b.addClass("tau-impediment");break;case"DONE":b.addClass("tau-done")}return b},_connectMarkers:function(){_.each(this._data.historyItems,function(a,b){var c=this._getHistoryItemStateIndex(a.state.name);this._connect(b,c,b-1,"in"),this._connect(b,c,b+1,"out")},this)},_connect:function(a,b,c,d){var e=this._data.historyItems[c];if(e){var f=this._getHistoryItemStateIndex(e.state.name),g=b-f;g>0&&this._$element.find(".tau-historyGrid .tau-historyItem").eq(a).find(".tau-progressSteps .tau-step").filter(function(a){return a>=f+1&&a<=b}).find(".tau-marker").addClass("tau-"+d)}}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=this._createStateDateItemsHash();this._$element.find(".tau-historyGridInterpretation .stateName").each(function(b,c){var d=$(c),e=a[d.text()],f=d.attr("title")+" ("+e.absolute+" days)";d.attr("title",f).addClass("tau-dateItems-"+e.relative)})},_createStateDateItemsHash:function(){var a={};return _.each(this._data.entityStates,function(b){a[b]={absolute:0,relative:0}}),this._calculateAbsoluteHashValues(a),this._calculateRelativeHashValues(a),a},_calculateAbsoluteHashValues:function(a){_.each(this._data.historyItems,function(b){var c=b.state.dateSpan;c&&(a[b.state.name].absolute+=c)})},_calculateRelativeHashValues:function(a){var b=_.max(a,function(a){return a.absolute}).absolute;_.each(a,function(c,d){var e=c.absolute*100/b;a[d].relative=Math.round(e/10)*10})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){if(this._timeLoadWasReported()){var a=this._calculateMaxSpentTime(),b=this._$element.find(".tau-historyGrid td.tau-historyItem");_.each(this._data.historyItems,function(c,d){var e=c.spentTime,f=b.eq(d).find(".tau-date"),g=this._calculateRelatedRoundedSpentTime(a,e);if(!isNaN(g)){var h=f.attr("title");f.addClass("tau-timeLoad-"+g).attr("title",h+" ("+e+" hours)")}},this)}},_timeLoadWasReported:function(){return _.any(this._data.historyItems,function(a){return a.spentTime>0})},_calculateMaxSpentTime:function(){return _.max(this._data.historyItems,function(a){return a.spentTime}).spentTime},_calculateRelatedRoundedSpentTime:function(a,b){var c=b*100/a,d=Math.round(c/10)*10;return d}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){var b={create:function(a,b){return $("<div/>").addClass(this._createClassName(a,b)).attr("title",this._createTitle(a,b)).data("entityInfo",{id:a.id,type:a.type,alias:a.alias||a.type}).click(this._onRelatedEntityClick)},_createTitle:function(a,b){var c=["["+(a.alias||a.type)+"]"," #"+a.id,a.name,b?"(closed)":"(added)"].join(" ");return c},_createClassName:function(a,b){var c=["tau-entity","tau-"+a.type.toLowerCase(),b?"tau-closed":""].join(" ");return c},_onRelatedEntityClick:function(a){var b=$(this).data("entityInfo");b&&location.assign("#"+b.type+"/"+b.id)}};return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=this._$element.find(".tau-historyGrid .tau-historyItem");_.each(this._data.historyItems,function(c,d){var e=a.eq(d).find(".tau-relatedEntities");c.relatedEntities&&(_.each(c.relatedEntities.opened,function(a){e.append(b.create(a))}),_.each(c.relatedEntities.closed,function(a){e.append(b.create(a,!0))}))})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.statsRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=$('<div class="tau-historyStats"/>'),b=$(["<table>","<tbody>",'<tr style="display: ',this._calculateCycleTime()?"":"none",'" >',"<td>Cycle Time:</td>","<td>"+this._calculateCycleTime()+"</td>","</tr>",'<tr style="display: ',this._calculateLeadTime()?"":"none",'">',"<td>Lead Time:</td>","<td>"+this._calculateLeadTime()+"</td>","</tr>","</tbody>","</table>"].join(""));(this._calculateCycleTime()||this._calculateLeadTime())&&a.append(b).appendTo(this._$element)},_calculateLeadTime:function(){return this._data.leadTime},_calculateCycleTime:function(){return this._data.cycleTime}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){a.data.element.find(".tau-historyGrid").mousewheel($.proxy(this,"_onMouseWheel"))},_onMouseWheel:function(a,b){var c=a.currentTarget;if(this._isScrollActive(c)){a.preventDefault();var d=$(c),e=d.scrollLeft(),f=e+ -b*100;d.scrollLeft(f)}},_isScrollActive:function(a){return a.scrollWidth>a.offsetWidth}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender":function(a){this._$relatedEntities=a.data.element.find(".tau-relatedEntities .tau-entity"),this._$relatedEntities.hover($.proxy(this,"_onHoverIn"),$.proxy(this,"_onHoverOut"))},_getRelatedEntities:function(a){var b=$(a).data("entityInfo").id;return this._$relatedEntities.filter(function(){return b==$(this).data("entityInfo").id})},_onHoverIn:function(a){this._getRelatedEntities(a.currentTarget).addClass("tau-highlight")},_onHoverOut:function(a){this._getRelatedEntities(a.currentTarget).removeClass("tau-highlight")}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(a){return a.extend({"bus afterRender":function(a){this._$element=a.data.element},"bus afterUpdate":function(a){this._$element.tauOverlay(),this.fire("refresh")}})}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem",["tau/core/templates-factory"],function(a){var b={name:"implementationHistoryItem",options:{},dependencies:[],markup:['<td class="tau-historyItem">','<div class="tau-progressSteps">',"{{each(index, step) $item.parent.data.entityStates}}",'<div class="tau-step">','<div class="tau-marker"/>',"</div>","{{/each}}","</div>",'<div class="tau-date"></div>','<div class="tau-relatedEntities"></div>',"</td>"].join("")};return a.register(b)}),define("tau/ui/templates/implementationHistory/ui.template.implementationHistory",["tau/core/templates-factory","tau/ui/templates/implementationHistory/ui.template.implementationHistoryItem"],function(a){var b={name:"implementationHistory",options:{},dependencies:["implementationHistoryItem"],markup:['<div class="tau-implementationHistory">','<div class="tau-historyGridInterpretation">',"{{each(index, stateName) entityStates}}",'<div class="stateName" title="${stateName}">',"<span>${stateName}</span>","</div>","{{/each}}","<div>Date</div>","<div>Related Entities</div>","</div>",'<div class="tau-historyGrid">',"<table>","<tbody>","<tr>",'{{tmpl(historyItems) "implementationHistoryItem"}}',"</tr>","</tbody>","</table>","</div>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/common/ui.template.attributeValue",["tau/core/templates-factory"],function(a){var b={name:"common-attributeValue",markup:['<span class="attr-item popup-target"><span class="attr-name">${name}</span></span>'],dependencies:[]};return a.register(b)}),define("tau/ui/templates/progressBar/ui.template.iteration.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c={name:"iteration-progress-bar",tags:[b],markup:['<div class="entity-progress-box">','   <div class="ui-progressbar__data">','      <span class="ui-label-completed">Completed&nbsp;<b class="value">${effortCompleted}${point}</b></span>','      <span class="ui-label-todo">ToDo&nbsp;<b class="value">${effortToDo}${point}</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};return a.register(c)}),define("tau/components/extensions/duplicateBugList/extension.duplicateBugList.count.label.setter",["jQuery","tau/components/extensions/component.extension.base"],function(jQuery,a){return a.extend({"bus afterRender+duplicateBugCountRetrieved":function(a){var b=a.duplicateBugCountRetrieved.data.count;b>0&&this.fire("setBadgeText",{text:b})}})}),define("tau/ui/tags/ui.tag.implode",["Underscore"],function(_){return{register:function(a,b){b.$tau=b.$tau||{},b.$tau.text_implode=function(a){var b=new String(a);if(_.isString(a))b=a;else if(_.isArray(a)){var c=_.clone(a),d=c.pop();b=_.filter([c.join(", "),d],function(a){return a!=0}).join(" &amp; ")}return b}}}}),define("tau/ui/templates/label/ui.template.label",["tau/core/templates-factory","tau/ui/tags/ui.tag.implode"],function(a,b){var c={name:"label",tags:[b],markup:['<div><span class="ui-label{{if cssClass}} ${cssClass}{{/if}}">${$item.$tau.text_implode(text)}</span></div>'],dependencies:[]};return a.register(c)}),define("tau/ui/extensions/label/ui.extension.label",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender:last+setBadgeText":function(a){this.element=a.afterRender.data.element,this._getBadgeElement().text(a.setBadgeText.data.text),this.config.quantityCssClass&&this._getBadgeElement().addClass(this.config.quantityCssClass)},_getBadgeElement:function(){var a=this.element.find(".ui-quantity");return a.length==0&&(a=$('<span class="ui-quantity"></span>').appendTo(this.element)),a}})}),define("tau/components/extensions/leadCycleTime/extension.ui.leadCycleTime",["jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.tauBubble"],function($,a){var b=function(a){var b=null,c=a.target,d=a.caption,e=a.value;c.click(function(a){b={x:a.pageX,y:a.pageY}}),c.addClass("ui-link").tauBubble({onShow:function(){var b=this.$popup.find(".tau-bubble__inner");if(b.find(".tau-time-interval-header").size()>0)return;b.append(['<div class="tau-time-interval-container">',"<table>","<tr>","   <td>",'       <div class="tau-time-interval-header">',a.caption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',e,"</div>","   </td>","</tr>","<tr>","   <td>",'       <div class="tau-time-interval-header">',a.startCaption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',a.startDate,"</div>","   </td>","</tr>","<tr>","   <td>",'       <div class="tau-time-interval-header">',a.endCaption,":</div>","   </td>","   <td>",'       <div class="tau-time-interval-value">',a.endDate,"</div>","   </td>","</tr>","</table>","</div>"].join(""))},alignTo:c,adjustArrow:function(a,b){a.css("left",b.width()/2-35+"px")},onPosition:function(a){a.my="left top",a.at="left bottom";var c=this.target.offset();a.offset=b.x-c.left-70+" 15"},target:c})};return a.extend({extractDataFromEvent:function(a,b){return(a[b]||{}).data||{}},"bus afterRender+dataBind":function(a){var c=this.extractDataFromEvent(a,"dataBind"),d=$(this.extractDataFromEvent(a,"afterRender").element);b({target:d.find("svg.main-plot rect").eq(4),caption:"Cycle Time",value:c.cycleTimeTooltip,startCaption:"Start Date",startDate:(c.startDate||"").length>0?c.startDate:c.createDate,endCaption:c.endDateLabel,endDate:c.endDate}),b({target:d.find("svg.main-plot rect").eq(0),caption:"Lead Time",value:c.leadTimeTooltip,startCaption:"Create Date",startDate:c.createDate,endCaption:c.endDateLabel,endDate:c.endDate})}})}),define("tau/ui/templates/leadCycleTime/ui.template.leadCycleTime",["tau/core/templates-factory"],function(a){var b={name:"lead-cycle-time",options:{contentSelector:".request-list"},markup:['<div style="position: relative;">','<div style="position: absolute; top:0px;left: 6.5%;">','   <svg width="30" height="65" style="position: relative;left: -15px;">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${createDate}</text>',"   </svg>","</div>","{{if (startDate)}}",'<div style="position: absolute; top:0px;left:{{if (cyclePercentage < 0.9)}} ${83-cyclePercentage*80}{{/if}}{{if (!(cyclePercentage<0.9))}}${86-cyclePercentage*80}{{/if}}%;">','   <svg width="30" height="57">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${startDate}</text>',"   </svg>","</div>",'<div style="position:absolute;left:6.5%;top:65px;width:80%; height:4px;">&nbsp;</div>',"{{/if}}",'<div style="position: absolute; ',"{{if (cyclePercentage && cyclePercentage<0.2)}}","top:-5px;left: 91","{{/if}}","{{if (!cyclePercentage || cyclePercentage > 0.2)}}","top:-5px;left: 87","{{/if}}",'%;">','   <svg width="30" height="60" style="position: relative;left: -15px;">','       <text x="10" y="55" fill="rgb(174,174,174)" style="font-size: 10px;font-weight: bold;" transform="rotate(-90 10 55)">${endDateLabel}<tspan  x="10" dy="1.4em">${endDate}</tspan></text>',"   </svg>","</div>",'<div style="position: absolute;left:87.5%;top:51px;">','   <svg width="50" height="50">','    <text x="0" y="11" fill="rgb(70,155,219)" width="50" style="font-size: 10px;font-weight: bold;">${cycleTime}</text>','    <text x="0" y="23" fill="rgb(95,95,95)" style="font-size: 10px;font-weight: bold;">${leadTime}</text>',"   </svg>","</div>",'<svg width="100%" height="80" class="main-plot">',"   <defs>",'   <linearGradient id="cycleTime" x1="0%" y1="0%" x2="0%" y2="100%">','            <stop offset="0%" style="stop-color:rgb(186,210,239);stop-opacity:1"/>','            <stop offset="100%" style="stop-color:rgb(98,143,198);stop-opacity:1"/>',"        </linearGradient>",'        <linearGradient id="leadTime" x1="0%" y1="0%" x2="0%" y2="100%">','            <stop offset="0%" style="stop-color:rgb(178,184,194);stop-opacity:1"/>','            <stop offset="100%" style="stop-color:rgb(141,144,152);stop-opacity:1"/>',"        </linearGradient>","    </defs>",'    <rect x="6.5%" y="67" rx="3" ry="3" width="80%" height="5"','          fill="url(#leadTime)" style="cursor: pointer;"/>','    <rect x="6%" y="5" width="1" height="70"','       style="fill:rgb(226,226,227);"/>','    <rect x="86.8%" y="5" width="1" height="70"','          style="fill:rgb(226,226,227);"/>',"{{if (cyclePercentage)}}",'    <rect class="lead-time-rect" x="${86-cyclePercentage*80}%" y="5" width="1" height="60"','       style="fill:rgb(226,226,227);"/>','    <rect x="${86.5-cyclePercentage*80}%" y="58" rx="3" ry="3" width="${cyclePercentage*80}%" height="5" style="cursor: pointer;"','          fill="url(#cycleTime)"/>',"{{/if}}","</svg>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/common/ui.template.entityLink.icon",["tau/core/templates-factory"],function(a){var b={name:"entity-link-icon",markup:['<a href="#${__type.toLowerCase()}/${id}" class="tau-linkentity tau-linkentity_type_icon">','<em class="ui-type-icon ui-type-icon-${__type.toLowerCase()} ui-link-entity__icon">${id}</em>',"</a>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/common/ui.template.entityLink.text",["tau/core/templates-factory"],function(a){var b={name:"entity-link-text",markup:['<a href="#${__type.toLowerCase()}/${id}" class="tau-linkentity tau-linkentity_type_text">','<span class="tau-linkentity__inner">',"{{if text}}","${text}","{{else}}","${name}","{{/if}}","</span>","</a>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/list/ui.template.list.baseInfo.item",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.icon","tau/ui/templates/common/ui.template.entityLink.text"],function(a){var b={name:"list-base-info-item",markup:['<tr class="{{if $item.index %2 != 0}}alternative-row{{/if}}">','<td class="entity-type tau-list__table__cell-id">{{tmpl($data) "entity-link-icon"}}</td>','<td class="name">{{tmpl($data) "entity-link-text"}}</td>','<td class="state">${state.name}</td>',"</tr>"].join(""),dependencies:["entity-link-icon","entity-link-text"]};return a.register(b)}),define("tau/ui/templates/list/ui.template.list.baseInfo",["tau/core/templates-factory","tau/ui/templates/list/ui.template.list.baseInfo.item"],function(a){var b={name:"request-list",options:{contentSelector:".request-list"},markup:['<div class="ui-base-info-list-content">','<table class="ui-table base-info-list" cellpadding="4" cellspacing="0" {{if items.length === 0}}style="display:none"{{/if}}>',"<tbody>","{{each items}}",'    {{tmpl($value, {index:$index}) "list-base-info-item"}}',"{{/each}}","</tbody>","</table>","</div>"].join(""),dependencies:["list-base-info-item"]};return a.register(b)}),define("tau/ui/extensions/baseList/ui.extension.baseList",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus beforeInit":function(a){var b=a.data.config;this.options={emptyDataMessage:b.emptyDataMessage||"No data",contentSelector:b.contentSelector||null,emptyElementCssClass:b.emptyElementCssClass||"ui-empty-data-msg"}},"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,a.dataBind.data.items.length===0&&this._applyToggleNoData(!0)},"bus hideListContent":function(a){this._applyToggleNoData(!0)},"bus showListContent":function(a){this._applyToggleNoData(!1)},_applyToggleNoData:function(a){this._toggleNoData(a)},_getVisibilityMethodName:function(a){return a?"show":"hide"},_toggleNoData:function(a){var b=this._getVisibilityMethodName(!a),c=this._getVisibilityMethodName(a),d=this.element,e=this.options;d.find(e.contentSelector)[b](),this._getNoDataMessageElement(d,e)[c]()},_getNoDataMessageElement:function(a,b){var c=a.find("."+b.emptyElementCssClass);return c.length===0&&(c=$(['<span class="',b.emptyElementCssClass,'">',b.emptyDataMessage,"</span>"].join("")).appendTo(a)),c}})}),define("tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.related_entity",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a,b){var c={tags:[b],name:"list-grid-entity__row_related_entity",markup:["",'<li class="tau-list__list__item tau-list__list__item-related_entity" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row {{if $item.data.entityState && $item.data.entityState.isFinal}} tau-list__table__row_isfinalstate_true{{/if}}">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','   <a href="#${__type}/${id}"><em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em></a>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','   {{tmpl($item.data) "cell-name"}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-state">','<div runas="property.entityState" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">${entityState.name}</div>',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-date" >','<div runas="property.endDate.list" data-context:general:id="${id}" data-context:general:entity-type:name="${__type}">',"{{if endDate}}","${endDate}","{{/if}}","</div>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-release">','{{if $item.data.hasOwnProperty("release")}}','<div runas="property.release" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-show-url="false" ','{{if __type == "task"}}','data-editable="false" ',"{{else}}",'data-placeholder-text="assign to {{term("release") "name"}}"',"{{/if}}",">","{{if release}}","${release.name}","{{/if}}","</div>","{{/if}}","</td>",'{{if $item.data.hasOwnProperty("iteration")}}','<td class="tau-list__table__cell tau-list__table__cell-iteration">','<div runas="property.iteration" ','data-context:general:id="${id}" ','data-context:general:entity-type:name="${__type}" ','data-show-url="false" ','{{if __type == "task"}}','data-editable="false" ',"{{else}}",'data-placeholder-text="assign to {{term("iteration") "name"}}"',"{{/if}}",">","{{if iteration}}","${iteration.name}","{{/if}}","</div>","</td>","{{/if}}",'<td class="tau-list__table__cell tau-list__table__cell-entityactions">','<button class="action-detach button small" role="action-detach" type="button">Detach</button>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(c)}),define("tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.requester",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"list-grid-entity__row_requester",markup:["",'<li class="tau-list__list__item tau-list__list__item_requester" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="i-item-${id} tau-list__table__row  ">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-avatar">','{{if avatar}}<img src="${avatar}" class="owner-avatar" />{{/if}}',"</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">','<a href="${url}">',"{{if firstName || lastName}}","${firstName} ${lastName}","{{else}}","${email}","{{/if}}","</a>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-email">','<span class="tau-extension-tooltip" title="Email: ${email}">',"${email}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-login">','<span class="tau-extension-tooltip" title="Login: ${login}">',"${login}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-requesteractions">','<button class="action-detach button small" role="action-detach" type="button">Detach</button>',"</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/testcase/ui.template.list.grid.entity.row.testcaserun",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.cell.progress","tau/ui/templates/list_/grid.entity/ui.template.cell.assignments","tau/ui/templates/list_/grid.entity/ui.template.cell.name","tau/ui/templates/assignmentsList/ui.template.assignments.mini","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"list-grid-entity__rowtestcaserun_testcase",markup:["",'<li class="tau-list__list__item tau-list__list__item-testcaserun tau-list__list__item-testcaserun-testcase" role="item">','<table class="tau-list__table">',"<tbody>",'<tr class="tau-list__table__row">','<td class="tau-list__table__cell tau-list__table__cell-dragdrop"  role="sortable-handler" ><div class="dragdrop_indicator"></div></td>','<td class="tau-list__table__cell tau-list__table__cell-id">','<a class="tau-entitylink" href="#testplanrun/${testplanrun.id}" title="${testplanrun.name}">','<em class="ui-type-icon ui-type-icon-testplanrun">${testplanrun.id}</em>',"</a>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-name">',"${testplanrun.name}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-date">','<span class="tau-extension-tooltip" title="Run Date: ${runDate}">',"${runDate}","</span>","</td>",'<td class="tau-list__table__cell tau-list__table__cell-release">',"{{if release}}",'<span class="tau-extension-tooltip" title="Release: ${release.name}">',"${release.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-iteration">',"{{if iteration}}",'<span class="tau-extension-tooltip" title="Iteration: ${iteration.name}">',"${iteration.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-build">',"{{if build}}",'<span class="tau-extension-tooltip" title="Build: ${build.name}">',"${build.name}","</span>","{{/if}}","</td>",'<td class="tau-list__table__cell tau-list__table__cell-laststatus">','<div class="ui-status ',"{{if passed === true}}","ui-status_type_passed green ","{{/if}}","{{if passed === false}}","ui-status_type_failed red ","{{if comment}}tau-extension-tooltip{{/if}}  ","{{/if}}",'{{if passed === null}}ui-status_type_na grey{{/if}}" ',"{{if comment}}",'title="Comment: \n ${comment}"',"{{/if}}",">","{{if runDate !== null}}","{{if passed === true}}","Passed","{{/if}}","{{if passed === false}}","Failed","{{/if}}","{{if passed === null}}","Skipped","{{/if}}","{{/if}}","</div>","</td>","</tr>","</tbody>","</table>","</li>"],dependencies:["ui.template.property.effort.content","ui.template.assignments.mini","cell-progress","cell-assignments","cell-name"]};return a.register(b)}),define("tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity",["tau/core/templates-factory","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.group","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity.row","tau/ui/templates/list_/grid.entity/testplan/ui.template.list.grid.entity.row.testplanrun","tau/ui/templates/list_/grid.entity/testplanrun/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/grid.entity/userstory/ui.template.list.grid.entity.row.testcase","tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.related_entity","tau/ui/templates/list_/grid.entity/request/ui.template.list.grid.entity.row.requester","tau/ui/templates/list_/grid.entity/testcase/ui.template.list.grid.entity.row.testcaserun","tau/ui/templates/list_/ui.template.list.comment"],function(a){var b={name:"list-grid-entity",markup:['<div class="tau-list">',"   {{if isEmpty === true}}",'      <div class="tau-list__empty-message">${config.currentView.emptyMessage}</div>',"   {{else}}",'     <div class="tau-list__content">',"       {{if groups && groups.length}}",'          {{tmpl(groups) "list-grid-entity__group"}}',"       {{/if}}","       {{if items && items.length}}",'           <div class="tau-list__group tau-list__group_flat_true"  role="group">','               <ul class="tau-list__list"  role="list">',"                   {{tmpl(items) $item.data.config.currentView.rowTemplateName }}","               </ul>","           </div>","       {{/if}}","     </div>","   {{/if}}",'   <div class="tau-list__comment-holder">','          {{tmpl({}) "list-grid__comment"}}',"   </div>","</div>"],dependencies:["list-grid-entity__group","list-grid-entity__row","list-grid-entity__rowtestplanrun","list-grid-entity__rowtestcaserun","list-grid-entity__rowtestcase","list-grid-entity__row_related_entity","list-grid-entity__row_requester","list-grid-entity__rowtestcaserun_testcase","list-grid__comment"]};return a.register(b)}),define("tau/ui/extensions/list/extension.list.editable.progress",["tau/components/extensions/component.extension.base"],function(a){return a.extend({name:"extension.list.editable.progress",category:"edit","bus afterRender":function(a){var b=a.data.element;b.addClass("tau-list-editable")}})}),define("tau/models/dataprocessor/model.processor.context",[],function(){function n(a){return _.isUndefined(a)||_.isNull(a)?null:(a.checkPractice=m,a.isPracticeAvailable=m,a.getTimeTrackingPolicies=b,a.getEffortPoint=c,a.getTerms=d,a.getCustomFields=e,a.getPractices=f,a.getEdition=h,a.getProject=g,a.getProjectId=l,a.getProcess=i,a.getLoggedUser=j,a.getProcessId=k,a)}var a=function(a,b){var c=null,d=a.processes[0].practices;for(var e=0;e<d.length;e++)d[e].name.toLowerCase()===b.toLowerCase()&&(c=d[e]);return c},b=function(){var b=a(this.applicationContext,"Time Tracking"),c=!b;return{disableSpentRemain:c}},c=function(b){var c=a(this.applicationContext,"Planning")||{},d=c.effortPoints;b=b||this.entity.entityType.name.toLowerCase();if(b==="task"||b==="request")d="Hour";var e=d.toLowerCase()==="point"?"pt":"h";return{name:d,shortName:e}},d=function(){var a=this.applicationContext;return a&&a.processes&&a.processes.length>0?a.processes[0].terms:[]},e=function(){var a=this.applicationContext;return a&&a.processes&&a.processes.length>0?a.processes[0].customFields:[]},f=function(){var a=this.applicationContext;return a&&a.processes&&a.processes.length>0?a.processes[0].practices:[]},g=function(){var a=this.applicationContext;return a&&a.selectedProjects&&a.selectedProjects.length>0?a.selectedProjects[0]:null},h=function(){var a=this.applicationContext;return a&&a.edition?a.edition:null},i=function(){var a=this.applicationContext;return a&&a.processes&&a.processes.length>0?a.processes[0]:null},j=function(){var a=this.applicationContext;return a&&a.loggedUser?a.loggedUser:null},k=function(){var a=this.applicationContext,b=this.getProcess();return b?b.id:null},l=function(){var a=this.applicationContext,b=this.getProject();return b?b.id:null},m=function(b){return null!==a(this.applicationContext,b)};return n}),define("tau/views/view.compositeControl",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher","tau/models/dataprocessor/model.processor.context"],function(_,$,a,b,c){var d=function(a){return _(a).map(function(a){return"tau/components/component."+a})},e=function(a){var b={},c=_(a).keys();return _(c).each(function(c){var d=c.split(":"),e=null,f=-1,g=d.length,h=b;while(++f<g-1)e=d[f],h.hasOwnProperty(e)||(h[e]={}),h=h[e];var i=d[f];h[i]=a[c]}),b},f=a.extend({name:"view.compositeControl",init:function(a){this._loaded=!1,this._super(a),this.timeoutDescriptor=null},initialize:function(){var a=this;a._super.apply(a,arguments);var b=a.config.dependencies,c=_.size(b)>0&&a.config.visible;if(c){var e=d(b);require(e,a.createComponentTypesCallback(b))}else a.fireDependenciesAreReady({})},createComponentTypesCallback:function(a){var b=this;return b.dependenciesHash={},function(){var c=arguments;_(a).each(function(a,d){b.dependenciesHash[a]=c[d]}),b.fireDependenciesAreReady(b.dependenciesHash)}},fireDependenciesAreReady:function(a){this.fire("dependenciesAreReady",{controlTypes:a})},"bus afterInit+dataBind":function(){},"bus afterInit+dataBind+dependenciesAreReady":function(a){var b=this,c=a.afterInit.data,d=a.dataBind.data,e=a.dependenciesAreReady.data;b.config.visible&&(b._loaded=!0),b.fireBeforeRender({data:d}),b.doRender(d,c.refreshSelector);var f=b.instantiateChildrenComponents(b.element.find("[runas]"),e.controlTypes);b.initializeChildrenComponents(f,d)},createOnAfterRenderCallback:function(a){return function(b){b.removeListener(),a.replaceWith(b.data.element)}},onDestroyCallback:function(a){var b=this,c=a.sender;delete b.children[c.uniqueId]},instantiateChildrenComponents:function(a,b){var c=this,d=[];c.children={};var f=_.bind(c.onDestroyCallback,c);return a.each(function(a,g){var h=$(this),i=h.attr("runas"),j=b.hasOwnProperty(i);if(!j)throw"The component type ["+i+"] not found";var k=b[i],l=k.create({disabledExtensionCategories:c.config.disabledExtensionCategories,context:c.config.context});l.uniqueId=l.uniqueId||_.uniqueId(),l.on("afterRender",c.createOnAfterRenderCallback(h)),l.on("destroy",f);var m={instance:l,config:e(h.data())};c.children[l.uniqueId]=l,d.push(m)}),d},initializeChildrenComponents:function(a,b){var c=this,d=50,e=10,f=function(){var b=a.length;if(b){var g=+(new Date),h=a.splice(0,e),i=h.length;for(var j=0;j<i;j++){var k=h[j];c.fire("createComponentContext",k)}var l=+(new Date),m=l-g,n=m/d;if(Math.abs(1-n)>.3){var o=Math.floor((e+e/n)/2);e=o||1}c.timeoutDescriptor=setTimeout(f,1)}else c.fire("component.ready")};f(),c.fireAfterRender({data:b})},"bus createComponentContext":function(a){var b=this,d=a.data,e=d.config,f=e.context.general;e.context.entity=f,e.context.assignable=f,e.context.applicationContext=b.config.context.applicationContext,c(e.context),b.fire("componentContextCreated",d)},"bus componentContextCreated":function(a){var b=a.data;b.instance.fire("initialize",b.config)},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},destroyChildren:function(){var a=this;clearTimeout(a.timeoutDescriptor),a.dispatcher=null,_(a.children||[]).chain().keys().each(function(b){a.children[b].destroy()}),a.children=null},lifeCycleCleanUp:function(){this.destroyChildren(),this._super()},destroy:function(){this.destroyChildren(),this._super()}});return f}),define("tau/ui/templates/list_/ui.template.list",["tau/core/templates-factory"],function(a){var b={name:"list",markup:['<div class="tau-list">',"</div>"]};return a.register(b)}),define("tau/ui/extensions/list/extension.list.groups",["jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/list_/ui.template.list"],function($,a,b){return a.extend({name:"extension.list.groups","bus afterRender":function(a){var b=this,c=a.data.element;c.delegate("[role=expander]","click",function(a){var c=$(a.target);if(c.is("a")||c.parent("a").length)return;var d=c.parents("[role=group]:first");d.toggleClass("tau-list__group_collapsed_true"),b.bus.fire("toggled")})}})}),define("tau/ui/extensions/list/extension.list.overlay",["tau/components/extensions/component.extension.base"],function(a){return a.extend({name:"extension.list.overlay","bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element.parent()},showOverlay:function(){this.element.tauOverlay()},hideOverlay:function(){this.element.tauOverlay("hide")},"bus beforeInit":function(a){this.element&&this.element.length&&this.showOverlay()},"bus showOverlay":function(a){this.element&&this.element.length&&this.showOverlay()},"bus afterRender":function(a){if(this.element&&this.element.length){var b=this;b.hideOverlay()}}})}),define("libs/jquery/jquery.tau.bubblepopup",["jQuery"],function(jQuery){return function($,a){var b={TOP:"top",BOTTOM:"bottom",AUTO:"auto"},c={CONTENT:a+"-content",PLACEHOLDER:a+"-placeholder",ACTIVE:a+"-active"};$.widget("ui."+a,{options:{content:"",position:b.AUTO},_create:function(){this._createFrame(),this.hide(),this.setContent($(this.options.content)),this.setPosition(this.options.position||b.AUTO),this._initDOM()},_createFrame:function(){var b=$("<div/>").addClass(a),d=$("<div/>").addClass(c.CONTENT);b.append(d),this._$frame=b,this._$contentWrapper=d},show:function(){this.updatePosition(),this.element.addClass(c.ACTIVE),this._trigger("show")},hide:function(){this._trigger("hide"),this.element.removeClass(c.ACTIVE)},setContent:function(a){this._$content=$(a).appendTo(this._$contentWrapper.empty())},getContent:function(){return this._$content},setPosition:function(a){if(this._isValidPosition(a)&&a!=this._$position){var c=this._$position=a;c==b.AUTO&&(c=this._calculatePosition()),this._setPositionMarker(c)}},getPosition:function(){return this._$position},updatePosition:function(){this.getPosition()==b.AUTO&&this._setPositionMarker(this._calculatePosition())},_isValidPosition:function(a){var c=!1;return $.each(b,function(b,d){if(a==d)return c=!0,!1}),c},_setPositionMarker:function(a){var c=$.map(b,function(b){if(b!=a)return b});this._$frame.removeClass(c.join(" ")).addClass(a)},_calculatePosition:function(){var a=$(window).height(),c=this.element.outerHeight(),d=this.element.offset(),e=2*d.top+c<a,f=b.TOP;return e&&(f=b.BOTTOM),f},_initDOM:function(){this.element.addClass(c.PLACEHOLDER).append(this._$frame)},destroy:function(){$.Widget.prototype.destroy.apply(this,arguments),this._$frame.remove(),this.element.removeClass(c.PLACEHOLDER)}})}(jQuery,"taububblepopup"),jQuery}),define("tau/ui/extensions/ui.extension.tooltip",["jQuery","tau/components/extensions/component.extension.base","libs/jquery/jquery.tau.bubblepopup"],function($,a){return a.extend({name:"ui.extension.tooltip",category:"edit","bus afterRender":function(a){var b=this,c=a.data.element,d=$.proxy(b.onMouseEnter,b),e=$.proxy(b.onMouseLeave,b);c.find(".tau-extension-tooltip").mouseenter(d).mouseleave(e)},onMouseEnter:function(a){var b=this,c=$(a.currentTarget),d=c.data("ui.extension.tooltip/title");d||(d=c.prop("title"),c.data("ui.extension.tooltip/title",d),c.prop("title",""));var e=setTimeout(function(){b.isExecuted=!0;var a=c.data("ui.extension.tooltip/title");c.taububblepopup({content:'<div class="tau-tooltip-title">'+a+"</div>"}),c.taububblepopup("show")},500);b.timeOutDescriptor=e},onMouseLeave:function(a){var b=this,c=$(a.currentTarget),d=b.timeOutDescriptor;clearTimeout(d);var e=b.isExecuted;e&&c.taububblepopup("hide"),b.isExecuted=!1}})}),define("tau/ui/extensions/list/extension.list.handleAction",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({name:"extension.list.handleAction",getRowElement:function(a,b){var c=a.find(".i-item-"+b);return c},"bus afterItemsProvided+afterRender+handleGlobalAction":function(a){var b=a.afterItemsProvided.data.data,c=a.handleGlobalAction.data.id,d=_(b).detect(function(a){return a.id==c});if(d){var e=a.afterRender.data.element,f=this.getRowElement(e,c);this.fire("markElementToBeUpdated",{element:f}),this.fire("updateElement",{element:f}),this.fire("refreshMainEntity")}},"bus afterRender+beforeDeleteRow":function(a){var b=a.afterRender.data.element,c=a.beforeDeleteRow.data.id,d=this.getRowElement(b,c);this.fire("markElementToBeDeleted",{element:d}),this.fire("deleteElement",{element:d,callback:$.noop})},"bus afterRender+afterDeleteRow":function(a){var b=this,c=a.afterRender.data.element,d=a.afterDeleteRow.data.id,e=this.getRowElement(c,d);this.fire("deleteElement",{element:e,callback:function(){b.fire("refresh")}})}})}),define("tau/ui/extensions/list/extension.list.handleAction.generator",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){var b=function(a,b){var c=b.split(":"),d=a;return _(c).each(function(a){d=d[a]}),d};return function(c,d){return a.extend({name:"extension.list.handleAction.generator/"+c,init:function(){this._super.apply(this,arguments),this.bus.getGlobalBus().on(c,this.onGlobalAction,this)},destroy:function(){this.bus.getGlobalBus().removeListener(c,this.onGlobalAction,this),this._super.apply(this,arguments)},onGlobalAction:function(a){var c=b(a.data,d);this.fire("handleGlobalAction",{id:c})}})}}),define("tau/models/dataProviders/model.provider.groups.default",["Underscore","tau/models/dataProviders/model.provider.groups.base"],function(_,a){return a.extend({fetch:function(a,b,c){var d=[];if(!a){c(!1);return}_.forEach(b,function(b){var c=_.complexKey(b,a),e=_(d).any(function(a){return a.key===c});e||d.push({key:c,items:[]})}),c(d)}})}),define("tau/models/model.list",["Underscore","tau/core/model-base","tau/models/dataProviders/model.provider.groups.default"],function(_,a,b){var c=a.extend({name:"model.list",onInit:function(){var a=this;a.store.unbind(this);var b=new this.config.itemsDataProvider(this.config);b.fetch(function(b){a.fire("afterItemsProvided",{data:b})})},"bus afterItemsProvided":function(a){var c=this,d=null;this.config.groupsDataProvider?d=this.config.groupsDataProvider:d=b;var e=a.data.data,f=_.isArray(this.config.groupBy)?this.config.groupBy[0]:this.config.groupBy,g=new d(this.config);g.fetch(f,e,function(a){c.fireAfterGroupsProvided(a)})},fireAfterGroupsProvided:function(a){this.fire("afterGroupsProvided",{data:a})},createSubscription:function(a,b){var c=this;c.store.on({eventName:"beforeRemove",type:a,listener:c},function(a){var d=a.data.id;b(d)&&c.fire("beforeDeleteRow",{id:d})}),c.store.on({eventName:"afterRemove",type:a,listener:c},function(a){var d=a.data.id;b(d)&&c.fire("afterDeleteRow",{id:d})})},"bus afterItemsProvided+afterGroupsProvided":function(a){var b=this,c=a.afterItemsProvided.data.data,d=a.afterGroupsProvided.data.data;if(c&&c.length){var e=function(a){return _(c).detect(function(b){return b.id==a})};_(c).chain().map(function(a){return a.__type}).unique().each(function(a){b.createSubscription(a,e)})}var f={items:[],groups:[],isEmpty:c.length?!1:!0};d!==!1?f.groups=this.innerGroupBy(c,d):f.items=c,this.data=f,b.fire("afterDataProvided",{data:f})},"bus afterDataProvided":function(a){var b=this.preProcess(a.data.data);this.fire("preDataBind",b),this.fire("dataBind",b)},preProcess:function(a){var b=this.config.views[0];return _.forEach(a.groups,function(a){a.title||(_.isObject(a.key)?a.title=_.complexKey(a.key,b.group.dataIndex):a.title=a.key)}),a.config={views:this.config.views,currentView:b},a},innerGroupBy:function(a,b){var c=_.isArray(this.config.groupBy)?this.config.groupBy[0]:this.config.groupBy,d=this;return _.forEach(b,function(b){_.forEach(a,function(a){var d=_.complexKey(a,c);_.isArray(b.key)&&_.indexOf(b.key,d)>-1?b.items.push(a):_.isEqual(b.key,d)&&b.items.push(a)})}),b},"bus prioritize.start":function(a){var c=a.data.item,d=a.data.group,e=null;this.config.groupsDataProvider?e=this.config.groupsDataProvider:e=b;var f=new e(this.config),g=_.filter(this.data.groups,function(a){return f.isAvailableForItem(c,a,d)});this.fire("prioritize.updateGroupsAvailability",{groups:g});var h=f.getCommentRequirements(c,this.data.groups,d);this.fire("prioritize.updateGroupsCommentRequirements",{groups:h})}});return c}),define("tau/models/model.list.editable",["Underscore","tau/core/model.editable.base"],function(_,a){var b=a.extend({name:"model.list.editable",category:"edit","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus positionUpdated":function(a){var b=a.data,c=this,d=b.item,e=this.config.store,f=[];b.isCollapsed==0&&f.push(function(a){var d=new c.config.itemsDataProvider(c.config);d.changePriority(b.item,b.prev,b.next,function(b){a(null,b)})}),b.group&&f.push(function(a){var d=new c.config.groupsDataProvider(c.config);d.moveToGroup(b.item,b.group,b.prevGroup,function(b){a(null,b)})}),b.isCollapsed==1?(c.fire("beforeUpdate"),c.fire("showOverlay"),_.parallel(f,function(){c.fire("refresh")})):(c.fire("beforeUpdate"),_.parallel(f,function(a,b){var d={};_.forEach(b,function(a){a&&_.extend(d,a.changed||{})}),c.fire("afterUpdate",{changedItem:d})}))}});return b}),define("tau/views/view.list",["tau/core/view-base"],function(a){return a.extend({name:"view.list","bus initialize":function(a){var b=this.config.views[0];b.type=b.type||"grid";var c=["tau/ui/templates/list_/",b.type,"/ui.template.list.",b.type].join(""),d=this;require([c],function(b){d.config.template=b,d.startLifeCycle(a)})}})}),define("tau/ui/templates/ui.template.lookswitcher",["tau/core/templates-factory"],function(a){var b={name:"ui.lookswitcher",markup:['<div class="ui-lookswitcher tau-look-switcher">','   {{if !loveNewLook }}<a class="ui-lookswitcher-love-link">Always use this awesome UI</a>{{/if}}','   {{if loveNewLook }}<a class="ui-lookswitcher-hate-link">Switch back to the old look</a>{{/if}}',"</div>"],dependencies:[]};return a.register(b)}),define("tau/models/model.menu.actions",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({"bus beforeInit":function(a){var b=a.data.config,c=b.eventNamesCommon||{};_.defaults(c,{dataBind:"dataBind"});var d=c.dataBind,e=b.items,f=[],g=0;_(e).each(function(a){if(a==="-----"){if(g===0)return;g=0}else++g;f.push(a)});var h={items:f};this.bus.fire(d,h)}});return b}),define("tau/ui/behaviour/menu/ui.behaviour.menu.actions",["Underscore","jQuery","tau/core/tau-widget"],function(_,$,a){a.widget("ui.behaviourMenuActions",{_create:function(){this.init()},init:function(){var a=$(this.element);this.$element=a,this.$popup=a.find(".ui-menu__popup");var b=this;this.$items=this.$element.find(".ui-menu__item-action"),this.currentIndex=-1,b.isOpened=!1,this.$element.find(".ui-menu__trigger").click(function(a){b.show()}),this._bindEvents()},show:function(){var a=this;a.$popup.slideToggle(100,function(){a.isOpened=!a.isOpened,a.isOpened?a._mapKeyboard():a._unmapKeyboard()})},_bindEvents:function(){var a=this;a.$items.hover(function(){a.$items.not(this).removeClass("ui-menu__item-action-hover"),$(this).addClass("ui-menu__item-action-hover"),a.currentIndex=a.$items.index(this)},function(){$(this).removeClass("ui-menu__item-action-hover")}),$("body").click(function(b){a.isOpened&&a.close();if($(b.target).parents(".ui-menu:first").length)return})},_mapKeyboard:function(){this.mapper=_.bind(this._keyboardEvents,this),$(document).bind("keydown",this.mapper)},_unmapKeyboard:function(){$(document).unbind("keydown",this.mapper)},_keyboardEvents:function(a){var b=this;switch(a.keyCode){case $.ui.keyCode.ESCAPE:b.close();break;case $.ui.keyCode.DOWN:b.currentIndex++,b.currentIndex=b.currentIndex>=b.$items.length?0:b.currentIndex,b.$items.removeClass("ui-menu__item-action-hover"),b.$items.eq(b.currentIndex).addClass("ui-menu__item-action-hover");break;case $.ui.keyCode.UP:b.currentIndex--,b.currentIndex=b.currentIndex<0?b.$items.length-1:b.currentIndex,b.$items.removeClass("ui-menu__item-action-hover"),b.$items.eq(b.currentIndex).addClass("ui-menu__item-action-hover");break;case $.ui.keyCode.ENTER:var c=b.$items.filter(".ui-menu__item-action-hover");c&&c.trigger("click")}},close:function(){var a=this;this.$popup.slideUp(100,function(){a.isOpened=!1,a._unmapKeyboard()})},destroy:function(){}})}),define("tau/ui/templates/actions/ui.template.moveOrCopy",["tau/core/templates-factory"],function(a){var b={name:"move-or-copy",markup:['<div style="display: none;">','\t<div id="copyActionPopup" style="padding: 10px">','\t\t\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t\t\t<tr>","\t\t\t\t\t\t<td>",'                           <select id="projectSelector">','                               <option value="0" >- Select Project -</option>','                               {{each projects}}<option value="${ID}" >${Name}</option>{{/each}}',"                           </select>","\t\t\t\t\t\t</td>","\t\t\t\t\t\t<td>",'                           <input type="button" value="Copy" class="copy" disabled></button> ',"\t\t\t\t\t\t</td>","\t\t\t\t\t\t<td>",'                           <input type="button" value="Move" class="move" disabled></button> ',"\t\t\t\t\t\t</td>","\t\t\t\t\t</tr>","\t\t\t\t</table>",'\t\t\t\t\t<div style="font-size: 90%">',"\t\t\t\t\t\tCustom fields will be saved only when the entity is copied or moved to a project with the same process","\t\t\t\t\t</div>","\t</div>","</div>"]};return a.register(b)}),define("tau/ui/templates/actions/ui.template.convert",["tau/core/templates-factory"],function(a){var b={name:"convert",markup:['<div style="display: none;">','\t<div id="convertEntityPanel" style="overflow: visible; padding: 10px">','\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t<tr>","\t\t\t\t<td>","\t\t\t\t\tConvert to","\t\t\t\t</td>","\t\t\t\t<td>",'                   <select id="entityType">','                       <option value="0" >- Select New Type -</option>','                       {{each types}}<option value="${ID}" >${Name}</option>{{/each}}',"                   </select>","\t\t\t\t</td>","\t\t\t</tr>","\t\t\t<tr>",'\t\t\t\t<td colspan="2">','\t\t\t\t\t<span style="font-size: 90%">',"\t\t\t\t\t\tCustom fields will be saved only inside the same process and if they have the same name and type in both entities.","\t\t\t\t\t</span>","\t\t\t\t</td>","\t\t\t</tr>","\t\t</table>",'       <div style="" id="pnlLookupUserStory" style="display: none">',"\t\t\tSelect new parent user story:",'\t\t\t<table cellspacing="0" cellpadding="0">',"\t\t\t\t<tbody><tr>","\t\t\t\t\t<td>",'\t\t\t\t\t\t<input type="text" style="display: none;" id="hdnGeneralID">','                       <table cellspacing="0" cellpadding="0">',"                           <tr>","\t\t                        <td>","\t\t                        </td>","\t                        </tr>","\t                        <tr>","\t\t                        <td>",'\t\t\t                        <textarea style="height:16px;width:500px;" class="input" title="Type the beginning of the entity name (at least 2 symbols)" id="txtGeneralsLookup" cols="20" rows="1" ></textarea>',"\t\t                        </td>",'\t\t                        <td>&nbsp;&nbsp;<a id="lnkFind" href="javascript:void(0)">Find</a></td>',"\t                        </tr>","           </table>","\t\t\t\t\t</td>","\t\t\t\t</tr>","\t\t\t</tbody></table>","\t\t</div>",'\t\t<table cellpadding="6" cellspacing="0">',"\t\t\t<tr>","\t\t\t\t<td>",'                   <button type="button" value="Convert" class="convert-btn" disabled="disabled">Convert</button> ',"\t\t\t\t</td>","\t\t\t</tr>","\t\t</table>","\t</div>","</div>"]};return a.register(b)}),define("tau/ui/templates/menu/ui.template.menu.actions",["tau/core/templates-factory","tau/ui/templates/menu/ui.template.menu.actions.item"],function(a){var b={name:"menu-actions",markup:['<div class="ui-menu-actions">','   <span class="ui-menu__trigger">Actions<span class="ui-menu__indicator"></span></span>','   <div class="ui-menu__popup ui-drop-down">','       <div class=" ui-drop-down drop-down-list">','      {{tmpl(items) "menu-actions-item"}}',"       </div>","   </div>","</div>"],dependencies:["menu-actions-item"]};return a.register(b)}),define("tau/ui/templates/menu.testPlanRun/ui.template.menu.testPlanRun",["tau/core/templates-factory"],function(a){var b={name:"menu-testPlanRun",markup:['<div class="tau-menu-testplanrun">',"{{if additionalActions.run.show == true}}",'<a class="tau-action tau-action-run" href="${additionalActions.run.url}"><span class="tau-action__icon"></span>Run</a>',"{{/if}}","{{if additionalActions.newRun.show == true}}",'<a class="tau-action tau-action-newrun" href="${additionalActions.newRun.url}"><span class="tau-action__icon"></span>New Run</a>',"{{/if}}","{{if additionalActions.completeRun.show == true}}",'<a class="tau-action" href="${additionalActions.completeRun.url}">Complete Last Run</a>',"{{/if}}","{{if additionalActions.changeLastRun.show == true}}",'<a class="tau-action" href="${additionalActions.changeLastRun.url}">Change Last Run</a>',"{{/if}}","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/extensions/storeFreeze.extension",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus onConfigContainerCreated":function(a){this.config&&this.config.store&&(this.promise=this.config.store.freeze())},"bus afterInit":function(a){if(!this.promise)return;this.promise.unfreeze(),delete this.promise}})}),define("tau/components/extensions/context.convert.extension",["Underscore","tau/components/extensions/component.extension.base","tau/configurations/converters/converter.context"],function(_,a,b){return a.extend({init:function(a){this._super(a),this.practices=[],this.editions=[]},"bus onConfigContainerCreated":function(a){var c=[],d=[];if(a.data.context){var e=a.data.context,f=this;_.each(e.getPractices(),function(a){c.push(a.name)});var g=e.getEdition();d=g?[g]:[];var h=this.config.context.configurator.isBoardEdition;h&&d.push("board")}var i=a.data;b.convert(i,c,d)}})}),define("tau/components/extensions/extension.storeErrorEmiter",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({"bus beforeInit":function(a){this._super(a);var b=this.config.store,c=this;b.unbind(this),b.on({eventName:"failure",listener:c},function(){c.onFailure.apply(c,arguments)})},onFailure:function(a){var b="Looks like application is not available. Please check your connection or server availability";if(a.data&&a.data.data){a.data.data.Message&&(b=a.data.data.Message);var c=a.data.data.response;if(c){c.Message&&(b=c.Message);if(_.isArray(c)){var d=[c[1]];_.isArray(c[4])&&c[4].length>0&&c[4][0]!=d[0]&&d.push(c[4][0]),b=d.join(":&nbsp;")}c.Error&&c.Error.Message&&(b=c.Error.Message)}}var e=0;a.data&&a.data.data&&(e=a.data.data.status||0),e===500&&window.appIsInDebugMode===!1&&(b="Looks like application is not available. Please check your connection or server availability"),this.fire("error",{message:b}),(e>=400||e===0)&&this.fire("globalFailure");if(a.data&&a.data.cmd){var f=a.data.cmd.name;_.include(["get","find"],f)?e===0&&this.fire("destroy"):this.fire("refresh")}},destroy:function(){this.config.store.unbind(this),this._super()}})}),define("tau/ui/extensions/ui.extension.loading",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({showWaitIcon:function(){var a=$(".ui-wait-icon");a.length===0?(a=$('<div class="ui-wait-icon"></div>'),a.appendTo("body")):a.show()},"bus beforeInit":function(){this.bus.fire("showLoading","reaction on beforeInit")},"bus showLoading":function(){this.showWaitIcon()},"bus hideLoading":function(){$(".ui-wait-icon").hide()},init:function(a){this._super(a)},"bus beforeInit+afterRender+showLoading":function(a){this.bus.fire("hideLoading","hide on after render"),this.element=a.afterRender.data.element},"bus globalFailure":function(){this.bus.fire("hideLoading","hide on global failure"),this.element&&this.element.show()}})}),define("tau/models/boardSettings/model.board.settings",["Underscore","tau/core/class"],function(_,a){var b=function(){},c=function(a,b){var c=new Array(a.length);return function(d){var e=d.uid,f=d.data;c[e]=f,a=_(a).without(e),a.length===0&&b(c)}};return a.extend({init:function(a,b){var c=this;c.settings=a,c.sources=b,c.callbacksMap=[],c.commonCallback=_.bind(function(a){var b=this,c=a.data,d=b.mergeChanges(c);d!==null&&b.applyCallback(d)},c)},applyCallback:function(a){var b=_(a).keys();for(var c=0;c<this.callbacksMap.length;c++){var d=this.callbacksMap[c];this.matchCommandCallback(b,d)&&d.callback.apply(d.listener,[a])}},matchCommandCallback:function(a,b){var c=_.intersection(a,b.fields);return c.length>0},each:function(a,c){if(this.sources.length)_(this.sources).each(a);else{var d=c||b;d()}},mergeChanges:function(a){var b=this,c=b.settings,d=_(a).keys(),e=null;for(var f=0;f<d.length;f++){var g=d[f];c[g]!==a[g]&&(e=e||{},e[g]=c[g]=a[g])}return e},get:function(a){var d=this;_(a).defaults({callback:b});var e=d.settings,f={},g=d.sources,h=_.range(g.length),i=a.fields,j=function(b){_(b).each(function(a){for(var b=0;b<i.length;b++){var c=i[b],d=a[c]!==null?a[c]:e[c];!_.isNaN(d)&&!_.isNull(d)&&!_.isUndefined(d)&&(f[c]=d)}}),_(e).extend(f),a.callback(e)},k=c(h,j);d.each(function(a,b){a.get({uid:b,fields:i,callback:k})},function(){j([])})},set:function(a){var d=this;_(a).defaults({callback:b});var e=d.sources,f=_.range(e.length),g=function(a){},h=c(f,g);d.each(function(b,c){b.set({uid:c,set:a.set,callback:h})},function(){g([])}),d.commonCallback({data:a.set}),a.callback(d.settings)},registerSubscription:function(a){var b=this;return b.callbacksMap.push(a),this.commonCallback},unregisterSubscription:function(a){var b=this;for(var c=b.callbacksMap.length-1;c;c--)b.callbacksMap.splice(c,1)},bind:function(a){var b=this,c=b.registerSubscription(a);b.each(function(d,e){d.bind({uid:e,fields:a.fields,listener:b,callback:c})})},unbind:function(a){var b=this;b.each(function(a){a.unbind({listener:b})}),b.unregisterSubscription(a.listener)},dispose:function(){var a=this;a.each(function(b,c){b.unbind({listener:a})}),a.callbacksMap=[]}})}),define("tau/core/async.source.adapter",["tau/core/class"],function(a){var b=function(a,b){if(!a.hasOwnProperty("uid"))throw"required parameter [uid] is missed in command";var c=a.callback,d=function(b){var d={uid:a.uid,data:b};c(d)};a.callback=d,b(a)};return a.extend({init:function(a){this.proxy=a},get:function(a){return b(a,this.proxy.onGet),this},set:function(a){return b(a,this.proxy.onSet),this},bind:function(a){return b(a,this.proxy.onBind),this},unbind:function(a){return this.proxy.onUnbind(a),this}})}),define("tau/models/boardSettings/factory.board.settings",["Underscore","tau/models/boardSettings/model.board.settings","tau/core/async.source.adapter","tau/storage/api"],function(_,a,b,c){var d=function(a,c){var d=a.getStateManager();return new b({onGet:function(a){d.get({id:c.id,fields:a.fields,callback:a.callback})},onSet:function(a){d.set({id:c.id,set:a.set,callback:a.callback})},onBind:function(a){var b=function(b){var c={};c[b.fieldName]=b.value,a.callback.call(this,c)};d.bind({paramId:c.id,fieldName:a.fields[0],callback:b,listener:a.listener})},onUnbind:function(a){d.unbind(a.listener)}})},e=function(a){var d=new c({service:a.service});return new b({onGet:function(b){d.data(a.groupName,a.id).done(function(a){var c=a.data||{};c=c.userData||{};var d={};for(var e=0;e<b.fields.length;e++){var f=b.fields[e];c.hasOwnProperty(f)&&(d[f]=c[f])}b.callback(d)})},onSet:function(b){var c=b.set;d.data(a.groupName,a.id,{scope:"Public",userData:c}).done(function(a){b.callback(c)})},onBind:function(a){},onUnbind:function(a){}})};return{createInstance:function(b,c){var f=[];c.groupName="boards",c.service=b.getRestStorageService(),f.push(d(b,c)),f.push(e(c));var g=new a(c,f);return g},createComponentSettings:function(b,c){var f=[];c.groupName="settings",c.service=b.getRestStorageService(),f.push(e(c)),f.push(d(b,c));var g=new a(c,f);return g}}}),define("tau/components/extensions/extension.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({init:function(a){this._super.apply(this,arguments),this.bus.getGlobalBus().on("entityWasMovedToProject",this.onEntityWasMovedToProject,this),this.bus.getGlobalBus().on("refreshMainEntity",this.refresh,this)},destroy:function(){this.bus.getGlobalBus().removeListener("entityWasMovedToProject",this.onEntityWasMovedToProject,this),this.bus.getGlobalBus().removeListener("refreshMainEntity",this.refresh,this),this._super.apply(this,arguments)},"bus onContextRetrieved":function(a){var b=a.data,c=this;_.each(b.processes[0].practices,function(a){c.practices.push(a.name)})},onEntityWasMovedToProject:function(a){var b=this.config.entity.id;b==a.data.entity.id&&(this.fire("evictData"),this.fire("refresh"))},refresh:function(){this.fire("evictData"),this.fire("refresh")}})}),define("tau/components/extensions/entity/extension.refresher.project",["Underscore","tau/core/model-base"],function(_,a){return a.extend({onInit:function(){var a=[this.config.entity.type||this.config.context.entityType.name],b=this;b.store.unbind(this),_.forEach(a,function(a){b.store.on({eventName:"beforeSave",type:a,listener:b},function(){b.beforeEntitySave.apply(b,arguments)}),b.store.on({eventName:"afterSave",type:a,listener:b},function(){b.afterEntitySave.apply(b,arguments)})})},"bus contextRetrieved":function(a){this.project=a.data.context.getProject()},beforeEntitySave:function(a){(a.data.changes.userStory||a.data.changes.project)&&a.data.cmd.config.fields.push({project:["id"]})},afterEntitySave:function(a){a.data.changes.project&&(this.fire("evictData"),this.fire("refresh"))}})}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.profile",["tau/core/templates-factory"],function(a){var b={name:"pluginsList-profile",markup:["<ul>",'   <li class="name tau-profileName"><a href="${editUrl}">${name}</a></li>','   <li class="delete"><a class="tau-profile-actions button danger" href=""><span class="delete-icon"></span></a></li>',"</ul>"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.plugin",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.profile"],function(a){var b={name:"pluginsList-plugin",markup:['<div class="plugin-block">','   <img src="${iconSrc}" />','   <h4 class="_pluginName">${name}</h4>','   <p class="note-p">${description}</p>','   <div class="separator"></div>','   <div class="profiles-list">','       <div class="tau-profiles-short">','           {{tmpl(profilesShort) "pluginsList-profile"}}',"       </div>",'       <div class="tau-profiles-more" style="display:none">','           {{tmpl(profilesMore) "pluginsList-profile"}}',"       </div>","   </div>",'   <div class="pb-5 tau-profiles-moreLink" style="display:none">','       <a class="more-link">Show more (${profilesMore.length})</a>',"   </div>",'   <div class="pt-5">','       <button type="button" class="button bold" onClick="window.location.href = \'${newProfileUrl}\';">Add Profile</button>',"   </div>","</div>"],dependencies:["pluginsList-profile"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList.category",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.plugin"],function(a){var b={name:"pluginsList-category",markup:['<div class="plugins-category">','<div class="expanded tau-pluginCategory">','<span class="label">${category}</span>',"</div>",'{{tmpl(plugins) "pluginsList-plugin"}}',"</div>"],dependencies:["pluginsList-plugin"]};return a.register(b)}),define("tau/ui/templates/pluginsList/ui.template.pluginsList",["tau/core/templates-factory","tau/ui/templates/pluginsList/ui.template.pluginsList.category"],function(a){var b={name:"pluginsList",options:{contentSelector:".ui-pluginsList-table"},markup:['<div class="plugins">','   <div class="list">','       <h2 class="h2 icon">Plugins</h2>','       {{tmpl(items) "pluginsList-category"}}',"   </div>","</div>"],dependencies:["pluginsList-category"]};return a.register(b)}),define("tau/ui/templates/common/ui.template.buttonAction",["tau/core/templates-factory"],function(a){var b={name:"button-action",markup:['<a class="button-box ${id}-button user-action button small ${className}"',' role="button">','   <span class="">${title}</span>',"</a>"].join("")};return a.register(b)}),define("tau/ui/templates/print/ui.template.print",["tau/core/templates-factory","tau/ui/templates/common/ui.template.buttonAction"],function(a){var b={name:"print",markup:['<div class="ui-print">','   <div class="ui-print__controls">','       {{tmpl([{id: "x", className: "ui-print__controls__print", title: "Print"}]) "button-action"}}',"   </div>","</div>"],dependencies:["button-action"]};return a.register(b)}),define("tau/views/view.composer",["Underscore","jQuery","tau/core/view-base","tau/core/event-dispatcher"],function(_,$,a,b){var c=a.extend({init:function(a){this._loaded=!1,this._super(a)},initialize:function(){var a=this,b=a.config.children,c=_.size(b)>0&&a.config.visible;if(c){var d=a.config.children,e=a.config.context||{};this.fire("createComponents",{components:d,context:e})}else a._super.apply(a,arguments),a._fireChildrenRendered({children:[],childrenEvtArgs:[]})},"bus componentCreated":function(a){var b=a.data.component;this.fire("childComponentCreated",b)},"bus componentsCreated":function(a){this.fire("beforeComponentsInitialize",a.data),this.initializeChildrenComponents(a),this.fire("afterComponentsInitialize",a.data)},initializeChildrenComponents:function(a){var c=this,d=_(a.data).pluck("component"),e=_(a.data).pluck("config");c.dispatcher=new b(d),c.dispatcher.listen("afterInit",function(a){c.fireAfterInit()}),c.dispatcher.listen("afterRender",function(a){var b=a.argsArr,e={children:d,childrenEvtArgs:b};c._fireChildrenRendered(e)}),_(d).each(function(a,b){a.fire("initialize",e[b])})},_fireChildrenRendered:function(a){this.fire("internalChildrenRendered",a)},"bus afterInit+dataBind":function(a){},"bus afterInit+dataBind+internalChildrenRendered":function(a){this.destroyChildComponents();var b=this,c=a.afterInit.data,d=a.dataBind.data,e=a.internalChildrenRendered.data;b.children=e.children,b.config.visible&&(b._loaded=!0);if(e.children.length===0)b.render(d,c);else{b.fireBeforeRender({data:d});var f=b.bindTemplate(d);f.find("[runas]").each(function(a,b){var c=$(this),d=c.attr("runas"),f=c.attr("componentId"),g=_(e.childrenEvtArgs).detect(function(a,b){var c=a.view.config;return c.type===d&&c.id.toString()===f});if(!g){var i='Component "'+f+'" type of ['+d+"] not found";throw i}var h=g.element;c.replaceWith(h)}),f=b.prepareElement(f),b.fire("childrenRendered",e.children),b.updateElement(f,c.refreshSelector),!b.config.visible&&b.hide(),b.fireAfterRender({data:d})}},"bus show":function(){this._super(),this._loaded||this.fire("initialize",{})},lifeCycleCleanUp:function(){this._super()},destroyChildComponents:function(){delete this.dispatcher;var a=null;if(this.children&&this.children.length)while(a=this.children.pop())a.destroy();delete this.children},destroy:function(){this.destroyChildComponents(),this._super()}});return c}),define("tau/models/model.progressBar",["tau/core/model-base"],function(a){var b=function(a){this.model=a};b.prototype={setEntity:function(a){this.entity=a.data},done:function(){var a=this.model.entity=this.entity;if(!a)return;var b={id:a.id,entityType:{name:a.__type},entityState:{id:a.entityState.id,name:a.entityState.name,isFinal:a.entityState.isFinal},effortCompleted:a.effortCompleted,effortToDo:a.effortToDo,timeSpent:a.timeSpent,timeRemain:a.timeRemain},c=Math.round(100*parseFloat(b.effortToDo)+100*parseFloat(b.effortCompleted))/100;b.percentCompleted=Math.round(1e4*(b.effortCompleted/c))/100,b.percentCompleted=isNaN(b.percentCompleted)?0:b.percentCompleted,b.percentCompleted=b.percentCompleted>100?100:b.percentCompleted,a.entityState.isFinal&&(b.percentCompleted=100),b.disableSpentRemain=this.model.config.context.getTimeTrackingPolicies().disableSpentRemain;var d=this.model.config.maxWidthPercents;_.isUndefined(d)===!1?b.maxWidthPercents=d:b.maxWidthPercents=100,this.model.bus.fire("dataBind",b)}};var c=a.extend({name:"Progress Bar",beforeSaveRoleEffort:function(a){var b=a.data.cmd.config;b.fields=b.fields||[],b.fields.push({assignable:["id","effortCompleted","effortToDo","timeSpent","timeRemain"]})},afterSaveEntity:function(a){var b=a.data;b.changes.hasOwnProperty("timeRemain")&&b.id===this.config.context.entity.id&&this.fire("remainTimeChanged")},afterSaveRoleEffort:function(a){var b=this;b.fire("roleEffortChanged")},onDataUpdated:function(a){var b=this;b.fire("refresh")},onInit:function(){var a=this,c=new b(this),d=this.config.context,e=d.entity.entityType.name,f=d.entity.id,g=["effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isFinal"]}],h=function(b){var c=b.data.cmd.config.fields;b.data.cmd.config.fields=c.concat(g),a.fire("beforeChanges",b.data.changes)},i=function(b){if(a.isInTransaction(b))return;a.fire("applyChanges",b.data.changes)};a.store.unbind(this),a.store.on({eventName:"beforeSave",type:e,filter:{id:d.assignable.id},hasChanges:["entityState"],listener:this},h),a.store.on({eventName:"afterSave",type:e,filter:{id:d.assignable.id},hasChanges:["entityState"],listener:this},i),a.store.on({eventName:"afterSave",type:e,filter:{id:d.assignable.id},hasChanges:["effort|effortCompleted|effortToDo|timeSpent|timeRemain"],listener:a},_.bind(a.onDataUpdated,a)),a.store.on({eventName:"beforeSave",type:"roleEffort",listener:this},function(){a.beforeSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:"roleEffort",filter:{assignable:{id:d.assignable.id}},listener:this},function(b){if(a.isInTransaction(b))return;a.afterSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:e,listener:this},function(){a.afterSaveEntity.apply(a,arguments)}),this.store.get(e,{id:f,fields:g},{success:c.setEntity,scope:c}).done({success:c.done,scope:c})},isInTransaction:function(a){var b=this,c=a.data?a.data.cmd:{};return c===b.lastCmd?!0:(b.lastCmd=c,!1)},"bus evict":function(){var a=this.config.context.general;this.store.evictProperties(a.id,a.entityType.name,["effortCompleted","effortToDo","timeSpent","timeRemain","entityState"])}});return c}),define("tau/models/model.state.editable",["tau/core/model.editable.base"],function(a){return a.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})},"bus beforeSave":function(a){var b=a.data.cmd,c=b.fields||[];c=c.concat(["effortCompleted","effortToDo","timeSpent","timeRemain"]),b.fields=c}})}),define("tau/ui/extensions/progressBar/ui.extension.progressBar.updater",["tau/components/extensions/component.extension.base","tau/ui/behaviour/overlay/ui.behaviour.overlay"],function(a){var b=a.extend({"bus afterRender":function(a){this.$el=a.data.element,this.config.context.getTimeTrackingPolicies().disableSpentRemain&&this.$el.find(".ui-progressbar__data").hide()},"bus roleEffortChanged":function(){this.fire("refresh")},"bus remainTimeChanged":function(){this.fire("refresh")},"bus beforeChanges":function(a){this.$el.tauOverlay()},"bus applyChanges":function(a){this.$el.tauOverlay("hide"),this.fire("refresh")}});return b}),define("tau/ui/templates/progressBar/ui.template.progressBar",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c={name:"progress-bar",tags:[b],markup:['<div class="entity-progress-box">','   <div class="state-select">{{term(entityType.name) "name"}} is','      <div componentId="ctrlEntityState" runas="property.entityState"></div>',"   </div>",'   <div class="ui-progressbar__data">','      <span class="ui-label-spent ui-progressbar__data__spent">Spent&nbsp;<b class="value">${timeSpent}h</b></span>','      <span class="ui-label-remain  ui-progressbar__data__remain">Remain&nbsp;<b class="value">${timeRemain}h</b></span>',"   </div>",'   <div class="ui-progress-bar-progress ui-progressbar__progress">',"{{if percentCompleted !== 0 }}",'      <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${ Math.round(percentCompleted) < 15 ? 15 : Math.round(percentCompleted) }%;">','         <span class="ui-label ui-progressbar__progress__label"><b class="value">${ Math.round(percentCompleted) }%</b></span>',"      </span>","{{/if}}","   </div>","</div>"],dependencies:["common-attributeValue"]};return a.register(c)}),define("tau/ui/templates/progressBar/ui.template.progressBar.small",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.attributeValue"],function(a,b){var c=["{{if disableSpentRemain === false}}","Time spent: ${timeSpent}{{if timeSpent}}h{{/if}}  ","Time remain: {{if !timeRemain && timeRemain !== 0}}N/A{{else}}${timeRemain}{{if timeRemain}}h{{/if}}{{/if}}  ","{{/if}}","Percent complete: ${Math.round(percentCompleted)}%"].join(""),d={name:"progress-bar-small",tags:[b],markup:["<div>","{{if maxWidthPercents > 0}}",'    <div class="ui-progress-bar-progress ui-progressbar__progress tau-extension-tooltip" style="width:${maxWidthPercents}%;" title="'+c+'">','        <span class="ui-progress-progress ui-progressbar__progress__indicator" style="width:${percentCompleted}%;{{if percentCompleted == 0}}display:none;{{/if}}"></span>',"    </div>","{{else}}",'   <div{{if maxWidthPercents == 0}} class="tau-extension-tooltip" title="'+c+'"{{/if}}>',"   </div>","{{/if}}","</div>"]};return a.register(d)}),define("tau/models/model.property.simple",["tau/core/model-base"],function(a){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName,this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},listenOfPropertyChanged:function(){var a=this.config.context.entity.id;this.listenedEntities[a]||(this.listenedEntities[a]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onInit:function(){this.listenOfPropertyChanged(),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.onEntityRetrieved,scope:this})},onEntityRetrieved:function(a){var b=a[0].data[this.propertyName]||this.config.defaultText;this.fire("dataBind",{name:this.propertyName,text:b})}})}),define("tau/models/model.property.text",["tau/models/model.property.simple"],function(a,b){return a.extend({})}),define("tau/models/model.property.text.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable})}})}),define("tau/models/model.property.text.validation",["tau/core/model-base","tau/utils/utils.jsonSchema"],function(a,b,c){var d=a.extend({category:"edit",name:"Model text validation",schema:b.Schema.create({type:"string",optional:!1,empty:!1,maxLength:50,minLength:0,pre:["trim"]}),"bus afterRender":function(a){this.$element=a.data.element},"bus validate":function(a){this.$element.find(".property-text").dateEditor("resetValidationErrors");var b=a.data,c=b.cmd.$set[this.config.propertyName];b.validation=this.schema.validate(c);if(!b.validation||b.validation.isError()!=1)b.validation=this.schema.validate(c),b.cmd.$set[this.config.propertyName]=b.validation.instance},"bus afterValidate":function(a){var b=a.data.validation;this.$element.find(".property-text").editableText("setValue",b.instance)},"bus validationFailed":function(a){var b=a.data.validation;this.$element.find(".property-text").editableText("setValidationErrors",b.errors[0].description)}});return d}),define("tau/models/model.property.abbreviation.validation",["tau/models/model.property.text.validation","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",schema:b.Schema.create({type:"string",optional:!0,empty:!0,maxLength:3,pre:["trim"],post:[function(a){return(a+"").toUpperCase()},function(a){var b=/^[\dа-яa-z]{1,3}$/i;return a.match(b)||new this.Error("Abbr","Should contain letters or digits"),a}]})});return c}),define("tau/components/extensions/property/extension.property.text.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=this.permissions=a.permissionsReady.data;if(d.editable){var e=this.$el=a.afterRender.data.element,f=e.find(".property-text");b.$widget=f,f.editableText({restoreText:!1,onSave:function(a){var c={};c[b.config.propertyName]=a;var d={$set:c};d.$include=[b.config.propertyName],b.bus.fire("save",d)}})}},"bus edit":function(){this.permissions.editable&&this.$el.find(".property-text").editableText("activate")}})}),define("tau/components/extensions/property/extension.property.refresher",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({category:"refresher","bus propertyChanged":function(){this.fire("refresh")}})}),define("tau/ui/templates/property/ui.template.property",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink.full"],function(a){var b={name:"property",markup:["<div>",'<span class="property tau-property{{if name}} tau-property-${name}{{/if}}{{if !text}} tau-property_empty_true{{/if}}">',"{{if hasUrl}}",'<span class="property-text tau-property__value" data-placeholder="${placeholderText}">','{{tmpl($data) "entity-link-full"}}',"</span>","{{else}}",'<span class="property-text tau-property__value" data-placeholder="${placeholderText}">${text}</span>',"{{/if}}","</span>","{{if subtext}}",'<div class="tau-property__subtext">${subtext}</div>',"{{/if}}","</div>"].join(""),dependencies:["entity-link-full"]};return a.register(b)}),define("tau/models/finder/model.relation.editor",["Underscore","tau/core/model.editable.base"],function(_,a){return a.extend({"bus entitySelected":function(a){var b={};b[this.config.propertyName]=null;var c=a.data.entity;c&&c.id&&(b[this.config.propertyName]={id:c.id});var d=this.config.context;this.config.store.evictProperties(d.entity.id,d.entity.entityType.name,[this.config.propertyName]),this.fire("save",{$set:b})}})}),define("tau/models/model.property.bool",["tau/core/model-base"],function(a){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},onInit:function(){this.store.unbind(this),this.attachToChangePropertiesOfCurrentEntity(this.propertyName),this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",this.propertyName]}).done({success:this.onEntityRetrieved,scope:this})},onEntityRetrieved:function(a){var b=a[0].data,c={value:b[this.propertyName]};this.fire("dataBind",c)}})}),define("tau/models/model.property.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus beforeInit+dataBind":function(a){this.fire("permissionsReady",{editable:this.config.editable!=0})}})}),define("tau/components/extensions/property/extension.property.bool.editable",["Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/checkbox/ui.behaviour.checkboxToggle"],function(_,a){return a.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element;a.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var d=this.permissions=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=c.find(".property .ui-checkbox");f.checkboxToggle({classNames:{checked:"checked",unchecked:"unchecked"},onSave:function(a){b.bus.fire("elementUpdated");var c={};c[b.config.propertyName]=a,b.bus.fire("save",c)}})}},"bus edit":function(){this.permissions.editable&&this.element.find(".property .ui-checkbox").checkboxToggle("toggle")}})}),define("tau/ui/templates/property/ui.template.bool",["tau/core/templates-factory"],function(a){var b={name:"property-bool",markup:['<div><span class="property"><div class="ui-checkbox {{if value}}checked{{/if}}{{if !value}}unchecked{{/if}}">&nbsp;</div></span></div>'].join("")};return a.register(b)}),define("tau/models/finder/model.build.search",["Underscore","tau/models/finder/model.assignable.search"],function(_,a){return a.extend({init:function(a){this._super(a),delete this.properties.state,delete this.properties.priority},setInitialLimits:function(a){this.initialLimits=a},getInitialQueryConfig:function(){return{$skip:0,$limit:20,$query:{}}},getInitialQueryString:function(){return""},getType:function(){return"build"},"bus requireSearchConfig":function(a){var b=this,c=a.data.project,d=this.config.context.entity;this.config.store.get(d.entityType.name,{id:d.id,fields:["id",{project:["id"]}]}).done({success:function(a){var c=a[0].data,d={"Project.Id":null};c.project&&(d["Project.Id"]=c.project.id),b.setInitialLimits(d);var e={$skip:0,$limit:20,$query:d},f=b.getInitialQueryString();b.fire("searchConfigFormed",{type:b.getType(),config:e,properties:b.properties,searchQuery:f})}})},"bus search":function(a){var b=a.data,c=this,d=b.collection,e={};_.each(d,function(a){var b=c.properties[a.property];if(!b)return;var d=b.name?b.name:a.property;b.statement(e,d,a.value)}),e=_.extend(e,this.initialLimits),c.bus.fire("newSearchQuery",{type:c.getType(),config:{$query:e,$skip:0,$limit:20}})}})}),define("tau/components/extensions/property/extension.property.build.refresher",["Underscore","tau/core/model-base"],function(_,a,b){return a.extend({category:"refresher","bus afterInit":function(){var a=this.store,b=this.config.context.entity,c=this;this.store.unbind(this),a.on({eventName:"afterSave",type:"testplanrun",listener:this,filter:{id:b.id}},function(a){var b=a.data.changes;(b.hasOwnProperty("release")||b.hasOwnProperty("iteration"))&&c.bus.fire("refresh")})}})}),define("tau/models/finder/model.build.testPlanRun.search",["Underscore","tau/models/finder/model.build.search"],function(_,a){return a.extend({"bus requireSearchConfig":function(a){var b=this,c=a.data.project,d=this.config.context.entity;this.config.store.get("testPlanRun",{id:d.id,fields:["id",{project:["id",{process:["id",{practices:["id","name"]}]}]},{release:["id"]},{iteration:["id"]}]}).done({success:function(a){var c=a[0].data,d=c.project.process.practices,e=_.any(d,function(a){return a.name.toLowerCase()=="iterations"}),f={"Project.Id":null,"Release.Id":null};c.project&&(f["Project.Id"]=c.project.id),c.release&&(f["Release.Id"]=c.release.id),c.iteration&&e==1&&(f["Iteration.Id"]=c.iteration.id),b.setInitialLimits(f);var g={$skip:0,$limit:20,$query:f},h=b.getInitialQueryString();b.fire("searchConfigFormed",{type:b.getType(),config:g,properties:b.properties,searchQuery:h})}})}})}),define("tau/ui/templates/property/ui.template.property.date",["tau/core/templates-factory"],function(a){var b={name:"property-date",markup:'<div><div class="property"><div class="property-text">${text}</div></div>'};return a.register(b)}),define("tau/models/model.property.effort",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;a.store.unbind(a),a.store.on(a.getSubscriptionConfig("afterSave"),_.bind(a.onEntityAfterSave,a)),a.store.on(a.getSubscriptionConfig("beforeSave"),_.bind(a.onEntityBeforeSave,a)),a.store.get(c,{id:d,fields:["id","effort",{roleEfforts:["id",{role:["id","hasEffort"]}]}]}).done({scope:a,success:a.done})},done:function(a){var b=this,c=a[0].data,d=b.config.context,e=d.entity.entityType.name,f={id:c.id,effort:Math.round(100*c.effort)/100,unit:d.getEffortPoint(e),roleEfforts:c.roleEfforts};b.fire("dataBind",f)},getSubscriptionConfig:function(a){var b=this,c=b.config.context.entity;return{eventName:a,type:"roleEffort",listener:b,filter:{assignable:{id:c.id}},hasChanges:["effort"]}},onEntityAfterSave:function(a){this.fire("propertyChanged")},onEntityBeforeSave:function(a){this.fire("beforeChangeProperty")}});return b}),define("tau/models/model.property.effort.editable",["tau/core/model.editable.base","Underscore"],function(a,_){var b=a.extend({name:"Effort Editable","bus beforeInit+dataBind":function(){var a=this,b={editable:!0};this.fire("permissionsReady",b)}});return b}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList",["tau/core/templates-factory"],function(a){var b={name:"ui.template.assignments.effortsOnly.effortsList",markup:["{{if roleEffort}}",'<tr class="tau-row group" roleId="${role.id}">',"   <td><span>${role.name}</span></td>",'   <td class="tau-cell-role-effort-value role-effort"><div class="effort">${roleEffort.effort}<span class="point">${$item.effortPoints}</span></div></td>',"</tr>","{{/if}}"].join(""),dependencies:[]};return a.register(b)}),define("tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly",["tau/core/templates-factory","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly.effortsList"],function(a){var b={name:"ui.template.assignments.effortsOnly",markup:['<table class="assignments-table-readonly tau-assignments-effort-only">','   <tr class="tau-header-row tau-row-delimiter">','       <td class="tau-header-cell-title"></td>','       <td class="tau-header-cell-value">Effort</td>',"    </tr>",'   {{tmpl(assignments.groups, {effortPoints: effortPoints}) "ui.template.assignments.effortsOnly.effortsList"}}',"{{if tasksEffort}}",'   <tr class="tau-footer-row tau-row-delimiter">',"       <td>Tasks</td>","       <td>${tasksEffort.effort} h</td>","   </tr>","{{/if}}",'   <tr class="tau-footer-row tau-footer-row-total">',"       <td>Total</td>","       <td><span>${totalEffort.effort} ${effortPoints}</span></td>","   </tr>","</table>"].join(""),dependencies:["ui.template.assignments.effortsOnly.effortsList"]};return a.register(b)}),define("tau/ui/extensions/effort/extension.effort.editable",["tau/components/extensions/component.extension.base","tau/ui/templates/assignmentsList/ui.template.assignments.effortsOnly","tau/ui/behaviour/common/ui.behaviour.editableText"],function(a,b){return a.extend({category:"edit",normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},"bus afterRender+beforeChangeProperty":function(a){var b=a.afterRender.data.element;this.fire("markElementToBeUpdated",{element:b})},"bus propertyChanged":function(a){this.fire("refresh")},"bus refresh+afterRender":function(a){var b=a.afterRender.data.element;this.fire("updateElement",{element:b})},hasEffortIterator:function(a){return a.role.hasEffort},"bus permissionsReady+dataBind+afterRender":function(a){var c=this,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f=_(e.roleEfforts).chain().select(c.hasEffortIterator).size().value();d.editMode="disabled",f&&(d.editMode=f===1&&c.config.entitiesCount==0?"inline":"roleEfforts");var g=a.afterRender.data.element,h=g.find(".entity-effort");if(d.editMode==="inline")h.editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(a){var b=c.normalizeEffort(a),d=_(e.roleEfforts).detect(c.hasEffortIterator),f={typeName:"roleEffort",id:d.id,$set:{effort:b}};c.bus.fire("save",f)},onEditStart:function(){c._$additionalInfo=h.find(".entity-effort-info").detach()},onEditEnd:function(){c._$additionalInfo.appendTo(h)}});else if(d.editMode==="roleEfforts"){var i={components:[{type:"assignmentsList",template:b}],context:c.config.context},j={target:h,componentsConfig:i};c.fire("initBubble",j)}}}})}),define("tau/ui/templates/property.effort/ui.template.property.effort",["tau/core/templates-factory","tau/ui/templates/property.effort/ui.template.property.effort.content"],function(a){var b={name:"ui.template.property.effort",markup:['<div class="tau-property">{{tmpl($item.data) "ui.template.property.effort.content"}}</div>'],dependencies:["ui.template.property.effort.content"]};return a.register(b)}),define("tau/models/model.property.email.validation",["tau/models/model.property.text.validation","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",schema:b.Schema.create({type:"string",optional:!0,empty:!0,pre:["trim"],post:[function(a){var b=/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;return a.match(b)||new this.Error("Email","Provide a valid email address"),a}]})});return c}),define("tau/ui/templates/property/ui.template.property.endDate.list",["tau/core/templates-factory"],function(a){var b={name:"property-endDate-list",markup:['<span><span class="tau-extension-tooltip" title="Completion date: ${text}">',"${text}","</span>","</span>"].join("")};return a.register(b)}),define("tau/models/model.property.entityState",["tau/core/model-base","Underscore"],function(a,_){var b=function(a){this.model=a};b.prototype={done:function(a){var b=a[0].data.entityState;this.model.fire("dataBind",b)}};var c=a.extend({onInit:function(){var a=this,c=new b(this),d=this.config.context,e=d.entity.entityType.name,f=d.entity.id,g=[{entityState:["id","name","isFinal","isCommentRequired",{nextStates:["id"]}]}],h=function(b){var c=b.data.changes,d=b.data.cmd.config.fields;b.data.cmd.config.fields=_.union(d,g),a.fire("beforeChanges",c),a.fire("beforeChangeProperty")},i=function(b){a.fire("applyChanges",b.data.changes),a.fire("propertyChanged")};a.store.unbind(a),a.store.on({eventName:"beforeSave",type:e,hasChanges:["entityState"],listener:this},h),a.store.on({eventName:"afterSave",type:e,hasChanges:["entityState"],listener:this},i),this.store.get(e,{id:f,fields:g},{success:c.setEntity,scope:c}).done({success:c.done,scope:c})}});return c}),define("tau/models/model.property.entityState.editable",["tau/core/model.editable.base"],function(a){return a.extend({name:"Entity state editable","bus dataBind":function(){this.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/entityState/extension.entityState.editable",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus prepareChanges":function(a){this.bus.fire("markElementToBeUpdated",{element:this.element})},"bus applyChanges":function(a){var b=this;this.bus.on("afterRender",function(a){a.removeListener(),b.bus.fire("updateElement",{element:b.element})}),this.bus.fire("refresh")},"bus ownerChanged":function(){this.fire("refresh")},"bus beforeChangeOwner":function(){this.fire("markElementToBeUpdated",{element:this.element})},"bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element,d=a.permissionsReady.data,e=a.dataBind.data;if(e.nextStates.length>0&&d.editable){var f={components:[{type:"entityStateList",data:e}],context:b.config.context},g={target:c,componentsConfig:f,alignTo:c.find(".attr-name")};this.fire("initBubble",g)}this.bus.on("edit",function(){this.fire("toggleBubble")},this)}})}),define("tau/models/finder/model.feature.search",["Underscore","tau/models/finder/model.assignable.search"],function(_,a){return a.extend({init:function(a){this._super(a),this.properties.state.filter=function(a){return a?a.dataItem?a.dataItem.entityType.id===9:!0:!0}},getType:function(){return"feature"}})}),define("tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({extractDataFromEvent:function(a,b){return(a[b]||{}).data||{}},"bus afterRender+dataBind":function(a){var b=this.extractDataFromEvent(a,"dataBind"),c=$(this.extractDataFromEvent(a,"afterRender").element),d=$(['<span class="ui-days-passed">(<span class="days-count">',b.daysPassed,"</span> days passed)</span>"].join(""));c.find(".property").parent().append(d)}})}),define("tau/components/extensions/property/extension.property.editable",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){return a.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element;a.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var d=this.permissions=a.permissionsReady.data;if(d.editable===!1)return;c.find(".tau-property").addClass("tau-property_editable_true");var e=a.dataBind.data;(!e.text||!e.text.length)&&c.find(".property").addClass("editable");if(d.editable){var f={components:[_.extend({data:e,v2:!0},this.config.editorComponentConfig)],context:b.config.context},g={target:c.find(".property-text"),componentsConfig:f,alignTo:c.find(this.config.alignElementSelector||"")};this.fire("initBubble",g)}},"bus edit":function(){this.permissions.editable&&this.fire("toggleBubble")}})}),define("tau/ui/templates/property/ui.template.property.lastRunDate.list",["tau/core/templates-factory"],function(a){var b={name:"property-lastRunDate-list",markup:'<div><div class="property tau-extension-tooltip" title="Run Date: ${text}"><div class="property-text">${text}</div></div>'};return a.register(b)}),define("tau/ui/templates/property/ui.template.property.status",["tau/core/templates-factory"],function(a){var b={name:"property-last-status",markup:["<div>",'   <div class="ui-status {{if value === true}}ui-status_type_passed green{{/if}}{{if value === false}}ui-status_type_failed red{{/if}}{{if value === null}}ui-status_type_na grey{{/if}}">',"   {{if value === true}}","       Passed","   {{/if}}","   {{if value === false}}","       Failed","   {{/if}}","</div>","</div>"].join("")};return a.register(b)}),define("tau/ui/templates/common/ui.template.owner",["tau/core/templates-factory","tau/ui/templates/common/ui.template.userName"],function(a){return a.register({name:"owner",markup:["<table class='owner' userId='${id}'><tr>","<td class='owner-avatar-container'>","{{if avatar}}<img role='avatar' src='${avatar}' class='owner-avatar'/>{{/if}}","</td>","<td class='owner-info'>","   {{tmpl 'user-name'}}","</td>","</tr></table>"].join(""),dependencies:["user-name"]})}),define("tau/components/extensions/user/extension.user.editable",["tau/components/extensions/component.extension.base"],function(a){return a.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.element=a.afterRender.data.element,d=a.permissionsReady.data,e=a.dataBind.data;if(d.editable){var f={type:"userList",data:e,extensions:this.getExtensions(),v2:!0};this.extendEditorConfig(f);var g={components:[f],context:b.config.context},h={target:c,componentsConfig:g,alignTo:c.find(".user-name")};this.fire("initBubble",h)}this._toggle&&this.bus.removeListener("edit",this._toggle,this),this._toggle=function(){b.fire("toggleBubble")},this.bus.on("edit",this._toggle,this)},extendEditorConfig:function(){},getExtensions:function(){return[]}})}),define("tau/models/userList/extension.model.user.Excluder",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b=["id","firstName","lastName"],c={};c[this.getUserPropertyName()]=b,this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[c]},callback:{scope:this,success:this.onEntityRetrieved}})},getUserPropertyName:function(){throw"Use Excluder getUserPropertyName should be ovveriden"},onEntityRetrieved:function(a){var b=a.data||{},c=[b[this.getUserPropertyName()]];this.fire("excludedUserReady",c)}})}),define("tau/models/userList/extension.model.owner.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(_,a){return a.extend({getUserPropertyName:function(){return"owner"}})}),define("tau/models/extensions/team/extension.model.allUserRetriever",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus registerStoreRequest":function(){var a=this;this.store.get("user",{fields:["id","firstName","lastName","isActive","deleteDate",{role:["id","name"]}]}).done({success:function(b){var c=b[0].data,d={},e=[];c=_.filter(c,function(a){return a.deleteDate===null}),_.forEach(c,function(a){var b=a.role;b&&(d[b.id]=b),e.push({user:a,role:b})}),a.fire("projectMembersReady",e),a.fire("projectRolesReady",_.values(d))}})}})}),define("tau/models/extensions/team/extension.model.requestOwners.retriever",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity,b=this.config.store,c=this;b.get(a.entityType.name,{id:a.id,fields:[{project:["id",{projectMembers:[{user:["id","firstName","lastName","email","isActive","deleteDate"]},{role:["id","name"]}]}]}]}).done({success:function(a){var b=a[0].data.project.projectMembers;c.fire("members.provided",b)}}),b.get(a.entityType.name,{id:a.id,fields:[{requesters:["id","firstName","lastName","email","isActive","deleteDate","kind"]}]}).done({success:function(a){var b=a[0].data.requesters;c.fire("requesters.provided",b)}})},"bus members.provided+requesters.provided":function(a){var b=a["members.provided"].data,c=a["requesters.provided"].data,d=_.pluck(c,"id");b=_.reject(b,function(a){return _.indexOf(d,a.user.id)>-1}),_.forEach(c,function(a){b.unshift({role:{id:0,name:"Requesters"},user:a})}),b=_.filter(b,function(a){return a.user.deleteDate===null});var e=[];_.forEach(b,function(a){var b=a.role;b&&e.push(b),a.username=a.email;if(a.firstName||a.lastName)a.username=_.trim([a.firstName,a.lastName].join(" "))}),e=_.uniq(e,!1,function(a){return a.id}),this.fire("projectMembersReady",b),this.fire("projectRolesReady",e)}})}),define("tau/models/userList/extension.model.responsible.Excluder",["Underscore","tau/models/userList/extension.model.user.Excluder"],function(_,a){return a.extend({getUserPropertyName:function(){return"responsible"}})}),define("tau/ui/templates/property/ui.template.property.severity",["tau/core/templates-factory"],function(a){var b={name:"property-severity",markup:["<div>",'   <span class="property  tau-list-severity-${kind}">','       <span class="property-text">${text}</span>',"   </span>","</div>"].join(""),dependencies:[]};return a.register(b)}),define("tau/ui/templates/property/ui.template.property.status.testCaseRun",["tau/core/templates-factory"],function(a){var b={name:"property-last-status-testcaserun",markup:["<div>",'   <div class="ui-status {{if value === true}}ui-status_type_passed green{{/if}}{{if value === false}}ui-status_type_failed red{{/if}}{{if value === null}}ui-status_type_na grey{{/if}}">',"   {{if value === true}}","       Passed","   {{/if}}","   {{if value === false}}","       Failed","   {{/if}}","   {{if value === null}}","       Skipped","   {{/if}}","</div>","</div>"].join("")};return a.register(b)}),define("tau/models/model.property.time",["tau/models/model.property.simple"],function(a){return a.extend({floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onEntityRetrieved:function(a){var b=a[0].data[this.propertyName],c={text:this.floatToString(b),point:this._getEffortPoints()};this.fire("dataBind",c)}})}),define("tau/models/model.property.time.editable",["tau/core/model.editable.base"],function(a){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/ui/templates/property/ui.template.property.time",["tau/core/templates-factory"],function(a){var b={name:"property-time",markup:["<div>",'   <div class="property"><div class="property-text">${text}<span class="point">${point}</span></div></div>',"</div>"].join("")};return a.register(b)}),define("tau/models/finder/model.userStory.search",["Underscore","tau/models/finder/model.assignable.search"],function(_,a){return a.extend({init:function(a){this._super(a);var b=function(a,b,c){a[b]={name:{$contains:c}}};this.properties.feature={label:this.terms.resolve("feature"),autoCompletable:!1,statement:b},this.properties.state.filter=function(a){return a?a.dataItem?a.dataItem.entityType.id===4:!0:!0}},getType:function(){return"userStory"}})}),define("tau/ui/templates/quick.add/ui.template.quick.add",["tau/core/templates-factory"],function(a){var b={name:"quick.add",markup:['<div class="ui-quick-add">','<span class="ui-link ui-quick-add-link">${label}</span>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/quick.add/ui.template.quick.add.content",["tau/core/templates-factory"],function(a){var b={name:"quick.add.content",markup:['<div class="ui-quick-add-stats"></div>','<div class="ui-quick-add-content">','<div class="quick-add-lines">',"</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/quick.add/ui.template.quick.add.line",["tau/core/templates-factory"],function(a){var b={name:"quick.add.line",markup:['<div class="ui-quick-add-line">',' <div class="quick-add-input ui-quick-add-new-item"></div>',"</div>"],dependencies:[]};return a.register(b)}),define("tau/models/model.release.progressBar",["Underscore","tau/core/model-base"],function(_,a){var b=a.extend({name:"Iteration Progress Bar",afterSaveRoleEffort:function(a){var b=this;b.fire("roleEffortChanged")},onDataUpdate:function(a){var b=this;b.fire("refresh")},floatToString:function(a){return a.toFixed(2).replace(".00","")},_getEffortPoints:function(){return this.config.context.getEffortPoint().shortName},onInit:function(){var a=this,b=this.config.context,c=b.entity.entityType.name,d=b.entity.id,e=["bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum",{features:["effortToDo","effortCompleted","userStories-count"]}];a.store.unbind(a),a.store.on({eventName:"afterSave",type:"roleEffort",listener:a,filter:{assignable:{id:d}}},_.bind(a.afterSaveRoleEffort,a)),a.store.on({eventName:"afterSave",type:c,listener:a,filter:{id:d},hasChanges:[e.join("|")]},_.bind(a.onDataUpdate,a)),a.store.get(c,{id:d,fields:e},{success:a.onEntityRetrieved,scope:a}).done({success:a.done,scope:a})},onEntityRetrieved:function(a){var b=a.data,c=function(a){return a["userStories-count"]==0},d=a.data.features,e=_.filter(d,c),f=_.pluck(e,"effortToDo"),g=_.pluck(e,"effortCompleted"),h=function(a){return _.reduce(a,function(a,b){return a+b},0)},i=b["bugs-effortToDo-sum"]+b["userStories-effortToDo-sum"]+h(f),j=b["bugs-effortCompleted-sum"]+b["userStories-effortCompleted-sum"]+h(g),k=Math.round(100*parseFloat(i)+100*parseFloat(j))/100,l=Math.round(1e4*(j/k))/100;l=isNaN(l)?0:l,l=l>100?100:l,this.effortToDo=i,this.effortCompleted=j,this.percentCompleted=l},done:function(){this.fire("dataBind",{effortToDo:this.floatToString(this.effortToDo),effortCompleted:this.floatToString(this.effortCompleted),percentCompleted:this.percentCompleted,totalEffort:this.floatToString(this.effortToDo+this.effortCompleted),point:this._getEffortPoints()})}});return b}),define("tau/ui/templates/releaseNotes/ui.template.releaseNotes",["tau/core/templates-factory"],function(a){var b={name:"releaseNotes",markup:['<div class="tau-releaseNotes">','<div class="tau-releaseNotes__inner">','<span class="tau-releaseNotes__title">${item.name} / ${item.endDate}</span><br />',"----------------------------------------------------------<br /><br />","{{if features.length || userStories.length}}",'<div class="tau-releaseNotes__subtitle">Added features</div><br /><br />',"{{each features}}",'<div class="tau-releaseNotes__feature" data-name="${name}">',"- ${name}<br />","{{each userStories}}",'<div class="tau-releaseNotes__userstory" data-name="${name}">',"&nbsp;&nbsp;&nbsp;&nbsp;- ${name}<br />","</div>","{{/each}}","</div>","{{/each}}","{{each userStories}}",'<div class="tau-releaseNotes__userstory tau-releaseNotes__userstory_separate_true" data-name="${name}">',"- ${name}<br />","</div>","{{/each}}","<br /><br />","{{/if}}","{{if bugs.length}}",'<div class="tau-releaseNotes__subtitle">Fixed Bugs</div><br /><br />',"{{each bugs}}",'<div class="tau-releaseNotes__bug" data-name="${name}">',"#${id} ${name}<br />","</div>","{{/each}}","{{/if}}","</div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/ui/extensions/testCaseList/ui.extension.testCaseList",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=this;b.element=a.data.element,b.element.find("tbody .extra-info").click(function(){b._onButtonClick.call(b,this)}),b.element.find("thead .extra-info.expand").click(function(){b.expandAll()}),b.element.find("thead .extra-info.collapse").click(function(){b.collapseAll()})},"bus expandTestCase":function(a){var b=a.data.testCaseId;this.element.find("tbody.collapsed").each(function(){$(this).tmplItem().data.id==b&&$(this).removeClass("collapsed").find(".extra-info").removeClass("expand").addClass("collapse")})},expandAll:function(){this.element.find("tbody.collapsed").removeClass("collapsed"),this._changeButtonsState("expand","collapse","-")},collapseAll:function(){this.element.find("tbody:not(.collapsed)").addClass("collapsed"),this._changeButtonsState("collapse","expand","+")},_changeButtonsState:function(a,b,c){var d="tbody .extra-info."+a,e=function(){$(this).addClass(b).removeClass(a).children("div").text(c)};this.element.find(d).each(e)},_onButtonClick:function(a){$(a).toggleClass("collapse").toggleClass("expand").parents("tbody").toggleClass("collapsed");var b=$(a).children("div"),c=b.text();c=="+"?c="-":c="+",b.text(c)}})}),define("tp/gateway",["libs/jquery/jquery"],function($){function a(){}return a.prototype={postJSON:function(a,b,c,d,e){$.ajax({url:a,data:b?JSON.stringify(b):b,success:c,error:$.proxy(function(a){if(!a||!a.getResponseHeader)return;var b=a.getResponseHeader("content-type");if(!b)return;b.indexOf("application/json")!=-1?a.status==400&&d?d(a):a.status==500&&e&&e(a):e&&e(a)},this),type:"POST",dataType:"json",contentType:"application/json"})},getJSON:function(a,b){$.ajax({url:a,dataType:"json",contentType:"application/json",success:b})}},new a}),define("tp/plugins/pluginsRepository",["tp/gateway","libs/jquery/jquery"],function(a){function b(){this._ctor()}return b.prototype={_requestUrlBase:"/api/v1/Plugins.asmx",_ctor:function(){this.gateway=a},_getUrl:function(){return(new Tp.WebServiceURL(this._requestUrlBase)).url},getStartedPlugins:function(a){this.gateway.postJSON(this._getUrl(),{},a)},pluginStartedAndHasAtLeastOneProfile:function(a,b){this.getStartedPlugins($.proxy(function(c){var d=$.grep(c,function(b){var c=$.grep(b.plugins,function(b){return b.name==a});if(c.length===0)return!1;var d=!1;return $(c).each(function(a,b){b.profiles.length>0&&(d=!0)}),d});d.length>0&&b()},this))}},new b}),define("tp/bus",["libs/jquery/jquery"],function($){var a=function(){var a={},b=function(b,c,d){var e=b||!1,f=c||[];if(!e)return;for(var g in a)if(typeof a[g]["on"+e]=="function")try{var h=d||a[g];a[g]["on"+e].apply(h,f)}catch(i){}},c=function(b,c,e){if(b in a)if(e)d(b);else throw new Error("Mediator name conflict: "+b);a[b]=c},d=function(b){b in a&&delete a[b]};return{name:"Bus",publish:b,subscribe:c,unsubscribe:d}};return a()}),define("domReady",[],function(){function a(a){for(var b=0,c;c=a[b];b++)c(g)}function b(){var b=h,c=i;f&&(b.length&&(h=[],a(b)),j.resourcesDone&&c.length&&(i=[],a(c)))}function c(){f||(f=!0,l&&clearInterval(l),b())}function d(a){return f?a(g):h.push(a),d}var e=typeof window!="undefined"&&window.document,f=!e,g=e?document:null,h=[],i=[],j=requirejs||require||{},k=j.resourcesReady,l;return"resourcesReady"in j&&(j.resourcesReady=function(a){k&&k(a),a&&b()}),e&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1)):window.attachEvent&&(window.attachEvent("onload",c),self===self.top&&(l=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),c())}catch(a){}},30))),document.readyState==="complete"&&c()),d.withResources=function(a){return f&&j.resourcesDone?a(g):i.push(a),d},d.version="1.0.0",d.load=function(a,b,c,e){e.isBuild?c(null):d(c)},d});var tau=tau||{};tau.mashups=function(){function a(){}return a.prototype={basePath:null,mashupPath:null,currentPlaceholder:null,libs:[],mashups:[],setPlaceholder:function(a,b,c){this.currentPlaceholder=a,this.basePath=b,this.mashupPath=c},addMashup:function(a){var b=this.basePath,c=this.mashupPath,d=this.currentPlaceholder,e=this.libs;this.libs=[];var f=function(){require(e,function(){var e=Array.prototype.slice.call(arguments);return e.push({placeholderId:d,basePath:b,mashupPath:c}),a.apply(null,e)})};require(["domReady"],function(a){a.withResources(f)})},addDependency:function(a){return this.libs.push("order!"+a),this},addText:function(a){return this.libs.push("text!"+this.mashupPath+a),this},addHtml:function(a){return this.addText(a+"!strip")},addModule:function(a,module){var b=this.libs;this.libs=[],define(a,b,function(){if(typeof module!="function")return module;var a=Array.prototype.slice.call(arguments);return module.apply(null,a)})},addCSS:function(a){var b=this.mashupPath+a,c=document.createElement("link");return c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",b),document.getElementsByTagName("head")[0].appendChild(c),this}},new a}(),define("tp/Mashups",function(){}),define("tp/plugins/profileNameSource",["tp/bus","libs/jquery/jquery","tp/Mashups"],function(a){function b(a){this._create(a)}return b.prototype={_create:function(b){this.bus=a,this.bus.subscribe("ProfileNameSource",{onProfileSaveSucceed:$.proxy(function(a){this.setProfileName(a.Name)},this)},!0)},getPluginName:function(){return(new Tp.URL(location.href)).getArgumentValue("PluginName")},getProfileNameKey:function(){return"ProfileName"},getProfileName:function(){var a=new Tp.URL(location.href),b=a.getArgumentValue(this.getProfileNameKey());if(!b){var c=a.getReference();c&&(b=c.substr(1))}return b},setProfileName:function(a){if(this.getProfileName())return;window.location=window.location+"#"+a}},new b}),define("tp/plugins/commandGateway",["libs/jquery/jquery","tp/plugins/profileNameSource","tp/gateway"],function($,a,b){function c(a){this._create(a)}return c.prototype={_requestUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Commands/{CommandName}",_requestForProfileUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Profiles/{ProfileName}/Commands/{CommandName}",_pluginName:null,_create:function(c){this.profileNameSource=a,this.gateway=b,c&&c.pluginName?this._pluginName=c.pluginName:this._pluginName=this.profileNameSource.getPluginName()},_getUrl:function(a){var b=this._requestUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{CommandName}/g,a);return(new Tp.WebServiceURL(b)).url},_getUrlForProfile:function(a){var b=this._requestForProfileUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{ProfileName}/g,this.profileNameSource.getProfileName()).replace(/{CommandName}/g,a);return(new Tp.WebServiceURL(b)).url},_post:function(a,b,c,d,e){this.gateway.postJSON(a,b,function(a){c&&c(a)},function(a){d&&d(a.responseText)},function(a){e&&e(a.responseText)})},execute:function(a,b,c,d,e){this._post(this._getUrl(a),b,c,d,e)},executeForProfile:function(a,b,c,d,e){this._post(this._getUrlForProfile(a),b,c,d,e)}},c}),define("tp/codemirror/lib/codemirror",[],function(){var a=function(){function a(b,c){function bM(a){return I&&(C&&a==229||window.opera&&a==197)||H&&C}function bO(a){return a>=0&&a<bl.size}function bQ(a){return n(bl,a)}function bR(a,b){bz=!0;var c=b-a.height;for(var d=a;d;d=d.parent)d.height+=c}function bS(a){var b={line:0,ch:0};cb(b,{line:bl.size-1,ch:bQ(bl.size-1).text.length},X(a),b,b),bu=!0}function bT(a){var b=[];return bl.iter(0,bl.size,function(a){b.push(a.text)}),b.join("\n")}function bU(a){function i(a){var b=dn(a,!0);if(b&&!P(b,e)){bn||b_(),e=b,cA(c,b),bu=!1;var d=cu();if(b.line>=d.to||b.line<d.from)f=setTimeout(dB(function(){i(a)}),150)}}for(var b=x(a);b!=K;b=b.parentNode)if(b.parentNode==$&&b!=_)return;for(var b=x(a);b!=K;b=b.parentNode)if(b.parentNode==bb)return g.onGutterClick&&g.onGutterClick(bP,W(bb.childNodes,b)+bB,a),u(a);var c=dn(a);switch(y(a)){case 3:C&&!H&&dp(a);return;case 2:c&&cD(c.line,c.ch,!0);return}if(!c){x(a)==U&&u(a);return}bn||b_();var d=+(new Date);if(bs&&bs.time>d-400&&P(bs.pos,c))return u(a),setTimeout(cq,20),cK(c.line);if(br&&br.time>d-400&&P(br.pos,c))return bs={time:d,pos:c},u(a),cJ(c);br={time:d,pos:c};var e=c,f;if(B&&!P(bo.from,bo.to)&&!Q(c,bo.from)&&!Q(bo.to,c)){E&&(bc.draggable=!0);var h=z(v,"mouseup",dB(function(b){E&&(bc.draggable=!1),bt=!1,h(),Math.abs(a.clientX-b.clientX)+Math.abs(a.clientY-b.clientY)<10&&(u(b),cD(c.line,c.ch,!0),cq())}),!0);bt=!0;return}u(a),cD(c.line,c.ch,!0);var j=z(v,"mousemove",dB(function(a){clearTimeout(f),u(a),i(a)}),!0),h=z(v,"mouseup",dB(function(a){clearTimeout(f);var b=dn(a);b&&cA(c,b),u(a),cq(),bu=!0,j(),h()}),!0)}function bV(a){for(var b=x(a);b!=K;b=b.parentNode)if(b.parentNode==bb)return u(a);var c=dn(a);if(!c)return;bs={time:+(new Date),pos:c},u(a),cJ(c)}function bW(a){a.preventDefault();var b=dn(a,!0),c=a.dataTransfer.files;if(!b||g.readOnly)return;if(c&&c.length&&window.FileReader&&window.File){function d(a,c){var d=new FileReader;d.onload=function(){f[c]=d.result,++h==e&&(b=cF(b),dB(function(){var a=cg(f.join(""),b,b);cA(b,a)})())},d.readAsText(a)}var e=c.length,f=Array(e),h=0;for(var i=0;i<e;++i)d(c[i],i)}else try{var f=a.dataTransfer.getData("Text");if(f){var j=cg(f,b,b),k=bo.from,l=bo.to;cA(b,j),bt&&cg("",k,l),cq()}}catch(a){}}function bX(a){var b=ck();T(b),a.dataTransfer.setDragImage(S,0,0),a.dataTransfer.setData("Text",b)}function bY(a){bn||b_();var b=a.keyCode;D&&b==27&&(a.returnValue=!1);var c=(H?a.metaKey:a.ctrlKey)&&!a.altKey,d=a.ctrlKey||a.altKey||a.metaKey;b==16||a.shiftKey?bp=bp||(bo.inverted?bo.to:bo.from):bp=null;if(g.onKeyEvent&&g.onKeyEvent(bP,t(a)))return;if(b==33||b==34)return cG(b==34),u(a);if(c&&(b==36||b==35||H&&(b==38||b==40)))return cH(b==36||b==38),u(a);if(c&&b==65)return cI(),u(a);if(!g.readOnly){if(!d&&b==13)return;if(!d&&b==9&&cM(a.shiftKey))return u(a);if(c&&b==90)return cd(),u(a);if(c&&(a.shiftKey&&b==90||b==89))return ce(),u(a)}if(b==36&&g.smartHome)return cN(),u(a);bE=(c?"c":"")+(a.altKey?"a":"")+b;if(bo.inverted&&J[bE]===!0){var e=Y(M);e&&(bq={anchor:e.start},Z(M,e.start,e.start))}!c&&!a.altKey&&(bE=null),cn(bE),g.pollForIME&&bM(b)&&(bK=50)}function bZ(a){if(g.onKeyEvent&&g.onKeyEvent(bP,t(a)))return;bq&&(bq=null,bu=!0),a.keyCode==16&&(bp=null),bK<2e3&&!bL&&(bK=2e3)}function b$(a){if(g.onKeyEvent&&g.onKeyEvent(bP,t(a)))return;if(g.electricChars&&bk.electricChars){var b=String.fromCharCode(a.charCode==null?a.keyCode:a.charCode);bk.electricChars.indexOf(b)>-1&&setTimeout(dB(function(){cO(bo.to.line,"smart")}),50)}var c=a.keyCode;c==13?(g.readOnly||cL(),u(a)):!a.ctrlKey&&!a.altKey&&!a.metaKey&&c==9&&g.tabMode!="default"?u(a):cn(bE)}function b_(){if(g.readOnly=="nocursor")return;bn||(g.onFocus&&g.onFocus(bP),bn=!0,K.className.search(/\bCodeMirror-focused\b/)==-1&&(K.className+=" CodeMirror-focused"),by||cp()),cm(),dq()}function ca(){bn&&(g.onBlur&&g.onBlur(bP),bn=!1,K.className=K.className.replace(" CodeMirror-focused","")),clearInterval(bj),setTimeout(function(){bn||(bp=null)},150)}function cb(a,b,c,d,e){if(bJ){var f=[];bl.iter(a.line,b.line+1,function(a){f.push(a.text)}),bJ.addChange(a.line,c.length,f);while(bJ.done.length>g.undoDepth)bJ.done.shift()}cf(a,b,c,d,e)}function cc(a,b){var c=a.pop();if(c){var d=[],e=c.start+c.added;bl.iter(c.start,e,function(a){d.push(a.text)}),b.push({start:c.start,added:c.old.length,old:d});var f=cF({line:c.start+c.old.length-1,ch:V(d[d.length-1],c.old[c.old.length-1])});cf({line:c.start,ch:0},{line:e-1,ch:bQ(e-1).text.length},c.old,f,f),bu=!0}}function cd(){cc(bJ.done,bJ.undone)}function ce(){cc(bJ.undone,bJ.done)}function cf(a,b,c,d,e){function v(a){return a<=Math.min(b.line,b.line+r)?a:a+r}var f=!1,h=bH.length;g.lineWrapping||bl.iter(a.line,b.line,function(a){if(a.text.length==h)return f=!0,!0});var i=b.line-a.line,k=bQ(a.line),l=bQ(b.line);if(k==l)if(c.length==1)k.replace(a.ch,b.ch,c[0]);else{l=k.split(b.ch,c[c.length-1]),k.replace(a.ch,null,c[0]),k.fixMarkEnds(l);var m=[];for(var n=1,o=c.length-1;n<o;++n)m.push(j.inheritMarks(c[n],k));m.push(l),bl.insert(a.line+1,m)}else if(c.length==1)k.replace(a.ch,null,c[0]),l.replace(null,b.ch,""),k.append(l),bl.remove(a.line+1,i);else{var m=[];k.replace(a.ch,null,c[0]),l.replace(null,b.ch,c[c.length-1]),k.fixMarkEnds(l);for(var n=1,o=c.length-1;n<o;++n)m.push(j.inheritMarks(c[n],k));i>1&&bl.remove(a.line+1,i-1),bl.insert(a.line+1,m)}if(g.lineWrapping){var p=U.clientWidth/dk()-3;bl.iter(a.line,a.line+c.length,function(a){if(a.hidden)return;var b=Math.ceil(a.text.length/p)||1;b!=a.height&&bR(a,b)})}else bl.iter(a.line,n+c.length,function(a){var b=a.text;b.length>h&&(bH=b,h=b.length,bI=null,f=!1)}),f&&(h=0,bH="",bI=null,bl.iter(0,bl.size,function(a){var b=a.text;b.length>h&&(h=b.length,bH=b)}));var q=[],r=c.length-i-1;for(var n=0,s=bm.length;n<s;++n){var t=bm[n];t<a.line?q.push(t):t>b.line&&q.push(t+r)}var u=a.line+Math.min(c.length,500);dv(a.line,u),q.push(u),bm=q,dx(100),bv.push({from:a.line,to:b.line+1,diff:r}),bw={from:a,to:b,text:c},cB(d,e,v(bo.from.line),v(bo.to.line)),$.style.height=bl.height*di()+2*dl()+"px"}function cg(a,b,c){function d(d){if(Q(d,b))return d;if(!Q(c,d))return e;var f=d.line+a.length-(c.line-b.line)-1,g=d.ch;return d.line==c.line&&(g+=a[a.length-1].length-(c.ch-(c.line==b.line?b.ch:0))),{line:f,ch:g}}b=cF(b),c?c=cF(c):c=b,a=X(a);var e;return ci(a,b,c,function(a){return e=a,{from:d(bo.from),to:d(bo.to)}}),e}function ch(a,b){ci(X(a),bo.from,bo.to,function(a){return b=="end"?{from:a,to:a}:b=="start"?{from:bo.from,to:bo.from}:{from:bo.from,to:a}})}function ci(a,b,c,d){var e=a.length==1?a[0].length+b.ch:a[a.length-1].length,f=d({line:b.line+a.length-1,ch:e});cb(b,c,a,f.from,f.to)}function cj(a,b){var c=a.line,d=b.line;if(c==d)return bQ(c).text.slice(a.ch,b.ch);var e=[bQ(c).text.slice(a.ch)];return bl.iter(c+1,d,function(a){e.push(a.text)}),e.push(bQ(d).text.slice(0,b.ch)),e.join("\n")}function ck(){return cj(bo.from,bo.to)}function cm(){if(cl)return;bh.set(bK,function(){dy(),co(),bn&&cm(),dz()})}function cn(a){function c(){dy();var d=co();d&&a&&(d=="moved"&&J[a]==null&&(J[a]=!0),d=="changed"&&(J[a]=!1)),!d&&!b?(b=!0,bh.set(80,c)):(cl=!1,cm()),dz()}var b=!1;cl=!0,bh.set(20,c)}function co(){function f(a,c){var d=0;for(;;){var e=b.indexOf("\n",d);if(e==-1||(b.charAt(e-1)=="\r"?e-1:e)>=a)return{line:c,ch:a-d};++c,d=e+1}}if(by||!bn)return;var a=!1,b=M.value,c=Y(M);if(!c)return!1;var a=bF.text!=b,d=bq,e=a||c.start!=bF.start||c.end!=(d?bF.start:bF.end);if(!e&&!d)return!1;if(a){bp=bq=null;if(g.readOnly)return bu=!0,"changed"}var h=f(c.start,bF.from),i=f(c.end,bF.from);if(d){var j=c.start==d.anchor?i:h,k=bp?bo.to:c.start==d.anchor?h:i;(bo.inverted=Q(j,k))?(h=j,i=k):(bq=null,h=k,i=j)}h.line==i.line&&h.line==bo.from.line&&h.line==bo.to.line&&!bp&&(bu=!1);if(a){var l=0,m=b.length,n=Math.min(m,bF.text.length),o,p=bF.from,q=-1;while(l<n&&(o=b.charAt(l))==bF.text.charAt(l))++l,o=="\n"&&(p++,q=l);var r=q>-1?l-q:l,s=bF.to-1,t=bF.text.length;for(;;){o=bF.text.charAt(t);if(b.charAt(m)!=o){++m,++t;break}o=="\n"&&s--;if(t<=l||m<=l)break;--m,--t}var q=bF.text.lastIndexOf("\n",t-1),u=q==-1?t:t-q-1;cb({line:p,ch:r},{line:s,ch:u},X(b.slice(l,m)),h,i);if(p!=s||h.line!=p)bu=!0}else cB(h,i);return bF.text=b,bF.start=c.start,bF.end=c.end,a?"changed":e?"moved":!1}function cp(){var a=[],b=Math.max(0,bo.from.line-1),c=Math.min(bl.size,bo.to.line+2);bl.iter(b,c,function(b){a.push(b.text)}),a=M.value=a.join(F);var d=bo.from.ch,e=bo.to.ch;bl.iter(b,bo.from.line,function(a){d+=F.length+a.text.length}),bl.iter(b,bo.to.line,function(a){e+=F.length+a.text.length}),bF={text:a,from:b,to:c,start:d,end:e},Z(M,d,bq?d:e)}function cq(){g.readOnly!="nocursor"&&M.focus()}function cr(){if(!be.getBoundingClientRect)return;var a=be.getBoundingClientRect(),b=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(a.top<0||a.bottom>b)&&be.scrollIntoView()}function cs(){var a=dd(bo.inverted?bo.from:bo.to),b=g.lineWrapping?Math.min(a.x,bc.offsetWidth):a.x;return ct(b,a.y,b,a.yBot)}function ct(a,b,c,d){var e=dm(),f=dl(),h=di();b+=f,d+=f,a+=e,c+=e;var i=U.clientHeight,j=U.scrollTop,k=!1,l=!0;b<j?(U.scrollTop=Math.max(0,b-2*h),k=!0):d>j+i&&(U.scrollTop=d+h-i,k=!0);var m=U.clientWidth,n=U.scrollLeft,o=g.fixedGutter?ba.clientWidth:0;return a<n+o?(a<50&&(a=0),U.scrollLeft=Math.max(0,a-10-o),k=!0):c>m+n&&(U.scrollLeft=c+10-m,k=!0,c>$.clientWidth&&(l=!1)),k&&g.onScroll&&g.onScroll(bP),l}function cu(){var a=di(),b=U.scrollTop-dl(),c=Math.max(0,Math.floor(b/a)),d=Math.ceil((b+U.clientHeight)/a);return{from:p(bl,c),to:p(bl,d)}}function cv(a){if(!U.clientWidth){bB=bC=bA=0;return}var b=cu();if(a!==!0&&a.length==0&&b.from>=bB&&b.to<=bC)return;var c=Math.max(b.from-100,0),d=Math.min(bl.size,b.to+100);bB<c&&c-bB<20&&(c=bB),bC>d&&bC-d<20&&(d=Math.min(bl.size,bC));var e=a===!0?[]:cw([{from:bB,to:bC,domStart:0}],a),f=0;for(var h=0;h<e.length;++h){var i=e[h];i.from<c&&(i.domStart+=c-i.from,i.from=c),i.to>d&&(i.to=d),i.from>=i.to?e.splice(h--,1):f+=i.to-i.from}if(f==d-c)return;e.sort(function(a,b){return a.domStart-b.domStart});var j=di(),k=ba.style.display;bf.style.display=ba.style.display="none",cx(c,d,e),bf.style.display="";var l=c!=bB||d!=bC||bD!=U.clientHeight;l&&(bD=U.clientHeight),bB=c,bC=d,bA=q(bl,c),_.style.top=bA*j+"px",$.style.height=bl.height*j+2*dl()+"px";if(bf.childNodes.length!=bC-bB)throw new Error("BAD PATCH! "+JSON.stringify(e)+" size="+(bC-bB)+" nodes="+bf.childNodes.length);if(g.lineWrapping){bI=U.clientWidth;var m=bf.firstChild;bl.iter(bB,bC,function(a){if(!a.hidden){var b=Math.round(m.offsetHeight/j)||1;a.height!=b&&(bR(a,b),bz=!0)}m=m.nextSibling})}else bI==null&&(bI=c_(bH)),bI>U.clientWidth?(bc.style.width=bI+"px",$.style.width="",$.style.width=U.scrollWidth+"px"):bc.style.width=$.style.width="";ba.style.display=k,(l||bz)&&cy(),cz()}function cw(a,b){for(var c=0,d=b.length||0;c<d;++c){var e=b[c],f=[],g=e.diff||0;for(var h=0,i=a.length;h<i;++h){var j=a[h];e.to<=j.from&&e.diff?f.push({from:j.from+g,to:j.to+g,domStart:j.domStart}):e.to<=j.from||e.from>=j.to?f.push(j):(e.from>j.from&&f.push({from:j.from,to:e.from,domStart:j.domStart}),e.to<j.to&&f.push({from:e.to+g,to:j.to+g,domStart:j.domStart+(e.to-j.from)}))}a=f}return a}function cx(a,b,c){if(!c.length)bf.innerHTML="";else{function d(a){var b=a.nextSibling;return a.parentNode.removeChild(a),b}var e=0,f=bf.firstChild,g;for(var h=0;h<c.length;++h){var i=c[h];while(i.domStart>e)f=d(f),e++;for(var j=0,k=i.to-i.from;j<k;++j)f=f.nextSibling,e++}while(f)f=d(f)}var l=c.shift(),f=bf.firstChild,j=a,m=bo.from.line,n=bo.to.line,o=m<a&&n>=a,p=v.createElement("div"),q;bl.iter(a,b,function(a){var b=null,d=null;o?(b=0,n==j&&(o=!1,d=bo.to.ch)):m==j&&(n==j?(b=bo.from.ch,d=bo.to.ch):(o=!0,b=bo.from.ch)),l&&l.to==j&&(l=c.shift()),!l||l.from>j?(a.hidden?p.innerHTML="<pre></pre>":p.innerHTML=a.getHTML(b,d,!0),bf.insertBefore(p.firstChild,f)):f=f.nextSibling,++j})}function cy(){if(!g.gutter&&!g.lineNumbers)return;var a=_.offsetHeight,b=U.clientHeight;ba.style.height=(a-b<2?b:a)+"px";var c=[],d=bB;bl.iter(bB,Math.max(bC,bB+1),function(a){if(a.hidden)c.push("<pre></pre>");else{var b=a.gutterMarker,e=g.lineNumbers?d+g.firstLineNumber:null;b&&b.text?e=b.text.replace("%N%",e!=null?e:""):e==null&&(e=" "),c.push(b&&b.style?'<pre class="'+b.style+'">':"<pre>",e);for(var f=1;f<a.height;++f)c.push("<br>&nbsp;");c.push("</pre>")}++d}),ba.style.display="none",bb.innerHTML=c.join("");var e=String(bl.size).length,f=bb.firstChild,h=O(f),i="";while(h.length+i.length<e)i+=" ";i&&f.insertBefore(v.createTextNode(i),f.firstChild),ba.style.display="",bc.style.marginLeft=ba.offsetWidth+"px",bz=!1}function cz(){var a=bo.inverted?bo.from:bo.to,b=di(),c=dd(a,!0),d=c.y+bA*di();L.style.top=Math.max(Math.min(d,U.offsetHeight),0)+"px",L.style.left=c.x-U.scrollLeft+"px",P(bo.from,bo.to)?(be.style.top=c.y+"px",be.style.left=(g.lineWrapping?Math.min(c.x,bc.offsetWidth):c.x)+"px",be.style.display=""):be.style.display="none"}function cA(a,b){var c=bp&&cF(bp);c&&(Q(c,a)?a=c:Q(b,c)&&(b=c)),cB(a,b)}function cB(a,b,c,d){c==null&&(c=bo.from.line,d=bo.to.line);if(P(bo.from,a)&&P(bo.to,b))return;if(Q(b,a)){var e=b;b=a,a=e}a.line!=c&&(a=cC(a,c,bo.from.ch)),b.line!=d&&(b=cC(b,d,bo.to.ch)),P(a,b)?bo.inverted=!1:P(a,bo.to)?bo.inverted=!1:P(b,bo.from)&&(bo.inverted=!0),P(a,b)?P(bo.from,bo.to)||bv.push({from:c,to:d+1}):P(bo.from,bo.to)?bv.push({from:a.line,to:b.line+1}):(P(a,bo.from)||(a.line<c?bv.push({from:a.line,to:Math.min(b.line,c)+1}):bv.push({from:c,to:Math.min(d,a.line)+1})),P(b,bo.to)||(b.line<d?bv.push({from:Math.max(c,a.line),to:d+1}):bv.push({from:Math.max(a.line,d),to:b.line+1}))),bo.from=a,bo.to=b,bx=!0}function cC(a,b,c){function d(b){var d=a.line+b,e=b==1?bl.size:-1;while(d!=e){var f=bQ(d);if(!f.hidden){var g=a.ch;if(g>c||g>f.text.length)g=f.text.length;return{line:d,ch:g}}d+=b}}var e=bQ(a.line);return e.hidden?a.line>=b?d(1)||d(-1):d(-1)||d(1):a}function cD(a,b,c){var d=cF({line:a,ch:b||0});(c?cA:cB)(d,d)}function cE(a){return Math.max(0,Math.min(a,bl.size-1))}function cF(a){if(a.line<0)return{line:0,ch:0};if(a.line>=bl.size)return{line:bl.size-1,ch:bQ(bl.size-1).text.length};var b=a.ch,c=bQ(a.line).text.length;return b==null||b>c?{line:a.line,ch:c}:b<0?{line:a.line,ch:0}:a}function cG(a){var b=Math.floor(U.clientHeight/di()),c=bo.inverted?bo.from:bo.to,d=q(bl,c.line)+Math.max(b-1,1)*(a?1:-1);cD(p(bl,d),c.ch,!0)}function cH(a){var b=a?{line:0,ch:0}:{line:bl.size-1,ch:bQ(bl.size-1).text.length};cA(b,b)}function cI(){var a=bl.size-1;cB({line:0,ch:0},{line:a,ch:bQ(a).text.length})}function cJ(a){var b=bQ(a.line).text,c=a.ch,d=a.ch;while(c>0&&/\w/.test(b.charAt(c-1)))--c;while(d<b.length&&/\w/.test(b.charAt(d)))++d;cA({line:a.line,ch:c},{line:a.line,ch:d})}function cK(a){cA({line:a,ch:0},{line:a,ch:bQ(a).text.length})}function cL(){ch("\n","end"),g.enterMode!="flat"&&cO(bo.from.line,g.enterMode=="keep"?"prev":"smart")}function cM(a){function b(a){if(P(bo.from,bo.to))return cO(bo.from.line,a);var b=bo.to.line-(bo.to.ch?0:1);for(var c=bo.from.line;c<=b;++c)cO(c,a)}bp=null;switch(g.tabMode){case"default":return!1;case"indent":b("smart");break;case"classic":if(P(bo.from,bo.to)){a?cO(bo.from.line,"smart"):ch("\t","end");break};case"shift":b(a?"subtract":"add")}return!0}function cN(){var a=Math.max(0,bQ(bo.from.line).text.search(/\S/));cD(bo.from.line,bo.from.ch<=a&&bo.from.ch?0:a,!0)}function cO(a,b){if(b=="smart")if(!bk.indent)b="prev";else var c=du(a);var d=bQ(a),e=d.indentation(),f=d.text.match(/^\s*/)[0],h;b=="prev"?a?h=bQ(a-1).indentation():h=0:b=="smart"?h=bk.indent(c,d.text.slice(f.length)):b=="add"?h=e+g.indentUnit:b=="subtract"&&(h=e-g.indentUnit),h=Math.max(0,h);var i=h-e;if(!i){if(bo.from.line!=a&&bo.to.line!=a)return;var j=f}else{var j="",k=0;if(g.indentWithTabs)for(var l=Math.floor(h/G);l;--l)k+=G,j+="\t";while(k<h)++k,j+=" "}cg(j,{line:a,ch:0},{line:a,ch:f.length})}function cP(){bk=a.getMode(g,g.mode),bl.iter(0,bl.size,function(a){a.stateAfter=null}),bm=[0],dx()}function cQ(){var a=g.gutter||g.lineNumbers;ba.style.display=a?"":"none",a?bz=!0:bf.parentNode.style.marginLeft=0}function cR(a,b){if(g.lineWrapping){K.className+=" CodeMirror-wrap";var c=U.clientWidth/dk()-3;bl.iter(0,bl.size,function(a){if(a.hidden)return;var b=Math.ceil(a.text.length/c)||1;b!=1&&bR(a,b)}),bc.style.width=$.style.width=""}else K.className=K.className.replace(" CodeMirror-wrap",""),bI=null,bH="",bl.iter(0,bl.size,function(a){a.height!=1&&!a.hidden&&bR(a,1),a.text.length>bH.length&&(bH=a.text)});bv.push({from:0,to:bl.size})}function cS(){this.set=[]}function cT(a,b,c){function e(a,b,c,e){mark=bQ(a).addMark(new h(b,c,e,d.set))}a=cF(a),b=cF(b);var d=new cS;if(a.line==b.line)e(a.line,a.ch,b.ch,c);else{e(a.line,a.ch,null,c);for(var f=a.line+1,g=b.line;f<g;++f)e(f,null,null,c);e(b.line,null,b.ch,c)}return bv.push({from:a.line,to:b.line+1}),d}function cU(a){a=cF(a);var b=new i(a.ch);return bQ(a.line).addMark(b),b}function cV(a,b,c){return typeof a=="number"&&(a=bQ(cE(a))),a.gutterMarker={text:b,style:c},bz=!0,a}function cW(a){typeof a=="number"&&(a=bQ(cE(a))),a.gutterMarker=null,bz=!0}function cX(a,b){var c=a,d=a;return typeof a=="number"?d=bQ(cE(a)):c=o(a),c==null?null:(b(d,c)&&bv.push({from:c,to:c+1}),d)}function cY(a,b){return cX(a,function(a){if(a.className!=b)return a.className=b,!0})}function cZ(a,b){return cX(a,function(a,c){if(a.hidden!=b)return a.hidden=b,bR(a,b?0:1),b&&(bo.from.line==c||bo.to.line==c)&&cB(cC(bo.from,bo.from.line,bo.from.ch),cC(bo.to,bo.to.line,bo.to.ch)),bz=!0})}function c$(a){if(typeof a=="number"){if(!bO(a))return null;var b=a;a=bQ(a);if(!a)return null}else{var b=o(a);if(b==null)return null}var c=a.gutterMarker;return{line:b,handle:a,text:a.text,markerText:c&&c.text,markerClass:c&&c.style,lineClass:a.className}}function c_(a){return bd.innerHTML="<pre><span>x</span></pre>",bd.firstChild.firstChild.firstChild.nodeValue=a,bd.firstChild.firstChild.offsetWidth||10}function da(a,b){function e(a){return bd.innerHTML="<pre><span>"+c.getHTML(null,null,!1,a)+"</span></pre>",bd.firstChild.firstChild.offsetWidth}if(b<=0)return 0;var c=bQ(a),d=c.text,f=0,g=0,h=d.length,i,j=Math.min(h,Math.ceil(b/dk()));for(;;){var k=e(j);if(k<=b&&j<h)j=Math.min(h,Math.ceil(j*1.2));else{i=k,h=j;break}}if(b>i)return h;j=Math.floor(h*.8),k=e(j),k<b&&(f=j,g=k);for(;;){if(h-f<=1)return i-b>b-g?f:h;var l=Math.ceil((f+h)/2),m=e(l);m>b?(h=l,i=m):(f=l,g=m)}}function dc(a,b){var c="";if(g.lineWrapping){var d=a.text.indexOf(" ",b+2);c=a.text.slice(b+1,d<0?a.text.length:d+(D?5:0))}bd.innerHTML="<pre>"+a.getHTML(null,null,!1,b)+'<span id="CodeMirror-temp-'+db+'">'+(a.text.charAt(b)||" ")+"</span>"+c+"</pre>";var e=document.getElementById("CodeMirror-temp-"+db),f=e.offsetTop,h=e.offsetLeft;if(D&&b&&f==0&&h==0){var i=document.createElement("span");i.innerHTML="x",e.parentNode.insertBefore(i,e.nextSibling),f=i.offsetTop}return{top:f,left:h}}function dd(a,b){var c,d=di(),e=d*(q(bl,a.line)-(b?bA:0));if(a.ch==0)c=0;else{var f=dc(bQ(a.line),a.ch);c=f.left,g.lineWrapping&&(e+=Math.max(0,f.top))}return{x:c,y:e,yBot:e+d}}function de(a,b){function l(a){var b=dc(h,a);if(j){var d=Math.round(b.top/c);return Math.max(0,b.left+(d-k)*U.clientWidth)}return b.left}b<0&&(b=0);var c=di(),d=dk(),e=bA+Math.floor(b/c),f=p(bl,e);if(f>=bl.size)return{line:bl.size-1,ch:0};var h=bQ(f),i=h.text,j=g.lineWrapping,k=j?e-q(bl,f):0;if(a<=0&&k==0)return{line:f,ch:0};var m=0,n=0,o=i.length,r,s=Math.min(o,Math.ceil((a+k*U.clientWidth*.9)/d));for(;;){var t=l(s);if(t<=a&&s<o)s=Math.min(o,Math.ceil(s*1.2));else{r=t,o=s;break}}if(a>r)return{line:f,ch:o};s=Math.floor(o*.8),t=l(s),t<a&&(m=s,n=t);for(;;){if(o-m<=1)return{line:f,ch:r-a>a-n?m:o};var u=Math.ceil((m+o)/2),v=l(u);v>a?(o=u,r=v):(m=u,n=v)}}function df(a){var b=dd(a,!0),c=N(bc);return{x:c.left+b.x,y:c.top+b.y,yBot:c.top+b.yBot}}function di(){var a=bf.offsetHeight;return a==dh?dg:(dh=a,bd.innerHTML="<pre>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x<br>x</pre>",dg=bd.firstChild.offsetHeight/10||1)}function dk(){return U.clientWidth==dh?dj:(dh=U.clientWidth,dj=c_("x"))}function dl(){return bc.offsetTop}function dm(){return bc.offsetLeft}function dn(a,b){var c=N(U,!0),d,e;try{d=a.clientX,e=a.clientY}catch(a){return null}if(!b&&(d-c.left>U.clientWidth||e-c.top>U.clientHeight))return null;var f=N(bc,!0);return de(d-f.left,e-f.top)}function dp(a){function e(){var a=X(M.value).join("\n");a!=d&&dB(ch)(a,"end"),L.style.position="relative",M.style.cssText=c,by=!1,cp(),cm()}var b=dn(a);if(!b||window.opera)return;(P(bo.from,bo.to)||Q(b,bo.from)||!Q(b,bo.to))&&dB(cD)(b.line,b.ch);var c=M.style.cssText;L.style.position="absolute",M.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(a.clientY-5)+"px; left: "+(a.clientX-5)+"px; z-index: 1000; background: white; "+"border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",by=!0;var d=M.value=ck();cq(),Z(M,0,M.value.length);if(C){w(a);var f=z(window,"mouseup",function(){f(),setTimeout(e,20)},!0)}else setTimeout(e,50)}function dq(){clearInterval(bj);var a=!0;be.style.visibility="",bj=setInterval(function(){be.style.visibility=(a=!a)?"":"hidden"},650)}function ds(a){function p(a,b,c){if(!a.text)return;var d=a.styles,e=g?0:a.text.length-1,f;for(var i=g?0:d.length-2,j=g?d.length:-2;i!=j;i+=2*h){var k=d[i];if(d[i+1]!=null&&d[i+1]!=m){e+=h*k.length;continue}for(var l=g?0:k.length-1,p=g?k.length:-1;l!=p;l+=h,e+=h)if(e>=b&&e<c&&o.test(f=k.charAt(l))){var q=dr[f];if(q.charAt(1)==">"==g)n.push(f);else{if(n.pop()!=q.charAt(0))return{pos:e,match:!1};if(!n.length)return{pos:e,match:!0}}}}}var b=bo.inverted?bo.from:bo.to,c=bQ(b.line),d=b.ch-1,e=d>=0&&dr[c.text.charAt(d)]||dr[c.text.charAt(++d)];if(!e)return;var f=e.charAt(0),g=e.charAt(1)==">",h=g?1:-1,i=c.styles;for(var j=d+1,k=0,l=i.length;k<l;k+=2)if((j-=i[k].length)<=0){var m=i[k+1];break}var n=[c.text.charAt(d)],o=/[(){}[\]]/;for(var k=b.line,l=g?Math.min(k+100,bl.size):Math.max(-1,k-100);k!=l;k+=h){var c=bQ(k),q=k==b.line,r=p(c,q&&g?d+1:0,q&&!g?d:c.text.length);if(r)break}r||(r={pos:null,match:!1});var m=r.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",s=cT({line:b.line,ch:d},{line:b.line,ch:d+1},m),t=r.pos!=null&&cT({line:k,ch:r.pos},{line:k,ch:r.pos+1},m),u=dB(function(){s.clear(),t&&t.clear()});a?setTimeout(u,800):bG=u}function dt(a){var b,c;for(var d=a,e=a-40;d>e;--d){if(d==0)return 0;var f=bQ(d-1);if(f.stateAfter)return d;var g=f.indentation();if(c==null||b>g)c=d-1,b=g}return c}function du(a){var b=dt(a),c=b&&bQ(b-1).stateAfter;return c?c=e(bk,c):c=f(bk),bl.iter(b,a,function(a){a.highlight(bk,c),a.stateAfter=e(bk,c)}),b<a&&bv.push({from:b,to:a}),a<bl.size&&!bQ(a).stateAfter&&bm.push(a),c}function dv(a,b){var c=du(a);bl.iter(a,b,function(a){a.highlight(bk,c),a.stateAfter=e(bk,c)})}function dw(){var a=+(new Date)+g.workTime,b=bm.length;while(bm.length){if(!bQ(bB).stateAfter)var c=bB;else var c=bm.pop();if(c>=bl.size)continue;var d=dt(c),h=d&&bQ(d-1).stateAfter;h?h=e(bk,h):h=f(bk);var i=0,j=bk.compareStates,k=!1,l=d,m=!1;bl.iter(l,bl.size,function(b){var d=b.stateAfter;if(+(new Date)>a)return bm.push(l),dx(g.workDelay),k&&bv.push({from:c,to:l+1}),m=!0;var f=b.highlight(bk,h);f&&(k=!0),b.stateAfter=e(bk,h);if(j){if(d&&j(d,h))return!0}else if(f!==!1||!d)i=0;else if(++i>3)return!0;++l});if(m)return;k&&bv.push({from:c,to:l+1})}b&&g.onHighlightComplete&&g.onHighlightComplete(bP)}function dx(a){if(!bm.length)return;bi.set(a,dB(dw))}function dy(){bu=null,bv=[],bw=bx=!1}function dz(){var a=!1;bx&&(a=!cs()),bv.length?cv(bv):(bx&&cz(),bz&&cy()),a&&cs(),bx&&(cr(),dq()),bn&&!by&&(bu===!0||bu!==!1&&bx)&&cp(),bx&&g.matchBrackets&&setTimeout(dB(function(){bG&&(bG(),bG=null),ds(!1)}),20);var b=bw;bx&&g.onCursorActivity&&g.onCursorActivity(bP),b&&g.onChange&&bP&&g.onChange(bP,b)}function dB(a){return function(){dA++||dy();try{var b=a.apply(this,arguments)}finally{--dA||dz()}return b}}function dC(a,b,c){this.atOccurrence=!1,c==null&&(c=typeof a=="string"&&a==a.toLowerCase()),b&&typeof b=="object"?b=cF(b):b={line:0,ch:0},this.pos={from:b,to:b};if(typeof a!="string")this.matches=function(b,c){if(b){var d=bQ(c.line).text.slice(0,c.ch),e=d.match(a),f=0;while(e){var g=d.indexOf(e[0]);f+=g,d=d.slice(g+1);var h=d.match(a);if(h)e=h;else break;f++}}else var d=bQ(c.line).text.slice(c.ch),e=d.match(a),f=e&&c.ch+d.indexOf(e[0]);if(e)return{from:{line:c.line,ch:f},to:{line:c.line,ch:f+e[0].length},match:e}};else{c&&(a=a.toLowerCase());var d=c?function(a){return a.toLowerCase()}:function(a){return a},e=a.split("\n");e.length==1?this.matches=function(b,c){var e=d(bQ(c.line).text),f=a.length,g;if(b?c.ch>=f&&(g=e.lastIndexOf(a,c.ch-f))!=-1:(g=e.indexOf(a,c.ch))!=-1)return{from:{line:c.line,ch:g},to:{line:c.line,ch:g+f}}}:this.matches=function(a,b){var c=b.line,f=a?e.length-1:0,g=e[f],h=d(bQ(c).text),i=a?h.indexOf(g)+g.length:h.lastIndexOf(g);if(a?i>=b.ch||i!=g.length:i<=b.ch||i!=h.length-g.length)return;for(;;){if(a?!c:c==bl.size-1)return;h=d(bQ(c+=a?-1:1).text),g=e[a?--f:++f];if(f>0&&f<e.length-1){if(h!=g)return;continue}var j=a?h.lastIndexOf(g):h.indexOf(g)+g.length;if(a?j!=h.length-g.length:j!=g.length)return;var k={line:b.line,ch:i},l={line:c,ch:j};return{from:a?l:k,to:a?k:l}}}}}var g={},k=a.defaults;for(var s in k)k.hasOwnProperty(s)&&(g[s]=(c&&c.hasOwnProperty(s)?c:k)[s]);var v=g.document,K=v.createElement("div");K.className="CodeMirror"+(g.lineWrapping?" CodeMirror-wrap":""),K.innerHTML='<div style="overflow: hidden; position: relative; width: 1px; height: 0px;"><textarea style="position: absolute; width: 10000px;" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-'+g.theme+'">'+'<div style="position: relative">'+'<div style="position: relative">'+'<div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div>'+'<div class="CodeMirror-lines"><div style="position: relative">'+'<div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden"></div>'+'<pre class="CodeMirror-cursor">&#160;</pre>'+"<div></div>"+"</div></div></div></div></div>",b.appendChild?b.appendChild(K):b(K);var L=K.firstChild,M=L.firstChild,U=K.lastChild,$=U.firstChild,_=$.firstChild,ba=_.firstChild,bb=ba.firstChild,bc=ba.nextSibling.firstChild,bd=bc.firstChild,be=bd.nextSibling,bf=be.nextSibling;E||(bc.draggable=!0),g.tabindex!=null&&(M.tabindex=g.tabindex),!g.gutter&&!g.lineNumbers&&(ba.style.display="none");try{c_("x")}catch(bg){throw bg.message.match(/unknown runtime/i)&&(bg=new Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)")),bg}var bh=new A,bi=new A,bj,bk,bl=new m([new l([new j("")])]),bm,bn;cP();var bo={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA=0,bB=0,bC=0,bD=0,bE=null,bF,bG,bH="",bI;dB(function(){bS(g.value||""),bu=!1})();var bJ=new r,bK=2e3,bL=!I&&!H&&(C||window.opera);g.pollForIME&&bL&&(bK=50),z(U,"mousedown",dB(bU)),z(U,"dblclick",dB(bV)),z(bc,"dragstart",bX),z(bc,"selectstart",u),C||z(U,"contextmenu",dp),z(U,"scroll",function(){cv([]),g.fixedGutter&&(ba.style.left=U.scrollLeft+"px"),g.onScroll&&g.onScroll(bP)}),z(window,"resize",function(){cv(!0)}),z(M,"keyup",dB(bZ)),z(M,"input",function(){cn(bE)}),z(M,"keydown",dB(bY)),z(M,"keypress",dB(b$)),z(M,"focus",b_),z(M,"blur",ca),z(U,"dragenter",w),z(U,"dragover",w),z(U,"drop",dB(bW)),z(U,"paste",function(){cq(),cn()}),z(M,"paste",function(){cn()}),z(M,"cut",function(){cn()});var bN;try{bN=v.activeElement==M}catch(bg){}bN?setTimeout(b_,20):ca();var bP=K.CodeMirror={getValue:bT,setValue:dB(bS),getSelection:ck,replaceSelection:dB(ch),focus:function(){cq(),b_(),cn()},setOption:function(a,b){var c=g[a];g[a]=b,a=="mode"||a=="indentUnit"?cP():a=="readOnly"&&b=="nocursor"?M.blur():a=="theme"?U.className=U.className.replace(/cm-s-\w+/,"cm-s-"+b):a=="lineWrapping"&&c!=b?dB(cR)():a=="pollForIME"&&bL&&(bK=b?50:2e3),(a=="lineNumbers"||a=="gutter"||a=="firstLineNumber"||a=="theme")&&dB(cQ)()},getOption:function(a){return g[a]},undo:dB(cd),redo:dB(ce),indentLine:dB(function(a,b){bO(a)&&cO(a,b==null?"smart":b?"add":"subtract")}),historySize:function(){return{undo:bJ.done.length,redo:bJ.undone.length}},clearHistory:function(){bJ=new r},matchBrackets:dB(function(){ds(!0)}),getTokenAt:dB(function(a){return a=cF(a),bQ(a.line).getTokenAt(bk,du(a.line),a.ch)}),getStateAfter:function(a){return a=cE(a==null?bl.size-1:a),du(a+1)},cursorCoords:function(a){return a==null&&(a=bo.inverted),df(a?bo.from:bo.to)},charCoords:function(a){return df(cF(a))},coordsChar:function(a){var b=N(bc);return de(a.x-b.left,a.y-b.top)},getSearchCursor:function(a,b,c){return new dC(a,b,c)},markText:dB(cT),setBookmark:cU,setMarker:dB(cV),clearMarker:dB(cW),setLineClass:dB(cY),hideLine:dB(function(a){return cZ(a,!0)}),showLine:dB(function(a){return cZ(a,!1)}),lineInfo:c$,addWidget:function(a,b,c,d,e){a=dd(cF(a));var f=a.yBot,g=a.x;b.style.position="absolute",$.appendChild(b);if(d=="over")f=a.y;else if(d=="near"){var h=Math.max(U.offsetHeight,bl.height*di()),i=Math.max($.clientWidth,bc.clientWidth)-dm();a.yBot+b.offsetHeight>h&&a.y>b.offsetHeight&&(f=a.y-b.offsetHeight),g+b.offsetWidth>i&&(g=i-b.offsetWidth)}b.style.top=f+dl()+"px",b.style.left=b.style.right="",e=="right"?(g=$.clientWidth-b.offsetWidth,b.style.right="0px"):(e=="left"?g=0:e=="middle"&&(g=($.clientWidth-b.offsetWidth)/2),b.style.left=g+dm()+"px"),c&&ct(g,f,g+b.offsetWidth,f+b.offsetHeight)},lineCount:function(){return bl.size},getCursor:function(a){return a==null&&(a=bo.inverted),R(a?bo.from:bo.to)},somethingSelected:function(){return!P(bo.from,bo.to)},setCursor:dB(function(a,b){b==null&&typeof a.line=="number"?cD(a.line,a.ch):cD(a,b)}),setSelection:dB(function(a,b){cB(cF(a),cF(b||a))}),getLine:function(a){if(bO(a))return bQ(a).text},setLine:dB(function(a,b){bO(a)&&cg(b,{line:a,ch:0},{line:a,ch:bQ(a).text.length})}),removeLine:dB(function(a){bO(a)&&cg("",{line:a,ch:0},cF({line:a+1,ch:0}))}),replaceRange:dB(cg),getRange:function(a,b){return cj(cF(a),cF(b))},coordsFromIndex:function(a){var b=0,c;return bl.iter(0,bl.size,function(d){var e=d.text.length+1;if(e>a)return c=a,!0;a-=e,++b}),cF({line:b,ch:c})},operation:function(a){return dB(a)()},refresh:function(){cv(!0)},getInputField:function(){return M},getWrapperElement:function(){return K},getScrollerElement:function(){return U},getGutterElement:function(){return ba}},cl=!1;cS.prototype.clear=dB(function(){for(var a=0,b=this.set.length;a<b;++a){var c=this.set[a].marked;if(!c)continue;for(var d=0;d<c.length;++d)c[d].set==this.set&&c.splice(d--,1)}bv.push({from:0,to:bl.size})}),cS.prototype.find=function(){var a,b;for(var c=0,d=this.set.length;c<d;++c){var e=this.set[c],f=e.marked;for(var g=0;g<f.length;++g){var h=f[g];if(h.set==this.set)if(h.from!=null||h.to!=null){var i=o(e);i!=null&&(h.from!=null&&(a={line:i,ch:h.from}),h.to!=null&&(b={line:i,ch:h.to}))}}}return{from:a,to:b}};var db=Math.floor(Math.random()*16777215).toString(16),dg,dh,dj,dh=0,dr={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},dA=0;dC.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){function d(a){var c={line:a,ch:0};return b.pos={from:c,to:c},b.atOccurrence=!1,!1}var b=this,c=cF(a?this.pos.from:this.pos.to);for(;;){if(this.pos=this.matches(a,c))return this.atOccurrence=!0,this.pos.match||!0;if(a){if(!c.line)return d(0);c={line:c.line-1,ch:bQ(c.line-1).text.length}}else{if(c.line==bl.size-1)return d(bl.size);c={line:c.line+1,ch:0}}}},from:function(){if(this.atOccurrence)return R(this.pos.from)},to:function(){if(this.atOccurrence)return R(this.pos.to)},replace:function(a){var b=this;this.atOccurrence&&dB(function(){b.pos.to=cg(a,b.pos.from,b.pos.to)})()}};for(var dD in d)d.propertyIsEnumerable(dD)&&!bP.propertyIsEnumerable(dD)&&(bP[dD]=d[dD]);return bP}function e(a,b){if(b===!0)return b;if(a.copyState)return a.copyState(b);var c={};for(var d in b){var e=b[d];e instanceof Array&&(e=e.concat([])),c[d]=e}return c}function f(a,b,c){return a.startState?a.startState(b,c):!0}function g(a){this.pos=this.start=0,this.string=a}function h(a,b,c,d){this.from=a,this.to=b,this.style=c,this.set=d}function i(a){this.from=a,this.to=a,this.line=null}function j(a,b){this.styles=b||[a,null],this.text=a,this.height=1,this.marked=this.gutterMarker=this.className=null,this.stateAfter=this.parent=this.hidden=null}function k(a,b,c,d){for(var e=0,f=0,g=0;f<b;e+=2){var h=c[e],i=f+h.length;g==0?(i>a&&d.push(h.slice(a-f,Math.min(h.length,b-f)),c[e+1]),i>=a&&(g=1)):g==1&&(i>b?d.push(h.slice(0,b-f),c[e+1]):d.push(h,c[e+1])),f=i}}function l(a){this.lines=a,this.parent=null;for(var b=0,c=a.length,d=0;b<c;++b)a[b].parent=this,d+=a[b].height;this.height=d}function m(a){this.children=a;var b=0,c=0;for(var d=0,e=a.length;d<e;++d){var f=a[d];b+=f.chunkSize(),c+=f.height,f.parent=this}this.size=b,this.height=c,this.parent=null}function n(a,b){for(;;){for(var c=0,d=a.children.length;c<d;++c){var e=a.children[c],f=e.chunkSize();if(b<f){a=e;break}b-=f}if(a.lines)return a.lines[b]}}function o(a){if(a.parent==null)return null;var b=a.parent,c=W(b.lines,a);for(var d=b.parent;d;b=d,d=d.parent)for(var e=0,f=d.children.length;;++e){if(d.children[e]==b)break;c+=d.children[e].chunkSize()}return c}function p(a,b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.height;if(b<g){a=f;continue a}b-=g,c+=f.chunkSize()}return c}while(!a.lines);for(var d=0,e=a.lines.length;d<e;++d){var h=a.lines[d],i=h.height;if(b<i)break;b-=i}return c+d}function q(a,b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.chunkSize();if(b<g){a=f;continue a}b-=g,c+=f.height}return c}while(!a.lines);for(var d=0;d<b;++d)c+=a.lines[d].height;return c}function r(){this.time=0,this.done=[],this.undone=[]}function s(){w(this)}function t(a){return a.stop||(a.stop=s),a}function u(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function v(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function w(a){u(a),v(a)}function x(a){return a.target||a.srcElement}function y(a){if(a.which)return a.which;if(a.button&1)return 1;if(a.button&2)return 3;if(a.button&4)return 2}function z(a,b,c,d){function e(a){c(a||window.event)}if(typeof a.addEventListener=="function"){a.addEventListener(b,e,!1);if(d)return function(){a.removeEventListener(b,e,!1)}}else{a.attachEvent("on"+b,e);if(d)return function(){a.detachEvent("on"+b,e)}}}function A(){this.id=null}function L(a,b){b==null&&(b=a.search(/[^\s\u00a0]/),b==-1&&(b=a.length));for(var c=0,d=0;c<b;++c)a.charAt(c)=="\t"?d+=G-d%G:++d;return d}function M(a){return a.currentStyle?a.currentStyle:window.getComputedStyle(a,null)}function N(a,b){var c=a.ownerDocument.body,d=0,e=0,f=!1;for(var g=a;g;g=g.offsetParent){var h=g.offsetLeft,i=g.offsetTop;g==c?(d+=Math.abs(h),e+=Math.abs(i)):(d+=h,e+=i),b&&M(g).position=="fixed"&&(f=!0)}var j=b&&!f?null:c;for(var g=a.parentNode;g!=j;g=g.parentNode)g.scrollLeft!=null&&(d-=g.scrollLeft,e-=g.scrollTop);return{left:d,top:e}}function O(a){return a.textContent||a.innerText||a.nodeValue||""}function P(a,b){return a.line==b.line&&a.ch==b.ch}function Q(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function R(a){return{line:a.line,ch:a.ch}}function T(a){return U?(S.innerHTML="",S.appendChild(document.createTextNode(a))):S.textContent=a,S.innerHTML}function V(a,b){if(!b)return a?a.length:0;if(!a)return b.length;for(var c=a.length,d=b.length;c>=0&&d>=0;--c,--d)if(a.charAt(c)!=b.charAt(d))break;return d+1}function W(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;++c)if(a[c]==b)return c;return-1}a.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,tabMode:"classic",enterMode:"indent",electricChars:!0,onKeyEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,smartHome:!0,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,workTime:100,workDelay:200,undoDepth:40,tabindex:null,pollForIME:!1,document:window.document};var b={},c={};a.defineMode=function(c,d){!a.defaults.mode&&c!="null"&&(a.defaults.mode=c),b[c]=d},a.defineMIME=function(a,b){c[a]=b},a.getMode=function(d,e){typeof e=="string"&&c.hasOwnProperty(e)&&(e=c[e]);if(typeof e=="string")var f=e,g={};else if(e!=null)var f=e.name,g=e;var h=b[f];return h?h(d,g||{}):(window.console&&console.warn("No mode "+f+" found, falling back to plain text."),a.getMode(d,"text/plain"))},a.listModes=function(){var a=[];for(var c in b)b.propertyIsEnumerable(c)&&a.push(c);return a},a.listMIMEs=function(){var a=[];for(var b in c)c.propertyIsEnumerable(b)&&a.push({mime:b,mode:c[b]});return a};var d={};a.defineExtension=function(a,b){d[a]=b},a.fromTextArea=function(b,c){function d(){b.value=h.getValue()}c||(c={}),c.value=b.value,!c.tabindex&&b.tabindex&&(c.tabindex=b.tabindex);if(b.form){var e=z(b.form,"submit",d,!0);if(typeof b.form.submit=="function"){var f=b.form.submit;function g(){d(),b.form.submit=f,b.form.submit(),b.form.submit=g}b.form.submit=g}}b.style.display="none";var h=a(function(a){b.parentNode.insertBefore(a,b.nextSibling)},c);return h.save=d,h.toTextArea=function(){d(),b.parentNode.removeChild(h.getWrapperElement()),b.style.display="",b.form&&(e(),typeof b.form.submit=="function"&&(b.form.submit=f))},h},a.copyState=e,a.startState=f,g.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var b=this.string.charAt(this.pos);if(typeof a=="string")var c=b==a;else var c=b&&(a.test?a.test(b):a(b));if(c)return++this.pos,b},eatWhile:function(a){var b=this.pos;while(this.eat(a));return this.pos>b},eatSpace:function(){var a=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){var b=this.string.indexOf(a,this.pos);if(b>-1)return this.pos=b,!0},backUp:function(a){this.pos-=a},column:function(){return L(this.string,this.start)},indentation:function(){return L(this.string)},match:function(a,b,c){if(typeof a!="string"){var e=this.string.slice(this.pos).match(a);return e&&b!==!1&&(this.pos+=e[0].length),e}function d(a){return c?a.toLowerCase():a}if(d(this.string).indexOf(d(a),this.pos)==this.pos)return b!==!1&&(this.pos+=a.length),!0},current:function(){return this.string.slice(this.start,this.pos)}},a.StringStream=g,h.prototype={attach:function(a){this.set.push(a)},detach:function(a){var b=W(this.set,a);b>-1&&this.set.splice(b,1)},split:function(a,b){if(this.to<=a&&this.to!=null)return null;var c=this.from<a||this.from==null?null:this.from-a+b,d=this.to==null?null:this.to-a+b;return new h(c,d,this.style,this.set)},dup:function(){return new h(null,null,this.style,this.set)},clipTo:function(a,b,c,d,e){this.from!=null&&this.from>=b&&(this.from=Math.max(d,this.from)+e),this.to!=null&&this.to>b&&(this.to=d<this.to?this.to+e:b),a&&d>this.from&&(d<this.to||this.to==null)&&(this.from=null),c&&(b<this.to||this.to==null)&&(b>this.from||this.from==null)&&(this.to=null)},isDead:function(){return this.from!=null&&this.to!=null&&this.from>=this.to},sameSet:function(a){return this.set==a.set}},i.prototype={attach:function(a){this.line=a},detach:function(a){this.line==a&&(this.line=null)},split:function(a,b){if(a<this.from)return this.from=this.to=this.from-a+b,this},isDead:function(){return this.from>this.to},clipTo:function(a,b,c,d,e){(a||b<this.from)&&(c||d>this.to)?(this.from=0,this.to=-1):this.from>b&&(this.from=this.to=Math.max(d,this.from)+e)},sameSet:function(a){return!1},find:function(){return!this.line||!this.line.parent?null:{line:o(this.line),ch:this.from}},clear:function(){if(this.line){var a=W(this.line.marked,this);a!=-1&&this.line.marked.splice(a,1),this.line=null}}},j.inheritMarks=function(a,b){var c=new j(a),d=b.marked;if(d)for(var e=0;e<d.length;++e)if(d[e].to==null&&d[e].style){var f=c.marked||(c.marked=[]),g=d[e],h=g.dup();f.push(h),h.attach(c)}return c},j.prototype={replace:function(a,b,c){!a&&(b==null||b==this.text.length)&&(this.className=this.gutterMarker=null);var d=[],e=this.marked,f=b==null?this.text.length:b;k(0,a,this.styles,d),c&&d.push(c,null),k(f,this.text.length,this.styles,d),this.styles=d,this.text=this.text.slice(0,a)+c+this.text.slice(f),this.stateAfter=null;if(e){var g=c.length-(f-a);for(var h=0,i=e[h];h<e.length;++h)i.clipTo(a==null,a||0,b==null,f,g),i.isDead()&&(i.detach(this),e.splice(h--,1))}},split:function(a,b){var c=[b,null],d=this.marked;k(a,this.text.length,this.styles,c);var e=new j(b+this.text.slice(a),c);if(d)for(var f=0;f<d.length;++f){var g=d[f],h=g.split(a,b.length);h&&(e.marked||(e.marked=[]),e.marked.push(h),h.attach(e))}return e},append:function(a){var b=this.text.length,c=a.marked,d=this.marked;this.text+=a.text,k(0,a.text.length,a.styles,this.styles);if(d)for(var e=0;e<d.length;++e)d[e].to==null&&(d[e].to=b);if(c&&c.length){d||(this.marked=d=[]);a:for(var e=0;e<c.length;++e){var f=c[e];if(!f.from)for(var g=0;g<d.length;++g){var h=d[g];if(h.to==b&&h.sameSet(f)){h.to=f.to==null?null:f.to+b,h.isDead()&&(h.detach(this),c.splice(e--,1));continue a}}d.push(f),f.attach(this),f.from+=b,f.to!=null&&(f.to+=b)}}},fixMarkEnds:function(a){var b=this.marked,c=a.marked;if(!b)return;for(var d=0;d<b.length;++d){var e=b[d],f=e.to==null;if(f&&c)for(var g=0;g<c.length;++g)if(c[g].sameSet(e)){f=!1;break}f&&(e.to=this.text.length)}},addMark:function(a){a.attach(this),this.marked==null&&(this.marked=[]),this.marked.push(a),this.marked.sort(function(a,b){return(a.from||0)-(b.from||0)})},highlight:function(a,b){var c=new g(this.text),d=this.styles,e=0,f=!1,h=d[0],i;this.text==""&&a.blankLine&&a.blankLine(b);while(!c.eol()){var j=a.token(c,b),k=this.text.slice(c.start,c.pos);c.start=c.pos,e&&d[e-1]==j?d[e-2]+=k:k&&(!f&&(d[e+1]!=j||e&&d[e-2]!=i)&&(f=!0),d[e++]=k,d[e++]=j,i=h,h=d[e]);if(c.pos>5e3){d[e++]=this.text.slice(c.pos),d[e++]=null;break}}return d.length!=e&&(d.length=e,f=!0),e&&d[e-2]!=i&&(f=!0),f||(d.length<5&&this.text.length<10?null:!1)},getTokenAt:function(a,b,c){var d=this.text,e=new g(d);while(e.pos<c&&!e.eol()){e.start=e.pos;var f=a.token(e,b)}return{start:e.start,end:e.pos,string:e.current(),className:f||null,state:b}},indentation:function(){return L(this.text)},getHTML:function(a,b,c,d){function g(a,b){if(!a)return;f&&D&&a.charAt(0)==" "&&(a=" "+a.slice(1)),f=!1,b?e.push('<span class="',b,'">',T(a),"</span>"):e.push(T(a))}var e=[],f=!0;c&&e.push(this.className?'<pre class="'+this.className+'">':"<pre>");var h=this.styles,i=this.text,j=this.marked;a==b&&(a=null);var k=i.length;d!=null&&(k=Math.min(d,k));if(!i&&d==null)g(" ",a!=null&&b==null?"CodeMirror-selected":null);else if(!j&&a==null)for(var l=0,m=0;m<k;l+=2){var n=h[l],o=h[l+1],p=n.length;m+p>k&&(n=n.slice(0,k-m)),m+=p,g(n,o&&"cm-"+o)}else{var q=0,l=0,r="",o,s=0,t=-1,u=null;function v(){j&&(t+=1,u=t<j.length?j[t]:null)}v();while(q<k){var w=k,x="";if(a!=null)if(a>q)w=a;else if(b==null||b>q)x=" CodeMirror-selected",b!=null&&(w=Math.min(w,b));while(u&&u.to!=null&&u.to<=q)v();u&&(u.from>q?w=Math.min(w,u.from):(x+=" "+u.style,u.to!=null&&(w=Math.min(w,u.to))));for(;;){var y=q+r.length,z=o;x&&(z=o?o+x:x),g(y>w?r.slice(0,w-q):r,z);if(y>=w){r=r.slice(w-q),q=w;break}q=y,r=h[l++],o="cm-"+h[l++]}}a!=null&&b==null&&g(" ","CodeMirror-selected")}return c&&e.push("</pre>"),e.join("")},cleanUp:function(){this.parent=null;if(this.marked)for(var a=0,b=this.marked.length;a<b;++a)this.marked[a].detach(this)}},l.prototype={chunkSize:function(){return this.lines.length},remove:function(a,b){for(var c=a,d=a+b;c<d;++c){var e=this.lines[c];e.cleanUp(),this.height-=e.height}this.lines.splice(a,b)},collapse:function(a){a.splice.apply(a,[a.length,0].concat(this.lines))},insertHeight:function(a,b,c){this.height+=c,this.lines.splice.apply(this.lines,[a,0].concat(b));for(var d=0,e=b.length;d<e;++d)b[d].parent=this},iterN:function(a,b,c){for(var d=a+b;a<d;++a)if(c(this.lines[a]))return!0}},m.prototype={chunkSize:function(){return this.size},remove:function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var d=this.children[c],e=d.chunkSize();if(a<e){var f=Math.min(b,e-a),g=d.height;d.remove(a,f),this.height-=g-d.height,e==f&&(this.children.splice(c--,1),d.parent=null);if((b-=f)==0)break;a=0}else a-=e}if(this.size-b<25){var h=[];this.collapse(h),this.children=[new l(h)]}},collapse:function(a){for(var b=0,c=this.children.length;b<c;++b)this.children[b].collapse(a)},insert:function(a,b){var c=0;for(var d=0,e=b.length;d<e;++d)c+=b[d].height;this.insertHeight(a,b,c)},insertHeight:function(a,b,c){this.size+=b.length,this.height+=c;for(var d=0,e=this.children.length;d<e;++d){var f=this.children[d],g=f.chunkSize();if(a<=g){f.insertHeight(a,b,c);if(f.lines&&f.lines.length>50){while(f.lines.length>50){var h=f.lines.splice(f.lines.length-25,25),i=new l(h);f.height-=i.height,this.children.splice(d+1,0,i),i.parent=this}this.maybeSpill()}break}a-=g}},maybeSpill:function(){if(this.children.length<=10)return;var a=this;do{var b=a.children.splice(a.children.length-5,5),c=new m(b);if(!a.parent){var d=new m(a.children);d.parent=a,a.children=[d,c],a=d}else{a.size-=c.size,a.height-=c.height;var e=W(a.parent.children,a);a.parent.children.splice(e+1,0,c)}c.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()},iter:function(a,b,c){this.iterN(a,b-a,c)},iterN:function(a,b,c){for(var d=0,e=this.children.length;d<e;++d){var f=this.children[d],g=f.chunkSize();if(a<g){var h=Math.min(b,g-a);if(f.iterN(a,h,c))return!0;if((b-=h)==0)break;a=0}else a-=g}}},r.prototype={addChange:function(a,b,c){this.undone.length=0;var d=+(new Date),e=this.done[this.done.length-1];if(d-this.time>400||!e||e.start>a+b||e.start+e.added<a-e.added+e.old.length)this.done.push({start:a,added:b,old:c});else{var f=0;if(a<e.start){for(var g=e.start-a-1;g>=0;--g)e.old.unshift(c[g]);e.added+=e.start-a,e.start=a}else e.start<a&&(f=a-e.start,b+=f);for(var g=e.added-f,h=c.length;g<h;++g)e.old.push(c[g]);e.added<b&&(e.added=b)}this.time=d}},A.prototype={set:function(a,b){clearTimeout(this.id),this.id=setTimeout(b,a)}};var B=function(){if(/MSIE [1-8]\b/.test(navigator.userAgent))return!1;var a=document.createElement("div");return"draggable"in a}(),C=/gecko\/\d{7}/i.test(navigator.userAgent),D=/MSIE \d/.test(navigator.userAgent),E=/WebKit\//.test(navigator.userAgent),F="\n";(function(){var a=document.createElement("textarea");a.value="foo\nbar",a.value.indexOf("\r")>-1&&(F="\r\n")})();var G=8,H=/Mac/.test(navigator.platform),I=/Win/.test(navigator.platform),J={};for(var K=35;K<=40;++K)J[K]=J["c"+K]=!0;document.documentElement.getBoundingClientRect!=null&&(N=function(a,b){try{var c=a.getBoundingClientRect();c={top:c.top,left:c.left}}catch(d){c={top:0,left:0}}if(!b)if(window.pageYOffset==null){var e=document.documentElement||document.body.parentNode;e.scrollTop==null&&(e=document.body),c.top+=e.scrollTop,c.left+=e.scrollLeft}else c.top+=window.pageYOffset,c.left+=window.pageXOffset;return c});var S=document.createElement("pre"),U=T("\t")!="\t";a.htmlEscape=T;var X,Y,Z;return"\n\nb".split(/\n/).length!=3?X=function(a){var b=0,c,d=[];while((c=a.indexOf("\n",b))>-1)d.push(a.slice(b,a.charAt(c-1)=="\r"?c-1:c)),b=c+1;return d.push(a.slice(b)),d}:X=function(a){return a.split(/\r?\n/)},a.splitLines=X,window.getSelection?(Y=function(a){try{return{start:a.selectionStart,end:a.selectionEnd}}catch(b){return null}},E?Z=function(a,b,c){b==c?a.setSelectionRange(b,c):(a.setSelectionRange(b,c-1),window.getSelection().modify("extend","forward","character"))}:Z=function(a,b,c){try{a.setSelectionRange(b,c)}catch(d){}}):(Y=function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){return null}if(!b||b.parentElement()!=a)return null;var d=a.value,e=d.length,f=a.createTextRange();f.moveToBookmark(b.getBookmark());var g=a.createTextRange();g.collapse(!1);if(f.compareEndPoints("StartToEnd",g)>-1)return{start:e,end:e};var h=-f.moveStart("character",-e);for(var i=d.indexOf("\r");i>-1&&i<h;i=d.indexOf("\r",i+1),h++);if(f.compareEndPoints("EndToEnd",g)>-1)return{start:h,end:e};var j=-f.moveEnd("character",-e);for(var i=d.indexOf("\r");i>-1&&i<j;i=d.indexOf("\r",i+1),j++);return{start:h,end:j}},Z=function(a,b,c){var d=a.createTextRange();d.collapse(!0);var e=d.duplicate(),f=0,g=a.value;for(var h=g.indexOf("\n");h>-1&&h<b;h=g.indexOf("\n",h+1))++f;d.move("character",b-f);for(;h>-1&&h<c;h=g.indexOf("\n",h+1))++f;e.move("character",c-f),d.setEndPoint("EndToEnd",e),d.select()}),a.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}}),a.defineMIME("text/plain","null"),a}();return a}),define("tp/popup",["jQuery"],function($){$.widget("ui.popup",$.ui.dialog,{options:{modal:!0,position:"center",draggable:!1,resizable:!1,fitToWindow:!0,horizontalPadding:20,verticalPadding:20},_create:function(){$.ui.dialog.prototype._create.apply(this);var a=$.proxy(this._resize,this),b=$.proxy(this.close,this);this.element.bind("popupopen",function(){$(window).bind("resize",a),$(".ui-widget-overlay").click(b)}),this.element.unbind("popupclose",function(){$(window).unbind("resize",a),$("ui-widget-overlay").unbind("click",b)});var c=this;this.element.bind("popupresize",function(){c.uiDialog.width()<c.options.minWidth&&c.uiDialog.width(c.options.minWidth),c.element.width()!=c.uiDialog.width()&&c.element.width(c.uiDialog.width())})},close:function(){$.ui.dialog.prototype.close.apply(this)},_init:function(){$.ui.dialog.prototype._init.apply(this),this.element.parent().addClass("tau-dialog-container"),this._resize()},destroy:function(){$.ui.dialog.prototype.destroy.apply(this)},open:function(){$.ui.dialog.prototype.open.apply(this,arguments),this._resize()},_setOption:function(a,b){$.ui.dialog.prototype._setOption.apply(this,arguments)},_resize:function(){if(this.options.fitToWindow){var a=$(window).width(),b=Math.max(this.options.minWidth,a-2*this.options.horizontalPadding);this.uiDialog.width(b),this.element.width(b);var c=$(window).height(),d=Math.max(this.options.minHeight,c-2*this.options.verticalPadding);this.uiDialog.height(d),this.element.height(d-this.uiDialog.find(".ui-dialog-titlebar").outerHeight(!1))}this._setOption("position",this._getOffset()),this._trigger("resize")},_getOffset:function(){var a=$("body"),b=a.width(),c=a.height(),d=(b-this.element.width())/2,e=Math.max((c-this.element.height())/2,50);return{top:e,left:d}}})}),define("tp/codemirror/mode/diff/diff",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("diff",function(){return{token:function(a){var b=a.next();a.skipToEnd();if(b=="+")return"plus";if(b=="-")return"minus";if(b=="@")return"rangeinfo"}}}),a.defineMIME("text/x-diff","diff")}),define("tp/codemirror/mode/clike/clike",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("clike",function(a,b){function k(a,b){var c=a.next();if(g[c]){var h=g[c](a,b);if(h!==!1)return h}if(c=='"'||c=="'")return b.tokenize=l(c),b.tokenize(a,b);if(/[\[\]{}\(\),;\:\.]/.test(c))return j=c,null;if(/\d/.test(c))return a.eatWhile(/[\w\.]/),"number";if(c=="/"){if(a.eat("*"))return b.tokenize=m,m(a,b);if(a.eat("/"))return a.skipToEnd(),"comment"}if(i.test(c))return a.eatWhile(i),"operator";a.eatWhile(/[\w\$_]/);var k=a.current();return d.propertyIsEnumerable(k)?(e.propertyIsEnumerable(k)&&(j="newstatement"),"keyword"):f.propertyIsEnumerable(k)?"atom":"word"}function l(a){return function(b,c){var d=!1,e,f=!1;while((e=b.next())!=null){if(e==a&&!d){f=!0;break}d=!d&&e=="\\"}if(f||!d&&!h)c.tokenize=k;return"string"}}function m(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=k;break}c=d=="*"}return"comment"}function n(a,b,c,d,e){this.indented=a,this.column=b,this.type=c,this.align=d,this.prev=e}function o(a,b,c){return a.context=new n(a.indented,b,c,null,a.context)}function p(a){var b=a.context.type;if(b==")"||b=="]"||b=="}")a.indented=a.context.indented;return a.context=a.context.prev}var c=a.indentUnit,d=b.keywords||{},e=b.blockKeywords||{},f=b.atoms||{},g=b.hooks||{},h=b.multiLineStrings,i=/[+\-*&%=<>!?|\/]/,j;return{startState:function(a){return{tokenize:null,context:new n((a||0)-c,0,"top",!1),indented:0,startOfLine:!0}},token:function(a,b){var c=b.context;a.sol()&&(c.align==null&&(c.align=!1),b.indented=a.indentation(),b.startOfLine=!0);if(a.eatSpace())return null;j=null;var d=(b.tokenize||k)(a,b);if(d=="comment"||d=="meta")return d;c.align==null&&(c.align=!0);if(j!=";"&&j!=":"||c.type!="statement")if(j=="{")o(b,a.column(),"}");else if(j=="[")o(b,a.column(),"]");else if(j=="(")o(b,a.column(),")");else if(j=="}"){while(c.type=="statement")c=p(b);c.type=="}"&&(c=p(b));while(c.type=="statement")c=p(b)}else j==c.type?p(b):(c.type=="}"||c.type=="top"||c.type=="statement"&&j=="newstatement")&&o(b,a.column(),"statement");else p(b);return b.startOfLine=!1,d},indent:function(a,b){if(a.tokenize!=k&&a.tokenize!=null)return 0;var d=b&&b.charAt(0),e=a.context,f=d==e.type;return e.type=="statement"?e.indented+(d=="{"?0:c):e.align?e.column+(f?0:1):e.indented+(f?0:c)},electricChars:"{}"}}),function(){function b(a){var b={},c=a.split(" ");for(var d=0;d<c.length;++d)b[c[d]]=!0;return b}function d(a,b){return b.startOfLine?(a.skipToEnd(),"meta"):!1}function e(a,b){var c;while((c=a.next())!=null)if(c=='"'&&!a.eat('"')){b.tokenize=null;break}return"string"}var c="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";a.defineMIME("text/x-csrc",{name:"clike",keywords:b(c),blockKeywords:b("case do else for if switch while struct"),atoms:b("null"),hooks:{"#":d}}),a.defineMIME("text/x-c++src",{name:"clike",keywords:b(c+" asm dynamic_cast namespace reinterpret_cast try bool explicit new "+"static_cast typeid catch operator template typename class friend private "+"this using const_cast inline public throw virtual delete mutable protected "+"wchar_t"),blockKeywords:b("catch class do else finally for if struct switch try while"),atoms:b("true false null"),hooks:{"#":d}}),a.defineMIME("text/x-java",{name:"clike",keywords:b("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:b("catch class do else finally for if switch try while"),atoms:b("true false null"),hooks:{"@":function(a,b){return a.eatWhile(/[\w\$_]/),"meta"}}}),a.defineMIME("text/x-csharp",{name:"clike",keywords:b("abstract as base bool break byte case catch char checked class const continue decimal default delegate do double else enum event explicit extern finally fixed float for foreach goto if implicit in int interface internal is lock long namespace new object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw try typeof uint ulong unchecked unsafe ushort using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:b("catch class do else finally for foreach if struct switch try while"),atoms:b("true false null"),hooks:{"@":function(a,b){return a.eat('"')?(b.tokenize=e,e(a,b)):(a.eatWhile(/[\w\$_]/),"meta")}}}),a.defineMIME("text/x-groovy",{name:"clike",keywords:b("abstract as assert boolean break byte case catch char class const continue def default do double else enum extends final finally float for goto if implements import in instanceof int interface long native new package property private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),atoms:b("true false null"),hooks:{"@":function(a,b){return a.eatWhile(/[\w\$_]/),"meta"}}})}()}),define("tp/codemirror/mode/css/css",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("css",function(a){function d(a,b){return c=b,a}function e(a,b){var c=a.next();if(c=="@")return a.eatWhile(/[\w\\\-]/),d("meta",a.current());if(c=="/"&&a.eat("*"))return b.tokenize=f,f(a,b);if(c=="<"&&a.eat("!"))return b.tokenize=g,g(a,b);if(c=="=")d(null,"compare");else return c!="~"&&c!="|"||!a.eat("=")?c=='"'||c=="'"?(b.tokenize=h(c),b.tokenize(a,b)):c=="#"?(a.eatWhile(/[\w\\\-]/),d("atom","hash")):c=="!"?(a.match(/^\s*\w*/),d("keyword","important")):/\d/.test(c)?(a.eatWhile(/[\w.%]/),d("number","unit")):/[,.+>*\/]/.test(c)?d(null,"select-op"):/[;{}:\[\]]/.test(c)?d(null,c):(a.eatWhile(/[\w\\\-]/),d("variable","variable")):d(null,"compare")}function f(a,b){var c=!1,f;while((f=a.next())!=null){if(c&&f=="/"){b.tokenize=e;break}c=f=="*"}return d("comment","comment")}function g(a,b){var c=0,f;while((f=a.next())!=null){if(c>=2&&f==">"){b.tokenize=e;break}c=f=="-"?c+1:0}return d("comment","comment")}function h(a){return function(b,c){var f=!1,g;while((g=b.next())!=null){if(g==a&&!f)break;f=!f&&g=="\\"}return f||(c.tokenize=e),d("string","string")}}var b=a.indentUnit,c;return{startState:function(a){return{tokenize:e,baseIndent:a||0,stack:[]}},token:function(a,b){if(a.eatSpace())return null;var d=b.tokenize(a,b),e=b.stack[b.stack.length-1];if(c=="hash"&&e=="rule")d="atom";else if(d=="variable")if(e=="rule")d="number";else if(!e||e=="@media{")d="tag";return e=="rule"&&/^[\{\};]$/.test(c)&&b.stack.pop(),c=="{"?e=="@media"?b.stack[b.stack.length-1]="@media{":b.stack.push("{"):c=="}"?b.stack.pop():c=="@media"?b.stack.push("@media"):e=="{"&&c!="comment"&&b.stack.push("rule"),d},indent:function(a,c){var d=a.stack.length;return/^\}/.test(c)&&(d-=a.stack[a.stack.length-1]=="rule"?2:1),a.baseIndent+d*b},electricChars:"}"}}),a.defineMIME("text/css","css")}),define("tp/codemirror/mode/htmlmixed/htmlmixed",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("htmlmixed",function(b,c){function g(a,b){var c=d.token(a,b.htmlState);return c=="tag"&&a.current()==">"&&b.htmlState.context&&(/^script$/i.test(b.htmlState.context.tagName)?(b.token=i,b.localState=e.startState(d.indent(b.htmlState,"")),b.mode="javascript"):/^style$/i.test(b.htmlState.context.tagName)&&(b.token=j,b.localState=f.startState(d.indent(b.htmlState,"")),b.mode="css")),c}function h(a,b,c){var d=a.current(),e=d.search(b);return e>-1&&a.backUp(d.length-e),c}function i(a,b){return a.match(/^<\/\s*script\s*>/i,!1)?(b.token=g,b.curState=null,b.mode="html",g(a,b)):h(a,/<\/\s*script\s*>/,e.token(a,b.localState))}function j(a,b){return a.match(/^<\/\s*style\s*>/i,!1)?(b.token=g,b.localState=null,b.mode="html",g(a,b)):h(a,/<\/\s*style\s*>/,f.token(a,b.localState))}var d=a.getMode(b,{name:"xml",htmlMode:!0}),e=a.getMode(b,"javascript"),f=a.getMode(b,"css");return{startState:function(){var a=d.startState();return{token:g,localState:null,mode:"html",htmlState:a}},copyState:function(b){if(b.localState)var c=a.copyState(b.token==j?f:e,b.localState);return{token:b.token,localState:c,mode:b.mode,htmlState:a.copyState(d,b.htmlState)}},token:function(a,b){return b.token(a,b)},indent:function(a,b){return a.token==g||/^\s*<\//.test(b)?d.indent(a.htmlState,b):a.token==i?e.indent(a.localState,b):f.indent(a.localState,b)},compareStates:function(a,b){return d.compareStates(a.htmlState,b.htmlState)},electricChars:"/{}:"}}),a.defineMIME("text/html","htmlmixed")}),define("tp/codemirror/mode/javascript/javascript",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("javascript",function(a,b){function g(a,b,c){return b.tokenize=c,c(a,b)}function h(a,b){var c=!1,d;while((d=a.next())!=null){if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function k(a,b,c){return i=a,j=c,b}function l(a,b){var c=a.next();if(c=='"'||c=="'")return g(a,b,m(c));if(/[\[\]{}\(\),;\:\.]/.test(c))return k(c);if(c=="0"&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),k("number","number");if(/\d/.test(c))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),k("number","number");if(c=="/")return a.eat("*")?g(a,b,n):a.eat("/")?(a.skipToEnd(),k("comment","comment")):b.reAllowed?(h(a,"/"),a.eatWhile(/[gimy]/),k("regexp","string")):(a.eatWhile(f),k("operator",null,a.current()));if(c=="#")return a.skipToEnd(),k("error","error");if(f.test(c))return a.eatWhile(f),k("operator",null,a.current());a.eatWhile(/[\w\$_]/);var d=a.current(),i=e.propertyIsEnumerable(d)&&e[d];return i?k(i.type,i.style,d):k("variable","variable",d)}function m(a){return function(b,c){return h(b,a)||(c.tokenize=l),k("string","string")}}function n(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=l;break}c=d=="*"}return k("comment","comment")}function p(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,this.prev=e,this.info=f,d!=null&&(this.align=d)}function q(a,b){for(var c=a.localVars;c;c=c.next)if(c.name==b)return!0}function r(a,b,c,e,f){var g=a.cc;s.state=a,s.stream=f,s.marked=null,s.cc=g,a.lexical.hasOwnProperty("align")||(a.lexical.align=!0);for(;;){var h=g.length?g.pop():d?D:C;if(h(c,e)){while(g.length&&g[g.length-1].lex)g.pop()();return s.marked?s.marked:c=="variable"&&q(a,e)?"variable-2":b}}}function t(){for(var a=arguments.length-1;a>=0;a--)s.cc.push(arguments[a])}function u(){return t.apply(null,arguments),!0}function v(a){var b=s.state;if(b.context){s.marked="def";for(var c=b.localVars;c;c=c.next)if(c.name==a)return;b.localVars={name:a,next:b.localVars}}}function x(){s.state.context||(s.state.localVars=w),s.state.context={prev:s.state.context,vars:s.state.localVars}}function y(){s.state.localVars=s.state.context.vars,s.state.context=s.state.context.prev}function z(a,b){var c=function(){var c=s.state;c.lexical=new p(c.indented,s.stream.column(),a,null,c.lexical,b)};return c.lex=!0,c}function A(){var a=s.state;a.lexical.prev&&(a.lexical.type==")"&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function B(a){return function(c){return c==a?u():a==";"?t():u(arguments.callee)}}function C(a){return a=="var"?u(z("vardef"),L,B(";"),A):a=="keyword a"?u(z("form"),D,C,A):a=="keyword b"?u(z("form"),C,A):a=="{"?u(z("}"),K,A):a==";"?u():a=="function"?u(R):a=="for"?u(z("form"),B("("),z(")"),N,B(")"),A,C,A):a=="variable"?u(z("stat"),G):a=="switch"?u(z("form"),D,z("}","switch"),B("{"),K,A,A):a=="case"?u(D,B(":")):a=="default"?u(B(":")):a=="catch"?u(z("form"),x,B("("),S,B(")"),C,A,y):t(z("stat"),D,B(";"),A)}function D(a){return o.hasOwnProperty(a)?u(F):a=="function"?u(R):a=="keyword c"?u(E):a=="("?u(z(")"),D,B(")"),A,F):a=="operator"?u(D):a=="["?u(z("]"),J(D,"]"),A,F):a=="{"?u(z("}"),J(I,"}"),A,F):u()}function E(a){return a.match(/[;\}\)\],]/)?t():t(D)}function F(a,b){if(a=="operator"&&/\+\+|--/.test(b))return u(F);if(a=="operator")return u(D);if(a==";")return;if(a=="(")return u(z(")"),J(D,")"),A,F);if(a==".")return u(H,F);if(a=="[")return u(z("]"),D,B("]"),A,F)}function G(a){return a==":"?u(A,C):t(F,B(";"),A)}function H(a){if(a=="variable")return s.marked="property",u()}function I(a){a=="variable"&&(s.marked="property");if(o.hasOwnProperty(a))return u(B(":"),D)}function J(a,b){function c(d){return d==","?u(a,c):d==b?u():u(B(b))}return function(e){return e==b?u():t(a,c)}}function K(a){return a=="}"?u():t(C,K)}function L(a,b){return a=="variable"?(v(b),u(M)):u()}function M(a,b){if(b=="=")return u(D,M);if(a==",")return u(L)}function N(a){return a=="var"?u(L,P):a==";"?t(P):a=="variable"?u(O):t(P)}function O(a,b){return b=="in"?u(D):u(F,P)}function P(a,b){return a==";"?u(Q):b=="in"?u(D):u(D,B(";"),Q)}function Q(a){a!=")"&&u(D)}function R(a,b){if(a=="variable")return v(b),u(R);if(a=="(")return u(z(")"),x,J(S,")"),A,C,y)}function S(a,b){if(a=="variable")return v(b),u()}var c=a.indentUnit,d=b.json,e=function(){function a(a){return{type:a,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),f={type:"atom",style:"atom"};return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":f,"false":f,"null":f,"undefined":f,NaN:f,Infinity:f}}(),f=/[+\-*&%=<>!?|]/,i,j,o={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},s={state:null,column:null,marked:null,cc:null},w={name:"this",next:{name:"arguments"}};return A.lex=!0,{startState:function(a){return{tokenize:l,reAllowed:!0,cc:[],lexical:new p((a||0)-c,0,"block",!1),localVars:null,context:null,indented:0}},token:function(a,b){a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation());if(a.eatSpace())return null;var c=b.tokenize(a,b);return i=="comment"?c:(b.reAllowed=i=="operator"||i=="keyword c"||i.match(/^[\[{}\(,;:]$/),r(b,c,i,j,a))},indent:function(a,b){if(a.tokenize!=l)return 0;var d=b&&b.charAt(0),e=a.lexical,f=e.type,g=d==f;return f=="vardef"?e.indented+4:f=="form"&&d=="{"?e.indented:f=="stat"||f=="form"?e.indented+c:e.info=="switch"&&!g?e.indented+(/^(?:case|default)\b/.test(b)?c:2*c):e.align?e.column+(g?0:1):e.indented+(g?0:c)},electricChars:":{}"}}),a.defineMIME("text/javascript","javascript"),a.defineMIME("application/json",{name:"javascript",json:!0})}),define("tp/codemirror/mode/perl/perl",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("perl",function(a,b){function f(a,b,c,d,e){return b.chain=null,b.style=null,b.tail=null,b.tokenize=function(a,b){var f=!1,g,i=0;while(g=a.next()){if(g===c[i]&&!f)return c[++i]!==undefined?(b.chain=c[i],b.style=d,b.tail=e):e&&a.eatWhile(e),b.tokenize=h,d;f=!f&&g=="\\"}return d},b.tokenize(a,b)}function g(a,b,c){return b.tokenize=function(a,b){return a.string==c&&(b.tokenize=h),a.skipToEnd(),"string"},b.tokenize(a,b)}function h(a,b){if(a.eatSpace())return null;if(b.chain)return f(a,b,b.chain,b.style,b.tail);if(a.match(/^\-?[\d\.]/,!1)&&a.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/))return"number";if(a.match(/^<<(?=\w)/))return a.eatWhile(/\w/),g(a,b,a.current().substr(2));if(a.sol()&&a.match(/^\=item(?!\w)/))return g(a,b,"=cut");var h=a.next();if(h=='"'||h=="'"){if(a.prefix(3)=="<<"+h){var i=a.pos;a.eatWhile(/\w/);var j=a.current().substr(1);if(j&&a.eat(h))return g(a,b,j);a.pos=i}return f(a,b,[h],"string")}if(h=="q"){var k=a.look(-2);if(!k||!/\w/.test(k)){k=a.look(0);if(k=="x"){k=a.look(1);if(k=="(")return a.eatSuffix(2),f(a,b,[")"],d,e);if(k=="[")return a.eatSuffix(2),f(a,b,["]"],d,e);if(k=="{")return a.eatSuffix(2),f(a,b,["}"],d,e);if(k=="<")return a.eatSuffix(2),f(a,b,[">"],d,e);if(/[\^'"!~\/]/.test(k))return a.eatSuffix(1),f(a,b,[a.eat(k)],d,e)}else if(k=="q"){k=a.look(1);if(k=="(")return a.eatSuffix(2),f(a,b,[")"],"string");if(k=="[")return a.eatSuffix(2),f(a,b,["]"],"string");if(k=="{")return a.eatSuffix(2),f(a,b,["}"],"string");if(k=="<")return a.eatSuffix(2),f(a,b,[">"],"string");if(/[\^'"!~\/]/.test(k))return a.eatSuffix(1),f(a,b,[a.eat(k)],"string")}else if(k=="w"){k=a.look(1);if(k=="(")return a.eatSuffix(2),f(a,b,[")"],"bracket");if(k=="[")return a.eatSuffix(2),f(a,b,["]"],"bracket");if(k=="{")return a.eatSuffix(2),f(a,b,["}"],"bracket");if(k=="<")return a.eatSuffix(2),f(a,b,[">"],"bracket");if(/[\^'"!~\/]/.test(k))return a.eatSuffix(1),f(a,b,[a.eat(k)],"bracket")}else if(k=="r"){k=a.look(1);if(k=="(")return a.eatSuffix(2),f(a,b,[")"],d,e);if(k=="[")return a.eatSuffix(2),f(a,b,["]"],d,e);if(k=="{")return a.eatSuffix(2),f(a,b,["}"],d,e);if(k=="<")return a.eatSuffix(2),f(a,b,[">"],d,e);if(/[\^'"!~\/]/.test(k))return a.eatSuffix(1),f(a,b,[a.eat(k)],d,e)}else if(/[\^'"!~\/(\[{<]/.test(k)){if(k=="(")return a.eatSuffix(1),f(a,b,[")"],"string");if(k=="[")return a.eatSuffix(1),f(a,b,["]"],"string");if(k=="{")return a.eatSuffix(1),f(a,b,["}"],"string");if(k=="<")return a.eatSuffix(1),f(a,b,[">"],"string");if(/[\^'"!~\/]/.test(k))return f(a,b,[a.eat(k)],"string")}}}if(h=="m"){var k=a.look(-2);if(!k||!/\w/.test(k)){k=a.eat(/[(\[{<\^'"!~\/]/);if(k){if(/[\^'"!~\/]/.test(k))return f(a,b,[k],d,e);if(k=="(")return f(a,b,[")"],d,e);if(k=="[")return f(a,b,["]"],d,e);if(k=="{")return f(a,b,["}"],d,e);if(k=="<")return f(a,b,[">"],d,e)}}}if(h=="s"){var k=/[\/>\]})\w]/.test(a.look(-2));if(!k){k=a.eat(/[(\[{<\^'"!~\/]/);if(k)return k=="["?f(a,b,["]","]"],d,e):k=="{"?f(a,b,["}","}"],d,e):k=="<"?f(a,b,[">",">"],d,e):k=="("?f(a,b,[")",")"],d,e):f(a,b,[k,k],d,e)}}if(h=="y"){var k=/[\/>\]})\w]/.test(a.look(-2));if(!k){k=a.eat(/[(\[{<\^'"!~\/]/);if(k)return k=="["?f(a,b,["]","]"],d,e):k=="{"?f(a,b,["}","}"],d,e):k=="<"?f(a,b,[">",">"],d,e):k=="("?f(a,b,[")",")"],d,e):f(a,b,[k,k],d,e)}}if(h=="t"){var k=/[\/>\]})\w]/.test(a.look(-2));if(!k){k=a.eat("r");if(k){k=a.eat(/[(\[{<\^'"!~\/]/);if(k)return k=="["?f(a,b,["]","]"],d,e):k=="{"?f(a,b,["}","}"],d,e):k=="<"?f(a,b,[">",">"],d,e):k=="("?f(a,b,[")",")"],d,e):f(a,b,[k,k],d,e)}}}if(h=="`")return f(a,b,[h],"variable-2");if(h=="/")return/~\s*$/.test(a.prefix())?f(a,b,[h],d,e):"operator";if(h=="$"){var i=a.pos;if(a.eatWhile(/\d/)||a.eat("{")&&a.eatWhile(/\d/)&&a.eat("}"))return"variable-2";a.pos=i}if(/[$@%]/.test(h)){var i=a.pos;if(a.eat("^")&&a.eat(/[A-Z]/)||!/[@$%&]/.test(a.look(-2))&&a.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)){var k=a.current();if(c[k])return"variable-2"}a.pos=i}if(/[$@%&]/.test(h))if(a.eatWhile(/[\w$\[\]]/)||a.eat("{")&&a.eatWhile(/[\w$\[\]]/)&&a.eat("}")){var k=a.current();return c[k]?"variable-2":"variable"}if(h=="#"&&a.look(-2)!="$")return a.skipToEnd(),"comment";if(/[:+\-\^*$&%@=<>!?|\/~\.]/.test(h)){var i=a.pos;a.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/);if(c[a.current()])return"operator";a.pos=i}if(h=="_"&&a.pos==1){if(a.suffix(6)=="_END__")return f(a,b,["\0"],"comment");if(a.suffix(7)=="_DATA__")return f(a,b,["\0"],"variable-2");if(a.suffix(7)=="_C__")return f(a,b,["\0"],"string")}if(/\w/.test(h)){var i=a.pos;if(a.look(-2)=="{"&&(a.look(0)=="}"||a.eatWhile(/\w/)&&a.look(0)=="}"))return"string";a.pos=i}if(/[A-Z]/.test(h)){var l=a.look(-2),i=a.pos;a.eatWhile(/[A-Z_]/);if(/[\da-z]/.test(a.look(0)))a.pos=i;else{var k=c[a.current()];return k?(k[1]&&(k=k[0]),l!=":"?k==1?"keyword":k==2?"def":k==3?"atom":k==4?"operator":k==5?"variable-2":"meta":"meta"):"meta"}}if(/[a-zA-Z_]/.test(h)){var l=a.look(-2);a.eatWhile(/\w/);var k=c[a.current()];return k?(k[1]&&(k=k[0]),l!=":"?k==1?"keyword":k==2?"def":k==3?"atom":k==4?"operator":k==5?"variable-2":"meta":"meta"):"meta"}return null}var c={"->":4,"++":4,"--":4,"**":4,"=~":4,"!~":4,"*":4,"/":4,"%":4,x:4,"+":4,"-":4,".":4,"<<":4,">>":4,"<":4,">":4,"<=":4,">=":4,lt:4,gt:4,le:4,ge:4,"==":4,"!=":4,"<=>":4,eq:4,ne:4,cmp:4,"~~":4,"&":4,"|":4,"^":4,"&&":4,"||":4,"//":4,"..":4,"...":4,"?":4,":":4,"=":4,"+=":4,"-=":4,"*=":4,",":4,"=>":4,"::":4,not:4,and:4,or:4,xor:4,BEGIN:[5,1],END:[5,1],PRINT:[5,1],PRINTF:[5,1],GETC:[5,1],READ:[5,1],READLINE:[5,1],DESTROY:[5,1],TIE:[5,1],TIEHANDLE:[5,1],UNTIE:[5,1],STDIN:5,STDIN_TOP:5,STDOUT:5,STDOUT_TOP:5,STDERR:5,STDERR_TOP:5,$ARG:5,$_:5,"@ARG":5,"@_":5,$LIST_SEPARATOR:5,'$"':5,$PROCESS_ID:5,$PID:5,$$:5,$REAL_GROUP_ID:5,$GID:5,"$(":5,$EFFECTIVE_GROUP_ID:5,$EGID:5,"$)":5,$PROGRAM_NAME:5,$0:5,$SUBSCRIPT_SEPARATOR:5,$SUBSEP:5,"$;":5,$REAL_USER_ID:5,$UID:5,"$<":5,$EFFECTIVE_USER_ID:5,$EUID:5,"$>":5,$a:5,$b:5,$COMPILING:5,"$^C":5,$DEBUGGING:5,"$^D":5,"${^ENCODING}":5,$ENV:5,"%ENV":5,$SYSTEM_FD_MAX:5,"$^F":5,"@F":5,"${^GLOBAL_PHASE}":5,"$^H":5,"%^H":5,"@INC":5,"%INC":5,$INPLACE_EDIT:5,"$^I":5,"$^M":5,$OSNAME:5,"$^O":5,"${^OPEN}":5,$PERLDB:5,"$^P":5,$SIG:5,"%SIG":5,$BASETIME:5,"$^T":5,"${^TAINT}":5,"${^UNICODE}":5,"${^UTF8CACHE}":5,"${^UTF8LOCALE}":5,$PERL_VERSION:5,"$^V":5,"${^WIN32_SLOPPY_STAT}":5,$EXECUTABLE_NAME:5,"$^X":5,$1:5,$MATCH:5,"$&":5,"${^MATCH}":5,$PREMATCH:5,"$`":5,"${^PREMATCH}":5,$POSTMATCH:5,"$'":5,"${^POSTMATCH}":5,$LAST_PAREN_MATCH:5,"$+":5,$LAST_SUBMATCH_RESULT:5,"$^N":5,"@LAST_MATCH_END":5,"@+":5,"%LAST_PAREN_MATCH":5,"%+":5,"@LAST_MATCH_START":5,"@-":5,"%LAST_MATCH_START":5,"%-":5,$LAST_REGEXP_CODE_RESULT:5,"$^R":5,"${^RE_DEBUG_FLAGS}":5,"${^RE_TRIE_MAXBUF}":5,$ARGV:5,"@ARGV":5,ARGV:5,ARGVOUT:5,$OUTPUT_FIELD_SEPARATOR:5,$OFS:5,"$,":5,$INPUT_LINE_NUMBER:5,$NR:5,"$.":5,$INPUT_RECORD_SEPARATOR:5,$RS:5,"$/":5,$OUTPUT_RECORD_SEPARATOR:5,$ORS:5,"$\\":5,$OUTPUT_AUTOFLUSH:5,"$|":5,$ACCUMULATOR:5,"$^A":5,$FORMAT_FORMFEED:5,"$^L":5,$FORMAT_PAGE_NUMBER:5,"$%":5,$FORMAT_LINES_LEFT:5,"$-":5,$FORMAT_LINE_BREAK_CHARACTERS:5,"$:":5,$FORMAT_LINES_PER_PAGE:5,"$=":5,$FORMAT_TOP_NAME:5,"$^":5,$FORMAT_NAME:5,"$~":5,"${^CHILD_ERROR_NATIVE}":5,$EXTENDED_OS_ERROR:5,"$^E":5,$EXCEPTIONS_BEING_CAUGHT:5,"$^S":5,$WARNING:5,"$^W":5,"${^WARNING_BITS}":5,$OS_ERROR:5,$ERRNO:5,"$!":5,"%OS_ERROR":5,"%ERRNO":5,"%!":5,$CHILD_ERROR:5,"$?":5,$EVAL_ERROR:5,"$@":5,$OFMT:5,"$#":5,"$*":5,$ARRAY_BASE:5,"$[":5,$OLD_PERL_VERSION:5,"$]":5,"if":[1,1],elsif:[1,1],"else":[1,1],"while":[1,1],unless:[1,1],"for":[1,1],foreach:[1,1],abs:1,accept:1,alarm:1,atan2:1,bind:1,binmode:1,bless:1,bootstrap:1,"break":1,caller:1,chdir:1,chmod:1,chomp:1,chop:1,chown:1,chr:1,chroot:1,close:1,closedir:1,connect:1,"continue":[1,1],cos:1,crypt:1,dbmclose:1,dbmopen:1,"default":1,defined:1,"delete":1,die:1,"do":1,dump:1,each:1,endgrent:1,endhostent:1,endnetent:1,endprotoent:1,endpwent:1,endservent:1,eof:1,eval:1,exec:1,exists:1,exit:1,exp:1,fcntl:1,fileno:1,flock:1,fork:1,format:1,formline:1,getc:1,getgrent:1,getgrgid:1,getgrnam:1,gethostbyaddr:1,gethostbyname:1,gethostent:1,getlogin:1,getnetbyaddr:1,getnetbyname:1,getnetent:1,getpeername:1,getpgrp:1,getppid:1,getpriority:1,getprotobyname:1,getprotobynumber:1,getprotoent:1,getpwent:1,getpwnam:1,getpwuid:1,getservbyname:1,getservbyport:1,getservent:1,getsockname:1,getsockopt:1,given:1,glob:1,gmtime:1,"goto":1,grep:1,hex:1,"import":1,index:1,"int":1,ioctl:1,join:1,keys:1,kill:1,last:1,lc:1,lcfirst:1,length:1,link:1,listen:1,local:2,localtime:1,lock:1,log:1,lstat:1,m:null,map:1,mkdir:1,msgctl:1,msgget:1,msgrcv:1,msgsnd:1,my:2,"new":1,next:1,no:1,oct:1,open:1,opendir:1,ord:1,our:2,pack:1,"package":1,pipe:1,pop:1,pos:1,print:1,printf:1,prototype:1,push:1,q:null,qq:null,qr:null,quotemeta:null,qw:null,qx:null,rand:1,read:1,readdir:1,readline:1,readlink:1,readpipe:1,recv:1,redo:1,ref:1,rename:1,require:1,reset:1,"return":1,reverse:1,rewinddir:1,rindex:1,rmdir:1,s:null,say:1,scalar:1,seek:1,seekdir:1,select:1,semctl:1,semget:1,semop:1,send:1,setgrent:1,sethostent:1,setnetent:1,setpgrp:1,setpriority:1,setprotoent:1,setpwent:1,setservent:1,setsockopt:1,shift:1,shmctl:1,shmget:1,shmread:1,shmwrite:1,shutdown:1,sin:1,sleep:1,socket:1,socketpair:1,sort:1,splice:1,split:1,sprintf:1,sqrt:1,srand:1,stat:1,state:1,study:1,sub:1,substr:1,symlink:1,syscall:1,sysopen:1,sysread:1,sysseek:1,system:1,syswrite:1,tell:1,telldir:1,tie:1,tied:1,time:1,times:1,tr:null,truncate:1,uc:1,ucfirst:1,umask:1,undef:1,unlink:1,unpack:1,unshift:1,untie:1,use:1,utime:1,values:1,vec:1,wait:1,waitpid:1,wantarray:1,warn:1,when:1,write:1,y:null},d="string-2",e=/[goseximacplud]/;return{startState:function(){return{tokenize:h,chain:null,style:null,tail:null}},token:function(a,b){return(b.tokenize||h)(a,b)},electricChars:"{}"}}),a.defineMIME("text/x-perl","perl"),a.StringStream.prototype.look=function(a){return this.string.charAt(this.pos+(a||0))},a.StringStream.prototype.prefix=function(a){if(a){var b=this.pos-a;return this.string.substr(b>=0?b:0,a)}return this.string.substr(0,this.pos-1)},a.StringStream.prototype.suffix=function(a){var b=this.string.length,c=b-this.pos+1;return this.string.substr(this.pos,a&&a<b?a:c)},a.StringStream.prototype.nsuffix=function(a){var b=this.pos,c=a||this.string.length-this.pos+1;return this.pos+=c,this.string.substr(b,c)},a.StringStream.prototype.eatSuffix=function(a){var b=this.pos+a,c;b<=0?this.pos=0:b>=(c=this.string.length-1)?this.pos=c:this.pos=b}}),define("tp/codemirror/mode/php/php",["tp/codemirror/lib/codemirror"],function(a){(function(){function b(a){var b={},c=a.split(" ");for(var d=0;d<c.length;++d)b[c[d]]=!0;return b}function c(a){return function(b,c){return b.match(a)?c.tokenize=null:b.skipToEnd(),"string"}}var d={name:"clike",keywords:b("abstract and array as break case catch cfunction class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw try use var while xor returndie echo empty exit eval include include_once isset list require require_once print unset"),blockKeywords:b("catch do else elseif for foreach if switch try while"),atoms:b("true false null TRUE FALSE NULL"),multiLineStrings:!0,hooks:{$:function(a,b){return a.eatWhile(/[\w\$_]/),"variable-2"},"<":function(a,b){return a.match(/<</)?(a.eatWhile(/[\w\.]/),b.tokenize=c(a.current().slice(3)),b.tokenize(a,b)):!1},"#":function(a,b){return a.skipToEnd(),"comment"}}};a.defineMode("php",function(b,c){function i(a,b){if(b.curMode==e){var c=e.token(a,b.curState);return c=="meta"&&/^<\?/.test(a.current())?(b.curMode=h,b.curState=b.php,b.curClose=/^\?>/,b.mode="php"):c=="tag"&&a.current()==">"&&b.curState.context&&(/^script$/i.test(b.curState.context.tagName)?(b.curMode=f,b.curState=f.startState(e.indent(b.curState,"")),b.curClose=/^<\/\s*script\s*>/i,b.mode="javascript"):/^style$/i.test(b.curState.context.tagName)&&(b.curMode=g,b.curState=g.startState(e.indent(b.curState,"")),b.curClose=/^<\/\s*style\s*>/i,b.mode="css")),c}return a.match(b.curClose,!1)?(b.curMode=e,b.curState=b.html,b.curClose=null,b.mode="html",i(a,b)):b.curMode.token(a,b.curState)}var e=a.getMode(b,"text/html"),f=a.getMode(b,"text/javascript"),g=a.getMode(b,"text/css"),h=a.getMode(b,d);return{startState:function(){var a=e.startState();return{html:a,php:h.startState(),curMode:c.startOpen?h:e,curState:c.startOpen?h.startState():a,curClose:c.startOpen?/^\?>/:null,mode:c.startOpen?"php":"html"}},copyState:function(b){var c=b.html,d=a.copyState(e,c),f=b.php,g=a.copyState(h,f),i;return b.curState==c?i=d:b.curState==f?i=g:i=a.copyState(b.curMode,b.curState),{html:d,php:g,curMode:b.curMode,curState:i,curClose:b.curClose}},token:i,indent:function(a,b){return a.curMode!=h&&/^\s*<\//.test(b)||a.curMode==h&&/^\?>/.test(b)?e.indent(a.html,b):a.curMode.indent(a.curState,b)},electricChars:"/{}:"}}),a.defineMIME("application/x-httpd-php","php"),a.defineMIME("application/x-httpd-php-open",{name:"php",startOpen:!0}),a.defineMIME("text/x-php",d)})()}),define("tp/codemirror/mode/python/python",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("python",function(a,b){function d(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}function t(a,b){if(a.sol()){var d=b.scopes[0].offset;if(a.eatSpace()){var l=a.indentation();return l>d?s="indent":l<d&&(s="dedent"),null}d>0&&w(a,b)}if(a.eatSpace())return null;var m=a.peek();if(m==="#")return a.skipToEnd(),"comment";if(a.match(/^[0-9\.]/,!1)){var n=!1;a.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(n=!0),a.match(/^\d+\.\d*/)&&(n=!0),a.match(/^\.\d+/)&&(n=!0);if(n)return a.eat(/J/i),"number";var o=!1;a.match(/^0x[0-9a-f]+/i)&&(o=!0),a.match(/^0b[01]+/i)&&(o=!0),a.match(/^0o[0-7]+/i)&&(o=!0),a.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(a.eat(/J/i),o=!0),a.match(/^0(?![\dx])/i)&&(o=!0);if(o)return a.eat(/L/i),"number"}return a.match(p)?(b.tokenize=u(a.current()),b.tokenize(a,b)):a.match(i)||a.match(h)?null:a.match(g)||a.match(e)||a.match(k)?"operator":a.match(f)?null:a.match(r)?"builtin":a.match(q)?"keyword":a.match(j)?"variable":(a.next(),c)}function u(a){while("rub".indexOf(a.charAt(0).toLowerCase())>=0)a=a.substr(1);var d=a.length==1,e="string";return function(g,h){while(!g.eol()){g.eatWhile(/[^'"\\]/);if(g.eat("\\")){g.next();if(d&&g.eol())return e}else{if(g.match(a))return h.tokenize=t,e;g.eat(/['"]/)}}if(d){if(b.singleLineStringErrors)return c;h.tokenize=t}return e}}function v(b,c,d){d=d||"py";var e=0;if(d==="py"){for(var f=0;f<c.scopes.length;++f)if(c.scopes[f].type==="py"){e=c.scopes[f].offset+a.indentUnit;break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function w(a,b){if(b.scopes.length==1)return;if(b.scopes[0].type==="py"){var c=a.indentation(),d=-1;for(var e=0;e<b.scopes.length;++e)if(c===b.scopes[e].offset){d=e;break}if(d===-1)return!0;while(b.scopes[0].offset!==c)b.scopes.shift();return!1}return b.scopes.shift(),!1}function x(a,b){s=null;var d=b.tokenize(a,b),e=a.current();if(e===".")return d=b.tokenize(a,b),e=a.current(),d==="variable"?"variable":c;if(e==="@")return d=b.tokenize(a,b),e=a.current(),d==="variable"||e==="@staticmethod"||e==="@classmethod"?"meta":c;if(e==="pass"||e==="return")b.dedent+=1;(e===":"&&!b.lambda&&b.scopes[0].type=="py"||s==="indent")&&v(a,b);var f="[({".indexOf(e);return f!==-1&&v(a,b,"])}".slice(f,f+1)),s==="dedent"&&w(a,b)?c:(f="])}".indexOf(e),f!==-1&&w(a,b)?c:(b.dedent>0&&a.eol()&&b.scopes[0].type=="py"&&(b.scopes.length>1&&b.scopes.shift(),b.dedent-=1),d))}var c="error",e=new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),f=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),g=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),h=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),i=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),j=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),k=d(["and","or","not","is","in"]),l=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],m=["bool","classmethod","complex","dict","enumerate","float","frozenset","int","list","object","property","reversed","set","slice","staticmethod","str","super","tuple","type"],n={types:["basestring","buffer","file","long","unicode","xrange"],keywords:["exec","print"]},o={types:["bytearray","bytes","filter","map","memoryview","open","range","zip"],keywords:["nonlocal"]};if(!b.version||parseInt(b.version,10)!==3){l=l.concat(n.keywords),m=m.concat(n.types);var p=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}else{l=l.concat(o.keywords),m=m.concat(o.types);var p=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}var q=d(l),r=d(m),s=null,y={startState:function(a){return{tokenize:t,scopes:[{offset:a||0,type:"py"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=x(a,b);return b.lastToken={style:c,content:a.current()},a.eol()&&a.lambda&&(b.lambda=!1),c},indent:function(a,b){return a.tokenize!=t?0:a.scopes[0].offset}};return y}),a.defineMIME("text/x-python","python")}),define("tp/codemirror/mode/ruby/ruby",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("ruby",function(a,b){function c(a){var b={};for(var c=0,d=a.length;c<d;++c)b[a[c]]=!0;return b}function i(a,b,c){return c.tokenize.push(a),a(b,c)}function j(a,b){h=null;if(a.sol()&&a.match("=begin")&&a.eol())return b.tokenize.push(n),"comment";if(a.eatSpace())return null;var c=a.next();if(c=="`"||c=="'"||c=='"'||c=="/")return i(l(c,"string",c=='"'),a,b);if(c=="%"){var d,e=!1;a.eat("s")?d="atom":a.eat(/[WQ]/)?(d="string",e=!0):a.eat(/[wxqr]/)&&(d="string");var f=a.eat(/[^\w\s]/);return f?(g.propertyIsEnumerable(f)&&(f=g[f]),i(l(f,d,e,!0),a,b)):"operator"}if(c=="#")return a.skipToEnd(),"comment";if(c=="<"&&a.eat("<")){a.eat("-"),a.eat(/[\'\"\`]/);var j=a.match(/^\w+/);return a.eat(/[\'\"\`]/),j?i(m(j[0]),a,b):null}if(c=="0")return a.eat("x")?a.eatWhile(/[\da-fA-F]/):a.eat("b")?a.eatWhile(/[01]/):a.eatWhile(/[0-7]/),"number";if(/\d/.test(c))return a.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if(c=="?"){while(a.match(/^\\[CM]-/));return a.eat("\\")?a.eatWhile(/\w/):a.next(),"string"}return c==":"?a.eat("'")?i(l("'","atom",!1),a,b):a.eat('"')?i(l('"',"atom",!0),a,b):(a.eatWhile(/[\w\?]/),"atom"):c=="@"?(a.eat("@"),a.eatWhile(/[\w\?]/),"variable-2"):c=="$"?(a.next(),a.eatWhile(/[\w\?]/),"variable-3"):/\w/.test(c)?(a.eatWhile(/[\w\?]/),a.eat(":")?"atom":"ident"):c!="|"||!b.varList&&b.lastTok!="{"&&b.lastTok!="do"?/[\(\)\[\]{}\\;]/.test(c)?(h=c,null):c=="-"&&a.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(c)?(a.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null:(h="|",null)}function k(){var a=1;return function(b,c){if(b.peek()=="}"){a--;if(a==0)return c.tokenize.pop(),c.tokenize[c.tokenize.length-1](b,c)}else b.peek()=="{"&&a++;return j(b,c)}}function l(a,b,c,d){return function(e,f){var g=!1,h;while((h=e.next())!=null){if(h==a&&(d||!g)){f.tokenize.pop();break}if(c&&h=="#"&&!g&&e.eat("{")){f.tokenize.push(k(arguments.callee));break}g=!g&&h=="\\"}return b}}function m(a){return function(b,c){return b.match(a)?c.tokenize.pop():b.skipToEnd(),"string"}}function n(a,b){return a.sol()&&a.match("=end")&&a.eol()&&b.tokenize.pop(),a.skipToEnd(),"comment"}var d=c(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload"]),e=c(["def","class","case","for","while","do","module","then","unless","catch","loop","proc"]),f=c(["end","until"]),g={"[":"]","{":"}","(":")"},h;return{startState:function(){return{tokenize:[j],indented:0,context:{type:"top",indented:-a.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(a,b){a.sol()&&(b.indented=a.indentation());var c=b.tokenize[b.tokenize.length-1](a,b),g;if(c=="ident"){var i=a.current();c=d.propertyIsEnumerable(a.current())?"keyword":/^[A-Z]/.test(i)?"tag":b.lastTok=="def"||b.lastTok=="class"||b.varList?"def":"variable",e.propertyIsEnumerable(i)?g="indent":f.propertyIsEnumerable(i)?g="dedent":i=="if"&&a.column()==a.indentation()&&(g="indent")}if(h||c&&c!="comment")b.lastTok=i||h||c;return h=="|"&&(b.varList=!b.varList),g=="indent"||/[\(\[\{]/.test(h)?b.context={prev:b.context,type:h||c,indented:b.indented}:(g=="dedent"||/[\)\]\}]/.test(h))&&b.context.prev&&(b.context=b.context.prev),a.eol()&&(b.continuedLine=h=="\\"||c=="operator"),c},indent:function(b,c){if(b.tokenize[b.tokenize.length-1]!=j)return 0;var d=c&&c.charAt(0),e=b.context,f=e.type==g[d]||e.type=="keyword"&&/^(?:end|until|else|elsif|when)\b/.test(c);return e.indented+(f?0:a.indentUnit)+(b.continuedLine?a.indentUnit:0)}}}),a.defineMIME("text/x-ruby","ruby")}),define("tp/codemirror/mode/xml/xml",["tp/codemirror/lib/codemirror"],function(a){a.defineMode("xml",function(a,b){function h(a,b){function c(c){return b.tokenize=c,c(a,b)}var d=a.next();if(d=="<"){if(a.eat("!"))return a.eat("[")?a.match("CDATA[")?c(k("atom","]]>")):null:a.match("--")?c(k("comment","-->")):a.match("DOCTYPE",!0,!0)?(a.eatWhile(/[\w\._\-]/),c(k("meta",">"))):null;if(a.eat("?"))return a.eatWhile(/[\w\._\-]/),b.tokenize=k("meta","?>"),"meta";g=a.eat("/")?"closeTag":"openTag",a.eatSpace(),f="";var e;while(e=a.eat(/[^\s\u00a0=<>\"\'\/?]/))f+=e;return b.tokenize=i,"tag"}return d=="&"?(a.eatWhile(/[^;]/),a.eat(";"),"atom"):(a.eatWhile(/[^&<]/),null)}function i(a,b){var c=a.next();return c==">"||c=="/"&&a.eat(">")?(b.tokenize=h,g=c==">"?"endTag":"selfcloseTag","tag"):c=="="?(g="equals",null):/[\'\"]/.test(c)?(b.tokenize=j(c),b.tokenize(a,b)):(a.eatWhile(/[^\s\u00a0=<>\"\'\/?]/),"word")}function j(a){return function(b,c){while(!b.eol())if(b.next()==a){c.tokenize=i;break}return"string"}}function k(a,b){return function(c,d){while(!c.eol()){if(c.match(b)){d.tokenize=h;break}c.next()}return a}}function n(){for(var a=arguments.length-1;a>=0;a--)l.cc.push(arguments[a])}function o(){return n.apply(null,arguments),!0}function p(a,b){var c=d.doNotIndent.hasOwnProperty(a)||l.context&&l.context.noIndent;l.context={prev:l.context,tagName:a,indent:l.indented,startOfLine:b,noIndent:c}}function q(){l.context&&(l.context=l.context.prev)}function r(a){if(a=="openTag")return l.tagName=f,o(u,s(l.startOfLine));if(a=="closeTag"){var b=!1;return l.context?b=l.context.tagName!=f:b=!0,b&&(m="error"),o(t(b))}return a=="string"?((!l.context||l.context.name!="!cdata")&&p("!cdata"),l.tokenize==h&&q(),o()):o()}function s(a){return function(b){return b=="selfcloseTag"||b=="endTag"&&d.autoSelfClosers.hasOwnProperty(l.tagName.toLowerCase())?o():b=="endTag"?(p(l.tagName,a),o()):o()}}function t(a){return function(b){return a&&(m="error"),b=="endTag"?(q(),o()):(m="error",o(arguments.callee))}}function u(a){return a=="word"?(m="attribute",o(u)):a=="equals"?o(v,u):a=="string"?(m="error",o(u)):n()}function v(a){return a=="word"&&d.allowUnquoted?(m="string",o()):a=="string"?o(w):n()}function w(a){return a=="string"?o(w):n()}var c=a.indentUnit,d=b.htmlMode?{autoSelfClosers:{br:!0,img:!0,hr:!0,link:!0,input:!0,meta:!0,col:!0,frame:!0,base:!0,area:!0},doNotIndent:{pre:!0,"!cdata":!0},allowUnquoted:!0}:{autoSelfClosers:{},doNotIndent:{"!cdata":!0},allowUnquoted:!1},e=b.alignCDATA,f,g,l,m;return{startState:function(){return{tokenize:h,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(a,b){a.sol()&&(b.startOfLine=!0,b.indented=a.indentation());if(a.eatSpace())return null;m=g=f=null;var c=b.tokenize(a,b);b.type=g;if((c||g)&&c!="comment"){l=b;for(;;){var d=b.cc.pop()||r;if(d(g||c))break}}return b.startOfLine=!1,m||c},indent:function(a,b){var d=a.context;if(d&&d.noIndent)return 0;if(e&&/<!\[CDATA\[/.test(b))return 0;d&&/^<\//.test(b)&&(d=d.prev);while(d&&!d.startOfLine)d=d.prev;return d?d.indent+c:0},compareStates:function(a,b){if(a.indented!=b.indented||a.tokenize!=b.tokenize)return!1;for(var c=a.context,d=b.context;;c=c.prev,d=d.prev){if(!c||!d)return c==d;if(c.tagName!=d.tagName)return!1}},electricChars:"/"}}),a.defineMIME("application/xml","xml"),a.defineMIME("text/html",{name:"xml",htmlMode:!0})}),define("tp/plugins/vcs/viewDiff/sourcePopup",["tp/codemirror/lib/codemirror","jQuery","tp/popup","tp/codemirror/mode/diff/diff","tp/codemirror/mode/clike/clike","tp/codemirror/mode/css/css","tp/codemirror/mode/htmlmixed/htmlmixed","tp/codemirror/mode/javascript/javascript","tp/codemirror/mode/perl/perl","tp/codemirror/mode/php/php","tp/codemirror/mode/python/python","tp/codemirror/mode/ruby/ruby","tp/codemirror/mode/xml/xml"],function(a,$){function b(){this._ctor()}return b.prototype={_ctor:function(){this.placeholder=$('<div class="_viewSourcePopup viewSourcePopup" />'),this.emptyText="No data to display",this.codeViewer=a(this.placeholder[0],{readOnly:!0,lineNumbers:!0});var b=this;this.popup=this.placeholder.popup({zIndex:2e4,autoOpen:!1,minWidth:300,open:function(){b.resizeCodeViewer()},resize:function(){b.resizeCodeViewer()}}),this.placeholder.parent().addClass("vcsSource")},resizeCodeViewer:function(){var a=$("._viewSourcePopup").height(),b=$("._viewSourcePopup").width();$(".CodeMirror-scroll").css("height",a),$(".CodeMirror-scroll").css("width",b)},view:function(a,b,c){var d=b||this.emptyText,e="File: "+c+'<br /><span class="subTitle">Revision: '+a+"</span>";this.placeholder.removeClass("_refreshing"),this.placeholder.find(".ui-wait-icon").remove(),this._setModeByFileExtension(c),this.codeViewer.setValue(d),this.popup.popup("option","title",e),this.popup.popup("open"),this.codeViewer.refresh()},loading:function(){this.placeholder.addClass("_refreshing"),this.placeholder.append('<div class="ui-wait-icon" />'),this.popup.popup("option","title",""),this.popup.popup("open")},_getExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_setModeByFileExtension:function(a){var b=this._getExtension(a),c="clike";switch(b){case"css":c="text/css";break;case"cs":c="text/x-csharp";break;case"c":case"h":c="text/x-csrc";break;case"cpp":c="text/x-c++src";break;case"html":case"htm":case"shtml":c="text/html";break;case"js":c="text/javascript";break;case"java":c="text/x-java";break;case"perl":c="text/x-perl";break;case"php":case"phtml":case"phl":c="application/x-httpd-php";break;case"py":c="text/x-python";break;case"rb":c="text/x-ruby";break;case"xml":case"config":c="application/xml";break;default:c="null"}this.codeViewer.setOption("mode",c)}},new b}),define("tp/plugins/vcs/viewDiff/diffPopup",["jQuery","tp/popup"],function($){function a(){this._ctor()}return a.prototype={placeholder:$('<div class="_viewDiffPopup viewDiffPopup">\n    <div class="diffHeader">\n        <div class="_legend legend">\n            <span class="lineAdded">line added</span>&nbsp;&nbsp;\n            <span class="lineUpdated">line changed</span>&nbsp;&nbsp;\n            <span class="lineDeleted">line deleted</span>\n        </div>\n        <div class="revisionsContainer">\n            <div class="revisionContainer right">\n                <div class="_rightRevision revision"></div>\n            </div>\n            <div class="revisionContainer left">\n                <div class="_leftRevision revision"></div>\n            </div>\n        </div>\n    </div>\n    <div class="diffContainer _diffContainer">\n        <div class="_rightContainer sourceContainer right">\n            <pre>\n                <div class="_rightPan"></div>\n            </pre>\n        </div>\n        <div class="_leftContainer sourceContainer left">\n            <pre>\n                <div class="_leftPan"></div>\n            </pre>\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n    <div class="scrollers">\n        <div class="_rightScroller rightScroller right">\n            <div class="_scrollerInternals scrollerInternals"></div>\n        </div>\n        <div class="_leftScroller leftScroller left">\n            <div class="_scrollerInternals scrollerInternals"></div>\n        </div>\n    </div>\n</div>'),lineTemplate:'<div {{if line.Action}}class="line${actions[line.Action]}"{{/if}}>${line.LineNumber}  ${line.Line}</div>',actions:{0:"None",10:"Added",20:"Updated",30:"Deleted"},_ctor:function(){this.emptyText="No data to display";var a=$.proxy(this._getSyncFunction("left","right"),this),b=$.proxy(this._getSyncFunction("right","left"),this),c=this,d=$.proxy(function(){c._processScroller("right"),c._processScroller("left")},this);this.popup=this.placeholder.popup({autoOpen:!1,zIndex:2e4,minWidth:300,open:function(){c._processScroller("right").bind("scroll",b),c._processScroller("left").bind("scroll",a),$(window).bind("resize",d)},close:function(){c.placeholder.find("._rightScroller").unbind("scroll",b),c.placeholder.find("._leftScroller").unbind("scroll",a),$(window).unbind("resize",d)},resize:function(){d()}}),this.placeholder.parent().addClass("vcsDiff")},_getSyncFunction:function(a,b){var c=this;return function(){var d=c.placeholder.find("._"+a+"Scroller");c.placeholder.find("._"+b+"Scroller").scrollLeft(d.scrollLeft()),c.placeholder.find("._"+b+"Container").scrollLeft(d.scrollLeft()),c.placeholder.find("._"+a+"Container").scrollLeft(d.scrollLeft())}},_processScroller:function(a){var b=$("._"+a+"Pan").width(),c=this.placeholder.find("._"+a+"Container"),d=c.width(),e=this.placeholder.find("._"+a+"Scroller"),f=this.placeholder.find("._diffContainer");return c.height()<f.height()?(c.height(f.height()),e.css("right",0)):(c.css("height","auto"),e.css("right","17px")),e.find("._scrollerInternals").width(b),e.width(d),d<b?e.show():e.hide(),e},view:function(a,b,c){var d="Changed file: "+c;this.placeholder.removeClass("_refreshing"),this.placeholder.find(".ui-wait-icon").remove(),this.placeholder.find("._leftRevision").text("Revision "+b.LeftPanRevisionId),this.placeholder.find("._rightRevision").text("Revision "+b.RightPanRevisionId),this._processPan(this.placeholder.find("._leftPan").html(""),b.LeftPan),this._processPan(this.placeholder.find("._rightPan").html(""),b.RightPan),this.popup.popup("option","title",d),this.popup.popup("open")},loading:function(){this.placeholder.addClass("_refreshing"),this.placeholder.append('<div class="ui-wait-icon" />'),this.popup.popup("option","title",""),this.popup.popup("open")},_processPan:function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.LineNumber=this._normalizeLineNumber(d.LineNumber),d.Line=d.Line.replace(/\t/g,"&#9;")||"&nbsp;",a.append($.tmpl(this.lineTemplate,{line:d,actions:this.actions}))}},_normalizeLineNumber:function(a){var b=a;if(b<0)return"     ";var c=new String(b+1);while(c.length<5)c=" "+c;return c}},new a}),define("tau/ui/extensions/revisionList/ui.extension.revisionList.showDiff",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/core/keyboard.manager","tp/plugins/pluginsRepository","tp/plugins/commandGateway","tp/plugins/vcs/viewDiff/sourcePopup","tp/plugins/vcs/viewDiff/diffPopup"],function(_,$,a,b,c,d,e,f){function h(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.getElementsByTagName("head")[0].appendChild(b)}var g=["Subversion","Git"];return h(require.toUrl("tp/codemirror/theme/default.css")),a.extend({plugins:[],"bus afterRender+dataBind":function(a){var b=this.plugins,h=_.pluck(a.dataBind.data.items,"id"),i=this;_.each(g,function(g){var j={pluginName:g},k=new d(j),l={extension:this,pluginName:g,commandGateway:k,revisions:h,viewSourcePopup:e,viewDiffPopup:f,getImportedRevisions:function(a){this.commandGateway.execute("GetImportedRevisions",this.revisions,$.proxy(this.getImportedRevisionsSuccess,this))},getImportedRevisionsSuccess:function(b){if(b.length==0)return;var c=a.afterRender.data.element,d={};for(var e=0;e<b.length;e++)d[b[e]]=!0;c.find(".ui-revisionList > tbody").each(function(a){var b=$(this),c=b.tmplItem().data;d.hasOwnProperty(c.id)&&a.attachViewDiffBehaviourForElement(b)},[this])},attachViewDiffBehaviourForElement:function(a){var b=a.tmplItem().data,c=a.find(".files");c.each(function(a){var c=$(this),d=c.tmplItem().data,e=c.find(".vcsViewDisabled");d.fileAction!="Deleted"&&(e.attr("href","#").removeAttr("disabled").addClass("vcsView"),e.click(function(c){c.preventDefault(),a.showView(b.id,b.sourceControlId,d.fileName)}),e.removeClass("vcsViewDisabled"));if(d.fileAction==="Modified"){var f=c.parent().find(".diff");f.append($('<a href="#" class="_diff button small">Diff</a>').click(function(c){c.preventDefault(),a.showDiff(b.id,b.sourceControlId,d.fileName)}))}},[this])},showView:function(a,b,c){var d=i.config;d.context.configurator.getKeyBoardManager().pushHandler({handleKeyDown:function(a){a.keyCode==27&&d.context.configurator.getKeyBoardManager().popHandler()}}),this.viewSourcePopup.loading();var e=this;this.commandGateway.execute("ViewSource",{TpRevisionId:a,Path:c},function(a){var d=a.Content||"File is empty";e.viewSourcePopup.view(b,d,c)},null,this.showError)},showDiff:function(a,b,c){var d=i.config;d.context.configurator.getKeyBoardManager().pushHandler({handleKeyDown:function(a){a.keyCode==27&&d.context.configurator.getKeyBoardManager().popHandler()}}),this.viewDiffPopup.loading();var e=this;this.commandGateway.execute("ViewDiff",{TpRevisionId:a,Path:c},function(a){e.viewDiffPopup.view(b,a,c)},null,this.showError)},showError:function(a){$("<div />").html('<p class="p-15">'+a+"</p>").popup({title:"Error occured",fitToWindow:!1})}};b[g]=l,c.pluginStartedAndHasAtLeastOneProfile(g,$.proxy(l.getImportedRevisions,l))},this)}})}),define("tau/models/propertyLists/model.defaultList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({onInit:function(){var a=this,b=this.config,c=this.config.context.entity;this.propertyType=b.listType,a.store.get(b.listType,{fields:["id","name"]}).get(c.entityType.name,{id:c.id,fields:["id",b.listType]}).done({success:_.bind(a.onDataRetrieved,a)})},onDataRetrieved:function(a){var b=a[0].data,c=a[1].data,d=this.config.data,e=!!(this.config.showReset&&d&&d.id),f={states:_.reject(b,function(a){return d&&a.id===d.id}),completed:!0,nullableValue:e};this.fire("dataBind",f)}})}),define("tau/models/propertyLists/model.staticList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({onInit:function(){var a=this,b=this.config,c=this.config.context.entity;a.store.get(c.entityType.name,{id:c.id,fields:["id",b.data.name]}).done({success:_.bind(a.onDataRetrieved,a)})},onDataRetrieved:function(a){var b=a[0].data,c=b[this.config.data.name],d=this.config.values;_.forEach(d,function(a,b){_.isObject(a)==0&&(a={id:a,name:a},d[b]=a)});var e=!!this.config.showReset&&!!c,f={states:_.reject(d,function(a){return c&&a.id==c}),completed:!0,nullableValue:e};this.fire("dataBind",f)},"bus updateState":function(a){var b={},c=null;a.data&&a.data.id&&(c=a.data.id),b[this.config.data.name]=c,this.fire("save",b)}})}),define("tau/models/propertyLists/model.prioritiesList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({name:"priority-list-model",propertyType:"priority",onInit:function(){var a=this,b=function(b){var c=b[0].data;a.assignable=c,a.store.get(a.propertyType,a.createGetPrioritiesCommand()).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};this.getAssignable(b)},getRequiredFields:function(){return[{entityType:["id"]}]},createGetPrioritiesCommand:function(){return{fields:["id","name","importance",{entityType:["id"]}]}},processData:function(a){var b=this.getCurrentEntityId(),c=this.assignable.entityType.id,d=[];_.each(a,function(a){a.id!==b&&a.entityType.id===c&&d.push({id:a.id,name:a.name,importance:a.importance||0})}),d.sort(function(a,b){return a.importance-b.importance}),this.fire("dataBind",{states:d,completed:!0,nullableValue:!1})}})}),define("tau/models/propertyLists/model.severityList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({name:"severity-list",propertyType:"severity",onInit:function(){var a=this;a.store.get(a.propertyType,{fields:["id","name","importance"]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})},getRequiredFields:function(){return["id","name","importance"]},createGetStateForAssignableCommand:function(){return{fields:["id","name","importance"]}},processData:function(a){var b=this.getCurrentEntityId(),c=[];_.each(a,function(a){a.id!==b&&c.push({id:a.id,name:a.name,importance:a.importance})}),c.sort(function(a,b){return a.importance-b.importance}),this.fire("dataBind",{states:c,completed:!0,nullableValue:!1})}})}),define("tau/models/propertyLists/model.userStoryList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({name:"userStory-list",propertyType:"userStory",onInit:function(){var a=this,b=function(){a.store.get("userStory",{fields:["id","name",{project:["id","name"]}]}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})};b()},processData:function(a){var b=this.getCurrentEntityId(),c={};_.each(a,function(a){if(a.id==b)return;c.hasOwnProperty(a.project.id)||(c[a.project.id]=a.project,c[a.project.id].items=[]),c[a.project.id].items.push(a)});var d={states:this.sortProjects(_.values(c)),completed:!0,nullableValue:b!==null&&this.config.context.entity.entityType.name.toLowerCase()!="task"&&this.propertyIsNotEmpty()};this.fire("dataBind",d)}})}),define("tau/models/propertyLists/model.featureList",["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,a){return a.extend({name:"release-list",propertyType:"feature",onInit:function(){var a=this;a.store.get("project",{fields:["id","name",{process:["id"]},{features:["id","name"]}]},{success:a.onProjectRetrieved.tauCreateDelegate(a)}).get("feature",{fields:["id","name",{project:["id"]}]},{success:a.onFeatureRetrieved.tauCreateDelegate(a)}).get("process",{fields:["id",{practices:["name"]}]},{success:a.onProcessesRetrieved.tauCreateDelegate(a)}).done({success:a.onDataRetrieved.tauCreateDelegate(a)})},onFeatureRetrieved:function(a){this.featureList=a.data},onProjectRetrieved:function(a){this.projectList=a.data},onProcessesRetrieved:function(a){this.processList=a.data},getFeaturesForProject:function(a){var b=this.getCurrentEntityId(),c=function(a){a.id!==b&&this.push(a)},d=[];return this.projectHasRequirementsPractice(a)&&_.each(a.features,c,d),d},onDataRetrieved:function(){this.processData(this.projectList,this.processList)},projectHasRequirementsPractice:function(a){var b=a.process.id,c=_.detect(this.processList,function(a){return a.id==b}),d=_.detect(c.practices,function(a){return a.name=="Requirements"});return!_.isEmpty(d)},processData:function(a,b){var c=[];this.processList=b,_.each(this.sortProjects(a),function(a){var b=this.getFeaturesForProject(a);_.isEmpty(b)||c.push({id:a.id,name:a.name,items:b})},this);var d={states:c,completed:!0,nullableValue:this.getCurrentEntityId()!==null&&this.propertyIsNotEmpty()};this.fire("dataBind",d)}})}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.base",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){var b=a.extend({getRestoredState:function(){return null},"bus beforeInit":function(a){var b=a.data.config,c=b.children,d=_.filter(c[0].children,function(a){return a.type=="container"});this.initialLabel=null;var e=this;_.forEach(d,function(a,b){a.selected==1&&(e.initialLabel=a.label)});var f=c.slice(1),g=this.getRestoredState(),h=!1;if(g){var i=0;_.forEach(d,function(a,b){a.label==g?(h=!0,f[b].visible=!0,a.selected=!0):(f[b].visible=!1,a.selected=!1)})}h==0&&_.forEach(d,function(a,b){a.label==e.initialLabel&&(f[b].visible=!0,a.selected=!0)})},"bus childrenRendered":function(a){var b=[];_.forEach(a.data.config.tabs,function(a,c){b[c]={label:a.label}}),this.fire("headerRendered",{component:a.data.children[0],switchConfig:b});var c=a.data.children.slice(1);this.fire("tabsRendered",{components:c})},"bus headerRendered":function(a){var b=a.data.component,c=_.bind(function(a){_.bind(this.onHeaderSwitched,this)(a)},this);b.on("switched",c),this.header=b},"bus headerRendered+tabsRendered":function(a){var b=a.headerRendered.data.switchConfig,c=a.tabsRendered.data.components,d={};_.forEach(c,function(a,c){d[b[c].label]=a}),this.tabs=d},onHeaderSwitched:function(a){var b=a.data.label;this.tabs[b]&&this.selectTabExternal(b)},selectTabInternal:function(a){var a=a||this.initialLabel;this.tabs[a]&&(_.forEach(this.tabs,function(a,b){a.fire("hide")}),this.tabs[a].fire("show"),this.header.fire("switched.after",{label:a}),this.fire("tabs.switched"))},selectTabExternal:function(a){this.selectTabInternal(a)}});return b}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.routing",["Underscore","tau/ui/extensions/tabs/ui.extension.tabs.state.base"],function(_,a){var b=a.extend({init:function(a){this._super(a),this.name=a.stateName||"tab",this.defaultState=this.getRestoredState()},getRestoredState:function(){return this.config.hasOwnProperty("stateName")?this.config[this.config.stateName]:null},getStateName:function(){return this.config.stateName},selectTabExternal:function(a){var b=this.config.context.componentSettings,c={},d=this.getStateName();c[d]=a,b.set({set:c})},onStateChanged:function(a){var b=a[this.getStateName()]||this.defaultState;this.selectTabInternal(b)},"bus initialize":function(){var a=this,b=a.config.context.componentSettings;b.bind({fields:[this.getStateName()],listener:a,callback:a.onStateChanged})},"bus destroy":function(){var a=this,b=a.config.context.componentSettings;b.unbind({listener:a,callback:a.onStateChanged})}});return b}),define("tau/ui/extensions/tabs/ui.extension.tabs.state.simple",["Underscore","tau/ui/extensions/tabs/ui.extension.tabs.state.base"],function(_,a){var b=a.extend({});return b}),define("tau/ui/extensions/layout/ui.extension.layout.tabsHeader",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/extensions/extension.javascript"],function(_,$,a){return a.extend({"bus beforeInit":function(a){var b=a.data.config;this.options={childrenContainerSelector:b.childrenContainerSelector||"ul.entity-tabs"}},getTabItemCssName:function(a){return"tab-item"+((a.position||{}).right?" tab-item-right-part":"")},"bus afterRender+childrenRendered":function(a){var b=this;b.element=a.afterRender.data.element;var c=a.childrenRendered.data;b.children=c.children;var d=c.childrenEvtArgs,e=c.config.children;_(d).each(function(a,c){var d=a.element,f=e[c],g=f.selected,h=b.getTabItemCssName(f);b._add(d,g,h,f.label)}),this.findContainerElement().bind("click",$.proxy(this._onContainerClick,this))},findContainerElement:function(){return this.element.find(this.options.childrenContainerSelector)},getTabsCount:function(){return this.findContainerElement().children(".tab-item").length},_add:function(a,b,c,d){var e=b?"selected":"";c=c||"tab-item",d=d||a.text(),$('<li class="'+c+'"></li>').data({label:d,index:this.getTabsCount()}).addClass(e).append(a).appendTo(this.findContainerElement())},_onContainerClick:function(a){var b=$(a.target),c=".tab-item",d=b.is(c)?b:b.parents(c);if(d.is(c)){var e=d.data().index,f={label:d.data("label"),index:e,tabHeader:this.children[e]};this.fire("switched",f)}},"bus switched.after":function(a){var b=a.data.index,c=this.findContainerElement(),d=c.children(".tab-item");d.filter(".selected").removeClass("selected"),_.isUndefined(b)&&a.data.label?d.each(function(){var b=$(this);b.data("label")==a.data.label&&b.addClass("selected")}):d.eq(b).addClass("selected")},destroy:function(){this._super(),delete this.element,delete this.children}})}),define("tau/ui/templates/container/ui.template.container.tabsHeader",["tau/core/templates-factory"],function(a){var b={name:"container.tabsHeader",markup:['<div class="box table">','   <ul class="entity-tabs">',"   </ul>","</div>"],dependencies:[]};return a.register(b)}),define("tau/models/model.tags",["Underscore","tau/core/model-base"],function(_,a){var b=function(a){this.model=a};b.prototype={_parseTags:function(a){a=a||"";var b=_.isArray(a)?a:a.split(","),c={},d=_(b).map(function(a){return a.trim()});return _.select(d,function(a){var b=a.toLowerCase();return c.hasOwnProperty(b)?!1:(c[b]=!0,!0)})},onGetTags:function(a){var b=a.data;this.id=b.id,this.tags=this._parseTags(b.tags)},done:function(a){var b={tags:this.tags};this.model.bus.fire("dataBind",b)}};var c=a.extend({onInit:function(){var a=new b(this),c=this.config.context,d=c.entity.entityType.name,e=c.entity.id,f={id:e,fields:["id","tags"]};this.store.get(d,f,{scope:a,success:a.onGetTags}).done({success:a.done,scope:a})},"bus evict":function(){var a=this.config.context.general;this.store.evictProperties(a.id,a.entityType.name,["tags"])}});return c}),define("tau/models/model.tags.editable",["tau/core/model.editable.base"],function(a){var b=a.extend({category:"edit",name:"Editable tags","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})}});return b}),define("tau/ui/extensions/tags/ui.extension.tags.duplicateBug",["tau/components/extensions/component.extension.base"],function(a){return a.extend({"bus dataBind+afterRender":function(a){var b=a.dataBind.data.tags,c=a.afterRender.data.element.find("li.ui-tags__tag span");for(var d=0;d<b.length;d++){var e="duplicateOf#".toLocaleLowerCase(),f=b[d];if(f.toLowerCase().indexOf(e)===0){var g="#bug/"+f.substring(e.length);c.eq(d).text("").append($('<a class="ui-tags__duplicateBug" href="'+g+'">'+f+"</a>"))}}}})}),define("tau/ui/behaviour/tags/ui.behaviour.tagsEditor",["Underscore","jQuery","tau/core/tau"],function(_,$,a){$.widget("ui.tagsEditor",{options:{selector:".ui-tags__tag",onSave:function(){}},_create:function(){this.init()},init:function(){this.$list=$(this.element);var a=this.options.selector,b=this.$list.find(a);b.append('<a href="#" class="ui-tags__control-delete" title="Delete tag">Delete tag</a>');var c=this;this.$list.delegate(".ui-tags__control-delete","click",function(b){b.preventDefault(),$(this).parents(a).eq(0).remove(),c.options.onSave(c.getTags())}),this.$widget=$('<li class="ui-tags__editor"><a href="#" title="Add tag" class="ui-tags__editor__control-show"><i>Add tag</i></a></li>'),this.$widget.find("a:first").click(_.bind(this.showEditor,this)),this.$list.append(this.$widget)},_processAddTag:function(a){var b=this,c=b.parseTags(a.find(":text").val());b.hideEditor();var d=b.getTags();d=d.concat(c),b.options.onSave(d)},showEditor:function(b){b.preventDefault();if(!this._editorIsVisible){if(!this.$editor){var c=$(a.concat('<span class="ui-tags__editor__inner">','    <input type="text" maxlength="50" class="ui-tags__editor__input" />','    <div class="button-group" style="position: relative; top: 5px; left: 3px;"><a title="Add" class="button small ui-tags__editor__button-submit" >Add&nbsp;</a>','    <a title="Cancel" class="button small ui-tags__editor__button-cancel"  >x</a></div>',"</span>")),d=this;c.find(".ui-tags__editor__button-submit").click(function(){d._processAddTag(c)}),c.find(".ui-tags__editor__button-cancel").click(function(){d.hideEditor()}),c.find(":text").keydown(_.bind(this.mapKeys,this)),c.appendTo(this.$widget),this.$editor=c}this.resetEditor(),this.$widget.toggleClass("ui-tags__editor-active",!0),this._editorIsVisible=!0,this.$editor.find(":text").focus()}},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.find(":text").blur(),this.$widget.toggleClass("ui-tags__editor-active",!1),this._editorIsVisible=!1,this.resetEditor())},resetEditor:function(){this.$editor&&this.$editor.find(":text").val("")},mapKeys:function(a){switch(a.which){case 13:a.preventDefault();var b=this;this._processAddTag(this.$editor);break;case 27:a.preventDefault(),this.hideEditor(a)}},getTagsElements:function(){var a=[],b=this;return this.$list.find(this.options.selector).each(function(c,d){a.push({value:b.getTagText($(d)),$el:$(d)})}),a},getTagText:function(a){return $.trim(a.find("span:first").text())},getTags:function(){var a=[],b=this;return this.$list.find(this.options.selector).each(function(c,d){var e=$(d);a.push(b.getTagText(e))}),a},addTags:function(a){},parseTags:function(a){a=a||"";var b=a.split(",");return b=_(b).map(function(a){return a.trim()}),b=_.uniq(b),b=_.compact(b),b}})}),define("tau/components/extensions/tags/extension.tags.editable",["Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/tags/ui.behaviour.tagsEditor"],function(_,a){return a.extend({category:"edit",_afterSaveHandler:function(a){this.fire("refresh")},"bus afterSave":function(a){this._afterSaveHandler(a)},"bus beforeSave":function(a){var b=a.data.cmd.$set.tags;b&&(a.data.cmd.fields=a.data.cmd.fields||[],a.data.cmd.fields.push("tags"))},"bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(c.editable)var d=a.afterRender.data.element.tagsEditor({validation:{trim:!0},onSave:function(a){b.bus.fire("elementUpdated"),b.bus.fire("save",{tags:a.join(",")}),d.addClass("data-saving")}})}})}),define("tau/ui/templates/tags/ui.template.tag.item",["tau/core/templates-factory"],function(a){var b={name:"tag-item",markup:['<li class="ui-tags__tag" rel="tag">',"   <span>${$item.data}</span>","</li>"],dependencies:[]};return a.register(b)}),define("tau/ui/templates/tags/ui.template.tags",["tau/core/templates-factory","tau/ui/templates/tags/ui.template.tag.item"],function(a){var b={name:"tags",markup:['<ul class="ui-tags">','   {{tmpl(tags) "tag-item"}}',"</ul>"],dependencies:["tag-item"]};return a.register(b)}),define("tau/models/model.testCaseList.editable",["tau/core/model.editable.base"],function(a){return a.extend({category:"edit",name:"Editable State","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0})}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender+permissionsReady":function(a){if(a.permissionsReady.data.editable){var b=a.afterRender.data.element;b.find(".tau-add-testCase").click($.proxy(this.addTestCaseClickHandler,this))}},addTestCaseClickHandler:function(){function d(){Ext.WindowMgr.zseed=9999999;var d=new Tp.controls.TestCaseCreateEditorWindow({userStoryId:b,processId:a.getProcessId()});d.show(),d.on("saved",function(){c.fire("testCaseWasAdded",{assignable:{id:b}})})}var a=this.config.context,b=a.assignable.id,c=this;if(!window.processConfigurations){var e=window.progressDialog||{show:function(){},hide:function(){}};e.show("Loading..."),Ext.Ajax.request({url:(new Tp.WebServiceURL("/PageServices/TestCaseListService.asmx/GetProcessConfiguration")).toString(),headers:{"Content-Type":"application/json"},success:function(a){e.hide();var b=$.parseJSON(a.responseText).d;processConfigurations=b,d()},jsonData:{userStoryId:b}})}else d()}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.edit.runner",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus dataBind":function(a){this.data=a.data},onAfterRender:function(){},"bus afterRender":function(a){this.element=a.data.element,this.onAfterRender()},"bus afterRender+permissionsReady":function(a){if(a.permissionsReady.data.editable){var b=a.afterRender.data.element;b.find(".last-run").removeClass("hidden"),b.find(".buttons").removeClass("hidden"),b.find(".passed").click($.proxy(this.passedClickHandler,this)),b.find(".failed").click($.proxy(this.failedClickHandler,this))}},getTestCaseId:function(a){return $(a.target).parents("tbody").eq(0).tmplItem().data.id},passedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!0)},failedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!1)},setTestCaseStatus:function(a,b){Ext.Ajax.request({url:(new Tp.WebServiceURL("/PageServices/TestCaseListService.asmx/ChangeRunState")).toString(),headers:{"Content-Type":"application/json"},success:this._onChangeStateComplete.createDelegate(this),failure:this._onChangeStateFailed.createDelegate(this),jsonData:{testCaseID:a,status:b}})},openNextTestCase:function(){var a=this.testCaseId,b=this.data.items;for(var c=0;c<b.length-1;c++)b[c].id===a&&this.fire("expandTestCase",{testCaseId:b[c+1].id});this.onAfterRender=function(){}},_onChangeStateComplete:function(a){this.testCaseId=$.parseJSON(a.responseText).d.TestCaseID,this.onAfterRender=this.openNextTestCase,this.fire("testCaseStateWasChanged")},_onChangeStateFailed:function(a){this.fire("showError",{message:a.get_message()})},destroy:function(){delete this.data,delete this.element}})}),define("tau/components/extensions/testCaseList/extension.testCaseList.refresher",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus testCaseWasAdded":function(a){this.fire("evictTestCases"),this.fire("refresh")},"bus testCaseStateWasChanged":function(a){this.fire("evictTestCases"),this.fire("refresh")}})}),define("tau/models/model.testCasesRunResults",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;this.store.get(c,{id:d,fields:["passedCount","failedCount","notRunCount"]},{success:this.onDataRetrieved,scope:this}).done()},onDataRetrieved:function(a){var b=a.data,c={passedCount:b.passedCount,failedCount:b.failedCount,notRunCount:b.notRunCount};this.bus.fire("dataBind",c)}});return b}),define("tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults",["tau/core/templates-factory"],function(a){var b={name:"test-cases-run-results",markup:['<div class="tau-testCasesRunResults">','   <div class="tau-testCasesRunResults-container">','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-passed">Passed: ${passedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-failed">Failed: ${failedCount}</span>','       <span class="tau-testCasesRunResults-item tau-testCasesRunResults-notRun">Not Run: ${notRunCount}</span>',"   </div>","</div>"],dependencies:[]};return a.register(b)}),define("tau/components/extensions/testrunner/extension.stylesheets",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus afterRender":function(a){var b=this.config.stylesheets;$("link.testrunnercss").remove(),_.forEach(b,function(a){$("<link />").attr({type:"text/css",rel:"stylesheet",href:require.toUrl(a),name:"testrunnercss"}).appendTo("head")})}})}),define("tau/components/extensions/testrunner/extension.driver.qunit",["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus beforeInit":function(a){var b=this;require(["libs.tests/qunit","libs.tests/tests.result","libs.tests/jquery.simulate","libs.tests/jsmock","libs.tests/jqMock"],function(){b.bus.fire("dataBind",{})})},"bus error.global":function(a){var b=a.data;module("global failure"),test("global failure",function(){ok(!1,b.message)})},"bus afterInit+afterRender":function(a){function h(){var a=QUnit.urlParams["failedonly"]=="true",b=QUnit.urlParams["cardview"]=="true"&&!QUnit.urlParams.filter;$container=d.find("#qunit-tests"),$container.hide(),a&&$container.addClass("failedonly"),b&&$container.addClass("cardview")}function i(){$container=d.find("#qunit-tests"),$container.show()}var b=function(a,b){var c=_.extend({},a);return _.each(_.keys(a),function(a){b.hasOwnProperty(a)||delete c[a]}),c};window.included=QUnit.included=function(a,c,d){var e=b(_.extend({},a),c),f=QUnit.equiv(e,c);QUnit.push(f,e,c,d)};var c=_.compact(a.afterInit.data.config.files);if(!c||c.length==0)return;var d=a.afterRender.data.element,e=d.find("#qunit-header"),f=function(){var a=QUnit.urlParams["failedonly"]=="true",b=QUnit.urlParams["cardview"]=="true"&&!QUnit.urlParams.filter,c=$("<label><input type='checkbox' name='failedonly'>failed only</label>"),d=c.find("input[name=failedonly]");d.attr("checked",a),d.bind("click",function(){QUnit.url({failedonly:!a})});var f=$("<label><input type='checkbox' name='cardview'>card view</label>"),g=f.find("input[name=cardview]");g.attr("checked",b),g.bind("click",function(){QUnit.url({cardview:!b})}),e.append(c),e.append(f),jQuery.fx.off=!0},g=QUnit.start;QUnit.start=function(){g.call(QUnit),f()},require(c,function(){h();var a=-1,b=arguments,c;for(a=0,c=b.length;a<c;a++)b[a]&&b[a].run();i()})},"bus dom.appended":function(){$.browser.msie&&QUnit.load()}})}),define("libs.tests/nodeunit/assert",[],function(){function e(a,b,d,e,f){throw new c.AssertionError({message:d,actual:a,expected:b,operator:e,stackStartFunction:f})}function f(a,b){return a===b?!0:a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():a instanceof RegExp&&b instanceof RegExp?a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline:typeof a!="object"&&typeof b!="object"?a==b:i(a,b)}function g(a){return a===null||a===undefined}function h(a){return Object.prototype.toString.call(a)=="[object Arguments]"}function i(c,d){if(g(c)||g(d))return!1;if(c.prototype!==d.prototype)return!1;if(h(c))return h(d)?(c=b.call(c),d=b.call(d),f(c,d)):!1;try{var e=a(c),i=a(d),j,k}catch(l){return!1}if(e.length!=i.length)return!1;e.sort(),i.sort();for(k=e.length-1;k>=0;k--)if(e[k]!=i[k])return!1;for(k=e.length-1;k>=0;k--){j=e[k];if(!f(c[j],d[j]))return!1}return!0}function j(a,b,c,d){var f=null,g=!1,h=!0;d=d||"",arguments.length==3?typeof c=="string"&&(d=c,h=!1):arguments.length==2&&(h=!1);try{b()}catch(i){g=!0,f=i}a&&!g&&e("Missing expected exception"+(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"")),!a&&g&&h&&f instanceof c&&e("Got unwanted exception"+(c&&c.name?" ("+c.name+").":".")+(d?" "+d:""));if(a&&g&&h&&!(f instanceof c)||!a&&g)throw f}var exports={},a=function(a){if(Object.keys)return Object.keys(a);if(typeof a!="object"&&typeof a!="function")throw new TypeError("-");var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},b=Array.prototype.slice,c=exports;c.AssertionError=function(b){this.name="AssertionError",this.message=b.message,this.actual=b.actual,this.expected=b.expected,this.operator=b.operator;var c=b.stackStartFunction||e;Error.captureStackTrace&&Error.captureStackTrace(this,c)},c.AssertionError.super_=Error;var d=function(){this.constructor=c.AssertionError};return d.prototype=Error.prototype,c.AssertionError.prototype=new d,c.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",JSON.stringify(this.expected),this.operator,JSON.stringify(this.actual)].join(" ")},c.AssertionError.__proto__=Error.prototype,c.fail=function(a){e(null,null,a)},c._fail=e,c.ok=function(b,d){b||e(b,!0,d,"==",c.ok)},c.equal=function(b,d,f){b!=d&&e(b,d,f,"==",c.equal)},c.notEqual=function(b,d,f){b==d&&e(b,d,f,"!=",c.notEqual)},c.deepEqual=function(b,d,g){f(b,d)||e(b,d,g,"deepEqual",c.deepEqual)},c.notDeepEqual=function(b,d,g){f(b,d)&&e(b,d,g,"notDeepEqual",c.notDeepEqual)},c.strictEqual=function(b,d,f){b!==d&&e(b,d,f,"===",c.strictEqual)},c.notStrictEqual=function(b,d,f){b===d&&e(b,d,f,"!==",c.notStrictEqual)},c.throws=function(a,c,d){j.apply(this,[!0].concat(b.call(arguments)))},c.doesNotThrow=function(a,c,d){j.apply(this,[!1].concat(b.call(arguments)))},c.ifError=function(a){if(a)throw a},exports}),define("libs.tests/nodeunit/types",["libs/async/async","./assert"],function(a,b){var exports={};exports.assertion=function(a){return{method:a.method||"",message:a.message||a.error&&a.error.message||"",error:a.error,passed:function(){return!this.error},failed:function(){return Boolean(this.error)}}},exports.assertionList=function(a,b){var c=a||[];return c.failures=function(){var a=0;for(var b=0;b<this.length;b+=1)this[b].failed()&&(a+=1);return a},c.passes=function(){return c.length-c.failures()},c.duration=b||0,c};var c=function(a){return function(c,d,e){return function(){var f=arguments[e-1],g=exports.assertion({method:c,message:f});try{b[d].apply(null,arguments)}catch(h){g.error=h}a(g)}}};return exports.test=function(d,e,f,g){var h,i=[],j=c(function(b){i.push(b),f.log&&a.nextTick(function(){f.log(b)})}),k={done:function(b){if(h!==undefined&&h!==i.length){var c=new Error("Expected "+h+" assertions, "+i.length+" ran"),j=exports.assertion({method:"expect",error:c});i.push(j),f.log&&a.nextTick(function(){f.log(j)})}if(b){var k=exports.assertion({error:b});i.push(k),f.log&&a.nextTick(function(){f.log(k)})}var l=(new Date).getTime();a.nextTick(function(){var a=exports.assertionList(i,l-e);f.testDone(d,a,f.moduleId),g(null,i)})},ok:j("ok","ok",2),same:j("same","deepEqual",3),equals:j("equals","equal",3),expect:function(a){h=a},_assertion_list:i,_data:{},set:function(a,b){this._data[a]=b},get:function(a,b){return _.isUndefined(this._data[a])?b:this._data[a]},has:function(a){return!_.isUndefined(this._data[a])}};for(var l in b)b.hasOwnProperty(l)&&(k[l]=j(l,l,b[l].length));return k},exports.options=function(a){var b=function(b){a[b]=a[b]||function(){}};return b("moduleStart"),b("moduleDone"),b("testStart"),b("testDone"),a},exports}),define("libs.tests/nodeunit/reporters/browser",[],function(){return function(a){var exports={};return exports.info="Browser-based test reporter",exports.run=function(b,c){var d=(new Date).getTime();c=c||{};var e=c.bus||null;a.runModules(b,{filter:c.filter||!1,execution:c.execution,data:c.data,shuffle:c.shuffle,moduleStart:function(module){e.fire("module.start",{module:module})},testStart:function(a,b){e.fire("test.start",{names:a,moduleId:b})},testDone:function(a,b,c){e.fire("test.done",{names:a,moduleId:c,assertions:b})},moduleDone:function(module,a){e.fire("module.done",{module:module,assertions:a})},done:function(a){e.fire("modules.done",{assertions:a})}})},exports}}),define("libs.tests/nodeunit/extensions/assert-expressions",[],function(){function a(c,e,f,g){f=f||!1,g=g||[];if(c===e)return!0;if(e instanceof d)return e.assert(c);if(c===null||e===null)return!1;if(c instanceof Array&&e instanceof Array){if(c.length!=e.length)return!1;for(var h=0;h<c.length;h++){var i=b(c[h],e[h],f,g,e[h]);if(!i)return!1}return!0}if(typeof c=="object"&&typeof e=="object"){for(var h in e){var i=b(c[h],e[h],f,g,e[h]);if(!i)return!1}if(!f)for(var h in c)if(!a(c[h],e[h]))return!1;return!0}return!1}function b(b,c,d,e,f){if(f&&typeof f=="object"){for(var g=0;g<e.length;g++)if(f===e[g])throw new Error("Circular Reference detected in the object!");var h=e.length;e.push(f);var i=a(b,c,d,e);return e.splice(h),i}return a(b,c,d,e)}function d(a,b){this.type=a,this.param=b}var c={ANYTHING:0,NOT:1,INSTANCEOF:2,SUPERSET:3,REGEX:4,ANYOF:5,ALLOF:6,CUSTOM:7,ERROR:8};d.prototype.assert=function(b){switch(this.type){case c.ANYTHING:return!0;case c.NOT:return!a(b,this.param);case c.INSTANCEOF:return b instanceof this.param;case c.SUPERSET:return a(b,this.param,!0);case c.REGEX:return this.param.test(b);case c.ANYOF:for(var d=0;d<this.param.length;d++)if(a(b,this.param[d]))return!0;return!1;case c.ALLOF:for(var d=0;d<this.param.length;d++)if(!a(b,this.param[d]))return!1;return!0;case c.CUSTOM:return this.param(b);case c.ERROR:var e=!0;return"name"in this.param&&(e=e&&this.param.name===b.name),"message"in this.param&&(e=e&&this.param.message===b.message),"type"in this.param&&(e=e&&a(b,this.param.type)),e;case c.INTEGER:return isNaN(parseInt(b,10))===!1}},d.prototype.tostring=function(){switch(this.type){case c.ANYTHING:return"is.anything";case c.NOT:return"is.not("+tostring(this.param)+")";case c.INSTANCEOF:return"is.instanceOf("+_getClassName(this.param)+")";case c.SUPERSET:return"is.objectThatIncludes("+tostring(this.param)+")";case c.REGEX:return"is.regex("+this.param.toString()+")";case c.ANYOF:return"is.anyOf("+tostring(this.param)+")";case c.ALLOF:return"is.allOf("+tostring(this.param)+")";case c.CUSTOM:return"is.custom(function)";case c.ERROR:return a(this.param,{})?"is.exception()":"is.exception("+tostring(this.param)+")"}};var e={anything:new d(c.ANYTHING),not:function(a){return new d(c.NOT,a)},instanceOf:function(a){if(typeof a!="function")throw new Error("Invalid argument to is.instanceOf() , argument must be a Class");return new d(c.INSTANCEOF,a)},objectThatIncludes:function(a){return new d(c.SUPERSET,a)},regex:function(a){if(a instanceof RegExp)return new d(c.REGEX,a);throw new Error("Invalid argument to is.regex() , argument must be regex")},anyOf:function(a){if(a instanceof Array)return new d(c.ANYOF,a);throw new Error("Invalid argument to is.anyOf() , argument must be an Array")},allOf:function(a){if(a instanceof Array)return new d(c.ALLOF,a);throw new Error("Invalid argument to is.allOf() , argument must be an Array")},custom:function(a){if(!$.isFunction(a))throw new Error("Invalid argument to is.custom() , argument must be a Function that returns a boolean value");return new d(c.CUSTOM,a)},exception:function(a){if(typeof a=="string")return new d(c.ERROR,{message:a});typeof a=="undefined"&&(a={});if(typeof a!="object")throw new Error("Invalid argument to is.exception() , argument must be an object or string");if("type"in a&&typeof a["type"]!="function")throw new Error("Invalid argument to is.exception() , the type attribute of the parameter must be a Class");return"type"in a&&(a.type=new d(c.INSTANCEOF,a.type)),new d(c.ERROR,a)},integer:function(a){return new d(c.INTEGER)}};return{ExpressionFactory:e,assert:function(b,c){return b===c||a(b,c)}}}),define("tau/components/extensions/testrunner/utils/utils.testrunner.diff",[],function(){var a=Object.prototype.toString,b=Object.prototype.hasOwnProperty,c=function(){function a(a,c){var d={},e={};for(var f=0;f<c.length;f++)d[c[f]]==null&&(d[c[f]]={rows:[],o:null}),d[c[f]].rows.push(f);for(var f=0;f<a.length;f++)e[a[f]]==null&&(e[a[f]]={rows:[],n:null}),e[a[f]].rows.push(f);for(var f in d){if(!b.call(d,f))continue;d[f].rows.length==1&&typeof e[f]!="undefined"&&e[f].rows.length==1&&(c[d[f].rows[0]]={text:c[d[f].rows[0]],row:e[f].rows[0]},a[e[f].rows[0]]={text:a[e[f].rows[0]],row:d[f].rows[0]})}for(var f=0;f<c.length-1;f++)c[f].text!=null&&c[f+1].text==null&&c[f].row+1<a.length&&a[c[f].row+1].text==null&&c[f+1]==a[c[f].row+1]&&(c[f+1]={text:c[f+1],row:c[f].row+1},a[c[f].row+1]={text:a[c[f].row+1],row:f+1});for(var f=c.length-1;f>0;f--)c[f].text!=null&&c[f-1].text==null&&c[f].row>0&&a[c[f].row-1].text==null&&c[f-1]==a[c[f].row-1]&&(c[f-1]={text:c[f-1],row:c[f].row-1},a[c[f].row-1]={text:a[c[f].row-1],row:f-1});return{o:a,n:c}}return function(b,c){b=b.replace(/\s+$/,""),c=c.replace(/\s+$/,"");var d=a(b==""?[]:b.split(/\s+/),c==""?[]:c.split(/\s+/)),e="",f=b.match(/\s+/g);f==null?f=[" "]:f.push(" ");var g=c.match(/\s+/g);g==null?g=[" "]:g.push(" ");if(d.n.length==0)for(var h=0;h<d.o.length;h++)e+="<del>"+d.o[h]+f[h]+"</del>";else{if(d.n[0].text==null)for(c=0;c<d.o.length&&d.o[c].text==null;c++)e+="<del>"+d.o[c]+f[c]+"</del>";for(var h=0;h<d.n.length;h++)if(d.n[h].text==null)e+="<ins>"+d.n[h]+g[h]+"</ins>";else{var i="";for(c=d.n[h].row+1;c<d.o.length&&d.o[c].text==null;c++)i+="<del>"+d.o[c]+f[c]+"</del>";e+=" "+d.n[h].text+g[h]+i}}return e}}();return c}),define("tau/components/extensions/testrunner/utils/utils.testrunner.dump",[],function(){function f(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=f(c.childNodes));return b}function g(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1}var a=Object.prototype.toString,b=Object.prototype.hasOwnProperty,c=function(a,b){return d(b)==a},d=function(b){if(typeof b=="undefined")return"undefined";if(b===null)return"null";var c=a.call(b).match(/^\[object\s(.*)\]$/)[1]||"";switch(c){case"Number":return isNaN(b)?"nan":"number";case"String":case"Boolean":case"Array":case"Date":case"RegExp":case"Function":return c.toLowerCase()}return typeof b=="object"?"object":undefined},e=function(){function b(a){return'"'+a.toString().replace(/"/g,'\\"')+'"'}function d(a){return a+""}function e(a,b,c){var d=i.separator(),e=i.indent(),f=i.indent(1);return b.join&&(b=b.join(","+d+f)),b?[a,f+b,e+c].join(d):a+c}function f(a,b){var c=a.length,d=Array(c);this.up();while(c--)d[c]=this.parse(a[c],undefined,b);return this.down(),e("[",d,"]")}var h=/^function (\w+)/,i={parse:function(a,b,c){c=c||[];var d=this.parsers[b||this.typeOf(a)];b=typeof d;var e=g(a,c);if(e!=-1)return"recursion("+(e-c.length)+")";if(b=="function"){c.push(a);var f=d.call(this,a,c);return c.pop(),f}return b=="string"?d:this.parsers.error},typeOf:function(b){var d;return b===null?d="null":typeof b=="undefined"?d="undefined":c("RegExp",b)?d="regexp":c("Date",b)?d="date":c("Function",b)?d="function":typeof b.setInterval!==undefined&&typeof b.document!="undefined"&&typeof b.nodeType=="undefined"?d="window":b.nodeType===9?d="document":b.nodeType?d="node":a.call(b)==="[object Array]"||typeof b.length=="number"&&typeof b.item!="undefined"&&(b.length?b.item(0)===b[0]:b.item(0)===null&&typeof b[0]=="undefined")?d="array":d=typeof b,d},separator:function(){return this.multiline?this.HTML?"<br />":"\n":this.HTML?"&nbsp;":" "},indent:function(a){if(!this.multiline)return"";var b=this.indentChar;return this.HTML&&(b=b.replace(/\t/g,"   ").replace(/ /g,"&nbsp;")),Array(this._depth_+(a||0)).join(b)},up:function(a){this._depth_+=a||1},down:function(a){this._depth_-=a||1},setParser:function(a,b){this.parsers[a]=b},quote:b,literal:d,join:e,_depth_:1,parsers:{window:"[Window]",document:"[Document]",error:"[ERROR]",unknown:"[Unknown]","null":"null","undefined":"undefined","function":function(a){var b="function",c="name"in a?a.name:(h.exec(a)||[])[1];return c&&(b+=" "+c),b+="(",b=[b,i.parse(a,"functionArgs"),"){"].join(""),e(b,i.parse(a,"functionCode"),"}")},array:f,nodelist:f,arguments:f,object:function(a,b){var c=[];i.up();for(var d in a){var f=a[d];c.push(i.parse(d,"key")+": "+i.parse(f,undefined,b))}return i.down(),e("{",c,"}")},node:function(a){var b=i.HTML?"&lt;":"<",c=i.HTML?"&gt;":">",d=a.nodeName.toLowerCase(),e=b+d;for(var f in i.DOMAttrs){var g=a[i.DOMAttrs[f]];g&&(e+=" "+f+"="+i.parse(g,"attribute"))}return e+c+b+"/"+d+c},functionArgs:function(a){var b=a.length;if(!b)return"";var c=Array(b);while(b--)c[b]=String.fromCharCode(97+b);return" "+c.join(", ")+" "},key:b,functionCode:"[code]",attribute:b,string:b,date:b,regexp:d,number:d,"boolean":d},DOMAttrs:{id:"id",name:"name","class":"className"},HTML:!1,indentChar:"  ",multiline:!0};return i}();return e}),define("tau/components/extensions/testrunner/extension.driver.nodeunit.reporter",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/components/extensions/testrunner/utils/utils.testrunner.diff","tau/components/extensions/testrunner/utils/utils.testrunner.dump"],function(_,$,a,b,c){function d(a){return a?(a+="",a.replace(/[\&<>]/g,function(a){switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return a}})):""}function e(a){if(a.stacktrace)return a.stacktrace.split("\n")[6];if(a.stack)return a.stack.split("\n")[0];!a.sourceURL}window.jsErrors=[],window.onerror=function(a){window.jsErrors[window.jsErrors.length]=a};var f=function(a){var f=a.message;f=f?f:_.isString(a.error)?a.error:"";var g=!a.error,h=a.error?a.error.expected:"",i=a.error?a.error.actual:"",j=a.error?a.error.operator:null;f=d(f)||(g?"okay":"failed"),f='<span class="test-message">'+f+"</span>",h=d(c.parse(h)),i=d(c.parse(i));var k=f;k+="<table>",j&&(k+='<tr class="test-expected"><th>Expected: </th><td><pre>'+h+"</pre></td></tr>",i!=h&&(k+='<tr class="test-actual"><th>Result: </th><td><pre>'+i+"</pre></td></tr>",k+='<tr class="test-diff"><th>Diff: </th><td><pre>'+b(h,i)+"</pre></td></tr>"));if(!g){var l=e(a.error);l&&(k+='<tr class="test-source"><th>Source: </th><td><pre>'+d(l)+"</pre></td></tr>")}return k+="</table>",k};return a.extend({"bus afterRender":function(a){this.sourceTitle=document.title,document.title="♒ In Progress "+this.sourceTitle,this.$el=a.data.element,this.startedAt=(new Date).getTime()},"bus module.start":function(a){var module=a.data.module,b=this.$el.find("#"+module.id);b.toggleClass("nodeunit-pending",!1),b.toggleClass("nodeunit-inprogress",!0);var c=this.$el.find("#nodeunit-banner");c.toggleClass("nodeunit-pending",!1),c.toggleClass("nodeunit-inprogress",!0)},"bus test.start":function(a){var b=a.data.names,c=a.data.moduleId,d=_.underscored(b.join(" ").replace(/[^a-z\d]/gi," ")),e=b.join(" "),f=b.slice(1).join(" "),g=$(["<li id="+d+' role="test">',"<strong>"+f,'<b class="counts"> (','<b class="failed" role="failed">&infin;</b>,','<b class="passed" role="passed">&infin;</b>,','<b class="all" role="all">&infin;</b>',")</b> ",'<b class="all" role="time">&infin;</b> ms',"</strong>",'<a href="?filter='+e+'">Rerun</a>',"</li>"].join(""));this.$el.find("#"+c).find("[role=tests]").append(g)},"bus test.done":function(a){var b=a.data.names,c=a.data.assertions,d=a.data.moduleId,e=_.underscored(b.join(" ").replace(/[^a-z\d]/gi," ")),g=this.$el.find("#"+d).find("#"+e);g.find("[role=time]").text(c.duration),g.find("[role=passed]").text(c.passes()),g.find("[role=failed]").text(c.failures()),g.find("[role=all]").text(c.length);var h=$(["<ol>","</ol>"].join(""));_.forEach(c,function(a){var b=$("<li></li>"),c=f(a);a.failed()?(b.html(c),b.addClass("fail"),window.jsErrors.push("failure:"+a.message)):(b.html(a.message||a.method||"no message"),b.addClass("pass")),b.appendTo(h)}),c.failures()||h.hide(),g.find("strong").click(function(){h.toggle()}),h.appendTo(g)},"bus module.done":function(a){var module=a.data.module,b=a.data.assertions,c=this.$el.find("#"+module.id),d=!!b.failures();c.toggleClass("nodeunit-inprogress",!1),c.toggleClass("nodeunit-failed",d),c.toggleClass("nodeunit-passed",!d);var e=c.find("[role=result]");e.find("[role=time]").text(b.duration),e.find("[role=passed]").text(b.passes()),e.find("[role=failed]").text(b.failures()),e.find("[role=all]").text(b.length);var f=c.find("[role=test]");f.length==0&&c.hide()},"bus modules.done":function(a){if(!this.$el)return;var b=a.data.assertions,c=(new Date).getTime(),d=c-this.startedAt,e=b.failures(),f=!!e,g=this.$el.find("#nodeunit-banner");g.toggleClass("nodeunit-inprogress",!1),g.toggleClass("nodeunit-fail",f),g.toggleClass("nodeunit-pass",!f),document.title=f?"✖ Failed "+this.sourceTitle:"✔ Passed "+this.sourceTitle,window.allTestsCompleted=!0;var h=this.$el.find("[role=result-total]");h.find("[role=time]").text(b.duration),h.find("[role=passed]").text(b.passes()),h.find("[role=failed]").text(b.failures()),h.find("[role=all]").text(b.length)}})}),define("tau/ui/templates/testrunner/ui.template.testrunner.qunit",["tau/core/templates-factory"],function(a){var b={name:"testrunner.qunit",markup:["<div>",'<h1 id="qunit-header">Tau Tests Suite</h1>','<h2 id="qunit-banner"></h2>','<h2 id="qunit-userAgent"></h2>','<ol id="qunit-tests"></ol>','<p id="qunit-testresult" class="result"></p>',"</div>"]};return a.register(b)}),define("tau/ui/templates/testrunner/ui.template.testrunner.nodeunit",["tau/core/templates-factory"],function(a){var b={name:"testrunner.nodeunit",markup:["<div>",'<h1 id="nodeunit-header">','<form method="GET">','<a href="?">Tau Tests Suite</a>&nbsp;&nbsp;',"<fieldset><legend>General</legend>",'<label><input type="checkbox" name="shuffle" {{if options.shuffle}}checked{{/if}}>shuffle</label>','<label><input type="radio" name="execution" value="serial"   {{if options.execution == "serial"}}checked{{/if}}>serial execution</label>','<label><input type="radio" name="execution" value="parallel" {{if options.execution == "parallel"}}checked{{/if}}>parallel execution</label>',"</fieldset>","<fieldset><legend>Data</legend>",'<label><input type="radio" name="data" value="local" {{if options.data == "local"}}checked{{/if}}>local</label>','<label><input type="radio" name="data" value="remote" {{if options.data == "remote"}}checked{{/if}}>remote</label>',"</fieldset>",'<div class="nodeunit-form__buttons">','<input type="submit" name="apply" value="apply" />','<input type="submit" name="reset" value="reset to defaults" />',"{{if options.filter || options.file}}",'<input type="submit" name="reset_filters" value="reset filters" />',"{{/if}}","</div>",'<input type="hidden" name="filter" value="${options.filter}" />','<input type="hidden" name="file" value="${options.file}" />',"</form>","</h1>",'<h2 id="nodeunit-banner" class="nodeunit-pending"></h2>','<h2 id="nodeunit-userAgent">${useragent}</h2>','<p id="nodeunit-testresult" class="result" role="result-total">','Tests completed in <span role="time">&infin;</span> milliseconds.<br/>','<span class="passed" role="passed">&infin;</span> assertions of ','<span class="all" role="all">&infin;</span> passed,','<span class="failed" role="failed">&infin;</span> failed.',"</p>",'<ol id="nodeunit-tests">',"{{each modules}}",'<li class="nodeunit-pending" role="module" id="${$value.id}">','<strong class="nodeunit-module-name">${$value.name}</strong> ',"<i>${$value.file}</i>",'<a href="?file=${$value.file}">File</a>','<a href="?filter=${$value.name}">Rerun</a>','<div class="nodeunit-module-result" role="result">','Tests completed in <span role="time">&infin;</span> milliseconds.<br/>','<span class="passed" role="passed">&infin;</span> assertions of ','<span class="all" role="all">&infin;</span> passed,','<span class="failed" role="failed">&infin;</span> failed.',"</div>",'<ol class="nodeunit-tests" role="tests"></ol>',"</li>","{{/each}}","</ol>","</div>"]};return a.register(b)}),define("tau/models/model.timeList.editable",["Underscore","tau/components/extensions/component.extension.base"],function(_,a){var b=a.extend({category:"edit","bus beforeInit":function(){this.fire("permissionsReady",{editable:!0})}});return b}),define("tau/ui/templates/common/ui.template.entityIcon",["tau/core/templates-factory","tau/ui/tags/ui.tag.term"],function(a,b){var c={tags:[b],name:"entity-icon",markup:['<em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">{{term(__type) "iconBig"}}</em>'],dependencies:[]};return a.register(c)}),define("tau/ui/templates/timeList/ui.template.timeList.time",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(a){var b={name:"time-list-time",markup:["<tr>",'   <td class="date">${date}</td>','   <td class="spent">${spent} h</td>','   <td class="remain">${remain} h</td>','   <td class="description">${description}</td>','   <td class="work-on">','    {{tmpl(workOn) "entity-icon"}}',"    <span>${workOn.name}</span>","   </td>",'   <td class="person">${person}</td>','   <td class="edit-time hidden"><a href="${editUrl}">Edit</a></td>','   <td class="delete-time hidden"><button type="button" class="action-detach button small">Delete</button></td>',"</tr>"].join(""),dependencies:["entity-icon"]};return a.register(b)}),define("tau/ui/templates/timeList/ui.template.timeList",["tau/core/templates-factory","tau/ui/templates/timeList/ui.template.timeList.time"],function(a){var b={name:"time-list",options:{contentSelector:".time-list"},markup:['<div class="ui-timeList-content">','<table class="ui-table box time-list"{{if items.length === 0}} style="display:none"{{/if}}>',"<thead>",'   <tr class="head-row">','       <th class="header-cell">Date</th>','       <th class="header-cell">Time Spent</th>','       <th class="header-cell">Time Remain</th>','       <th class="header-cell">Description</th>','       <th class="header-cell">Work On</th>','       <th class="header-cell">Person</th>','       <th class="header-cell edit-time hidden"></th>','       <th class="header-cell delete-time hidden"></th>',"   </tr>","</thead>","<tbody>",'    {{tmpl(items) "time-list-time"}}',"</tbody>","</table>","</div>"].join(""),dependencies:["time-list-time"]};return a.register(b)}),define("tau/components/extensions/timeList/extension.timeList.delete",["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus afterRender+permissionsReady+dataBind":function(a){if(a.permissionsReady.data.editable){var b=a.afterRender.data.element;b.find(".delete-time,.edit-time").removeClass("hidden"),b.find(".delete-time button").click($.proxy(this.onDeleteClick,this))}},"bus afterRemove":function(){this.fire("refresh")},onDeleteClick:function(a){var b=$(a.target).parents("tr").tmplItem().data.id;this.fire("remove",{id:b,typeName:"time"})}})}),define("tau/models/model.title.editable",["tau/core/model.editable.base","tau/utils/utils.jsonSchema"],function(a,b){var c=a.extend({category:"edit",name:"Editable title",schema:b.Schema.create({type:"object",properties:{name:{optional:!1,type:"string",maxLength:255,pre:["trim"],fallbacks:{maxLength:"truncateToMaxLength",optional:function(){}}}}}),"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus validate":function(a){var b=a.data,c=b.cmd.$set;b.validation=this.schema.validate(c)}});return c}),define("tau/components/extensions/title/extension.title.editable",["tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(a){return a.extend({category:"edit","bus changeName":function(a){this.bus.fire("save",{name:a.data})},"bus permissionsReady+afterRender":function(a){var b=this,c=a.permissionsReady.data;if(c.editable){var d=a.afterRender.data.element,e=d.find(".entity-title");this.$widget=e,e.editableText({restoreText:!0,onSave:function(a){b.bus.fire("changeName",a)},onEditStart:function(){b._$titleInfo=e.find(".title-info").detach()},onEditEnd:function(){b._$titleInfo.appendTo(e)}})}},"bus validate":function(){if(!this.$widget)return;this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(a){if(!this.$widget)return;this.$widget.editableText("setValue",a.data.validation.instance.name)},"bus validationFailed":function(a){if(!this.$widget)return;this.$widget.editableText("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/ui/templates/title/ui.template.title",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityIcon"],function(a){var b={name:"title",markup:['<table class="ui-title">',"<tbody>","<tr>","<td>",'{{tmpl({__type:entity.__type}) "entity-icon"}}','<span class="entity-id"><a class="ui-link" href="${url}">#${entity.id}</a></span>',"</td>","<td>",'<div class="entity-title">',"${entity.name}",'{{if entity.__type !== "project"}}','<span class="title-info"> for ${project.name}</span>',"{{/if}}","</div>","</td>","</tr>","</tbody>","</table>"],dependencies:["entity-icon"]};return a.register(b)}),define("tau/models/extensions/team/extension.model.teamOfEntityRetriever",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{project:["id"]}]},callback:{scope:this,success:this.onEntityRetrieved}})},onEntityRetrieved:function(a){var b=a.data.project?a.data.project.id:a.data.id,c={user:["id","firstName","lastName","isActive"]},d={role:["id","name"]},e={projectMembers:[c,d]};this.fire("get",{type:"project",query:{id:b,fields:["id",e]},callback:{scope:this,success:this.onProjectRetrieved}}),this.fire("commitTransaction")},onProjectRetrieved:function(a){var b=a.data.projectMembers;this.fire("projectMembersReady",b);var c=this.getRoles(b);this.fire("projectRolesReady",c)},getRoles:function(a){var b={},c=[];return _.each(a,function(a){var d=a.role;b.hasOwnProperty(d.id)||(b[d.id]=!0,c.push(d))}),c}})}),define("tau/models/userList/extension.model.assignmentsUser.Excluder",["Underscore","tau/core/model-base"],function(_,a){return a.extend({"bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={role:["id","name"]},c={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",b,c],list:!0}]},callback:{scope:this,success:this.onEntityRetrieved}})},onEntityRetrieved:function(a){var b=this.config.data||{},c=a.data,d=[],e=b.roleId||(b.role||{}).id;if(e){var f=c.assignments||[];for(var g=0;g<f.length;g++)f[g].role.id==e&&d.push(f[g].generalUser)}this.fire("excludedUserReady",d)}})}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList",["tau/core/templates-factory","tau/ui/templates/common/ui.template.user"],function(a){var b={name:"user-list",markup:'<div class="role-title" role="user-group">${role.name}</div>{{tmpl(users) "user"}}',dependencies:["user"]};return a.register(b)}),define("tau/ui/templates/common/ui.template.linkAction",["tau/core/templates-factory"],function(a){var b={name:"link-action",markup:['<a class="${id}-link user-action" >',"   ${title}","</a>"].join("")};return a.register(b)}),define("tau/ui/templates/filteredUserList/ui.template.filteredUserList",["tau/core/templates-factory","tau/ui/templates/filteredUserList/ui.template.filteredUserList.userList","tau/ui/templates/common/ui.template.buttonAction","tau/ui/templates/common/ui.template.linkAction"],function(a){var b={name:"filtered-user-list",markup:['<div class="filtered-user-list">','<div class="header-box">','{{tmpl(headerActions) "button-action"}}',"</div>",'<div class="search-box-container">','   <input type="text" class="user-search-box">','   <div class="help">For filter start typing name or occupation</div>',"</div>",'<div class="user-list"><div class="i-inner">{{tmpl(groups) "user-list"}}</div></div>','<div class="footer-box">','<a class="more-link ',"{{if moreAvailable == false}}","link-hidden","{{/if}}",'" >',"more...","</a>","</div>","</div>"],dependencies:["user-list","button-action","link-action"]};return a.register(b)}),define("tau/models/model.extension",["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction")}});return b}),define("tau/configurations/converters/converter.print",["Underscore","tau/models/model.extension","tau/models/model.impedimentsCountCalculator","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/components/extensions/impedimentList/extension.impedimentList.visibilityController","tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(_,a,b,c,d,e,f,g,h){var i={impedimentListPanel:function(a,c){var d=new h(c.getTerms());return _.extend(a,{compId:"impediments",type:"container",layout:"list",cssClass:"b-section",disableAnimation:!0,children:[{type:"label",text:d.getTerms("Impediment").names,hideCounter:!0},{type:"impedimentList",disableModel:!0}],extensions:[e,b,g]}),a},duplicateBugListPanel:function(a,b){var e=new h(b.getTerms());return _.extend(a,{compId:"duplicateBugs",type:"container",layout:"list",cssClass:"b-section",disableAnimation:!0,children:[{type:"label",text:"Duplicate "+e.getTerms("Bug").names,hideCounter:!0},{type:"duplicateBugList",disableModel:!0}],extensions:[f,d,c,g]}),a},tabs:function(a){a=_.extend(a,{type:"container",children:[],cssClass:"b-tabs"});var b=[];return _.forEach(a.tabs,function(b,c){var d=!1;b=_.extend(b,{type:"container",children:b.items,cssClass:"b-tab"}),d=!_.isUndefined(b.children)&&b.children.length&&b.children[0].type==="revisionList";if(d)return;!_.isUndefined(b.header)&&b.header.length&&b.children.unshift({type:"label",text:b.header[0].text}),a.children.push(b)}),a},collapsible:function(a){return a=_.extend(a,{type:"container",children:[],cssClass:"b-section"}),a.children=a.items,!_.isUndefined(a.header)&&a.header.length&&a.children.unshift({type:"label",text:a.header[0].text}),a}},j=function(a,b){var c=null;if(_.isArray(a)){var d=0;c=function(b){a.splice(b,1),d--};for(d=0;d<a.length;d++)b(a[d],d,c)}else{c=function(b){delete a[b]};var e=_(a).keys(),f=null;while(f=e.pop())b(a[f],f,c)}},k=function(a,b){return j(a,function(c,d,e){if(c.type){if(c.printable===!1){e(d);return}_.isFunction(i[c.type])&&(a[d]=i[c.type](c,b)),c.children&&(a[d].children=k(c.children,b)),c.items&&(a[d].items=k(c.items,b)),a[d].disabledExtensionCategories=["edit"]}else d=="children"&&(a[d]=k(c,b))}),a};return{convert:function(a){return a=k(a,a.context),a.children&&a.children.length&&(a.children[0].cssClass="main-container main-container-print i-print"),a}}}),define("tau/components/extensions/print.convert.extension",["tau/components/extensions/component.extension.base","tau/configurations/converters/converter.print"],function(a,b){return a.extend({"bus onConfigContainerCreated":function(a){var c=a.data;b.convert(c),c.children.push({type:"print"})},"bus afterRender":function(a){var b=a.data.element,c=b.find("a");c.removeAttr("href"),b.find("[role=attachment]").removeAttr("role")}})}),define("tau/services/service.applicationContext",["tau/core/class","tau/configurator"],function(a,b){var c=a.extend({init:function(a){this.store=a||b.getStore()},getApplicationContext:function(a,b){this.store.get("context",{id:a.id,fields:["id","acid","culture","edition",{loggedUser:["id","email","isAdministrator"]},{processes:["id","name","terms","practices","customFields"]},{selectedProjects:["id","name",{process:["id","name"]}]}]}).done({success:function(a){b.success.apply(null,[a[0].data])}})}});return c}),define("tau/service.container",["tau/core/Class","tau/store/factory","tau/core/keyboard.manager","tau/core/global.bus","tau/core/external","tau/core/state.manager","tau/services/service.routing","tau/utils/utils.routing","tau/utils/utils.history","libs/parseUri","tau/store/services/service.globalSettings","tau/services/service.applicationContext","tau/store/services/service.notifications","tau/store/services/service.actions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return a.extend({ckPath:"../Ckeditor/",_config:{},isBoardEdition:!1,setRestStorageService:function(a){this.restStorageService=a},getRestStorageService:function(){return this.restStorageService},getStoreFactory:function(){return this.storeFactory||(this.storeFactory=new b),this.storeFactory},getKeyBoardManager:function(){if(!this.keyboardManager){this.keyboardManager=new c;var a={handleKeyDown:function(a){a.keyCode==$.ui.keyCode.ESCAPE&&(a.preventDefault(),a.stopPropagation())}};this.keyboardManager.pushHandler(a)}return this.keyboardManager},setGlobalSettingsService:function(a){this.globalSettingsService=a},getGlobalSettingsService:function(){if(!this.globalSettingsService){var a={appPath:this.getApplicationPath()};this.globalSettingsService=new k(a)}return this.globalSettingsService},setApplicationContextService:function(a){this.applicationContextService=a},getApplicationContextService:function(){return this.applicationContextService||(this.applicationContextService=new l(this.getStore())),this.applicationContextService},setNotificationService:function(a){this.notificationService=a},getNotificationService:function(){if(!this.notificationService){var a={appPath:this.getApplicationPath()};this.notificationService=new m(a)}return this.notificationService},setActionsService:function(a){this.actionsService=a},getActionsService:function(){if(!this.actionsService){var a={appPath:this.getApplicationPath()};this.actionsService=new n(a)}return this.actionsService},clearSingles:function(){this.getStoreFactory().clearSingles()},clear:function(){this.clearSingles(),d.reset(),delete this.currentDate,delete this.external,delete this.stateManager,this.getStoreFactory().clear()},getCurrentAcid:function(){var a="",b=this.getWindow();if(b.location&&b.location.href){var c=b.location.href;a=j(c).queryKey.acid||a}return a},setWindow:function(a){this.window=a},getWindow:function(){return this.window||window},getHistory:function(){return this.history||(this.history=new i),this.history},pushRouting:function(){this.routingArr=this.routingArr||[],this.routingArr.push(this.routing),this.routing=null},popRouting:function(){this.routing=this.routingArr.pop()},createRouting:function(a){var b={window:this.getWindow()};a&&(b.safe=!0,b.v2=!0,b.safeParameterName=a);var c=new h(b);return c},getRouting:function(a){return this.routing||(this.routing=this.createRouting(a)),this.routing},setCurrentDate:function(a){this.currentDate=a},getCurrentDate:function(){return this.currentDate?this.currentDate:new Date},getGlobalBus:function(){return d.get()},setApplicationPath:function(a){this.getStoreFactory().setApplicationPath(a)},getApplicationPath:function(){return this.getStoreFactory().getApplicationPath()},getCkPath:function(){return this.ckPath},setCkPath:function(a){this.ckPath=a},setInitialData:function(a){this.getStoreFactory().setInitialData(a)},setStoreFactory:function(a){this.storeFactory=a},setService:function(a){this.getStoreFactory().setService(a)},getService:function(){return this.getStoreFactory().getService()},getRestPath:function(){return this.getStoreFactory().getRestPath()},setProxy:function(a){this.getStoreFactory().setProxy(a)},getProxy:function(){return this.getStoreFactory().getProxy()},disableRules:function(){this.getStoreFactory().disableRules()},enableRules:function(){this.getStoreFactory().enableRules()},initRules:function(){this.getStoreFactory().initRules()},getStore:function(a){return a=a||{},_.defaults(a,{services:this}),this.getStoreFactory().getStore(a)},setConfig:function(a,b){this._config[a]=b},getConfig:function(a,b){var c=b;return this._config.hasOwnProperty(a)&&(c=this._config[a]),c},setExternal:function(a){this.external=new e(a)},getExternal:function(){return this.external||(this.external=new e(window)),this.external},getStateManager:function(){var a=this;if(!a.stateManager){var b=a.getExternal(),c=new g({external:b});a.stateManager=new f({service:c,state:b.hashParams()}),b.onHashChange(function(b){var c=b.hashParams();a.stateManager.update(c)})}return a.stateManager}})}),define("tau/configurator",["tau/service.container","tau/store/factory.instance"],function(a,b){var c=new a;return c.setStoreFactory(b),c}),define("tau/core/component-base",["Underscore","tau/core/class","tau/configurator","tau/core/bus"],function(_,a,b,c){return a.extend({init:function(a){return this.config=_.extend({},a),this.config.context=this.config.context||{},_.defaults(this.config.context,{configurator:b}),this.bus=new c({name:a.name,globalBus:this.config.context.configurator.getGlobalBus()}),_.defaults(this.config,{bus:this.bus}),this},attach:function(a,b){b=b||{};var c=this.config.disabledExtensionCategories;if(c){var d=a.prototype.category;if(d&&_.indexOf(c,d)>=0)return this}var e=_.clone(this.config);b.hasOwnProperty("onCreate")||(e=_.extend(e,b));var f=new a(e);return b.onCreate&&b.onCreate(f),this}})}),define("tau/components/component.collapsibleHeader",["Underscore","tau/core/component-base","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/collapsibleHeader/ui.extension.collapsibleHeader","tau/ui/templates/collapsibleHeader/ui.template.collapsibleHeader"],function(_,a,b,c,d,e,f){return{create:function(g){return g=g||{},_.defaults(g,{template:f,cssClass:"ui-collapsible-header",childrenContainerSelector:".ui-children-container"}),(new a(g)).attach(c).attach(d).attach(e).attach(b).bus}}}),define("tau/components/component.creator",["Underscore","tau/core/component-base","tau/core/view-base","tau/ui/extensions/ui.extension.domOperationsBase"],function(_,a,b,c){return{create:function(d,e){var f=e||{};d=d||{},_.defaults(f,{name:d.name}),d.template&&(f.template=d.template);var g=new a(f);f=g.config;var h=f.context.configurator;_.defaults(f,{store:h.getStore()});var i=d.ViewType||b;g.attach(i),d.ModelType&&g.attach(d.ModelType);var j=d.domOperations||c;g.attach(j);if(d.extensions&&d.extensions.constructor==Array)for(var k=0;k<d.extensions.length;k++){var l=d.extensions[k];l.hasOwnProperty("type")&&l.hasOwnProperty("config")?g.attach(l.type,l.config):g.attach(l)}return g.bus}}}),define("tau/components/component.additionalInfo",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/additionalInfo/extension.additionalInfo.editable","tau/components/extensions/additionalInfo/extension.additionalInfo.updateAnimation","tau/components/extensions/component.creator.extension","tau/ui/templates/container/ui.template.container.table","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(_,a,b,c,d,e,f,g,h){return{create:function(i){i=i||{};var j=[];_.forEach(i.children,function(a){a.label&&a.field?(a.label.disabledExtensionCategories=i.disabledExtensionCategories,j.push(a.label),a.field.disabledExtensionCategories=i.disabledExtensionCategories,j.push(a.field)):(a.disabledExtensionCategories=i.disabledExtensionCategories,j.push(a))}),i.children=j,_.defaults(i,{template:f,cssClass:"additional-info-table",columnCount:2,cellsCssClass:["ui-additionalinfo__label","ui-additionalinfo__value"],layout:"table"});var k={extensions:[e,g,d,h,c],ViewType:b};return a.create(k,i)}}}),define("tau/components/component.assignedEffort",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/label/ui.template.assignmentEffort.label"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.board.grid",["tau/components/component.creator","tau/models/model.board.grid","tau/ui/templates/board.grid/ui.template.board.grid"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.board.header",["Underscore","tau/components/component.creator","tau/models/model.board.header","tau/ui/templates/board.header/ui.template.board.header"],function(_,a,b,c){return{create:function(d){var e={extensions:[b],template:c},f=a.create(e,d);return f}}}),define("tau/components/component.board.overview",["Underscore","tau/components/component.creator","tau/models/model.board.overview","tau/ui/extensions/board.overview/ui.extension.board.overview","tau/ui/templates/board.overview/ui.template.board.overview"],function(_,a,b,c,d){return{create:function(e){var f={extensions:[b,c],template:d},g=a.create(f,e);return g}}}),define("tau/components/component.board.selector",["Underscore","tau/components/component.creator","tau/models/model.board.selector","tau/ui/templates/board.selector/ui.template.board.selector"],function(_,a,b,c){return{create:function(d){var e={extensions:[b],template:c},f=a.create(e,d);return f}}}),define("tau/components/component.board.settings",["Underscore","tau/components/component.creator","tau/models/model.board.settings","tau/ui/extensions/board.settings/ui.extension.board.settings.create","tau/ui/templates/board.settings/ui.template.board.settings"],function(_,a,b,c,d){return{create:function(e){var f={extensions:[b,c],template:d},g=a.create(f,e);return g}}}),define("tau/components/component.board.zoomLevel",["Underscore","tau/components/component.creator","tau/models/model.board.zoomLevel","tau/ui/templates/board.zoomLevel/ui.template.board.zoomLevel","tau/ui/extensions/board.zoomLevel/ui.extension.board.zoomLevel.editable"],function(_,a,b,c,d){return{create:function(e){var f={ModelType:b,template:c,extensions:[d]};return a.create(f,e)}}}),define("tau/components/component.container",["Underscore","tau/components/component.creator","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout","tau/ui/extensions/spinner/ui.extension.spinner"],function(_,a,b,c,d,e){return{create:function(f){var g={extensions:_.concat([f.extensions,c,d,e]),ViewType:b};return a.create(g,f)}}}),define("tau/components/component.board.container",["Underscore","tau/components/component.container","tau/components/extensions/board.container/extension.board.container"],function(_,a,b){return{create:function(c){return c=_.extend(c,{extensions:[b]}),a.create(c)}}}),define("tau/views/view.page.board",["Underscore","tau/core/view-base","tau/components/component.container","tau/configurations/board.container.config","tau/components/extensions/board.container/extension.board.container","tau/models/boardSettings/factory.board.settings"],function(_,a,b,c,d,e){return a.extend({init:function(a){this._super(a),this.config.placeholder&&this.config.placeholder.addClass("ui-entity-view")},"container afterInit":function(a){this.fireAfterInit()},initialize:function(){},"container componentsCreated":function(a){this.fire(a.name,a.data)},"container afterRender":function(a){this.fireBeforeRender(),this.element=a.data.element,this.config.placeholder&&this.config.placeholder.append(this.element),this.config.placeholder&&this.config.placeholder.addClass("tau-entity-loaded"),this.fireAfterRender()},"bus beforeInit":function(a){var f=this,g=a.data,h=g.config.context.configurator;g.context=_.extend(g.context||{},{acid:h.getCurrentAcid(),configurator:h,entity:{entityType:{name:"board"}}});var i=c.getDefaultBoardSettings(g.config.context.entity.id),j=e.createInstance(h,i);j.bind({fields:["viewMode"],listener:f,callback:function(a){this.fire("refresh")}}),j.get({fields:["viewMode"],callback:function(a){_.extend(g,a),_.extend(g,c.getConfig(g)),f.container=b.create({name:"board page container",layout:g.layout,template:g.template,store:f.config.store,extensions:[d],context:{configurator:g.config.context.configurator}}),f.container.on("afterInit",f["container afterInit"],f),f.container.on("afterRender",f["container afterRender"],f),f.container.on("componentsCreated",f["container componentsCreated"],f),f.container.fire("boardSettings.ready",{boardSettings:j}),f.container.initialize(g)}})},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){if(!this.container)return;this.container.destroy(),this.container=null},destroy:function(){this.destroyContainer(),this.container=null,this._super()}})}),define("tau/components/component.editor.requester",["tau/components/component.creator","tau/models/model.requester","tau/ui/extensions/editor.requester/ui.extension.editor.requester.form","tau/ui/templates/editor.requester/ui.template.editor.requester"],function(a,b,c,d){return{create:function(e){var f={name:"finder",extensions:[b,c],template:d};return a.create(f,e)}}}),define("tau/components/component.feature.totalEffort",["tau/components/component.creator","tau/models/model.feature.totalEffort","tau/ui/templates/feature/ui.template.totalEffort"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c};return a.create(e,d)}}}),define("tau/components/component.iteration.progressBar",["tau/components/component.creator","tau/models/model.iteration.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.label",["Underscore","tau/components/component.creator","tau/models/model.label","tau/ui/templates/label/ui.template.label","tau/ui/extensions/label/ui.extension.label"],function(_,a,b,c,d){return{create:function(e){var f={ModelType:b,template:c,extensions:_.clone(e.extensions||[])};return e.hideCounter||f.extensions.push(d),a.create(f,e)}}}),define("tau/components/component.label.duplicateBugCount",["Underscore","tau/components/component.label","tau/components/extensions/duplicateBugList/extension.duplicateBugList.count.label.setter","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(_,a,b,c,d,e,f,g){return{create:function(e){var h=e.context.applicationContext.processes[0].terms,i=new g(h);return e=e||{},_.extend(e,{text:"Duplicate "+i.getTerms("Bug").names,quantityCssClass:e.quantityCssClass||"ui-gray-quantity",extensions:[b,c,f,d]}),a.create(e)}}}),define("tau/components/component.label.impedimentsCount",["Underscore","tau/components/component.label","tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter","tau/models/model.impedimentsCountCalculator","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(_,a,b,c,d,e,f){return{create:function(d){var g=new f(d.context.getTerms());return d=d||{},_.extend(d,{text:g.getTerms("Impediment").names,quantityCssClass:d.quantityCssClass||"ui-red-quantity",extensions:[b,c,e]}),a.create(d)}}}),define("tau/components/component.list.creator",["tau/components/component.creator","tau/ui/extensions/baseList/ui.extension.baseList"],function(a,b){return{create:function(c,d){return d.emptyDataMessage=c.message,d.contentSelector=c.template.options.contentSelector,c.showEmptyMessage!==!1&&(c.extensions=c.extensions||[],c.extensions.push(b)),a.create(c,d)}}}),define("tau/components/component.list.baseInfo",["Underscore","tau/components/component.list.creator","tau/models/model.list.baseInfo","tau/models/assignmentsList/extension.model.store.operations","tau/ui/templates/list/ui.template.list.baseInfo","tau/core/termProcessor"],function(_,a,b,c,d,e){return{create:function(f,g){var h=new e(f.context.getTerms());return g=g||{},g.extensions=_.compact(_.union(g.extensions,[c])),_.extend(g,{message:"No "+h.getTerms(f.typeName).names.toLowerCase()+" found",ModelType:f.ModelType||b,template:d}),a.create(g,f)}}}),define("tau/components/component.duplicateBugList",["Underscore","tau/components/component.list.baseInfo","tau/models/model.duplicateBugList","tau/models/model.duplicateBugRetriever"],function(_,a,b,c){return{create:function(d){return d.ModelType=b,d.typeName="bug",a.create(d,{extensions:[c]})}}}),define("tau/components/component.impedimentList",["Underscore","tau/components/component.list.baseInfo","tau/models/baseInfoList/extension.model.additionalInfoImpedimentFilter"],function(_,a,b){return{create:function(c){return c.typeName="impediment",c.propertyName="impediments",a.create(c,{extensions:[b]})}}}),define("tau/components/component.page.base",["Underscore","tau/components/component.creator","tau/components/extensions/storeFreeze.extension","tau/components/extensions/context.convert.extension","tau/components/extensions/error/extension.errorBar","tau/components/extensions/extension.storeErrorEmiter","tau/ui/extensions/ui.extension.loading"],function(_,a,b,c,d,e,f){return{create:function(g,h){var i=[b,c,d,e,f];i=_.union(i,g.extensions);var j={name:g.name,ModelType:g.ModelType,ViewType:g.ViewType,extensions:i};return a.create(j,h)}}}),define("tau/components/component.page.board",["tau/components/component.page.base","tau/views/view.page.board"],function(a,b){return{create:function(c){var d={name:"board page component",extensions:[],ViewType:b};return a.create(d,c)}}}),define("tau/components/component.progressBar",["Underscore","tau/components/component.creator","tau/views/view.composer","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/models/model.state.editable","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/ui/templates/progressBar/ui.template.progressBar"],function(_,a,b,c,d,e,f,g,h){return{create:function(i,j){j=j||{};var k={ViewType:b,extensions:[j.model||d,e,c,f,g],template:j.template||h},l=i.extensions||[];for(var m=0;m<l.length;m++)k.extensions.push(l[m]);return _(i).extend({children:[{id:"ctrlEntityState",type:"property.entityState",disabledExtensionCategories:i.disabledExtensionCategories}]}),a.create(k,i)}}}),define("tau/components/component.progressBar.small",["Underscore","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.progressBar","tau/ui/extensions/progressBar/ui.extension.progressBar.updater","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/progressBar/ui.template.progressBar.small"],function(_,a,b,c,d,e,f){return{create:function(b,g){g=g||{};var h={extensions:[c,d,e],template:f};return a.create(h,b)}}}),define("tau/components/component.property.abbreviation",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.abbreviation.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(_,a,b,c,d,e,f,g){return{create:function(h){h.propertyName="abbreviation";var i={ModelType:b,extensions:[c,d,e,f],template:g};return a.create(i,h)}}}),define("tau/components/component.property.bool",["Underscore","tau/components/component.creator","tau/models/model.property.bool","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/property/extension.property.bool.editable","tau/ui/templates/property/ui.template.bool"],function(_,a,b,c,d,e,f){return{create:function(g){var h=_.concat([g.extensions,d]);g.editable===!0&&(h=_.concat([h,e,c]));var i={ModelType:b,template:g.template||f,extensions:h};return a.create(i,g)}}}),define("tau/components/component.property.isActive",["tau/components/component.property.bool"],function(a){return{create:function(b){return b=b||{},b.propertyName="isActive",a.create(b)}}}),define("tau/components/component.property.isPrivate",["Underscore","tau/components/component.property.bool"],function(_,a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="isPrivate",b.editable=!0,a.create(b)}}}),define("tau/components/component.property.isProduct",["tau/components/component.property.bool"],function(a){return{create:function(b){return b=b||{},b.propertyName="isProduct",a.create(b)}}}),define("tau/components/component.property.lastStatus",["tau/components/component.property.bool","tau/ui/templates/property/ui.template.property.status"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="lastStatus",c.template=b,a.create(c)}}}),define("tau/components/component.property.status.testCaseRun",["tau/components/component.property.bool","tau/ui/templates/property/ui.template.property.status.testCaseRun"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="passed",c.template=b,a.create(c)}}}),define("tau/components/component.property.effort",["tau/components/component.creator","tau/models/model.property.effort","tau/models/model.property.effort.editable","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/effort/extension.effort.editable","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property.effort/ui.template.property.effort"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={extensions:[b,c,f,d,e,g],template:h};return a.create(j,i)}}}),define("tau/components/component.property.email",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.email.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(_,a,b,c,d,e,f,g){return{create:function(h){h.propertyName="mailReplyAddress";var i={ModelType:b,extensions:[c,d,e,f],template:g};return a.create(i,h)}}}),define("tau/components/component.property.entityState",["tau/components/component.creator","tau/models/model.property.entityState","tau/models/model.property.entityState.editable","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.attributeValue","tau/components/extensions/entityState/extension.entityState.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,d,e,f,h]};return a.create(j,i)}}}),define("tau/components/component.property.text",["Underscore","tau/components/component.creator","tau/models/model.property.text","tau/models/model.property.text.editable","tau/models/model.property.text.validation","tau/components/extensions/property/extension.property.text.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property"],function(_,a,b,c,d,e,f,g){return{create:function(h){var i={ModelType:b,extensions:_.concat([h.extensions,c,d,e,f]),template:g};return a.create(i,h)}}}),define("tau/components/component.property.lastFailureComment",["Underscore","tau/components/component.property.text"],function(_,a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="lastFailureComment",b.defaultText="N/A",a.create(b)}}}),define("tau/components/component.release.assignedEffort",["tau/components/component.creator","tau/models/model.release.progressBar","tau/ui/templates/label/ui.template.assignmentEffort.label"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.release.progressBar",["tau/components/component.creator","tau/models/model.release.progressBar","tau/ui/templates/progressBar/ui.template.iteration.progressBar"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/component.tags",["tau/components/component.creator","tau/models/model.tags","tau/models/model.tags.editable","tau/ui/extensions/tags/ui.extension.tags.duplicateBug","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/components/extensions/tags/extension.tags.editable","tau/ui/templates/tags/ui.template.tags"],function(a,b,c,d,e,f,g){return{create:function(h){var i={extensions:[b,c,f,d,e],template:g};return a.create(i,h)}}}),define("tau/components/component.testCasesRunResults",["tau/components/component.creator","tau/models/model.testCasesRunResults","tau/ui/templates/testCasesRunResults/ui.template.testCasesRunResults"],function(a,b,c){return{create:function(d){var e={ModelType:b,template:c};return a.create(e,d)}}}),define("tau/components/component.tabsHeader",["Underscore","tau/core/component-base","tau/views/view.container","tau/components/extensions/component.creator.extension","tau/ui/extensions/layout/ui.extension.layout.tabsHeader","tau/ui/templates/container/ui.template.container.tabsHeader"],function(_,a,b,c,d,e){return{create:function(f){return f=f||{},_.defaults(f,{template:e}),(new a(f)).attach(b).attach(c).attach(d).bus}}}),define("tau/views/view.tabs",["Underscore","tau/views/view.container","tau/components/component.tabsHeader"],function(_,a){var b=a.extend({"bus beforeInit":function(a){var b=this;b._selectedIndex=-1,this.additionalHeaderTabIndexList={};var c=a.data.config;this.tabsHeader={type:"tabsHeader",children:[]},this.panels=[],_.each(c.tabs,this.addTabInfo,this),_.each(c.additionalHeaders||[],this.addAdditionalActionToTab,this),c.children=[this.tabsHeader].concat(this.panels)},addTabInfo:function(a,b){var c=a.selected===!0,d={type:"container",name:a.label+" tab container",selected:c,children:a.header||[],label:a.label};this.tabsHeader.children.push(d);var e={type:"container",visible:c,children:a.items||[]};this.panels.push(e),c&&(this._selectedIndex=b)},addAdditionalActionToTab:function(a){var b=a||{};b.position={right:!0};var c=this.tabsHeader;c.children.push(b),this.additionalHeaderTabIndexList[c.children.length]=!0}});return b}),define("tau/components/component.tabs",["tau/components/component.creator","tau/views/view.tabs","tau/components/extensions/component.creator.extension","tau/ui/extensions/tabs/ui.extension.tabs.state.routing","tau/ui/extensions/tabs/ui.extension.tabs.state.simple","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(a,b,c,d,e,f,g){return{create:function(h){var i=h.stateName?d:e,j={extensions:[c,i,f].concat(h.extensions||[]),ViewType:b,template:g};return a.create(j,h)}}}),define("tau/components/extensions/application/extension.history",["Underscore","jQuery","tau/core/class","tau/core/event","tau/store/types","tau/configurator"],function(_,$,a,b,c,d){return a.extend({init:function(a){this.config=a,this.bus=a.bus,this.globalBus=this.bus.getGlobalBus(),d.getWindow().document&&(this.defaultTitle=d.getWindow().document.title),b.subscribeOn(this);var c=function(a){var b=d.getHistory().getCurrent();b&&b.title&&(d.getWindow().document.title=b.title)};this._currentHandler=_.bind(c,this),d.getHistory().on("setCurrent",this._currentHandler,this)},"bus controller.preExecute":function(a){d.getHistory().process()},"bus controller.postExecute":function(a){},clearCurrent:function(){d.getHistory().current=null},"bus destroy":function(){d.getWindow().document&&(d.getWindow().document.title=this.defaultTitle),this.clearCurrent(),d.getHistory().stack=[],d.getHistory().removeAllListeners(this)}})}),define("tau/utils/utils.redirect",["Underscore","jQuery","tau/core/class","tau/configurator"],function(_,$,a,b){return a.extend({init:function(a){this.context=a,this.window=b.getWindow()},_process:function(a){var c=null;if(a.match(/^http(s)?:\/\//i))c=a;else if(a[0]=="#")c=a;else{var d=b.getApplicationPath();a[0]!=="/"&&(a="/"+a),c=d+a}return this.context&&(c=$.tmpl(c,this.context).text()),c},_redirect:function(a,b){b.location.href=a},redirect:function(a,b){var c=this.window;if(typeof b!="undefined"){var d=$(document),e={scrollbars:1,width:d.width()*.8,height:d.height()*.8,top:50},f=[],g=null;for(g in e)f.push(g+"="+e[g]);var h=f.join(",");c=this.window.open(this._process(a),b,h);return}this._redirect(this._process(a),c)},back:function(){this.window.history&&this.window.history.back&&this.window.history.back()},reload:function(){this.window.location&&this.window.location.reload&&this.window.location.reload()}})}),define("tau/components/extensions/application/extension.integration",["Underscore","jQuery","tau/core/class","tau/core/event","tau/store/types","tau/configurator","tau/utils/utils.redirect"],function(_,$,a,b,c,d,e){return a.extend({init:function(a){this.config=a,this.config.integration=this.config.integration||{},this.bus=a.bus,this.globalBus=this.bus.getGlobalBus(),b.subscribeOn(this),this.criticalChanged=!1,this.window=d.getWindow(),this.redirect=new e},"bus afterRender":function(){$("body").delegate("a[href=#]","click",function(a){a.preventDefault()});var a=this.config.integration.reloadCallback,b=!!a;b?$("html").addClass("tau-html_integration_popup"):$("html").addClass("tau-html_integration_main")},"bus initProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show("Reloading...")},"bus application.error":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"globalBus showProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show(a.data.text)},"globalBus hideProgress":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"bus destroy":function(){d.getGlobalBus().removeAllListeners(this),this.window._criticalTauChanges&&(this.bus.fire("initProgress"),this.redirect.reload()),$("body .jquery-notify-bar").remove()},"bus application.reload":function(a){var b=this.config.integration.reloadCallback;if(!!b==0)return;b(a)},"bus application.exit":function(a){var b=this.config.integration.reloadCallback,c=!!b;c?(this.window._criticalTauChanges=!0,this.bus.fire("destroy")):(this.bus.fire("initProgress"),this.redirect.redirect("default.aspx"))}})}),define("tau/components/extensions/application/extension.controller.board",["Underscore","jQuery","tau/core/event.emitter","tau/utils/utils.redirect","tau/components/extensions/print.convert.extension"],function(_,$,a,b,c){return a.extend({init:function(a){this._super(a),this.config=a},"bus view.dom.ready+componentsCreated":function(a){var b=a.componentsCreated.data;_.each(b,function(a){a.component.fire("view.dom.ready")})},"bus afterRender:last+innerContentRendered":function(a){var b=a.afterRender.data.element,c=a.innerContentRendered.data.element,d="",e="";c.hasClass("tau-board-container")?(d="tau-page-board",e="tau-page-entity"):(d="tau-page-entity",e="tau-page-board"),b.removeClass(e).addClass(d).append(c)},"bus application.navigate.board":function(a){this.executeAction({strategy:"board",action:"actionBoard",parameters:a.data})},"bus application.navigate.entity":function(a){var b=a.data,c="action"+(b.action||"show").toLocaleLowerCase();c=this.hasOwnProperty(c)?c:"actionshow",this.executeAction({strategy:"entity",action:c,parameters:b})},executeAction:function(a){var b=this;require(["tau/components/component.page."+a.strategy],function(c){var d=a.action,e=a.parameters;b.fire("controller.preExecute",{action:d,parameters:e}),b[d](c,e.id,e.entity),b.fire("controller.postExecute")})},actionBoard:function(a,b){this.current&&this.current.fire("destroy");var c=this,d={context:{configurator:c.config.context.configurator,entity:{id:b,entityType:{name:"board"}}}};this.current=a.create(d),this.current.on("componentsCreated",function(a){this.fire.apply(c,arguments)},this),this.current.on("error",function(a){c.fire("application.error")}),this.current.on("afterRender",function(a){c.fire("innerContentRendered",{element:a.data.element})}),this.current.on("componentsCreated",function(a){c.fire("componentsCreated",a.data)}),this.current.initialize()},_getItemConfig:function(a,b){return{context:{configurator:this.config.context.configurator},entity:{id:a,type:b}}},actionshow:function(a,b,c){this._action(a,b,c),$("html").toggleClass("tau-html_action_view",!0).toggleClass("tau-html_action_print",!1)},actionprint:function(a,b,d){this._action(a,b,d,{extensions:[c]}),$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!0),$("body").addClass("print-mode")},_action:function(a,c,d,e){$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!1),this.current&&this.current.fire("destroy");var f=this;this.current=a.create(this._getItemConfig(c,d),e||{}),this.current.on("beforeDelete",function(a){f.fire("initProgress")}),this.current.on("deleted",function(a){var c=f.config.context.configurator.getHistory(),d=new b,e=c.pop();e?(c.setCurrent(null),d.redirect(e.url)):f.fire("application.exit")}),this.current.on("error",function(a){f.fire("application.error")}),this.current.on("afterRender",function(a){f.fire("innerContentRendered",{element:a.data.element})}),this.current.initialize()},destroy:function(){this._super(),this.current&&this.current.fire("destroy"),delete this.current,delete this.config}})}),define("tau/ui/extensions/print/ui.extension.print",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.redirect"],function(_,$,a,b){return a.extend({"bus beforeInit":function(a){this.options=a.data.config,this.options.window=this.options.window||window},"bus afterRender":function(a){this.element=a.data.element,this.entity=a.data.data.context.entity;var b=this.element,c=this;this._printHandler||(this._printHandler=_.bind(this._print,this),b.find(".ui-print__controls__print").bind("click",this._printHandler));var d=b.find(".ui-print__controls__close");this._closeHandler||(this._closeHandler=_.bind(this._close,this),b.find(".ui-print__controls__close").bind("click",this._closeHandler))},_print:function(a){this.options.window.print()},_close:function(a){a.preventDefault(),this.options.window.opener?this.options.window.close():(new b(this.options.context)).redirect("View.aspx?noRedirect=1&id=${entity.id}")}})}),define("tau/components/component.print",["Underscore","tau/core/component-base","tau/views/view.container","tau/ui/templates/print/ui.template.print","tau/ui/extensions/print/ui.extension.print"],function(_,a,b,c,d){return{create:function(e){return e=e||{},_.defaults(e,{template:c}),(new a(e)).attach(d).attach(b).bus}}}),define("tau/components/extensions/property/extension.property.process.refresher",["Underscore","tau/core/model-base","tau/utils/utils.redirect"],function(_,a,b){return a.extend({category:"refresher","bus afterInit":function(){var a=this.store,c=this.config.context.entity,d=this.config.bus;this.store.unbind(this),a.on({eventName:"afterSave",type:"project",listener:this,filter:{id:c.id},hasChanges:["process"]},function(){d.getGlobalBus().fire("processChanged",{project:c,entity:c}),(new b).reload()})}})}),define("tau/components/extensions/redirect/extension.redirect",["tau/components/extensions/component.extension.base","tau/utils/utils.redirect"],function(a,b){return a.extend({_redirect:function(a){this.redirect.redirect(a)},"bus afterInit":function(a){this.redirect=new b(a.data.config.context),this._redirect(a.data.config.to)},"bus redirect":function(a){this._redirect(a.data.to)}})}),define("tau/components/component.redirect",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/redirect/extension.redirect","tau/ui/templates/menu/ui.template.menu.actions"],function(a,b,c,d){return{create:function(b){var d={extensions:[c]};return a.create(d,b)}}}),define("tau/ui/extensions/popup/ui.extension.popup",["jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function($,a,b){return a.extend({init:function(a){var b=this;b._super(a),b.bodyOverflow=$("body").css("overflow"),$("body").css("overflow","hidden"),b.$overlay=$('<div class="ui-popup-overlay" style="display: none;"></div>').appendTo("body"),b.$container=$('<div class="ui-popup" style="display: none;"><div class="close"></div></div>').appendTo("body")},"bus beforeDelete":function(){},"bus deleted":function(){var a=this,b=this.$container.position(),c=b.top,d=b.left,e=this.$container.width(),f=this.$container.height();this.$container.animate({opacity:0,top:c+f/2,left:d+e/2,width:0,height:0},800,function(){a.bus.fire("destroy")}),this.$overlay.hide()},"bus contentRendered":function(a){var b=this;b.$overlay.show(),b.element=a.data.element,b.element.addClass("ui-popup-content");var c=b.$container,d=$(".close",c);d.hide(),c.animate({opacity:"show"},150,function(){b.element.appendTo(c),d.fadeIn(1e3),b._attachHandlers()})},_attachKeyBoardHandling:function(){var a=this,c={handleKeyDown:function(){a._onDocumentKeyDown.apply(a,arguments)}};b.getKeyBoardManager().pushHandler(c)},_attachHandlers:function(){if(this._attached)return;this._attached=!0,this._onBodyClickHandler=$.proxy(this._onBodyClick,this),this._onDocumentKeyDownHandler=$.proxy(this._onDocumentKeyDown,this),this._onCloseButtonClickHandler=$.proxy(this._onCloseButtonClick,this),$(document).bind("click",this._onBodyClickHandler),this._attachKeyBoardHandling(),this.$container.find(".close").bind("click",this._onCloseButtonClickHandler),this._removeElements=this._removeElementsInnerImpl},_onDocumentKeyDown:function(a){a.keyCode==$.ui.keyCode.ESCAPE&&this.fire("destroy")},_onBodyClick:function(a){if(a.target!=this.$overlay[0])return;this.fire("destroy")},_onCloseButtonClick:function(){this.fire("destroy")},_detachHandlers:function(){$(document).unbind("click",this._onBodyClickHandler),this.element&&this.element.parents(".ui-popup").unbind("click",this._onElementClickHandler),b.getKeyBoardManager().popHandler(),this.$container.find(".close").unbind("click",this._onCloseButtonClickHandler)},_removeElementsInnerImpl:function(){this.$overlay.remove(),this.$container.remove(),$("body").css("overflow",this.bodyOverflow)},_removeElements:$.noop,destroy:function(){this._detachHandlers(),this._removeElements(),this._super()}})}),define("tau/components/component.application.boardPlus",["tau/components/component.creator","tau/core/component-base","tau/service.container","tau/store/factory.instance","tau/core/view-base","tau/components/extensions/application/extension.history","tau/components/extensions/application/extension.routing","tau/components/extensions/application/extension.routing.patterns","tau/components/extensions/application/extension.integration","tau/components/extensions/application/extension.navigation","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/popup/ui.extension.popup","tau/components/extensions/application/extension.controller.board","tau/components/extensions/application/extension.controller.board.entity","tau/ui/templates/application/ui.template.application.boardPlus"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){return{create:function(a){a=a||{onCreate:function(){}};var p=new c;p.setStoreFactory(d),p.____id="personal-board-configurator",p.isBoardEdition=!0;var q={name:"application component",template:o,context:{configurator:p}},r=new b(q);return r.attach(g,a).attach(h,a).attach(f,a).attach(i,a).attach(j,a).attach(k,a).attach(m,a).attach(n,a).attach(e),a.integration&&a.integration.showInPopup===!0&&r.attach(l,a),r.bus}}}),define("tau/models/assignmentsList/extension.model.assignmentToRolesMapper",["Underscore","tau/models/extension.model.base","tau/configurator"],function(_,a,b){return a.extend({category:"model assignment to role mapper","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={generalUser:["id","firstName","lastName"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{assignments:["id",{role:["id","name"]},b],list:!0}]},callback:{scope:this,success:this.onAssignmentsRetrieved}})},"bus assignmentsReady+rolesReady+extendDataToBind":function(a){var b=(a.assignmentsReady||{}).data,c=(a.rolesReady||{}).data,d=(a.extendDataToBind||{}).data,e=c,f=[];for(var g=0;g<e.length;g++){var h=e[g],i={};i.role=h,i.users=this.getUsersInRole(b,h),i.allowAdd=(h.isPair?2:1)>i.users.length,this.fire("userGroupWasCreated",i),f.push(i)}d.assignments={groups:f}},_convertUserDataToViewData:function(a){var c=[b.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join("");return{id:a.id,name:a.firstName+" "+a.lastName,avatar:c}},getUsersInRole:function(a,b){var c=[],a=_.sortBy(a,function(a){return a.id}),d=a.length;for(var e=0;e<d;e++){var f=a[e];if(f.role.id==b.id){var g=this._convertUserDataToViewData(f.generalUser);g.assignmentId=f.id,g.roleId=b.id,c.push(g)}}return c}})}),define("tau/models/model.assignmentsList",["Underscore","tau/store/types","tau/core/model-base","tau/models/assignmentsList/extension.model.effortRetriever","tau/models/assignmentsList/extension.model.store.operations","tau/models/assignmentsList/extension.model.effortPointsRetriever","tau/models/assignmentsList/extension.model.assignmentsRetriever","tau/models/assignmentsList/extension.model.entityRolesRetriever","tau/models/assignmentsList/extension.model.featureRolesRetriever","tau/models/assignmentsList/extension.model.assignmentToRolesMapper","tau/models/assignmentsList/extension.model.taskEffortRetriever"],function(_,a,b,c,d,e,f,g,h,i,j){var k=b.extend({"bus assignmentsReady":function(a){this.assignments=a.data},"bus roleEffortsReady":function(a){this.roleEfforts=a.data},destroyExtensions:function(){var a=this.extensions||[];if(a.length>0){var b=this.config.context.entity.id,c=this.bus;_.each(a,function(a){a.destroy("destroy")})}delete this.extensions},initExtensions:function(){this.destroyExtensions();var b=a.findByKeyword(this.config.context.entity.entityType.name),k=new(b.name!="feature"?g:h)(this.config);this.extensions=[new c(this.config),new d(this.config),new e(this.config),new f(this.config),k,new i(this.config)],b.name.toLowerCase()=="userstory"&&this.extensions.push(new j(this.config))},onInit:function(){this.clearData();var a=this;a.store.unbind(a),a.initExtensions(),a.fire("registerStoreRequest"),a.fire("commitTransaction",{success:a.done,scope:a}),this.bindStoreListeners()},done:function(){var a={};this.bus.fire("extendDataToBind",a),this.bus.fire("dataBind",a),this.destroyExtensions()},bindStoreListeners:function(){var a=this;a.store.on({eventName:"afterSave",type:"assignment",listener:a},function(){a.afterAssignmentSaved.apply(a,arguments)}),a.store.on({eventName:"beforeSave",type:"assignment",listener:a},function(){a.beforeSaveAssignment.apply(a,arguments)}),a.store.on({eventName:"beforeSave",type:"roleEffort",listener:a},function(){a.beforeSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"afterSave",type:"roleEffort",listener:a},function(){a.afterSaveRoleEffort.apply(a,arguments)}),a.store.on({eventName:"beforeRemove",type:"assignment",listener:a},function(){a.beforeRemoveAssignment.apply(a,arguments)}),a.store.on({eventName:"afterRemove",type:"assignment",listener:a},function(){a.afterAssignmentRemoved.apply(a,arguments)});var b=this.config.context.entity.id,c=this.config.context.entity.entityType.name,d={id:b};a.store.on({eventName:"beforeRemove",type:c,listener:a,filter:d},function(){a.store.unbind(a)}),a.store.on({eventName:"beforeSave",type:c,listener:a,filter:d,hasChanges:["entityState"]},_.bind(a.beforeEntityEntityStateChanged,a)),a.store.on({eventName:"afterSave",type:c,listener:a,filter:d,hasChanges:["entityState"]},_.bind(a.afterEntityEntityStateChanged,a)),a.store.on({eventName:"afterSave",type:c,listener:a,filter:d,hasChanges:["effort|effortToDo|effortCompleted|tasks-count|tasks-effort-sum|tasks-effortToDo-sum"]},_.bind(a.onDataUpdate,a))},beforeEntityEntityStateChanged:function(a){this.fire("beforeStateChanged")},afterEntityEntityStateChanged:function(a){this.fire("afterStateChanged")},onDataUpdate:function(a){this.fire("dataDidUpdated")},beforeSaveRoleEffort:function(a){var b=a.data.id;if(_.isNumber(b)&&this.isRoleEffortOfCurrentEntity(b)){var c=a.data.cmd;c.config.fields=c.config.fields||[],c.config.fields.push("effortToDo"),this.fire("beforeSaveRoleEffort",{roleEffortId:b})}},afterSaveRoleEffort:function(a){var b=a.data.id;_.isNumber(b)&&this.isRoleEffortOfCurrentEntity(b)&&this.fire("afterSaveRoleEffort",{roleEffortId:b})},beforeRemoveAssignment:function(a){this.fireEventIfAssignmentFromCurrentEntity(a,"beforeRemoveAssignment")},afterAssignmentRemoved:function(a){this.fireEventIfAssignmentFromCurrentEntity(a,"afterAssignmentRemoved")},beforeSaveAssignment:function(a){_.isNumber(a.data.id)?this.fireEventIfAssignmentFromCurrentEntity(a,"beforeSaveAssignment"):this.fireEventIfAssignmentFromCurrentEntity(a,"beforeAddAssignment")},afterAssignmentSaved:function(a){_.isNumber(a.data.cmd.config.id)?this.fireEventIfAssignmentFromCurrentEntity(a,"afterAssignmentSaved"):this.fireEventIfAssignmentFromCurrentEntity(a,"afterAssignmentAdded")},fireEventIfAssignmentFromCurrentEntity:function(a,b){var c=a.data.id;if(this.isAssignmentOfCurrentEntity(c)||((a.data.changes||{}).assignable||{}).id===this.config.context.entity.id){var d=_.extend({assignmentId:c},a.data.changes);this.fire(b,d)}},isRoleEffortOfCurrentEntity:function(a){return _.any(this.roleEfforts,function(b){return b.id===a})},isAssignmentOfCurrentEntity:function(a){return _.any(this.assignments,function(b){return b.id===a})},clearData:function(){delete this.assignments,delete this.roleEfforts},destroy:function(){this.clearData(),this._super.apply(this,arguments)}});return k}),define("tau/models/assignment/model.property.assignUser.editable.base",["Underscore","tau/core/model.editable.base","tau/configurator"],function(_,a){return a.extend({"bus assignToLoggedUser":function(){this.assignTo(this.getLoggedUser().id)},"bus changeAssignment":function(a){var b=a.data.user.id;this.assignTo(b)},getLoggedUser:function(){return this.config.context.getLoggedUser()},assignTo:function(a){},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base","tau/configurator"],function(_,a){return a.extend({"bus removeAssignment":function(){var a={id:this.config.data.assignmentId,typeName:"assignment"};this.fire("remove",a)},assignTo:function(a){var b={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.hasOwnProperty("assignmentId")&&_.extend(b,{id:this.config.data.assignmentId,$set:{generalUser:{id:a}}}),this.fire("save",b)},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/models/assignment/model.property.owner.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(_,a){return a.extend({assignTo:function(a){var b={type:this.config.context.entity.entityType.name,$set:{owner:{id:a}},$include:[{owner:["id","firstName","lastName","email"]}]};this.fire("save",b)}})}),define("tau/components/extensions/user/extension.owner.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder"],function(a,b,c){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c},getExtensions:function(){return[b]}})}),define("tau/components/extensions/user/extension.owner.project.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder","tau/models/extensions/team/extension.model.allUserRetriever"],function(a,b,c,d){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c,a.Retriever=d},getExtensions:function(){return[b]}})}),define("tau/components/extensions/user/extension.owner.request.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.owner.editable","tau/models/userList/extension.model.owner.Excluder","tau/models/extensions/team/extension.model.requestOwners.retriever"],function(a,b,c,d){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c,a.Retriever=d},getExtensions:function(){return[b]},"bus initBubble":function(a){var b=a.data.target,c=function(){b.tauBubble("empty"),b.data("bubbleLoaded",!1)};b.bind("externalClose",c),b.bind("close",c)}})}),define("tau/models/assignment/model.property.responsible.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base"],function(_,a){return a.extend({assignTo:function(a){var b={type:this.config.context.entity.entityType.name,$set:{responsible:{id:a}},$include:[{responsible:["id","firstName","lastName"]}]};this.fire("save",b)}})}),define("tau/components/extensions/user/extension.responsible.editable",["tau/components/extensions/user/extension.user.editable","tau/models/assignment/model.property.responsible.editable","tau/models/userList/extension.model.responsible.Excluder"],function(a,b,c){return a.extend({category:"edit",extendEditorConfig:function(a){a.UserExcluder=c},getExtensions:function(){return[b]}})}),define("tau/models/assignment/model.add.assignment.editable",["Underscore","tau/models/assignment/model.property.assignUser.editable.base","tau/configurator"],function(_,a){return a.extend({assignTo:function(a){var b={typeName:"assignment",$include:[{generalUser:["id","firstName","lastName"]},{role:["id","name"]},{assignable:["id"]}]};this.config.data.role&&_.extend(b,{id:null,$set:{generalUser:{id:a},assignable:{id:parseInt(this.config.context.entity.id)},role:{id:this.config.data.role.id}}}),this.fire("save",b)},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/components/component.assignmentsList",["Underscore","tau/components/component.creator","tau/models/model.assignmentsList","tau/models/model.assignmentsList.editable","tau/models/userList/extension.model.unassignAction","tau/models/userList/extension.model.showMore","tau/components/extensions/assignmentsList/extension.assignmentsList.editable","tau/components/extensions/component.creator.extension","tau/ui/extensions/popupEditorContainer.extension","tau/models/assignment/model.assignment.editable","tau/models/assignment/model.add.assignment.editable","tau/ui/templates/assignmentsList/ui.template.assignmentsList"],function(_,a,b,c,d,e,f,g,h,i,j,k){return{create:function(l){var m={extensions:_.concat([b,g,c,f,{type:h,config:{popupEditorContainer:[{targetSelector:".user-list .user",alignmentSelector:".user-name",alignmentSelectorFrom:"target",component:{type:"userList",extensions:[i,d,e]}}]}},{type:h,config:{popupEditorContainer:[{targetSelector:".owner-cell .user-name",component:{type:"userList",extensions:[e]}}]}},{type:h,config:{popupEditorContainer:[{targetSelector:".add-btn:not(.disabled)",component:{type:"userList",extensions:[j,e]}}]}},l.extensions]),template:l.template||k};return a.create(m,l)}}}),define("tau/components/component.feature.assignmentList",["Underscore","tau/components/component.assignmentsList","tau/ui/templates/assignmentsList/ui.template.feature.assignmentsList"],function(_,a,b){return{create:function(c){return _(c).extend({template:b}),a.create(c)}}}),define("tau/utils/utils.date",["Underscore","tau/configurator","tau/utils/utils.date/utils.date.formats","tau/utils/utils.translation","libs/date.js/build/date","libs/date.js/build/time.special"],function(_,a,b,c){var d={},e="/Date",f=/^\/Date\((-?\d+)(([+-])(\d{2})(\d{2}))\)\//;Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getDate(),this.getMonth())};var g=function(a){return function(b){var c=d.parse(b);return c?d._format(c,a):""}};return d={serverTimezoneOffset:-1*(new Date).getTimezoneOffset(),format:{date:{"short":g(b.date.short)},time:{"short":g(b.time.short)},datetime:{"short":g(b.datetime.short)}},_format:function(a,b){return a.toString(b)||""},formatAs:function(a,b){return this._format(a,b)},parse:function(a){if(_.isString(a)&&a.indexOf(e)==0){var b=a.match(f),c=parseInt(b[1]),g=(parseInt(b[4])*60+parseInt(b[5]))*parseInt(b[3]+"1");a=new Date(c),a.sourceOffset=g,d.serverTimezoneOffset=g}return Date.parse(a)},convertToTimezone:function(a,b){a=d.parse(a);if(!a)return a;b||(b=a.sourceOffset||null);if(!b)return a;var c=(new Date).getTimezoneOffset(),e=b+c;return a=new Date(a.getTime()+e*60*1e3),a},getFormatData:function(){return b},getAge:function(b,d){d=d||a.getCurrentDate(),b=Date.parse(b);var e={isZero:!0,value:0,unit:"sec",direction:"ago",toString:function(){var a;return this.isZero?a="now":a=this.value+" "+this.unit+" "+this.direction,a}};e.direction=d>b?"ago":"after";var f=new TimePeriod(b,d,function(a){return a===1?1:a<1?0:Math.ceil(a)}),g=[{func:"years",units:"year|years"},{func:"months",units:"month|months"},{func:"days",units:"day|days"},{func:"hours",units:"hour|hours"},{func:"minutes",units:"min"},{func:"seconds",units:"sec"}],h=_.detect(g,function(a,b){var d=f[a.func];if(d!==0)return a.value=Math.abs(d),a.unit=c.pluralize(a.units,d),!0});return h&&(e.isZero=!1,e.value=h.value,e.unit=h.unit),e}},d}),define("tau/models/model.attachments",["tau/core/model-base","tau/configurator","tau/utils/utils.date"],function(a,b,c){function e(a,b){this.model=a,this.filterCallback=b||d}var d=function(){return!0};e.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(a){this.assignable=a.data;var b={items:this.getAttachments()},c=this.getSelected();c&&(b.selected=c),this.model.data=b,this.model.bus.fire("dataBind",b)},each:function(a){var b=this.assignable.attachments,c=b.length;for(var d=0;d<c;d++){var e=b[d];this.filterCallback(e)&&a(e)}},getAttachments:function(){var a=this,b=[],c=a.model.config.selected,d=function(d){var e=a.attachmentDTOToModelAttachment(d);b.push(e),c&&d.id==c.id&&(a.selected=e,e.selected=!0)};return this.each(d),b},attachmentDTOToModelAttachment:function(a){var b=c.parse(c.convertToTimezone(a.date));return{id:a.id,name:a.name,mimeType:a.mimeType,ownerName:[a.owner.firstName," ",a.owner.lastName].join(""),date:c.format.date.short(b),thumbnailUri:a.thumbnailUri,uri:a.uri}},getSelected:function(){return this.selected}};var f=a.extend({init:function(a,b,c){this.name="Attachment Model",this._super.apply(this,arguments),this.filter=this.config.filter||c},_getFields:function(){var a=[{attachments:["id","date","name","mimeType","uri","thumbnailUri",{owner:["id","firstName","lastName"]}]}];return a},onInit:function(){var a=this.config.context.entity,b=new e(this,this.filter),c=this._getFields();this.store.get(a.entityType.name,{id:a.id,fields:c},b.getAssignableRetrievedCallback()).done()},setSelected:function(a){if(this.config.selected.id!=a.id){var b=this.data.items,c=null;for(var d=0;d<b.length;d++)if(b[d].id==a.id){c=b[d];break}c&&(this.config.selected=c,this.fire("selectedChanged",{attachment:a}))}},next:function(){var a=this.data.items,b=null,c=this.config.selected;for(var d=0;d<a.length;d++)if(a[d].id==c.id){b=a[d];break}b&&(d==a.length-1&&(d=-1),this.setSelected(a[d+1]))},prev:function(){var a=this.data.items,b=null,c=this.config.selected;for(var d=0;d<a.length;d++)if(a[d].id==c.id){b=a[d];break}b&&(d==0&&(d=a.length),this.setSelected(a[d-1]))},close:function(){this.fire("close")},"bus attachmentUploaded":function(a){var b=this,c=[{general:["id"]}].concat(b._getFields()[0].attachments);b.store.save("attachment",{id:a.data.data.id,$set:{},fields:c}).done({success:function(){b.bus.fire("attachmentUploadCompleted",{element:a.data.element})}})}});return f}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.customFields",["Underscore","tau/core/templates-factory","tau/utils/utils.date"],function(_,a,b){var c={name:"boardplus.card.customFields",engine:"jqote2",customFunctions:{formatDate:function(a){var a=b.parse(a);return a.toString("MMM yyyy")},isDate:function(a){return _.isDate(b.parse(a))}},markup:[['<span class="tau-customField"><%=this.name%>: ','<%if (this.type === "Date"){ %>',"<%=fn.formatDate(this.value)%>","<%}%>","<% else {%>","<%= this.value%>","<%}%>","</span>"].join("")]};return a.register(c)}),define("tau/ui/templates/board.plus/ui.template.boardplus.card.userStory",["tau/core/templates-factory","tau/ui/templates/board.plus/ui.template.boardplus.card.assignments","tau/ui/templates/board.plus/ui.template.boardplus.card.customFields","tau/ui/templates/board.plus/ui.template.boardplus.card.id"],function(a){var b={name:"boardplus.card.userstory",engine:"jqote2",markup:[["<div>",'   <%= fn.sub("boardplus.card.id", this) %>','<% if (this.hasOwnProperty("tags") && this.tags.length > 0) {%>',"<% for( var i=0;i<this.tags.length;i++){%>",'<span class="tau-tag"><%=this.tags[i]%></span>',"<% } %>","<% } %>","</div>",'<div class="tau-name"><%= this.name %></div>',"<div>",'<% if (this.hasOwnProperty("assignments")) {%>','   <%= fn.sub("boardplus.card.assignments", this.assignments) %>',"<% } %>","<% if (this.openImpedimentsCount) {%>",'   <span class="tau-impediments"><%=this.openImpedimentsCount%></span>',"<% } %>",'<% if (this.hasOwnProperty("effort")) {%>','   <div class="tau-effort"><%=this.effort%> pt</div>',"<% } %>",'<% if (this.hasOwnProperty("tasksInfo")) {%>','   <div class="tau-related-tasks">',"<%=this.tasksInfo.plannedCount%>/<%=this.tasksInfo.inProgressCount%>","   </div>","<% } %>",'<% if (this.hasOwnProperty("bugsInfo")) {%>','<div class="tau-related-bugs">',"<%=this.bugsInfo.plannedCount%>/<%=this.bugsInfo.inProgressCount%>","</div>","<% } %>","</div>",'<% if (this.hasOwnProperty("customFields")) {%>',"<div>",'   <%= fn.sub("boardplus.card.customFields", this.customFields) %>',"</div>","<% } %>"].join("")]};return a.register(b)}),define("tau/ui/templates/board.plus/ui.template.boardplus.cards",["tau/core/templates-factory","tau/ui/templates/board.plus/ui.template.boardplus.card.userStory"],function(a){var b={name:"boardplus.cards",engine:"jqote2",markup:[['<%= fn.sub("boardplus.card.userstory", this.items) %>'].join("")]};return a.register(b)}),define("tau/ui/extensions/board.plus/ui.extension.board.plus.cardsUpdater",["Underscore","jQuery","tau/core/event.emitter","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/templates/board.plus/ui.template.boardplus.cards"],function(_,$,a,b){var c=function(a){return"zoom-level-"+a};return a.extend({"bus view.skeleton.built:last+model.zoomLevelChanged:last":function(a){var b=a["view.skeleton.built"].data.element,d=b.attr("class");_.each(d.split(" "),function(a){a.indexOf("zoom-level-")==0&&b.removeClass(a)}),b.addClass(c(a["model.zoomLevelChanged"].data.zoomLevel))},"bus view.skeleton.built+model.cards.data.ready":function(a){var b=a["model.cards.data.ready"].data.cards;b.length>0&&this.fire("model.data.loader.registerItems",{items:_.pluck(b,"data")})},"bus model.dataUpdated:last+view.dom.ready:last+view.skeleton.built:last":function(a){var b=a["model.dataUpdated"].data,c=this,d=new Date;this.detachedElements=[],this.renderedItems=[],_.each(b.items,function(a){c.fire("template.pure.bind",{name:"boardplus.card.userstory",data:a})});var e=[];for(var f=0;f<this.renderedItems.length;f++){var g=this.renderedItems[f],h=g.card;h.innerHTML=g.html,this.fire("view.card.updated",{card:h})}_.each(e,function(a){a.parent.appendChild(a.child)})},"bus template.boardplus.card.userstory.pure.bound":function(a){var c=a.data,d=c.data,e=document.getElementById(b.generateCardId(d)),f=e.parentNode;e.innerHTML=c.html,this.renderedItems.push({card:e,html:c.html})}})}),define("tau/components/component.board.plus",["Underscore","tau/core/bus.profiler","tau/components/component.creator","tau/views/view.board.plus","tau/models/board.plus/model.board.plus","tau/models/board.plus/model.board.cell.preloadable","tau/ui/extensions/board.plus/ui.extension.board.plus.controller","tau/ui/extensions/board.plus/ui.extension.board.plus.layout","tau/ui/extensions/board.plus/ui.extension.board.plus.selection","tau/models/board.plus/model.board.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.batch","tau/ui/extensions/board.plus/ui.extension.board.plus.requestIndicator","tau/models/board.plus/model.board.collapse","tau/ui/extensions/board.plus/ui.extension.board.plus.collapse","tau/models/board.plus/model.board.focus","tau/ui/extensions/board.plus/ui.extension.board.plus.focus","tau/ui/extensions/board.plus/ui.extension.board.plus.name","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsUpdater","tau/models/board.plus/model.dataUpdater","tau/models/model.board.zoomLevel","tau/ui/extensions/board.zoomLevel/ui.extension.board.zoomLevel.editable","tau/ui/extensions/board.plus/ui.extension.board.plus.viewMode","tau/ui/extensions/board.plus/ui.extension.board.plus.profiler","tau/ui/extensions/ui.extension.templateBinder","tau/ui/templates/board.plus/ui.template.boardplus.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.cell.grid.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.card.userStory","tau/ui/templates/board.plus/ui.template.boardplus.request.indicator"],function(_,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){return{create:function(z){var A={ViewType:c,ModelType:d,extensions:[e,f,g,h,i,j,k,l,m,n,o,p,q,u,v,r,s,t,w,x,y]},B=b.create(A,z),C=new a(B);return B.fire("profiler.ready",{profiler:C}),B}}}),define("tau/components/component.board.plus.list",["Underscore","tau/core/bus.profiler","tau/ui/extensions/board.plus/ui.extension.board.plus.profiler","tau/components/component.creator","tau/views/view.board.plus","tau/models/board.plus/model.board.plus.list","tau/models/board.plus/model.board.cell.list","tau/ui/extensions/board.plus/ui.extension.board.plus.controller","tau/ui/extensions/board.plus/ui.extension.board.plus.requestIndicator","tau/ui/extensions/board.plus/ui.extension.board.plus.selection.list","tau/models/board.plus/model.board.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop","tau/ui/extensions/board.plus/ui.extension.board.plus.dragndrop.batch","tau/ui/extensions/board.plus/ui.extension.board.plus.layout","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsUpdater","tau/models/board.plus/model.dataUpdater","tau/models/model.board.zoomLevel","tau/ui/extensions/board.zoomLevel/ui.extension.board.zoomLevel.editable","tau/ui/extensions/board.plus/ui.extension.board.plus.cardsViewer.list","tau/ui/extensions/board.plus/ui.extension.board.plus.viewMode","tau/ui/extensions/ui.extension.templateBinder","tau/ui/templates/board.plus/ui.template.boardplus.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.cell.grid.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.card.userStory","tau/ui/templates/board.plus/ui.template.boardplus.request.indicator"],function(_,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){return{create:function(u){var v={ViewType:d,ModelType:e,extensions:[f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,b]},w=c.create(v,u),x=new a(w);return w.fire("profiler.ready",{profiler:x}),w}}}),define("tau/models/customField/model.customField.date.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(a,b,c){var d=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{type:"string",optional:!1,post:function(a){if(this.wasError()==0){var b=c.parse(a);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 01-01-1900"):a=c.format.date.short(b)}return a},additionalProperties:{dateFormat:c.getFormatData().date.short}}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,b.validation=this.schema.validate(c)}});return d}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(_,a,b,c){return a.extend({init:function(a){this._super(a),this.strategy=new b},fetch:function(a,b,c){var d=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&d.push("bug"),this._fetchState(a,d,c)},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.groups",["Underscore","tau/models/dataProviders/model.provider.groups.user_stories","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(_,a,b,c){return a.extend({init:function(a){this._super(a),this.strategy=new b},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a,b,c){var d=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&d.push("bug"),this._fetchIterations(a,d,c)},_fetchIterations:function(a,c,d){var e=this.config.context,f=e.entity.entityType.name,g=e.entity.id,h=this.config.store,i={id:g,nested:!0,fields:[{iterations:["id","name","startDate","endDate"]}]},j="d MMM";h=h.get("release",i),h.done({success:function(a){var c=_(a).pluck("data")[0].iterations,e=[];c=_.sortBy(c,function(a){return-1*b.parse(a.startDate)}),_.forEach(c,function(a){var c=b.parse(a.startDate).clearTime(),d=b.parse(a.endDate).clearTime(),f=!0,h=!1;Date.today().between(c,d)&&(f=!1,h=!0);var i=c.toString(j)+" / "+d.toString(j);i=i+" ("+Math.floor((d.getTime()-c.getTime())/1e3/60/60/24+1)+" days)",h&&(i+=" (current)"),a.releaseId=g,e.push({key:a.id,title:a.name,subtitle:i,collapsed:f,realGroup:a})}),e.unshift({key:null,title:"Backlog",collapsed:!0,realGroup:{id:null,releaseId:g}}),_.forEach(e,function(a){a.items=[]}),d(e)},scope:this})},moveToGroup:function(a,b,c,d){return this._moveToGroupByIteration(a,b,c,d)},_moveToGroupByIteration:function(a,b,c,d){var e=this.config.store,f=b.realGroup;if(!f||a.iteration&&f.id==a.iteration.id){d.call(null);return}var g=[],h={release:{id:f.releaseId}};f.id?h.iteration={id:f.id}:h.iteration=null,g.push(function(b){e.save(a.__type,{id:a.id,$set:h,fields:["id",{iteration:["id"]}]}).done({success:function(){b(null,arguments)}})}),g.push(function(b){e.get(a.__type,{id:a.id,fields:["id",{iteration:["id"]}]}).done({success:function(a){b(null,a[0].data)}})}),_.series(g,function(a,b){_.isFunction(d)&&d.call(null,{changed:b[1]})})}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/models/dataProviders/strategies/model.provider.groups.strategy.states","tau/utils/utils.date"],function(_,a,b,c){return a.extend({init:function(a){this._super(a),this.strategy=new b},fetch:function(a,b,c){var d=["userstory"];return this.config.context.isPracticeAvailable("Bug Tracking")&&d.push("bug"),this._fetchState(a,d,c)},moveToGroup:function(a,b,c,d){var e=this.config.store;return this.strategy.moveToGroup(e,a,b,c,d)},isAvailableForItem:function(a,b,c){return this.strategy.isAvailableForItem(a,b,c)},getCommentRequirements:function(a,b,c){return this.strategy.getCommentRequirements(a,b,c)}})}),define("tau/models/dataProviders/project/project.model.provider.releases.groups",["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a,b,c){return this._fetchReleases(a,b,c)},_fetchReleases:function(a,c,d){var e=this.config.context,f=e.entity.entityType.name,g=e.entity.id,h=this.config.store,i=this,j={id:g,nested:!0,fields:[{releases:["id","name","startDate","endDate"]}]};h.get("project",j).done({success:function(a){var c=_(a).pluck("data")[0].releases;c=_.sortBy(c,function(a){return-1*b.parse(a.startDate)});var e=[];_.forEach(c,function(a){e.push(i._processRelease(a))}),_.forEach(e,function(a){a.items=[]}),d(e)}})},_processRelease:function(a){var c=b.parse(a.startDate).clearTime(),d=b.parse(a.endDate).clearTime(),e=!0,f=!1;Date.today().between(c,d)&&(e=!1,f=!0);var g="d MMM",h=b.formatAs(c,g)+" / "+b.formatAs(d,g);h=h+" ("+Math.floor((d.getTime()-c.getTime())/1e3/60/60/24+1)+" days)",f&&(h+=" (current)");var i={key:a.id,title:a.name,subtitle:h,collapsed:e,realGroup:a};return i}})}),define("tau/models/model.leadCycleTime",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(_,a,b){var c=6e4,d=c*60,e=24*d,f=a.extend({name:"Lead Cycle Time Model",onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id,e={id:d,fields:["leadTime","cycleTime","createDate","startDate","endDate"]};a.store.unbind(a),a.store.on({eventName:"afterSave",type:c,fields:["entityState"],listener:a},function(){a.fire("refresh")}),a.store.get(c,e,{scope:a,success:a.onEntityRetrieved}).done()},getTime:function(a){var b="d",c="min",d="h";return this.getTimeWithAbbreviation(a,b,d,c)},getTimeWithAbbreviation:function(a,b,f,g){a*=e;if(a<d)return(a/c).toFixed(0)+g;if(a<e)return(a/d).toFixed(0)+f;var h=parseInt(a/e);a%=e;var i=(a/d).toFixed(0);return h+b+" "+(i>0?i+f:"")},convertDayToMinutes:function(a){return a*24*60},getLongTime:function(a){return this.getTimeWithAbbreviation(a," days"," hours"," minutes")},onEntityRetrieved:function(a){var c=a.data,d=b.parse(c.startDate),e=b.parse(c.createDate),f=b.parse(c.endDate),g="dd MMM yy",h=f?"End Date":"Today";f=f||new Date;var i=c.leadTime,j={leadTime:this.getTime(i),leadTimeTooltip:this.getLongTime(i),createDate:e.toString(g),endDateLabel:h,endDate:(f||new Date).toString(g)};if(_.isNumber(c.cycleTime)){var k=c.cycleTime;j.cyclePercentage=k/i,j.cycleTime=this.getTime(k),j.cycleTimeTooltip=this.getLongTime(k),j.startDate=d.toString(g),j.startDate==j.createDate&&(j.startDate="")}else j.cycleTime="",j.cyclePercentage=null;this.fire("dataBind",j)}});return f}),define("tau/components/component.leadCycleTime",["Underscore","tau/components/component.creator","tau/models/model.leadCycleTime","tau/components/extensions/leadCycleTime/extension.ui.leadCycleTime","tau/ui/templates/leadCycleTime/ui.template.leadCycleTime"],function(_,a,b,c,d){return{create:function(e){var f={ModelType:b,template:d,extensions:_.union(e.extensions||[],[c])};return a.create(f,e)}}}),define("tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date"],function(_,$,a,b){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=this._$element.find(".tau-historyGrid td.tau-historyItem");_.each(this._data.historyItems,function(c,d){var e=a.eq(d),f=e.find(".tau-date"),g=$("<span/>").addClass("tau-day"),h=$("<span/>").addClass("tau-month");g.text(b.formatAs(c.date,"dd")),h.text(b.formatAs(c.date,"MMM")),f.attr("title",b.format.date.short(c.date)).append(g,h)})}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/utils/utils.storage"],function(_,$,a,b,c){return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render(),this._bindEvents()},_render:function(){var a=$('<div class="tau-legend"></div>'),b=$('<h3><span class="tau-legendToggler">Legend</span></h3>');a.append(b,this._createGroups()),this._setState(a),a.appendTo(this._$element)},_createGroups:function(){var a=$('<div class="tau-groups"></div>');this._createGroupElement("Progress Flow",this._getProgressFlowTypes()).appendTo(a);var b=this._getRelatedEntitiesTypes();return b&&this._createGroupElement("Related Entities",b).appendTo(a),this._createGroupElement("Histograms",this._getHistogramTypes()).appendTo(a),a},_createGroupElement:function(a,b){var c=$("<dl/>"),d=$("<dt/>").text(a);return c.append(d),_.each(b,function(a){var b=$("<dd/>"),d=$(a.element).addClass("glyph");b.text(a.description),b.prepend(d),c.append(b)}),c},_getProgressFlowTypes:function(){var a=this._$element.find(".tau-historyGrid .tau-historyItem .tau-flow"),b={};_.each(a,function(a){var c=$.trim(a.className.replace("tau-flow",""));c in b||(b[c]=$(a).clone().empty().removeAttr("title"))});var c=_.map(b,function(a,b){var c={element:a};switch(b){case"tau-normal":c.description="normal flow";break;case"tau-transitions":c.description="multiple state transitions";break;case"tau-impediment":c.description="impediment";break;case"tau-done":c.description="final state"}return c});return c},_getRelatedEntitiesTypes:function(){var a=null,b=this._$element.find(".tau-historyGrid .tau-historyItem .tau-entity");if(b.size()>0){var c={};_.each(b,function(a){var b=$.trim(a.className.replace(/tau-entity|tau-closed/g,""));b in c||(c[b]=$(a).clone(!0).unbind().removeAttr("title"))});var d=_.map(c,function(a,b){return{element:a,description:a.data("entityInfo").alias}});a=[{element:$('<div class="tau-entity"></div>'),description:"entity (added)"},{element:'<div class="tau-entity tau-closed"></div>',description:"entity (closed)"}].concat(d)}return a},_getHistogramTypes:function(){var a=[];return a.push({element:this._getElementForStateHistogram(),description:"total days in entity state"}),this._timeLoadWasReported()&&a.push({element:this._getElementForTimeLoadHistogram(),description:"daily total spent time"}),a},_getElementForStateHistogram:function(){var a=$(['<div class="tau-historyGridInterpretation">','<div class="stateName tau-dateItems-50">',"<span>State name</span>","</div>","</div>"].join(""));return a},_timeLoadWasReported:function(){return _.any(this._data.historyItems,function(a){return a.spentTime>0})},_getElementForTimeLoadHistogram:function(){var a=new Date(0),c=$(['<div class="tau-date tau-timeLoad-50">','<span class="tau-day">'+b.formatAs(a,"dd")+"</span>",'<span class="tau-month">'+b.formatAs(a,"MMM")+"</span>","</div>"].join(""));return c},_setState:function(a){this._isCollapsed()&&this._collapse(a)},_bindEvents:function(){this._$element.find(".tau-legend .tau-legendToggler").click($.proxy(this,"_toggleState"))},_toggleState:function(a){var b=$(a.currentTarget).parents(".tau-legend");this._isCollapsed()?this._uncollapse(b):this._collapse(b)},_isCollapsed:function(){return c.get("implementationHistoryLegendState")=="collapsed"},_uncollapse:function(a){c.remove("implementationHistoryLegendState"),a.removeClass("tau-collapsed")},_collapse:function(a){c.set("implementationHistoryLegendState","collapsed"),a.addClass("tau-collapsed")}})}),define("tau/models/model.property.date",["tau/models/model.property.simple","tau/utils/utils.date"],function(a,b){return a.extend({onEntityRetrieved:function(a){var c=this.config.format?this.config.format:"date",d=a[0].data;this.property=d[this.propertyName];var e=b.format[c].short(b.convertToTimezone(this.property)),f=b.parse(this.property),g={text:e};this.fire("extendData",{dataToBind:g,entity:d,date:f}),this.fire("dataBind",g)}})}),define("tau/models/model.property.date.validation",["tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(a,b,c){var d=a.extend({category:"edit",name:"Model date validation",schema:b.Schema.create({type:"string",optional:!1,empty:!1,post:function(a){if(this.wasError()==0){var b=c.parse(a),d=c.parse(this.schema.additionalProperties.max),e=c.parse(this.schema.additionalProperties.min);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 1-Jan-1900"):d&&b>d?new this.Error("Date","Date must be less then "+c.format.date.short(d)):e&&b<e?new this.Error("Date","Date must be greater then "+c.format.date.short(d)):a=c.formatAs(b,this.schema.additionalProperties.dateFormat)}return a},additionalProperties:{dateFormat:c.getFormatData().date.short,max:null,min:null}}),"bus afterInit":function(){this.config.format=="datetime"&&(this.schema.additionalProperties.dateFormat=c.getFormatData().datetime.short)},"bus afterRender":function(a){this.element=a.data.element},"bus validateDate":function(a){var b=this.schema.validate(a.data.value);a.data.value=b.instance},"bus validate":function(a){var b=this.element.find(".property");b.dateEditor("resetValidationErrors");var c=a.data,d=c.cmd.$set[this.config.propertyName];if(!c.validation||c.validation.isError()!=1)c.validation=this.schema.validate(d),c.cmd.$set[this.config.propertyName]=c.validation.instance},"bus resetValidationErrors":function(){var a=this.element.find(".property");a.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){var b=a.data.validation;this.element.find(".property").dateEditor("setValue",b.instance)},"bus validationFailed":function(a){var b=this.element.find(".property");b.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}});return d}),define("tau/models/model.property.date.editable",["tau/core/model.editable.base","tau/utils/utils.date"],function(a,b){return a.extend({"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:this.config.editable})},"bus afterValidate":function(a){var c=a.data.cmd.$set[this.config.propertyName];c&&(c=b.parse(c),c=b.format.datetime.short(c),a.data.cmd.$set[this.config.propertyName]=c)}})}),define("tau/models/model.property.date.validation.project",["Underscore","tau/core/model-base","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(_,a,b,c){var d=a.extend({category:"edit",name:"Model date validation","bus afterInit":function(){this.schema=b.Schema.create({type:"string",optional:!0,empty:!0,pre:["trim"],post:function(a){if(this.wasError()==0){var b=c.parse(a),d=c.parse(this.schema.additionalProperties.max),e=c.parse(this.schema.additionalProperties.min);b==null?new this.Error("Date","Incorrect date format"):b<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 1-Jan-1900"):d&&b>d?new this.Error("Date","Start Date should be earlier than End Date"):e&&b<e?new this.Error("Date","End Date should be later than Start Date"):a=c.format.date.short(b)}return a},additionalProperties:{dateFormat:c.getFormatData().date.short,max:null,min:null}});var a=this.config.store,d=this.config.context.entity,e=this.config.bus,f=this,g=function(a){var b=a[0].data;this.config.propertyName=="startDate"&&(this.schema.additionalProperties.max=c.parse(b.endDate)),this.config.propertyName=="endDate"&&(this.schema.additionalProperties.min=c.parse(b.startDate))};a.get("project",{id:d.id,fields:["startDate","endDate"]}).done({success:_.bind(g,this)}),this.config.propertyName=="startDate"?a.on({eventName:"afterSave",type:"project",listener:this,filter:{id:d.id},hasChanges:["endDate"]},function(a){var b=c.parse(a.data.changes.endDate);f.schema.additionalProperties.max=b}):this.config.propertyName=="endDate"&&a.on({eventName:"afterSave",type:"project",listener:this,filter:{id:d.id},hasChanges:["startDate"]},function(a){var b=c.parse(a.data.changes.startDate);f.schema.additionalProperties.min=b})},"bus afterRender":function(a){this.element=a.data.element},"bus validateDate":function(a){var b=this.schema.validate(a.data.value||"");a.data.value=b.instance},"bus validate":function(a){var b=this.element.find(".property");b.dateEditor("resetValidationErrors");var c=a.data,d=c.cmd.$set[this.config.propertyName];if(!c.validation||c.validation.isError()!=1)c.validation=this.schema.validate(d),c.cmd.$set[this.config.propertyName]=c.validation.instance||null},"bus resetValidationErrors":function(){var a=this.element.find(".property");a.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){var b=a.data.validation;this.element.find(".property").dateEditor("setValue",b.instance)},"bus validationFailed":function(a){var b=this.element.find(".property");b.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}});return d}),define("tau/models/model.timeInterval",["Underscore","tau/models/model.leadCycleTime","tau/utils/utils.date"],function(_,a,b){var c=36e5,d=c*24;return a.extend({onInit:function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d=this.config.timeField,e={id:c,fields:[d]};this.store.get(b,e,{scope:this,success:this.onEntityRetrieved}).done()},onEntityRetrieved:function(a){var b=a.data[this.config.timeField];if(b){var b=this.getLongTime(b);this.fire("dataBind",{text:b,point:""})}else this.fire("dataBind",{text:"",point:""})}})}),define("tau/components/component.property.timeInterval",["Underscore","tau/components/component.creator","tau/models/model.timeInterval","tau/ui/templates/property/ui.template.property.time"],function(_,a,b,c){return{create:function(d){d=d||{};var e={ModelType:b,template:c,extensions:_.concat([d.extensions])};return a.create(e,d)}}}),define("tau/models/model.releaseNotes",["Underscore","tau/core/model-base","tau/utils/utils.date"],function(_,a,b){var c=a.extend({onInit:function(){var a=this.config.context.entity,c=this.config.store,d=this;c.unbind(this),c.on({eventName:"afterSave",type:"assignable",listener:this},function(a){var b=["entityState","name"],c=["feature","userstory","bug"];_.include(c,a.data.cmd.type.toLowerCase())&&_.intersect(_.keys(a.data.changes),b).length&&d.bus.fire("refresh")});var e=["feature","userstory","bug"];_.forEach(e,function(a){c.on({eventName:"afterRemove",type:a,listener:d},function(a){d.bus.fire("refresh")})}),c.get("release",{id:a.id,fields:["id","name","startDate","endDate"]}).find("bugs",{fields:["id","name"],$query:{"Release.Id":a.id,"EntityState.isFinal":1},$orderBy:"id"}).find("features",{fields:["id","name",{release:["id"]},{entityState:["id","isFinal"]},{userStories:["id","name",{release:["id"]},{entityState:["id","isFinal"]}]}],$query:{"Release.Id":a.id},$orderBy:"id"}).find("userStories",{fields:["id","name",{release:["id"]},{feature:["id"]},{entityState:["id","isFinal"]}],$query:{"Release.Id":a.id,"EntityState.isFinal":1},$orderBy:"id"}).done({success:function(a){var c=a[2].data,e=[],f=_.pluck(c,"id");_.forEach(c,function(a){var b=[],c=[];_.forEach(a.userStories,function(d){d.release&&d.release.id===a.release.id&&(d.entityState.isFinal==1?b.push(d):c.push(d))}),b.length>0?(a.userStories=b,e.push(a)):a.entityState.isFinal==1&&c.length>0&&c.length==a.userStories.length&&(a.userStories=[],e.push(a))});var g=a[0].data;g.endDate=b.format.date.short(g.endDate);var h=a[1].data,i=a[3].data;i=_.filter(i,function(a){return!a.feature||!a.feature.id||_.indexOf(f,a.feature.id)==-1}),d.bus.fire("dataBind",{item:g,features:e,bugs:h,userStories:i})}})}});return c}),define("tau/components/component.releaseNotes",["tau/components/component.creator","tau/models/model.releaseNotes","tau/ui/templates/releaseNotes/ui.template.releaseNotes"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:c};return a.create(e,d)}}}),define("tau/components/extensions/attachments/component.attachments.uploader",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","tau/utils/utils.date","libs/jquery/jquery.fileupload","libs/jquery/jquery.iframe-transport"],function(_,$,a,b,c,d,e){var f=/<title\b[^>]*>(.*?)<\/title>/;return b.extend({"bus permissionsReady+afterRender":function(a){if(!this._initialized){this._initialized=!0,this.element=a.afterRender.data.element;var b=a.permissionsReady.data;b.editable&&b.deletable&&this._initUploader()}},_initUploader:function(){this._createToolbar(),this._bindUploader()},_createToolbar:function(){var a=$('<div class="uploader-toolbar"></div>'),b=this._createFileBrowser();a.append(b).prependTo(this.element),this._$fileInput=b.find("input"),/\bapple\b/i.test(navigator.vendor)&&this._$fileInput.removeAttr("multiple")},_bindUploader:function(){this._$fileInput.fileupload({url:this._getUploadUrl(),formData:this._getFormData(),add:$.proxy(this,"_onFileAdd")})},_createFileBrowser:function(){return $('<span class="fileBrowser"><i>Attach files</i></span>').append($('<input type="file" multiple/>'))},_getUploadUrl:function(){return a.getApplicationPath()+"/UploadFile.ashx"},_getFormData:function(){return[{name:"generalId",value:this._getGeneralId()}]},_getGeneralId:function(){return this.config.context.entity.id},_getGeneralType:function(){return this.config.context.entity.entityType.name},_onFileAdd:function(a,b){var c=this;if(!b.files||b.files.length==0)return;var d=this._createAttachmentDummy(b.files[0].name);d.appendTo(this._getAttachmentsPlaceholder()),b.submit().success(function(a){var b=c._getResponseText(a);try{var e=c._parseResponse(b)}catch(f){c._onAttachmentUploadFail(d);return}c.bus.fire("attachmentUploaded",{element:c._updateAttachmentElement(d,e),data:e})}).error(function(a,b,e){var g=a.responseText.match(f),h="Looks like application is not available. Please check your connection or server availability";g&&g.length>0&&(h=g[1]),c._onAttachmentUploadFail(d,h)})},_updateAttachmentElement:function(a,b){var c=this._createAttachmentElement(b);return a.replaceWith(c),c},_onAttachmentUploadFail:function(a,b){this._deleteFailedAttachmentElement(a,b)},_getResponseText:function(a){var b="";return typeof a=="string"?b=a:a.jquery&&(b=a.text()),b},_createAttachmentDummy:function(a){var b=this._createAttachmentElement({name:a});return b.addClass("uploading").find(".toolbar").remove(),b},_deleteFailedAttachmentElement:function(a,b){b=b||"Upload failed",this.fire("error",{message:b}),a.addClass("failed");var c=$('<p class="error"></p>').insertAfter(a.find(".name"));c.text("Upload failed"),a.fadeOut(1500,function(){a.remove()})},_getAttachmentsPlaceholder:function(){return this.element.find(".ui-attachments-content")},_createAttachmentElement:function(a){return $.tmpl("attachments-attachment",a)},_parseResponse:function(a){var b;try{b=JSON.parse(a),b=b.items||b,b=b.pop()}catch(d){}var e=c.parse(c.convertToTimezone(b[1])),f={id:b[0],uri:b[4],thumbnailUri:b[5],mimeType:b[3],name:b[2],ownerName:b[6][1]+" "+b[6][2],date:c.format.date.short(e)};return f}})}),define("tau/components/component.attachments",["tau/components/component.creator","tau/models/model.attachments","tau/models/model.attachments.editable","tau/components/extensions/attachments/component.attachments.uploader","tau/components/extensions/attachments/component.attachments.selectable","tau/components/extensions/attachments/component.attachments.showPreview","tau/components/extensions/attachments/component.attachments.thumbProxy","tau/components/extensions/attachments/component.attachments.deletable","tau/components/extensions/error/extension.errorBar","tau/ui/templates/attachments/ui.template.attachments"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(k){var l=k||{},m={extensions:[b,c,d,e,f,g,h,i],template:j};return a.create(m,l)}}}),define("tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator","tau/extensions/extension.javascript"],function(_,$,a,b){return a.extend({"bus afterRender":function(a){var c=this;c.element=a.data.element,c.element.find(".thumbnail-nav").click(c._onAttachmentThumbnailsContainerClick.tauCreateDelegate(c)),c.element.find(".toolbar .prev, .toolbar .next").click($.proxy(c,"_onAttachmentsNavigationClick")),c.element.click($.proxy(c,"_onClose")),b.getKeyBoardManager().pushHandler({handleKeyDown:function(){c._onKeyDown.apply(c,arguments)}})},"bus destroy":function(){this.destroy()},"bus changeSelected":function(a){var b=a.data.attachment;this._changeSelectedAttachment(b)},_getSelectedAttachmentSelector:function(){return".thumbnail-nav > li > img.selected"},_getAttachmentsCount:function(){return this.element.find(".thumbnail-nav > li").length},_getCurrentSelectedAttachment:function(){return this.element.find(this._getSelectedAttachmentSelector()).parent().data().tmplItem.data},_getAttachmentData:function(a){return this.element.find(".thumbnail-nav > li").eq(a).data().tmplItem.data},_getCurrentSelectedAttachmentIndex:function(){return this.element.find(this._getSelectedAttachmentSelector()).parent().index()},_changeSelectedAttachment:function(a){if(this._getCurrentSelectedAttachment().id==a.id)return;var b=this.element;b.find(".thumbnail-nav > li > img.selected").removeClass("selected");var c=b.find(".thumbnail-nav > li > img"),d=this;c.each(function(){if($(this).parent("li").data().tmplItem.data.id==a.id){$(this).addClass("selected");var c=b.find(".ui-attachment-view-image");return d.bus.fire("beforeChangeImage",a.uri)&&(c.attr("src",a.uri),d.bus.fire("afterChangeImage")),!1}})},_onKeyDown:function(a){a.keyCode==$.ui.keyCode.ESCAPE&&this._close()},_close:function(){this.element.remove(),this.bus.fire("closed"),this.fire("destroy")},_next:function(){var a=this._getCurrentSelectedAttachmentIndex()+1;a>=this._getAttachmentsCount()&&(a=0),this._setSelectedAttachmentIndex(a)},_prev:function(){var a=this._getCurrentSelectedAttachmentIndex()-1;a<0&&(a=this._getAttachmentsCount()-1),this._setSelectedAttachmentIndex(a)},_setSelectedAttachmentIndex:function(a){this._changeSelectedAttachment(this._getAttachmentData(a))},_closeButtonClick:function(a){a.stopPropagation(),this._close()},_onAttachmentsNavigationClick:function(a){a.stopPropagation();var b=$(a.target);b.hasClass("prev")?this._prev():b.hasClass("next")&&this._next()},_onAttachmentThumbnailsContainerClick:function(a){a.stopPropagation();var b=$(a.target);if(b.is(".ui-attach-thumbnail")){var c=b.parent("li").data(),d=c.tmplItem.data;this._changeSelectedAttachment(d)}},_onClose:function(a){/^img$/i.test(a.target.tagName)||this._close()},destroy:function(){b.getKeyBoardManager().popHandler(),this.element.find(".ui-attachments-control > .display-table").unbind("click")}})}),define("tau/components/component.attachmentsPreview",["tau/components/component.creator","tau/models/model.attachments","tau/ui/templates/attachmentsPreview/ui.template.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview","tau/ui/extensions/attachmentsPreview/ui.extension.attachmentsPreview.animations"],function(a,b,c,d,e){return{create:function(f){var g=function(a){return(a.mimeType||"").indexOf("image/")==0},h={ModelType:b,template:c,extensions:[d,e]};return f.filter=f.filter||g,a.create(h,f)}}}),define("tau/ui/extensions/auditHistory/ui.audit.history",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(_,$,a,b){return a.extend({getColumns:function(){return[{Id:"RowID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Entity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Modification",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ProjectID",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"InnerEntity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Date",Title:"Date Time",Type:"date",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Description",Title:"Action",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:300,Facet:{}},{Id:"Modifier",Title:"Modified By",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}}]},getDataRequest:function(){var a=this.config.context.entity;return{GridID:null,GroupBy:null,OrderBy:"Date",OrderDir:!1,Start:0,Limit:10,Cnt:{ID:a.id,Type:a.entityType.name}}},"bus extJsHistoryPanel":function(a){var b=a.data.panel;this.config.store.on({type:"general",eventName:"afterSave",filter:{id:this.config.context.entity.id},listener:this},function(a){b.getStore().reload()})},destroy:function(){this.config.store.unbind(this),this._super()},"bus extJsHistoryPanel+destroy":function(a){var b=a.extJsHistoryPanel.data.panel;b.destroy()},"bus initialize":function(){var a=this,d=b.getApplicationPath()+"/PageServices/AuditHistoryListService.asmx/js?d=1";require([d],function(){a.fire("serviceLoaded")})},"bus afterRender+serviceLoaded":function(a){var b=a.afterRender.data.element,c=b[0],d=this;d.config.store.unbind(this),gridPanelType="Ext.grid.GridPanel",configurationFactory="Tp.controls.grid.AuditHistoryConfigurationFactory",editorFieldFactory="Tp.controls.grid.AuditHistoryFieldFactory",gridProxy="Ext.Tp.GridServiceProxy({ webServiceProxy: Tp.Web.Extensions.ExtJs.AuditHistoryListService, webServiceProxyMethod: Tp.Web.Extensions.ExtJs.AuditHistoryListService.GetData })";var e={id:"super_grid",canEdit:!1,canDelete:!1,isOwner:!1,gridHeader:{Title:"History",Columns:d.getColumns()},gridDataRequest:d.getDataRequest(),pluginTypes:"Tp.controls.grid.plugins.HidePagingConstraint",innerGridConfig:[]};Ext.onReady(function(){var a=$('<div class="ext-holder"/>').appendTo("body"),c=Tp.controls.grid.Factory.getInstance();e=c.getConfigurationFactory(e).createConfig(),e.applyTo=a[0];var f=new Ext.grid.GridPanel(e);a.appendTo(b),d.fire("extJsHistoryPanel",{panel:f}),$(".ui-empty-data-msg",b).hide()})}})}),define("tau/components/component.audit.history",["tau/components/component.creator","tau/models/model.label","tau/ui/templates/auditHistory/ui.template.auditHistory","tau/ui/extensions/auditHistory/ui.audit.history"],function(a,b,c,d){return{create:function(e){var f={name:"auditHistory",ModelType:b,template:c,extensions:[d]};return a.create(f,e)}}}),define("tau/models/model.breadcrumbs",["Underscore","tau/core/model-base","tau/core/event","tau/configurator"],function(_,a,b,c){var d=a.extend({"bus afterInit":function(a){c.getRouting().on("stateChanged",function(a){c.getHistory().updateCurrent({url:c.getRouting().getUrl().source})},this)},"bus currentFound":function(a){this._dataHandler(a.data)},"bus currentUpdated":function(a){c.getHistory().updateCurrent(a.data)},_dataHandler:function(a){var b=this;if(a){c.getHistory().setCurrent(a);var d=c.getHistory().stack,e=_.detect(d,function(b){return b.id===a.id});if(e){var f=_.indexOf(d,e);c.getHistory().stack=d.slice(0,f)}}this.bus.fire("stackFound",{})},"bus beforeInit+stackFound":function(){var a=_.clone(c.getHistory().stack);a=a.slice(-3),this.fire("dataBind",{items:a});var b=this},"bus destroy":function(){c.getRouting().removeAllListeners(this)}});return d}),define("tau/models/model.breadcrumbs.entity",["Underscore","tau/core/model-base","tau/configurator","tau/core/termProcessor"],function(_,a,b,c){var d=function(a,b){this.model=a,this.appContext=b;var d=b.processes[0].terms;this.termProcessor=new c(d)};d.prototype={convertToItem:function(a){var c=_.bind(function(a){var b=a,c=this.termProcessor.getTerms(b.__type).name,d=c+" #"+b.id+" "+b.name;return d},this),d=b.getRouting().getUrl().source;return{id:a.id,url:d.length&&d.match(/\//)?d:"#"+a.__type.toLowerCase()+"/"+a.id,title:c(a)}},onGetEntity:function(a){this.entity=a.data},done:function(){this.model.fire("currentFound",this.convertToItem(this.entity))}};var e=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,e=b.entity.id,f=b.applicationContext.processes[0],g=new d(a,b.applicationContext),h=function(b){b.data.changes.hasOwnProperty("name")&&a.store.get(c,{id:e,fields:["id","name"]},{success:function(b){a.bus.fire("currentUpdated",g.convertToItem(b.data))}}).done()};a.store.on({eventName:"afterSave",type:c,listener:this},h),a.store.get(c,{id:e,fields:["id","name"]},{scope:g,success:g.onGetEntity}).done({scope:g,success:g.done})}});return e}),define("tau/components/extensions/breadcrumbs/extension.breadcrumbs.items",["tau/components/extensions/component.extension.base","tau/core/event","tau/store/types","tau/configurator"],function(a,b,c,d){return a.extend({init:function(a){this._super(a);var b=this;this.historyListener||(this.historyListener=function(){b.bus.fire("refresh")},d.getHistory().on("changed",this.historyListener,this))},destroy:function(a){this.historyListener&&d.getHistory().removeListener("changed",this.historyListener,this),this._super()}})}),define("tau/components/component.breadcrumbs",["tau/components/component.creator","tau/models/model.breadcrumbs","tau/models/model.breadcrumbs.entity","tau/components/extensions/breadcrumbs/extension.breadcrumbs.items","tau/ui/templates/breadcrumbs/ui.template.breadcrumbs"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/components/component.collapsible",["Underscore","tau/configurator","tau/core/component-base","tau/views/view.collapsible","tau/components/extensions/component.creator.extension","tau/ui/extensions/collapsible/ui.extension.collapsible","tau/ui/extensions/collapsible/ui.extension.collapsible.state","tau/ui/extensions/layout/ui.extension.layout","tau/ui/templates/container/ui.template.container.list"],function(_,a,b,c,d,e,f,g,h){return{create:function(i){i=i||{},_.defaults(i,{store:a.getStore(),template:h,cssClass:"ui-collapsible",layout:"list",collapsed:!0});var j=new b(i);return _.isArray(i.extensions)&&_.each(i.extensions,function(a){j.attach(a)}),j.attach(d).attach(e).attach(g).attach(f).attach(c).bus}}}),define("tau/components/component.duplicateBugListPanel",["Underscore","tau/components/component.collapsible","tau/components/extensions/duplicateBugList/extension.duplicateBugList.visibilityController","tau/models/model.duplicateBugCountCalculator","tau/models/model.duplicateBugRetriever","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/ui/extensions/ui.extensions.onMarkAsDuplicate","tau/core/termProcessor"],function(_,a,b,c,d,e,f,g,h){return{create:function(e){var i=new h(e.context.getTerms());return e=e||{},_.extend(e,{collapsed:!0,header:[{type:"label",text:"Duplicates "+i.getTerms("Bug").names,quantityCssClass:e.quantityCssClass||"ui-gray-quantity"}],items:[{type:"duplicateBugList"}],extensions:[b,c,d,f,g]}),a.create(e)}}}),define("tau/components/component.impedimentListPanel",["Underscore","tau/components/component.collapsible","tau/components/extensions/impedimentList/extension.impedimentList.visibilityController","tau/components/extensions/impedimentList/extension.impedimentList.count.label.setter","tau/models/model.impedimentsCountCalculator","tau/models/model.extensions","tau/models/assignmentsList/extension.model.store.operations","tau/core/termProcessor"],function(_,a,b,c,d,e,f,g){return{create:function(c){var e=new g(c.context.getTerms());return c=c||{},_.extend(c,{collapsed:!0,header:[{type:"label",text:e.getTerms("Impediment").names,quantityCssClass:c.quantityCssClass||"ui-red-quantity"}],items:[{type:"impedimentList"}],extensions:[b,d,f]}),a.create(c)}}}),define("tau/ui/behaviour/common/ui.behaviour.richeditor",["Underscore","jQuery","tau/configurator"],function(_,$,a){function b(a){var b=a.editor,c=b.dataProcessor,d=c&&c.htmlFilter;dataFilter=c&&c.dataFilter;var e=["head","base","basefont","meta","link","title","style","script","input","isindex","textarea","button","option","select","frameset","frame","iframe","object","embed","applet","bgsound","marque","blink"],f={elements:{$:function(a){return _.indexOf(e,a.name)>0?!1:(a.attributes["class"]&&delete a.attributes["class"],a.attributes.id&&delete a.attributes.id,a.attributes.role&&delete a.attributes.role,a)},a:function(a){return _.trim(a.attributes.href).match(/^javascript:/gi)&&(delete a.attributes.href,delete a.attributes["data-cke-saved-href"]),a},style:function(a){return!1},script:function(a){return!1}},attributeNames:[[/^on/,"no"]]};d.addRules(f),dataFilter.addRules(f)}$.widget("ui.richeditor",{staticExecutionGroups:{},$target:null,$editor:null,$input:null,ckeInstance:null,ckeConfig:{enterMode:3,language:"en",toolbar:[],toolbarStartupExpanded:!1,disableNativeSpellChecker:!1,scayt_autoStartup:!1,removePlugins:"elementspath",resize_enabled:!1,height:150,width:"auto",skin:"v3",resize_dir:"vertical",startupFocus:!0,autoGrow_maxHeight:8e3,extraPlugins:"autogrow",contentsCss:require.toUrl("../css.ext/tau.clientinput.ckeditor.css"),on:{instanceReady:b}},options:{validation:{},executionGroupName:null,hideTarget:!0,scrollToButtonBar:!1,placeholder:{className:null,text:null},settings:{},saveAction:{checkChanges:!0,disableIfEmpty:!1,available:!0,text:"Save"},cancelAction:{available:!0,text:"Cancel"},onSave:function(a){},onCancel:function(){}},_create:function(){this.init()},getTemplate:function(){var a=['<div class="ui-richeditor">','   <textarea class="ui-richeditor__area" style="height:'+this.options.settings.height+'px;"></textarea>','   <div class="ui-richeditor__controls button-group">'],b=this.options.saveAction;b.available&&(a=a.concat(['<button class="ui-richeditor__controls__save button" type="button">',b.text,"</button>"]));var c=this.options.cancelAction;return c.available&&(a=a.concat(['<button class="ui-richeditor__controls__cancel button" type="button">',c.text,"</button>"])),a=a.concat(["   </div>","</div>"]),a.join("")},setText:function(a){this.$target.html(a)},setValidationErrors:function(a){this.element.addClass("ui-validationerror"),_.isString(a)&&this.element.attr("title",a)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title")},setValue:function(a){this.setText(a)},init:function(){this.$target=$(this.element),this.$target.addClass("editable");var a={};$.extend(!0,a,this.ckeConfig,this.options.settings),a.autoGrow_minHeight=Math.max(this.$target.height(),a.height),this.options.settings=a,this.bindEventsTarget(this.$target),this._applyPlaceholder(this.$target,this.options.placeholder)},_applyPlaceholder:function(a,b){b.className&&$.trim(a.html())===""&&(a.addClass(b.className),a.text(b.text))},_removePlaceholder:function(a,b){b.className&&a.hasClass(b.className)&&(a.removeClass(b.className),a.text(""))},bindEventsTarget:function(a){var b=function(a,b){return function(a,b){var c=null,d=null;a.bind("mousedown",function(a){a.which!=3&&(c=a.pageX,d=a.pageY)}),a.bind("mouseup",function(a){if(a.which!=3){var e=5;c>a.pageX-e&&c<a.pageX+e&&d>a.pageY-e&&d<a.pageY+e&&b.call(this,a),c=null,d=null}})}.call(this,a,b)},c=$.proxy(this.showEditor,this),d=function(a,b){a.bind("dblclick",b)},e=function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var a=window.getSelection();a.removeAllRanges()}};d(a,function(a){e();if(a.target.tagName.toLowerCase()=="a")return;c()})},_dataChangeEventHandler:function(a){var b=this;if(!b._visible)return;var c=b.$editor.find(".ui-richeditor__controls__save");window.setTimeout(function(){var b=a.sender.getData(),d=b.length>0;c.attr("disabled",d?!1:"disabled"),d?c.removeClass("disable"):c.addClass("disable")},150)},__displayEditor:function(){var a=this;a.options.hideTarget&&a.$target.hide(),a.$editor.show();if(a.options.scrollToButtonBar){var b=a.element.parent().find(".ui-richeditor__controls"),c=$(".ui-popup-content.tau-container");c.size()==0&&(c=$(window)),c.scrollTop(b.offset().top)}},getSettings:function(){return this.options.settings},setSettings:function(a){this.options.settings=a},_applyEditor:function(){var a=this;a.$input.parents("body").length?this.ckeInstance?(a.__displayEditor(),this.ckeInstance.setMode("wysiwyg"),this.ckeInstance.setData(this.$input.val())):(a._trigger("beforeapply",this.options.settings),this.initCKEditor(this.$input,this.options.settings,function(b,c){a.__displayEditor(),a.ckeInstance=c;var d=a.options.saveAction;if(d.available&&d.disableIfEmpty){var e=["contentDom","afterCommandExec","key","insertElement","taukeypress"],f=$.proxy(a._dataChangeEventHandler,a);for(var g=0,h=e.length;g<h;g++)c.on(e[g],f)}})):(a.$editor.show(),window.setTimeout(function(){a._applyEditor()},0))},showEditor:function(){if(!this._visible){this._visible=!0,this._removePlaceholder(this.$target,this.options.placeholder),this._initText||(this._initText=this.options.hasOwnProperty("text")?this.options.text:this.$target.html()),this.$editor?this.$editor.hide():(this.$editor=this.createEditor(),this.$editor.hide(),this.$editor.insertAfter(this.$target));var a=this.options.executionGroupName;return a&&(this.staticExecutionGroups[a]&&this.staticExecutionGroups[a]._innerCancel(),this.staticExecutionGroups[a]=this),this.$input.val(this._initText),this._applyEditor(),this.$editor}},hideEditor:function(){var a=this.$target,b=this.$input,c=this.$editor;b.blur(),c.hide(),this.options.hideTarget&&a.show();var d=this;d._applyPlaceholder(d.$target,d.options.placeholder),this._visible=!1},initCKEditor:function(b,c,d){var e=a.getCkPath(),f=this;require(["Underscore","order!"+e+"ckeditor.js",,"order!"+e+"ckfinder/ckfinder.js",,"order!"+e+"../Javascript/EditView/ckeditor.plugins.js"],function(_){CKEDITOR.tools.indexOf=_.indexOf,CKEDITOR.editor.prototype.resize=function(a,b,c,d){var e=this.container,f=CKEDITOR.document.getById("cke_contents_"+this.name),g=d?e.getChild(1):e;g.setSize("width",a,!0),!CKEDITOR.env.webkit;var h=c?0:(g.$.offsetHeight||0)-(f.$.clientHeight||0);f.setStyle("height",Math.max(b-h,0)+"px"),this.fire("resize")},CKEDITOR.replace(b.attr("id"),c);var a=CKEDITOR.instances[b.attr("id")];CKFinder.SetupCKEditor(a,e+"ckfinder/");var g=function(){f.$editor.find(".ui-richeditor__controls__save").attr("disabled","disabled").addClass("disable")},h=function(){f.$editor.find(".ui-richeditor__controls__save").removeAttr("disabled").removeClass("disable")};a.on("charcount_limit_reached",g),a.on("charcount_limit_restored",h),d(b,a)})},createEditor:function(){var a=$(this.getTemplate()),b=this.$input=a.find("textarea");return b.attr("id",_.uniqueId("ui-richeditor__area")),this.bindEventsEditor(a),a},bindEventsEditor:function(a){var b=this.options,c=a.find(".ui-richeditor__controls__save"),d=a.find(".ui-richeditor__controls__cancel");b.saveAction.available&&c.click($.proxy(this._save,this)),b.cancelAction.available&&d.click($.proxy(this._cancel,this))},_isChangedText:function(a){return a!=this._initText},_allowSave:function(a){var b=!0,c=this.options.saveAction.checkChanges;return c&&!this._isChangedText(a)&&(b=!1),b},_save:function(a){a.preventDefault();var b=this.$input;this.ckeInstance&&this.ckeInstance.updateElement();var c=b.val();this._allowSave(c)?(this._initText=c,this.setText(c),this.options.onSave(c)):this._innerCancel(),this.hideEditor()},_cancel:function(a){a.preventDefault(),this._innerCancel()},_innerCancel:function(){this.hideEditor(),this.options.onCancel()},destroy:function(){var a=this.options.executionGroupName;a&&this.staticExecutionGroups[a]===this&&(this.staticExecutionGroups[a]=null),this.ckeInstance&&(this.ckeInstance.focusManager.forceBlur(),this.ckeInstance.destroy()),this.$editor&&this.$editor.remove()}})}),define("tau/ui/extensions/comments/ui.extension.comment.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,a,b){var c=b.extend({category:"edit",destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var a=this;a.componentList&&(a.componentList.destroy(),delete a.componentList)},"bus applyTo+permissionsReady":function(a){var b=a.applyTo.data,c=a.permissionsReady.data;this.applyPermissions(b.config,b.data,b.element,c)},applyPermissions:function(a,b,c,d){var e=this,f=this.config=_.extend({},a,{comment:b}),g=this.element=c,h=$('<li class="ui-comment-menu button-group"></li>'),i=g.children(".ui-comment-body");if(d.editable){i.addClass("editable");var j=$.proxy(e.onReply,e);h.append($('<a class="reply button small"><span class="icon"></span>reply</a>').click(j));var k=$.proxy(e.onEdit,e);h.append($('<a class="edit button small"><span class="icon"></span>edit</a>').click(k)),$(['<div class="ui-comment-reply">','   <div class="ui-editor-placeholder" style="display: none;"></div>',"</div>"].join("")).insertAfter(i.find(".ui-comment-text"))}if(d.deletable){var l=$.proxy(e.onDelete,e);h.append($('<a class="delete button danger small"><span class="icon"></span>delete</a>').click(l)),i.addClass("deletable")}i.find(".ui-comment-heading").append(h);var m=g.children(".ui-comments"),n={components:[{type:"commentList"}],context:f.context};this.componentList||this.createComponents(n,function(a){var c=a[0],d={element:m,data:{comments:b.comments||[]},config:_.extend({},c.config,{commentId:e.config.comment.id})};e.componentList=c.component,c.component.fire("applyTo",d)})},showEditorForEdit:function(){var a=this,b=this.element.find("> .ui-comment-body > .ui-comment-text"),c=this.element.tmplItem().data;this.showEditor({element:b,text:c.description,checkChanges:!1,saveHandler:function(b){a.fire("saveComment",{description:b})}})},showEditorForReply:function(){var a=this,b=this.element.find("> .ui-comment-body > .ui-comment-reply > .ui-editor-placeholder"),c=this.element.tmplItem().data;a.showEditor({element:b,text:"",hideTarget:!1,saveText:"Add Reply",saveHandler:function(b){a.fire("replyToComment",{description:b,parentId:c.id})}})},showEditor:function(a){var b=this,c=function(){b.fire("editorSave"),a.saveHandler.apply(this,arguments)},d=a.element,e=d.richeditor({text:a.text,hideTarget:a.hideTarget!==!1,executionGroupName:"comments",onSave:c,validation:{trim:!0},settings:{toolbar:[["Bold","Italic","Strike"],["NumberedList","BulletedList"],["Link","Unlink"],["Image"],["Source"]],startupFocus:!0,extraPlugins:""},saveAction:{text:a.saveText||"Save",disableIfEmpty:!0,checkChanges:a.checkChanges},cancelAction:{available:!0}}),f=e.richeditor("showEditor");this.fire("editorCreated",{editorElement:f})},onReply:function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.showEditorForReply()},onEdit:function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.showEditorForEdit()},onDelete:function(a){var b=this,c=b.element.find("> .ui-comment-body");c.confirmation({message:"Delete comment?",ok:$.proxy(b.onConfirmDelete,b),cancel:$.proxy(b.onCancelDelete,b)}),c.confirmation("show")},onCancelDelete:function(a){a.stopPropagation(),a.preventDefault(),this.element.find("> .ui-comment-body").confirmation("hide")},onConfirmDelete:function(a){a.stopPropagation(),a.preventDefault(),this.fire("deleteComment")}});return c}),define("tau/ui/extensions/comments/ui.extension.comments.new.editor",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,a){var b=a.extend({category:"edit",destroy:function(){this.$ckEditor.richeditor("destroy"),this._super()},"bus afterRender":function(a){this.element=a.data.element,this.initializeEditor()},onSave:function(a){var b=this;b.fire("editorSave"),b.fire("saveComment",{description:a}),b.closeEditor()},onCancel:function(a){this.closeEditor()},closeEditor:function(){this.fire("destroy")},initializeEditor:function(){var a=this;this.$editorPlaceHolder=this.element.find(".ui-comment-text"),this.$ckEditor=this.$editorPlaceHolder.richeditor({executionGroupName:"comments",onSave:$.proxy(a.onSave,a),onCancel:$.proxy(a.onCancel,a),validation:{trim:!0},scrollToButtonBar:!0,settings:{toolbar:[["Bold","Italic","Strike"],["NumberedList","BulletedList"],["Link","Unlink"],["Image"],["Source"]],startupFocus:!0,extraPlugins:""},saveAction:{text:"Add comment",disableIfEmpty:!0},cancelAction:{available:!0}});var b=this.$ckEditor.richeditor("showEditor");this.fire("editorCreated",{editorElement:b})}});return b}),define("tau/ui/extensions/comments/ui.extension.comments.add",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,a){var b=a.extend({category:"edit",destroy:function(){var a=this;a.destroyDynamicComponents(),a._super()},lifeCycleCleanUp:function(){var a=this;a.destroyDynamicComponents(),a._super()},destroyDynamicComponents:function(){var a=this;a.commentNewEditorComponent&&(a.commentNewEditorComponent.destroy(),delete a.commentNewEditorComponent)},"bus initialize":function(a){this.config=a.data},"bus afterRender+permissionsReady+dataBind":function(a){this.element=a.afterRender.data.element;var b=a.permissionsReady.data;this.data=a.dataBind.data,this.initializeAddCommentLink()},initializeAddCommentLink:function(){this.$addLink=$("<span class='ui-comments-add-link'>Add Comment</span>").click($.proxy(this.addNewComment,this)).insertAfter(this.element.find(".ui-all-comments"))},onCloseEditor:function(a){this.$addLink.show()},addNewComment:function(){var a=this;a.$addLink.hide();var b={components:[{type:"comment.new.editor"}],context:a.config.context};a.createComponents(b,function(b){var c=a.commentNewEditorComponent=b[0].component;c.on("afterRender",function(b){var c=b.data.element;c.insertAfter(a.$addLink)}),c.on("destroy",$.proxy(a.onCloseEditor,a)),c.initialize()})}});return b}),define("tau/components/extensions/customField/extension.customField.richtext.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,a){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var b=this,c=a.afterRender.data.data,d=a.permissionsReady.data;if(d.editable){var e=a.afterRender.data.element,f=e.find(".ui-customfield__value");b.$widget=f,f.richeditor({text:e.tmplItem().data.value,placeholder:{text:"Double-click to add content...",className:"ui-description__inner_empty_true"},settings:{fitImgWidth:!1,toolbar:[["Cut","Copy","Paste","PasteText","PasteFromWord","-","Bold","Italic","Underline","Strike","-","Subscript","Superscript"],["NumberedList","BulletedList","-","Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"],["Link","Unlink","Anchor"],["Image","Table","HorizontalRule","SpecialChar"],"/",["Source","Format","Font","FontSize"],["Replace","-","RemoveFormat","TextColor","BGColor","-","Templates"],["Maximize"]],extraPlugins:"autogrow,charcount",charcount_limit:4e3},onSave:function(a){b.bus.fire("save",{customFields:[{name:c.name,type:c.type,value:a}]})}})}},"bus validate":function(){this.$widget.richeditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.richeditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.richeditor("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/components/extensions/field/extension.field.richText.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,a){return a.extend({category:"edit","bus prepareChanges":function(a){this.bus.fire("markElementToBeUpdated",{element:this.element})},"bus applyChanges":function(a){var b=this;this.bus.on("afterRender",function(a){a.removeListener(),b.bus.fire("updateElement",{element:b.element})}),this.bus.fire("refresh")},"bus changeText":function(a){var b=this,c={};c[b.config.fieldName]=a.data,b.bus.fire("save",c)},"bus permissionsReady+afterRender":function(a){var b=this;this.element=a.afterRender.data.element;var c=a.permissionsReady.data;if(c.editable){var d=this.element.width(),e=a.afterRender.data.element.find(".ui-description__inner").richeditor({text:this.element.tmplItem().data.html,placeholder:{text:"Double-click to add description...",className:"ui-description__inner_empty_true"},onSave:function(a){b.fire("changeText",a),e.addClass("data-saving")},settings:{fitImgWidth:!1,toolbar:[["Cut","Copy","Paste","PasteText","PasteFromWord","-","Bold","Italic","Underline","Strike","-","Subscript","Superscript"],["NumberedList","BulletedList","-","Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"],["Link","Unlink","Anchor"],["Image","Table","HorizontalRule","SpecialChar"],["Source","Format","Font","FontSize"],["Replace","-","RemoveFormat","TextColor","BGColor","-","Templates"],["Maximize"]],height:450}});e.bind("richeditorbeforeapply",function(a,c){var d=[],e=0,f=b.element.width(),g=$(a.target).richeditor("getSettings");_.each(g.toolbar,function(a){var b=a.length*28+20;e+b>f&&(e=0,d.push("/")),d.push(a),e+=b}),g.toolbar=d,$(a.target).richeditor("setSettings",g)})}}})}),define("tau/utils/utils.htmlConverter",["tau/configurator","Underscore"],function(a,_){return{fromSourceToHtml:function(b){var c=a.getApplicationPath()+"/",d=b||"",e=/(?:<img(?=\s)(?:[^>"']|"[^"]*"|'[^']*')*?\s)src\s*=\s*("~\/([^"]*)"|'~\/([^']*)')(?:[^>]*>)/gi;d=d.replace(e,function(a,b,d,e){var f=d||e,g=b[0];return a.replace(b,function(){return g+c+f+g})});var f=/<[^<]+?>/g,g=[],h;while((h=f.exec(d))!=null)g.push({left:h.index,right:h.index+h[0].length});return d.replace(/\w[\xa0]+\w/g,function(a,b){return _.find(g,function(a){return a.left<=b&&a.right>=b})?a:a.replace(/[\xa0]/g," ")})},fromHtmlToSource:function(b){var c=a.getApplicationPath(),d=b||"",e='(?:<img(?=\\s)(?:[^>"\']|"[^"]*"|\'[^\']*\')*?\\s)src\\s*=\\s*("'+c+'/([^"]*)"|\''+c+"/([^']*)')(?:[^>]*>)",f=new RegExp(e,"gi");return d=d.replace(f,function(a,b,c,d){var e=c||d,f=b[0];return a.replace(b,function(){return f+"~/"+e+f})}),d}}}),define("tau/models/dataprocessor/model.processor.comment",["tau/configurator","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(a,b,c){function d(a){this.context=a}return d.prototype={destroy:function(){this.context=null},convertDTO:function(d){var e=this,f={id:d.id,parentId:d.parentId,avatar:[a.getApplicationPath(),"/Avatar.ashx?UserId=",d.owner.id,"&size=32"].join(""),name:e.getName(d.owner),description:b.fromSourceToHtml(d.description),age:this.getAge(d.createDate),createDate:c.format.datetime.short(c.convertToTimezone(d.createDate)),comments:[],deleted:"DELETED"===d.description,isRequester:d.owner.kind&&d.owner.kind.toString().toLowerCase()==="requester"};return this.context.getLoggedUser().id==d.owner.id&&(f.isOwnerComment=!0),f},getName:function(a){var b=a.firstName||"",c=a.lastName||"",d="";if(b.length>0||c.length>0)d=[b," ",c.trim().substring(0,1),"."].join("");return d},getAge:function(a){if(!a)return"Draft";var b=c.getAge(c.parse(a));return b.isZero?"Just added":b.toString()}},d}),define("tau/models/model.comment.editable",["Underscore","tau/core/model.editable.base","tau/configurator","tau/models/dataprocessor/model.processor.comment"],function(_,a,b,c){var d=a.extend({name:"Editable Comments","bus applyTo":function(a){var b=this.bindedData=a.data.data;this.authorizate(b)},authorizate:function(a){var b=this.bindedData.deleted,c={editable:!b,deletable:!0};this.fire("permissionsReady",c)},_convertDTO:function(a){var b=this.config,d=b.parentCommentId,e=new c(b.context),f=e.convertDTO(_.extend({},a));return f.parentId=d,f},"bus afterInit":function(a){var b=this;this.config=a.data.config;var c={id:null,description:"",owner:b.config.context.getLoggedUser()},d=b._convertDTO(c);b.bindedData=d,b.fire("dataBind",d)},_fireUpdate:function(a,b){var c=this;b.general={id:c.config.context.entity.id},c.fire("save",{id:a,typeName:"comment",$set:b,$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind"]}]})},"bus saveComment":function(a){var b=this,c=a.data,d=this.bindedData.id;b._fireUpdate(d,c)},"bus replyToComment":function(a){var b=this,c=a.data;b._fireUpdate(null,c)},"bus deleteComment":function(){var a=this.bindedData,b=a.id;a.comments&&a.comments.length>0?this._fireUpdate(b,{description:"DELETED"}):this.fire("remove",{id:b,typeName:"comment"})}});return d}),define("tau/models/model.comments",["Underscore","tau/core/model-base","tau/models/dataprocessor/model.processor.comment","tau/utils/utils.date","tau/store/types.targetprocess"],function(_,a,b,c){function d(a,b){this.model=a,this.converter=b}d.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(a){this.assignable=this.model.assignable=a.data;var b=a.data.comments,d=_(b).sortBy(function(a){return+c.parse(a.createDate)}),e=this.convertDTO(d).convertToTree(null);this.model.bus.fire("dataBind",{items:e})},convertDTO:function(a){var b=this;return this.convertedComments=_(a).map(function(a){return b.converter.convertDTO(a)}),this},convertToTree:function(a){var b=[],c=this.convertedComments;for(var d=0,e=c.length;d<e;d++){var f=c[d];f.parentId==a&&(b.push(f),f.comments=this.convertToTree(f.id))}return b}};var e=a.extend({name:"Comments",onInit:function(){var a=this.config.context.entity;this.converter=new b(this.config.context);var c=new d(this,this.converter);this.store.get(a.entityType.name,{id:a.id,fields:["id",{comments:["id","description","createDate","parentId",{owner:["id","firstName","lastName","kind"]}],list:!0}]},c.getAssignableRetrievedCallback()).done()},"bus createDTO":function(a){var b=a.data,c=this.converter.convertDTO(b);c.comments=[],this.fire("DTOCreated",c)},destroy:function(){this.converter.destroy(),this.converter=null,this._super()}});return e}),define("tau/models/customField/model.customField.richtext.editable",["tau/models/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.htmlConverter"],function(a,b,c){var d=a.extend({category:"edit",name:"Editable custom field",schema:b.Schema.create({type:"object",properties:{value:{optional:!0,empty:!0,maxLength:4e3,type:"string",pre:["trim"]}}}),"bus validate":function(a){var b=a.data,c=b.cmd.$set.customFields[0];b.validation=this.schema.validate(c)},"bus beforeSave":function(a){var b=a.data.cmd.$set,d=b.customFields[0];d.value=c.fromHtmlToSource(d.value)}});return d}),define("tau/models/model.field.richText",["tau/core/model-base","tau/utils/utils.htmlConverter"],function(a,b){var c=a.extend({name:"field ",init:function(a){this._super.apply(this,arguments),this.fieldName=a.fieldName;if(!a.fieldName)throw"model.field.richText fieldName is undefined"},onInit:function(){var a=this.config.context,b=a.entity.entityType.name,c=a.entity.id,d=this,e=function(a){if(a.data.id!=c)return;var b=a.data.changes;if(!b.hasOwnProperty(d.fieldName))return;d.fire("applyChanges",b)},f=function(a){if(a.data.id!=c)return;var b=a.data.changes;if(!b.hasOwnProperty(d.fieldName))return;d.fire("prepareChanges",b)};this.store.on({eventName:"beforeSave",type:b,listener:this},f).on({eventName:"afterSave",type:b,listener:this},e);var g={id:c,fields:["id",d.fieldName]};this.store.get(b,g,{scope:this,success:this.entityRetrieved}).done({success:this.requestDone,scope:this})},entityRetrieved:function(a){var b=a.data;this.id=b.id,this.fieldValue=b[this.fieldName]},requestDone:function(){this.bus.fire("dataBind",{html:b.fromSourceToHtml(this.fieldValue)})}});return c}),define("tau/models/model.field.richText.editable",["tau/core/model.editable.base","tau/utils/utils.htmlConverter","tau/utils/utils.jsonSchema"],function(a,b,c){var d=a.extend({category:"edit",name:"model.field.richText.editable",schema:null,init:function(a){this._super.apply(this,arguments);var b={type:"object",properties:{}};this.fieldName=a.fieldName,b.properties[this.fieldName]={optional:!0,empty:!0,type:"string"},this.schema=c.Schema.create(b)},"bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(a){var c=a.data.cmd.$set;c[this.fieldName]=b.fromHtmlToSource(c[this.fieldName])},"bus validate":function(a){var b=a.data,c=b.cmd.$set;b.validation=this.schema.validate(c)}});return d}),define("tau/ui/extensions/comments/ui.extension.comment.practices.notification",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){var c=b.extend({category:"edit",beforeSaveComment:function(a){var b=this.placeHolder.find('input[type="checkbox"]'),c={};b.each(function(a,b){var d=$(b);d.attr("checked")&&(c[d.val()]=!0)}),a.cmd["comment-practices-notification-opts"]=c},"bus editorSave":function(){if(!this.globalSettings.IsEmailNotificationsEnabled)return;var a=this;a.config.store.on({eventName:"beforeSave",type:"comment",listener:a},function(b){var c=b.data;a.beforeSaveComment(c)})},"bus editorCreated":function(a){this.globalSettings=this.config.context.applicationContext.globalSettings||{};if(!this.globalSettings.IsEmailNotificationsEnabled)return;var b=a.data.editorElement;this.placeHolder=b.find(".tau-notification-practices-settings");if(!this.placeHolder.length){var c=this.placeHolder=$('<div class="tau-notification-practices-settings"><span class="prompt">Notify by email: </span></div>');c.append("<input type='checkbox' id='owner' value='Owner' /><label for='owner'>Owner</label>"),c.append("<input type='checkbox' id='people' value='Assigned' /><label for='people'>Assigned people</label>"),this.config.context.general.entityType.name.toLowerCase()==="request"?c.append("<input type='checkbox' id='requestor' value='Requesters' /><label for='requestor'>Requester(s)</label>"):c.append("<input type='checkbox' id='team' value='Team' /><label for='team'>Project Team</label>"),c.insertBefore(b.find(".ui-richeditor__controls"))}},"bus destroy":function(){this.config.store.unbind(this),this._super.apply(this,arguments)}});return c}),define("tau/components/component.comment",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/comments/ui.extension.comment.editable","tau/models/model.comment.editable","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/ui/templates/comments/ui.template.comments.comment"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[d,c,e,b],template:f};return a.create(h,g)}}}),define("tau/components/component.comment.new.editor",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.comment.editable","tau/ui/extensions/comments/ui.extension.comments.new.editor","tau/ui/extensions/comments/ui.extension.comment.practices.notification","tau/ui/templates/comments/ui.template.comments.comment.new.editor"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[c,d,e,b],template:f};return a.create(h,g)}}}),define("tau/ui/extensions/comments/ui.extension.commentList.editable",["tau/configurator","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.comment"],function(a,b,c){var d=b.extend({destroy:function(){this.destroyDynamicComponents(),this._super()},lifeCycleCleanUp:function(){this.destroyDynamicComponents(),this._super()},destroyDynamicComponents:function(){var a=this;if(a.dynamicComponents&&a.dynamicComponents.length){var b=null;while(b=a.dynamicComponents.pop())b.destroy()}},"bus applyTo":function(a){var b=this;b.dynamicComponents=[];var c=a.data,d=c.data.comments;this.element=c.element;var e=c.element.children(".ui-comment");this.config=c.config;var f=c.config.context,g={components:[],context:f};e.each(function(a){g.components.push({type:"comment"})}),b.createComponents(g,function(a){for(var c=0,f=a.length;c<f;c++){var g=a[c],h={element:e.eq(c),data:d[c],config:g.config};g.component.fire("applyTo",h),b.dynamicComponents.push(g.component)}})}});return d}),define("tau/components/component.commentList",["tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/ui/extensions/comments/ui.extension.commentList.editable"],function(a,b,c){return{create:function(){var d={extensions:[b,c]};return a.create(d,{name:"comment.commentList"})}}}),define("tau/ui/extensions/comments/ui.extension.comments.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base","tau/ui/templates/comments/ui.template.comments.comment"],function(_,$,a,b,c){var d=b.extend({category:"edit",destroy:function(){var a=this;a.destroyDynamicComponents(),a._super()},destroyDynamicComponents:function(){var a=this;a.commentListComponent&&(a.commentListComponent.destroy(),delete a.commentListComponent)},"bus dataBind+afterRender":function(a){var b=this;b.destroyDynamicComponents();var c={comments:a.dataBind.data.items},d=this.element=a.afterRender.data.element,e=".ui-all-comments",f=d.find(e),g={components:{type:"commentList"},context:this.config.context};b.createComponents(g,function(a){b.commentListComponent=a[0].component;var d={element:f,data:c,config:g};b.commentListComponent.fire("applyTo",d)})},getGUIDSelector:function(a){return"guid-comment-"+a},getCommentIdClass:function(a){return"comment-id-"+a},"bus prepareUpdate":function(a){var b=a.data.cmd,c=null,d=b.config.$set.parentId,e=".ui-all-comments"+(d?" ."+this.getCommentIdClass(d)+" .ui-comments":""),f=this.getGUIDSelector(b.guid);if(!b.config.id)c=$("<div class='ui-comment "+f+"'><div class='ui-comment-body'>Adding new comment. Please wait...</div></div>").appendTo(this.element.find(e));else{var g=this.getCommentIdClass(b.config.id);c=this.element.find(".ui-all-comments ."+g)}this.fire("markElementToBeUpdated",{element:c})},"bus applyUpdate":function(a){var b=this,c=a.data.cmd,d=c.guid,e=this.getCommentIdClass(a.data.id);if(!c.config.id){var f=this.getGUIDSelector(d),g=this.element.find(".ui-all-comments").find("."+f);g.addClass(e).removeClass(f)}this.on("afterRender",function(a){a.removeListener();var c=a.data.element,d=c.find("."+e+" > .ui-comment-body");b.fire("updateElement",{element:d})}),this.fire("refresh")},"bus prepareRemove":function(a){var b=a.data.cmd,c=this.getCommentIdClass(b.config.id),d=this.element.find(".ui-all-comments ."+c);this.fire("markElementToBeDeleted",{element:d})},"bus applyRemove":function(a){var b=this,c=a.data.cmd,d=this.getCommentIdClass(c.config.id),e=this.element.find(".ui-all-comments ."+d);this.fire("deleteElement",{element:e,callback:function(){b.fire("refresh")}})}});return d}),define("tau/components/component.comments",["Underscore","tau/components/component.list.creator","tau/components/extensions/component.creator.extension","tau/models/model.comments","tau/models/model.comments.editable","tau/ui/extensions/ui.extension.shortcutProcessor","tau/ui/extensions/comments/ui.extension.comments.editable","tau/ui/extensions/comments/ui.extension.comments.add","tau/ui/templates/comments/ui.template.comments"],function(_,a,b,c,d,e,f,g,h){return{create:function(i){var j={extensions:_.concat([c,d,e,f,g,b,i.extensions]),template:h,showEmptyMessage:!1};return i.shortcutProcessorTarget=".ui-comment-text",a.create(j,i)}}}),define("tau/models/model.customField",["Underscore","tau/core/model-base","tau/configurator","tau/utils/utils.htmlConverter","tau/utils/utils.date","tau/extensions/extension.underscore"],function(_,a,b,c,d){var e=a.extend({_process:function(a){var b={RichText:function(a){return a.value=c.fromSourceToHtml(a.value),a},Date:function(a){return a.value=d.format.date.short(d.convertToTimezone(a.value)),a.output=a.value,a},DropDown:function(a){return a.options=a.options?_.asString(a.options).split("\r\n"):[],a.value=_.asString(a.value),a.output=_.asString(a.value),a},Entity:function(a){return a.value=a.value||{},a.value=_.defaults(a.value,{id:null,name:"",kind:null}),a.value.__type=a.value.kind,a.output=a.value.name+"",a},MultipleSelectionList:function(a){return a.options=a.options?_.asString(a.options).split("\r\n"):[],a.value?(a.value=_.asString(a.value).split(","),a.output=a.value.join(", ")):(a.value=null,a.output=""),a},Number:function(a){return a.value=a.value?parseInt(a.value)+"":"",a.output=a.value,a},URL:function(a){return a.value=a.value||{},_.defaults(a.value,{url:"",title:""}),a.options=null,a}};return a.type in b&&(a=b[a.type](a)),a.type!="url",a},createConfiguration:function(a,b,c,d){var e=_.find(c,function(b){return b.type.toLowerCase()==a.type.toLowerCase()&&b.name==a.name}),f=_.find(d,function(b){return b.type.toLowerCase()==a.type.toLowerCase()&&b.name==a.name}),g={};if(e&&f)g={name:f.name,type:f.type,required:e.required,listed:e.listed,value:f.value,options:e.value,output:f.value},g=this._process(g);else if(e&&!f)g={name:e.name,type:e.type,required:e.required,listed:e.listed,value:null,options:e.value,output:null},g=this._process(g);else throw new Error("No valid configuration for field "+a.name);return g},"bus configurationProvided":function(a){var b=a.data;_.isEmpty(b)==0&&this.fire("dataBind",b),this.configuration=b},"bus beforeInit":function(a){var b=a.data.config;this.store=b.store?b.store:this.store;var c=b.context.entity,d=b.context.getCustomFields(),e=b.customField||b.data,f=this,g={name:e.name,type:e.type};this.store.get(c.entityType.name,{id:c.id,fields:["id","customFields"]}).done({success:function(a){var b=a[0].data.customFields,e=f.createConfiguration(g,c,d,b);f.fire("configurationProvided",e)}})}});return e}),define("tau/components/component.customField.checkbox",["tau/components/component.creator","tau/models/model.customField","tau/models/model.customField.editable","tau/components/extensions/customField/extension.customField.checkbox.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/ui/templates/customField/ui.template.customField.checkbox"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[c,e,d]};return a.create(h,g)}}}),define("tau/components/component.customField.dropdown",["Underscore","tau/components/component.creator","tau/models/model.customField","tau/models/model.customField.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/ui/extensions/popupEditorContainer.extension","tau/components/extensions/component.creator.extension","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.dropdown"],function(_,a,b,c,d,e,f,g,h,i){return{create:function(j){var k={ModelType:b,extensions:[c,d,g,h,f,{type:e,config:{onCreate:function(a){_(a.config).extend({popupEditorContainer:[{targetSelector:"tr",alignmentSelector:".ui-customfield__value",component:{type:"customField.dropdown.list"}}]})}}}],template:i};return a.create(k,j)}}}),define("tau/components/component.customField.entity",["Underscore","tau/components/component.creator","tau/components/extensions/component.creator.extension","tau/models/model.customField","tau/ui/extensions/customField/ui.extension.customField.required","tau/ui/templates/customField/ui.template.customField.entity","tau/ui/extensions/popupEditorContainer.extension","tau/models/customField/model.customField.entity.editable","tau/ui/extensions/customField/ui.extension.customField.editable"],function(_,a,b,c,d,e,f,g,h){return{create:function(i){var j={template:e,extensions:[g,c,d,f,h,b]};i=i||{};var k={type:"finder",additionalExtensions:[g],fields:["id","name",{project:["id","name","abbreviation"]}],maxHeight:400};return i.customField&&i.customField.required===!0&&(k.resetDisabled=!0),_.extend(i,{popupEditorContainer:[{targetSelector:"tr",targetCssClass:"ui-customfield_editable_true",alignmentSelector:".entity-custom-field-link",component:k}]}),a.create(j,i)}}}),define("tau/components/component.customField.multiselect",["Underscore","tau/components/component.creator","tau/models/model.customField","tau/models/model.customField.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/ui/extensions/popupEditorContainer.extension","tau/components/extensions/component.creator.extension","tau/components/extensions/customField/extension.customField.multiselect.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.multiselect"],function(_,a,b,c,d,e,f,g,h,i){return{create:function(j){var k={ModelType:b,extensions:[c,d,g,h,f,{type:e,config:{onCreate:function(a){_(a.config).extend({popupEditorContainer:[{targetSelector:"tr",alignmentSelector:".ui-customfield__value",component:{type:"customField.multiselect.list"}}]})}}}],template:i};return a.create(k,j)}}}),define("tau/components/component.customField.number",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.number.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.number.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(a,b,c,d,e,f,g){return{create:function(h){var i={ModelType:b,template:g,extensions:[c,e,d,f]};return a.create(i,h)}}}),define("tau/components/component.customField.text",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.text.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.text.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.text"],function(a,b,c,d,e,f,g){return{create:function(h){var i={ModelType:b,template:g,extensions:[c,d,e,f]};return a.create(i,h)}}}),define("tau/components/component.customField.url.editor",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.url.editable.editor","tau/components/extensions/customField/extension.customField.url.editor","tau/ui/templates/customField/ui.template.customField.url.editor"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/components/component.customField.url",["Underscore","tau/components/component.creator","tau/models/model.customField","tau/ui/extensions/customField/ui.extension.customField.required","tau/models/customField/model.customField.url.editable.row","tau/components/extensions/customField/extension.customField.url.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/extensions/popupEditorContainer.extension","tau/components/extensions/component.creator.extension","tau/ui/templates/customField/ui.template.customField.url"],function(_,a,b,c,d,e,f,g,h,i){return{create:function(j){var k={extensions:[b,c,d,e,f,h,{type:g,config:{onCreate:function(a){_(a.config).extend({popupEditorContainer:[{targetSelector:"tr",alignmentSelector:".ui-customfield__value",component:{type:"customField.url.editor"}}]})}}}],template:i};return a.create(k,j)}}}),define("tau/ui/behaviour/date/ui.behaviour.dateEditor",["Underscore","jQuery","tau/core/tau","tau/configurator"],function(_,$,a,b){$.widget("ui.dateEditor",{options:{widgetName:"datepicker",onSave:function(){},validation:{required:!1},dateFormat:"m/dd/yy"},errors:[],_create:function(){this.init()},init:function(){var a=$(this.element);this.$element=a,a.click($.proxy(this.showEditor,this)),a.addClass("ui-dateeditor-source")},setValidationErrors:function(a){this.element.addClass("ui-validationerror"),_.isString(a)&&this.element.attr("title",a)},resetValidationErrors:function(a){this.element.removeClass("ui-validationerror"),this.element.removeAttr("title",a)},activate:function(){this._justActivated=!0,this.showEditor(),this.$editor.find(":text").focus()},_attachKeyBoardHandling:function(){var a=this,c={handleKeyDown:function(){a.mapKeys.apply(a,arguments)}};b.getKeyBoardManager().pushHandler(c)},showEditor:function(b){var c=this;if(!this._editorIsVisible){if(!this.$editor){var d=$(a.concat('<span class="ui-dateeditor">','    <input type="text" maxlength="20" />',"</span>")),e=d.find(":text");e.focus();var f=$("body"),g=function(a){c._onDocumentClick.apply(c,arguments),f.unbind("click",g)},h=function(){f.click(g)};e[this.options.widgetName]({showButtonPanel:!1,dateFormat:this.options.dateFormat,buttonText:"choose",showOn:"button",beforeShow:h,onSelect:function(a){e.focus()}}),d.insertAfter(this.$element),this.$editor=d}this._attachKeyBoardHandling(),c._documentClickDelegate||(c._documentClickDelegate=function(a){c._onDocumentClick(a)},$(document.body).click(c._documentClickDelegate)),this.$element.hide(),this._editorIsVisible=!0,this.$editor.show(),this.$editor.find(":text").val(this.$element.text())}},trimString:function(a){return(a||"").trim()},_getDefaultValue:function(){return this.options.date||this.element.text()},_onSave:function(){var a=this.$editor.find(":text").val(),c={value:a};(this.options.beforeChange||function(){})(c),a=c.value,this.hideEditor(),this.$element.show();var d=this._getDefaultValue();this.trimString(d)!=this.trimString(a)&&this.options.onSave(a),this.$element.text(a),b.getKeyBoardManager().popHandler()},_onCancel:function(){b.getKeyBoardManager().popHandler();var a=this.$editor.find(":text").val();this.hideEditor(),this.$element.show(),this.options.onCancel&&this.options.onCancel()},hideEditor:function(){this.$editor&&this._editorIsVisible&&(this.$editor.hide(),this._editorIsVisible=!1),this._documentClickDelegate&&($(document.body).unbind("click",this._documentClickDelegate),delete this._documentClickDelegate)},_onDocumentClick:function(a){var b=this,c=$(a.target);if(!this._editorIsVisible)return;if(this._justActivated&&a.target!=document.body){this._justActivated=!1;return}if(c.hasClass("ui-dateeditor-source")||c.hasClass("ui-dateeditor")||c.parents(".ui-dateeditor").length>0||c.parents(".ui-datepicker").length>0||c.parents(".ui-datepicker-calendar").length>0||c.parents(".ui-datepicker-header").length>0)return;b._onSave(),b.hideEditor(),a.stopPropagation(),a.preventDefault()},destroy:function(){this.hideEditor();var a=this.$editor;if(a){var b=a.find(":text");b[this.options.widgetName]("destroy"),a.remove()}},mapKeys:function(a){switch(a.which){case 13:a.preventDefault(),this._onSave();break;case 27:a.preventDefault(),this._onCancel()}}})}),define("tau/components/extensions/customField/extension.customField.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(_,$,a,b){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var c=this,d=a.afterRender.data.data,e=a.permissionsReady.data;if(e.editable){var f=a.afterRender.data.element,g=f.find(".ui-customfield__value");g.addClass("editableText"),this.$widget=g,$.datepicker.parseDate=function(a,c,d){return b.parse(c)},$.datepicker.formatDate=function(a,c,d){return b.formatAs(c,a)};var h=b.getFormatData().date.short;g.dateEditor({dateFormat:h,onSave:function(a){c.bus.fire("save",{customFields:[{name:d.name,type:d.type,value:a}]})}}),f.behaviourCustomFieldRow({onActivate:function(){g.dateEditor("activate"),g.focus()}}),f.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.dateEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}})}),define("tau/components/component.customField.date",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.date.editable","tau/ui/extensions/customField/ui.extension.customField.required","tau/components/extensions/customField/extension.customField.date.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.date"],function(a,b,c,d,e,f,g){return{create:function(h){var i={ModelType:b,template:g,extensions:[c,d,e,f]};return a.create(i,h)}}}),define("tau/components/extensions/property/extension.property.date.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(_,$,a,b){return a.extend({category:"edit",init:function(){this._super.apply(this,arguments),this.onClickProxy=$.proxy(this.onClickHandler,this)},"bus permissionsReady+afterRender+dataBind":function(a){var c=this,d=this.element=a.afterRender.data.element;a.afterRender.data.element.find(".external-view").click(function(a){a.stopPropagation()});var e=this.permissions=a.permissionsReady.data,f=this.date=a.dataBind.data,g=this.config.format;if(e.editable){this.element.bind("click",this.onClickProxy);var h=this.$widget=d.find(".property"),i=null;g=="datetime"?i="datetimepicker":i="datepicker",$.datepicker.parseDate=function(a,c,d){return b.parse(c)},$.datepicker.formatDate=function(a,c,d){return b.format.date.short(c)},h.dateEditor({dateFormat:b.getFormatData().date.short,widgetName:i,beforeChange:function(a){c.fire("validateDate",a)},onSave:function(a){var b={};b[c.config.propertyName]=a;if(c.trimString(a)!=c.trimString(f.text)){var d={$set:b};d.$include=[c.config.propertyName],c.bus.fire("save",d)}else c.fire("resetValidationErrors")}})}},trimString:function(a){return(a||"").trim()},showEditor:function(){this.$widget.dateEditor("activate"),this.$widget.focus()},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){this.showEditor()},removeHandlers:function(){this.element&&this.element.unbind("click",this.onClickProxy)},removeWidget:function(){this.$widget&&this.$widget.dateEditor("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/components/component.property.date",["Underscore","tau/components/component.creator","tau/models/model.property.date","tau/models/model.property.date.validation","tau/models/model.property.date.editable","tau/components/extensions/property/extension.property.date.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.date"],function(_,a,b,c,d,e,f,g){return{create:function(h){h=_.extend(_.clone(h)),h.validationExtension=h.validationExtension||c;var i={ModelType:b,template:h.template||g,extensions:_.concat([h.extensions,f,d,e,h.validationExtension])};return a.create(i,h)}}}),define("tau/components/component.property.buildDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="buildDate",b.format="datetime",a.create(b)}}}),define("tau/components/component.property.completeDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="endDate",a.create(b)}}}),define("tau/components/component.property.createDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="createDate",a.create(b)}}}),define("tau/components/component.property.endDate",["tau/components/component.property.date"],function(a,b){return{create:function(b){return b=b||{},b.propertyName="endDate",a.create(b)}}}),define("tau/components/component.property.endDate.list",["tau/components/component.property.date","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property/ui.template.property.endDate.list"],function(a,b,c){return{create:function(d){return d=d||{},d.propertyName="endDate",d.template=c,d.extensions=[b],a.create(d)}}}),define("tau/components/component.property.endDate.project",["tau/components/component.property.date","tau/models/model.property.date.validation.project"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="endDate",c.validationExtension=b,a.create(c)}}}),define("tau/components/component.property.lastRunDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="lastRunDate",b.editable=!1,b.format="datetime",a.create(b)}}}),define("tau/components/component.property.lastRunDate.list",["tau/components/component.property.date","tau/ui/extensions/ui.extension.tooltip","tau/ui/templates/property/ui.template.property.lastRunDate.list"],function(a,b,c){return{create:function(d){return d=_.clone(d||{}),d.propertyName="lastRunDate",d.editable=!1,d.format="datetime",d.extensions=[b],d.template=c,a.create(d)}}}),define("tau/components/component.property.startDate",["tau/components/component.property.date"],function(a){return{create:function(b){return b=b||{},b.propertyName="startDate",a.create(b)}}}),define("tau/components/component.property.startDate.project",["tau/components/component.property.date","tau/models/model.property.date.validation.project"],function(a,b){return{create:function(c){return c=c||{},c.propertyName="startDate",c.validationExtension=b,a.create(c)}}}),define("tau/components/extensions/property/extension.property.time.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(_,$,a){return a.extend({category:"edit",normalizeEffort:function(a){return Math.abs(Math.round(parseFloat(a)*100)/100)||0},"bus permissionsReady+afterRender+dataBind":function(a){var b=this,c=this.permissions=a.permissionsReady.data;c.editable&&(b.$el=a.afterRender.data.element,b.$el.find(".property-text").editableText({mask:/^\d*\.?\d*$/,restoreText:!0,onSave:function(c){var d=a.dataBind.data,e=b.normalizeEffort(d.text),f=b.normalizeEffort(c);if(e===f)return this.restoreInitialText(),!1;var g={};g[b.config.propertyName]=f;var h={$include:["id"],id:b.config.context.entity.id,$set:g};b.bus.fire("save",h)},onEditStart:function(){this.$element.data("points",this.$element.find("span").detach())},onEditEnd:function(){this.$element.append(this.$element.data("points"))}}))},showEditor:function(){this.$el.find(".property-text").editableText("activate")},"bus edit":function(){this.permissions.editable&&this.showEditor()},onClickHandler:function(){},removeHandlers:function(){},removeWidget:function(){this.$widget&&this.$widget.editableText("destroy")},destroy:function(){this.removeHandlers(),this.removeWidget(),this._super.apply(this,arguments)}})}),define("tau/components/component.property.time",["Underscore","tau/components/component.creator","tau/models/model.property.time","tau/models/model.property.time.editable","tau/components/extensions/property/extension.property.time.editable","tau/components/extensions/property/extension.property.refresher","tau/ui/templates/property/ui.template.property.time","tau/ui/behaviour/common/ui.behaviour.editableText"],function(_,a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:f,extensions:[d,c,e]};return a.create(h,g)}}}),define("tau/components/component.property.initialEstimate",["Underscore","tau/components/component.property.time"],function(_,a){return{create:function(b){return b=_.clone(b||{}),b.propertyName="initialEstimate",a.create(b)}}}),define("tau/components/component.property.velocity",["tau/components/component.property.time"],function(a){return{create:function(b){return b.propertyName="velocity",a.create(b)}}}),define("tau/ui/behaviour/common/ui.behaviour.listSelectable",["Underscore","jQuery","tau/configurator"],function(_,$,a){$.widget("ui.listSelectable",{_create:function(){},_handler:function(a){},enable:function(b){b=_.defaults(b||{},{saveScroll:!1});if(this._enabled)return;this._enabled=!0;var c=this.element.parents(".ui-drop-down:first").find(".filter-field-wrapper :text");c.length&&c.focus();var d=this;this.reset(b);var e=function(a){return a++,a>=d._max&&(a=0),a},f=function(a){return a--,a<0&&(a=d._max-1),a},g=this.$items,h=this.options.className;a.getKeyBoardManager().pushHandler({handleKeyDown:function(a){var b=d._index;switch(a.keyCode){case $.ui.keyCode.DOWN:a.preventDefault(),b=e(b);break;case $.ui.keyCode.UP:a.preventDefault(),b=f(b);break;case $.ui.keyCode.ENTER:a.preventDefault();if(b<0)return;d.$items.eq(b).trigger("click");break;default:return}d._index=b,d.$items.removeClass(h),b>=0&&d.$items.eq(b).addClass(h),d.$list.animate({scrollTop:d._getOffset(b)},{duration:0})}})},_getOffset:function(a){var b=this.$items.eq(a);if(b.length==0)return 0;var c=this.$inner.position().top,d=b.position().top,e=b.parent("i-group");e.length&&(d+=e.position().top);var f=-c+d-this.$list.height()/2;return f},reset:function(a){a=_.defaults(a||{},{saveScroll:!1}),this.$items=this.element.find(this.options.items).filter(":visible");var b=this.element;this.$list=b,this.$inner=this.$list.find(this.options.inner||".i-inner"),a.saveScroll==0&&b.scrollTop(0);var c=b.height();this.step=this.$items.eq(0).height()*.5,this._index=-1,this._max=this.$items.length;var d=this.options.className;a.saveScroll==0&&this.$items.removeClass(d)},disable:function(){if(!this._enabled)return;this._enabled=!1,a.getKeyBoardManager().popHandler()},destroy:function(){this.disable()}})}),define("tau/ui/extensions/stateList/ui.extension.stateList.editable",["Underscore","jQuery","tau/utils/utils.textsearch","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(_,$,a,b){var c=b.extend({"bus dataBind+afterRender":function(a){this.searchIndex=null;var b=this.config,c=this.element=a.afterRender.data.element,d=this.dataToBind=a.dataBind.data,e=0;_.forEach(d.states,function(a){a.items?e+=a.items.length:e++}),this.$list=c.find(".drop-down-list"),this.$options=this.$list.find(".drop-down-option"),this.$options.click($.proxy(this.onItemSelected,this)),b.hasOwnProperty("maxHeight")&&this.$list.css("max-height",b.maxHeight).css("overflow-y","auto");var f=$("<div class='drop-down-actions' role='actions' />"),g=!1;if(d.hasOwnProperty("defaultValue")){g=!0;var h=this.config.defaultValueLabel||"default";$("<span class='action-link default'>"+h+"</span>").click($.proxy(this.defaultValue,this)).appendTo(f)}this.config.allowToReset=_.isUndefined(this.config.allowToReset)?!0:this.config.allowToReset;if(d.nullableValue&&this.config.allowToReset){g=!0;var i=this.config.clearValueLabel||"reset";$("<span class='action-link clear' role='action-reset'>"+i+"</span>").click($.proxy(this.clearValue,this)).appendTo(f)}g&&f.insertBefore(this.$list);if(d.states.length===0&&d.completed){var j=b.emptyDataMessage||"None";this.$list.append("<span class='empty-message'>"+j+"</span>")}b.filter&&e>3&&(this.filterField=$("<input type='text' class='filter-field' />").keyup($.proxy(this._filterDelegate,this)),$("<div class='filter-field-wrapper'></div>").append(this.filterField).insertBefore(this.$list));if(b.expandable&&!d.completed){var k=b.mode||"short";if(k!=="full"){var l=$("<div class='drop-down-footer'></div>"),m=this.config.fullModeLabel||"more...";this.$mode=$("<div class='action-link more'>"+m+"</div>").click($.proxy(this._toggleMode,this)).appendTo(l),l.insertAfter(this.$list)}}this._resize(),this.bus.fire("listOptionsReady",{element:c}),this._createSelectable()},_createSelectable:function(){this.$list.listSelectable({items:".drop-down-option:visible",className:"drop-down-option_hover"}),this.$list.addClass("tau-dropdownlist_selectable_true")},_enableSelectable:function(){this.$list.hasClass("tau-dropdownlist_selectable_true")&&this.$list.listSelectable("enable")},_disableSelectable:function(){this.$list.hasClass("tau-dropdownlist_selectable_true")&&this.$list.listSelectable("disable")},"bus focus":function(a){this._enableSelectable()},"bus refresh":function(a){this._enableSelectable()},"bus blur":function(a){this._disableSelectable()},_resize:function(a){if(!this.element)return;var b=this.element,c=b.find(".drop-down-list");c.css("maxHeight",$(window).height()/2*.8),c.css("overflowY","auto"),c.css("overflowX","hidden")},"bus afterRender+popupResize":function(a){this._resize(a.popupResize.data)},"bus popupResize":function(a){this._resize(a.data)},_toggleMode:function(a){a.stopPropagation();var b=this.config.mode==="full"?"short":"full";this.fire("refresh",{mode:b})},clearValue:function(a){a.stopPropagation(),this._updateState(null)},defaultValue:function(a){a.stopPropagation(),this._updateState(this.dataToBind.defaultValue)},onItemSelected:function(a){var b=$(a.target).tmplItem().data;this._updateState(b.id)},_updateState:function(a){var b=!0;this.config.confirmation&&window.confirm&&(b=window.confirm(this.config.confirmation)),b&&this.fire("updateState",{id:a})},_resetList:function(){this.$options.show()},_noResults:function(a){var a='"'+a+'" not found';this.$noResults?this.$noResults.text(a):this.$noResults=$("<div class='not-found' />").text(a).insertBefore(this.$list),this.$noResults.show()},_clearNoResults:function(){this.$noResults&&this.$noResults.hide()},_filterDelegate:function(b){if(b.keyCode==jQuery.ui.keyCode.DOWN||b.keyCode==jQuery.ui.keyCode.UP||b.keyCode==jQuery.ui.keyCode.ENTER||b.keyCode==jQuery.ui.keyCode.ESCAPE)return;if(!this.searchIndex){var c=[];this.searchIndex=new a,this.$options.each(function(a,b){c.push({_id:a,data:$(b).text()}),$(this).data("text",$(b).text())}),this.searchIndex.load(c)}var d=this.filterField.val(),e=this.searchIndex.search(d);this.$options.hide();var f=this.$options;_.forEach(e,function(a){var b=f.eq(a._id),c=b.data("text")+"";c=c.substr(0,a.entry.from)+"<em>"+c.substr(a.entry.from,a.entry.len)+"</em>"+c.substr(a.entry.from+a.entry.len,c.length),b.html(c),b.show(),b.parent().show()}),f.filter(":hidden").parent().not(f.filter(":visible").parent()).hide(),d.length?e.length==0?this._noResults(d):this._clearNoResults():(this._clearNoResults(),this._resetList()),this.$list.listSelectable("reset")}});return c}),define("tau/components/component.customField.dropdown.list",["tau/components/component.creator","tau/core/model-base","tau/models/customField/model.customField.dropdown.editable","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/templates/state/ui.template.state-list.dropdown"],function(a,b,c,d,e){return{create:function(f){var g={ModelType:b,extensions:[c,d],template:e};return a.create(g,f)}}}),define("tau/ui/extensions/stateList/ui.extension.stateList.editable.multiselect",["Underscore","jQuery","tau/ui/extensions/stateList/ui.extension.stateList.editable"],function(_,$,a){var b=a.extend({"bus dataBind+afterRender":function(a){this._super(a);var b=a.afterRender.data.element;this.$el=b,this.field=this.config.data,this._updateSave();var c=b.find("[role=action-save]"),d=this;c.click(function(a){var c=b.find("[role=option].tau-option_selected_true"),e=[];_.forEach(c,function(a){e.push($(a).tmplItem().data.id)}),d._updateState(e)});var e=b.find("[role=action-cancel]");e.click(function(a){d.fire("close")})},"bus blur":function(){this.bus.fire("close")},onItemSelected:function(a){var b=$(a.target);b.toggleClass("tau-option_selected_true"),this._updateSave()},_updateSave:function(){if(this.field.required==1){this.enabled=this.enabled||null;var a=this.$el.find("[role=option].tau-option_selected_true"),b=this.$el.find("[role=action-save]");a.length?(b.removeClass("disable"),b.removeAttr("disabled")):(b.addClass("disable"),b.attr("disabled","disabled"))}}});return b}),define("tau/components/component.customField.multiselect.list",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.multiselect.editable","tau/ui/extensions/stateList/ui.extension.stateList.editable.multiselect","tau/ui/templates/state/ui.template.state-list.multiselect"],function(a,b,c,d,e){return{create:function(f){var g={ModelType:b,extensions:[c,d],template:e};return a.create(g,f)}}}),define("tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.list",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(_,$,a){return a.extend({"bus afterRender":function(a){var b=a.data.element,c=b.find("[role=list]"),d=b.find("[role=list-placeholder]");this.$list=c,this.$listPlaceholder=d,this.first=!0,this.$listPlaceholder.listSelectable({items:"[role=option]",className:"tau-result-list-row_hover",inner:"table"}),this.attachScrollingEvents(d),this.attachSortingEvents(b.find("[role=list-sorting]")),this.setScrollAvailable(!1),this._signUpOnActionsAndSelection(b)},"bus result.ready":function(a){var b=this.$listPlaceholder.data("listSelectable")._index;this.$listPlaceholder.listSelectable("disable");var c=this,d=this.$list,e=a.data.data.result,f=this.config.templateList,g=f.get().bind(this.config,e);e.paging.start==0&&(d.empty(),b=-1,e.paging.count==0&&this.$listPlaceholder.toggleClass("tau-finder__result_state_empty",!0)),this.setScrollAvailable(e.paging.hasNext),g.find("[role=option]").appendTo(d),this.$listPlaceholder.toggleClass("tau-finder__result_state_loading",!1),e.paging.count>0&&this.$listPlaceholder.toggleClass("tau-finder__result_state_empty",!1),this.$listPlaceholder.listSelectable("enable",{saveScroll:!0}),this.$listPlaceholder.data("listSelectable")._index=b,this.first&&(setTimeout(function(){c.$listPlaceholder.scrollTop(0)},100),this.first=!1)},"bus scroll.reachEnd":function(a){this.scrollAvailable&&this.bus.fire("search.pagingBound")},setScrollAvailable:function(a){this.scrollAvailable=a},attachScrollingEvents:function(a){var b=this,c=function(c){a.scrollTop()+a.innerHeight()>=a[0].scrollHeight&&b.bus.fire("scroll.reachEnd")};a.scroll(c)},attachSortingEvents:function(a){var b=a.find("[role=sorting]"),c=this;a.delegate("[role=sorting]","click",function(){var a=$(this),d="desc";a.hasClass("tau-finder__sorttrigger_dir_"+d)&&(d="asc"),b.toggleClass("tau-finder__sorttrigger_dir_desc",!1),b.toggleClass("tau-finder__sorttrigger_dir_asc",!1),b.toggleClass("tau-finder__sorttrigger_state_active",!1),a.toggleClass("tau-finder__sorttrigger_dir_"+d,!0),a.toggleClass("tau-finder__sorttrigger_state_active",!0);var e=a.val();c.bus.fire("search.orderBound",{value:e,dir:d})})},_signUpOnActionsAndSelection:function(a){var b=this;a.delegate("[role=option]","click",function(a){var c=$(this),d=c.data();if(!d)return;if(!d.tmplItem)return;d=d.tmplItem.data;if(!d)return;b.bus.fire("entitySelected",{entity:d})})}})}),define("tau/components/component.finder.requesters",["tau/components/component.creator","tau/models/finder.requesters/model.generalUser.finder","tau/models/finder.requesters/model.generalUser.editor","tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.list","tau/ui/extensions/finder.requesters/ui.extension.finder.requesters.filter","tau/ui/templates/finder.requesters/ui.template.finder","tau/ui/templates/finder.requesters/ui.template.finder.resultList"],function(a,b,c,d,e,f,g){return{create:function(h){var i={name:"finder",extensions:[b,c,d,e],template:f};return h.templateList=g,a.create(i,h)}}}),define("tau/components/extensions/userList/extension.userList.editable",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(_,$,a){return a.extend({category:"edit",name:"user list",init:function(){this._super.apply(this,arguments),this._userClick=$.proxy(this.onUserClick,this),this._unassignClick=$.proxy(this.onUnassignClick,this),this._assignToMeClick=$.proxy(this.onAssignToMeClick,this),this._filterChanged=$.proxy(this.onFilterChanged,this),this._moreClicked=$.proxy(this.onMoreClick,this)},onMoreClick:function(a){a.stopPropagation(),this.fire("showMore")},onUserClick:function(a){var b=$(a.target),c=b.tmplItem().data;this.fire("changeAssignment",{user:c})},onUnassignClick:function(){this.fire("removeAssignment")},onAssignToMeClick:function(){this.fire("assignToLoggedUser")},onFilterChanged:function(a){if(a.keyCode==$.ui.keyCode.DOWN||a.keyCode==$.ui.keyCode.UP||a.keyCode==$.ui.keyCode.ENTER)return;a.preventDefault(),this.fire("setFilter",{filter:$(a.target).val()})},"bus beforeRender":function(){var a=this.$element;a&&(a.find(".user").unbind("click",this._userClick),a.find(".unassign-button").unbind("click",this._unassignClick),a.find(".assign-to-me-button").unbind("click",this._assignToMeClick),a.find(".user-search-box").unbind("keyup",this._filterChanged),a.find(".more-link").unbind("click",this._moreClicked))},"bus afterRender":function(a){var b=this,c=b.$element=a.data.element;c.find(".user").click(this._userClick),c.find(".unassign-button").click(this._unassignClick),c.find(".assign-to-me-button").click(this._assignToMeClick),c.find(".user-search-box").keyup(this._filterChanged),c.find(".more-link").bind("click",this._moreClicked)},"bus refresh":function(a){var b=this.$element.find(".user-list");this._resize(),b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),b.listSelectable("reset")},"bus focus":function(a){var b=this.$element.find(".user-list");b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),this.$element.find(".user-search-box").focus()},"bus blur":function(a){this.$element.find(".user-list:visible").listSelectable("disable")},_resize:function(a){if(!this.$element)return;var b=this.$element,c=b.find(".user-list");c.css("maxHeight",$(window).height()/3),c.css("overflowY","auto"),c.css("overflowX","hidden")},"bus afterRender+popupResize":function(a){this._resize(a.popupResize.data)},"bus popupResize":function(a){this._resize(a.data)}})}),define("tau/ui/extensions/ui.extension.content.imagePreview",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(_,$,a,b){return a.extend({category:"edit","bus afterRender":function(a){var b=this,c=a.data,d=c.element,e=this.config.imagePreviewContentSelector,f=d.find(e).find("img");if(f.size()>0)var g=setInterval(function(){$.contains(document.body,d[0])&&(clearInterval(g),b.onDOMReady(d))},1e3)},onDOMReady:function(a){var b=this,c=this.config.imagePreviewContentSelector,d=a.find(c).find("img"),e=a.width();for(var f=0,g=d.size();f<g;f++){var h=d.eq(f),i=h[0].style.width,j=parseInt(i);if(j>e){var k=$('<div class="tau-lightbox-container"></div>'),l=$('<a rel="lightbox" class="tau-lightbox-full-size">View Full Size</a>');l.attr("href",h.attr("src")),l.click($.proxy(b.pushEscapeHandler,b)),k.append(h.clone()).append(l),h.replaceWith(k)}}},pushEscapeHandler:function(){var a=this,c=b.getKeyBoardManager();c.pushHandler({handleKeyDown:function(b){b.keyCode==$.ui.keyCode.ESCAPE&&a.popHandler()}}),$("body").find("#ux-lightbox-overlay").bind("click",a.popHandler)},popHandler:function(){var a=this;b.getKeyBoardManager().popHandler(),$("body").find("#ux-lightbox-overlay").unbind("click",a.popHandler)}})}),define("tau/components/component.customField.richtext",["tau/components/component.creator","tau/models/model.customField","tau/models/customField/model.customField.richtext.editable","tau/components/extensions/customField/extension.customField.richtext.editable","tau/ui/extensions/customField/ui.extension.customField.editable","tau/ui/templates/customField/ui.template.customField.richtext","tau/ui/extensions/ui.extension.shortcutProcessor","tau/ui/extensions/ui.extension.content.imagePreview"],function(a,b,c,d,e,f,g,h){return{create:function(i){i=i||{};var j={ModelType:b,template:f,extensions:[c,d,e,h,g]};return i.shortcutProcessorTarget=".ui-customfield__value.value",i.imagePreviewContentSelector=".ui-customfield__value.value",a.create(j,i)}}}),define("tau/components/component.field.richText",["tau/components/component.creator","tau/models/model.field.richText","tau/models/model.field.richText.editable","tau/components/extensions/field/extension.field.richText.editable","tau/ui/templates/field/ui.template.field.richText","tau/ui/extensions/ui.extension.shortcutProcessor","tau/ui/extensions/ui.extension.content.imagePreview"],function(a,b,c,d,e,f,g){return{create:function(h){var i={extensions:[b,c,f,d,g],template:e};return h.shortcutProcessorTarget=".ui-description__inner",h.imagePreviewContentSelector=".ui-description__inner",a.create(i,h)}}}),define("tau/components/component.description",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.fieldName="description",a.create(b)}}}),define("tau/components/component.steps",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.fieldName="steps",a.create(b)}}}),define("tau/components/component.success",["tau/components/component.field.richText"],function(a){return{create:function(b){return b=b||{},b.fieldName="success",a.create(b)}}}),define("tau/components/extensions/diagnostics/extension.diagnostics.base",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/extensions/component.extension.base"],function($,_,a,b,c){var d=c.extend({init:function(a){this._super(a)},_getData:function(){var c=0,d=_.values(a.getProxy().__subscriptions);return _.each(d,function(a){if(_.isObject(a)){var b=_.values(a);_.each(b,function(a){_.isObject(a)&&(c+=_(a).values().length)})}}),{countOfBuses:b.count(),globalBusListeners:a.getGlobalBus().getListenersCount(),storeListeners:c}},"bus beforeInit":function(){var a=this;a.fire("dataBind",a._getData())},signUp:function(){var c=["create","destroy"],d=["initialize","refresh","afterStoreOn","afterStoreUnbind"],e=this,f=function(a){e.refreshStats()};_.each(c,function(a){b.on(a,f,e)}),_.each(d,function(b){a.getGlobalBus().on(b,f,e,null,1e3)})},startMonitoringWithOutRefresh:function(){if(this.monitoringStarted)return;this.monitoringStarted=!0,this.signUp()},startMonitoring:function(){this.startMonitoringWithOutRefresh(),this.refreshStats()},"bus afterRender":function(){var b=this,c=this.config.startMonitoringConfig||{name:/(application|entity component)/,events:["afterRender"]},d=a.getGlobalBus(),e=function(a){a.caller.name.match(c.name)&&(_.each(c.events,function(a){d.removeAllListeners(b)}),b.startMonitoring())};_.each(c.events,function(a){d.on(a,e,b)})},refreshStats:function(){this.fire("refreshData",this._getData())},"bus destroy":function(){a.getGlobalBus().removeAllListeners(this),b.removeAllListeners(this)}});return d}),define("tau/components/component.diagnostics.globalListeners",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.globalListeners","tau/components/extensions/diagnostics/extension.diagnostics.base"],function($,_,a,b,c,d,e){return{create:function(b){var f=e.extend({_getData:function(){return this.startMonitoringWithOutRefresh(),{data:a.getGlobalBus().getListeners()}},_onDetailsClick:function(){var a=$(this).tmplItem().data.item;console.log(a.fn.toString()),console.log(a.fn)},_signUpOnClick:function(a){$(".tau-global-listener",a.data.element).click(this._onDetailsClick)},"bus elementRefreshedWithData":function(a){this._signUpOnClick(a)},"bus afterRender":function(a){this._signUpOnClick(a)}}),g={extensions:[f],template:d};return c.create(g,b)}}}),define("tau/components/component.diagnostics",["tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics","tau/components/extensions/diagnostics/extension.diagnostics.base"],function(a,b,c){return{create:function(d){var e={extensions:[c],template:b};return a.create(e,d)}}}),define("tau/components/component.diagnostics.store",["jQuery","Underscore","tau/configurator","tau/core/bus.reg","tau/components/component.creator","tau/ui/templates/diagnostics/ui.template.diagnostics.store","tau/components/extensions/diagnostics/extension.diagnostics.base"],function($,_,a,b,c,d,e){return{create:function(b){var f=e.extend({_getData:function(){this.startMonitoringWithOutRefresh();var b=0,c=_.values(a.getProxy().__subscriptions),d={};return _.each(c,function(a){if(_.isObject(a)){var b=_.values(a);_.each(b,function(a){if(_.isObject(a)){var b=_(a).values();_.each(b,function(a){var b=a.config.eventName+"["+a.config.type+"]";d.hasOwnProperty(b)||(d[b]={name:b,items:[]});var c="unknown";a.config.listener&&a.config.listener.name&&(c=a.config.listener.name),a.config.listener&&a.config.listener.bus&&a.config.listener.bus.name&&(c=a.config.listener.bus.name),d[b].items.push({name:c,sub:a})})}})}}),{data:_.values(d)}},_onDetailsClick:function(){var a=$(this).tmplItem().data.sub;console.log(a.callback.toString()),console.log(a)},_signUpOnClick:function(a){$(".tau-store-listener",a.data.element).click(this._onDetailsClick)},"bus elementRefreshedWithData":function(a){this._signUpOnClick(a)},"bus afterRender":function(a){this._signUpOnClick(a)}}),g={extensions:[f],template:d};return c.create(g,b)}}}),define("tau/utils/utils.urlBuilder",["Underscore","tau/configurator"],function(_,a){return{getViewUrl:function(b){return a.getApplicationPath()+"/View.aspx?noRedirect=1&id="+b},getAddImpedimentUrl:function(b){return a.getApplicationPath()+"/Project/Tracking/Impediment/Edit.aspx?AssignableID="+b},getAddTimeUrl:function(b){return a.getApplicationPath()+"/Project/Tracking/Time/Edit.aspx?AssignableID="+b},getAddTaskForUserStoryUrl:function(b){return a.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?UserStoryID="+b},getAddTaskForRequestUrl:function(b){return a.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?RequestID="+b},getSplitForUserStoryUrl:function(a,b){return"/Project/Planning/UserStory/Split.aspx?UserStoryID="+a+"&SplittedStoryID="+b},getAddBugForUserStoryUrl:function(b){return a.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?UserStoryID="+b},getAddBugForRequestUrl:function(b){return a.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?RequestID="+b},getAddTestCaseForUserStoryUrl:function(b){return a.getApplicationPath()+"/Project/QA/TestCase/Edit.aspx?UserStoryID="+b},getAssignTestCasesForTestPlanUrl:function(b){return a.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+b},getAddTestRunForTestPlanUrl:function(b){return a.getApplicationPath()+"/Project/QA/TestPlanRun/Edit.aspx?TestPlanID="+b},getAddUserStoryForRequestUrl:function(b){return a.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?RequestID="+b},getAddUserStoryForFeatureUrl:function(b){return a.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?FeatureID="+b},getAddUserStoryForIterationUrl:function(b){return a.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?IterationID="+b},getAddFeatureForRequestUrl:function(b){return a.getApplicationPath()+"/Project/Planning/Feature/Edit.aspx?RequestID="+b},getAddTestCaseForTestPlanRunUrl:function(b){return a.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+b},getAddIterationForReleaseUrl:function(b){return a.getApplicationPath()+"/Project/Planning/Iteration/Edit.aspx?ReleaseID="+b},getPrintUrl:function(b,c){return a.getApplicationPath()+"/RestUI/Print.aspx?id="+b+"&type=Tp.BusinessObjects."+c},getPrintUrlRelative:function(b,c){return"RestUI/Print.aspx?acid="+a.getCurrentAcid()+"#"+c.toLowerCase()+"/"+b+"/print"},getEditUrl:function(b,c){var d=a.getApplicationPath()+"/",e=c.toLowerCase();return e=="project"?d+="EditProject.aspx?ProjectID="+b:(d+="Project/",_.indexOf(["bug","testplan","testcase","testplanrun"],e)>-1?d+="QA/":_.indexOf(["impediment"],e)>-1?d+="Tracking/":_.indexOf(["request"],e)>-1?d+="HelpDesk/":e==="time"?d+="Tracking/":d+="Planning/",d+=c+"/Edit.aspx?"+c+"ID="+b),d},getAvatarUrl:function(b,c){return a.getApplicationPath()+"/Avatar.ashx?UserId="+b+"&size="+c},getUserUrl:function(b,c){var d="/User/View.aspx?UserID=";return c&&c=="Requester"&&(d="/User/Requester/View.aspx?RequesterID="),[a.getApplicationPath(),d,b].join("")}}}),define("tau/configurations/base.container.config",["Underscore","tau/core/class","tau/core/termProcessor","tau/utils/utils.urlBuilder","tau/components/extensions/comments/extensions.comments.refresher"],function(_,a,b,c,d){var e=a.extend({init:function(a){var e=a.context.getTerms();this.termProcessor=new b(e),this.collections={};var f=a.context.entity;this.registerAction("Old View",{label:"Old View",url:c.getViewUrl(f.id)}),this.registerAction("Old Edit",{label:"Old Edit",url:c.getEditUrl(f.id,f.entityType.name)}),this.registerAction("Print",{label:"Print View",command:function(a){a.redirectTo(c.getPrintUrlRelative(f.id,f.entityType.name),"_blank")}}),this.registerAction("-----","-----"),this.registerAction("Delete",{label:"Delete",confirmation:"Are you sure?",command:function(a){a.removeEntity()},className:"ui-menu__item-action-delete"}),this.registerAction("Move or Copy",{label:"Move or Copy",command:function(a){a.moveOrCopy()},editions:["~board"]}),this.registerAction("Convert",{label:"Convert",command:function(a){a.convert()},editions:["~board"]}),this.registerAction("Attach to Request",{label:"Attach To "+this.getTermName("Request"),command:function(a){a.attachToRequest()},editions:["Pro","~board"]}),this.registerAction("Add Impediment",{label:"Add "+this.getTermName("Impediment"),url:c.getAddImpedimentUrl(f.id)}),this.registerAdditionalInfoItem("Owner",{label:{type:"label",text:"Owner"},field:{type:"property.owner"}}),this.registerAdditionalInfoItem("Assigned Effort",{label:{type:"label",text:"Assigned Effort"},field:{type:"assignedEffort"}}),this.registerAdditionalInfoItem("Release Assigned Effort",{label:{type:"label",text:"Assigned Effort"},field:{type:"release.assignedEffort"}}),this.registerAdditionalInfoItem("Velocity",{label:{type:"label",text:"Velocity"},field:{type:"property.velocity"}}),this.registerAdditionalInfoItem("CycleTime",{label:{type:"label",text:"Cycle Time"},field:{type:"property.timeInterval",timeField:"cycleTime"}}),this.registerAdditionalInfoItem("LeadTime",{label:{type:"label",text:"Lead Time"},field:{type:"property.timeInterval",timeField:"leadTime"}}),this.registerAdditionalInfoItem("State",{label:{type:"label",text:"State"},field:{type:"property.entityState"}}),this.registerAdditionalInfoItem("Test Plan",{label:{type:"label",text:this.getTermName("TestPlan")},field:{type:"property.testPlan"}}),this.registerAdditionalInfoItem("Responsible",{label:{type:"label",text:"Responsible"},field:{type:"property.responsible"}}),this.registerAdditionalInfoItem("IsPrivate",{label:{type:"label",text:"Private?"},field:{type:"property.isPrivate"}}),this.registerAdditionalInfoItem("LastFailureComment",{label:{type:"label",text:"Last Failure Comment"},field:{type:"property.lastFailureComment"}}),this.registerAdditionalInfoItem("Release",{label:{type:"label",text:this.getTermName("Release")},field:{type:"property.release"},practices:["Planning"]}),this.registerAdditionalInfoItem("ImpedimentDate",{label:{type:"label",text:"Creation Date"},field:{type:"property.impedimentDate"}}),this.registerAdditionalInfoItem("CreationDate",{label:{type:"label",text:"Creation Date"},field:{type:"property.createDate"}}),this.registerAdditionalInfoItem("FinishDate",{label:{type:"label",text:"Finish  Date"},field:{type:"property.completeDate",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{type:"label",text:"Start Date"},field:{type:"property.startDate",editable:!0}}),this.registerAdditionalInfoItem("ResolvedOn",{label:{type:"label",text:"Resolved On"},field:{type:"property.completeDate"}}),this.registerAdditionalInfoItem("CompletionDate",{label:{type:"label",text:"Completion  Date"},field:{type:"property.completeDate"}}),this.registerAdditionalInfoItem("Iteration",{label:{type:"label",text:this.getTermName("Iteration")},field:{type:"property.iteration"},practices:["Iterations"]}),this.registerAdditionalInfoItem("Project",{label:{type:"label",text:this.getTermName("Project")},field:{type:"property.project"}}),this.registerAdditionalInfoItem("Priority",{label:{type:"label",text:this.getTermName("Priority")},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Business Value",{label:{type:"label",text:"Business Value"},field:{type:"property.priority"},practices:["Planning"]}),this.registerAdditionalInfoItem("Initial Estimate",{label:{type:"label",text:"Initial Estimate"},field:{type:"property.initialEstimate"},practices:["Planning"]}),this.registerAdditionalInfoItem("Feature",{label:{type:"label",text:this.getTermName("Feature")},field:{type:"property.feature"},practices:["Requirements"]}),this.registerAdditionalInfoItem("User Story",{label:{type:"label",text:this.getTermName("userStory")},field:{type:"property.userStory"}}),this.registerAdditionalInfoItem("Assignable",{label:{type:"label",text:this.getTermName("Assignable")},field:{type:"property.assignable"}}),this.registerAdditionalInfoItem("Build",{label:{type:"label",text:this.getTermName("build")},field:{type:"property.build"}}),this.registerAdditionalInfoItem("Last Status",{label:{type:"label",text:"Last Status"},field:{type:"property.lastStatus"}}),this.registerAdditionalInfoItem("Last Run Date",{label:{type:"label",text:"Last Run Date"},field:{type:"property.lastRunDate"}}),this.registerAdditionalInfoItem("User Story For Task",{label:{type:"label",text:this.getTermName("userStory")},field:{type:"property.userStory",resetDisabled:!0}}),this.registerAdditionalInfoItem("Severity",{label:{type:"label",text:this.getTermName("Severity")},field:{type:"property.severity"},practices:["Planning"]}),this.registerTab("Description",{selected:!0,label:"description",header:[{type:"label",text:"Description"}],items:[{type:"tags"},{type:"container",name:"description container",cssClass:"ui-sub-control",children:[{type:"description"}]},this._buildRichTextCustomFieldsSummary(a),{type:"attachments"},{type:"label",text:"Comments",cssClass:"ui-ctrl-title"},{type:"container",name:"comments container",cssClass:"ui-sub-control",children:[{type:"comments",extensions:[d]}]}]}),this.registerTab("Track",{label:"track",header:[{type:"label",text:"Track"}],items:[{type:"audit.history",stateName:"audit",editions:["~board"]}],printable:!1}),this.registerTab("Flow",{label:"implementationHistory",printable:!1,header:[{type:"label",text:"Flow"}],items:[{type:"implementationHistory"}]}),this.registerPanel("Additional Info",{type:"collapsible",name:"additional info container",collapsed:!1,stateName:"additionalInfo",header:[{type:"label",text:"Info"}],items:[{type:"additionalInfo",children:this.getAdditionalInfoItems(a)}]}),this.registerPanel("Lead Cycle Time",{type:"collapsible",name:"Lead Cycle Time",stateName:"leadTime",collapsed:!1,header:[{type:"label",text:"Lead Cycle Time"}],items:[{type:"leadCycleTime"}]});var g=this._buildCustomFieldsSummary(a);g.length&&this.registerPanel("Custom Fields",{type:"collapsible",name:"custom fields collapsible",collapsed:!1,stateName:"customFields",header:[{type:"label",text:"Custom Fields"}],items:g}),window.appIsInDebugMode===!0&&this.registerPanel("Diagnostic",{type:"collapsible",name:"diagnostics container",printable:!1,collapsed:!0,header:[{type:"diagnostics"}],items:[{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Global Bus Listeners"}],items:[{type:"diagnostics.globalListeners"}]},{type:"collapsible",collapsed:!0,header:[{type:"label",text:"Store Listeners"}],items:[{type:"diagnostics.store"}]}]}),this.registerPanel("Look Switcher",{type:"lookswitcher",printable:!1})},getCollection:function(a){var b={};return a in this.collections||(this.collections[a]={}),b=this.collections[a],b},addToCollection:function(a,b,c){var d=this.getCollection(a);return d[b]=c,this},registerAction:function(a,b){this.addToCollection("actions",a,b)},getActions:function(a){var b=this.getActionsAliases(),c=this.getCollection("actions"),d=[];return _.forEach(b,function(a){a in c?d.push(c[a]):d.push({label:"--"+a,command:function(){alert("Still working on it")}})}),d},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},registerAdditionalInfoItem:function(a,b){b.field&&_.defaults(b.field,{name:a+" "+b.field.type}),b.label&&_.defaults(b.label,{name:a+" "+b.label.type}),this.addToCollection("additionalInfo",a,b)},getAdditionalInfoItems:function(a){var b=this.getAdditionalInfoAliases(),c=this.getCollection("additionalInfo"),d=[];return _.forEach(b,function(a){a in c&&d.push(c[a])}),d},getAdditionalInfoAliases:function(){return[]},registerTab:function(a,b){this.addToCollection("tabs",a,b)},getTabs:function(a){var b=this.getTabsAliases(),c=this.getCollection("tabs"),d=[];return _.forEach(b,function(a){a in c&&d.push(c[a])}),d},getTabsAliases:function(){return["Description"]},registerPanel:function(a,b){this.addToCollection("panels",a,b)},getPanels:function(a){var b=this.getPanelsAliases(),c=this.getCollection("panels"),d=[],e=this;return _.forEach(b,function(b){b in c&&(b=="Additional Info"&&(c[b].items[0].children=e.getAdditionalInfoItems(a)),d.push(c[b]))}),d},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Additional Info","Custom Fields"]},_buildCustomFieldsSummary:function(a){var b=a.context,c=b.getCustomFields(),d=b.entity.entityType.name.toLowerCase(),e=_(c).select(function(a){return d===a.entityKind.toLowerCase()&&a.type.toLowerCase()!=="richtext"}),f=[];for(var g=0;g<e.length;g++){var h=e[g],i=h.type.toLowerCase();i==="multipleselectionlist"&&(i="multiselect"),f.push({type:"customField."+i,customField:h})}return f},_buildRichTextCustomFieldsSummary:function(a){var b=a.context,c=b.getCustomFields(),d=b.entity.entityType.name.toLowerCase(),e=_(c).select(function(a){return d===a.entityKind.toLowerCase()&&a.type.toLowerCase()==="richtext"}),f={type:"container",name:"custom fields container",visible:e.length>0,children:[]};for(var g=0;g<e.length;g++){var h=e[g];f.children.push({type:"label",text:h.name,cssClass:"ui-ctrl-title"}),f.children.push({type:"container",name:"custom field container for "+h.type.toLowerCase(),cssClass:"ui-sub-control",children:[{type:"customField."+h.type.toLowerCase(),customField:h}]})}return f},getNames:function(a){return this.termProcessor.getTerms(a).names},getTermName:function(a){return this.termProcessor.getTerms(a).name},getConfig:function(a){var c=a.context.getTerms();return this.termProcessor=new b(c),{children:[{type:"container",name:"main entity container",layout:"table",cssClass:"main-container",cellsCssClass:["general-info","additional-info"],children:[{type:"container",name:"general info column container",layout:"list",children:[{type:"breadcrumbs"},{type:"title"},{type:"tabs",cssClass:"tau-tabs",stateName:"generalTab",tabs:this.getTabs(a),additionalHeaders:[{type:"menu.actions",items:this.getActions(a)}]}]},{type:"container",name:"additional info column container",layout:"list",children:this.getPanels(a)}]}]}},isIE9:function(){var a=new String("H");a[0]="0";var b=Array.prototype.join.call(a,"-")=="H";return b}});return e}),define("tau/configurations/baseAssignable.container.config",["Underscore","tau/configurations/base.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/ui/extensions/assignmentsList/ui.extension.assignmentsList.overlay","tau/components/extensions/progressBar/extensions.progressBar.refresher"],function(_,a,b,c,d,e){var f=a.extend({init:function(b){a.prototype.init.call(this,b);var e=b.context.entity;this.registerAction("Add Time",{label:"Add "+this.getTermName("Time"),url:c.getAddTimeUrl(e.id),practices:["Time Tracking"]}),this.registerAction("Move to User Story",{label:"Move to Another User Story",command:function(){this.moveOrCopy()},editions:["~board"]}),this.registerAction("Find Duplicate",{label:"Find Duplicate",command:function(){this.markAsDuplicate()},editions:["~board"]}),this.registerAction("Split",{label:"Split",command:function(){this.split()}}),this.registerAction("Add Test Case",{label:"Add "+this.getTermName("testCase"),url:c.getAddTestCaseForUserStoryUrl(e.id),practices:["Test Cases"]}),this.registerAction("Add Bug",{label:"Add "+this.getTermName("bug"),url:c.getAddBugForUserStoryUrl(e.id),practices:["Bug Tracking"]}),this.registerAction("Create Bug",{label:"Create "+this.getTermName("bug"),url:c.getAddBugForRequestUrl(e.id),practices:["Bug Tracking"]}),this.registerAction("Add Task",{label:"Add "+this.getTermName("task"),url:c.getAddTaskForUserStoryUrl(e.id)}),this.registerAction("Create Task",{label:"Create "+this.getTermName("task"),url:c.getAddTaskForRequestUrl(e.id)}),this.registerAction("Create User Story",{label:"Create "+this.getTermName("userStory"),url:c.getAddUserStoryForRequestUrl(e.id)}),this.registerAction("Create Feature",{label:"Create "+this.getTermName("feature"),url:c.getAddFeatureForRequestUrl(e.id),practices:["Requirements"]}),this.registerTab("Track",{label:"track",header:[{type:"label",text:"Track"}],items:[{type:"collapsible",printable:!1,name:"audit history collapsible",stateName:"audit",collapsed:!0,header:[{type:"label",text:"Audit history"}],items:[{type:"audit.history"}],editions:["~board"]},{type:"collapsible",name:"time list collapsible",stateName:"times",collapsed:!1,header:[{type:"label",text:"Time records"}],items:[{type:"timeList"}],practices:["Time Tracking"]}]}),this.registerTab("Source",{label:"source",header:[{type:"label",text:"Source",practices:["Source Control"]}],items:[{type:"revisionList",practices:["Source Control"]}]}),this.registerPanel("Progress Bar",{type:"progressBar"}),this.registerPanel("Impediments",{type:"impedimentListPanel",stateName:"impediments"}),this.registerPanel("Assignments",{type:"collapsible",stateName:"assignments",collapsed:!1,header:[{type:"label",text:"Assignments"}],items:[{type:"assignmentsList",extensions:[d]}]})},getActionsAliases:function(){return["Add Time","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Release","Iteration"]},getTabsAliases:function(){return["Description","Track","Source","Flow"]},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Impediments","Assignments","Additional Info","Custom Fields"]}});return f}),define("tau/configurations/baseContainable.container.config",["tau/configurations/base.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder"],function(a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add Iteration",{label:"Add "+this.getTermName("Iteration"),url:c.getAddIterationForReleaseUrl(d.id),practices:["Iterations"]})}});return d}),define("tau/configurations/impediment.container.config",["tau/configurations/baseContainable.container.config"],function(a){var b=a.extend({getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","Track"]},getAdditionalInfoAliases:function(){return["State","ImpedimentDate","ResolvedOn","Business Value","Assignable","Owner","Responsible","IsPrivate"]}});return b}),define("tau/models/dataProviders/model.provider.items.base",["Underscore","tau/core/class","tau/models/dataprocessor/model.processor.assignments","tau/models/dataprocessor/model.processor.importance","tau/utils/utils.urlBuilder"],function(_,a,b,c,d){return a.extend({init:function(a){this.config=a},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority"]},{roleEfforts:["id",{role:["id","name"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}],b},_processAssignments:function(a){var c=b.getAssignments(a);return _.forEach(c.groups,function(a){_.forEach(a.users,function(a){a.avatarUrl=d.getAvatarUrl(a.id,24)})}),c},_processTags:function(a){return a.tags?_.isArray(a.tags)?a.tags:a.tags.toString().split(", "):[]},_calculateEffortToMaximum:function(a){if(a.length==0)return a;var b=_.max(a,function(a){return a.effort.total}),c=b.effort.total;return _.forEach(a,function(b){b.effort.percentFromCount=a.length,b.effort.percentFromMaximum=c==0?0:Math.round(b.effort.total/c*100)}),a},_convertData:function(a){var b=a,c=[],d=this;return _.forEach(b,function(a){c.push(d._convertItem(a))}),c},_convertItem:function(a){var b={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a)};return b.severity={id:a.severity.id,name:a.severity.name},b},_getEffortData:function(a){var b={};return b.estimated=a.effort,b.spent=a.effortCompleted,b.remain=a.effortToDo,b.total=b.spent+b.remain,b.percentComplete=b.total===0?0:Math.round(b.spent/b.total*100),b.percentFromMaximum=0,b.timeSpent=Math.round(a.timeSpent*100)/100,b.timeRemain=Math.round(a.timeRemain*100)/100,b.unit=this.config.context.getEffortPoint(a.__type),b},_getAssignedEffort:function(a){var b={},c=0,d=0,e=function(a){c+=a.effortToDo,d+=a.effortCompleted};return _.each(a.userStories,e),_.each(a.bugs,e),b.value=Math.round((c+d)*100)/100,b.unit=this.config.context.getEffortPoint(a.__type),b},_getVelocityData:function(a){var b={};return b.value=a.velocity,b.unit=this.config.context.getEffortPoint(a.__type),b},_fetch:function(a,b,d,e){var f=this.config.context,g=f.entity.entityType.name,h=f.entity.id,i=f.applicationContext.processes[0].practices,j=_.pluck(i,"name"),k=this.config.store,l=this._createDetailCommand(a),m={id:h,nested:!0,fields:[l]},n=this,o=function(c){var d=c[0].data[a];_.map(d,function(a){a.__type=b});var f=n._convertData(d);e(f)};d&&(k=k.get(d,{fields:["id","importance"]}),o=function(d){var f=_(d[0].data).pluck("importance"),g=_.min(f),h=_.max(f);n.importanceProcessor=new c(g,h);var i=d[1].data[a];_.map(i,function(a){a.__type=b});var j=n._convertData(i);e(j)}),k=k.get(g,m),k.done({success:o,scope:n})},_sortByPriority:function(a){return _.sortBy(a,function(a){var b=a.numericPriority||0;return a.entityState.isFinal===!0&&(b+=100500),b})},changePriority:function(a,b,c,d){var e=this.config.store;e.evictProperties(a.id,a.__type,["numericPriority"]);var f=[];f.push(function(d){e.save("prioritizer",{id:a.id,$set:{beforeId:c.id,afterId:b.id}}).done({success:function(){d(null,arguments)}})}),f.push(function(b){e.get(a.__type,{id:a.id,fields:["id","numericPriority"]}).done({success:function(a){b(null,a[0].data)}})}),_.series(f,function(a,b){_.isFunction(d)&&d.call(null,{changed:b[1]})})}})}),define("tau/models/dataProviders/model.provider.items.bugs",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("bugs","bug","severity",a)},_createDetailCommand:function(a){var b={};b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{severity:["id","name","importance"]}];var c={project:["id"]};return this.config.multiprojects&&c.project.push("abbreviation"),b[a].push(c),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&b[a].push({iteration:["id","name"]}),b},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),severity:{id:a.severity.id,name:a.severity.name,kind:b.importanceProcessor.getKind(a.severity.importance)},projectId:a.project.id,entitiesCount:0};return this.config.multiprojects&&(c.project={id:a.project.id,abbreviation:a.project.abbreviation}),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&(c.iteration={id:a.iteration?a.iteration.id:null,name:a.iteration?a.iteration.name:null}),c}})}),define("tau/models/dataProviders/model.provider.items.tasks",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("tasks","task","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{userStory:["id"]},{entityState:["id","name","isInitial","isFinal","numericPriority"]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{priority:["id","name","importance"]},{project:["id"]}],b},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),priority:null,projectId:a.project.id,entitiesCount:0};return c}})}),define("tau/models/dataProviders/model.provider.items.tasks_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.bugs","tau/models/dataProviders/model.provider.items.tasks"],function(_,a,b,c){return a.extend({init:function(a){this.config=a,this.providers=[new c(a)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new b(a))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(a){var b=this,c=function(c){var d=b._convertData(c);a(d)},d=[];_.forEach(b.providers,function(a){d.push(function(b){a.fetch(function(a){b(null,a)})})}),_.parallel(d,function(a,b){var d=_.flatten(b);c(d)})}})}),define("tau/models/dataProviders/userstory/userstory.model.provider.tasks.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("tasks","task","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{userStory:["id"]},{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{priority:["id","name","importance"]},{project:["id"]}],b},_convertData:function(a){return a=this._super(a),a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),priority:null,projectId:a.project.id,entitiesCount:0};return c.visibleEntityState=c.entityState,c}})}),define("tau/models/dataProviders/userstory/userstory.model.provider.bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("bugs","bug","severity",a)},_createDetailCommand:function(a){var b={};b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{severity:["id","name","importance"]}];var c={project:["id"]};return this.config.multiprojects&&c.project.push("abbreviation"),b[a].push(c),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&b[a].push({iteration:["id","name"]}),b},_convertData:function(a){return a=this._super(a),a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),severity:{id:a.severity.id,name:a.severity.name,kind:b.importanceProcessor.getKind(a.severity.importance)},projectId:a.project.id,entitiesCount:0};return c.visibleEntityState=c.entityState,this.config.multiprojects&&(c.project={id:a.project.id,abbreviation:a.project.abbreviation}),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&(c.iteration={id:a.iteration?a.iteration.id:null,name:a.iteration?a.iteration.name:null}),c}})}),define("tau/models/dataProviders/request/request.model.provider.related_entities.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a){var b=_.bind(function(b){this._loadFull(b,a)},this);this._fetch("relatedEntities","bug",null,b)},_loadFull:function(a,b){var c=_.pluck(this.config.context.getPractices(),"name"),d=this.config.store,e=[];_.forEach(a,function(a){var b=a.__type.toLowerCase(),f=["id",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]}];f.push({release:["id","name"]}),_.indexOf(c,"Iterations")!=-1&&f.push({iteration:["id","name"]}),b.toLowerCase()=="userstory"&&f.push({tasks:["id"]}),e.push(function(c){d.get(b,{id:a.id,fields:f}).done({success:function(b){a=_.extend(a,b[0].data),c(null,a)}})})}),_.series(e,function(a,c){b(c)})},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","endDate",{entityType:["id","name"]}],b},_convertItem:function(a){var c=this,d={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.entityType.name,endDate:b.format.date.short(a.endDate),tags:[]};return d}})}),define("tau/models/dataProviders/model.provider.items.user_stories",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("userStories","userStory","priority",a)},fetchForGroup:function(a,b){var c=this.config.context,d=c.entity.entityType.name,e=c.entity.id,f=c.applicationContext.processes[0].practices,g=_.pluck(f,"name"),h=this.config.store,i="userStories",j="userStory",k=this._createDetailCommand(i),l={id:e,nested:!0,fields:[k]};h=h.get(d,l);var m=this,n=function(c){var d=_(c).pluck("data")[0][i];_.map(d,function(a){a.__type=j}),d=_.filter(d,function(b){return b.entityState.name==a.key});var e=m._convertData(d);b(e)};h.done({success:n,scope:m})},_createDetailCommand:function(a){var b={};b[a]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{feature:["id"]},{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]}];var c={project:["id"]};return this.config.multiprojects&&c.project.push("abbreviation"),b[a].push(c),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&b[a].push({iteration:["id","name"]}),b},_convertData:function(b){return b=a.prototype._convertData.call(this,b),b=this._calculateEffortToMaximum(b),this._sortByPriority(b)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,__type:a.__type,numericPriority:a.numericPriority,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),priority:{id:a.priority.id,name:a.priority.name,kind:b.importanceProcessor.getKind(a.priority.importance)},effort:this._getEffortData(a),assignments:this._processAssignments(a),projectId:a.project.id,entitiesCount:a["tasks-count"]};return this.config.multiprojects&&(c.project={id:a.project.id,abbreviation:a.project.abbreviation}),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&(c.iteration={id:a.iteration?a.iteration.id:null,name:a.iteration?a.iteration.name:null}),c}})}),define("tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(_,a,b,c){return a.extend({init:function(a){this.config=a,this.providers=[new b(a)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new c(a))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(a){var b=this,c=function(c){var d=b._convertData(c);a(d)},d=[];_.forEach(b.providers,function(a){d.push(function(b){a.fetch(function(a){b(null,a)})})}),_.parallel(d,function(a,b){var d=_.flatten(b);c(d)})}})}),define("tau/models/dataProviders/release/release.model.provider.bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("bugs","bug","severity",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{severity:["id","name","importance"]},{project:["id"]}],b},_convertData:function(a){return a=this._super(a),a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),severity:{id:a.severity.id,name:a.severity.name,kind:b.importanceProcessor.getKind(a.severity.importance)},projectId:a.project.id,entitiesCount:0};return c.visibleEntityState=c.entityState,c}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("userStories","userStory","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{project:["id"]}],b},_convertData:function(b){return b=a.prototype._convertData.call(this,b),b=this._calculateEffortToMaximum(b),this._sortByPriority(b)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,__type:a.__type,numericPriority:a.numericPriority,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),priority:{id:a.priority.id,name:a.priority.name,kind:b.importanceProcessor.getKind(a.priority.importance)},effort:this._getEffortData(a),assignments:this._processAssignments(a),projectId:a.project.id,entitiesCount:a["tasks-count"]};return c.visibleEntityState=c.entityState,c}})}),define("tau/models/dataProviders/feature/feature.model.provider.user_stories.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("userStories","userStory","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{project:["abbreviation"]},{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{project:["id"]}],b},_convertData:function(b){return b=a.prototype._convertData.call(this,b),b=this._calculateEffortToMaximum(b),this._sortByPriority(b)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,__type:a.__type,numericPriority:a.numericPriority,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),priority:{id:a.priority.id,name:a.priority.name,kind:b.importanceProcessor.getKind(a.priority.importance)},effort:this._getEffortData(a),assignments:this._processAssignments(a),projectId:a.project.id,project:{abbreviation:a.project.abbreviation},entitiesCount:a["tasks-count"]};return c.visibleEntityState=c.entityState,c}})}),define("tau/models/dataProviders/model.provider.items.user_stories_bugs",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(_,a,b,c){return a.extend({init:function(a){this.config=a,this.providers=[new b(a)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new c(a))},_convertData:function(a){return a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},fetch:function(a){var b=this,c=function(c){var d=b._convertData(c);a(d)},d=[];_.forEach(b.providers,function(a){d.push(function(b){a.fetch(function(a){b(null,a)})})}),_.parallel(d,function(a,b){var d=_.flatten(b);c(d)})}})}),define("tau/models/dataProviders/release/release.model.provider.iterations.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(_,a,b,c){return a.extend({init:function(a){this.config=a,a.additionalFields=["iteration"],this.providers=[new b(a)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new c(a))},_convertData:function(b){return b=a.prototype._convertData.call(this,b),_.forEach(b,function(a){a.visibleEntityState=a.entityState}),this._sortByPriority(b)}})}),define("tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items",["Underscore","tau/models/dataProviders/model.provider.items.user_stories_bugs","tau/models/dataProviders/model.provider.items.user_stories","tau/models/dataProviders/model.provider.items.bugs"],function(_,a,b,c){return a.extend({init:function(a){this.config=a,a.additionalFields=["iteration"],this.providers=[new b(a)],this.config.context.isPracticeAvailable("Bug Tracking")&&this.providers.push(new c(a))},_convertData:function(b){var c=a.prototype._convertData.call(this,b);return this._sortByPriority(c)}})}),define("tau/models/dataProviders/release/release.model.provider.features.items",["Underscore","tau/models/dataProviders/model.provider.items.base"],function(_,a){return a.extend({fetch:function(a){this._fetch("features","feature","severity",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{owner:["id","firstName","lastName"]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{priority:["id","name","importance"]},{project:["id"]}],b},_convertData:function(a){return a=this._super(a),a=this._calculateEffortToMaximum(a),this._sortByPriority(a)},_convertItem:function(a){var b=this,c={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},tags:this._processTags(a),effort:this._getEffortData(a),assignments:this._processAssignments(a),priority:{id:a.priority.id,name:a.priority.name,kind:b.importanceProcessor.getKind(a.priority.importance)},projectId:a.project.id,entitiesCount:0};return c.visibleEntityState=c.entityState,c}})}),define("tau/configurations/release.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/models/dataProviders/release/release.model.provider.iterations.items","tau/models/dataProviders/release/release.model.provider.iterations.groups","tau/ui/extensions/list/iterations/extension.list.release_iterations","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.items","tau/models/dataProviders/release/release.model.provider.user_stories_bugs.groups","tau/models/dataProviders/release/release.model.provider.features.items","tau/models/dataProviders/release/release.model.provider.bugs.items","tau/models/dataProviders/release/release.model.provider.user_stories.items","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/external.refresh.extension"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=a.extend({init:function(a){this._super(a),this.registerPanel("Progress Bar",{type:"release.progressBar"}),this.registerTab("Iterations",{practices:["Iterations"],label:"iterations",header:[{type:"label",text:this.getNames("iteration"),countFieldNames:["iterations"]}],items:[{practices:["Iterations"],type:"list",itemsDataProvider:c,groupsDataProvider:d,groupBy:"iteration.id",extensions:[e],views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]});var b=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:b.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"quick.add",printable:!1,property:"release",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+b.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],itemsDataProvider:j,views:[{type:"grid.entity"}],extensions:[k]}]}),this.registerTab("Bugs",{practices:["Bug Tracking"],label:"bugs",header:[{type:"label",text:b.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"quick.add",printable:!1,property:"release",entityType:"bug",evictProperties:["bugs","bugs-count"],label:"Add "+b.getNames("Bug"),practices:["Bug Tracking"]},{type:"list.editable",itemsDataProvider:i,externalRefreshEvents:["bug.items.added"],views:[{type:"grid.entity"}],practices:["Bug Tracking"],extensions:[k]}]}),this.registerTab("Features",{practices:["Requirements"],label:"features",header:[{type:"label",text:b.getNames("feature"),countFieldNames:["features"]}],items:[{type:"quick.add",printable:!1,property:"release",entityType:"feature",evictProperties:["features","features-count"],label:"Add "+b.getNames("Feature"),practices:["Requirements"]},{practices:["Requirements"],type:"list.editable",externalRefreshEvents:["feature.items.added"],itemsDataProvider:h,views:[{type:"grid.entity"}]}]}),this.registerTab("Release Notes",{label:"notes",header:[{type:"label",text:"Notes"}],items:[{type:"releaseNotes"}]})},getAdditionalInfoAliases:function(){return["StartDate","FinishDate","Release Assigned Effort"]},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Additional Info","Custom Fields"]},getActionsAliases:function(){return["Add Iteration","-----","Old View","Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","Iterations","User Stories","Bugs","Features","Release Notes","Track"]}});return m}),define("tau/models/dataProviders/project/project.model.provider.releases.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a){this._fetch("iterations","iteration",!1,a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","tags","startDate","endDate",{release:["id","name"]},{userStories:["effortToDo","effortCompleted"]},{bugs:["effortToDo","effortCompleted"]}],b},_convertItem:function(a){var c={id:a.id,name:a.name,__type:a.__type,tags:this._processTags(a),release:a.release,assignedEffort:this._getAssignedEffort(a),startDate:b.format.date.short(a.startDate),endDate:b.format.date.short(a.endDate)};return c},_convertData:function(a){return a=this._super(a),this._sortByStartDate(a)},_sortByStartDate:function(a){return _.sortBy(a,function(a){return-1*a.startDate})}})}),define("tau/models/dataProviders/project/project.model.provider.releases_flat.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a){this._fetch("releases","release",!1,a)},_createDetailCommand:function(a){var b={};return b[a]=["id","name","tags","startDate","endDate"],b},_convertItem:function(a){var c=b.parse(a.startDate),d=b.parse(a.endDate),e=!1;Date.today().between(c,d)&&(e=!0);var f={id:a.id,name:a.name+(e?" (current)":""),__type:a.__type,tags:this._processTags(a),startDate:b.format.date.short(a.startDate),endDate:b.format.date.short(a.endDate)};return f},_convertData:function(a){return a=this._super(a),this._sortByStartDate(a)},_sortByStartDate:function(a){return _.sortBy(a,function(a){return-1*a.startDate})}})}),define("tau/models/dataProviders/request/request.model.provider.requesters.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date","tau/utils/utils.urlBuilder"],function(_,a,b,c){return a.extend({fetch:function(a){this._fetch("requesters","user",null,a)},_convertData:function(a){return a=this._super(a),_.reject(a,function(a){return a.deleteDate!=null})},_createDetailCommand:function(a){var b={};return b[a]=["id","firstName","lastName","deleteDate","email","login","kind"],b},_convertItem:function(a){var d=this,e={id:a.id,firstName:a.firstName,lastName:a.lastName,deleteDate:a.deleteDate,login:a.login,email:a.email,endDate:b.format.date.short(a.endDate),avatar:c.getAvatarUrl(a.id,32),url:c.getUserUrl(a.id,a.kind)};return e}})}),define("tau/configurations/request.container.config",["tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/models/dataProviders/request/request.model.provider.related_entities.items","tau/ui/extensions/list/request/extension.related_entities.action.detach","tau/models/dataProviders/request/request.model.provider.requesters.items","tau/ui/extensions/list/testplan/extension.list.editableCells","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/request/extension.requesters.action.add","tau/ui/extensions/list/request/extension.requesters.action.detach"],function(a,b,c,d,e,f,g,h,i){var j=a.extend({init:function(a){this._super(a),this.registerAdditionalInfoItem("Owner",{label:{type:"label",text:"Owner"},field:{type:"property.owner.request"}}),this.registerAdditionalInfoItem("RequestType",{label:{type:"label",text:this.getTermName("RequestType")},field:{type:"property.requestType"}}),this.registerAdditionalInfoItem("Source",{label:{type:"label",text:"Source"},field:{type:"property.requestSource"}}),this.registerTab("Related Entities",{label:"related_entities",header:[{type:"label",text:"Related Entities",countFieldNames:["relatedEntities"]}],items:[{type:"list.editable",sortable:!1,itemsDataProvider:c,views:[{rowTemplateName:"list-grid-entity__row_related_entity",type:"grid.entity"}],extensions:[d,f,g]}]}),this.registerTab("Requesters",{label:"requesters",header:[{type:"label",text:"Requesters",countFieldNames:["requesters"]}],items:[{type:"list",sortable:!1,itemsDataProvider:e,extensions:[h,i],views:[{rowTemplateName:"list-grid-entity__row_requester",type:"grid.entity.requesters"}]}]})},getTabsAliases:function(){return["Description","Related Entities","Requesters","Track","Flow"]},getAdditionalInfoAliases:function(){return["Owner","Business Value","IsPrivate","RequestType","Source","CreationDate","CompletionDate"]},getActionsAliases:function(){return["Add Time","Create Bug","Create User Story","Create Task","Create Feature","Move or Copy","-----","Old View","Old Edit","Print","-----","Delete"]}});return j}),define("tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.urlBuilder","tau/core/termProcessor"],function(_,$,a,b,c){return a.extend({"bus afterRender+permissionsReady+dataBind":function(a){if(a.permissionsReady.data.editable){var d=a.dataBind.data,e=a.afterRender.data.element,f=this.config.context.getTerms(),g=new c(f),h=e.find(".tau-add-testCase"),i=$('<a class="tau-add-testCase">Add '+g.getTerms("TestCase").names+"</a>");i.attr("href",b.getAddTestCaseForTestPlanRunUrl(this.config.context.entity.id)),i.text(h.text()),h.replaceWith(i)}}})}),define("tau/configurations/iteration.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.items","tau/models/dataProviders/iteration/iteration.model.provider.user_stories_bugs.groups","tau/ui/extensions/list/external.refresh.extension","tau/models/dataProviders/release/release.model.provider.bugs.items","tau/models/dataProviders/release/release.model.provider.user_stories.items","tau/ui/extensions/list/request/extension.list.entityState"],function(a,b,c,d,e,f,g,h,i){var j=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add User Story",{label:"Add "+this.getTermName("userStory"),url:c.getAddUserStoryForIterationUrl(d.id)}),this.registerPanel("Progress Bar",{type:"iteration.progressBar"});var e=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:e.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"quick.add",property:"iteration",entityType:"userStory",evictProperties:["userStories","userStories-count"],label:"Add "+e.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],itemsDataProvider:h,views:[{type:"grid.entity"}],extensions:[i]}]}),this.registerTab("Bugs",{practices:["Bug Tracking"],label:"bugs",header:[{type:"label",text:e.getNames("bug"),countFieldNames:["bugs"]}],items:[{type:"quick.add",property:"iteration",entityType:"bug",practices:["Bug Tracking"],evictProperties:["bugs","bugs-count"],label:"Add "+e.getNames("Bug")},{type:"list.editable",practices:["Bug Tracking"],itemsDataProvider:g,views:[{type:"grid.entity"}],externalRefreshEvents:["bug.items.added"],extensions:[i]}]})},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Additional Info","Custom Fields"]},getActionsAliases:function(){return["Add User Story","-----","Old View","Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","User Stories","Bugs","Track"]},getAdditionalInfoAliases:function(){return["StartDate","FinishDate","Release","Velocity","Assigned Effort"]}});return j}),define("tau/configurations/build.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder"],function(a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b);var c=b.context.entity;this.registerAdditionalInfoItem("BuildDate",{label:{type:"label",text:"Build Date"},field:{type:"property.buildDate",editable:!0}})},getTabsAliases:function(){return["Description","Track"]},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Owner","BuildDate","Release","Iteration"]}});return d}),define("tau/configurations/project.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/models/dataProviders/project/project.model.provider.releases.items","tau/models/dataProviders/project/project.model.provider.releases.groups","tau/ui/extensions/list/extension.list.checkEmpty","tau/models/dataProviders/project/project.model.provider.releases_flat.items"],function(a,b,c,d,e,f,g){var h=a.extend({init:function(b){a.prototype.init.call(this,b);var c=b.context.entity;this.registerAdditionalInfoItem("Owner",{label:{type:"label",text:"Owner"},field:{type:"property.owner.project"}}),this.registerAdditionalInfoItem("Abbreviation",{label:{type:"label",text:"Abbreviation"},field:{type:"property.abbreviation",cssClass:"abbr",editable:!0}}),this.registerAdditionalInfoItem("Reply Email",{label:{type:"label",text:"Reply Email"},field:{type:"property.email",editable:!0}}),this.registerAdditionalInfoItem("IsActive",{label:{type:"label",text:"Active?"},field:{type:"property.isActive",editable:!0}}),this.registerAdditionalInfoItem("IsProduct",{label:{type:"label",text:"Product?"},field:{type:"property.IsProduct",editable:!0}}),this.registerAdditionalInfoItem("Company",{label:{type:"label",text:"Company"},field:{type:"property.company",editable:!0}}),this.registerAdditionalInfoItem("Program",{label:{type:"label",text:"Program"},field:{type:"property.program",editable:!0}}),this.registerAdditionalInfoItem("Process",{label:{type:"label",text:"Process"},field:{type:"property.process",editable:!0}}),this.registerAdditionalInfoItem("StartDate",{label:{type:"label",text:"Start Date"},field:{type:"property.startDate.project",editable:!0}}),this.registerAdditionalInfoItem("EndDate",{label:{type:"label",text:"End Date"},field:{type:"property.endDate.project",editable:!0}});var h=this;this.registerTab("Releases",{practices:["Iterations"],label:"releases",header:[{type:"label",text:h.getNames("release"),countFieldNames:["releases"]}],items:[{practices:["Iterations"],type:"list.editable",itemsDataProvider:d,groupsDataProvider:e,extensions:[f],groupBy:"release.id",sortable:!1,views:[{type:"grid.entity",group:{dataIndex:"id"}}]}]}),this.registerTab("Releases (flat)",{practices:["~Iterations"],label:"releases-flat",header:[{type:"label",text:h.getNames("release"),countFieldNames:["releases"]}],items:[{practices:["~Iterations"],type:"list.editable",itemsDataProvider:g,sortable:!1,views:[{type:"grid.entity"}]}]})},getAdditionalInfoAliases:function(){return["Abbreviation","Owner","IsActive","IsProduct","Program","Company","Process","StartDate","EndDate","Reply Email"]},getActionsAliases:function(){return["Old View","Old Edit","Print","-----","Delete"]},getTabsAliases:function(){return["Description","Releases","Releases (flat)"]},getTabs:function(a){var b=this._super(a);return b[0].items=b[0].items.slice(1),b}});return h}),define("tau/models//model.revisionList",["Underscore","tau/core/model-base","tau/utils/utils.urlBuilder","tau/utils/utils.date","tau/utils/utils.htmlConverter"],function(_,a,b,c,d){return a.extend({retrieveRevisions:function(a){var b=this.store,c=["id","sourceControlId","description","commitDate",{author:["firstName","lastName"]},{revisionFiles:["id","fileName","fileAction"]}];for(var d=0;d<a.length;d++)b=b.get(a[d].type,{id:a[d].id,nested:!0,fields:["id",{revisions:c}]});b.done({success:this.onRevisionsRetrieved,scope:this})},onInit:function(){var a=this,b=a.config.context.entity,c=b.entityType.name,d=b.id,e=[{type:c,id:d}],f=this.store;c.toLowerCase()=="userstory"?f.get(c,{id:d,fields:[{tasks:["id"]}]}).done({success:this.onTasksIdRetrieved,scope:this}):this.retrieveRevisions(e)},onTasksIdRetrieved:function(a){var b=a[0].data,c=[{type:b.__type,id:b.id}];c=c.concat(_.map(b.tasks,function(a){return{id:a.id,type:a.__type}})),this.retrieveRevisions(c)},onRevisionsRetrieved:function(a){var b=_.pluck(a,"data");b=_.pluck(b,"revisions"),b=_.flatten(b),this.bindRevisions(b)},onRevisionIdsRetrieved:function(a){var b=_.clone(a[0].data.revisions);if(a.length>1){var c=_.pluck(a[1].data,"revisions");_.each(c,function(a){b=b.concat(a)})}var d=_.pluck(b,"id")},bindRevisions:function(a){var b={Add:"Added",Delete:"Deleted",Modify:"Modified"};a=_.sortBy(a,function(a){return-a.id}),this.fire("dataBind",{items:_.map(a,function(a){var d=a.author||{firstName:"unknown",lastName:""},e=[d.firstName,d.lastName].join(" ").trim(),f={commitDate:c.format.datetime.short(a.commitDate),author:e,revisionFiles:_.map(a.revisionFiles,function(a){return _.extend(_.clone(a),{fileAction:b[a.fileAction]})})};return _.extend(_.clone(a),f)})})},onEntityRetrieved:function(a){var b=a.data.revisions;this.bindRevisions(b)},"bus evictTestCases":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,["testCases","testCases-count"])}})}),define("tau/models/model.testCaseList",["Underscore","tau/core/model-base","tau/utils/utils.urlBuilder","tau/utils/utils.date","tau/utils/utils.htmlConverter"],function(_,a,b,c,d){function e(a){this.model=a}e.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(a){var b={labelAdd:this.model.config.labelAdd||"Add",items:[]};this.model.assignable=a.data;var c=_.sortBy(a.data.testCases,function(a){return a.numericPriority}),d=c.length;for(var e=0;e<d;e++)b.items.push(this.convertServerDataModelData(c[e]));this.model.bus&&this.model.bus.fire("dataBind",b)},convertServerDataModelData:function(a){var e=null;a.lastRunDate&&(e=c.format.datetime.short(a.lastRunDate));var f=undefined;a.lastStatus!=undefined&&(f={isPassed:a.lastStatus});var g={__type:"testCase",id:a.id,name:a.name,lastRunDate:e,applicationUrl:"#testcase/"+a.id,externalUrl:b.getViewUrl(a.id),steps:d.fromSourceToHtml(a.steps),success:d.fromSourceToHtml(a.success)};return f&&(g.lastRunStatus=f),g}};var f=a.extend({onInit:function(){var a=this,b=new e(a),c=a.config.context.entity;this.store.get(c.entityType.name,{id:c.id,fields:["id",{testCases:["id","name","lastRunDate","lastStatus","steps","success","numericPriority"]}]},b.getAssignableRetrievedCallback()).done()},"bus evictTestCases":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,["testCases","testCases-count"])}});return f}),define("tau/models/model.timeList",["Underscore","tau/core/model-base","tau/utils/utils.date","tau/utils/utils.urlBuilder"],function(_,a,b,c){function d(a){return{id:a,fields:["id","name",{times:["id","date","spent","remain","description",{assignable:["id"]},{user:["id","firstName","lastName"]}]}]}}function e(a){var b={id:a,fields:["id",{tasks:["id","name",{times:["id","date","spent","remain","description",{assignable:["id"]},{user:["id","firstName","lastName"]}]}]}],list:!0,nested:!0};return b}function f(a){this.model=a,this.times=[]}f.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},getTaskRetrievedCallbackInfo:function(){return{scope:this,success:this.onTasksRetrieved}},getAllTasksRetrievedCallbackInfo:function(){return{scope:this,success:this.onAllTasksRetrieved}},onAssignableRetrieved:function(a){this.assignable=this.model.assignable=a.data;var b=this.model.assignable,c=b.times;this._addTimesToTimeArray(c,this.assignable)},onTasksRetrieved:function(a){_(a.data.tasks).each(function(a){a.__type="task"});var b=a.data.tasks;for(var c=0;c<b.length;c++)this._addTimesToTimeArray(b[c].times,b[c])},onAllTasksRetrieved:function(){var a={items:this.getTimes()};this.model.bus.fire("dataBind",a)},getTimesSortedByDate:function(){var a=[],c=this.times.length;for(var d=0;d<c;d++){var e=_(this.times[d]).clone();e.date=b.parse(e.date),a.push(e)}return a.sort(function(a,b){var c=b.date-a.date;return c!=0?c:b.id-a.id}),a},getTimes:function(){var a=[],b=this.getTimesSortedByDate(),c=b.length;for(var d=0;d<c;d++)a.push(this.convertServerDataModelData(b[d]));return a},convertServerDataModelData:function(a){var d=a.user;return{id:a.id,date:b.format.date.short(b.convertToTimezone(a.date)),spent:a.spent,remain:a.remain,description:a.description,person:[d.firstName,d.lastName].join(" "),workOn:{__type:a.workOn.__type,name:a.workOn.name},editUrl:c.getEditUrl(a.id,"time")}},_addTimesToTimeArray:function(a,b){var c=[];for(var d=0;d<a.length;d++){var e=_(a[d]).clone();e.workOn=b,c.push(e)}this.times=this.times.concat(c)}};var g=a.extend({isUserStory:function(a){return a.toLowerCase()=="userstory"},onInit:function(){var a=new f(this),b=this.config.context.entity,c=b.id,g=b.entityType.name,h=d(c),i=this.isUserStory(g),j=this.store;j=j.get(g,h,a.getAssignableRetrievedCallback());if(i){var k=e(c);j=j.get(g,k,a.getTaskRetrievedCallbackInfo())}j.done(a.getAllTasksRetrievedCallbackInfo())}});return g}),define("tau/components/component.timeList",["tau/components/component.list.creator","tau/models/model.timeList","tau/models/model.timeList.editable","tau/ui/templates/timeList/ui.template.timeList","tau/components/extensions/timeList/extension.timeList.delete","tau/core/model.editable.base"],function(a,b,c,d,e,f){return{create:function(g){var h={ModelType:b,template:d,extensions:[e,f,c],message:"No time records found"};return a.create(h,g)}}}),define("tau/components/extensions/entity/extension.requestList.remover",["Underscore","tau/core/model-base","tau/models/model.extensions","tau/configurator"],function(_,a,b,c){return a.extend({init:function(a){this._super.apply(this,arguments),this.hideElementIfHelpDeskPracticeIsOff(this.config.context)},hideElementIfHelpDeskPracticeIsOff:function(a){this.store=c.getStore(),a.isPracticeAvailable("Help Desk")<0&&(this.bus.getGlobalBus().on("requestWasAttachedToEntity",this._updateRefresh,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this._updateRefresh,this),this.bus.on("afterRender",this._update,this))},_updateRefresh:function(){var a=this.config.context;this.config.store.evictProperties(a.entity.id,a.entity.entityType.name,["requests-count"]),this._update()},_update:function(){b.calculateRequestsCount.call(this,{callback:function(a){var b=a.count,c=this.$el;b>0?c.show():c.hide()},scope:this})},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this._updateRefresh,this),this._super()},"bus afterRender":function(a){this.$el=a.data.element}})}),define("tau/configurations/task.container.config",["tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover"],function(a,b,c,d){var e=a.extend({init:function(a){this._super(a),this.registerPanel("Requests",{type:"collapsible",stateName:"requests",collapsed:!0,header:[{type:"label",text:this.getNames("request"),countFieldNames:["requests"],extensions:[c]}],items:[{type:"requestList"}],extensions:[d],editions:["Pro"]})},getAdditionalInfoAliases:function(){return["Owner","User Story For Task","CreationDate","CompletionDate"]},getActionsAliases:function(){return["Add Time","Add Impediment","Attach to Request","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Requests","Impediments","Assignments","Additional Info","Custom Fields"]}});return e}),define("tau/configurations/bug.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/requestsList/extension.requestList.refresher","tau/components/extensions/entity/extension.requestList.remover"],function(_,a,b,c,d,e){var f=a.extend({init:function(a){this._super(a),this.registerPanel("Requests",{type:"collapsible",collapsed:!1,stateName:"requests",header:[{type:"label",text:this.getNames("request"),countFieldNames:["requests"],extensions:[c]}],items:[{type:"requestList"}],extensions:[e],editions:["Pro"]}),this.registerPanel("Duplicated Bugs",{type:"duplicateBugListPanel",stateName:"duplicateBug"})},getAdditionalInfoAliases:function(){return _.union(["Owner","Priority","Severity","Release","Iteration","User Story","Build"],!!$.browser.msie&&!this.isIE9()?["CycleTime","LeadTime","CreationDate","CompletionDate"]:[])},getActionsAliases:function(){return["Add Time","Add Impediment","Attach to Request","Move or Copy","Convert","Find Duplicate","-----","Old View","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return _.union(["Look Switcher","Diagnostic","Progress Bar","Requests","Duplicated Bugs","Impediments","Assignments"],!$.browser.msie||this.isIE9()?["Lead Cycle Time"]:[],["Additional Info","Custom Fields"])}});return f}),define("tau/configurations/feature.container.config",["jQuery","tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/feature/feature.model.provider.user_stories.items","tau/models/dataProviders/feature/feature.model.provider.user_stories.groups","tau/ui/extensions/list/external.refresh.extension","tau/ui/extensions/list/request/extension.list.entityState"],function($,a,b,c,d,e,f,g,h,i){var j=a.extend({init:function(b){a.prototype.init.call(this,b);var g=b.context.entity;this.registerAction("Add User Story",{label:"Add "+this.getTermName("userStory"),url:c.getAddUserStoryForFeatureUrl(g.id)}),this.registerPanel("Progress Bar",{type:"progressBar"}),this.registerPanel("Requests",{type:"collapsible",stateName:"requests",collapsed:!0,header:[{type:"label",text:this.getNames("request"),countFieldNames:["requests"],extensions:[d]}],items:[{type:"requestList"}],extensions:[e],editions:["Pro"]}),this.registerPanel("Impediments",{type:"impedimentListPanel"}),this.registerPanel("Total Effort",{type:"feature.totalEffort"}),this.registerPanel("Assignments",{type:"collapsible",collapsed:!1,stateName:"assignments",header:[{type:"label",text:"Assignments"}],items:[{type:"feature.assignmentList"}]});var h=this;this.registerTab("User Stories",{label:"userStories",header:[{type:"label",text:h.getNames("userStory"),countFieldNames:["userStories"]}],items:[{type:"quick.add",printable:!1,property:"feature",entityType:"userStory",evictProperties:["userStories-count"],label:"Add "+this.getNames("UserStory")},{type:"list.editable",externalRefreshEvents:["userStory.items.added"],multiprojects:!0,itemsDataProvider:f,views:[{type:"grid.entity"}],extensions:[i]}]})},getTabsAliases:function(){return["Description","User Stories","Track","Flow"]},getActionsAliases:function(){return["Add User Story","Add Impediment","Attach to Request","Move or Copy","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return _.union(["Look Switcher","Diagnostic","Progress Bar","Requests","Impediments","Total Effort","Assignments"],!$.browser.msie||this.isIE9()?["Lead Cycle Time"]:[],["Additional Info","Custom Fields"])},getAdditionalInfoAliases:function(){return _.union(["Owner","Initial Estimate","Business Value","Release"],!!$.browser.msie&&!this.isIE9()?["CycleTime","LeadTime","CreationDate","CompletionDate"]:[])}});return j}),define("tau/models/dataProviders/userstory/userstory.model.provider.testcases.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date","tau/configurator"],function(_,a,b,c){return a.extend({fetch:function(a){this._fetch("testCases","testCase","priority",a)},_convertData:function(a){return a=this._super(a),_.sortBy(a,function(a){var b=a.numericPriority||0;return b})},_createDetailCommand:function(a){var b={};return b[a]=["id","name","tags","lastStatus","lastRunDate","steps","success","numericPriority"],b},_convertItem:function(a){var c=this,d={id:a.id,__type:a.__type,name:a.name,tags:[],lastStatus:a.lastStatus?"passed":"failed",lastRunDate:b.format.datetime.short(b.convertToTimezone(a.lastRunDate)),steps:a.steps,success:a.success,numericPriority:a.numericPriority};return d}})}),define("tau/ui/extensions/list/testcases/extension.list.testcases.actions",["Underscore","tau/components/extensions/component.extension.base","tau/configurator","tau/utils/utils.date"],function(_,a,b,c){return a.extend({_toggle:function(a,b){var c=a.find(".ui-richeditor:visible");c.length&&c.prev().richeditor("hideEditor"),_.isBoolean(b)?(a.find(".tau-list__itemexpander").toggleClass("tau-list__itemexpander_state_open",b).toggleClass("tau-list__itemexpander_state_closed",!b),a.find(".tau-list__table-additional").toggleClass("tau-list__table-additional_state_open",b).toggleClass("tau-list__table-additional_state_closed",!b)):(a.find(".tau-list__itemexpander").toggleClass("tau-list__itemexpander_state_open").toggleClass("tau-list__itemexpander_state_closed"),a.find(".tau-list__table-additional").toggleClass("tau-list__table-additional_state_open").toggleClass("tau-list__table-additional_state_closed"))},"bus prioritize.start":function(){var a=this.$el.find(".ui-richeditor:visible");a.length&&a.prev().richeditor("hideEditor")},"bus preDataBind":function(a){var b=a.data;b.labelAdd=this.config.labelAdd||"Add"},"bus testCaseWasAdded":function(){this.fire("evictTestCases")},"bus evictTestCases":function(){var a=this.config.context.entity;b.getStore().evictProperties(a.id,a.entityType.name,["testCases","testCases-count"]),this.fire("refresh")},"bus afterRender":function(a){var c=a.data.element;this.$el=c;var d=c.find("[role=item]"),e=this;c.delegate("[role=item-expander-all]","click",function(){e._toggle(d,!0)}),c.delegate("[role=item-collapser-all]","click",function(){e._toggle(d,!1)});var f=b.getStore(),g=function(a,b){f.save("testcase",{id:a.id,$set:{lastStatus:b,lastFailureComment:null},fields:["id","lastStatus","lastRunDate"]}).done({success:function(){}})},h=_.bind(this.addTestCaseClickHandler,this);c.delegate("[role=action-add]","click",function(a){a.preventDefault(),a.stopPropagation(),h()}),c.delegate("[role=item-expander]","click",function(a){var b=$(this),c=b.parents("[role=item]:first");e._toggle(c)}),c.delegate("[role=action-pass]","click",function(a){a.preventDefault(),a.stopPropagation();var b=$(this).parents("[role=item]:first"),c=b.data("tmplItem").data;g(c,!0),e._toggle(b,!1);var d=b.next("[role=item]");d.length&&e._toggle(d,!0)}),c.delegate("[role=action-fail]","click",function(a){a.preventDefault(),a.stopPropagation();var b=$(this).parents("[role=item]:first"),c=b.data("tmplItem").data,d=!1;g(c,d),e._toggle(b,!1);var f=b.next("[role=item]");f.length&&e._toggle(f,!0)})},addTestCaseClickHandler:function(){this.bus.fire("action.add",{entity:this.config.context.entity})}})}),define("tau/ui/extensions/list/testcases/extension.list.testcases.actions.add.userStory",["Underscore","tau/components/extensions/component.extension.base","tau/configurator","tau/utils/utils.date"],function(_,a,b,c){return a.extend({showTestCaseEditor:function(){var a=this.config.context,b=a.assignable.id,c=this;window.processConfigurations||(window.processConfigurations={}),Ext.WindowMgr.zseed=9999999;var d=new Tp.controls.TestCaseCreateEditorWindow({userStoryId:b,processId:a.applicationContext.processes[0].id});d.show(),d.on("saved",function(){c.fire("testCaseWasAdded",{assignable:{id:b}})})},"bus action.add":function(){this.showTestCaseEditor()}})}),define("tau/configurations/userStory.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/requestsList/extensions.requestList.labelRefresher","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher","tau/components/extensions/entity/extension.requestList.remover","tau/models/dataProviders/model.provider.items.tasks_bugs","tau/models/dataProviders/model.provider.groups.tasks_bugs","tau/ui/extensions/list/extension.list.refresher","tau/models/dataProviders/userstory/userstory.model.provider.testcases.items","tau/ui/extensions/list/testcases/extension.list.testcases.actions","tau/ui/extensions/list/testcases/extension.list.testcases.actions.add.userStory","tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase","tau/models/dataProviders/userstory/userstory.model.provider.tasks.items","tau/models/dataProviders/userstory/userstory.model.provider.bugs.items","tau/ui/extensions/list/request/extension.list.entityState","tau/ui/extensions/list/external.refresh.extension"],function(_,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=a.extend({init:function(a){this._super(a);var b=this;this.registerTab("Tasks",{label:"tasks",header:[{type:"label",text:b.getNames("task"),countFieldNames:["tasks"]}],items:[{type:"quick.add",printable:!1,property:"userStory",entityType:"task",evictProperties:["tasks","tasks-count"],label:"Add "+b.getNames("task")},{type:"list.editable",extensions:[i,p],externalRefreshEvents:["task.items.added"],itemsDataProvider:n,multiprojects:!0,views:[{type:"grid.entity"}]}]}),this.registerTab("Bugs",{label:"bugs",practices:["Bug Tracking"],header:[{type:"label",text:b.getNames("bug"),countFieldNames:["bugs"]}],items:[{practices:["Bug Tracking"],type:"quick.add",printable:!1,property:"userStory",entityType:"bug",evictProperties:["bugs","bugs-count"],label:"Add "+b.getNames("bug")},{type:"list.editable",extensions:[i,p],practices:["Bug Tracking"],externalRefreshEvents:["bug.items.added"],itemsDataProvider:o,multiprojects:!0,views:[{type:"grid.entity"}]}]}),this.registerTab("Test Cases",{editions:["~board"],label:"testcases",header:[{type:"label",text:b.getNames("testCase"),countFieldNames:["testCases"],extensions:[e],editions:["~board"]}],items:[{type:"list.editable",itemsDataProvider:j,multiprojects:!0,practices:["Test Cases"],views:[{type:"grid.entity.testcase",rowTemplateName:"list-grid-entity__rowtestcase",emptyMessage:"No test cases found"}],template:m,extensions:[k,l],editions:["~board"]}],practices:["Test Cases"]}),this.registerPanel("Requests",{type:"collapsible",stateName:"requests",collapsed:!0,header:[{type:"label",text:this.getNames("request"),countFieldNames:["requests"],extensions:[d]}],items:[{type:"requestList"}],extensions:[f],editions:["Pro"]})},getTabsAliases:function(){return["Description","Tasks","Bugs","Test Cases","Source","Track","Flow"]},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Requests","Impediments","Assignments",!$.browser.msie||this.isIE9()?["Lead Cycle Time"]:[],"Additional Info","Custom Fields"]},getActionsAliases:function(){return["Split","Add Task","Add Time","Add Bug","Add Test Case","Add Impediment","Attach to Request","Move or Copy","Convert","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return _.union(["Owner","Business Value","Release","Iteration","Feature"],!!$.browser.msie&&!this.isIE9()?["CycleTime","LeadTime","CreationDate","CompletionDate"]:[])}});return r}),define("tau/models/dataProviders/testplanrun/testplanrun.model.provider.testcaseruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/configurator"],function(_,a,b){return a.extend({fetch:function(a){this._fetch("testCaseRuns","testCaseRun","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","passed","executed","runDate",{testCases:["id","name","tags","numericPriority",{priority:["id","name","importance"]}]}],b},_convertData:function(a){return a=this._super(a),a=_.compact(a),_.sortBy(a,function(a){var b=a.testcase.numericPriority||0;return b})},_convertItem:function(a){var b=this;if(a.testCases.length==0)return null;var c=a.testCases[0];c.priority.kind=this.importanceProcessor.getKind(c.priority.importance);var d={id:a.id,__type:a.__type,name:c.name,testcase:{id:c.id,__type:c.__type,name:c.name,tags:this._processTags(c),priority:c.priority,numericPriority:c.numericPriority},passed:a.passed,runDate:a.runDate,executed:a.executed,status:a.passed===!0?"Passed":a.passed===!1?"Failed":"Skipped"};return d}})}),define("tau/configurations/testplanrun.container.config",["Underscore","tau/configurations/baseAssignable.container.config","tau/models/model.extensions","tau/models/dataProviders/testplanrun/testplanrun.model.provider.testcaseruns.items"],function(_,a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b),this.registerAdditionalInfoItem("Build",{label:{type:"label",text:this.getTermName("build")},field:{type:"property.build.testPlanRun"}}),this.registerPanel("Last Run",{type:"collapsible",stateName:"lastRun",collapsed:!1,header:[{type:"label",text:"Last Run"}],items:[{type:"testCasesRunResults"}]}),this.registerTab("Test Case Runs",{label:"testcaseruns",header:[{type:"label",text:this.getNames("testCaseRun"),countFieldNames:["testCaseRuns"]}],items:[{type:"list",itemsDataProvider:c,sortable:!1,views:[{rowTemplateName:"list-grid-entity__rowtestcaserun",type:"grid.entity",emptyMessage:"No items found"}]}],practices:["Test Cases"]})},getAdditionalInfoAliases:function(){return["Test Plan","Build","Release","Iteration","CreationDate","CompletionDate"]},getActionsAliases:function(){return["Add Time","-----","Old View","Old Edit","Print","-----","Delete"]},getPanelsAliases:function(){return["Look Switcher","Diagnostic","Progress Bar","Last Run","Impediments","Assignments","Additional Info","Custom Fields"]},getTabsAliases:function(){return["Description","Test Case Runs","Track","Flow"]},getConfig:function(a){var b=this._super(a),c=_.jsonSelect(b,".additionalHeaders");return c[0][0]={type:"menu.actions.testplanrun",items:c[0][0].items},b}});return d}),define("tau/models/dataProviders/testcase/testcase.model.provider.testcaseruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date","tau/configurator"],function(_,a,b,c){return a.extend({fetch:function(a){this._fetch("testCaseRuns","testCaseRun","priority",a)},_createDetailCommand:function(a){var b={};return b[a]=["id","passed","executed","comment","runDate",{testPlanRun:["id","name","tags","numericPriority",{testPlan:["id","name"]},{priority:["id","name","importance"]},{release:["id","name"]},{iteration:["id","name"]},{build:["id","name"]}]}],b},_convertData:function(a){return a=this._super(a),a=_.compact(a),_.sortBy(a,function(a){return a.runDateReal}).reverse()},_convertItem:function(a){var c=this;if(a.runDate==null)return null;if(a.passed===null)return null;var d=a.testPlanRun,e=d.testPlan,f={id:a.id,__type:a.__type,name:e.name,testplan:e,comment:a.comment,testplanrun:{id:d.id,__type:d.__type,name:d.name},release:d.release,iteration:d.iteration,build:d.build,passed:a.passed,runDate:b.format.datetime.short(b.convertToTimezone(a.runDate)),runDateReal:a.runDate,executed:a.executed,status:a.passed===!0?"Passed":a.passed===!1?"Failed":"Skipped"};return f}})}),define("tau/configurations/testcase.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/models/dataProviders/testcase/testcase.model.provider.testcaseruns.items"],function(a,b,c){var d=a.extend({init:function(b){a.prototype.init.call(this,b),this.registerTab("Test Case Runs",{label:"testcaseruns",header:[{type:"label",text:"Runs"}],items:[{type:"list",itemsDataProvider:c,sortable:!1,views:[{rowTemplateName:"list-grid-entity__rowtestcaserun_testcase",type:"grid.entity",emptyMessage:"No items found"}]}],practices:["Test Cases"]})},getTabs:function(){var a=this._super.apply(this,arguments);return a[0].items[1].children=[{type:"container",layout:"table",cssClass:"test-case-description",cellsCssClass:["steps","success"],children:[{type:"container",children:[{type:"label",text:"Steps"},{type:"steps"}]},{type:"container",children:[{type:"label",text:"Success"},{type:"success"}]}]}],a},getTabsAliases:function(){return["Description","Test Case Runs","Track"]},getActionsAliases:function(){return["Move or Copy","-----","Old View","Old Edit","Print","-----","Delete"]},getAdditionalInfoAliases:function(){return["Business Value","User Story","Owner","CreationDate","Last Status","LastFailureComment","Last Run Date"]}});return d}),define("tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.items",["Underscore","tau/models/dataProviders/model.provider.items.base","tau/configurator"],function(_,a,b){return a.extend({fetch:function(a){this._fetch("testPlanRuns","testPlanRun","severity",a)},_createDetailCommand:function(a){var b={};b[a]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain","passedCount","failedCount","notRunCount","testCaseRuns-count",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:["id","firstName","lastName"]}]},{release:["id","name"]},{iteration:["id","name"]},{build:["id","name"]}];var c={project:["id"]};return this.config.multiprojects&&c.project.push("abbreviation"),b[a].push(c),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&b[a].push({iteration:["id","name"]}),b},_convertData:function(a){return a=this._super(a),_.sortBy(a,function(a){var b=a.numericPriority||0;return b})},_convertItem:function(a){var b=this,c=!0;this.config.context.isPracticeAvailable("Iterations")||(c=!1);var d={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.__type,entityState:{id:a.entityState.id,name:a.entityState.name,isInitial:a.entityState.isInitial,isFinal:a.entityState.isFinal,numericPriority:a.entityState.numericPriority},assignments:this._processAssignments(a),projectId:a.project.id,entitiesCount:0,release:a.release,iteration:a.iteration,build:a.build,passedCount:_.toNumber(a.passedCount)||0,failedCount:_.toNumber(a.failedCount)||0,notRunCount:_.toNumber(a.notRunCount)||0,isAvailableIteration:c,additionalActions:{}};return this.config.multiprojects&&(d.project={id:a.project.id,abbreviation:a.project.abbreviation}),this.config.additionalFields&&_.indexOf(this.config.additionalFields,"iteration")>-1&&(d.iteration={id:a.iteration?a.iteration.id:null,name:a.iteration?a.iteration.name:null}),d}})}),define("tau/models/dataProviders/testplan/testplan.model.provider.testcases.items",["Underscore","tau/models/dataProviders/userstory/userstory.model.provider.testcases.items","tau/utils/utils.date","tau/configurator"],function(_,a,b,c){return a.extend({})}),define("tau/ui/extensions/list/testcases/extension.list.testcases.actions.add.testPlan",["Underscore","tau/components/extensions/component.extension.base","tau/configurator","tau/utils/utils.urlBuilder"],function(_,a,b,c){return a.extend({"bus action.add":function(a){var d=a.data.entity;b.getRouting().redirect(c.getAddTestCaseForTestPlanRunUrl(d.id))}})}),define("tau/configurations/testplan.container.config",["tau/configurations/baseContainable.container.config","tau/models/model.extensions","tau/utils/utils.urlBuilder","tau/components/extensions/testCaseList/extension.testPlanRun.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extensions.testCaseList.labelRefresher","tau/ui/extensions/list/testplan/extension.list.editableCells","tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.items","tau/models/dataProviders/testplan/testplan.model.provider.testplanruns.groups","tau/models/dataProviders/testplan/testplan.model.provider.testcases.items","tau/ui/extensions/list/testcases/extension.list.testcases.actions","tau/ui/extensions/list/testcases/extension.list.testcases.actions.add.testPlan","tau/ui/templates/list_/grid.entity.testcase/ui.template.list.grid.entity.testcase","tau/ui/extensions/list/external.refresh.extension"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=a.extend({init:function(b){a.prototype.init.call(this,b);var d=b.context.entity;this.registerAction("Add Test Plan Run",{label:"Add "+this.getTermName("TestPlanRun"),url:c.getAddTestRunForTestPlanUrl(d.id),practices:["Test Cases"]}),this.registerAction("Assign Test Cases",{label:"Assign "+this.getTermName("TestCase"),url:c.getAssignTestCasesForTestPlanUrl(d.id),practices:["Test Cases"]}),this.registerTab("Test Cases",{label:"testcases",header:[{type:"label",text:this.getNames("testCase"),countFieldNames:["testCases"],extensions:[e]}],items:[{type:"list.editable",itemsDataProvider:i,multiprojects:!0,practices:["Test Cases"],views:[{type:"grid.entity.testcase",rowTemplateName:"list-grid-entity__rowtestcase",emptyMessage:"No test cases found"}],template:l,extensions:[j,k],labelAdd:"Assign"}],practices:["Test Cases"]}),this.registerTab("Test Plan Runs",{label:"testplanruns",header:[{type:"label",text:this.getNames("testPlanRun"),countFieldNames:["testPlanRuns"]}],items:[{type:"quick.add",printable:!1,property:"testPlan",entityType:"testPlanRun",evictProperties:["testPlanRuns-count"],label:"Add "+this.getNames("TestPlanRun")},{type:"list.editable",itemsDataProvider:g,externalRefreshEvents:["testPlanRun.items.added"],groupsDataProvider:h,groupBy:"entityState.name",multiprojects:!0,views:[{rowTemplateName:"list-grid-entity__rowtestplanrun",type:"grid.entity",group:{dataIndex:"name"}}],extensions:[f]}],practices:["Test Cases"]})},getTabsAliases:function(){return["Description","Test Cases","Test Plan Runs","Track"]},getAdditionalInfoAliases:function(){return["Initial Estimate","Owner","CreationDate"]},getActionsAliases:function(){return["Add Test Plan Run","Assign Test Cases","-----","Old View","Old Edit","Print","-----","Delete"]}});return n}),define("tau/configurations/factory.container.config",["Underscore","tau/core/class","tau/core/termProcessor","tau/models/model.extensions","tau/configurations/base.container.config","tau/configurations/baseAssignable.container.config","tau/configurations/baseContainable.container.config","tau/configurations/userStory.container.config","tau/configurations/task.container.config","tau/configurations/bug.container.config","tau/configurations/request.container.config","tau/configurations/testplanrun.container.config","tau/configurations/testcase.container.config","tau/configurations/testplan.container.config","tau/configurations/iteration.container.config","tau/configurations/feature.container.config","tau/configurations/release.container.config","tau/configurations/build.container.config","tau/configurations/impediment.container.config","tau/configurations/project.container.config","tau/configurations/board.container.config","tau/configurations/converters/converter.context"],function(_,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=a.extend({init:function(a,b){this.originalConfigObject=a,this.appConfig=b,this.practices=[],this.editions=[];var c=this.appConfig.context;c&&(this.practices=_(c.getPractices()).pluck("name")),c&&(this.editions=[c.getEdition()])},getConfig:function(){var a=this.originalConfigObject.getConfig(this.appConfig);return u.convert(a,this.practices,this.editions)},getActions:function(){var a=this.originalConfigObject.getActions(this.appConfig.context.applicationContext);return u.convert(a,this.practices,this.editions)}}),w=a.extend({init:function(){this.configs={base:d,userstory:g,task:h,bug:i,request:j,testplanrun:k,testcase:l,testplan:m,iteration:n,feature:o,release:p,build:q,impediment:r,project:s,board:t}},getConfig:function(a){var b=a.context.entity.entityType.name.toLowerCase(),c=this.configs[b]?this.configs[b]:this.configs.base,d=new c(a),e=d.getConfig(a);return e},getContextBasedConfigObject:function(a){var b=a.context.entity.entityType.name.toLowerCase(),c=this.configs[b]?this.configs[b]:this.configs.base,d=new c(a);return new v(d,a)}});return new w}),define("tau/models/entity/actions/model.entity.actions",["Underscore","tau/configurator","tau/core/model-base","tau/configurations/factory.container.config"],function(_,a,b,c){return b.extend({name:"model.entity.actions",onInit:function(){var a=this,b=a.config.context.id;a.fire("permissionsReady",{editable:!0});var d=c.getContextBasedConfigObject(a.config),e=d.getActions();a.fire("dataBind",{items:e})}})}),define("tau/components/component.entity.actions",["tau/components/component.creator","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/models/entity/actions/model.entity.actions","tau/ui/extensions/entity/actions/extension.entity.actions.editable","tau/ui/templates/entity/ui.template.entity.actions"],function(a,b,c,d,e,f){return{create:function(g){var h={extensions:[b,c,d,e],template:f};return a.create(h,g)}}}),define("tau/views/view.entity",["Underscore","tau/core/view-base","tau/components/component.container","tau/configurations/factory.container.config"],function(_,a,b,c){return a.extend({init:function(a){this._super(a),this.config.placeholder&&this.config.placeholder.addClass("ui-entity-view")},"container afterInit":function(a){this.fireAfterInit()},initialize:function(){},"container afterRender":function(a){this.fireBeforeRender(),this.element=a.data.element,this.config.placeholder&&this.config.placeholder.append(this.element),this.config.placeholder&&this.config.placeholder.addClass("tau-entity-loaded"),this.fireAfterRender()},initializeContainer:function(a){this.container.initialize(a)},getStateFields:function(a){var b={};a.hasOwnProperty("stateName")&&(b[a.stateName]=a);var c=this,d=[];if(_.isArray(a.children))d=a.children;else if(_.isArray(a.tabs)){var e=_.pluck(a.tabs,"items");d=_.flatten(e)}return _.each(d,function(a){_.extend(b,c.getStateFields(a))}),b},"bus contextRetrieved":function(a){var d=this,e=a.data;_.extend(e,d.config.containerConfig||c.getConfig(e));var f=this.getStateFields(e);this.container=b.create({name:"entity container",store:this.config.store}),this.container.on("afterInit",this["container afterInit"],this),this.container.on("afterRender",this["container afterRender"],this),d.bus.fire("onConfigContainerCreated",e);if(!_.isEmpty(f)){var g=_.pluck(f,"stateName"),d=this;e.context.componentSettings.get({fields:g,callback:function(a){_.each(f,function(b,c){a.hasOwnProperty(c)&&(f[c][c]=a[c])}),d.initializeContainer(e)}})}else this.initializeContainer(e)},lifeCycleCleanUp:function(){this.destroyContainer(),this._super()},destroyContainer:function(){if(!this.container)return;this.container.destroy(),this.container=null},destroy:function(){this.destroyContainer(),this.container=null,this._super()}})}),define("tau/utils/utils.textConverter",["Underscore","tau/core/class","tau/configurator"],function(_,a,b){var c=a.extend({convert:function(a,b){var c=a;if(b===!0){$node=$("<span></span>");var d=c.split(/\r\n|\r|\n/);for(var e=0;e<d.length;e++)d[e]=$node.text(d[e]).html();c=d.join("\r\n")}return c=c.replace(/([^\r])\n/gi,"$1<br />\n"),c=c.replace(/\r\n/gi,"<br />\r\n"),c=c.replace(/  /gi,"&nbsp;&nbsp;"),c=c.replace(/&nbsp; /gi,"&nbsp;&nbsp;"),c}});return c}),define("tau/ui/extensions/entityStateList/ui.extension.entityStateList.practices.comment",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator","tau/utils/utils.textConverter","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(_,$,a,b,c){var d=a.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,this.dataToBind=a.dataBind.data},"bus focus.before":function(){this.element.find(".ui-entity-state-comment").remove()},"bus updateState":function(a){var b=this.entityStateId=a.data.id,c=_(this.dataToBind.states).detect(function(a){return a.id===b&&a.isCommentRequired});if(!c)return;a.cancel();var d=this.element;if(d.find(".ui-entity-state-comment").length>0){d.find(".ui-state-comment-field").focus();return}var e=d;e.find(".drop-down-list").listSelectable("disable");var f=$("<div class='ui-entity-state-comment'></div>").append($("<div class='ui-state-comment-header'>Please, provide comment</div>")).append($("<div class='ui-state-comment-field-container'></div>").append("<textarea rows='5' class='ui-state-comment-field'></textarea>")).append($("<div class='button-group'></div>").append($("<button type='button' class='save button'>Save</button>").click($.proxy(this._save,this))).append($("<button type='button' class='cancel button'>Cancel</button>").click($.proxy(this._cancel,this)))).appendTo(d),g=f.find(".ui-state-comment-field").focus(),h=f.find(".save"),i=function(){window.setTimeout(function(){var a=g.val()||"",b=a.trim().length===0;b?h.attr("disabled","disabled"):h.attr("disabled")&&h.removeAttr("disabled"),b?h.addClass("disable"):h.removeClass("disable")},50)};i(),h.bind("focus",i),g.bind("change keyup click propertychange paste",i)},_save:function(a){a.stopPropagation();var b=new c,d=this,e=this.element.find(".ui-state-comment-field").val(),f=b.convert(e,!0);d.fire("save",{$set:{entityState:{id:d.entityStateId},comments:[{description:f}]},$include:[{comments:["id","description"]}]})},_cancel:function(a){a.stopPropagation(),this.element.find(".ui-entity-state-comment").remove();var b=this.element.find(".ui-drop-down");b.find(".drop-down-list").listSelectable("enable"),b.show()}});return d}),define("tau/components/component.entityStateList",["tau/components/component.creator","tau/models/propertyLists/model.entityStateList","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/extensions/entityStateList/ui.extension.entityStateList.practices.comment","tau/ui/templates/state/ui.template.state-list"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[d,b,c],template:e};return a.create(g,f)}}}),define("tau/ui/extensions/list/extension.list.prioritize.comment",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.tauBubble","tau/utils/utils.textConverter"],function(_,$,a,b,c){return a.extend({name:"extension.list.prioritize.comment","bus afterRender":function(a){this.$root=a.data.element,this.$el=a.data.element.find("[role=comment-form]")},"bus prioritize.updateGroupsCommentRequirements":function(a){var b=a.data.groups,c=this.$root.find("[role=group]");c.data("isCommentRequired",!1),_.forEach(b,function(a,b){c.eq(b).data("isCommentRequired",a.isCommentRequired)})},"bus prioritize.checkAvailability":function(a){var b=a.data.$targetGroup,c=a.data.$prevGroup;if(!b.data("isCommentRequired")||b[0]===c[0]){this.fire("prioritize.isAvailable.comment");return}var d=a.data.$item;this.$item=d;var e=a.data.item;this.item=e;var f=this.$el;f.removeClass("updating");var g=a.data.isCollapsed,h=!1;g==0?h=d.find("[role=sortable-handler]"):h=b.find("[role=title]"),d.tauBubble({showOnCreation:!0,alignTo:h}),f.detach(),d.tauBubble("widget").find("[role=content]").append(f),f.show(),d.tauBubble("show");var i=f.find("textarea");i.val("").focus();var j=f.find(":button"),k=j.eq(0);k.bind("click",_.bind(this._save,this));var l=j.eq(1);l.bind("click",_.bind(this._cancel,this)),d.bind("externalClose",_.bind(this._cancel,this));var m=function(){window.setTimeout(function(){var a=i.val()||"",b=a.trim().length===0;b?k.attr("disabled","disabled"):k.attr("disabled")&&k.removeAttr("disabled"),b?k.addClass("disable"):k.removeClass("disable")},50)};m(),k.bind("focus",m),i.bind("change keyup click propertychange paste",m)},_save:function(a){a.stopPropagation();var b=this,d=this.$el,e=new c,f=e.convert(d.find("textarea").val(),!0),g=b.config.store,h=b.item;d.addClass("updating"),g.save("comment",{$set:{description:f,general:{id:h.id}},$include:["id","description","createDate","parentId",{owner:["id","firstName","lastName"]}]}).done({success:function(){d.removeClass("updating"),b.fire("prioritize.isAvailable.comment"),b.$item.tauBubble("destroy")},failure:function(){b.fire("prioritize.isNotAvailable")}})},_cancel:function(){var a=this;this.$el.addClass("updating");var b=function(){a.fire("prioritize.isNotAvailable",{$item:a.$item}),a.$item.tauBubble("destroy")};$.fx.off===!0?b():setTimeout(b,50)}})}),define("tau/ui/extensions/finder/ui.extension.finder.simpleSearch",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b,c){return b.extend({"bus afterRender":function(a){var b=a.data.element,c=this,d=$(".filter-field",b),e=function(){d.is(":visible")&&d.focus()};$(".tau-bubble").bind("show",e),c.fire("showHandlerSigned",{handler:e});var f=function(a){var d=$(this),e=d.val();if(a.keyCode==jQuery.ui.keyCode.ENTER){c.fire("completeInput",{element:b,value:e});return}if(a.keyCode==jQuery.ui.keyCode.DOWN||a.keyCode==jQuery.ui.keyCode.UP)return;c.fire("inputChange",{element:b,value:e})};d.keyup(f),this.disableChange=!1},"bus inputChange":function(a){var b=this;b.lastChangeDate||(b.lastChangeDate=new Date),b.lastArgs||(b.lastArgs={value:""});if(b.lastArgs.value==a.data.value)return;b.lastArgs=a.data,setTimeout(function(){if(!b.lastChangeDate)return;var a=new Date-b.lastChangeDate;a>500&&b.lastArgs&&b.fire("completeInput",b.lastArgs)},501)},"bus partialDataRequest":function(){this.disableChange=!0},"bus dataRequestCompleted":function(){this.disableChange=!1},"bus completeInput":function(a){var b=this;b.lastRequestArgs||(b.lastRequestArgs={value:""});if(b.lastRequestArgs.value==a.data.value)return;var c=a.data.value!==""&&a.data.value!==null?[{property:"name",value:a.data.value}]:[];b.fire("search",{element:a.data.element,collection:c}),b.lastChangeDate=null,b.lastRequestArgs=a.data},"bus destroy+showHandlerSigned":function(a){$(".tau-bubble").unbind("show",a.showHandlerSigned.data.handler)}})}),define("tau/components/component.finder",["tau/components/component.creator","tau/models/finder/model.entity.finder","tau/ui/templates/finder/ui.template.finder","tau/models/finder/model.general.search","tau/models/finder/model.data","tau/ui/extensions/finder/ui.extension.finder.list","tau/ui/extensions/finder/ui.extension.finder.simpleSearch"],function(a,b,c,d,e,f,g){return{create:function(h){var i=b,j=h.searchModel||d;!h.resetDisabled&&h.data&&(h.data.id||h.data.value&&h.data.value.id)&&(h.actions=[{name:"reset",fn:function(){this.bus.fire("entitySelected",{entity:null})}}]);var k={name:"finder",extensions:[e,i,j,f,g],template:c};return h.additionalExtensions&&(k.extensions=k.extensions.concat(h.additionalExtensions)),a.create(k,h)}}}),define("tau/models/model.implementationHistory",["Underscore","tau/models/model.leadCycleTime","tau/models/dataprocessor/model.processor.implementationHistory","tau/configurator","tau/store/types"],function(_,a,b,c,d){return a.extend({onInit:function(){var a=this.config.context,b="implementationHistory",c=this.config.context.entity.id;this.store.evictProperties(c,"implementationHistory",["statistics"]),this.store.get(b,{id:a.entity.id,fields:["id","statistics"]}).get("process",{id:a.getProcessId(),nested:!0,fields:[{entityStates:["id","name","isInitial","isFinal","isPlanned","numericPriority",{entityType:["id","name"]},{role:["id"]}]}]}).get("user",{fields:["id","firstName","lastName"]}).get("roles",{fields:["id","name"]}).get(this.config.context.entity.entityType.name,{id:c,fields:["leadTime","cycleTime"]}).done({scope:this,success:this.onDone}),this.store.unbind(this),this._bindToStoreChanges()},_bindToStoreChanges:function(){this._bindToStoreAfterSafe(),this._bindToStoreAfterRemove()},_bindToStoreAfterSafe:function(){this.store.on({eventName:"afterSave",type:this.config.context.entity.entityType.name,listener:this,filter:{id:this.config.context.entity.id},hasChanges:["entityState"]},this._getOnStoreChangesProxy()),_.each(this._getStoreObservableEntityTypes(),function(a){this.store.on({eventName:"afterSave",type:a,listener:this},this._getOnStoreChangesProxy())},this)},_bindToStoreAfterRemove:function(){_.each(this._getStoreObservableEntityTypes(),function(a){this.store.on({eventName:"afterRemove",type:a,listener:this},this._getOnStoreChangesProxy())},this)},_getStoreObservableEntityTypes:function(){if(!this._storeObservableEntityTypes){var a=["assignment","impediment"];switch(this.config.context.entity.entityType.name){case"userstory":a.push("task","bug");break;case"feature":a.push("userstory");break;case"request":a.push("feature","userstory","task","bug")}this._storeObservableEntityTypes=a}return this._storeObservableEntityTypes},_onStoreChanges:function(a){this.store.evictProperties(this.config.context.entity.id,"implementationHistory",["statistics"]),this.fire("afterUpdate")},_getOnStoreChangesProxy:function(){return this._onStoreChangesProxy||(this._onStoreChangesProxy=_.bind(this._onStoreChanges,this)),this._onStoreChangesProxy},shouldShowLeadCycleTimes:function(){var a=this.config.context.entity.entityType.name;return["userstory","bug","feature"].indexOf(a.toLowerCase())!=-1},onDone:function(a){var c=a[4].data.cycleTime,d=this.convertDayToMinutes(c).toFixed(0),e={};this.shouldShowLeadCycleTimes()&&(e={leadTime:this.getLongTime(a[4].data.leadTime),cycleTime:d>0?this.getLongTime(c):null});var f=b.transform(_.extend({response:a,entityTypeName:this.config.context.entity.entityType.name,terms:this.config.context.getTerms()},e));this.fire("dataBind",f)}})}),define("tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(_,$,a,b){return a.extend({"bus afterRender+stateProgressRendered":function(a){this._$element=a.afterRender.data.element,this._data=a.afterRender.data.data,this._render()},_render:function(){var a=this._$element.find(".tau-historyGrid .tau-historyItem");_.each(this._data.historyItems,function(b,c){b.assignments&&!b.state.isFinal&&$('<div class="tau-assignments"/>').insertAfter(a.eq(c).find(".tau-flow")).append(this._getAssignments(b))},this)},_getAssignments:function(a){var c=[];return _.each(a.assignments,function(d){var e=[d.firstName,d.lastName,"("+this._getAssignmentRoles(d)+")"].join(" "),f=b.getApplicationPath()+"/Avatar.ashx?UserId="+d.id+"&size=50",g=this._isActiveAssignment(d,a)?' class="active"':"";c.push("<img"+g+' alt="avatar" title="'+e+'" src="'+f+'"/>')},this),c.join("")},_getAssignmentRoles:function(a){return _.map(a.roles,function(a){return a.name}).join(", ")},_isActiveAssignment:function(a,b){return _.any(a.roles,function(a){return a.id==b.state.roleId})}})}),define("tau/components/component.implementationHistory",["tau/components/component.creator","tau/models/model.implementationHistory","tau/components/extensions/implementationHistory/component.implementationHistory.dateRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateProgressRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.stateHistogramRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.timeLoadRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.assignmentsRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.statsRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.legendRenderer","tau/components/extensions/implementationHistory/component.implementationHistory.historyGridScroller","tau/components/extensions/implementationHistory/component.implementationHistory.relatedEntitiesHighlighter","tau/components/extensions/implementationHistory/component.implementationHistory.updateOverlay","tau/ui/templates/implementationHistory/ui.template.implementationHistory"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return{create:function(o){var p=o||{},q={extensions:[b,c,d,e,f,g,h,i,j,k,l,m],template:n};return a.create(q,p)}}}),define("tau/ui/extensions/list/extension.list.prioritize",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){return b.extend({name:"extension.list.prioritize",category:"edit","bus afterRender":function(b){var c=b.data.element,d=this;this.$el=c,c.addClass("tau-list__sortable__true");var e=c.find("[role=group]");e.addClass("tau-list__group_sortable_true");var f={sensitivity:7,speed:12};a.getConfig("isPopup",!1)&&(f={sensitivity:20,speed:30}),e.addClass("tau-list__group_available_true"),e.sortable({scroll:!0,scrollSensitivity:f.sensitivity,scrollSpeed:f.speed,cursor:"move",connectWith:".tau-list__group_available_true[role=group]",items:".tau-list__list [role=item]",dropOnEmpty:!0,handle:"[role=sortable-handler]",forcePlaceholderSize:!0,placeholder:{element:function(a){var b=$('<li class="tau-list__list__item tau-list__sortable-placeholder ui-sortable-placeholder"></li>');return b.height(50),b},update:function(a,b){return}},helper:function(a,b){var c=b;return c}});var g=function(){$(this).data("sortable").refreshPositions()};c.mousedown(function(){e.bind("mousemove",g)}),c.mouseup(function(){e.unbind("mousemove",g)}),e.bind("sortstart",function(a,b){d.started=!0;var c=b.item,e=c.data("tmplItem").data||{},f=$(a.currentTarget);f.addClass("tau-list__group_sortover_true"),d.$group=f;var g=f.data("tmplItem")?f.data("tmplItem").data:{};d.fire("prioritize.start",{item:e,group:g})}),e.bind("sortstop",function(a,b){e.addClass("tau-list__group_available_true"),e.removeClass("tau-list__group_available_false"),e.removeClass("tau-list__group_sortover_true")}),e.bind("sortupdate",function(a,b){if(d.started)d.started=!1;else return;var c=b.item,e=c.prev("[role=item]"),f=c.next("[role=item]"),g=c.data("tmplItem").data||{},h=e.length?e.data("tmplItem").data:{},i=f.length?f.data("tmplItem").data:{},j=c.parents("[role=group]:first"),k=j.data("tmplItem")||null;k=k?k.data:null;var l=j.hasClass("tau-list__group_collapsed_true");j.addClass("i-target");var m=$(this),n=m.data("tmplItem")||null;n=n?n.data:null,d.fire("prioritize.checkAvailability",{$item:c,$prevGroup:m,$targetGroup:j,item:g,prev:h,next:i,group:k,prevGroup:n,isCollapsed:l})}),e.bind("sortchange",function(a,b){var c=e.find(".tau-list__sortable-placeholder").parents("[role=group]:first");c.length==1&&c.hasClass("tau-list__group_sortover_true")==0&&(e.removeClass("tau-list__group_sortover_true"),c.addClass("tau-list__group_sortover_true"))});var h=function(a,b,c,d){c?$(c[0]).find(".tau-list__list").append(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)};e.each(function(){var a=$(this);a.data("sortable")._rearrange=h})},"bus prioritize.checkAvailability":function(a){this.bus.fire("prioritize.isAvailable.default",{})},"bus prioritize.checkAvailability+prioritize.isNotAvailable":function(a){this.bus.fire("refresh")},"bus prioritize.checkAvailability+prioritize.isAvailable.default+prioritize.isAvailable.comment":function(a){var b=a["prioritize.checkAvailability"].data;this.fire("positionUpdated",b)},"bus prioritize.updateGroupsAvailability":function(a){var b=a.data,c=b.groups,d=this,e=this.$el.find("[role=group]");if(e.length<=1||e.length==c.length){e.addClass("tau-list__group_available_true").removeClass("tau-list__group_available_false"),this.$group.sortable("refresh");return}var f=_.filter(e.toArray(),function(a){var b=$(a).data("tmplItem").data;return _.any(c,function(a){return b===a})}),g=$(f);e.addClass("tau-list__group_available_false").removeClass("tau-list__group_available_true"),g.removeClass("tau-list__group_available_false").addClass("tau-list__group_available_true"),this.$group.sortable("refresh")},"bus beforeUpdate":function(){this.$el.find(".i-target [role=counter]").css("backgroundColor","#ffefd5")},"bus afterUpdate":function(a){this.$el.find("[role=group]").each(function(){$(this).find("[role=counter]").text($(this).find("[role=item]").length)}),this.$el.find(".i-target [role=counter]").animate({backgroundColor:"#ffffff"},200),this.$el.find(".i-target").removeClass("i-target");var b=a.data.changedItem,c=this.$el.find(".i-item-"+b.id),d=c.parents("[role=item]:first"),e=d.data("tmplItem").data;_.extend(e,b);if(this.$el.find("[role=group]").length>1){var f="tau-list__table__row_isfinalstate_true";e.entityState&&c.toggleClass(f,!!e.entityState.isFinal)}}})}),define("tau/ui/extensions/list/extension.list.state",["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(_,$,a,b){return a.extend({name:"extension.list.state",initialState:{},"bus preDataBind":function(a){var c=a.data,d=b.getRouting().getStateParameter("list")||{},e=this;_.forEach(c.groups,function(a){var b=(new String(a.key)).toString();e.initialState[b]=a.collapsed,_.isUndefined(d[b])==0&&(a.collapsed=d[b])})},"bus afterInit+afterRender":function(a){this.$el=a.afterRender.data.element},"bus toggled":function(a){var c=this.$el.find("[role=group]"),d={},e=this;c.each(function(){var a=$(this),b=a.hasClass("tau-list__group_collapsed_true"),c=a.data("tmplItem").data,f=(new String(c.key)).toString();_.isUndefined(e.initialState[f])==0&&e.initialState[f]!==b&&(d[f]=b)}),b.getRouting().setStateParameter("list",d,!0),b.getHistory().updateCurrent({url:b.getRouting().getUrl().source})}})}),define("tau/components/component.list",["Underscore","tau/components/component.creator","tau/ui/extensions/list/extension.list.prioritize","tau/ui/extensions/list/extension.list.prioritize.comment","tau/ui/extensions/list/extension.list.groups","tau/ui/extensions/list/extension.list.overlay","tau/ui/extensions/list/extension.list.state","tau/ui/extensions/ui.extension.tooltip","tau/ui/extensions/list/extension.list.handleAction","tau/ui/extensions/list/extension.list.handleAction.generator","tau/models/model.list","tau/models/model.list.editable","tau/views/view.list","tau/ui/extensions/list/external.refresh.extension"],function(_,a,b,c,d,e,f,g,h,i,j,k,l,m){return{create:function(n){n=n||{},n.views=n.views||[{}],_(n.views).each(function(a){a.emptyMessage=a.emptyMessage||"No items found",a.rowTemplateName=a.rowTemplateName||"list-grid-entity__row"});var o=n.views[0];o.type=o.type||"grid",n.multiprojects&&(o.multiprojects=n.multiprojects),o.timeTrackingPolicies=n.context.getTimeTrackingPolicies();var p=[k,d,e,f,g,m,h,i("bugWasMarkedAsDuplicate","duplicateBugId"),i("entityWasMovedToProject","entity:id"),i("entityWasCopiedToProject","entity:id")];n.sortable!==!1&&(p.push(b),p.push(c));var q={extensions:p.concat(n.extensions||[]),ModelType:j,ViewType:n.ViewType||l};return n.template&&(q.template=n.template),a.create(q,n)}}}),define("tau/components/component.list.editable",["Underscore","tau/components/component.list","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity","tau/ui/extensions/list/extension.list.editable.progress","tau/views/view.compositeControl"],function(_,a,b,c,d){return{create:function(e){return e=_(e).defaults({ViewType:d,template:e.template||b,extensions:[],dependencies:["title","property.severity","property.priority","property.entityState","assignmentsList","property.effort","entity.actions","progressBar.small","property.release","property.iteration","property.build","property.build.testPlanRun","property.lastStatus","property.lastRunDate.list","property.status.testCaseRun","property.endDate","property.endDate.list","steps","success","menu.testPlanRun"]}),e.extensions.push(c),a.create(e)}}}),define("tau/components/component.lookswitcher",["jQuery","Underscore","tau/configurator","tau/components/component.creator","tau/ui/templates/ui.template.lookswitcher","tau/components/extensions/component.extension.base"],function($,_,a,b,c,d){var e={create:function(e){var f=d.extend({"bus beforeInit":function(){var b=this,c=a.getGlobalSettingsService();c.getGlobalSettings({success:function(a){b.fire("dataBind",{loveNewLook:a.LoveNewLook})}})},execute:function(b,c){var d=a.getGlobalSettingsService(),e=this;d.sendRequest("GlobalSettingsService",b,null,function(a){d.resetSettings(),c&&c()},function(a){})},"bus feltInLove+afterRender":function(a){var b=this;this.execute("WantToSeeBeatyAlways",function(){b.fire("refresh")})},"bus hateIt+afterRender":function(b){var c=this;c.execute("HateNewLook",function(){document.location.href=a.getApplicationPath()+"/view.aspx?id="+c.config.context.entity.id})},"bus afterRender":function(a){var b=this,c=a.data.element,d=function(a,d){$(a,c).click(function(){$(this).unbind(),$(this).addClass("tau-disabled"),$(this).attr("disabled"),b.fire(d)})};d(".ui-lookswitcher-love-link","feltInLove"),d(".ui-lookswitcher-hate-link","hateIt")}}),g={extensions:[f],template:c};return b.create(g,e)}};return e}),define("tau/components/extensions/menu/extension.menu.actions",["Underscore","jQuery","tau/configurator","tau/ui/extensions/editable-base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","tau/utils/utils.redirect"],function(_,$,a,b,c,d){return b.extend({"bus dataBind+afterRender":function(a){this.redirect=new d(this.config.context);var b=this.$el=a.afterRender.data.element;b.behaviourMenuActions(),b.find(".ui-menu__item-action").click(_.bind(this.executeCommand,this))},"bus select":function(){this.$el.behaviourMenuActions("show")},removeEntity:function(){var b=this.config.context.entity;this.config.store.remove(b.entityType.name,{id:b.id}).done(),a.getHistory().exclude(b.id)},redirectTo:function(a,b){this.redirect.redirect(a,b)},split:function(){var a=this.config.context.entity.id,b={generalID:a};this.fire("split",b)},markAsDuplicate:function(){var a=this.config.context.entity.id,b={generalID:a};this.fire("markAsDuplicate",b)},convert:function(){var a=this.config.context.entity.id,b=this.config.context.getProjectId(),c={generalID:a,projectID:b};this.fire("convertEntity",c)},attachToRequest:function(){var a=this.config.context.entity.id;this.fire("attachToRequest",{generalID:a})},moveOrCopy:function(){var a=this.config.context.entity.id;this.fire("moveOrCopy",{generalID:a})},executeCommand:function(a){if($(a.target).is("a"))return;var b=this,c=$(a.currentTarget).data().tmplItem.data,d=c.command,e=c.confirmation||!1;if(e&&window.confirm(e)==0)return;if(_.isFunction(d))_.bind(d,b)(b);else if(typeof d=="object"){var f={components:d,context:b.config.context};b.createComponents(f,function(a){var b=a[0].component;b.initialize()})}else c.url&&b.redirectTo(c.url);this.fire("beforeSave",{})}})}),define("tau/components/extensions/menu/extensions.menu.moveOrCopy",["tau/components/extensions/component.extension.base","tau/configurator","tau/core/templates-factory","tau/ui/templates/actions/ui.template.moveOrCopy"],function(a,b,c){var d=0;return a.extend({"bus moveOrCopy":function(a){var b=a.data.generalID;this.moveOrCopy(b)},moveOrCopy:function(a){var e=this;Ext.WindowMgr.zseed=99999;var f=b.getActionsService(),g=function(b){function i(b,c){var d=$("#"+h+" #projectSelector").val();d!=0&&f[b](e.config.context.entity.id,d,function(b){k.close(),c&&c(a,d)},function(a){k.close();var b=$.parseJSON(a.responseText).Message;e.fire("error",{message:b})})}d++;var g=c.get("move-or-copy").bind(e.config,{projects:b.d}).appendTo("body"),h="copyActionPopup"+d;g.find("#copyActionPopup").prop("id",h);var j=g.find(".copy,.move");g.find("#projectSelector").change(function(){var a="disabled";$(this).val()!="0"?j.removeAttr(a):j.attr(a,a)}),g.find(".copy").click(function(){var a=function(a,b){e.fire("entityWasCopiedToProject",{entity:{id:a},project:{id:b}})};i("copyGeneralToProject",a)}),g.find(".move").click(function(){var a=function(a,b){e.fire("entityWasMovedToProject",{entity:{id:a},project:{id:b}})};i("moveGeneralToProject",a)});var k=showModalPopup(h,{title:"Move or Copy",width:440,height:126})};f.getActiveProjectForEntity(a,g)}})}),define("tau/components/extensions/menu/extensions.menu.attachToRequest",["tau/components/extensions/component.extension.base","tau/configurator","tau/core/templates-factory"],function(a,b,c){var d=0;return a.extend({"bus attachToRequest":function(a){var b=a.data.generalID;this.attachToRequest(b)},attachToRequest:function(a){Ext.WindowMgr.zseed=99999;var c=this,d=this.config.context.getProjectId(),e=[];for(var f=0;f<_projectContext.length;f++)e.push(_projectContext[f].id);var g=b.getActionsService();g.getProjectIds(function(b){var e=Ext.create({xtype:"lookupgenerallistitemgrid",listeners:{lookupactionlinkclick:{fn:function(b,d,e,h,i,j){f.close(),f.destroy();var k=function(b){c.fire("requestWasAttachedToEntity",{entity:{id:a}},{project:{id:h.json.GeneralID}})},l=function(a){};g.attachGeneralToRequest(a,h.json.GeneralID,k,l)},scope:this}},showReleaseIteration:!1,showEntityType:!1,excludeEntityId:0,showProjects:!0,entityTypeIds:[17],showState:!1,projectIds:b.d,projectId:d,appendItems:[]}),f=showModalPopupForComponent(e,{width:680,height:500,title:"Attach to Request"})})}})}),define("tau/components/extensions/menu/extensions.menu.markAsDuplicate",["tau/components/extensions/component.extension.base","tau/configurator"],function(a,b){var c=0;return a.extend({"bus markAsDuplicate":function(a){var b=a.data.generalID;this.markAsDuplicate(b)},markAsDuplicate:function(a){Ext.WindowMgr.zseed=99999;var c=[];for(var d=0;d<_projectContext.length;d++)c.push(_projectContext[d].id);var e=this,f=Tp.controls.Duplicate.CreatePopup(c,a,undefined,{onMarkDelegate:function(a){var c=b.getStore(),d=c.freeze();e.fire("bugWasMarkedAsDuplicate",a),d.unfreeze()}});f.show(c,a),b.getKeyBoardManager().pushHandler({handleKeyDown:function(a){a.which==27&&(b.getKeyBoardManager().popHandler(),f.hide(),f.destroy())}})}})}),define("tau/components/extensions/menu/extensions.menu.split",["tau/components/extensions/component.extension.base","tau/configurator","tau/utils/utils.urlBuilder","tau/utils/utils.redirect"],function(a,b,c,d){return a.extend({"bus split":function(a){var b=a.data.generalID;this.split(b)},split:function(a){var e=this,f=b.getActionsService();f.splitUserStory(a,function(b){var e=b.d,f=c.getSplitForUserStoryUrl(a,e);(new d).redirect(f)},function(a){e.fire("error",{message:"Split operation is failed due to server error"})})}})}),define("tau/components/extensions/menu/extensions.menu.converter",["tau/components/extensions/component.extension.base","tau/configurator","tau/core/templates-factory","tau/ui/templates/actions/ui.template.convert"],function(a,b,c){var d=46,e=0;return a.extend({"bus convertEntity":function(a){var b=a.data.projectID,c=a.data.generalID;this.convert(c,b)},convert:function(a,f){var g=this.config.context.entity.id,h=this.bus.getGlobalBus(),i=b.getActionsService();Ext.WindowMgr.zseed=99999;var j=this,k=[],l=function(g){function n(){var a=h.find("#entityType").val();h.find("textarea").unbind("keypress"),h.find("textarea").unbind("keyup"),h.find("#pnlLookupUserStory").css("display",a==d?"block":"none"),a==0?h.find(".convert-btn").attr("disabled","disabled"):a==d?(h.find("textarea").bind("keypress ",function(a){a.keyCode==13&&(a.stopPropagation(),a.preventDefault())}),h.find("textarea").bind("keyup",m),h.find("textarea").bind("change",m),m()):h.find(".convert-btn").removeAttr("disabled")}e++;var h=c.get("convert").bind(j.config,{types:g.d}).appendTo("body"),l="convertEntityPanel"+e;h=h.find("#convertEntityPanel").prop("id",l);var m=function(){h.find("textarea").val().length==0?h.find(".convert-btn").attr("disabled","disabled"):h.find(".convert-btn").removeAttr("disabled")};$create(Tp.Atlas.Extenders.Lookup.GeneralLookupBehavior,{TargetControl:h.find("#txtGeneralsLookup")[0],clearLink:h.find("#lnkClear")[0],entityTypeIDs:[4],excludeEntityID:a,findLink:h.find("#lnkFind")[0],generalElement:h.find("#hdnGeneralID")[0],id:"lkpUserStories",projectID:f,projectIDs:k,showEntityTypeFilter:!1,showProjectFilter:!0,showReleaseIterationFilter:!0,onFindDelegate:function(){h.find(".convert-btn").removeAttr("disabled")},showStateFilter:!1},null,null),h.find(".convert-btn").click(function(){var c=h.find("#entityType").val();o.hide(),j.fire("showProgress",{text:"Converting..."});var e={generalId:a},f=function(c){o.close(),j.fire("hideProgress");var d=c.d,e=d.EntityTypeName.split("."),f=e[e.length-1],g={entity:{id:d.GeneralID},entityType:{name:f}};j.fire("generalWasConverted",g),b.getHistory().exclude(a,!1),b.getRouting().redirect("#"+f.toLowerCase()+"/"+d.GeneralID),window._criticalTauChanges=!0},g=function(a){o.close(),j.fire("hideProgress");var b=jQuery.parseJSON(a.responseText)||{Message:"Server is not available"},c=b.Message;j.fire("error",{message:c})};if(c==d){var k=h.find("#hdnGeneralID").val();if(!k){j.fire("error",{message:"Parent user story is not specified"});return}i.convertGeneralToTask(a,k,f,g)}else e.entityTypeId=c,i.convertGeneralToType(a,c,f,g)}),h.find("#entityType").change(function(){n()}),n();var o=showModalPopup(l,{title:"Convert",width:600,height:220})};i.getProjectIds(function(b){k=b.d,i.generalCanConvertTo(a,l)})}})}),define("tau/components/component.menu.actions",["tau/components/component.creator","tau/models/model.menu.actions","tau/components/extensions/menu/extension.menu.actions","tau/components/extensions/menu/extensions.menu.moveOrCopy","tau/components/extensions/menu/extensions.menu.attachToRequest","tau/components/extensions/menu/extensions.menu.markAsDuplicate","tau/components/extensions/menu/extensions.menu.split","tau/components/extensions/menu/extensions.menu.converter","tau/components/extensions/error/extension.errorBar","tau/ui/templates/menu/ui.template.menu.actions"],function(a,b,c,d,e,f,g,h,i,j){return{create:function(k){var l={extensions:[b,d,e,g,h,f,i,c],template:k.template||j};return a.create(l,k)}}}),define("tau/models/model.menu.testPlanRun",["Underscore","tau/core/model-base","tau/configurator"],function(_,a,b){var c=a.extend({"bus beforeInit":function(a){var c=a.data.config,d=c.eventNamesSpecial||{};_.defaults(d,{dataBind:"dataBind"});var e=d.dataBind,f=c.context.entity.id,g=b.getApplicationPath(),h={run:{show:!1,url:g+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+f,label:"Run"},completeRun:{show:!1,url:g+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+f+"&CompleteRun=1",label:"Complete Last Run"},newRun:{show:!1,url:g+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+f+"&ReRun=1",label:"New Run"},changeLastRun:{show:!1,url:g+"/Project/QA/TestPlanRun/TestsRunner.aspx?TestPlanRunID="+f+"&Edit=1",label:"Change Last Run"}},i=this,j=c.context.entity;this.store.get("testplanrun",{id:j.id,fields:["testCaseRuns-count","passedCount","failedCount","notRunCount",{entityState:["isFinal"]}]}).done({success:function(a){var b=a[0].data;!b.entityState.isFinal&&b["testCaseRuns-count"]>0&&(b.passedCount>0||b.failedCount>0?(h.newRun.show=!0,b.notRunCount>0?h.completeRun.show=!0:h.changeLastRun.show=!0):h.run.show=!0),i.bus.fire(e,{additionalActions:h})}}),this.store.on({eventName:"afterSave",type:"testplanrun",listener:this,filter:{id:j.id},hasChanges:["entityState"]},function(a){i.fire("refresh")})}});return c}),define("tau/components/component.menu.testPlanRun",["tau/components/component.creator","tau/models/model.menu.testPlanRun","tau/ui/templates/menu.testPlanRun/ui.template.menu.testPlanRun"],function(a,b,c){return{create:function(d){var e={extensions:[b],template:d.template||c};return a.create(e,d)}}}),define("tau/models/model.menu.testPlanRun.union",["Underscore","tau/core/model-base","tau/configurator"],function(_,a,b){var c=a.extend({"bus dataBind.special+dataBind.common":function(a){var b=a["dataBind.special"].data.additionalActions,c=[];_.forEach(b,function(a,b){a.show==1&&c.push({label:a.label||b,url:a.url})}),c=c.concat(a["dataBind.common"].data.items),this.fire("dataBind",{items:c})}});return c}),define("tau/components/component.menu.actions.testplanrun",["tau/components/component.creator","tau/models/model.menu.actions","tau/models/model.menu.testPlanRun","tau/models/model.menu.testPlanRun.union","tau/components/extensions/menu/extension.menu.actions","tau/components/extensions/error/extension.errorBar","tau/ui/templates/menu/ui.template.menu.actions"],function(a,b,c,d,e,f,g){return{create:function(h){h.eventNamesCommon={dataBind:"dataBind.common"},h.eventNamesSpecial={dataBind:"dataBind.special"};var i={extensions:[b,c,d,e,f],template:h.template||g};return a.create(i,h)}}}),define("tau/models/model.entity",["Underscore","tau/configurator","tau/core/model-base","tau/models/boardSettings/factory.board.settings","tau/models/dataprocessor/model.processor.context","tau/extensions/extension.underscore.async"],function(_,a,b,c,d){return b.extend({name:"Entity",onInit:function(){var b=this.config.entity,d=this.config.context.configurator.getStore(),e=this,f=[];f.push(function(b){var c=a.getGlobalSettingsService();c.store=d,c.getGlobalSettings({success:function(a){b(!1,a)}})}),f.push(function(c){var e=a.getApplicationContextService();e.store=d,e.getApplicationContext({id:b.id},{success:function(a){c(!1,a)}})}),f.push(function(a){var c={id:b.id,entityType:{name:b.type}};a(!1,c)}),f.push(function(d){var e=c.createComponentSettings(a,{id:b.type});d(!1,e)}),_.parallel(f,function(a,b){e.prepareContext({globalSettings:b[0],applicationContext:b[1],entity:b[2],componentSettings:b[3]})})},prepareContext:function(a){var b={};a.applicationContext.globalSettings=a.globalSettings,_.extend(b,{assignable:a.entity,entity:a.entity,general:a.entity,applicationContext:a.applicationContext,componentSettings:a.componentSettings}),this.bus.fire("contextRetrieved",{context:d(b)})},"bus contextRetrieved":function(a){var b=a.data.context,c=this.store,d=this;c.unbind(d);var e=b.entity;c.on({eventName:"afterRemove",type:e.entityType.name,listener:this},function(a){var b=a.data.cmd.config.id;e.id==b&&d.fire("deleted",a.data)}),c.on({eventName:"beforeRemove",type:e.entityType.name,listener:this},function(a){var b=a.data.cmd.config.id;e.id==b&&d.fire("beforeDelete")})}})}),define("tau/components/component.page.entity",["Underscore","tau/components/component.page.base","tau/models/model.entity","tau/views/view.entity","tau/components/extensions/extension.refresher","tau/components/extensions/entity/extension.refresher.project"],function(_,a,b,c,d,e){return{create:function(f,g){g=g||{},_(g).defaults({extensions:[]});var h={name:"entity component",ModelType:b,ViewType:c,extensions:_.union([d,e],g.extensions)};return a.create(h,f)}}}),define("tau/components/extensions/application/extension.controller.entity",["Underscore","tau/core/event.emitter","tau/core/tau","tau/components/component.page.entity","tau/configurator","tau/utils/utils.redirect","tau/core/event","tau/store/types","tau/components/extensions/print.convert.extension"],function(_,a,b,c,d,e,f,g,h){return a.extend({init:function(a){this._super(a),this.config=a,this._initGlobalEvents()},_initGlobalEvents:function(){var a=this,b=function(b){var c=b.data,d={project:{id:c.project.id}},e={id:c.entity.id,changes:d,cmd:{config:{$set:d}}};a.bus.fire("application.reload",e)},c=function(b){var c=b.data,d={},e={id:c.bugId,changes:d,cmd:{config:{$set:d}}};a.bus.fire("application.reload",e)};a.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",c,a),a.bus.getGlobalBus().on("entityWasMovedToProject",b,a),a.bus.getGlobalBus().on("processChanged",b,a);var e=["general","assignment","roleEffort"],f=d.getStore(),g=function(b){a.bus.fire("application.reload",b.data)};_.each(e,function(b){f.on({type:b,eventName:"afterSave",listener:a},g),f.on({type:b,eventName:"afterRemove",listener:a},g)})},"bus afterRender:last+innerContentRendered":function(a){var b=a.afterRender.data.element,c=a.innerContentRendered.data.element;b.append(c),this.fire("contentRendered",{element:c})},"bus beforeRender":function(a){},_getItemConfig:function(a,b){var c={entity:{id:a,type:b}};return c},"bus application.navigate.entity":function(a){var b=this,c=a.data,e=(c.action||"").toLocaleLowerCase(),f=e&&e!="demoview"&&e!="tpview"?e:"show";if(!c.id&&!c.entity){var g=d.getRouting(),h=g.getReferer()?g.getReferer().url:null;h&&h!=="#"?g.redirect("#"+h):this.bus.fire("application.exit");return}f="action"+f,this[f]||(f="actionshow"),this.bus.fire("controller.preExecute",{action:f,parameters:c}),this[f].call(this,c.id,c.entity),this.bus.fire("controller.postExecute")},actionshow:function(a,b){this._action(a,b),$("html").toggleClass("tau-html_action_view",!0).toggleClass("tau-html_action_print",!1)},actionprint:function(a,b){this._action(a,b,{extensions:[h]}),$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!0),jQuery("body").addClass("print-mode")},_action:function(a,b,f){$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!1),this.current&&(this.current.destroy(),d.getStore().evictData());var g=this;this.current=c.create(this._getItemConfig(a,b),f||{}),this.current.on("beforeDelete",function(a){g.bus.fire("initProgress")}),this.current.on("deleted",function(a){var b=d.getHistory(),c=new e,f=b.pop();f?(b.setCurrent(null),c.redirect(f.url)):g.bus.fire("application.exit")}),this.current.on("error",function(a){g.bus.fire("application.error")}),this.current.on("afterRender",function(a){g.fire("innerContentRendered",{element:a.data.element})}),this.current.initialize()},destroy:function(){this._super(),d.getStore().unbind(this),this.current&&this.current.fire("destroy"),delete this.current,delete this.$element,delete this.config}})}),define("tau/components/component.application",["tau/components/component.creator","tau/core/component-base","tau/core/view-base","tau/components/extensions/application/extension.history","tau/components/extensions/application/extension.routing","tau/components/extensions/application/extension.routing.patterns","tau/components/extensions/application/extension.integration","tau/components/extensions/application/extension.navigation","tau/components/extensions/error/extension.errorBar","tau/ui/extensions/popup/ui.extension.popup","tau/components/extensions/application/extension.controller.entity","tau/ui/templates/application/ui.template.application"],function(a,b,c,d,e,f,g,h,i,j,k,l){return{create:function(a){a=a||{onCreate:function(){}};var m={name:"application component",template:l},n=new b(m);return n.attach(e,a).attach(f,a).attach(d,a).attach(g,a).attach(h,a).attach(i,a).attach(k,a).attach(c),a.integration&&a.integration.showInPopup===!0&&n.attach(j,a),n.bus}}}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){var c=b.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,this.dataToBind=a.dataBind.data;var b=this.element.find(".plugin-block");_(b).each(function(a){$(a).find(".tau-profile-actions").click($.proxy(this.onDeleteProfile,{pluginBlock:$(a),parentExtension:this}))},this)},onDeleteProfile:function(a){a.preventDefault();var b=this.parentExtension,c=$(a.target).tmplItem().data,d=this.pluginBlock,e=function(){d.confirmation("hide"),d.tauOverlay("hide"),b.fire("refresh")};d.confirmation({message:"Do you really want to delete profile?",okLabel:"OK",cancelLabel:"Cancel",ok:function(){d.tauOverlay({showOnCreation:!1}),d.tauOverlay("showLarge"),d.confirmation("hideConfirmationMessage"),b.config.context.pluginRepository.deleteProfile(c.pluginName,c.name,e)},cancel:function(){d.confirmation("hide")}}),this.pluginBlock.confirmation("show")}});return c}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){var c=b.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,this.dataToBind=a.dataBind.data,_(this.element.find(".plugin-block")).each(function(a){var b=$(a).tmplItem().data.name;this.config.context.pluginRepository.getProfilesErrors(b,$.proxy(this.onProfilesErrorsRetrieved,{element:$(a),data:$(a).tmplItem().data}))},this)},onProfilesErrorsRetrieved:function(a){_(this.element.find(".tau-profileName")).each(function(b){_(a).each(function(a){if(a.ProfileName==$(b).tmplItem().data.name&&a.ErrorsExist){var c=$(b);c.fadeOut("slow"),c.children("a").addClass("error-indicator"),$(b).fadeIn("slow")}})},this)}});return c}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){var c=b.extend({"bus dataBind+afterRender":function(a){_(a.afterRender.data.element.find(".plugins-category")).each(function(a){var b=$(a);b.find(".tau-pluginCategory").click(function(a){a.preventDefault();var c=$(this),d=c.hasClass("collapsed"),e=d?"collapsed":"expanded",f=d?"expanded":"collapsed";c.removeClass(e),c.addClass(f),d?(b.find(".plugin-block").show(),b.find(".create-me").show()):(b.find(".plugin-block").hide(),b.find(".create-me").hide())})})}});return c}),define("tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore",["Underscore","jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function(_,$,a,b){var c=b.extend({"bus dataBind+afterRender":function(a){this.element=a.afterRender.data.element,this.dataToBind=a.dataBind.data,_(this.element.find(".plugin-block")).each(function(a){var b=$(a),c=b.tmplItem().data.profilesMore.length;if(c>0){var d=b.find(".tau-profiles-more"),e=b.find(".tau-profiles-moreLink");e.show(),e.click([e,d],$.proxy(this.onShowMoreClick,{profilesMoreCount:c}))}},this)},onShowMoreClick:function(a){a.preventDefault();var b=a.data[0].find(".more-link"),c=a.data[1];c.is(":visible")?b.text(["Show more (",this.profilesMoreCount,")"].join("")):b.text("Show less"),c.animate({opacity:"toggle",height:"toggle"},"slow")}});return c}),define("tau/models/model.pluginsList",["Underscore","jQuery","tau/configurator","tau/core/model-base"],function(_,$,a,b){var c=b.extend({onInit:function(){this.config.context.pluginRepository.getPlugins($.proxy(this.onPluginsRetrieved,this))},onPluginsRetrieved:function(a){this.augmentData(a),this.fire("dataBind",{items:a})},augmentData:function(b){_(b).each(function(b){_(b.plugins).each(function(b){b.iconSrc=[a.getApplicationPath(),"/PluginIcon.ashx?pluginName=",b.name].join(""),b.profilesShort=b.profiles.slice(0,3),b.profilesMore=b.profiles.slice(3)},this)},this)}});return c}),define("tau/components/component.pluginsList",["tau/components/component.list.creator","tau/ui/extensions/pluginsList/ui.extension.pluginsList.editable","tau/ui/extensions/pluginsList/ui.extension.pluginsList.errorDisplay","tau/ui/extensions/pluginsList/ui.extension.pluginsCategory.collapsible","tau/ui/extensions/pluginsList/ui.extension.pluginsList.showMore","tau/models/model.pluginsList","tau/ui/extensions/ui.extension.loading","tau/ui/templates/pluginsList/ui.template.pluginsList"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:f,template:h,message:"No plugins found",extensions:[b,c,d,e,g]};return a.create(j,i)}}}),define("tau/models/model.property",["tau/core/model.editable.base","tau/configurator"],function(a,b){return a.extend({init:function(a){this._super.apply(this,arguments);if(!a.propertyName)throw"PropertyName was not configured";this.propertyName=a.propertyName,this.displayField=a.displayField||"name",this.valueField=a.valueField||"id",this.listenedEntities={}},getEntityTypeName:function(){return this.config.context.entity.entityType.name},getEntityId:function(){return this.config.context.entity.id},buildRequest:function(a){var b=this.store;return b=b.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",a]}),b},getPropertyData:function(a){var b=this.buildRequest(a);b.done({success:this.onEntityRetrieved,scope:this})},getPropertyFields:function(){return[this.displayField,this.valueField]},onInit:function(){this._super.apply(this,arguments);var a={};a[this.propertyName]=this.getPropertyFields(),this.listenOfPropertyChanged(),this.getPropertyData(a)},listenOfPropertyChanged:function(){var a=this.config.context.entity.id;this.listenedEntities[a]||(this.listenedEntities[a]=!0,this.attachToChangePropertiesOfCurrentEntity(this.propertyName))},onProcessProperty:function(a){var b={id:a[this.valueField],name:this.propertyName.toLowerCase(),text:a[this.displayField]};return this.config.showUrl&&a.id&&(b.hasUrl=!0,b.__type=a.__type,b.id=a.id),b.placeholderText=this.config.placeholderText,b},processProperty:function(a){var b=this.onProcessProperty(a);this.fire("dataBind",b)},onEntityRetrieved:function(a){var b=this.property=a[0].data[this.propertyName]||{};this.processProperty(b)},entityBelongCurrentContext:function(a){return a.changes.hasOwnProperty(this.config.propertyName)&&a.cmd.config.id==this.config.context.entity.id},onEntityAfterSave:function(a){var b=a.data;this.entityBelongCurrentContext(b)&&this.fire("changed",b)},onEntityBeforeSave:function(a){var b=a.data;this.entityBelongCurrentContext(b)&&this.fire("beforeChanged",b)}})}),define("tau/models/model.property.assignable",["tau/models/model.property","tau/configurator"],function(a,b){return a.extend({onInit:function(){var a=this;a._super.apply(a,arguments),a.store.unbind(a),a.store.on({type:a.getEntityTypeName(),eventName:"beforeSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.store.evictProperties(a.getEntityId(),a.getEntityTypeName(),[a.config.refField]),a.fire("beforeChanged",b.data)}),a.store.on({type:a.getEntityTypeName(),eventName:"afterSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.fire("propertyChanged",b.data)})},getPropertyData:function(){var a=this;a.store.get(a.getEntityTypeName(),{id:a.getEntityId(),fields:["id",a.config.refField]},{success:function(b){if(!b.data[a.config.refField]||b.data[a.config.refField].length===0){a.processProperty({});return}a.store.get("assignable",{id:b.data[a.config.refField][0],fields:[a.displayField,a.valueField]},{success:function(b){a.processProperty(b.data)}}).done()},scope:a}).done()}})}),define("tau/components/component.property",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property","tau/models/model.property.editable","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(_,a,b,c,d,e,f,g,h,i){return{create:function(j){var k=new b(j.context.getTerms()),l=j.editorComponentConfig||{};l.resetDisabled=j.resetDisabled,l.showEmptyDataMessage&&(l.emptyDataMessage="No "+k.getTerms(j.propertyName).names.toLowerCase()+" found"),l.showClearValue&&(j.clearValueLabel="reset "+k.getTerms(j.propertyName).name.toLowerCase()),j.placeholderText=j.placeholderText||"click to edit";var m={ModelType:j.Model||c,template:j.template||i,extensions:_.concat([j.extensions,g,h,d,f,e])};return a.create(m,j)}}}),define("tau/components/component.property.assignable",["tau/components/component.property","tau/models/model.property.assignable","tau/models/finder/model.assignable.search","tau/models/finder/model.relation.editor"],function(a,b,c,d){return{create:function(e){return e.propertyName="assignable",e.refField="$ref:assignable[id]",e.showUrl=!0,e.Model=b,e.alignElementSelector=".property-text",e.showEmptyDataMessage=!0,e.editorComponentConfig={type:"finder",resetDisabled:!0,propertyName:"assignable",searchModel:c,additionalExtensions:[d],listType:"userStory",maxHeight:400},a.create(e)}}}),define("tau/components/component.property.build",["tau/components/component.property","tau/models/finder/model.build.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="build",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"build",fields:["id","name",{project:["id","abbreviation"]}],searchModel:b,additionalExtensions:[c],listType:"build",maxHeight:400},a.create(d)}}}),define("tau/components/component.property.build.testPlanRun",["tau/components/component.property","tau/components/extensions/property/extension.property.build.refresher","tau/models/finder/model.build.testPlanRun.search","tau/models/finder/model.relation.editor"],function(a,b,c,d){return{create:function(e){return e.propertyName="build",e.showUrl=!0,e.alignElementSelector=".property-text",e.showEmptyDataMessage=!0,e.extensions=[b],e.editorComponentConfig={type:"finder",propertyName:"build",fields:["id","name",{project:["id","abbreviation"]}],searchModel:c,additionalExtensions:[d],listType:"build",maxHeight:400},a.create(e)}}}),define("tau/components/component.property.company",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="company",b.showUrl=!1,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"company",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,clearValueLabel:"no company",defaultValueLabel:"current",fullModeLabel:"show old",emptyDataMessage:"No company found"},a.create(b)}}}),define("tau/components/component.property.feature",["tau/components/component.property","tau/models/finder/model.feature.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="feature",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"feature",searchModel:b,additionalExtensions:[c],maxHeight:400,filter:!0,expandable:!0,showEmptyDataMessage:!0},a.create(d)}}}),define("tau/components/component.property.iteration",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="iteration",b.showUrl=!0,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"iteration",maxHeight:200,filter:!0,expandable:!0,showEmptyDataMessage:!0,clearValueLabel:"backlog",defaultValueLabel:"current",fullModeLabel:"show old"},a.create(b)}}}),define("tau/components/component.property.priority",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="priority",b.editorType="",b.alignElementSelector=".property-text",b.showEmptyDataMessage=!0,b.editorComponentConfig={type:"state-list",listType:"priority",maxHeight:200},a.create(b)}}}),define("tau/components/component.property.program",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="program",b.showUrl=!1,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"program",expandable:!0,filter:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show old",clearValueLabel:"reset"},a.create(b)}}}),define("tau/components/component.property.project",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="project",b.showUrl=!0,b.editable=!1,b.alignElementSelector=".property-text",a.create(b)}}}),define("tau/components/component.property.release",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="release",b.showUrl=!0,b.alignElementSelector=".property-text",b.editorComponentConfig={type:"state-list",listType:"release",expandable:!0,filter:!0,showEmptyDataMessage:!0,defaultValueLabel:"current",fullModeLabel:"show old",clearValueLabel:"backlog"},a.create(b)}}}),define("tau/components/component.property.requestSource",["tau/components/component.property","tau/models/model.property.simple"],function(a,b){return{create:function(c){return c.propertyName="sourceType",c.Model=b,c.showUrl=!1,c.alignElementSelector=".property-text",c.editorComponentConfig={type:"state-list",listType:"static",values:["None","Email","Phone","Internal","External"],expandable:!0,filter:!1,showEmptyDataMessage:!1},a.create(c)}}}),define("tau/components/component.property.requestType",["tau/components/component.property"],function(a){return{create:function(b){return b.propertyName="requestType",b.editorType="",b.alignElementSelector=".property-text",b.showEmptyDataMessage=!0,b.editorComponentConfig={type:"state-list",listType:"requestType",maxHeight:200,showReset:!1},a.create(b)}}}),define("tau/components/component.property.testPlan",["tau/components/component.property"],function(a){return{create:function(b){return b=b||{},b.propertyName="testPlan",b.showUrl=!0,b.editable=!1,a.create(b)}}}),define("tau/components/component.property.userStory",["tau/components/component.property","tau/models/finder/model.userStory.search","tau/models/finder/model.relation.editor"],function(a,b,c){return{create:function(d){return d.propertyName="userStory",d.showUrl=!0,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"finder",propertyName:"userStory",searchModel:b,additionalExtensions:[c],listType:"userStory",maxHeight:400},a.create(d)}}}),define("tau/models/model.property.process",["Underscore","tau/models/model.property"],function(_,a){return a.extend({getPropertyData:function(a){this.store.get(this.getEntityTypeName(),{id:this.getEntityId(),fields:["id",{process:["id","name",{practices:["id","name"]}]}]}).done({success:this.onEntityRetrieved,scope:this})},processProperty:function(a){var b={id:a[this.valueField],text:a[this.displayField],subtext:_.pluck(a.practices,"name").join(", ")};this.fire("dataBind",b)}})}),define("tau/components/component.property.process",["Underscore","tau/components/component.creator","tau/core/termProcessor","tau/models/model.property.process","tau/models/model.property.editable","tau/components/extensions/property/extension.property.process.refresher","tau/components/extensions/property/extension.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/property/ui.template.property"],function(_,a,b,c,d,e,f,g,h,i,j){return{create:function(g){g.propertyName="process",g.showUrl=!1,g.alignElementSelector=".property-text",g.editorComponentConfig={type:"state-list",listType:"process",maxHeight:200,filter:!1,expandable:!1,showEmptyDataMessage:!1,showClearValue:!1,allowToReset:!1,defaultValueLabel:"current",fullModeLabel:"show old",confirmation:"It is strongly recommended to NOT change Process for Projects in progress as some data will be lost (esp. the Custom fields data). Are you sure you want to change process?"},g.extensions=[e];var k=new b(g.context.getTerms()),l=g.editorComponentConfig;l.resetDisabled=g.resetDisabled,l.showEmptyDataMessage&&(l.emptyDataMessage="No "+k.getTerms(g.propertyName).names.toLowerCase()+" found"),l.showClearValue&&(g.clearValueLabel="reset "+k.getTerms(g.propertyName).name.toLowerCase());var m={ModelType:g.Model||c,template:j,extensions:_.concat([g.extensions,h,i,d,f])};return a.create(m,g)}}}),define("tau/models/model.property.severity",["Underscore","tau/models/model.property","tau/models/dataprocessor/model.processor.importance"],function(_,a,b){return a.extend({getPropertyFields:function(){var a=this._super(),b=_.union(a,["importance"]);return b},buildRequest:function(a){var b=this._super(a);return b=b.get("severity",{fields:["id","importance"]}),b},onProcessProperty:function(a){var b=this._super(a);return b.kind=this.importanceProcessor.getKind(a.importance),b},onEntityRetrieved:function(a){var c=this.property=a[0].data[this.propertyName]||{},d=_(a[1].data).pluck("importance"),e=_.min(d),f=_.max(d);this.importanceProcessor=new b(e,f),this.processProperty(c)}})}),define("tau/components/component.property.severity",["tau/components/component.property","tau/models/model.property.severity","tau/ui/templates/property/ui.template.property.severity"],function(a,b,c){return{create:function(d){return d.propertyName="severity",d.editorType="",d.showUrl=!1,d.alignElementSelector=".property-text",d.showEmptyDataMessage=!0,d.editorComponentConfig={type:"state-list",listType:"severity",maxHeight:200},d.Model=b,d.template=c,a.create(d)}}}),define("tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator",["Underscore","tau/configurator","tau/components/extensions/component.extension.base"],function(_,a,b){function d(a,b){if(_.isDate(a)&&_.isDate(b)){var d=a.getTime(),e=b.getTime(),f=Math.abs(d-e);return Math.round(f/c)}return null}var c=864e5,e=b.extend({"bus extendData":function(b){var c=b.data.dataToBind||{},e=b.data.date;c.daysPassed=d(a.getCurrentDate(),e)}});return e}),define("tau/components/component.property.impedimentDate",["Underscore","tau/components/component.property.createDate","tau/components/extensions/impedimentDate/extensions.model.impedimentDate.daysPassedCalculator","tau/components/extensions/impedimentDate/extension.ui.impedimentDate.daysPassed"],function(_,a,b,c){return{create:function(d){return d=d||{},d.extensions=_.concat([d.extensions,b,c]),a.create(d)}}}),define("tau/models/model.property.user",["tau/models/model.property","tau/configurator"],function(a,b){var c=function(a){this.model=a};c.prototype={onGetEntity:function(a){this.entity=a.data},done:function(){var a=this.entity[this.model.config.propertyName],c=a.email;if(a.firstName||a.lastName)c=_.trim([a.firstName,a.lastName].join(" "));var d={id:a.id,avatar:[b.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join(""),name:c};this.model.fire("dataBind",d)}};var d=a.extend({onInit:function(){var a=this;this.listenOfPropertyChanged();var b=a.config.context,d=b.entity.entityType.name,e=b.entity.id,f=new c(a),g={},h=this.config.propertyName;g[h]=["firstName","lastName","email"],a.store.get(d,{id:e,fields:["id",g]},{scope:f,success:f.onGetEntity}).done({scope:f,success:f.done})}});return d}),define("tau/components/component.property.owner",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="owner",a.create(j,i)}}}),define("tau/components/component.property.owner.project",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.project.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="owner",a.create(j,i)}}}),define("tau/components/component.property.owner.request",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.owner.request.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="owner",a.create(j,i)}}}),define("tau/components/component.property.responsible",["tau/components/component.creator","tau/models/model.property.user","tau/models/model.property.editable","tau/components/extensions/property/extension.property.refresher","tau/components/extensions/bubble/extensions.bubble.creator","tau/components/extensions/component.creator.extension","tau/ui/templates/common/ui.template.owner","tau/components/extensions/user/extension.responsible.editable"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={ModelType:b,template:g,extensions:[c,e,f,d,h]};return i=i||{},i.propertyName="responsible",a.create(j,i)}}}),define("tau/components/component.quick.add",["jQuery","Underscore","tau/configurator","tau/components/component.creator","tau/ui/templates/quick.add/ui.template.quick.add","tau/components/extensions/component.extension.base","tau/ui/templates/quick.add/ui.template.quick.add.content","tau/ui/templates/quick.add/ui.template.quick.add.line","tau/ui/behaviour/common/ui.behaviour.tauBubble","tau/ui/behaviour/common/ui.behaviour.editableText"],function($,_,a,b,c,d,e,f){return{create:function(g){var h=d.extend({"bus beforeInit":function(){var a=this;a.fire("dataBind",{label:this.config.label,entityType:this.config.entityType})},_attachKeyBoardHandling:function(){var b=this,c={handleKeyDown:function(){}};a.getKeyBoardManager().pushHandler(c)},_getEntityId:function(){return this.config.context.entity.id},_getEntityType:function(){return this.config.context.entity.entityType.name},"bus close":function(){var b=this;a.getKeyBoardManager().popHandler();if(!b.itemsAdded)return;b.config.store.evictProperties(b._getEntityId(),this._getEntityType(),b.config.evictProperties),setTimeout(function(){b.bus.fire(b.config.entityType+".items.added",b.config.context)},1)},_appendAddLine:function(a){var b=this,c=$(".ui-quick-add-new-item",a);if(c.length>0){setTimeout(function(){c.click()},1);return}var d=f.get().bind({},{entityType:b.config.entityType});a.find(".quick-add-lines").append(d);var e=$(".quick-add-input",d);e.editableText({restoreText:!0,resetOnBlur:!0,onSave:function(c){if(!c||!c.trim())return;c.length>255&&(c=c.substring(0,254));var f=b.config.store;if(e.hasClass("ui-quick-add-saving"))return;e.removeClass("ui-quick-add-new-item").addClass("ui-quick-add-saving");var g={name:c};g[b.config.property]={id:b._getEntityId()};var h={};h[b.config.property]=["id"];var i=["id","name",h],j={$set:g,fields:i};d.data("item-id")&&(j.id=d.data("item-id"));var k=function(c){j.$set.project={id:c.id},f.save(b.config.entityType,j,{success:function(c){d.data("item-id",c.data.id),d.addClass("ui-quick-add-item-saved"),e.removeClass("ui-quick-add-saving").text(c.data.name),b.itemsAdded=!0;var f=$(".ui-quick-add-item-saved",a).length+" item(s) saved";$(".ui-quick-add-stats",a).text(f)}}).done()};$(".ui-quick-add-stats",a).text("saving..."),f.get(b._getEntityType(),{id:b._getEntityId(),fields:[{project:["id"]}]},{success:function(a){var b=a.data.project;k(b)}}).done(),b._appendAddLine(a)}}),setTimeout(function(){e.click()},1)},"bus displayQuickAdd":function(a){var b=a.data,c=this;c.itemsAdded=!1;var d=b.popup.find(".tau-bubble__inner");if(d.find(".ui-quick-add-content").length==0){var f=e.get().bind({},{});d.append(f)}b.api.adjustPosition(),d.find(".quick-add-lines").html(""),d.find(".ui-quick-add-stats").text(""),d.find(".button-box").click(function(){b.api.hide()}),this._appendAddLine(d),c._attachKeyBoardHandling()},"bus afterRender":function(a){var b=this,c=a.data.element,d=$(".ui-quick-add-link",c).tauBubble();d.bind("show",function(a,c){b.bus.fire("displayQuickAdd",c)}),d.bind("close",function(a,c){c.event&&(c.event.preventDefault(),c.event.stopPropagation()),b.bus.fire("close",c)})}}),i={extensions:[h],template:c};return b.create(i,g)}}}),define("tau/components/extensions/requestsList/extension.requestList.actions.detach",["jQuery","tau/configurator","tau/components/extensions/component.extension.base"],function($,a,b){return b.extend({category:"edit","bus dataBind+afterRender":function(a){var b=this,c=a.dataBind.data,d=a.afterRender.data.element;if(c.items&&c.items.length){var e=$('<td class="action"></td>'),f=$('<span class="action-detach button small">Detach</span>');f.click($.proxy(b.onActionDetach,b)),e.append(f);var g=d.find("table.base-info-list tbody > tr");g.append(e)}},onActionDetach:function(b){var c=this,d=c.config.context.entity.id,e=$(b.target).parent().parent().data().tmplItem.data.id,f=a.getActionsService();f.detachRequest({generalId:d,requestId:e,success:$.proxy(c.onRequestDetachedSuccess,c)})},onRequestDetachedSuccess:function(){var a=this;a.fire("evictProperty");var b=a.config.context.entity.id;a.fire("requestIsDetachedFromEntity",{entity:{id:b}})}})}),define("tau/components/component.requestList",["tau/components/component.list.baseInfo","tau/components/extensions/requestsList/extension.requestList.refresher","tau/components/extensions/requestsList/extension.requestList.actions.detach"],function(a,b,c){return{create:function(d){var e={extensions:[b,c]};return d.typeName="request",d.propertyName="requests",a.create(d,e)}}}),define("tau/models/propertyLists/model.releaseList",["Underscore","tau/models/propertyLists/model.propertyList.base","tau/configurator","tau/store/types","tau/utils/utils.date"],function(_,a,b,c,d){return a.extend({name:"release-list",propertyType:"release",onInit:function(){var a=this.config.context.entity,b=this;this.store.get(a.entityType.name,{id:a.id,fields:["id",{project:["id",{releases:["id","name","startDate","endDate"]}]}]}).done({success:function(a){var c=a[0].data.project;b.processData.call(b,c)}})},"bus beforeSave":function(a){var b=a.data.cmd,c=b.$set,d=b.fields=b.fields||[];this.entityContainIteration()&&d.push({iteration:["id","name"]})},entityContainIteration:function(){var a=c.findByKeyword(this.config.context.entity.entityType.name);return a.refs.hasOwnProperty("iteration")},getRequiredFields:function(){return[{entityState:["id"]}]},convertReleaseToDto:function(a){var b=this.isCurrentRelease(a),c=a.name+(b?" (current)":"");return{id:a.id,name:c,description:"From "+d.format.date.short(a.startDate)+" to "+d.format.date.short(a.endDate)}},isOldRelease:function(a){var c=b.getCurrentDate();return a.endDate<c},isCurrentRelease:function(a){var c=b.getCurrentDate();return a.startDate<=c&&c<=a.endDate},isCurrentOrFeatureRelease:function(a){return!this.isOldRelease(a)},selectOldReleases:function(){return _.select(this.projectReleaseList,this.isOldRelease,this)},selectCurrentAndFeatureReleases:function(a){return _.select(this.projectReleaseList,this.isCurrentOrFeatureRelease,this)},getCurrentRelease:function(){return _.detect(this.projectReleaseList,this.isCurrentRelease,this)},initProjectReleaseList:function(a){var b=this.getCurrentEntityId(),c=_.select(a.releases,function(a){return a.id!=b});_.each(c,function(a){a.startDate=d.parse(a.startDate),a.endDate=d.parse(a.endDate)}),this.projectReleaseList=c},processData:function(a){this.initProjectReleaseList(a);var b=this.getCurrentEntityId(),c=this.config,d=c.mode||"short",e=this.selectCurrentAndFeatureReleases(),f=[],g=this.selectOldReleases(),h=g.length==0;d=="short"&&e.length>0?f=e:(d=="full",f=f.concat(g,e),h=!0),f=_.map(f,this.convertReleaseToDto,this);var i={nullableValue:b!==null&&this.config.context.entity.entityType.name.toLowerCase()!=="iteration"&&this.propertyIsNotEmpty(),states:f,completed:h},j=this.getCurrentRelease();j&&(i.defaultValue=j.id),this.fire("dataBind",i)}})}),define("tau/models/propertyLists/model.iterationList",["Underscore","tau/models/propertyLists/model.propertyList.base","tau/configurator","tau/utils/utils.date"],function(_,a,b,c){return a.extend({name:"iteration-list",propertyType:"iteration",onInit:function(){var a=this.config.context.entity,b=this;this.store.get(a.entityType.name,{id:a.id,fields:["id",{project:["id",{iterations:["id","name","startDate","endDate",{release:["id","name"]}]}]}]}).done({success:function(a){var c=a[0].data.project;b.processData.call(b,c)}})},getRequiredFields:function(){return[{entityState:["id"]}]},"bus beforeSave":function(a){var b=a.data.cmd.fields=a.data.cmd.fields||[];b.push({release:["id","name"]})},processData:function(a){var d=this.config,e=this.getCurrentEntityId(),f=[],g=d.mode||"short",h=null,i=null,j=b.getCurrentDate(),k=function(a){a.id!==e&&f.push(a)};g==="full"?h=k:h=function(a){var b=c.parse(a.startDate),d=c.parse(a.endDate);a.id!==e&&(b>=j||d>=j)&&f.push(a)},_.each(a.iterations,h),f.length==0&&(d.mode=="full",h=k,_.each(a.iterations,h));var l=[],m={};_(f).each(function(a){var b=m[a.release.id]||{id:a.release.id,name:a.release.name};b.items=b.items||[];var d=c.parse(a.startDate),e=c.parse(a.endDate),f=j>=d&&j<=e,g=a.name+(f?" (current)":"");f&&(i=a),b.items.push({id:a.id,name:g,description:"From "+c.format.date.short(d)+" to "+c.format.date.short(e)}),m[b.id]||(l.push(b),m[b.id]=b)});var n=a.iterations.length,o=e?n-1:n,p={nullableValue:e!==null&&this.propertyIsNotEmpty(),states:l,completed:0===f.length-o};i&&(p.defaultValue=i.id),this.fire("dataBind",p)}})}),define("tau/components/component.state-list",["tau/components/component.creator","tau/models/propertyLists/model.defaultList","tau/models/propertyLists/model.staticList","tau/models/propertyLists/model.entityStateList","tau/models/propertyLists/model.prioritiesList","tau/models/propertyLists/model.severityList","tau/models/propertyLists/model.releaseList","tau/models/propertyLists/model.iterationList","tau/models/propertyLists/model.userStoryList","tau/models/propertyLists/model.featureList","tau/ui/extensions/stateList/ui.extension.stateList.editable","tau/ui/templates/state/ui.template.state-list"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={entityState:d,priority:e,severity:f,release:g,iteration:h,userStory:i,feature:j,"static":c,hasModel:function(a){return this.hasOwnProperty(a)},getByName:function(a){if(this.hasModel(a))return this[a];throw"Model for property list  [mode."+a+"] was not found."}};return{create:function(c){var d=b;m.hasModel(c.listType)&&(d=m.getByName(c.listType));var e=[d,k],f={extensions:e,template:l};return a.create(f,c)}}}),define("tau/models/model.title",["tau/core/model-base","tau/configurator"],function(a,b){var c=function(a,b){this.model=a,this.appContext=b};c.prototype={onGetEntity:function(a){this.entity=a.data},setProcess:function(a){this.process=a},setProject:function(a){this.project=a},"get task subPath":function(){return"Project/Planning/UserStory"},done:function(){var a=b.getCurrentAcid()||this.appContext.acid,c={entity:this.entity,process:this.process,project:this.project,appPath:b.getApplicationPath(),url:b.getApplicationPath()+"/RestUI/TpView.aspx?acid="+a+"#"+this.entity.__type.toLowerCase()+"/"+this.entity.id};this.model.fire("dataBind",c)}};var d=a.extend({onInit:function(){var a=this,b=a.config.context,d=b.entity.entityType.name,e=b.entity.id,f=b.applicationContext.processes[0],g=new c(a,b.applicationContext);g.setProcess(f),g.setProject(b.applicationContext.selectedProjects[0]),a._signed||(a._signed=!0,a.store.on({eventName:"afterSave",type:d,listener:a,filter:{id:e},hasChanges:["name"]},function(){a.bus.fire("refresh")})),a.store.get(d,{id:e,fields:["id","name"]},{scope:g,success:g.onGetEntity}).done({scope:g,success:g.done})}});return d}),define("tau/components/component.title",["tau/components/component.creator","tau/models/model.title","tau/models/model.title.editable","tau/components/extensions/title/extension.title.editable","tau/ui/templates/title/ui.template.title"],function(a,b,c,d,e){return{create:function(f){var g={extensions:[b,c,d],template:e};return a.create(g,f)}}}),define("tau/models/model.userList",["Underscore","tau/store/types","tau/core/model-base","tau/configurator","tau/utils/utils.textsearch"],function(_,a,b,c,d){return b.extend({init:function(){this._super.apply(this,arguments),this.textSearch=new d},"bus setFilter":function(a){this.config.data.filter=a.data.filter,this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},setShowMore:function(a){this.config.data.showMore=a},"bus showMore":function(){this.setShowMore(!0),this.fire("refresh",{refreshSelector:".user-list,.footer-box"})},onInit:function(){this.fire("registerStoreRequest"),this.fire("commitTransaction",{})},"bus projectMembersReady+excludedUserReady+projectRolesReady":function(a){var b=a.projectMembersReady.data,c=a.excludedUserReady.data,d=a.projectRolesReady.data,e=[],f=[];!this.excludedUsersContainsLoggedUser(c)&&this.loggedUserInProjectTeam(b)&&(f=[{id:"assign-to-me",title:"Assign To Me"}]),this.filterIsNotEmpty()?e=this.getFilteredGroups(d,b,c):(e=this.getGroups(b,c,d),e.length==0&&(this.setShowMore(!0),e=this.getGroups(b,c,d)));var g={headerActions:f,moreAvailable:!1,groups:e};this.fire("extendDataToBind",g),this.fire("dataBind",g)},getGroups:function(a,b,c){var d=[];for(var e=0;e<c.length;e++){var f=c[e];if(this.usersForRoleIsVisible(f)){var g=this.getUsersForRole(f,a,b);g.length>0&&d.push({role:f,users:g})}}return d},isStringValidForFilter:function(a){return this.textSearch.match(a,this.config.data.filter)!==null},getFilteredGroups:function(a,b,c){var d=[];for(var e=0;e<a.length;e++){var f=a[e],g=[];if(this.isStringValidForFilter(f.name))g=this.getUsersForRole(f,b,c);else{g=this.getUsersForRole(f,b,c);var h=[];for(var i=0;i<g.length;i++)this.isStringValidForFilter(g[i].name)&&h.push(g[i]);g=h}g.length>0&&d.push({role:f,users:g})}return d},usersForRoleIsVisible:function(a){var b=this.config.data||{};if(this.isMoreAvailable()){if(b.hasOwnProperty("roleId"))return b.roleId===a.id;if(b.role)return a.id==b.role.id}return!0},userIsNotExcluded:function(a,b){if(!a.user.isActive)return!1;var c=a.user.id;if(b.constructor!=Array)return c!=b.id;for(var d=0;d<b.length;d++)if(c==b[d].id)return!1;return!0},getUsersForRole:function(a,b,c){var d=[];for(var e=0;e<b.length;e++){var f=b[e];f.role.id==a.id&&this.userIsNotExcluded(f,c)&&d.push(this.convertUser(f.user))}return d.sort(function(a,b){var c=a.name.toLowerCase(),d=b.name.toLowerCase();return c<d?-1:c>d?1:0}),d},convertUser:function(a){var b=a.email;if(a.firstName||a.lastName)b=_.trim([a.firstName,a.lastName].join(" "));return{id:a.id,name:b,role:a.role,avatar:[c.getApplicationPath(),"/Avatar.ashx?UserId=",a.id,"&size=32"].join("")}},getLoggedUser:function(){return this.config.context.getLoggedUser()},loggedUserInProjectTeam:function(a){var b=this.getLoggedUser();return _.any(a,function(a){return a.user.id===b.id})},excludedUsersContainsLoggedUser:function(a){var b=this.getLoggedUser();for(var c=0;c<a.length;c++)if(a[c].id===b.id)return!0;return!1},filterIsNotEmpty:function(){return this.config.data.filter&&this.config.data.filter.length},filterIsEmpty:function(){return!this.filterIsNotEmpty()},isMoreAvailable:function(){var a=this.config.data;return this.filterIsEmpty()&&a.showMore!==!0&&(a.hasOwnProperty("roleId")||a.hasOwnProperty("role"))},destroy:function(){this.project=null,this.entity=null,this._super()}})}),define("tau/components/component.userList",["Underscore","tau/components/component.creator","tau/models/model.userList","tau/models/assignmentsList/extension.model.store.operations","tau/models/extensions/team/extension.model.teamOfEntityRetriever","tau/models/userList/extension.model.assignmentsUser.Excluder","tau/components/extensions/userList/extension.userList.editable","tau/ui/templates/filteredUserList/ui.template.filteredUserList"],function(_,a,b,c,d,e,f,g){return{create:function(h){var i=[];_.isArray(h.extensions)&&(i=_.clone(h.extensions));var j={extensions:i,template:g};return i.push(b),i.push(f),i.push(c),i.push(h.Retriever||d),i.push(h.UserExcluder||e),a.create(j,h)}}}),define("tau/ui/templates/common/ui.template.entityLink",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/common/ui.template.entityLink"],function(a,b){var c={tags:[b],name:"entity-link",markup:['<a href="#${__type.toLowerCase()}/${id}" class="ui-link-entity">','<em class="ui-type-icon ui-type-icon-${__type.toLowerCase()}">${id}</em>',"</a>&nbsp;&nbsp;"],dependencies:[]};return a.register(c)}),define("tau/ui/templates/revisionList/ui.template.revisionList.files",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"revision-list-files",markup:["<tr>",'   <td class="actions"><span>${fileAction}</span></td>','   <td class="diff"></td>','   <td class="files"><a target="_blank" class="vcsViewDisabled" disabled="disabled">${fileName}</a></td>',"</tr>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/ui/templates/revisionList/ui.template.revisionList.revision",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink","tau/ui/templates/revisionList/ui.template.revisionList.files"],function(a){var b={name:"revision-list-revision",markup:['<tbody class="collapsed">','   <tr class="first-row">','       <td class="toggler"><button class="extra-info expand" type="button"><div>+</div></button></td>','       <td class="revision-id">#&nbsp;${sourceControlId}</td>','       <td class="revision">${commitDate}&nbsp;by&nbsp;<span class="author">${author}</span></td>','       <td class="revision-comment">${description}</td>',"   </tr>",'   <tr class="revision-files second-row">',"       <td></td>",'       <td colspan="3">',"           <table>",'           {{tmpl(revisionFiles) "revision-list-files"}}',"           </table>","       </td>","   </tr>","</tbody>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/ui/templates/revisionList/ui.template.revisionList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/revisionList/ui.template.revisionList.revision"],function(a,b){var c={name:"revision-list",options:{contentSelector:".ui-revisionList-content"},tags:[b],markup:['<div class="ui-revisionList">','   <div class="ui-revisionList-content"{{if items.length === 0}} style="display:none"{{/if}}>','       <table class="ui-revisionList">',"           <colgroup>",'               <col class="toggler">','               <col class="revision-id">','               <col class="revision">','               <col class="comment">',"           </colgroup>","           <thead>","               <tr>",'                   <th class="toggler"></th>','                   <th class="revision-id"></th>','                   <th class="revision"></th>','                   <th class="comment"></th>',"               </tr>","           </thead>",'           {{tmpl(items) "revision-list-revision"}}',"       </table>","   </div>","</div>"].join(""),dependencies:["revision-list-revision"]};return a.register(c)}),define("tau/components/component.revisionList",["tau/components/component.list.creator","tau/models//model.revisionList","tau/ui/extensions/testCaseList/ui.extension.testCaseList","tau/ui/templates/revisionList/ui.template.revisionList","tau/ui/extensions/revisionList/ui.extension.revisionList.showDiff","tau/ui/templates/common/ui.template.entityLink"],function(a,b,c,d,e){return{create:function(f){var g={template:d,extensions:[b,c,e],message:"No revisions found"};return a.create(g,f)}}}),define("tau/ui/templates/testCaseList/ui.template.testCaseList.testCase",["tau/core/templates-factory","tau/ui/templates/common/ui.template.entityLink"],function(a){var b={name:"test-case-list-test-case",markup:['<tbody class="collapsed">',"   <tr>",'       <td class="toggler"><button class="extra-info expand" type="button"><div>+</div></button></td>','       <td class="testcase-id">','           {{tmpl($data) "entity-link"}}',"       </td>","       <td>${name}</td>","       <td>${lastRunDate}</td>","       <td>","{{if  lastRunStatus }}","   {{if lastRunStatus.isPassed === true}}",'       <span class="passed">Passed</span>',"   {{/if}}","   {{if lastRunStatus.isPassed === false}}",'       <span class="failed">Failed</span>',"   {{/if}}","{{/if}}",'       <td class="buttons hidden">','           <button class="passed green-button" type="button">Pass</button>','           <button class="failed  red-button" type="button">Fail</button>',"       </td>","</td>","   </tr>","   <tr>","       <td></td>",'       <td colspan="5">','           <div class="steps">',"               <h4>Steps</h4>","               <span>{{html steps}}</span>","           </div>",'           <div class="success">',"               <h4>Success</h4>","               <span>{{html success}}</span>","           </div>","       </td>","   </tr>","</tbody>"].join(""),dependencies:["entity-link"]};return a.register(b)}),define("tau/ui/templates/testCaseList/ui.template.testCaseList",["tau/core/templates-factory","tau/ui/tags/ui.tag.term","tau/ui/templates/testCaseList/ui.template.testCaseList.testCase"],function(a,b){var c={name:"test-case-list",options:{contentSelector:".ui-testCaseList-content"},tags:[b],markup:['<div class="ui-testCaseList">','   <div class="button-panel">','       <button class="tau-add-testCase" type="button">${labelAdd} {{term("TestCase") "name"}}</button>',"   </div>",'   <div class="ui-testCaseList-content"{{if items.length === 0}} style="display:none"{{/if}}>','       <table class="ui-testCaseList">',"           <colgroup>",'               <col class="toggler">','               <col class="id">','               <col class="name">','               <col class="last-run-date">','               <col class="last-status">','               <col class="last-run">',"           </colgroup>","           <thead>","               <tr>",'                   <th class="toggler">','                       <button class="extra-info expand" type="button"><div>+</div></button>','                        <button class="extra-info collapse" type="button"><div>-</div></button>',"                   </th>",'                   <th class="identificator">ID</th>',"                   <th>Name</th>","                   <th>Last Run Date</th>","                   <th>Last Status</th>",'                   <th class="last-run">Run</th>',"               </tr>","           </thead>",'           {{tmpl(items) "test-case-list-test-case"}}',"       </table>","   </div>","</div>"].join(""),dependencies:["test-case-list-test-case"]};return a.register(c)}),define("tau/components/component.testCaseList",["tau/components/component.list.creator","tau/models/model.testCaseList","tau/models/model.testCaseList.editable","tau/components/extensions/testCaseList/extension.testCaseList.edit.addTestCase","tau/components/extensions/testCaseList/extension.testCaseList.edit.runner","tau/components/extensions/testCaseList/extension.testCaseList.refresher","tau/ui/templates/testCaseList/ui.template.testCaseList","tau/ui/extensions/testCaseList/ui.extension.testCaseList"],function(a,b,c,d,e,f,g,h){return{create:function(i){var j={template:g,extensions:[b,c,h,i.addTestCaseExtension||d,e,f],message:"No test cases found"};return a.create(j,i)}}}),define("libs.tests/nodeunit/core",["libs/async/async","./types","./nodeunit"],function(a,b,c){var exports={},d=function(a){if(_.isObject(a)==0)return[];if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},e=function(a){var b={},c=d(a);for(var e=0;e<c.length;e+=1)b[c[e]]=a[c[e]];return b};exports.runTest=function(a,c,d,e){var f=b.options(d);f.testStart(a,d.moduleId);var g=(new Date).getTime(),h=b.test(a,g,f,e);try{c(h)}catch(i){h.done(i)}},exports.runSuite=function(b,c,e,f){c=h(c);var g=d(c),i=b,j="concatSeries";e.execution=="parallel"&&(j="concat"),e.shuffle&&(g=_.shuffle(g)),a[j](g,function(a,b){var d=c[a],f;f=i?[].concat(i,a):[a],f.toString=function(){return this.join(" ")};if(typeof d=="function"){var g=!0,h=e.filter,j=f.toString();h&&(g=j.search(h)==0);if(g)e.moduleStart&&e.moduleStart(),exports.runTest(f,c[a],e,b);else return b()}else exports.runSuite(f,c[a],e,b)},f)},exports.runModule=function(a,module,c,d){function j(){g||(g=!0,i(module))}var f=e(b.options(c)),g=!1,i=f.moduleStart;module=h(module),f.moduleStart=j,f.moduleId=module.id;var k=(new Date).getTime();exports.runSuite(a,module,f,function(a,c){var e=(new Date).getTime(),g=b.assertionList(c,e-k);f.moduleDone(module,g),d(null,c)})},exports.runModules=function(c,e){var f=[],g=b.options(e),h=(new Date).getTime(),i="concatSeries";e.execution=="parallel"&&(i="concat"),g.shuffle&&(c=_.shuffle(c)),a[i](d(c),function(a,b){exports.runModule(c[a].name||a,c[a],g,b)},function(a,c){var d=(new Date).getTime();g.done(b.assertionList(c,d-h))})};var f=function(a,c,d){return function(e){var f={};if(c){var g=e.done;e.done=function(a){try{c.call(f,function(c){if(a&&c)return e._assertion_list.push(b.assertion({error:a})),g(c);g(a||c)})}catch(d){g(d)}}}a?a.call(f,function(a){if(a)return e.done(a);d.call(f,e)}):d.call(f,e)}},g=function(b){return b.length?function(c){var d=this,e=[];for(var f=0,g=b.length;f<g;f++)(function(a){e.push(function(){return b[a].apply(d,arguments)})})(f);return a.series(e,c)}:null},h=function(a,b,c){var e={},b=b?b.slice():[],c=c?c.slice():[];a.setUp&&(b.push(a.setUp),delete a.setUp),a.tearDown&&(c.unshift(a.tearDown),delete a.tearDown);var i=d(a);for(var j=0;j<i.length;j+=1){var k=i[j];typeof a[k]=="function"?e[k]=f(g(b),g(c),a[k]):typeof a[k]=="object"&&k.substr(0,1)!="_"?e[k]=h(a[k],b,c):e[k]=a[k]}return e};return exports.testCase=function(a){return a},exports}),define("libs.tests/nodeunit/nodeunit",["libs/async/async","./core","./assert","./types","./reporters/browser","./extensions/assert-expressions"],function(a,b,c,d,e,f){var g=b;return g.assert=c,g.reporter=e,g.run=e(g).run,g.assert.equalByExpression=function(b,c,d){f.assert(b,c)||g.assert._fail(b,c,d,"==")},g}),define("tau/components/extensions/testrunner/extension.driver.nodeunit",["jQuery","Underscore","tau/components/extensions/component.extension.base","libs.tests/nodeunit/nodeunit","libs/underscore/underscore.string","libs/parseUri","tau/configurator","tau/utils/utils.storage"],function($,_,a,b,c,d,e,f){return a.extend({"bus afterInit":function(a){$.fx.off=!0;var c=_.compact(a.data.config.files),g=d(document.location.href).queryKey;_.forEach(g,function(a,b){g[b]=decodeURIComponent(a)});var h={file:null,filter:null,data:"local",view:"list",shuffle:!1,execution:"serial"};g.apply?(_.defaults(g,h),delete g.apply,f.set("testrunner.nodeunit",g)):g.reset?(delete g.reset,g=h,f.set("testrunner.nodeunit",g)):g.reset_filters&&(delete g.reset_filters,g.file="",g.filter="",f.set("testrunner.nodeunit",g)),g=_.defaults(g,f.get("testrunner.nodeunit")||h),e.setConfig("real",g.data=="remote"),g.bus=this.bus,g.file&&(c=_.filter(c,function(a){return a.search(g.file)==0}));var i=this;require(c,function(){var a=_.compact(_.toArray(arguments));_.forEach(a,function(module,a){c[a]?module.file=c[a]:module.file="",module.name||(module.name=_.camelCase(module.file)),module.id="module_"+_.uniqueId()});if(g.filter){var d=[];d=_.filter(a,function(module){return module.name.search(g.filter)==0}),d.length==0&&(d=_.filter(a,function(module){return g.filter.search(module.name)==0})),a=d}i.fire("dataBind",{modules:a,options:g,useragent:navigator.userAgent}),b.run(a,g)})}})}),define("tau/components/component.testrunner",["tau/core/component-base","tau/components/extensions/testrunner/extension.stylesheets","tau/components/extensions/testrunner/extension.driver.qunit","tau/components/extensions/testrunner/extension.driver.nodeunit","tau/components/extensions/testrunner/extension.driver.nodeunit.reporter","tau/core/view-base","tau/ui/templates/testrunner/ui.template.testrunner.qunit","tau/ui/templates/testrunner/ui.template.testrunner.nodeunit"],function(a,b,c,d,e,f,g,h){var i={create:function(i){var j={qunit:{extensions:[c],template:g,stylesheets:["libs.tests/qunit.css","libs.tests/extension.qunit.css"]},nodeunit:{extensions:[d,e],template:h,stylesheets:["libs.tests/nodeunit/nodeunit.css"]}},k=i.type||"qunit",l=j[k],m={name:"testrunner",template:l.template},n=new a(m);return i.stylesheets=l.stylesheets,_.forEach(_.toArray(l.extensions),function(a){n.attach(a,i)}),n.attach(b,i).attach(f),n.bus}};return i}),require(["tau/components/component.additionalInfo","tau/components/component.application.boardPlus","tau/components/component.application","tau/components/component.assignedEffort","tau/components/component.assignmentsList","tau/components/component.attachments","tau/components/component.attachmentsPreview","tau/components/component.audit.history","tau/components/component.board.container","tau/components/component.board.grid","tau/components/component.board.header","tau/components/component.board.overview","tau/components/component.board.plus","tau/components/component.board.plus.list","tau/components/component.board.selector","tau/components/component.board.settings","tau/components/component.board.zoomLevel","tau/components/component.breadcrumbs","tau/components/component.collapsible","tau/components/component.collapsibleHeader","tau/components/component.comment","tau/components/component.comment.new.editor","tau/components/component.commentList","tau/components/component.comments","tau/components/component.container","tau/components/component.creator","tau/components/component.customField.checkbox","tau/components/component.customField.date","tau/components/component.customField.dropdown","tau/components/component.customField.dropdown.list","tau/components/component.customField.entity","tau/components/component.customField.multiselect","tau/components/component.customField.multiselect.list","tau/components/component.customField.number","tau/components/component.customField.richtext","tau/components/component.customField.text","tau/components/component.customField.url.editor","tau/components/component.customField.url","tau/components/component.description","tau/components/component.diagnostics.globalListeners","tau/components/component.diagnostics","tau/components/component.diagnostics.store","tau/components/component.duplicateBugList","tau/components/component.duplicateBugListPanel","tau/components/component.editor.requester","tau/components/component.entity.actions","tau/components/component.entityStateList","tau/components/component.feature.assignmentList","tau/components/component.feature.totalEffort","tau/components/component.field.richText","tau/components/component.finder","tau/components/component.finder.requesters","tau/components/component.impedimentList","tau/components/component.impedimentListPanel","tau/components/component.implementationHistory","tau/components/component.iteration.progressBar","tau/components/component.label.duplicateBugCount","tau/components/component.label.impedimentsCount","tau/components/component.label","tau/components/component.leadCycleTime","tau/components/component.list.baseInfo","tau/components/component.list.creator","tau/components/component.list.editable","tau/components/component.list","tau/components/component.lookswitcher","tau/components/component.menu.actions","tau/components/component.menu.actions.testplanrun","tau/components/component.menu.testPlanRun","tau/components/component.page.base","tau/components/component.page.board","tau/components/component.page.entity","tau/components/component.pluginsList","tau/components/component.print","tau/components/component.progressBar","tau/components/component.progressBar.small","tau/components/component.property.abbreviation","tau/components/component.property.assignable","tau/components/component.property.bool","tau/components/component.property.build","tau/components/component.property.build.testPlanRun","tau/components/component.property.buildDate","tau/components/component.property.company","tau/components/component.property.completeDate","tau/components/component.property.createDate","tau/components/component.property.date","tau/components/component.property.effort","tau/components/component.property.email","tau/components/component.property.endDate","tau/components/component.property.endDate.list","tau/components/component.property.endDate.project","tau/components/component.property.entityState","tau/components/component.property.feature","tau/components/component.property.impedimentDate","tau/components/component.property.initialEstimate","tau/components/component.property.isActive","tau/components/component.property.isPrivate","tau/components/component.property.isProduct","tau/components/component.property.iteration","tau/components/component.property","tau/components/component.property.lastFailureComment","tau/components/component.property.lastRunDate","tau/components/component.property.lastRunDate.list","tau/components/component.property.lastStatus","tau/components/component.property.owner","tau/components/component.property.owner.project","tau/components/component.property.owner.request","tau/components/component.property.priority","tau/components/component.property.process","tau/components/component.property.program","tau/components/component.property.project","tau/components/component.property.release","tau/components/component.property.requestSource","tau/components/component.property.requestType","tau/components/component.property.responsible","tau/components/component.property.severity","tau/components/component.property.startDate","tau/components/component.property.startDate.project","tau/components/component.property.status.testCaseRun","tau/components/component.property.testPlan","tau/components/component.property.text","tau/components/component.property.time","tau/components/component.property.timeInterval","tau/components/component.property.userStory","tau/components/component.property.velocity","tau/components/component.quick.add","tau/components/component.redirect","tau/components/component.release.assignedEffort","tau/components/component.release.progressBar","tau/components/component.releaseNotes","tau/components/component.requestList","tau/components/component.revisionList","tau/components/component.state-list","tau/components/component.steps","tau/components/component.success","tau/components/component.tabs","tau/components/component.tabsHeader","tau/components/component.tags","tau/components/component.testCaseList","tau/components/component.testCasesRunResults","tau/components/component.testrunner","tau/components/component.timeList","tau/components/component.title","tau/components/component.userList","tau/components/extensions/print.convert.extension"],function(){return{}}),define("all.components",function(){})