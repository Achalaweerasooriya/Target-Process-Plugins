
//     Underscore.js 1.3.3
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

define('libs/underscore',[],function(){return function(){function eq(a,b,stack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&_.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&_.isFunction(b.isEqual))return b.isEqual(a);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var length=stack.length;while(length--)if(stack[length]==a)return!0;stack.push(a);var size=0,result=!0;if(className=="[object Array]"){size=a.length,result=size==b.length;if(result)while(size--)if(!(result=size in a==size in b&&eq(a[size],b[size],stack)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var key in a)if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],stack)))break}if(result){for(key in b)if(_.has(b,key)&&!(size--))break;result=!size}}return stack.pop(),result}var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return new wrapper(obj)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.3.3";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++)if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return obj==null?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)}),obj.length===+obj.length&&(results.length=obj.length),results)},_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;obj==null&&(obj=[]);if(nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;obj==null&&(obj=[]);if(nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var reversed=_.toArray(obj).reverse();return context&&!initial&&(iterator=_.bind(iterator,context)),initial?_.reduce(reversed,iterator,memo,context):_.reduce(reversed,iterator)},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){if(iterator.call(context,value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return obj==null?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&(results[results.length]=value)}),results)},_.reject=function(obj,iterator,context){var results=[];return obj==null?results:(each(obj,function(value,index,list){iterator.call(context,value,index,list)||(results[results.length]=value)}),results)},_.every=_.all=function(obj,iterator,context){var result=!0;return obj==null?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker}),!!result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return obj==null?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker}),!!result)};_.include=_.contains=function(obj,target){var found=!1;return obj==null?found:nativeIndexOf&&obj.indexOf===nativeIndexOf?obj.indexOf(target)!=-1:(found=any(obj,function(value){return value===target}),found)},_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method||value:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var shuffled=[],rand;return each(obj,function(value,index,list){rand=Math.floor(Math.random()*(index+1)),shuffled[index]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sortBy=function(obj,val,context){var iterator=_.isFunction(val)?val:function(obj){return obj[val]};return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a===void 0?1:b===void 0?-1:a<b?-1:a>b?1:0}),"value")},_.groupBy=function(obj,val){var result={},iterator=_.isFunction(val)?val:function(obj){return obj[val]};return each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)}),result},_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):_.isArguments(obj)?slice.call(obj):obj.toArray&&_.isFunction(obj.toArray)?obj.toArray():_.values(obj):[]},_.size=function(obj){return _.isArray(obj)?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))},_.last=function(array,n,guard){return n!=null&&!guard?slice.call(array,Math.max(array.length-n,0)):array[array.length-1]},_.rest=_.tail=function(array,index,guard){return slice.call(array,index==null||guard?1:index)},_.compact=function(array){return _.filter(array,function(value){return!!value})},_.flatten=function(array,shallow){return _.reduce(array,function(memo,value){return _.isArray(value)?memo.concat(shallow?value:_.flatten(value)):(memo[memo.length]=value,memo)},[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array,results=[];return array.length<3&&(isSorted=!0),_.reduce(initial,function(memo,value,index){if(isSorted?_.last(memo)!==value||!memo.length:!_.include(memo,value))memo.push(value),results.push(array[index]);return memo},[]),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=_.flatten(slice.call(arguments,1),!0);return _.filter(array,function(value){return!_.include(rest,value)})},_.zip=function(){var args=slice.call(arguments),length=_.max(_.pluck(args,"length")),results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results},_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(i in array&&array[i]===item)return i;return-1},_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(i in array&&array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);while(idx<len)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(this instanceof bound){ctor.prototype=func.prototype;var self=new ctor,result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return func.apply(context,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);return funcs.length==0&&(funcs=_.functions(obj)),each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait){var context,args,timeout,throttling,more,result,whenDone=_.debounce(function(){more=throttling=!1},wait);return function(){context=this,args=arguments;var later=function(){timeout=null,more&&func.apply(context,args),whenDone()};return timeout||(timeout=setTimeout(later,wait)),throttling?more=!0:result=func.apply(context,args),whenDone(),throttling=!0,result}},_.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)};immediate&&!timeout&&func.apply(context,args),clearTimeout(timeout),timeout=setTimeout(later,wait)}},_.once=function(func){var ran=!1,memo;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments))}},_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments,0));return wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return times<=0?func():function(){if(--times<1)return func.apply(this,arguments)}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&(keys[keys.length]=key);return keys},_.values=function(obj){return _.map(obj,_.identity)},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var result={};return each(_.flatten(slice.call(arguments,1)),function(key){key in obj&&(result[key]=obj[key])}),result},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]==null&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isEqual=function(a,b){return eq(a,b,[])},_.isEmpty=function(obj){if(obj==null)return!0;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!!obj&&obj.nodeType==1},_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"},_.isObject=function(obj){return obj===Object(obj)},_.isArguments=function(obj){return toString.call(obj)=="[object Arguments]"},_.isArguments(arguments)||(_.isArguments=function(obj){return!!obj&&!!_.has(obj,"callee")}),_.isFunction=function(obj){return toString.call(obj)=="[object Function]"},_.isString=function(obj){return toString.call(obj)=="[object String]"},_.isNumber=function(obj){return toString.call(obj)=="[object Number]"},_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj)},_.isNaN=function(obj){return obj!==obj},_.isBoolean=function(obj){return obj===!0||obj===!1||toString.call(obj)=="[object Boolean]"},_.isDate=function(obj){return toString.call(obj)=="[object Date]"},_.isRegExp=function(obj){return toString.call(obj)=="[object RegExp]"},_.isNull=function(obj){return obj===null},_.isUndefined=function(obj){return obj===void 0},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)},_.escape=function(string){return(""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/.^/,escapes={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var p in escapes)escapes[escapes[p]]=p;var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g,unescaper=/\\(\\|'|r|n|t|u2028|u2029)/g,unescape=function(code){return code.replace(unescaper,function(match,escape){return escapes[escape]})};_.template=function(text,data,settings){settings=_.defaults(settings||{},_.templateSettings);var source="__p+='"+text.replace(escaper,function(match){return"\\"+escapes[match]}).replace(settings.escape||noMatch,function(match,code){return"'+\n_.escape("+unescape(code)+")+\n'"}).replace(settings.interpolate||noMatch,function(match,code){return"'+\n("+unescape(code)+")+\n'"}).replace(settings.evaluate||noMatch,function(match,code){return"';\n"+unescape(code)+"\n;__p+='"})+"';\n";settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+source+"return __p;\n";var render=new Function(settings.variable||"obj","_",source);if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj},addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);return unshift.call(args,this._wrapped),result(func.apply(_,args),this._chain)}};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){var wrapped=this._wrapped;method.apply(wrapped,arguments);var length=wrapped.length;return(name=="shift"||name=="splice")&&length===0&&delete wrapped[0],result(wrapped,this._chain)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}}),wrapper.prototype.chain=function(){return this._chain=!0,this},wrapper.prototype.value=function(){return this._wrapped}}.call(this),_});
/*! Copyright (c) 2011, Lloyd Hilaiel, ISC License */

define('libs/jsonselect',[],function(){return function(exports){function jsonParse(str){try{return JSON&&JSON.parse?JSON.parse(str):(new Function("return "+str))()}catch(e){te("ijs",e.message)}}function te(ec,context){throw new Error(errorCodes[ec]+(context&&" in '"+context+"'"))}function lex(str,off){off||(off=0);var m=pat.exec(str.substr(off));if(!m)return undefined;off+=m[0].length;var a;return m[1]?a=[off," "]:m[2]?a=[off,m[0]]:m[3]?a=[off,toks.typ,m[0]]:m[4]?a=[off,toks.psc,m[0]]:m[5]?a=[off,toks.psf,m[0]]:m[6]?te("upc",str):m[8]?a=[off,m[7]?toks.ide:toks.str,jsonParse(m[8])]:m[9]?te("ujs",str):m[10]&&(a=[off,toks.ide,m[10].replace(/\\([^\r\n\f0-9a-fA-F])/g,"$1")]),a}function is(o,t){return typeof o===t}function exprLex(str,off){var v,m=exprPat.exec(str.substr(off));if(m)return off+=m[0].length,v=m[1]||m[2]||m[3]||m[5]||m[6],m[1]||m[2]||m[3]?[off,0,jsonParse(v)]:m[4]?[off,0,undefined]:[off,v]}function exprParse2(str,off){off||(off=0);var l=exprLex(str,off),lhs;if(l&&l[1]==="("){lhs=exprParse2(str,l[0]);var p=exprLex(str,lhs[0]);(!p||p[1]!==")")&&te("epex",str),off=p[0],lhs=["(",lhs[1]]}else!l||l[1]&&l[1]!="x"?te("ee",str+" - "+(l[1]&&l[1])):(lhs=l[1]==="x"?undefined:l[2],off=l[0]);var op=exprLex(str,off);if(!op||op[1]==")")return[off,lhs];(op[1]=="x"||!op[1])&&te("bop",str+" - "+(op[1]&&op[1]));var rhs=exprParse2(str,op[0]);off=rhs[0],rhs=rhs[1];var v;if(typeof rhs!="object"||rhs[0]==="("||operators[op[1]][0]<operators[rhs[1]][0])v=[lhs,op[1],rhs];else{v=rhs;while(typeof rhs[0]=="object"&&rhs[0][0]!="("&&operators[op[1]][0]>=operators[rhs[0][1]][0])rhs=rhs[0];rhs[0]=[lhs,op[1],rhs[0]]}return[off,v]}function exprParse(str,off){function deparen(v){return typeof v!="object"||v===null?v:v[0]==="("?deparen(v[1]):[deparen(v[0]),v[1],deparen(v[2])]}var e=exprParse2(str,off?off:0);return[e[0],deparen(e[1])]}function exprEval(expr,x){if(expr===undefined)return x;if(expr===null||typeof expr!="object")return expr;var lhs=exprEval(expr[0],x),rhs=exprEval(expr[2],x);return operators[expr[1]][1](lhs,rhs)}function parse(str,off,nested,hints){nested||(hints={});var a=[],am,readParen;off||(off=0);for(;;){var s=parse_selector(str,off,hints);a.push(s[1]),s=lex(str,off=s[0]),s&&s[1]===" "&&(s=lex(str,off=s[0]));if(!s)break;if(s[1]===">"||s[1]==="~")s[1]==="~"&&(hints.usesSiblingOp=!0),a.push(s[1]),off=s[0];else if(s[1]===",")am===undefined?am=[",",a]:am.push(a),a=[],off=s[0];else if(s[1]===")"){nested||te("ucp",s[1]),readParen=1,off=s[0];break}}nested&&!readParen&&te("mcp",str),am&&am.push(a);var rv;return!nested&&hints.usesSiblingOp?rv=normalize(am?am:a):rv=am?am:a,[off,rv]}function normalizeOne(sel){var sels=[],s;for(var i=0;i<sel.length;i++)if(sel[i]==="~"){if(i<2||sel[i-2]!=">")s=sel.slice(0,i-1),s=s.concat([{has:[[{pc:":root"},">",sel[i-1]]]},">"]),s=s.concat(sel.slice(i+1)),sels.push(s);if(i>1){var at=sel[i-2]===">"?i-3:i-2;s=sel.slice(0,at);var z={};for(var k in sel[at])sel[at].hasOwnProperty(k)&&(z[k]=sel[at][k]);z.has||(z.has=[]),z.has.push([{pc:":root"},">",sel[i-1]]),s=s.concat(z,">",sel.slice(i+1)),sels.push(s)}break}return i==sel.length?sel:sels.length>1?[","].concat(sels):sels[0]}function normalize(sels){if(sels[0]===","){var r=[","];for(var i=i;i<sels.length;i++){var s=normalizeOne(s[i]);r=r.concat(s[0]===","?s.slice(1):s)}return r}return normalizeOne(sels)}function parse_selector(str,off,hints){var soff=off,s={},l=lex(str,off);l&&l[1]===" "&&(soff=off=l[0],l=lex(str,off)),l&&l[1]===toks.typ?(s.type=l[2],l=lex(str,off=l[0])):l&&l[1]==="*"&&(l=lex(str,off=l[0]));for(;;){if(l===undefined)break;if(l[1]===toks.ide)s.id&&te("nmi",l[1]),s.id=l[2];else if(l[1]===toks.psc)(s.pc||s.pf)&&te("mpc",l[1]),l[2]===":first-child"?(s.pf=":nth-child",s.a=0,s.b=1):l[2]===":last-child"?(s.pf=":nth-last-child",s.a=0,s.b=1):s.pc=l[2];else{if(l[1]!==toks.psf)break;if(l[2]===":val"||l[2]===":contains")s.expr=[undefined,l[2]===":val"?"=":"*=",undefined],l=lex(str,off=l[0]),l&&l[1]===" "&&(l=lex(str,off=l[0])),(!l||l[1]!=="(")&&te("pex",str),l=lex(str,off=l[0]),l&&l[1]===" "&&(l=lex(str,off=l[0])),(!l||l[1]!==toks.str)&&te("sex",str),s.expr[2]=l[2],l=lex(str,off=l[0]),l&&l[1]===" "&&(l=lex(str,off=l[0])),(!l||l[1]!==")")&&te("epex",str);else if(l[2]===":has"){l=lex(str,off=l[0]),l&&l[1]===" "&&(l=lex(str,off=l[0])),(!l||l[1]!=="(")&&te("pex",str);var h=parse(str,l[0],!0);l[0]=h[0],s.has||(s.has=[]),s.has.push(h[1])}else if(l[2]===":expr"){s.expr&&te("mexp",str);var e=exprParse(str,l[0]);l[0]=e[0],s.expr=e[1]}else{(s.pc||s.pf)&&te("mpc",str),s.pf=l[2];var m=nthPat.exec(str.substr(l[0]));m||te("mepf",str),m[5]?(s.a=2,s.b=m[5]==="odd"?1:0):m[6]?(s.a=0,s.b=parseInt(m[6],10)):(s.a=parseInt((m[1]?m[1]:"+")+(m[2]?m[2]:"1"),10),s.b=m[3]?parseInt(m[3]+m[4],10):0),l[0]+=m[0].length}}l=lex(str,off=l[0])}return soff===off&&te("se",str),[off,s]}function isArray(o){return Array.isArray?Array.isArray(o):toString.call(o)==="[object Array]"}function mytypeof(o){if(o===null)return"null";var to=typeof o;return to==="object"&&isArray(o)&&(to="array"),to}function mn(node,sel,id,num,tot){var sels=[],cs=sel[0]===">"?sel[1]:sel[0],m=!0,mod;cs.type&&(m=m&&cs.type===mytypeof(node)),cs.id&&(m=m&&cs.id===id),m&&cs.pf&&(cs.pf===":nth-last-child"?num=tot-num:num++,cs.a===0?m=cs.b===num:(mod=(num-cs.b)%cs.a,m=!mod&&num*cs.a+cs.b>=0));if(m&&cs.has){var bail=function(){throw 42};for(var i=0;i<cs.has.length;i++){try{forEach(cs.has[i],node,bail)}catch(e){if(e===42)continue}m=!1;break}}return m&&cs.expr&&(m=exprEval(cs.expr,node)),sel[0]!==">"&&sel[0].pc!==":root"&&sels.push(sel),m&&(sel[0]===">"?sel.length>2&&(m=!1,sels.push(sel.slice(2))):sel.length>1&&(m=!1,sels.push(sel.slice(1)))),[m,sels]}function forEach(sel,obj,fun,id,num,tot){var a=sel[0]===","?sel.slice(1):[sel],a0=[],call=!1,i=0,j=0,k,x;for(i=0;i<a.length;i++){x=mn(obj,a[i],id,num,tot),x[0]&&(call=!0);for(j=0;j<x[1].length;j++)a0.push(x[1][j])}if(a0.length&&typeof obj=="object"){a0.length>=1&&a0.unshift(",");if(isArray(obj))for(i=0;i<obj.length;i++)forEach(a0,obj[i],fun,undefined,i,obj.length);else for(k in obj)obj.hasOwnProperty(k)&&forEach(a0,obj[k],fun,k)}call&&fun&&fun(obj)}function match(sel,obj){var a=[];return forEach(sel,obj,function(x){a.push(x)}),a}function compile(sel){return{sel:parse(sel)[1],match:function(obj){return match(this.sel,obj)},forEach:function(obj,fun){return forEach(this.sel,obj,fun)}}}var toString=Object.prototype.toString,errorCodes={bop:"binary operator expected",ee:"expression expected",epex:"closing paren expected ')'",ijs:"invalid json string",mcp:"missing closing paren",mepf:"malformed expression in pseudo-function",mexp:"multiple expressions not allowed",mpc:"multiple pseudo classes (:xxx) not allowed",nmi:"multiple ids not allowed",pex:"opening paren expected '('",se:"selector expected",sex:"string expected",sra:"string required after '.'",uc:"unrecognized char",ucp:"unexpected closing paren",ujs:"unclosed json string",upc:"unrecognized pseudo class"},toks={psc:1,psf:2,typ:3,str:4,ide:5},pat=new RegExp('^(?:([\\r\\n\\t\\ ]+)|([~*,>\\)\\(])|(string|boolean|null|array|object|number)|(:(?:root|first-child|last-child|only-child))|(:(?:nth-child|nth-last-child|has|expr|val|contains))|(:\\w+)|(?:(\\.)?(\\"(?:[^\\\\\\"]|\\\\[^\\"])*\\"))|(\\")|\\.((?:[_a-zA-Z]|[^\\0-\\0177]|\\\\[^\\r\\n\\f0-9a-fA-F])(?:[_a-zA-Z0-9\\-]|[^\\u0000-\\u0177]|(?:\\\\[^\\r\\n\\f0-9a-fA-F]))*))'),nthPat=/^\s*\(\s*(?:([+\-]?)([0-9]*)n\s*(?:([+\-])\s*([0-9]))?|(odd|even)|([+\-]?[0-9]+))\s*\)/,exprPat=new RegExp('^\\s*(?:(true|false|null)|(-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)|("(?:[^\\]|\\[^"])*")|(x)|(&&|\\|\\||[\\$\\^<>!\\*]=|[=+\\-*/%<>])|([\\(\\)]))'),operators={"*":[9,function(lhs,rhs){return lhs*rhs}],"/":[9,function(lhs,rhs){return lhs/rhs}],"%":[9,function(lhs,rhs){return lhs%rhs}],"+":[7,function(lhs,rhs){return lhs+rhs}],"-":[7,function(lhs,rhs){return lhs-rhs}],"<=":[5,function(lhs,rhs){return is(lhs,"number")&&is(rhs,"number")&&lhs<=rhs}],">=":[5,function(lhs,rhs){return is(lhs,"number")&&is(rhs,"number")&&lhs>=rhs}],"$=":[5,function(lhs,rhs){return is(lhs,"string")&&is(rhs,"string")&&lhs.lastIndexOf(rhs)===lhs.length-rhs.length}],"^=":[5,function(lhs,rhs){return is(lhs,"string")&&is(rhs,"string")&&lhs.indexOf(rhs)===0}],"*=":[5,function(lhs,rhs){return is(lhs,"string")&&is(rhs,"string")&&lhs.indexOf(rhs)!==-1}],">":[5,function(lhs,rhs){return is(lhs,"number")&&is(rhs,"number")&&lhs>rhs}],"<":[5,function(lhs,rhs){return is(lhs,"number")&&is(rhs,"number")&&lhs<rhs}],"=":[3,function(lhs,rhs){return lhs===rhs}],"!=":[3,function(lhs,rhs){return lhs!==rhs}],"&&":[2,function(lhs,rhs){return lhs&&rhs}],"||":[1,function(lhs,rhs){return lhs||rhs}]};exports._lex=lex,exports._parse=parse,exports.match=function(sel,obj){return compile(sel).match(obj)},exports.forEach=function(sel,obj,fun){return compile(sel).forEach(obj,fun)},exports.compile=compile}(typeof exports=="undefined"?window.JSONSelect={}:exports),window.JSONSelect});
define('tau/extensions/extension.underscore',["libs/underscore","libs/jsonselect"],function(_,JSONSelect){var cloneDeep=function(obj){if(_.isArray(obj))return _.map(obj,cloneDeep);if(typeof obj=="object"&&obj!==null){var result={};return _.each(obj,function(value,key){result[key]=cloneDeep(value)}),result}return obj},mergeDeep=function(target){var srcs=Array.prototype.slice.call(arguments,1);if("boolean"==typeof srcs[srcs.length-1])var xtraDeep=srcs.pop();for(var i=0;i<srcs.length;i++){var src=srcs[i];_.each(src,function(value,key){var tval=target[key];tval===undefined&&(target[key]=value),xtraDeep?Array.isArray(value)&&Array.isArray(tval)?target[key]=tval.concat(value):"object"==typeof value&&"object"==typeof tval?mergeDeep(tval,value):Array.isArray(tval)?tval.append(value):target[key]=[tval,value]:"object"==typeof value&&"object"==typeof tval?mergeDeep(tval,value,xtraDeep):target[key]=value})}return target};return _.mixin({keysExt:function(obj){if(_.isArray(obj))return _.keys(obj);var keys=[];for(var key in obj)keys.push(key);return keys},findComplexField:function(fields,name){var field=null,self=this;return _.each(fields,function(fld){if(self.isSimple(fld))return;if(!fld.hasOwnProperty(name))return;field=fld}),field},concat:function(array){return _.flatten(_.compact(array))},getFieldName:function(field){if(this.isSimple(field))return field;var keys=_.select(_.keys(field),function(key){return key!=="list"});if(keys.length>1||keys.length===0)throw"Only one reference or list should be defined";return keys[0]},isSimple:function(field){return _.isString(field)},mergeFields:function(masterFields,fields,config){var self=this,appendMethod=config&&config.prependFields?"unshift":"push";return _.each(fields,function(field){if(masterFields===field)return;if(self.isSimple(field)){var masterEqs=_.select(masterFields,function(fld){return fld===field});masterEqs.length===0&&masterFields[appendMethod](field);return}var fieldName=self.getFieldName(field),masterField=self.findComplexField(masterFields,fieldName);if(masterField===null){masterFields[appendMethod](field);return}var toBeIncludedFields=field[fieldName],masterFieldsInObj=masterField[fieldName];self.mergeFields(masterFieldsInObj,toBeIncludedFields)}),masterFields},mergeArrayObjects:function(destination,source,config){_.each(_(destination).keys(),function(key){if(!_.isArray(destination[key]))return;if(!_.isArray(source[key]))return;if(config&&_.isArray(config)&&_(config).indexOf(key)<0)return;destination[key]=destination[key].concat(source[key])})},functionsExt:function(obj){return _.filter(_.keysExt(obj),function(key){return _.isFunction(obj[key])}).sort()},groupByComplex:function(arr,keyFunction){var groupped=[],keys={};return _(arr).each(function(val){var key=keyFunction(val);if(!keys.hasOwnProperty(key)){var group={key:key,items:[]};groupped.push(group),keys[key]=group}keys[key].items.push(val)}),groupped},complexKey:function(object,key){var val=undefined,keys=key.split(".");return keys.length===1?object[key]:(_.forEach(keys,function(innerKey){val=object=object[innerKey];if(_.isUndefined(val)===!0)return!1}),val)},jsonSelect:function(jsonObject,selector){return JSONSelect.match(selector,jsonObject)},inArray:function(value,array){return _.indexOf(array,value)>-1},asString:function(val){return(new String(val||"")).toString()},toCamelCase:function(str){var car=str.substr(0,1),cdr=str.substr(1);return car.toLowerCase()+cdr},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})},cloneDeep:cloneDeep,deepClone:cloneDeep,mergeDeep:mergeDeep,deepMerge:mergeDeep,fixedPoint:function(x){return x}}),_.MIN_INT=-9007199254740992,_.MAX_INT=-_.MIN_INT,_});
define('libs/async/async',[],function(){var async={};return function(){var root=this,previous_async=root.async;typeof module!="undefined"&&module.exports?module.exports=async:root.async=async,async.noConflict=function(){return root.async=previous_async,async};var _forEach=function(arr,iterator){if(arr.forEach)return arr.forEach(iterator);for(var i=0;i<arr.length;i+=1)iterator(arr[i],i,arr)},_map=function(arr,iterator){if(arr.map)return arr.map(iterator);var results=[];return _forEach(arr,function(x,i,a){results.push(iterator(x,i,a))}),results},_reduce=function(arr,iterator,memo){return arr.reduce?arr.reduce(iterator,memo):(_forEach(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo)},_keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys},_indexOf=function(arr,item){if(arr.indexOf)return arr.indexOf(item);for(var i=0;i<arr.length;i+=1)if(arr[i]===item)return i;return-1};typeof process=="undefined"||!process.nextTick?async.nextTick=function(fn){setTimeout(fn,0)}:async.nextTick=process.nextTick,async.forEach=function(arr,iterator,callback){if(!arr.length)return callback();var completed=0;_forEach(arr,function(x){iterator(x,function(err){err?(callback(err),callback=function(){}):(completed+=1,completed===arr.length&&callback())})})},async.forEachSeries=function(arr,iterator,callback){if(!arr.length)return callback();var completed=0,iterate=function(){iterator(arr[completed],function(err){err?(callback(err),callback=function(){}):(completed+=1,completed===arr.length?callback():iterate())})};iterate()};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.forEach].concat(args))}},doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.forEachSeries].concat(args))}},_asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v,callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.reduce=function(arr,memo,iterator,callback){async.forEachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.inject=async.reduce,async.foldl=async.reduce,async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)},async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v&&results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter),async.filterSeries=doSeries(_filter),async.select=async.filter,async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v||results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject),async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){result?main_callback(x):callback()})},function(err){main_callback()})};async.detect=doParallel(_detect),async.detectSeries=doSeries(_detect),async.some=function(arr,iterator,main_callback){async.forEach(arr,function(x,callback){iterator(x,function(v){v&&(main_callback(!0),main_callback=function(){}),callback()})},function(err){main_callback(!1)})},async.any=async.some,async.every=function(arr,iterator,main_callback){async.forEach(arr,function(x,callback){iterator(x,function(v){v||(main_callback(!1),main_callback=function(){}),callback()})},function(err){main_callback(!0)})},async.all=async.every,async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){if(err)return callback(err);var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))})},async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length)return callback(null);var completed=[],listeners=[],addListener=function(fn){listeners.unshift(fn)},removeListener=function(fn){for(var i=0;i<listeners.length;i+=1)if(listeners[i]===fn){listeners.splice(i,1);return}},taskComplete=function(){_forEach(listeners,function(fn){fn()})};addListener(function(){completed.length===keys.length&&callback(null)}),_forEach(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k],taskCallback=function(err){err?(callback(err),callback=function(){}):(completed.push(k),taskComplete())},requires=task.slice(0,Math.abs(task.length-1))||[],ready=function(){return _reduce(requires,function(a,x){return a&&_indexOf(completed,x)!==-1},!0)};if(ready())task[task.length-1](taskCallback);else{var listener=function(){ready()&&(removeListener(listener),task[task.length-1](taskCallback))};addListener(listener)}})},async.waterfall=function(tasks,callback){if(!tasks.length)return callback();callback=callback||function(){};var wrapIterator=function(iterator){return function(err){if(err)callback(err),callback=function(){};else{var args=Array.prototype.slice.call(arguments,1),next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),async.nextTick(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()},async.parallel=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array)async.map(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args||null)})},callback);else{var results={};async.forEach(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array)async.mapSeries(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args||null)})},callback);else{var results={};async.forEachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()};return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn};return makeCallback(0)},async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]),cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){test()?iterator(function(err){if(err)return callback(err);async.whilst(test,iterator,callback)}):callback()},async.until=function(test,iterator,callback){test()?callback():iterator(function(err){if(err)return callback(err);async.until(test,iterator,callback)})},async.queue=function(worker,concurrency){var workers=0,tasks=[],q={concurrency:concurrency,push:function(data,callback){tasks.push({data:data,callback:callback}),async.nextTick(q.process)},process:function(){if(workers<q.concurrency&&tasks.length){var task=tasks.splice(0,1)[0];workers+=1,worker(task.data,function(){workers-=1,task.callback&&task.callback.apply(task,arguments),q.process()})}},length:function(){return tasks.length}};return q};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(err?console.error&&console.error(err):console[name]&&_forEach(args,function(x){console[name](x)}))}]))}};async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={};return hasher=hasher||function(x){return x},function(){var args=Array.prototype.slice.call(arguments),callback=args.pop(),key=hasher.apply(null,args);key in memo?callback.apply(null,memo[key]):fn.apply(null,args.concat([function(){memo[key]=arguments,callback.apply(null,arguments)}]))}}}(),async});
define('tau/extensions/extension.underscore.async',["libs/underscore","libs/async/async"],function(_,async){_.mixin({parallel:async.parallel,series:async.series,waterfall:async.waterfall})});
// (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>

// Underscore.strings is freely distributable under the terms of the MIT license.

// Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>

define('libs/underscore/underscore.string',["libs/underscore"],function(_){(function(root){if(typeof _!="undefined")var _reverse=_().reverse,_include=_.include;var nativeTrim=String.prototype.trim,parseNumber=function(source){return source*1||0},strRepeat=function(i,m){for(var o=[];m>0;o[--m]=i);return o.join("")},slice=function(a){return Array.prototype.slice.call(a)},defaultToWhiteSpace=function(characters){return characters?_s.escapeRegExp(characters):"\\s"},sArgs=function(method){return function(){var args=slice(arguments);for(var i=0;i<args.length;i++)args[i]=args[i]==null?"":""+args[i];return method.apply(null,args)}},sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat,str_format=function(){return str_format.cache.hasOwnProperty(arguments[0])||(str_format.cache[arguments[0]]=str_format.parse(arguments[0])),str_format.format.call(null,str_format.cache[arguments[0]],arguments)};return str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type="",arg,output=[],i,k,match,pad,pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type==="string")output.push(parse_tree[i]);else if(node_type==="array"){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw sprintf('[_.sprintf] property "%s" does not exist',match[2][k]);arg=arg[match[2][k]]}}else match[1]?arg=argv[match[1]]:arg=argv[cursor++];if(/[^s]/.test(match[8])&&get_type(arg)!="number")throw sprintf("[_.sprintf] expecting number but found %s",get_type(arg));switch(match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":arg=parseInt(arg,10);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg=Math.abs(arg);break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?"+"+arg:arg,pad_character=match[4]?match[4]=="0"?"0":match[4].charAt(1):" ",pad_length=match[6]-String(arg).length,pad=match[6]?str_repeat(pad_character,pad_length):"",output.push(match[5]?arg+pad:pad+arg)}}return output.join("")},str_format.cache={},str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\x25]+/.exec(_fmt))!==null)parse_tree.push(match[0]);else if((match=/^\x25{2}/.exec(_fmt))!==null)parse_tree.push("%");else{if((match=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt))===null)throw"[_.sprintf] huh?";if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\d]*)/i.exec(replacement_field))===null)throw"[_.sprintf] huh?";field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!=="")if((field_match=/^\.([a-z_][a-z_\d]*)/i.exec(replacement_field))!==null)field_list.push(field_match[1]);else{if((field_match=/^\[(\d+)\]/.exec(replacement_field))===null)throw"[_.sprintf] huh?";field_list.push(field_match[1])}match[2]=field_list}else arg_names|=2;if(arg_names===3)throw"[_.sprintf] mixing positional and named placeholders is not (yet) supported";parse_tree.push(match)}_fmt=_fmt.substring(match[0].length)}return parse_tree},str_format}(),_s={isBlank:sArgs(function(str){return/^\s*$/.test(str)}),stripTags:sArgs(function(str){return str.replace(/<\/?[^>]+>/ig,"")}),capitalize:sArgs(function(str){return str.charAt(0).toUpperCase()+str.substring(1).toLowerCase()}),chop:sArgs(function(str,step){step=parseNumber(step)||str.length;var arr=[];for(var i=0;i<str.length;)arr.push(str.slice(i,i+step)),i+=step;return arr}),clean:sArgs(function(str){return _s.strip(str.replace(/\s+/g," "))}),count:sArgs(function(str,substr){var count=0,index;for(var i=0;i<str.length;)index=str.indexOf(substr,i),index>=0&&count++,i=i+(index>=0?index:0)+substr.length;return count}),chars:sArgs(function(str){return str.split("")}),escapeHTML:sArgs(function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:sArgs(function(str){return str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:sArgs(function(str){return str.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}),insert:sArgs(function(str,i,substr){var arr=str.split("");return arr.splice(parseNumber(i),0,substr),arr.join("")}),includes:sArgs(function(str,needle){return str.indexOf(needle)!==-1}),include:function(obj,needle){return!_include||/string|number/.test(typeof obj)?this.includes(obj,needle):_include(obj,needle)},join:sArgs(function(sep){var args=slice(arguments);return args.join(args.shift())}),lines:sArgs(function(str){return str.split("\n")}),reverse:function(obj){return!_reverse||/string|number/.test(typeof obj)?Array.prototype.reverse.apply(String(obj).split("")).join(""):_reverse.call(_(obj))},splice:sArgs(function(str,i,howmany,substr){var arr=str.split("");return arr.splice(parseNumber(i),parseNumber(howmany),substr),arr.join("")}),startsWith:sArgs(function(str,starts){return str.length>=starts.length&&str.substring(0,starts.length)===starts}),endsWith:sArgs(function(str,ends){return str.length>=ends.length&&str.substring(str.length-ends.length)===ends}),succ:sArgs(function(str){var arr=str.split("");return arr.splice(str.length-1,1,String.fromCharCode(str.charCodeAt(str.length-1)+1)),arr.join("")}),titleize:sArgs(function(str){var arr=str.split(" "),word;for(var i=0;i<arr.length;i++)word=arr[i].split(""),typeof word[0]!="undefined"&&(word[0]=word[0].toUpperCase()),i+1===arr.length?arr[i]=word.join(""):arr[i]=word.join("")+" ";return arr.join("")}),camelize:sArgs(function(str){return _s.trim(str).replace(/(\-|_|\s)+(.)?/g,function(match,separator,chr){return chr?chr.toUpperCase():""})}),underscored:function(str){return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/^([A-Z]+)/,"-$1").replace(/\_|\s+/g,"-").toLowerCase()},trim:sArgs(function(str,characters){return!characters&&nativeTrim?nativeTrim.call(str):(characters=defaultToWhiteSpace(characters),str.replace(new RegExp("^["+characters+"]+|["+characters+"]+$","g"),""))}),ltrim:sArgs(function(str,characters){return characters=defaultToWhiteSpace(characters),str.replace(new RegExp("^["+characters+"]+","g"),"")}),rtrim:sArgs(function(str,characters){return characters=defaultToWhiteSpace(characters),str.replace(new RegExp("["+characters+"]+$","g"),"")}),truncate:sArgs(function(str,length,truncateStr){return truncateStr=truncateStr||"...",length=parseNumber(length),str.length>length?str.slice(0,length)+truncateStr:str}),prune:sArgs(function(str,length,pruneStr){pruneStr=pruneStr||"...",length=parseNumber(length);var pruned="";return str.substring(length-1,length+1).search(/^\w\w$/)===0?pruned=_s.rtrim(str.slice(0,length).replace(/([\W][\w]*)$/,"")):pruned=_s.rtrim(str.slice(0,length)),pruned=pruned.replace(/\W+$/,""),pruned.length+pruneStr.length>str.length?str:pruned+pruneStr}),words:function(str,delimiter){return String(str).split(delimiter||" ")},pad:sArgs(function(str,length,padStr,type){var padding="",padlen=0;length=parseNumber(length),padStr?padStr.length>1&&(padStr=padStr.charAt(0)):padStr=" ";switch(type){case"right":padlen=length-str.length,padding=strRepeat(padStr,padlen),str+=padding;break;case"both":padlen=length-str.length,padding={left:strRepeat(padStr,Math.ceil(padlen/2)),right:strRepeat(padStr,Math.floor(padlen/2))},str=padding.left+str+padding.right;break;default:padlen=length-str.length,padding=strRepeat(padStr,padlen),str=padding+str}return str}),lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,"right")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,"both")},sprintf:sprintf,vsprintf:function(fmt,argv){return argv.unshift(fmt),sprintf.apply(null,argv)},toNumber:function(str,decimals){var num=parseNumber(parseNumber(str).toFixed(parseNumber(decimals)));return num!==0||str==="0"||str===0?num:Number.NaN},strRight:sArgs(function(sourceStr,sep){var pos=sep?sourceStr.indexOf(sep):-1;return pos!=-1?sourceStr.slice(pos+sep.length,sourceStr.length):sourceStr}),strRightBack:sArgs(function(sourceStr,sep){var pos=sep?sourceStr.lastIndexOf(sep):-1;return pos!=-1?sourceStr.slice(pos+sep.length,sourceStr.length):sourceStr}),strLeft:sArgs(function(sourceStr,sep){var pos=sep?sourceStr.indexOf(sep):-1;return pos!=-1?sourceStr.slice(0,pos):sourceStr}),strLeftBack:sArgs(function(sourceStr,sep){var pos=sourceStr.lastIndexOf(sep);return pos!=-1?sourceStr.slice(0,pos):sourceStr}),indexOfAnyChar:function(str,chars,position){var strLen=str.length,i=position,r=-1,found=!1;while(i<strLen&&!found)_.contains(chars,str.charAt(i))&&(found=!0,r=i),++i;return r}};_s.strip=_s.trim,_s.lstrip=_s.ltrim,_s.rstrip=_s.rtrim,_s.center=_s.lrpad,_s.ljust=_s.lpad,_s.rjust=_s.rpad,_.mixin(_s)})(this||window)});
define('Underscore',["libs/underscore","tau/extensions/extension.underscore","tau/extensions/extension.underscore.async","libs/underscore/underscore.string"],function(_){return _});