require(["all.components"],function(){require(["Modernizr","jQuery","Underscore","tau/app.resolver","tau/service.container","tau/configurator","tau/components/component.application.generic"],function(Modernizr,$,_,appResolver,ServiceContainer,configuratorGlobal,ApplicationComponent){configuratorGlobal.isBoardEdition=!0;var APPID="page",ROUTING_PATTERNS=[{pattern:/board\/last/,adapter:function(){var self=this,configurator=self.configurator,referer=configurator.getRouting().restoreReferer(),boardFactory=configurator.getBoardDefinitionFactory(),user=configurator.getLoggedUser();referer&&referer.id?boardFactory.findLast(referer.id,user).done(function(board){board?configurator.getRouting().redirect(configurator.getUrlBuilder().getRelativeBoardUrl(board.key,board.acid||undefined)):configurator.getRouting().redirect(configurator.getUrlBuilder().getRelativeBoardUrl("current"))}):configurator.getRouting().redirect(configurator.getUrlBuilder().getRelativeBoardUrl("current"))},type:"tau/components/component.page.board",host:"tau/components/component.master.board"},{pattern:/board\/current/,adapter:function(){var self=this,configurator=self.configurator,boardFactory=configurator.getBoardDefinitionFactory(),user=configurator.getLoggedUser();boardFactory.findDefault(user).done(function(board){var def=$.Deferred();if(!board){var definition=boardFactory.createByOwner(user),storage=configurator.getRestStorage();storage.data(definition.groupName,definition.id,{scope:"Public",publicData:definition,userData:{menuIsVisible:1}}).done(function(res){definition.id=res.data.key,def.resolve(definition)})}else def.resolve(board);def.done(function(board){configurator.getRouting().redirect(configurator.getUrlBuilder().getRelativeBoardUrl(board.id,board.acid||undefined))})})},type:"tau/components/component.page.board",host:"tau/components/component.master.board"},{pattern:/board\/([\w|0-9]+)/,adapter:function(id){var configurator=this.configurator,boardFactory=configurator.getBoardDefinitionFactory(),user=configurator.getLoggedUser();boardFactory.getById(id,user).done(_.bind(function(board){this.resolve({id:board.id,entity:"board"})},this)).fail(function(){configurator.getRouting().redirect(configurator.getUrlBuilder().getRelativeBoardUrl("current"))})},type:"tau/components/component.page.board",host:"tau/components/component.master.board"},{pattern:/(\w+)\/([0-9]+)($|\s|&)/,adapter:function(entityType,entityId,tail){this.resolve({id:parseInt(entityId),entity:entityType,action:"show"})},type:"tau/components/component.page.entity",host:"tau/components/component.master.board"},{pattern:/(\w+)\/([0-9]+)\/(\w+)[&|]*.*/,adapter:function(entityType,entityId,action){this.resolve({id:parseInt(entityId),entity:entityType,action:action})},type:"tau/components/component.page.entity",host:"tau/components/component.master.board"}];$(function(){var afterRenderHandler=function(evt){$(":root").addClass("tau-app-frame");var $body=$("body");$body.prepend(evt.data.element),app.fire("view.dom.ready",{element:$body})},configurator=new ServiceContainer;configurator.isBoardEdition=!0,configurator.setWindow(window);var pageInfo=appResolver.resolvePageInfo({appId:APPID,configurator:configurator},{type:"board",id:"last"},function(d){var external=this;external.setHashParam(APPID,d.type+"/"+d.id,!0)}),appCfg={name:"application board",applicationId:APPID,pageType:pageInfo.type,pageId:pageInfo.id,routes:ROUTING_PATTERNS,configurator:configurator},app=ApplicationComponent.create(appCfg),initializeFeedback=function(){(function(){var uv=document.createElement("script");uv.type="text/javascript",uv.async=!0,uv.src=("https:"==document.location.protocol?"https://":"http://")+"widget.uservoice.com/rywvig4l55Tifwaw7wk3Ag.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(uv,s)})()};app.on("afterRender",afterRenderHandler),app.on("afterRender",initializeFeedback),app.on("application.exit",function(){app.fire("initProgress"),configurator.getRouting().redirect(configurator.getUrlBuilder().getDashboardUrl())}),app.initialize(appCfg)})})})