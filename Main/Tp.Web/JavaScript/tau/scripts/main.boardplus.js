define("text",["module"],function(e){"use strict";var t,n,i,r,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,d=u&&location.protocol&&location.protocol.replace(/\:/,""),l=u&&location.hostname,p=u&&(location.port||void 0),g={},f=e.config&&e.config()||{};return t={version:"2.0.12",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(i){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,a=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!o||a>1)?(t=e.substring(0,a),n=e.substring(a+1,e.length)):t=e,i=n||t,a=i.indexOf("!"),-1!==a&&(r="strip"===i.substring(a+1),i=i.substring(0,a),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var a,o,s,c=t.xdRegExp.exec(e);return c?(a=c[2],o=c[3],o=o.split(":"),s=o[1],o=o[0],!(a&&a!==n||o&&o.toLowerCase()!==i.toLowerCase()||(s||o)&&s!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,f.isBuild&&(g[e]=i),r(i)},load:function(e,n,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();f.isBuild=r&&r.isBuild;var a=t.parseName(e),o=a.moduleName+(a.ext?"."+a.ext:""),s=n.toUrl(o),c=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void i():void(!u||c(s,d,l,p)?t.get(s,function(n){t.finishLoad(e,a.strip,n,i)},function(e){i.error&&i.error(e)}):n([o],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,i)}))},write:function(e,n,i){if(g.hasOwnProperty(n)){var r=t.jsEscape(g[n]);
i.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,i,r,a){var o=t.parseName(n),s=o.ext?"."+o.ext:"",c=o.moduleName+s,u=i.toUrl(o.moduleName+s)+".js";t.load(c,i,function(){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},t.write(e,c,n,a)},a)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("ï»¿")&&(r=r.substring(1)),t(r)}catch(a){i&&i(a)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,r){var a,o=t.createXhr();if(o.open("GET",e,!0),r)for(a in r)r.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),r[a]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(){var t,r;4===o.readyState&&(t=o.status||0,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=o,i&&i(r)):n(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",a=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),r)),c="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=s.readLine());)n.append(o),n.append(i);c=String(n.toString())}finally{s.close()}t(c)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,o,s,c={};a&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),o=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),o.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),c),o.close(),n.close(),t(c.value)
}catch(u){throw new Error((s&&s.path||"")+": "+u)}}),t}),define("tau/components/extensions/extension.tracking.performance",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({init:function(e){this.globalBus=e.bus.globalBus,this._super(e),this._slice={},this._commands={},this._startLifeCycle=null,this.diagnostics=e.context.configurator.getDiagnosticsService(),this._setPageClientProcessingTime()},_setPageClientProcessingTime:function(){var e=this.diagnostics.page();e&&(e.client=(new Date).getTime()-window.clientStartTime.getTime())},_requestCompleted:function(e,t){this._commands[t.command.method]=parseInt(t.response.getResponseHeader("X-Stopwatch"),10)},_viewReady:function(e){if(this._startLifeCycle.caller.id==e.caller.id){var t=e.date-this._startLifeCycle.date,n=Math.max(0,this._commands.xaxis||0,this._commands.yaxis||0);this._commands.list&&(n+=this._commands.list),this._commands.cells&&(n+=this._commands.cells),this.diagnostics.set("board",{server:n,client:t-n})}},"globalBus start.lifecycle":function(e){this._startLifeCycle=e},"globalBus slice.ready":function(t,n){e.each(n,function(e,t){this._slice[t]!==e&&(this._slice[t]&&(this._slice[t].removeListener("request.completed",this._requestCompleted,this),this._commands={}),this._slice[t]=e,e.on("request.completed",this._requestCompleted,this))},this)},"globalBus model.cells.content.loaded + cardsFullyLoaded":function(e){this._viewReady(e["model.cells.content.loaded"])},"globalBus overview.board.ready":function(e){this._viewReady(e)}})}),define("tau/components/extensions/extension.views.menu.comet.listener",["require","tau/components/extensions/component.extension.base"],function(e){var t=e("tau/components/extensions/component.extension.base");return t.extend({init:function(e){this._super(e);var t=e.context.configurator;this._listener=t.getViewsMenuCometListener(),this._listener.startListen()},destroy:function(){this._super(),this._listener.stopListen()}})}),define("tau/app.resolver",["Underscore"],function(e){var t=function(t){var n=t.split("/");
if(n.length<2)return null;var i=n[0],r=n[1],a=r.length,o=e.without([r.indexOf("&"),r.indexOf("||"),a],-1),s=e.min(o),c=r.substring(0,s);return{id:c,type:i}};return{resolvePageInfo:function(n,i,r){var a=n.configurator.getExternal(),o=a.getHashParam(n.appId,null),s=o||a.getHash(),c=t(s),u=c;return c||(u=i,e.isFunction(r)&&r.call(a,u)),u},getQueryParam:function(e,t){var n=e.indexOf(t+"=");if(-1===n)throw'Param "'+t+'" not found';n=n+t.length+1;var i=e.indexOf("&",n);i=-1!==i?i:e.length;var r=e.substring(n,i);return r}}}),define("main.boardplus.login",["Underscore","jQuery","tau/core/class","tau/app.resolver","tau/components/component.video-intro.popup"],function(e,t,n,i,r){return n.extend({init:function(e,t){this.configurator=e,this.applicationId=t},process:function(){var e=this.configurator.getWindow(),t=!e.appIsInDebugMode&&e.tauUserInfo&&e.tauUserInfo.isFirstTimeTp3Login;return t?this.firstTimeLogin():this.notFirstTimeLogin()},notFirstTimeLogin:function(){var n=this.configurator.getHashService(),r=!n.getHash();if(r&&e.has(n.getHrefParsed().queryKey,"start"))this.setHash("start/start");else if(r&&e.has(n.getHrefParsed().queryKey,"invite"))this.setHash("invite");else{var a=this.applicationId;i.resolvePageInfo({appId:this.applicationId,configurator:this.configurator},{type:"board",id:"last"},function(e){this.setHashParam(a,e.type+"/"+e.id)})}return t.Deferred().resolve()},showCallAdminPopup:function(){var e=this.configurator.getGlobalBus();r.create({url:"//www.youtube.com/embed/Lxl2sTEyYaE",showNextButton:!1}),e.fire("contentRendered")},firstTimeLogin:function(){var n=t.Deferred(),i=this.configurator.getLoggedUser().isAdministrator,r=window.tauUserInfo&&window.tauUserInfo.Tp3Available,a=t.Deferred();return n.fail(a.reject),n.done(function(){var e=this.configurator.getGlobalSettingsService();e.sendRequest("GlobalSettingsService","FirstTimeLoginTP3",null).done(a.resolve).fail(function(){throw new Error("First time login operation is failed")})}.bind(this)),i||r||(this.showCallAdminPopup(),n.reject()),this.getPublicBoardsCount().then(e.bind(function(t){t>0?(this.setHash("invite"),n.resolve()):this.getPrivateBoardsCount().then(e.bind(function(e){e>1?(this.setHash("invite"),n.resolve()):i?(this.setHash("start/start"),n.resolve()):(this.showCallAdminPopup(),n.reject())
},this))},this)),a},getBoardsCount:function(e){var n=t.Deferred();return this.configurator.getRestStorage().select("boards",{$where:'(publicData.isShared == "'+e+'")',$fields:["key"]}).done(function(e){n.resolve((e.data||[]).length)}),n},getPublicBoardsCount:function(){return this.getBoardsCount(!0)},getPrivateBoardsCount:function(){return this.getBoardsCount(!1)},setHash:function(e){this.configurator.getHashService().setHash(this.applicationId+"="+e)}})}),define("main.boardplus.routes",["require","app.path","tp/reports/service.chart.size","jQuery"],function(e){function t(e,t,i){var r=null,a=!1,o={fields:["acid"],callback:function(i){r=i.acid,a=!1,taus.context({"@":"--app-context-core",host:n.get(),version:e.getSystemInfo().version,path:t,user:e.getLoggedUser(),acid:i.acid})}};e.getAppStateStore().bind(o),e.getAppStateStore().get({fields:o.fields,callback:function(e){o.callback(e),i()}}),e.getApplicationContextService().onApplicationContextRetrieved.add(function(e){e.acid!==r||a||(a=!0,taus.track("appContext",{"@":"--app-context-teams-projects",projects:e.selectedProjectIds,teams:e.selectedTeamIds}))},!0)}var n=e("app.path"),i=e("tp/reports/service.chart.size"),r=e("jQuery");return{createApplicationRoutes:function(){return[{pattern:/start/,host:{name:"board_startScreen_h",type:"board.startScreen"},type:{name:"board_startScreen",type:"board.startScreen"}},{name:"process-setup-workflow",pattern:/process-setup\/(\d+)\/workflows\/([a-z]+)/,adapter:function(e,t){this.resolve({processId:parseInt(e,10),optionGroupId:"workflows",entityType:t})},host:{name:"board_host",type:"master.board"},type:{name:"setup workflow",type:"setup.workflow"}},{name:"process-setup-terms",pattern:/process-setup\/(\d+)\/terms/,host:{name:"board_host",type:"master.board"},adapter:function(e){this.resolve({processId:parseInt(e,10),optionGroupId:"terms"})},type:{name:"terms",type:"terms"}},{name:"process-setup-general",pattern:/process-setup\/(\d+)\/([a-z\-]+)/,adapter:function(e,t){this.resolve({processId:parseInt(e,10),optionGroupId:t})
},host:{name:"board_host",type:"master.board"},type:{name:"setup process",type:"setup.process"}},{pattern:/invite/,adapter:function(){var e=this.configurator,t=e.getHelpScenarioService(),n=t.getAvailableFlows().scratch;t.setCurrentFlow(n.id),t.setState(t.stateTypes.ToBeStarted),e.getRouting().redirect(e.getUrlBuilder().getRelativeBoardUrl("current"))},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/report\/(\d+)/,adapter:function(e){var t=this.configurator;t.registerService("chart.size",new i),this.resolve({id:e,entity:"report"})},host:{name:"board_host",type:"master.board"},type:{name:"report_page",type:"page.report"}},{pattern:/board\/last/,adapter:function(){var e=this.configurator,t=e.getRouting().restoreReferer(),n=e.getUrlBuilder();if(t&&t.id){var i=e.getBoardDefinitionFactory();i.findLast(t.id).done(function(t){var i;i=t?n.getRelativeBoardUrl(t.id,t.acid||void 0):n.getRelativeBoardUrl("current"),e.getRouting().redirect(i)})}else e.getRouting().redirect(n.getRelativeBoardUrl("current"))},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/board\/current/,adapter:function(){var e=this.configurator;e.getGlobalBus().fire("applicationStart");var t=e.getAppStateStore().settings.acid||void 0,n=e.getBoardDefinitionFactory();n.findDefaultForLoggedUser().done(function(i){var a=r.Deferred();i?a.resolve(i):n.createBoard().done(function(e){a.resolve(e)}),a.done(function(n){var i=e.getUrlBuilder();e.getRouting().redirect(i.getRelativeBoardUrl(n.id,n.acid||t))})})},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/board\/([\w|0-9]+)/,adapter:function(e){var n=this,i=this.configurator,r=i.getBoardDefinitionFactory();i.getRestStorage()._cache={};var a={id:["board",e].join("/"),type:"board",args:e},o=function(){r.getById(e).done(function(e){n.resolve({id:e.id,entity:"board"})}).fail(function(){i.getRouting().redirect(i.getUrlBuilder().getRelativeBoardUrl("current"))
})};t(i,a,o)},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/finish-(\w+)\/([0-9]+)/,adapter:function(e,t){this.resolve({entity:{id:parseInt(t,10),type:e}})},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.finish-iteration"}},{pattern:/(\w+)\/([0-9]+)($|\s|&)/,adapter:function(e,n){var i=this,r=this.configurator,a=taus.start("statistics_view",{"@":["--add-last-view-entity-context",function(e){var t="@timing";return e.loadTime=e[t],delete e[t],e}],entity:{id:n,type:e.toLowerCase()}}),o={id:[e,n].join("/"),type:e,args:n},s=function(){taus.track({"@":["--save-last-view-entity-context"],action:"view entity",name:"view "+e+" #"+n,tags:["view entity"],type:e,id:n}),i.resolve({entity:{id:parseInt(n,10),type:e},action:"show",cssClass:"tau-app tau-page-single tau-page-entity i-role-bubble-holder",handlers:{onPageLoaded:function(){a.stop()}}})};t(r,o,s)},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.entity",comet:{enabled:!0}}},{pattern:/(\w+)\/([0-9]+)\/(\w+)[&|]*.*/,adapter:function(e,t,n){this.resolve({entity:{id:parseInt(t,10),type:e},action:n,cssClass:"tau-app tau-page-single tau-page-entity i-role-bubble-holder"})},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.entity"}}]}}}),define("tp/mashups.loader",["jQuery","Underscore","tp/mashups","libs/parseUri"],function(e,t,n,i){var r=["beforeAppInit"],a={initDeferred:e.Deferred(),loadState:{},initPointsData:{},init:function(){this._setLoadStates(),this._overrideMashupsFunctions();var e=i(location.href).hasQueryKey("nomashups");return e||require(["user/mashups"],function(){this._processRegisteredMashups(),this.initDeferred.resolve()}.bind(this)),this},_setLoadStates:function(){t.each(r,function(t){this.loadState[t]={status:e.Deferred()}},this)},_overrideMashupsFunctions:function(){this.originalFunctions={initializeMashupFolder:n.prototype.initializeMashupFolder},n.prototype.initializeMashupFolder=e.noop
},_processRegisteredMashups:function(){var e=n.prototype.getRegisteredMashups();t.each(e,function(e){var t=e.options.initPoint;this.initPointsData[t]||(this.initPointsData[t]={initPoint:t,mashups:[]}),e.mashups.length&&this.initPointsData[t].mashups.push(e)},this)},loadMashups:function(e){this.initDeferred.done(this._loadMashups.bind(this,e))},_loadMashups:function(e){var t=this.initPointsData[e]||{},n=t.mashups||[];t.startTime=Date.now();var i=this._initializeMashups(n);i.done(this._toggleState.bind(this,e))},_initializeMashups:function(n){var i=e.Deferred(),r=n.length,a=[],o=function(){0===r&&i.resolve(a)};return o(),t.each(n,function(e){this.originalFunctions.initializeMashupFolder.call(e.ctx),e.initDeferred.done(function(){a.push(e)}),e.initDeferred.always(function(){r--,o()})},this),i},_toggleState:function(e){var t=this.initPointsData[e]||{};this._updateTimingData(t),this._trackMashupsLoad(t),this.loadState[e].status.resolve()},_trackMashupsLoad:function(e){var n={"@":["--exclude-board-context"]},i=t.extend({},n,e);taus.track("mashups.load",i)},_updateTimingData:function(e){e.totalTime=Date.now()-e.startTime,delete e.startTime}};return a}),define("tracking/stores/store.testconsole",["tau/core/class","Underscore"],function(e){return e.extend({init:function(e){this.config=e||{},window.testconsole={posts:[]}},post:function(e){window.testconsole.posts.push(e)}})}),define("tracking/stores/store.console",["tau/core/class","Underscore"],function(e,t){return e.extend({init:function(e){this.config=e||{},t.defaults(this.config,{method:"log"})},post:function(e){console[this.config.method](e)}})}),define("tracking/stores/store.tauspy",["jQuery","Underscore","app.path","libs/json2"],function(e,t,n){var i=!1,r=0;"withCredentials"in new XMLHttpRequest&&(i=!0);var a=[],o=function(e){this.config=t.defaults(e||{},{local:"taus"}),this.usePost=i,this.config.local&&(this.localUrl=n.get()+"/"+e.local,this.usePost=!0)};return o.prototype={encode:function(e){var t,n,i,r,a,o,s,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,l=0,p="",g=[];
if(!e)return e;do t=e.charCodeAt(d++),n=e.charCodeAt(d++),i=e.charCodeAt(d++),c=t<<16|n<<8|i,r=c>>18&63,a=c>>12&63,o=c>>6&63,s=63&c,g[l++]=u.charAt(r)+u.charAt(a)+u.charAt(o)+u.charAt(s);while(d<e.length);p=g.join("");var f=e.length%3;return(f?p.slice(0,f-3):p)+"===".slice(f||3)},postViaImage:function(e){try{if(!e)return!1;var t="https:"===document.location.protocol;if(t&&!this.config.urlSSL)return!1;var n=this.encode(encodeURIComponent(JSON.stringify(e)));if(Image){var i=t?this.config.urlSSL:this.config.url;(new Image).src=i+"?f=b&d="+n}}catch(r){}return!0},queueItem:function(e){var n=this;t.isArray(e)?a=a.concat(e):a.push(e),clearTimeout(r);var i=function(){if(0!==a.length){var e=a.concat([]);a=[],n.usePost?n.postForm(e):n.postViaImage(e)}};a.length>(n.usePost?20:3)?i():r=setTimeout(i,1e3)},postForm:function(t){try{if(!t)return!1;var n=this.localUrl;if(!n){n=i?this.config.urlSSL:this.config.url;var i="https:"===document.location.protocol;if(i&&!this.config.urlSSL)return!1}e.ajax({type:"POST",url:n,dataType:"text",processData:!1,data:JSON.stringify(t),contentType:"application/json; charset=utf-8"})}catch(r){}return!0},post:function(e){this.queueItem(e)}},o}),define("tracking/stores/store.factory",["tracking/stores/store.testconsole","tracking/stores/store.console","tracking/stores/store.tauspy"],function(e,t,n){var i=function(){},r={testconsole:e,console:t,tauspy:n,empty:function(){this.init=i,this.post=i}};return{createTrackingStore:function(e,t){var n;if(t.api)t.api&&t.api.init&&(t.api.init(t.config),n=t.api);else{var i=r.hasOwnProperty(e)?e:"empty";n=new r[i](t)}return{api:n}}}}),define("tracking/taus",["Underscore","tracking/stores/store.factory"],function(e,t){var n="action",i=function(n){this.sid=n.sid,this.globalBus=n.globalBus,this.debugMode=n.debugMode,this.stores=e.map(n.store,function(e,n){return t.createTrackingStore(n,e)});var i=n.adapters;this.adapters={get:function(t){return i[t]||e.identity}},this.getPostAdapters=n.getPostAdapters||function(e){return[e,"--global--"]
},this.sync={},this.temp={},this.last={},this.adaptersScope={sid:this.sid}};return i.prototype={_getAdapterArr:function(t){var n=[];return e.isArray(t)?n=t:e.isString(t)&&(n=[t]),n},_isDuplicate:function(e,t){var n="--tmp-"+e,i=JSON.stringify(t),r=(new Date).getTime(),a=r-(this.last[n]||0);return this.temp[n]===i&&3e3>=a?!0:(this.temp[n]=i,this.last[n]=r,!1)},_post:function(t){if(e.isObject(t))for(var n=0;n<this.stores.length;n++)try{this.stores[n].api.post(t)}catch(i){}},_verifyThenPost:function(t,n){if(this._isDuplicate(t,n))return!1;var i={};return i[t]=e.extend({sid:this.sid,tick:(new Date).getTime()},n),this._post(i),!0},_adapt:function(t,n){var i=e.isFunction(n)?n:this.adapters.get(n);return i.call(this.adaptersScope,t)},_applyAdapters:function(t,n){var i="@",r=this._getAdapterArr(t[i]),a=e.omit(t,i),o=r.concat(n);return e.reduce(o,this._adapt.bind(this),a)},context:function(e){this._applyAdapters(e,[])},track:function(){var t=[].slice.call(arguments),i=t[0],r=t[1];1===t.length&&(i=n,r=e.isString(t[0])?{name:t[0]}:t[0]);try{var a=this._applyAdapters(r,this.getPostAdapters(i));this._verifyThenPost(i,a)}catch(o){this.debugMode&&console&&console.log(o)}},error:function(e){this.track("error",e)},start:function(){var t,i;if(e.isFunction(arguments[0])){var r=arguments[0]();t=r.tick,i=r.args}else t=+new Date,i=[].slice.call(arguments);var a,o,s;if(3===i.length)a=i[0],o=i[1],s=i[2];else if(2===i.length){var c=e.isObject(i[0]);a=c?n:i[0],o=c?i[0]:i[1],s=c?i[1]:e.uniqueId()}else 1===i.length&&(a=n,o=e.isString(i[0])?{name:i[0]}:i[0],s=e.uniqueId());return this.sync[s]={t0:t,type:a,data:o},{stop:this.stop.bind(this,s)}},stop:function(){var t,n;if(e.isFunction(arguments[0])){var i=arguments[0]();t=i.tick,n=i.args}else t=+new Date,n=[].slice.call(arguments);var r=n[0],a=n[1]||{},o=this.sync[r];if(o&&o.t0){var s=e.extend({t0:o.t0,t1:t},o.data,a),c=this._getAdapterArr(s["@"]);c.splice(0,0,"to-timing"),s["@"]=c,this.track(o.type,s),delete this.sync[r]}}},i}),define("tracking/taus.types.adapters",["Underscore"],function(e){var t="@timing",n="--exclude-board-context-flag",i={tick:function(){return(new Date).getTime()
},getInfoFromTypes:function(t){if(!t)return"empty";var n=[],i=t.types?t.types:t;return e.isArray(i)&&(n=e.map(i,function(t){return e.isString(t)?t:t.type})),0===n.length?"empty":n.join(",")},getFilter:function(e){return e?e.filter?e.filter:"":""},getBoardContext:function(t){if(!t)return{};var n=this.getInfoFromTypes(t.cells).split(",");1===n.length&&"empty"==n[0]&&(n=[]),n=e.sortBy(n);var i=t.user||{};return{x:{type:this.getInfoFromTypes(t.x),filter:this.getFilter(t.x)},y:{type:this.getInfoFromTypes(t.y),filter:this.getFilter(t.y)},mode:t.viewMode||null,zoomLevel:t.zoomLevel||null,user_cardFilter:i.cardFilter||"",cards:{types:n,filter:this.getFilter(t.cells)},cardSettings:t.cardSettings}},makePlainCleanObject:function(t,n,i,r){var a=this;if(t=t||{},!(e.isUndefined(n)||e.isNull(n)||e.isEmpty(n))){var o=e.isArray(n);if(!e.isObject(n)&&!o)return void(t[i]=n);if(o)return t[i]=[],e.each(n,function(e){e&&t[i].push(a.makePlainCleanObject({},e,"",r))}),t;for(var s=e.keys(n),c=i?i+"_":"",u=0;u<s.length;u++){var d=s[u];e.indexOf(r,d)>=0||a.makePlainCleanObject(t,n[d],c+d,r)}return t}}},r=function(t,n){var i=n?e.pick(n,"mode","zoomLevel","x","y","cards","user_cardFilter"):null;if(i&&"timeline"===(i.mode||"").toLocaleLowerCase()){var r=e.pick(n,"timelineGlobalDateRange","timelineLocalDateRange","timelineSettings");e.extend(i,r)}return e.extend(t,{"@board-context":i})},a={"--app-context-core":function(e){var t,n,i,r;return e.host&&(t=e.host.toLowerCase().replace("http://","").replace("https://","")),e.user&&(n=[t,"user",e.user.id].join("/")),e.path&&(i=e.path),e.acid&&(r=e.acid),this.cntx={appContext:{id:[t,r].join("/"),host:t,version:e.version,acid:r},host:{id:t},user:{id:n},path:i},this.cntx},"--app-context-teams-projects":function(t){var n=function(e){return"null"===e?-1:e};return{_id:this.cntx.appContext.id,host:{id:this.cntx.host.id},teams:t.teams?e.map(t.teams,n):[],projects:t.projects?e.map(t.projects,n):[]}},"--add-last-view-entity-context":function(e){return e["@view-context"]=this.viewEntityContext||null,e
},"--save-last-view-entity-context":function(e){return this.viewEntityContext={id:e.id,type:e.type,sid:+new Date},a["--add-last-view-entity-context"].call(this,e)},"view-entity":function(e){var t=e.tags||[];return t.push("view entity"),e.tags=t,a["--add-last-view-entity-context"].call(this,e)},"to-timing":function(n){var i={};return i[t]=n.t1-n.t0,e.extend(e.omit(n,"t0","t1"),i)},action:function(e){if(e.action=e.action||e.name,!e.action)throw"stats: [action | name] property must be provided for action message";return e},"action.id.sid":function(e){return e._id&&(e._id+="/"+this.sid),e},"--exclude-board-context":function(e){return e[n]=!0,e},"--update-board-context":function(t){return this.boardContext&&e.extend(this.boardContext,t.changes),t},"open-board-action":function(t){var n=t.boardSettings,r=t.definition,o=i.getBoardContext(r),s=e.extend({},n,o);this.boardContext=s;var c=e.extend({action:"open board",tags:["board","open board"],contextBoard:n.acid&&n.acid.length>0?!0:!1},s);c.boardName=c.name||"Unknown board",delete c.cards;var u=o.cards.types.join(",");return u||(u="no cards"),c.name=['open board "',c.boardName,'" ',"[",o.x.type,"/",o.y.type," with cards ",u,"]"].join(""),a["--exclude-board-context"](c)},"slice-request-completed":function(n){var r=function(e){return!n.hasOwnProperty(e)};if(e.any(["command","response",t],r))throw"Invalid argument's properties for [slice-request-completed] adapter";var o=n.command||{},s=n[t],c=n.response||{},u=e.defaults({},o,{config:{$skip:0,$take:0}}),d=parseInt(c.getResponseHeader("X-Stopwatch")),l=c.getResponseHeader("X-Sql-Stopwatch"),p=parseInt(c.getResponseHeader("X-Count")),g=(c.responseText||"").length,f={method:u.method,page:{skip:u.config.$skip,take:u.config.$take},totalTime:s,netTime:s-d,serverTime:d,contentSize:g};return e.keys(o.config||{}).length>0&&(f.params=u.config),isNaN(p)||(f.countOfEntities=p),l&&(f.serverSqlTimes=l.split(";")),i.makePlainCleanObject(f,n.request.definition,"",["global"]),a["--exclude-board-context"](f)
},"slice-detailed-error":function(t){var n=e.extend({place:"slice",board:i.getBoardContext(t.definition)},e.omit(t,"definition"));return a["--exclude-board-context"](n)},"header-menu-click":function(t){var n=t.tags||[],i=n[0]||"click",r=n[1]||"header menu click";return e.extend(t,{action:r,name:r,tags:["board","click","page header","page header item"],area:"page header",event:i})},"--save-statistics_newlist_cardLoad":function(e){return this.latest_statistics_newlist_cardLoad=e,e},"--restore-statistics_newlist_cardLoad":function(){var e=this.latest_statistics_newlist_cardLoad;return delete this.latest_statistics_newlist_cardLoad,e},"--cast-statistics_newlist_cardLoad-to-statistics":function(e){return e.board=e["@board-context"],delete e["@board-context"],e.loadTime=e["@timing"],delete e["@timing"],e},"--global--":function(t){return t[n]||r(t,this.boardContext),delete t[n],e.extend({},t,this.cntx)}};return a}),define("tracking/extensions/extension.tracking.base",["tau/core/extension.base","app.path","Underscore"],function(e,t,n){return e.extend({init:function(e){this.global=e.bus.getGlobalBus(),this._super(e)},destroy:function(){delete this.globalBus,this._super()},getPath:function(){return t.get()},getHost:function(){return t.get().toLowerCase().replace("http://","").replace("https://","")},makePlainCleanObject:function(e,t,i,r){e=e||{};var a=this;if(!(n.isUndefined(t)||n.isNull(t)||n.isEmpty(t))){var o=n.isArray(t);if(!n.isObject(t)&&!o)return void(e[i]=t);if(o)return e[i]=[],n.each(t,function(t){t&&e[i].push(a.makePlainCleanObject({},t,"",r))}),e;for(var s=n.keys(t),c=i?i+"_":"",u=0;u<s.length;u++){var d=s[u];n.indexOf(r,d)>=0||a.makePlainCleanObject(e,t[d],c+d,r)}return e}},getInfoFromTypes:function(e){if(!e)return"empty";var t=[];return e.types&&(e=e.types),n.isArray(e)&&n.each(e,function(e){t.push(n.isString(e)?e:e.type)}),0===t.length?"empty":t.join(",")},getFilter:function(e){return e?e.filter?e.filter:"":""},getBoardContext:function(e){if(!e)return{};var t=this.getInfoFromTypes(e.cells).split(",");
1===t.length&&"empty"==t[0]&&(t=[]),t=n.sortBy(t);var i=e.user||{};return{x:{type:this.getInfoFromTypes(e.x),filter:this.getFilter(e.x)},y:{type:this.getInfoFromTypes(e.y),filter:this.getFilter(e.y)},mode:e.viewMode||null,zoomLevel:e.zoomLevel||null,user_cardFilter:i.cardFilter||"",cards:{types:t,filter:this.getFilter(e.cells)},cardSettings:e.cardSettings}}})}),define("tracking/extensions/extension.tracking.board.statistics",["./extension.tracking.base","Underscore"],function(e,t){return e.extend({"global start.lifecycle + overview.board.ready + board.paging.settings + model.cells.content.loaded":function(e){var n=e["start.lifecycle"],i=e["overview.board.ready"],r=e["board.paging.settings"].data,a=e["model.cells.content.loaded"].data;if(n.caller.id==i.caller.id){var o=i.date-n.date,s=0;a.data?t.each(a.data.items,function(e){s+=e.dynamic.items.length}):a.cards&&(s=a.cards.length);var c=["viewMode","x","y","cells","global","boardId"],u=this.makePlainCleanObject(this.getBoardContext(r.definition),r.definition,null,c);if("newlist"!==(u.mode||"").toLowerCase()){var d={"@":["--exclude-board-context"],loadTime:o,page:{current:t.extend({},r.page),size:{x:r.x.onPage,y:r.y.onPage},total:{x:r.x.totalPages,y:r.y.totalPages}},cardsCount:s,board:u};window.performance&&window.performance.timing&&!this.initialLoadTracked&&(this.initialLoadTracked=!0,d.totalLoadTime=Date.now()-performance.timing.navigationStart),this.fire("track.statistics",d)}}}})}),define("tracking/extensions/extension.tracking.application.context",["Underscore","./extension.tracking.base"],function(e,t){return t.extend({init:function(e){this._super(e);var t=e.context.configurator,n=t.getAppStateStore();n.bind({fields:["acid"],listener:this,callback:this.fire.bind(this,"acid.changed")})},"global acid.changed > track.new.context":function(e,t,n){var i=this._extractSelectedIds(n),r={action:"change context",name:this._getEventDescription(i),teams:i.teams,projects:i.projects,processes:i.processes,tags:["selected context"]};
this.fire("track.action",r)},_extractSelectedIds:function(e){return{teams:this._getEntityIds(e.selectedTeams),projects:this._getEntityIds(e.selectedProjects),processes:e.selectedProcessIds}},_getEntityIds:function(t){return e.without(e.pluck(t,"id"),"None")},_getEventDescription:function(e){return"context changed, teams="+e.teams.length+", projects="+e.projects.length+", processes="+e.processes.length}})}),define("tracking/extensions/extension.tracking.board.actions",["Underscore","./extension.tracking.base","libs/json2"],function(e,t){return t.extend({bs_id:0,"global boardSettings.ready":function(e,t){var n=t.boardSettings;this.bs_id!==n.__objectId&&(this.bs_id=n.__objectId,this.boardSettings&&this.boardSettings.onChange.remove(this.trackBoardSettingsDiff),this.boardSettings=n,this.boardSettings.onChange.remove(this.trackBoardSettingsDiff).add(this.trackBoardSettingsDiff))},"global add.board":function(t,n){this.fire("track.action",e.extend({name:"add board"},n))},"global remove.board":function(t,n){this.fire("track.action",e.extend({name:"remove board"},n))},"global help.flow.action":function(e,t){var n={name:t.name,area:"help flow",tags:["help flow","help"]};t.tags&&(n.tags=n.tags.concat(t.tags)),t.progress&&(n.progress=t.progress),this.fire("track.action",n)},"global quick.add.popup.rendered":function(){this.fire("track.action",{name:"show quick add popup",tags:["board","quick add"]})},"global relatedQuickAdd.afterShow":function(){this.fire("track.action",{name:"show related quick add popup",tags:["board","quick add"]})},"global paging.cell.show.more":function(){this.fire("track.action",{name:"show more cards",tags:["board","show more"]})},"global board.configurator.ready:last + model.data.item.did.add":function(e,t,n){if(n.message&&n.message.dataItem&&n.message.dataItem.type&&n.message.dataItem.data){var i=n.message.dataItem.data.cardData,r=i.type.toLowerCase();this.fire("track.action",{action:"entity added",name:r+" #"+i.id+" added using quick add",type:r,tags:["add "+r,"add card","board"]})
}},"global error":function(t,n){var i="---",r="";if(n)if(e.isString(n))i=n;else if(n.message)i=n.message+(n.details||"");else if(n.$node){var a=n.$node.text&&n.$node.text();a=a||"unknown issue: unknown $node",i=a}else try{r=e.keys(n).join(" / "),i="unknown issue: "+JSON.stringify(n)}catch(o){i=["unknown issue: ","fail during global error stringification","(",o.message,").","Object keys:","[",r,"]"].join("")}else i="unknown issue: unspecified global error";this.fire("track.error",{message:i})},"global model.data.item.did.fail.add":function(e,t){t.Message&&(this.fire("track.error",{name:"quick add error",message:t.Message}),this.fire("track.action",{name:"quick add error",tags:["error","board","quick add"],message:t.Message}))},"global view.card.batch.move.completed":function(t,n){var i=[],r={};e.each(n,function(e){if(e.data){var t=e.data("entity-type");i.push({type:t,id:e.data("entity-id")}),r[t]||(r[t]=0),r[t]++}}),this.fire("track.action",{action:"move cards",name:i.length+" card(s) moved "+JSON.stringify(r),cards:i,tags:["board","business action","move cards"]})},"global board.template.selected":function(e,t){t=t||{name:"not defined"},this.fire("track.action",{action:"apply template",name:"apply template ["+t.name+"]",template:t,tags:["board","templates","customize","settings"]})},trackBoardSettingsDiff:function(t){if(t){var n=[],i={};e.each(t,function(e,t){var r=t;"isdraft"!==r.toLowerCase()&&(r="user"===t?"user filter":"edit"===t?"switch "+(e?"on":"off")+" board edit mode":"name"==t?"boardName":t,i[r]=e,n.push(r))}),n.length>0&&taus.track({"@":["--update-board-context"],action:"customize board",name:"change board settings ["+n.join(",")+"]",tags:["customize","board"].concat(n),changes:i})}}})}),define("tracking/extensions/extension.tracking.clicks",["./extension.tracking.base","Underscore","jQuery"],function(e,t,n){return e.extend({track:function(e,n,i){e||(e="body"),i=i||"click",n=n||{},t.defaults(n,{tags:[]});var r=function(e){n.tags.indexOf(e.toLowerCase())<0&&n.tags.push(e)
};r("board"),r(i),n.area&&r(n.area);var a={selector:e,data:n,event:i};return this.clickMap[e]=a,{name:function(e){return n.name=e,r(e),this},nameSelector:function(e){return a.nameSelector=e,this},nameTemplate:function(e){return a.nameTemplate=e,this},tag:function(){return t.each(arguments,function(e){r(e)}),this},event:function(e){return a.event=e,r(e),this},area:function(e){return n.area=e,r(e),this}}},trackArea:function(e,t){var n=this;return function(i){var r=e+(i?" "+i:"");return n.track(r,{area:t})}},trackMainMenu:function(){this.track(".tau-user-submenu .tau-menu-item").area("page header menu").tag("context menu");var e=this.trackArea(".tau-teams-projects-manager","project/team selection");e("button"),this.track(".tau-social-share-popup .tau-share-link").area("social sharing").tag("share targetprocess")},trackGettingStarted:function(){this.track(".tau-getting-started .rhino-btn,.tau-getting-started .rhino-bullet").area("getting started popup").tag("getting started")},trackQuickAdd:function(){var e=this.trackArea(".tau-quick-add-dialog","quick add popup");e("button").tag("quick add popup")},trackBoard:function(){this.track(".tau-board-settings-header.i-role-tabheaders").area("board settings").tag("select setting tab").nameTemplate("select [<%= name%>] tab"),this.track(".tau-cellholder .tau-add").area("board").tag("quick add").name("quick add in cell")},trackSidebar:function(){this.track(".tau-pane-collapser").area("sidebar").name("boards menu collapse (expand)"),this.track(".tau-boardselector__headermenu__item").nameTemplate("customize board menu -> <%= name%>").area("sidebar").tag("boards menu header")},startTracking:function(){var e=this,i=function(e){return e?e:null},r=function(e){var t=i(e.text())||i(e.attr("title"))||i(e.data("title"))||i(e.data("label"))||i(e.attr("role"))||"";return t.toLowerCase()},a=function(e,t){var i;return e.nameSelector?(i=n(e.nameSelector,this).text(),i&&e.data.name&&(i=e.data.name+" "+i),i):(i=e.data.name||r(t)||r(n(this)),i.replace(/[\t\n;]/g,""))
},o=function(i){try{var r=n(i.target),o=i.data,s=a.call(this,o,r);if(!s)return;o.nameTemplate&&(s=t.template(o.nameTemplate)({name:s}));var c=t.defaults({name:s,event:o.event},o.data);e.fire("track.action",c)}catch(u){}},s=n("body");t.each(this.clickMap,function(e){s.on(e.event,e.selector,e,o)})},init:function(e){var n=this;n._super(e),e=e||{},e.disableClicksTracking!==!0&&(t.defaults(e,{clickMap:{}}),n.clickMap=e.clickMap,n.trackSidebar(),n.trackMainMenu(),n.trackGettingStarted(),n.trackBoard(),n.trackQuickAdd(),n.startTracking())}})}),define("libs/schedule",[],function(){function e(e){this.createdOn=new Date,this.period=e,this.expected=0,this.xxx=null,this.MAX_DELTA=6e4,this.iterationNo=-1;var t=this.loop=function(e,n){var i=new Date,r=i.getTime(),a=this.expected>0?this.expected:r,o=r-a;n||e({date:i,"schedule-shift":o,i:++this.iterationNo}),this.expected=+new Date+this.period,this.xxx=setTimeout(function(){t(e,n)},this.period)}.bind(this);this.stop=function(){this.expected=0,clearTimeout(this.xxx)}.bind(this)}return e}),define("tracking/extensions/session",["jQuery"],function(e){var t=e.Deferred();window.session={options:{use_html5_location:!1,session_timeout:1},start:function(e){t.resolve(e)}};var i=function(e,t,i){"use strict";var r=.4,a={use_html5_location:!1,ipinfodb_key:!1,gapi_location:!0,location_cookie:"location",location_cookie_timeout:5,session_timeout:32,session_cookie:"first_session",get_object:null,set_object:null},o=function(){if(e.session=e.session||{},e.session.contains=function(e){if("string"==typeof e)return-1!==this.indexOf(e);for(var t=0;t<e.length;t++)if(-1!==this.indexOf(e[t]))return!0;return!1},e.session&&e.session.options)for(var t in e.session.options)a[t]=e.session.options[t];var n={api_version:r,locale:c.locale(),current_session:c.session(),original_session:c.session(a.session_cookie,24*a.session_timeout*60*60*1e3),browser:c.browser(),plugins:c.plugins(),time:c.time(),device:c.device()};if(a.use_html5_location?n.location=c.html5_location():a.ipinfodb_key?n.location=c.ipinfodb_location(a.ipinfodb_key):a.gapi_location&&(n.location=c.gapi_location()),e.session&&e.session.start)var i=e.session.start;
var o,s=0,u=function(t){t&&s--,0===s&&i&&i(e.session)};e.session={};for(var d in n)if(o=n[d],"function"==typeof o)try{o(function(t){e.session[d]=t,u(!0)}),s++}catch(l){e.console&&"function"==typeof console.log&&(console.log(l),u(!0))}else e.session[d]=o;u()},s={detect:function(){var e={browser:this.search(this.data.browser),version:this.search(i.userAgent)||this.search(i.appVersion),os:this.search(this.data.os)};if("Linux"==e.os)for(var t=["CentOS","Debian","Fedora","Gentoo","Mandriva","Mageia","Red Hat","Slackware","SUSE","Turbolinux","Ubuntu"],n=0;n<t.length;n++)if(i.userAgent.toLowerCase().match(t[n].toLowerCase())){e.distro=t[n];break}return e},search:function(e){if("object"!=typeof e){var t=e.indexOf(this.version_string);if(-1==t)return;return parseFloat(e.substr(t+this.version_string.length+1))}for(var n=0;n<e.length;n++){var i=e[n].string,r=e[n].prop;if(this.version_string=e[n].versionSearch||e[n].identity,i){if(-1!=i.indexOf(e[n].subString))return e[n].identity}else if(r)return e[n].identity}},data:{browser:[{string:i.userAgent,subString:"Chrome",identity:"Chrome"},{string:i.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:i.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:e.opera,identity:"Opera",versionSearch:"Version"},{string:i.vendor,subString:"iCab",identity:"iCab"},{string:i.vendor,subString:"KDE",identity:"Konqueror"},{string:i.userAgent,subString:"Firefox",identity:"Firefox"},{string:i.vendor,subString:"Camino",identity:"Camino"},{string:i.userAgent,subString:"Netscape",identity:"Netscape"},{string:i.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:i.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:i.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:i.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:i.platform,subString:"Win",identity:"Windows"},{string:i.platform,subString:"Mac",identity:"Mac"},{string:i.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:i.userAgent,subString:"iPad",identity:"iPad"},{string:i.userAgent,subString:"Android",identity:"Android"},{string:i.platform,subString:"Linux",identity:"Linux"}]}},c={browser:function(){return s.detect()
},time:function(){var e=new Date,t=new Date;return e.setMonth(0),e.setDate(1),t.setMonth(6),t.setDate(1),{tz_offset:-(new Date).getTimezoneOffset()/60,observes_dst:e.getTimezoneOffset()!==t.getTimezoneOffset()}},locale:function(){var e=(i.language||i.browserLanguage||i.systemLanguage||i.userLanguage||"").split("-");return 2==e.length?{country:e[1].toLowerCase(),lang:e[0].toLowerCase()}:e?{lang:e[0].toLowerCase(),country:null}:{lang:null,country:null}},device:function(){var n,r,a={screen:{width:e.screen.width,height:e.screen.height}};try{n=e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth}catch(o){n=0}try{r=e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight}catch(o){r=0}return a.viewport={width:n,height:r},a.is_tablet=!!i.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),a.is_phone=!a.is_tablet&&!!i.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i),a.is_mobile=a.is_tablet||a.is_phone,a},plugins:function(){var e=function(e){if(i.plugins){for(var t,n=0,r=i.plugins.length;r>n;n++)if(t=i.plugins[n],t&&t.name&&-1!==t.name.toLowerCase().indexOf(e))return!0;return!1}return!1},t=function(e){for(var t=!0,n=0;n<e.length;n++){try{var t=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"+e[n]),!0)}catch(i){}if(t)return!0}return!1};return{flash:e("flash")||t([".7",".6",""]),silverlight:e("silverlight"),java:e("java"),quicktime:e("quicktime")}},session:function(n,i){var r=u.get_obj(n);if(null==r){r={visits:1,start:(new Date).getTime(),last_visit:(new Date).getTime(),url:e.location.href,path:e.location.pathname,referrer:t.referrer,referrer_info:u.parse_url(t.referrer),search:{engine:null,query:null}};var a,o=[{name:"Google",host:"google",query:"q"},{name:"Bing",host:"bing.com",query:"q"},{name:"Yahoo",host:"search.yahoo",query:"p"},{name:"AOL",host:"search.aol",query:"q"},{name:"Ask",host:"ask.com",query:"q"},{name:"Baidu",host:"baidu.com",query:"wd"}],s=o.length,c=0,d="q query term p wd query text".split(" ");
for(c=0;s>c;c++)if(a=o[c],-1!==r.referrer_info.host.indexOf(a.host)){r.search.engine=a.name,r.search.query=r.referrer_info.query[a.query],r.search.terms=r.search.query?r.search.query.split(" "):null;break}if(null===r.search.engine&&r.referrer_info.search.length>1)for(c=0;c<d.length;c++){var l=r.referrer_info.query[d[c]];if(l){r.search.engine="Unknown",r.search.query=l,r.search.terms=l.split(" ");break}}}else r.prev_visit=r.last_visit,r.last_visit=(new Date).getTime(),r.visits++,r.time_since_last_visit=r.last_visit-r.prev_visit;return u.set_obj(n,r,i),r},html5_location:function(){return function(e){i.geolocation.getCurrentPosition(function(t){t.source="html5",e(t)},function(){a.gapi_location?c.gapi_location()(e):e({error:!0,source:"html5"})})}},gapi_location:function(){return function(t){var n=u.get_obj(a.location_cookie);n&&"google"===n.source?t(n):(e.gloader_ready=function(){"google"in e&&(e.google.loader.ClientLocation?(e.google.loader.ClientLocation.source="google",t(e.google.loader.ClientLocation)):t({error:!0,source:"google"}),u.set_obj(a.location_cookie,e.google.loader.ClientLocation,60*a.location_cookie_timeout*60*1e3))},u.embed_script("https://www.google.com/jsapi?callback=gloader_ready"))}},architecture:function(){var e=n.userAgent.match(/x86_64|Win64|WOW64|x86-64|x64\;|AMD64|amd64/)||"x64"===n.cpuClass?"x64":"x86";return{arch:e,is_x64:"x64"==e,is_x86:"x68"==e}},ipinfodb_location:function(t){return function(n){var i=u.get_obj(a.location_cookie);i||"ipinfodb"!==i.source?n(i):(e.ipinfocb=function(e){if("OK"===e.statusCode)e.source="ipinfodb",u.set_obj(a.location_cookie,e,60*a.location_cookie*60*1e3),n(e);else{if(a.gapi_location)return c.gapi_location()(n);n({error:!0,source:"ipinfodb",message:e.statusMessage})}},u.embed_script("http://api.ipinfodb.com/v3/ip-city/?key="+t+"&format=json&callback=ipinfocb"))}}},u={parse_url:function(e){var n=t.createElement("a"),i={};n.href=e;var r=n.search.substr(1);if(""!=r)for(var a,o=r.split("&"),s=0,c=o.length;c>s;s++)a=o[s].split("="),2===a.length&&(i[a[0]]=decodeURI(a[1]));
return{host:n.host,path:n.pathname,protocol:n.protocol,port:""===n.port?80:n.port,search:n.search,query:i}},set_cookie:function(n,i,r,a){return n?(a||(a={}),(null===i||void 0===i)&&(r=-1),r&&(a.expires=(new Date).getTime()+r),t.cookie=[encodeURIComponent(n),"=",encodeURIComponent(String(i)),a.expires?"; expires="+new Date(a.expires).toUTCString():"","; path="+(a.path?a.path:"/"),a.domain?"; domain="+a.domain:"",e.location&&"https:"===e.location.protocol?"; secure":""].join("")):null},get_cookie:function(e,n){return(n=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(t.cookie))?decodeURIComponent(n[1]):null},embed_script:function(e){var n=t.createElement("script");n.type="text/javascript",n.src=e,(t.body||t.getElementsByTagName("body")[0]||t.head).appendChild(n)},package_obj:function(e){if(e){e.version=r;var t=d.stringify(e);return delete e.version,t}},set_obj:function(e,t,n,i){u.set_cookie(e,u.package_obj(t),n,i)},get_obj:function(e){var t;try{t=d.parse(u.get_cookie(e))}catch(n){}return t&&t.version==r?(delete t.version,t):void 0}};null!=a.get_object&&(u.get_obj=a.get_object),null!=a.set_object&&(u.set_obj=a.set_object);var d={parse:e.JSON&&e.JSON.parse||function(e){return"string"==typeof e&&e?new Function("return "+e)():null},stringify:e.JSON&&e.JSON.stringify||function(e){var t=typeof e;if("object"===t&&null!==e){var n,i,r=[],a=e&&e.constructor===Array;for(n in e)i=e[n],t=typeof i,"string"===t?i='"'+i+'"':"object"===t&&null!==i&&(i=this.stringify(i)),r.push((a?"":'"'+n+'":')+i);return(a?"[":"{")+r.join(",")+(a?"]":"}")}return"string"===t?'"'+e+'"':void 0}};o()};return"undefined"==typeof window.exports?i(window,document,navigator):window.exports.session=i,t}),define("tracking/extensions/host.info",["jQuery","app.path","libs/json2"],function(e,t){var n=null;return{get:function(){if(!n){var i=localStorage.getItem("host_info");if(i)try{i=e.parseJSON(i);var r=new Date-new Date(i.date),a=Math.floor(r/36e5);if(24>a)return n=e.Deferred().resolve(i.data)}catch(o){}n=e.ajax({url:t.get()+"/info.ashx",dataType:"json"}).done(function(e){var t={date:(new Date).getTime(),data:e};
localStorage.setItem("host_info",JSON.stringify(t))})}return n}}}),define("tracking/extensions/extension.tracking.user.host",["jQuery","app.path","Underscore","libs/schedule","./extension.tracking.base","tau/configurator","./session","tp/mashups","./host.info","tp/mashups/failed"],function(e,t,n,i,r,a,o,s,c,u){var d=function(e,t){if(!e)return"";var n=e.toLowerCase().split("/mashups/");return n.length?(n=(n[n.length-1]||"").replace("/","").replace(t,"").replace(".js",""),n=n.split(s.prototype.mashupKeySeparator)[0]):""};return r.extend({init:function(e){var t=e.scheduler;this._super.apply(this,arguments),this.global.on("application.context.data",function(e){e.removeListener(),t.onceADay(function(){this.getSessionData(e.data,function(e){this.fire("data.track",e)}.bind(this))}.bind(this)),window.performance&&window.performance.memory&&window.performance.memory.usedJSHeapSize&&t.eachXMins(30,function(e){var t={date:e.date,"live-minutes":30*e.i,"schedule-shift":e["schedule-shift"],memory:window.performance.memory};taus.track("browser-memory",t)})}.bind(this),this)},"global boardsSet.selected":function(e,t){var n=this.getHost(),i=this.getUser(),r={userProcess:{_id:i._id,user:{id:i._id},host:{id:n},process:t}};this.fire("data.track",r)},getUser:function(e){var t=this.getHost();e=e||{};var i=[window.loggedUser,a.getLoggedUser(),e.loggedUser,{id:0,role:"N/A"}],r=n.find(i,n.identity);return r=n.deepClone(r),r._id=t+"/user/"+r.id,r.host={id:t},r.tau_keep_date=!0,delete r.id,r},getSessionData:function(t,i){var r=this,a=r.getHost(),l=this.getUser(t);o.done(function(t){var r=t.location||{address:{}},o=new Date,p=o.getDate()+"_"+(o.getMonth()+1)+"_"+o.getFullYear(),g=l._id+"/"+p;delete r.latitude,delete r.longitude,delete r.source,l.location=r;var f=[],h=s.prototype.getRegisteredMashups();n.each(n.keys(h),function(e){var t=d(e,a),i=h[e],r=i.files;t.length&&f.push({_id:a+"/"+t+"/"+p,name:n.trim(t),host:{id:a},files:r})});var m={user:l,mashup:f,host:{_id:a},visit:{_id:g,user:{id:l._id},host:{id:a},browser:t.browser,device:t.device,locale:t.locale,location:r}},v=n.keys(u);
if(v.length>0){var b=[];n.each(v,function(e){var t=d(e,a);t.length&&b.push({_id:a+"/"+t+"/"+p,name:t,path:e,host:{id:a}})}),m.failedMashup=b}c.get().done(function(t){if("string"===e.type(t.createdOn)){var r=t.createdOn.split("/");t.createdOn=new Date(parseInt(r[2],10),parseInt(r[0],10)-1,parseInt(r[1],10))}n.extend(m.host,t),n.extend(m.visit.host,t),n.extend(m.user.host,t),i(m)})})}})}),define("tracking/extensions/extension.tracking.store.v2",["Underscore","./extension.tracking.base","tracking/stores/store.factory"],function(e,t,n){return t.extend({init:function(t){this._super(t),this.sid=t.sid,this.stores=[],e.each(t.store,function(e,t){try{var i=n.createTrackingStore(t,e);this.stores.push(i)}catch(r){}},this)},postData:function(t){if(e.isObject(t))for(var n=this,i=0;i<n.stores.length;i++){var r=n.stores[i];try{r.api.post(t,n.bus)}catch(a){}}},"bus data.track":function(e,t){this.postData(t)},"bus track.action":function(e,t){taus.track(t)},"bus track.action.id.sid":function(e,t){t["@"]=["action.id.sid"],taus.track(t)},"bus track.error":function(e,t){taus.error(t)},"bus track.statistics":function(e,t){taus.track("statistics",t)}})}),define("tracking/extensions/extension.tracking.rest",["Underscore","./extension.tracking.base","tau/configurator"],function(e,t,n){return t.extend({"global store.command.executed":function(t,i){if(i&&i.command&&i.command.config&&("save"==i.command.name||"remove"==i.command.name)){var r=i.command.config.id,a=r?" #"+r:"",o=i.command.type.toLowerCase();if("remove"==i.command.name)return void this.fire("track.action",{action:"delete entity",name:"delete "+o+a,area:"entity",tags:["delete "+o,"delete entity","entity"],type:o,id:r});var s=i.command.config.$set;if("save"==i.command.name&&s){var c=r||s.id?"update ":"add ",u=e.keys(s);if(0===u.length)return;var d=u.join(","),l=window.loggedUser||n.getLoggedUser()||{id:0,role:"N/A"};this.fire("track.action.id.sid",{action:c+"entity",_id:this.getHost()+"/"+t.caller.id+"/"+l.id+"/"+u.join("_"),name:c+o+a+" ["+d.toLowerCase()+"]",area:"entity",tags:[c+o,c+"entity","entity","add|update"],type:o,changes:u,params:s,id:r})
}}},"global store.command.failed":function(t){var n="something is wrong";try{if(t.data&&t.data.data){t.data.data.Message&&(n=t.data.data.Message);var i=t.data.data.response;if(i){if(i.Message&&(n=i.Message),e.isArray(i)){var r=[i[1]];e.isArray(i[4])&&i[4].length>0&&i[4][0]!=r[0]&&r.push(i[4][0]),n=r.join(":&nbsp;")}i.Error&&i.Error.Message&&(n=i.Error.Message)}}}catch(a){}var o={name:n,tags:["error","rest"]};this.fire("track.error",o),this.fire("track.action",o)}})}),define("tracking/extensions/extension.tracking.browser.actions",["./extension.tracking.base","jQuery"],function(e,t){return e.extend({init:function(){t(window).on("focus blur",this.trackFocusBlur)},trackFocusBlur:function(e){var t=e.type;taus.track("action",{action:t,name:t+" application",tags:["focus|blur application","browser event"]})}})}),define("tracking/component.tracking",["Underscore","tau/core/component-base","./extensions/extension.tracking.board.statistics","./extensions/extension.tracking.application.context","./extensions/extension.tracking.board.actions","./extensions/extension.tracking.clicks","./extensions/extension.tracking.user.host","./extensions/extension.tracking.store.v2","./extensions/extension.tracking.rest","./extensions/extension.tracking.browser.actions"],function(e,t,n,i,r,a,o,s,c,u){return{create:function(d){var l=e.compact([{type:n},{type:a},{type:o},{type:i},{type:r},{type:s},{type:c},{type:u}]),p={name:"tracking component","queue.bus":!0},g=new t(e.extend(p,d||{}));return e.each(l,function(e){g.attach(e.type,e.config)}),g.bus}}}),define("tracking/spy.event",["jQuery"],function(e){return e.Deferred()}),define("tracking/tauspy",["Underscore","jQuery","./taus","./taus.types.adapters","tau/core/global.bus","./component.tracking","./spy.event","libs/schedule"],function(e,t,n,i,r,a,o,s){var c=null,u={start:function(e){return c||(e=e||{},c=a.create(e)),c}},d=function(t){var i=[],r=function(e){return function(){i.push({methodName:e,params:[].slice.call(arguments)})}};window.taus={context:r("context"),track:r("track"),error:r("error"),start:function(){var t,n,r,a="action",o=[].slice.call(arguments);
return 3===o.length?(t=o[0],n=o[1],r=o[2]):2===o.length?e.isObject(o[0])?(t=a,n=o[0],r=o[1]):(t=o[0],n=o[1],r=e.uniqueId()):1===o.length&&(t=a,n=e.isString(o[0])?{name:o[0]}:o[0],r=e.uniqueId()),i.push({methodName:"start",params:[function(){return{tick:+new Date,args:[t,n,r]}}]}),{stop:this.stop.bind(this,r)}},stop:function(){var e=[].slice.call(arguments);i.push({methodName:"stop",params:[function(){return{tick:+new Date,args:e}}]})}};for(var a=new n(t);i.length>0;){var o=i.shift();a[o.methodName].apply(a,o.params)}window.taus=a},l=function(e,t){var n=new Date,i=n.getHours(),r=n.getMinutes(),a=60*(24-i)-r,o=new s(60*(a+1)*1e3);o.loop(function(t){e(t.date),o.stop(),setTimeout(l.bind(null,e,!0),0)},t)},p=function(e){var t=e.data("label")||e.attr("title")||e.data("title")||e.attr("role")||e.text()||"";return t.toLowerCase()},g=function(e){var t=e.attr("tauspref")||"",n=["click"];t&&n.push(t);var i=n.join(" "),r=e.attr("taustype"),a=r?r.split(","):[];taus.track("action",{"@":a,action:i,name:[i,p(e)].join(" "),tags:n})};return t(document).on("click",".i-taus",function(e){g(t(e.currentTarget))}),t.Event.prototype.stopPropagation=e.wrap(t.Event.prototype.stopPropagation,function(e){var n=this.originalEvent;if(n){var i=t(n.target).closest(".i-taus");0!==i.length&&g(i)}return e.apply(this,arguments)}),o.done(function(t){var n=(new Date).getTime(),a={version:2},o={onceADay:l,eachXMins:function(e,t){new s(60*e*1e3).loop(t)}};u.start(e.extend({sid:n},t,{scheduler:o},a)),d(e.extend({sid:n},t,{scheduler:o},a,{globalBus:r.get(),adapters:i}))}),u}),define("main.boardplus.init",["require","jQuery","Underscore","libs/parseUri","tau/service.container","tau/configurator","tau/services/service.navigator","tau/components/component.application.generic","tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific","tau/components/extensions/extension.tracking.performance","tau/components/extensions/extension.views.menu.comet.listener","main.boardplus.login","main.boardplus.routes","tp/mashups.loader","Modernizr","tracking/tauspy"],function(e){function t(e){var t=new a;
t._id=i.uniqueId("board_"),t.isBoardEdition=!0,t.setWindow(window),t.setFeaturesService(t.getWindow().tauFeatures),t.setLoggedUser(t.getWindow().loggedUser);var n=new s(t,{parameterName:e});return t.registerService("navigator",n),t}var n=e("jQuery"),i=e("Underscore"),r=e("libs/parseUri"),a=e("tau/service.container"),o=e("tau/configurator"),s=e("tau/services/service.navigator"),c=e("tau/components/component.application.generic"),u=e("tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific"),d=e("tau/components/extensions/extension.tracking.performance"),l=e("tau/components/extensions/extension.views.menu.comet.listener"),p=e("main.boardplus.login"),g=e("main.boardplus.routes"),f=e("tp/mashups.loader");e("Modernizr"),e("tracking/tauspy"),o.isBoardEdition=!0,n(function(){var n="page",i=t(n),a=o.getGlobalBus();if(tauFeatures["load.progress"]){var s={},h=function(){a.removeAllListeners(s),setTimeout(function(){tauLoadProgress.activityEnd("app.init").remove()},4)};a.addEventListener("error",h,s),a.addEventListener("contentRendered",h,s)}new p(i,n).process().then(function(){var t={name:"application board",options:{applicationId:n},routes:g.createApplicationRoutes(),context:{configurator:i},extensions:[u,d,l]},a=c.create(t),o=function(){tauFeatures["load.progress"]&&tauLoadProgress.activityEnd("user.mashups").activity("app.init"),a.initialize(t)};r(location.href).hasQueryKey("nomashups")?o():i.getFeaturesService().isEnabled("mashups.loader")?f.initDeferred.done(function(){f.loadState.beforeAppInit.status.done(function(){o()})}):e(["user/mashups"],function(){o()})})})}),require(["main.boardplus.init"],function(){}),define("main.boardplus",function(){});