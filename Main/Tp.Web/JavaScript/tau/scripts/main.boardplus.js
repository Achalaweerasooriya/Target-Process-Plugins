define("tau/components/extensions/extension.tracking.performance",["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({init:function(e){this.globalBus=e.bus.globalBus,this._super(e),this._slice={},this._commands={},this._startLifeCycle=null,this.diagnostics=e.context.configurator.getDiagnosticsService(),this._setPageClientProcessingTime()},_setPageClientProcessingTime:function(){var e=this.diagnostics.page();e&&(e.client=(new Date).getTime()-window.clientStartTime.getTime())},_requestCompleted:function(e,t){this._commands[t.command.method]=parseInt(t.response.getResponseHeader("X-Stopwatch"),10)},_viewReady:function(e){if(this._startLifeCycle.caller.id==e.caller.id){var t=e.date-this._startLifeCycle.date,i=Math.max(0,this._commands.xaxis||0,this._commands.yaxis||0);this._commands.list&&(i+=this._commands.list),this._commands.cells&&(i+=this._commands.cells),this.diagnostics.set("board",{server:i,client:t-i})}},"globalBus start.lifecycle":function(e){this._startLifeCycle=e},"globalBus slice.ready":function(t,i){e.each(i,function(e,t){this._slice[t]!==e&&(this._slice[t]&&(this._slice[t].removeListener("request.completed",this._requestCompleted,this),this._commands={}),this._slice[t]=e,e.on("request.completed",this._requestCompleted,this))},this)},"globalBus model.cells.content.loaded + cardsFullyLoaded":function(e){this._viewReady(e["model.cells.content.loaded"])},"globalBus overview.board.ready":function(e){this._viewReady(e)}})}),define("tau/components/extensions/extension.views.menu.comet.listener",["require","tau/components/extensions/component.extension.base"],function(e){var t=e("tau/components/extensions/component.extension.base");return t.extend({init:function(e){this._super(e);var t=e.context.configurator;this._listener=t.getViewsMenuCometListener(),this._listener.startListen()},destroy:function(){this._listener.stopListen(),this._super()}})}),define("tau/components/dashboard/widget.templates/new.list/list.filter.component.renderer",["require","jQuery","./list.component.renderer","tau/components/component.filter","libs/jquery/jquery.toggleFilter","libs/jquery/jquery.tau.resetableInput"],function(e){var t=e("jQuery"),i=e("./list.component.renderer"),n=e("tau/components/component.filter");
return e("libs/jquery/jquery.toggleFilter"),e("libs/jquery/jquery.tau.resetableInput"),{insertFilterComponent:function(e,a,r){var s=t(e),o={context:{configurator:a},name:"cells",filter:r.cells.filter,useFilter:!0},l=n.create(o);l.on("afterRender",function(e,t){s.append(t.element),s.find(".i-role-filter-control").addClass("boardsettings-filter--show"),l.fire("view.dom.ready"),l.fire("$form.ready",s)}),l.fire("initialize",o),l.fire("boardSettings.ready",{boardSettings:i.createStubBoardSettings(r,a.getBoardSettingsFactory())})}}}),define("jsx!tau/components/dashboard/widget.templates/new.list/dsl.filter.view",["require","jQuery","react","jsx!../shared/settings.list.item.view","./list.filter.component.renderer"],function(e){var t=e("jQuery"),i=e("react"),n=e("jsx!../shared/settings.list.item.view"),a=e("./list.filter.component.renderer");return i.createClass({componentDidMount:function(){a.insertFilterComponent(this.refs.filterContainer.getDOMNode(),this.props.configurator,this.props.listDefinition)},getFilter:function(){return t(this.getDOMNode()).find(".i-role-filter-input").val()},render:function(){return i.createElement(n,{labelClassName:"tau-select-inline",title:"Filter"},i.createElement("div",{className:"tau-inline-group",ref:"filterContainer"}))}})}),define("tau/components/dashboard/widget.templates/new.list/generic.list.template",["require","Underscore","react","./list.component.renderer","./linked/new.list.linked.widget.template","jsx!../shared/settings.container.view","jsx!./page.size.selector.view","jsx!./dsl.filter.view"],function(e){var t=e("Underscore"),i=e("react"),n=e("./list.component.renderer"),a=e("./linked/new.list.linked.widget.template"),r=e("jsx!../shared/settings.container.view"),s=e("jsx!./page.size.selector.view"),o=e("jsx!./dsl.filter.view"),l=i.createClass({displayName:"GenericListSettingsView",render:function(){return i.createElement(r,null,i.createElement(o,{ref:"dslFilter",configurator:this.props.configurator,listDefinition:this.props.listDefinition}),i.createElement(s,{ref:"pageSizeSelector",initialPageSize:this.props.listDefinition.cellPaging.onPage}))
}});return{create:function(e,a){var r=this,s=t.deepClone(a.listDefinition),o=t.deepClone(a.listOptions);return{id:a.id,name:a.name,description:a.description,previewSrc:a.previewSrc||"../img/widgets/lists-list.png",tags:a.tags,defaultSettings:{pageSize:s.cellPaging.onPage,filter:s.cells.filter},insert:function(t,i){return n.insertListComponent({placeholder:t,listDefinition:r._constructDefinition(s,i),listOptions:o,configurator:e})},insertSettings:function(t,n){var a=i.render(i.createElement(l,{configurator:e,listDefinition:r._constructDefinition(s,n)}),t);return function(){return{pageSize:a.refs.pageSizeSelector.getSelectedPageSize(),filter:a.refs.dslFilter.getFilter()}}}}},_constructDefinition:function(e,i){return e=t.deepClone(e),i=t.pick(i,"pageSize","filter"),a.mergeWidgetSettingsIntoListDefinition(e,i),i.filter&&(e.cells.useFilter=!0,e.cells.filter=i.filter),e}}}),define("tau/components/dashboard/services/dashboard.widget.template.default.source.lists",["require","../widget.templates/new.list/generic.list.template","Underscore"],function(e){var t=e("../widget.templates/new.list/generic.list.template"),i=e("Underscore");return{getCustomListTemplates:function(e){return i.map(this._getListDefinitions(),function(i){return t.create(e,i)})},_getListDefinitions:function(){return this._setDefaultValues([{id:"new.list.new.bugs",name:"New Bugs",description:"A list of all the latest bugs",listDefinition:{cells:{types:["bug"],filter:"",useFilter:!1,ordering:{name:"Creation Date",direction:"Desc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_bug:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"assigned_users",alignment:"base"},{id:"create_date",alignment:"base"},{id:"severity_short",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.open.impediments",name:"Open Impediments",description:"Open impediments displayed in a list",listDefinition:{cells:{types:["impediment"],filter:"?EntityState.IsFinal is False",useFilter:!0,ordering:{name:"Creation Date",direction:"Desc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_impediment:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"create_date",alignment:"base"},{id:"priority_short",alignment:"base"},{id:"responsible_person",alignment:"base"},{id:"state_short",alignment:"alt"}]]}},viewMode:"newlist"}},{id:"new.list.new.entities",name:"New Entities",description:"A list of recently created assignable entities, like bugs and user stories",listDefinition:{cells:{types:["epic","feature","userstory","bug","task","request"],filter:"",useFilter:!1,ordering:{name:"Creation Date",direction:"Desc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_epic_feature_userstory_bug_task_request:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"create_date",alignment:"base"},{id:"owner",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.programs.status",name:"Programs status",description:"Programs progress with high level indicators",previewSrc:"../img/widgets/lists-programs.png",listDefinition:{cells:{types:["program"],filter:"",useFilter:!1,ordering:{name:"Name",direction:"Asc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_program:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"progress_long_program",alignment:"base"},{id:"feature_icon",alignment:"base"},{id:"us_opentotal",alignment:"base"},{id:"bugs",alignment:"base"},{id:"projects_badge_program",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.projects.status",name:"Projects status",description:"List of projects with progress indicators",previewSrc:"../img/widgets/lists-projects.png",listDefinition:{cells:{types:["project"],filter:"",useFilter:!1,ordering:{name:"Name",direction:"Asc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_project:{list:[[{id:"team_project_name_long",alignment:"base"},{id:"progress_long",alignment:"base"},{id:"feature_icon",alignment:"base"},{id:"us_opentotal",alignment:"base"},{id:"bugs",alignment:"base"},{id:"owner",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.teams.status",name:"Teams status",description:"High level progress of Teams",previewSrc:"../img/widgets/lists-projects.png",listDefinition:{cells:{types:["team"],filter:"",useFilter:!1,ordering:{name:"Name",direction:"Asc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_team:{list:[[{id:"team_project_name_long",alignment:"base"},{id:"team_team",alignment:"base"},{id:"projects_badge_team",alignment:"base"},{id:"feature_icon",alignment:"base"},{id:"us_opentotal",alignment:"base"},{id:"bugs",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.releases.status",name:"Releases status",description:"Current Releases progress on a high level",previewSrc:"../img/widgets/lists-releases.png",listDefinition:{cells:{types:["release"],filter:"?it is Current",useFilter:!0,ordering:{name:"Name",direction:"Asc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_release:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"progress_long_release_iteration",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"us_opentotal",alignment:"base"},{id:"burndownlink",alignment:"base"},{id:"end_date",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.iterations.status",name:"Iterations status",description:"Current iterations progress on a high level",previewSrc:"../img/widgets/lists-teamiterations.png",listDefinition:{cells:{types:["iteration"],filter:"?it is Current",useFilter:!0,ordering:{name:"Name",direction:"Asc"}},x:{types:[],filter:"",useFilter:!1,ordering:{}},y:{types:[],filter:"",useFilter:!1,ordering:{}},cardSettings:{list_iteration:{list:[[{id:"entity_name_1line",alignment:"base"},{id:"project_abbr",alignment:"base"},{id:"iteration_velocity",alignment:"base"},{id:"effort_spent_total_collection",alignment:"base"},{id:"progress_long_release_iteration",alignment:"base"},{id:"burndownlink",alignment:"base"},{id:"dates",alignment:"base"}]]}},viewMode:"newlist"}},{id:"new.list.milestones",name:"Milestones",description:"A list of upcoming milestones",previewSrc:"../img/widgets/lists-milestones.png",listDefinition:{cells:{types:["milestone"],ordering:{name:"Date",direction:"Asc"},filter:"?It.Date >= Today"},cardSettings:{list_milestone:{list:[[{id:"milestone_date",alignment:"base"},{id:"milestone_name",alignment:"base"},{id:"project_abbrs_milestone",alignment:"base"}]]}},viewMode:"newlist"},listOptions:{quickAddOptions:{disabled:!0}}}])
},_setDefaultValues:function(e){return i.each(e,function(e){i.defaults(e,{tags:["Lists"]}),i.defaults(e.listDefinition,{cellPaging:{onPage:10}})}),e}}}),define("tau/components/dashboard/services/dashboard.widget.template.default.source.reports",["require","../widget.templates/custom.report/custom.report.template","Underscore"],function(e){var t=e("../widget.templates/custom.report/custom.report.template"),i=e("Underscore");return{getCustomReportTemplates:function(e){return i.map(this._getReportDefinitions(),function(i){return t(e,i)})},_getReportDefinitions:function(){return this._setDefaultValues([{id:"report.issues.resolution.time.trend",name:"Issues resolution time trend",description:"How quickly issues and questions are resolved",previewSrc:"../img/widgets/reports-trend-down.png",reportDefinition:{reportSettings:{report:{x:"endDate",y:"leadTime",color:"entityType",dimensions:{endDate:{type:"order",scale:"period"},entityType:{type:"category",scale:"ordinal"},leadTime:{type:"measure",scale:"linear"}},guide:{y:{label:"Lead Time"},x:{label:"End Date",tickPeriod:"day"}},type:"line"},dataSource:{source:{filter:'?(RequestType is "Issue" or RequestType is "Question") and CreateDate > Today - 30(days)',items:[{id:"Request"}]},dimensions:[{model:"DAY(EndDate)",id:"endDate"},{model:"Avg(LeadTime)",id:"leadTime"},{model:"entityType.name",id:"entityType"}],user:{}}}}},{id:"report.new.bugs.trend",name:"New Bugs trend",description:"New Bugs added into Project by day",previewSrc:"../img/widgets/reports-trend-flat.png",reportDefinition:{reportSettings:{report:{x:"createDate",y:["count"],color:"entityType",dimensions:{createDate:{type:"order",scale:"period"},entityType:{type:"category",scale:"ordinal"},count:{type:"measure",scale:"linear"}},guide:[{x:{label:"Create Date",tickPeriod:"day"},y:{label:"Count"}}],type:"line"},dataSource:{source:{filter:"?CreateDate >= Today - 30(days)",items:[{id:"Bug"}]},dimensions:[{model:"DAY(createDate)",id:"createDate"},{model:"Count()",id:"count"},{model:"entityType.name",id:"entityType"}],user:{}}}}},{id:"report.cycle.time.trend",name:"Cycle Time trend",description:"How average Cycle Time of Bugs and User Stories changes every week",previewSrc:"../img/widgets/reports-trend-down-double.png",reportDefinition:{reportSettings:{report:{x:"endDate",y:["cycleTime"],color:"entityType",dimensions:{endDate:{type:"order",scale:"period"},cycleTime:{type:"measure",scale:"linear"},entityType:{type:"category",scale:"ordinal"}},guide:[{x:{label:"Time",tickPeriod:"week"},y:{label:"CycleTime"}}],type:"line"},dataSource:{source:{filter:"?EntityState.IsFinal is true and EndDate >= Today - 182(days)",items:[{id:"Bug"},{id:"UserStory"}]},dimensions:[{id:"cycleTime",model:"avg(cycleTime)"},{id:"entityType",model:"entityType.name"},{id:"endDate",model:"week(endDate)"}]}}}},{id:"report.closed.bugs.trend",name:"Closed Bugs trend",description:"Bugs fixed in Project by day",previewSrc:"../img/widgets/reports-trend-up.png",reportDefinition:{reportSettings:{report:{x:"endDate",y:["count"],color:"entityType",dimensions:{endDate:{type:"order",scale:"period"},entityType:{type:"category",scale:"ordinal"},count:{type:"measure",scale:"linear"}},guide:[{x:{label:"End Date",tickPeriod:"day"},y:{label:"Count"}}],type:"line"},dataSource:{source:{filter:"?EndDate >= Today - 30(days)",items:[{id:"Bug"}]},dimensions:[{model:"DAY(endDate)",id:"endDate"},{model:"Count()",id:"count"},{model:"entityType.name",id:"entityType"}]}}}}])
},_setDefaultValues:function(e){return i.each(e,function(e){i.defaults(e,{tags:["Reports"]})}),e}}}),define("libs/react/react-infinity-scroll",["require","react","jQuery"],function(e){var t=e("react"),i=e("jQuery");if(t.addons=t.addons||{},t.addons.InfiniteScroll)return t.addons.InfiniteScroll;var n=t.addons.InfiniteScroll=t.createClass({statics:{setDefaultLoader:function(e){n._defaultLoader=e}},getDefaultProps:function(){return{pageStart:0,hasMore:!1,loadMore:function(){},threshold:250}},reset:function(){this.pageLoaded=0},componentDidMount:function(){this.pageLoaded=this.props.pageStart,this.attachScrollListener()},componentDidUpdate:function(){this.attachScrollListener()},render:function(){var e=this.props;return t.DOM.div(null,e.children,e.hasMore&&(e.loader||n._defaultLoader))},getScrollParent:function(){return i(this.getDOMNode()).scrollParent()[0]},scrollListener:function(){var e=this.getScrollParent();e.scrollHeight-i(e).scrollTop()-i(e).height()<Number(this.props.threshold)&&(this.detachScrollListener(),this.props.loadMore(this.pageLoaded+=1))},attachScrollListener:function(){if(this.props.hasMore){var e=this.getScrollParent();e.addEventListener("scroll",this.scrollListener),e.addEventListener("resize",this.scrollListener),this.scrollListener()}},detachScrollListener:function(){var e=this.getScrollParent();e.removeEventListener("scroll",this.scrollListener),e.removeEventListener("resize",this.scrollListener)},componentWillUnmount:function(){this.detachScrollListener()}});return n}),define("jsx!tau/components/dashboard/infinity.scroll.list",["require","Underscore","react","libs/react/react-infinity-scroll"],function(e){var t=e("Underscore"),i=e("react"),n=e("libs/react/react-infinity-scroll");return i.createClass({propTypes:{pageSize:i.PropTypes.number.isRequired,pageLimit:i.PropTypes.number,loadMore:i.PropTypes.func.isRequired,loadNew:i.PropTypes.func,loadNewInterval:i.PropTypes.number,renderItem:i.PropTypes.func.isRequired,autoRefresh:i.PropTypes.bool},getInitialState:function(){return{hasMore:!0,items:[],hasError:!1}
},componentDidMount:function(){this.props.autoRefresh&&(this._autoRefreshIntervalId=setInterval(this.forceUpdate.bind(this),6e4)),this._loadNewIntervalId=setInterval(this.loadNew,1e3*(this.props.loadNewInterval||60))},componentWillUnmount:function(){clearInterval(this._autoRefreshIntervalId),clearInterval(this._loadNewIntervalId)},reset:function(){this.refs.scroll.reset(),this.setState(this.getInitialState())},_getLoader:function(){return this.props.loader||i.createElement("div",{className:"tau-dashboard-widget-placeholder tau-loading--centered"})},_getEmptyMessage:function(){return this.props.emptyMessage||i.createElement("div",{className:"empty-message"},"No items to show")},_getErrorMessage:function(){return i.createElement("div",{className:"empty-message"},"Sorry, something went wrong :(")},_getHasMore:function(e,t){return e.length===this.props.pageSize&&(!this.props.pageLimit||t<this.props.pageLimit)},loadMore:function(e){this.isMounted()&&this.props.loadMore(e,this.props.pageSize).then(function(t){this.isMounted()&&this.setState({hasMore:this._getHasMore(t,e),items:this.state.items.concat(t)})}.bind(this)).fail(function(){this.isMounted()&&this.setState({hasMore:!1,hasError:!0})}.bind(this))},loadNew:function(){this.props.loadNew&&this.props.loadNew().then(function(e){this.isMounted()&&e.length&&this.setState({items:e.concat(this.state.items)})}.bind(this))},render:function(){var e=t.map(this.state.items,this.props.renderItem);return i.createElement("div",{style:{maxHeight:this.props.maxHeight||"500px",overflowY:"auto"},className:this.props.className||""},i.createElement(n,{ref:"scroll",loader:this._getLoader(),loadMore:this.loadMore,hasMore:this.state.hasMore},e,this.state.hasError?this._getErrorMessage():null,0!==this.state.items.length||this.state.hasMore||this.state.hasError?null:this._getEmptyMessage()))}})}),define("jsx!tau/components/latest.comments/dashboard.widget.latest.comments",["require","jQuery","react","jsx!tau/components/dashboard/infinity.scroll.list","jsx!tau/components/dashboard/widget.templates/shared/status.view"],function(e){var t=(e("jQuery"),e("react")),i=e("jsx!tau/components/dashboard/infinity.scroll.list"),n=e("jsx!tau/components/dashboard/widget.templates/shared/status.view");
return t.createClass({componentWillReceiveProps:function(){this.refs.list.reset(),this._firstLoadCommentId=null},_loadMore:function(e,t){return this.props.service.loadComments(this.props.acid,this.props.source,e,t,null,this._getFirstLoadCommentId()).then(function(e){return!this._firstLoadCommentId&&e.length&&(this._firstLoadCommentId=e[0].id),e}.bind(this))},_loadNew:function(){return this.props.service.loadComments(this.props.acid,this.props.source,1,999,this._getLatestCommentId())},_getFirstLoadCommentId:function(){return this._firstLoadCommentId||null},_getLatestCommentId:function(){var e=this.refs.list.state.items;return e.length?e[0].id:null},_renderCommentItem:function(e){var i=e.general.entityType.name.toLowerCase(),n="tau-text tau-text_type_"+i;return t.createElement("div",{className:"tau-dashboard-widget-comment",key:e.id},t.createElement("div",{className:"tau-dashboard-widget-comment__header"},t.createElement("a",{href:e.owner.userUrl,target:"_blank",onClick:this._openEntityView.bind(this,e.owner.id,"user")},t.createElement("img",{className:"tau-dashboard-widget-person",src:e.owner.avatarUrl,title:e.owner.fullName})),t.createElement("a",{className:"tau-dashboard-widget-name",href:e.owner.userUrl,onClick:this._openEntityView.bind(this,e.owner.id,"user")},e.owner.fullName),t.createElement("div",{className:"tau-dashboard-widget-date-time",title:e.date.full},e.date.userFriendly),e.parentId?t.createElement("span",{className:"tau-icon tau-icon_name_back-arrow"}):null),t.createElement("div",{className:"tau-dashboard-widget-comment__body"},e.description),t.createElement("div",{className:"tau-dashboard-widget-comment__footer"},t.createElement("a",{href:e.general.url,className:n,onClick:this._openEntityView.bind(this,e.general.id,i)},e.general.entityType.abbreviation+" "+e.general.id),t.createElement("a",{href:e.general.url,className:n,onClick:this._openEntityView.bind(this,e.general.id,i)},e.general.name)))},_openEntityView:function(e,t,i){i.preventDefault(),i.stopPropagation(),this.props.service.openEntityView(e,t)
},_getEmptyMessage:function(){return t.createElement(n,null,"No items to show")},render:function(){return t.createElement(i,{ref:"list",pageSize:10,loadMore:this._loadMore,loadNew:this._loadNew,loadNewInterval:600,renderItem:this._renderCommentItem,autoRefresh:!0,emptyMessage:this._getEmptyMessage()})}})}),define("tau/components/latest.comments/dashboard.widget.latest.comments.constants",[],function(){return{SOURCE_ALL:"all",SOURCE_RELATED_TO_ME:"related"}}),define("jsx!tau/components/latest.comments/dashboard.widget.latest.comments.settings",["require","react","./dashboard.widget.latest.comments.constants"],function(e){var t=e("react"),i=e("./dashboard.widget.latest.comments.constants");return t.createClass({getInitialState:function(){return{source:this.props.initialSource}},render:function(){var e=this.state.source.toLowerCase();return t.createElement("ul",{className:"tau-widget-settings-list"},t.createElement("li",{className:"tau-widget-settings-list__item"},t.createElement("label",{className:"tau-switch i-role-show-comments"},t.createElement("span",{className:"tau-widget-settings-list__title"},"Show comments"),t.createElement("div",{className:"tau-inline-group"},t.createElement("button",{className:"tau-btn tau-btn-board-view"+(e===i.SOURCE_ALL?" tau-checked":""),type:"button","data-value":i.SOURCE_ALL,onClick:this._onSourceButtonClick},"All"),t.createElement("button",{className:"tau-btn tau-btn-board-view tau-extension-board-tooltip"+(e===i.SOURCE_RELATED_TO_ME?" tau-checked":""),type:"button","data-value":i.SOURCE_RELATED_TO_ME,"data-title":"Comments from entities you follow, set as an owner or assigned to",onClick:this._onSourceButtonClick},"Related to me")))))},_onSourceButtonClick:function(e){e.preventDefault(),e.stopPropagation(),this.setState({source:e.target.getAttribute("data-value")})}})}),define("tau/components/latest.comments/dashboard.widget.latest.comments.service",["require","jQuery","Underscore","tau/core/class","tau/store/header","./dashboard.widget.latest.comments.constants","tau/utils/utils.date","tau/core/termProcessor"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("tau/core/class"),a=e("tau/store/header"),r=e("./dashboard.widget.latest.comments.constants"),s=e("tau/utils/utils.date"),o=e("tau/core/termProcessor"),l=new o;
return n.extend({init:function(e){this._configurator=e},loadComments:function(e,t,n,a,r,s){return this._loadComments(e,t,n,a,r,s).then(function(e){return i.map(e,this._createCommentItem,this)}.bind(this))},_loadComments:function(e,i,n,s,o,l){var c=t.Deferred();if(i!==r.SOURCE_RELATED_TO_ME&&i!=r.SOURCE_ALL)return c.reject(),c;var d=this._configurator.getApplicationPath()+"/api/v1/comments/"+i+"?format=json&acid="+e+"&skip="+(n-1)*s+"&take="+s+"&from="+o+"&to="+l;return t.ajax({url:d,dataType:"json"}).done(function(e){var t=a.formatObject(e);c.resolve(t.data)}.bind(this)).fail(c.reject),c},_createCommentItem:function(e){var t=this._configurator.getUrlBuilder(),i=e.general.entityType.name.split("|"),n=i[0],a=i.length>1?l.getShortAbbreviation(i[1]):l.getTerms(n).iconSmall;return{id:e.id,parentId:e.parentId,date:{full:s.formatAs(s.parse(e.createDate),"d MMMM yyyy HH:mm"),userFriendly:this._getCommentDateText(s.convertToTimezone(e.createDate))},owner:{id:e.owner.id,fullName:e.owner.firstName+" "+e.owner.lastName,avatarUrl:t.getAvatarUrl(e.owner.id,32),userUrl:t.getNewViewUrl(e.owner.id,"user",!0)},general:{id:e.general.id,name:e.general.name,entityType:{name:n,abbreviation:a},url:t.getNewViewUrl(e.general.id,n,!0)},description:this._getCommentText(e.description)}},_getCommentText:function(e){var i=e.replace(/<img[^>]*>/g,"*image*").replace(/<(?:.|\n)*?>/gm,"").replace(/\s{2,}/g," ");return t("<p>"+i+"</p>").text()},_getCommentDateText:function(e){if(1===s.getDiffInDays(new Date,e)){var t=s.getAge(e,this._configurator.getCurrentDate());return"sec"===t.unit?"1 min ago":t.toString()}return s.formatAs(e,"MMMM d")},openEntityView:function(e,t){this._configurator.getEntityViewService().showEntityView({entityId:e,entityType:t})}})}),define("tau/components/dashboard/widget.templates/dashboard.widget.latest.comments.template",["require","Underscore","libs/react/react-ex","jsx!tau/components/latest.comments/dashboard.widget.latest.comments","jsx!tau/components/latest.comments/dashboard.widget.latest.comments.settings","tau/components/latest.comments/dashboard.widget.latest.comments.constants","tau/components/latest.comments/dashboard.widget.latest.comments.service"],function(e){var t=e("Underscore"),i=e("libs/react/react-ex"),n=e("jsx!tau/components/latest.comments/dashboard.widget.latest.comments"),a=e("jsx!tau/components/latest.comments/dashboard.widget.latest.comments.settings"),r=e("tau/components/latest.comments/dashboard.widget.latest.comments.constants"),s=e("tau/components/latest.comments/dashboard.widget.latest.comments.service");
return function(e){return{id:"latest_comments",name:"Latest Comments",previewSrc:"../img/widgets/general-lastcomments.png",description:"Show all the latest comments or only when it is related to you",tags:["Lists"],insert:function(a,r,o){r=t.extend({acid:o.context.acid,service:new s(e)},r);var l=i.renderClass(n,r,a);return{update:l.setProps.bind(l),updateContext:function(e){l.setProps({acid:e.acid})},destroy:function(){i.unmountComponentAtNode(a)}}},insertSettings:function(e,t){var n=i.renderClass(a,{initialSource:t.source},e);return function(){return{source:n.state.source}}},defaultSettings:{source:r.SOURCE_RELATED_TO_ME}}}}),define("tau/components/follow.activity/modification.type",[],function(){return{None:0,Deleted:1,InnerFieldUpdated:2,ChildRemoved:3,ChildAdded:4,ChildUpdated:5}}),define("tau/components/follow.activity/modification.field.type",[],function(){return{None:0,Simple:1,SimpleCustomField:2,UrlCustomField:3,TemplatedUrlCustomField:4,DateCustomField:5,RichTextCustomField:6,EmptyCustomField:7,ProjectSquad:8,GeneralEntity:9,EmptyField:10,Comment:11,Assignment:12,Attachment:13,State:14}}),define("jsx!tau/components/follow.activity/template.helper",["require","Underscore","react","tau/core/class","./modification.type","./modification.field.type","tau/utils/utils.date","tau/core/termProcessor"],function(e){var t=e("Underscore"),i=e("react"),n=e("tau/core/class"),a=e("./modification.type"),r=e("./modification.field.type"),s=e("tau/utils/utils.date"),o=e("tau/core/termProcessor"),l=new o,c=function(e){var t=0;if(0===e.length)return t;for(var i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t};return n.extend({init:function(e){this._configurator=e,this._urlBuilder=e.getUrlBuilder()},getTemplate:function(e,t){var n=e.general.id,a=this._normalizeEntityType(e.general.type),r="tau-text_type_"+a;return i.createElement("div",{className:"notification__item notification__item--in-widget",key:this._getModificationKey(e)},t?null:i.createElement("div",{className:"follow-title"},i.createElement("a",{href:"#",className:r,onClick:this._openEntityView.bind(this,n,a)},e.general.name," ",i.createElement("span",{className:"tau-text "+r,href:"#"},this._getEntityAbbreviation(a)+" "+n))),this._getContent(e))
},_getModificationKey:function(e){return c(e.general.id+e.field+e.timestamp)},_getContent:function(e){var t=this._isFieldSimple(e);return i.createElement("div",{className:"follow-content"},t?this._getModificationDateBlock(e):null,this._getContainerTemplate(e),t?this._getByBlock(e):null)},_isFieldSimple:function(e){if(null===e.fieldValue)return!0;switch(e.modificationFieldType){case r.Comment:case r.Attachment:case r.GeneralEntity:return!1;case r.Assignment:return!0;default:return!(e.modificationType===a.ChildRemoved||e.modificationType===a.ChildUpdated||e.modificationType===a.ChildAdded)}},_getContainerTemplate:function(e){if(null===e.fieldValue)return e.modificationFieldType==r.ProjectSquad?this._getNoEntityContainer(e):this._getSimpleContainer(e);switch(e.modificationFieldType){case r.Comment:return this._getCommentContainer(e);case r.Attachment:return this._getAttachmentContainer(e);case r.Assignment:return this._getAssignmentContainer(e);case r.State:return this._getStateContainer(e);case r.ProjectSquad:return this._getProjectSquadContainer(e);case r.GeneralEntity:return this._getEntityPropertyContainer(e);default:return e.modificationType===a.ChildRemoved||e.modificationType===a.ChildUpdated||e.modificationType===a.ChildAdded?this._getChildContainer(e):this._getSimpleContainer(e)}},_getSimpleContainer:function(e){if(e.modificationType==a.Deleted)return this._getDeletedTemplate(e);switch(e.modificationFieldType){case r.EmptyField:case r.EmptyCustomField:return this._getEmptyFieldTemplate(e);case r.SimpleCustomField:return this._getSimpleCustomTemplate(e);case r.UrlCustomField:return this._getUrlCustomTemplate(e);case r.TemplatedUrlCustomField:return this._getTemplatedUrlCustomTemplate(e);case r.DateCustomField:return this._getDateCustomTemplate(e);case r.RichTextCustomField:return this._getFieldChangedTemplate(e);default:return this._getSimpleContainerForField(e)}},_getSimpleContainerForField:function(e){switch(e.field){case"BuildDate":case"StartDate":case"EndDate":case"PlannedStartDate":case"PlannedEndDate":return this._getDateTemplate(e);
case"Effort":case"Velocity":return this._getDecimalWithUnitTemplate(e);case"EntityState":return this._getEntityStateTemplate(e);case"LastStatus":return this._getLastStatusTemplate(e);case"Name":return this._getNameTemplate(e);case"Priority":case"Severity":return this._getEntityTemplate(e);case"Responsible":return this._getResponsibleTemplate(e);default:return this._getFieldChangedTemplate(e)}},_getDateTemplate:function(e){var t=s.parse(s.convertToTimezone(e.fieldValue));return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",i.createElement("span",{className:"follow-description__to-value"},s.formatAs(t,"MMMM dd, yyyy")))},_getDecimalWithUnitTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," from ",e.oldFieldValue," to ",i.createElement("span",{className:"follow-description__to-value"},e.fieldValue))},_getEntityStateTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed State from ",e.oldFieldValue," ",i.createElement("span",{className:"tau-icon-general tau-icon-l-arrow"})," ",i.createElement("span",{className:"follow-description__state"},e.fieldValue))},_getLastStatusTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed Last Status to ",i.createElement("span",{className:"follow-description__to-value"},e.fieldValue?"Passed":"Failed"))},_getNameTemplate:function(){return i.createElement("div",{className:"follow-description"},"Renamed this item")},_getDeletedTemplate:function(){return i.createElement("div",{className:"follow-description"},"Removed this item")},_getEmptyFieldTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Set ",this._getFieldName(e)," to ",i.createElement("span",{className:"follow-description__to-value"},"none"))},_getSimpleCustomTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",i.createElement("span",{className:"follow-description__to-value"},e.fieldValue.value))
},_getUrlCustomTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",i.createElement("a",{className:"follow-description__to-value follow-description__link",href:e.fieldValue.value,target:"_blank"},e.fieldValue.title))},_getTemplatedUrlCustomTemplate:function(e){var n=e.fieldValue.value.split(","),a=t.map(n,function(t,n){return i.createElement("a",{className:"follow-description__to-value follow-description__link",key:n,href:e.fieldValue.template.replace("{0}",t),target:"_blank"},t)});return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",a)},_getDateCustomTemplate:function(e){var t=s.parse(s.convertToTimezone(e.fieldValue.value));return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",i.createElement("span",{className:"follow-description__to-value"},s.formatAs(t,"MMMM dd, yyyy")))},_getNoEntityContainer:function(e){return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e)," to ",i.createElement("span",{className:"follow-description__to-value"},"No ",this._getFieldName(e)))},_getEntityTemplate:function(e){var t="Priority"==e.fieldValue.type?"Business Value":e.fieldValue.type;return i.createElement("div",{className:"follow-description"},"Changed ",t," to ",i.createElement("span",{className:"follow-description__to-value"},e.fieldValue.name))},_getResponsibleTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Assigned ",i.createElement("a",{className:"follow-description__to-value",href:"#",onClick:this._openEntityView.bind(this,e.fieldValue.id,"user")},i.createElement("img",{className:"tau-user-avatar",src:this._urlBuilder.getAvatarUrl(e.fieldValue.id,32)})," ",e.fieldValue.name)," as a ",e.fieldValue.type)},_getFieldChangedTemplate:function(e){return i.createElement("div",{className:"follow-description"},"Changed ",this._getFieldName(e))},_getProjectSquadContainer:function(e){var t=e.fieldValue.id,n=this._normalizeEntityType(e.fieldValue.type);
return i.createElement("div",{className:"follow-description"},"Changed ",e.fieldValue.type," to ",i.createElement("a",{className:"follow-description__to-value",href:"#",onClick:this._openEntityView.bind(this,t,n)},e.fieldValue.name))},_getEntityPropertyContainer:function(e){var t=e.fieldValue.id,n=this._normalizeEntityType(e.fieldValue.type),a="tau-entity-icon tau-entity-icon-follow tau-entity-color--"+n+" tau-entity-border--"+n;return i.createElement("div",null,this._getModificationDateBlock(e),i.createElement("div",{className:"follow-description notification__text"},this._getPersonBlock(e)," set ",this._getFieldName(e)," to "),i.createElement("div",{className:"notification__entity-wrap"},i.createElement("a",{href:"#",className:"notification__entity-link",onClick:this._openEntityView.bind(this,t,n)},i.createElement("em",{className:a},this._getEntityAbbreviation(n))," ",e.fieldValue.name)))},_getChildContainer:function(e){var t=e.fieldValue.id,n=this._normalizeEntityType(e.fieldValue.type),a="tau-entity-icon tau-entity-icon-follow tau-entity-color--"+n+" tau-entity-border--"+n;return i.createElement("div",null,this._getModificationDateBlock(e),i.createElement("div",{className:"follow-description notification__text"},this._getPersonBlock(e)," ",this._getAction(e.modificationType)," related entity:"),i.createElement("div",{className:"notification__entity-wrap"},i.createElement("a",{href:"#",className:"notification__entity-link",onClick:this._openEntityView.bind(this,t,n)},i.createElement("em",{className:a},this._getEntityAbbreviation(n))," ",e.fieldValue.name)))},_getCommentContainer:function(e){return i.createElement("div",null,this._getModificationDateBlock(e),i.createElement("div",{className:"follow-description notification__text"},this._getPersonBlock(e)," left a comment:"),i.createElement("div",{className:"notification__comment"},i.createElement("div",{className:"notification__comment__user"},e.fieldValue.name)))},_getAttachmentContainer:function(e){var t=this._configurator.getApplicationPath()+"/Attachment.aspx?AttachmentID="+e.fieldValue.id;
return i.createElement("div",null,this._getModificationDateBlock(e),i.createElement("div",{className:"follow-description"},this._getPersonBlock(e)," attached file:"),i.createElement("ul",{className:"notification__attached-data"},i.createElement("li",{className:"notification__attached-data__item"},i.createElement("a",{className:"notification__attached-data__link",target:"_blank",href:t},e.fieldValue.name))))},_getAssignmentContainer:function(e){return i.createElement("div",{className:"follow-description"},this._getAssignedAction(e.modificationType)," ",i.createElement("a",{className:"follow-description__to-value",href:"#",onClick:this._openEntityView.bind(this,e.fieldValue.id,"user")},i.createElement("img",{className:"tau-user-avatar",src:this._urlBuilder.getAvatarUrl(e.fieldValue.id,32)})," ",e.fieldValue.name)," as a ",e.fieldValue.type)},_getStateContainer:function(e){var t=e.fieldValue.target.id,n=this._normalizeEntityType(e.field),a="tau-entity-icon tau-entity-icon-follow tau-entity-color--"+n+" tau-entity-border--"+n;return i.createElement("div",null,this._getModificationDateBlock(e),i.createElement("div",{className:"follow-description notification__text"},i.createElement("span",null,"Changed State from ",e.oldFieldValue.state.name)," ",i.createElement("span",{className:"tau-icon-general tau-icon-l-arrow"})," ",i.createElement("span",{className:"follow-description__state"},e.fieldValue.state.name)," in"),i.createElement("div",{className:"notification__entity-wrap"},i.createElement("a",{href:"#",className:"notification__entity-link",onClick:this._openEntityView.bind(this,t,n)},i.createElement("em",{className:a},this._getEntityAbbreviation(n))," ",e.fieldValue.target.name)))},_getByBlock:function(e){return i.createElement("div",{className:"notification__information"},"by ",i.createElement("a",{href:"#",className:"gray-link",onClick:this._openEntityView.bind(this,e.author.iD,"user")},e.author.firstName+" "+e.author.lastName))},_getPersonBlock:function(e){return i.createElement("a",{className:"gray-link follow-description__person",href:"#",onClick:this._openEntityView.bind(this,e.author.iD,"user")},e.author.firstName+" "+e.author.lastName)
},_getModificationDateBlock:function(e){var t=s.parse(e.timestamp);return i.createElement("span",{className:"follow-description__date-time"},this._getModificationDateText(t))},_getModificationDateText:function(e){return s.sameDay(new Date,e)?s.formatAs(e,"HH:mm"):s.formatAs(e,"MMM dd")},_getAction:function(e){switch(e){case a.ChildAdded:return"added";case a.ChildRemoved:return"removed";case a.ChildUpdated:return"changed";default:return"set"}},_getAssignedAction:function(e){switch(e){case a.ChildAdded:return"Assigned";case a.ChildRemoved:return"Unassigned";default:return"Set"}},_openEntityView:function(e,t,i){i.preventDefault(),i.stopPropagation(),this._configurator.getEntityViewService().showEntityView({entityId:e,entityType:t})},_getFieldName:function(e){return t.titleize(t.underscored(e.field).replace(/_/g," "))},_normalizeEntityType:function(e){return e.replace("Tp.BusinessObjects.","").toLowerCase()},_getEntityAbbreviation:function(e){return l.getTerms(e).iconSmall}})}),define("jsx!tau/components/follow.activity/dashboard.widget.follow.activity",["require","react","jsx!tau/components/dashboard/infinity.scroll.list","jsx!./template.helper","jsx!tau/components/dashboard/widget.templates/shared/status.view"],function(e){var t=e("react"),i=e("jsx!tau/components/dashboard/infinity.scroll.list"),n=e("jsx!./template.helper"),a=e("jsx!tau/components/dashboard/widget.templates/shared/status.view");return t.createClass({componentWillMount:function(){this._templateHelper=new n(this.props.configurator)},componentWillReceiveProps:function(e){e.acid&&this.refs.list.reset()},_loadMoreModifications:function(e,t){var i={userId:this.props.configurator.getLoggedUser().id,to:this._getFirstLoadDate(),skip:(e-1)*t,take:t};return this.props.service.loadModifications(this.props.acid,i)},_loadNewModifications:function(){var e={userId:this.props.configurator.getLoggedUser().id,from:this._getFirstModificationDate()};return this.props.service.loadModifications(this.props.acid,e)},_getFirstLoadDate:function(){return this._firstLoadDate||(this._firstLoadDate=new Date),this._firstLoadDate
},_getFirstModificationDate:function(){var e=this.refs.list.state.items;return e.length>0?e[0].timestamp:this._getFirstLoadDate()},_createModificationItem:function(e,t,i){var n=t>0&&e.general.id===i[t-1].general.id;return this._templateHelper.getTemplate(e,n)},_getEmptyMessage:function(){return t.createElement(a,{textClassName:"tau-dashboard-widget-placeholder-text--follow"},t.createElement("span",null,"There is nothing to show. ",t.createElement("a",{href:"https://guide.targetprocess.com/working-with-entities/follow-entity.html",target:"_blank"},"Follow")," an entity to see changes!"))},render:function(){return t.createElement(i,{ref:"list",className:"notification__body",pageSize:100,pageLimit:100,loadMore:this._loadMoreModifications,loadNew:this._loadNewModifications,loadNewInterval:600,renderItem:this._createModificationItem,autoRefresh:!0,emptyMessage:this._getEmptyMessage()})}})}),define("tau/components/follow.activity/dashboard.widget.follow.activity.service",["require","jQuery","tau/core/class","tp/plugins/commandGateway","tau/store/header"],function(e){var t=e("jQuery"),i=e("tau/core/class"),n=e("tp/plugins/commandGateway"),a=new n({pluginName:"Following"}),r=e("tau/store/header");return i.extend({init:function(e){this._configurator=e},loadModifications:function(e,i){var n=t.Deferred(),s=function(){n.reject()},o=this._configurator.getApplicationPath()+"/GetUserFollowedEntities?&acid="+e;return t.ajax({type:"POST",url:o,dataType:"json"}).done(function(e){return e.length?(i.generals=e,void a.executeForSpecificProfile("FollowingProfile","GetModifications",i,function(e){var t=r.formatObject(e);n.resolve(t.data)},s,s)):void n.resolve([])}.bind(this)).fail(s),n}})}),define("tau/components/dashboard/widget.templates/dashboard.widget.follow.activity.template",["require","jQuery","Underscore","libs/react/react-ex","jsx!tau/components/follow.activity/dashboard.widget.follow.activity","tau/components/follow.activity/dashboard.widget.follow.activity.service"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("libs/react/react-ex"),a=e("jsx!tau/components/follow.activity/dashboard.widget.follow.activity"),r=e("tau/components/follow.activity/dashboard.widget.follow.activity.service");
return function(e){return{id:"follow_activity",name:"Follow Activity",previewSrc:"../img/widgets/general-follow.png",description:"Notifications about the entities you follow",tags:["Lists"],insert:function(s,o,l){t(s).closest(".tau-dashboard-widget").addClass("tau-dashboard-widget--follow"),o=i.extend({configurator:e,service:new r(e),acid:l.context.acid},o);var c=n.renderClass(a,o,s);return{updateContext:function(e){c.setProps({acid:e.acid})},destroy:function(){n.unmountComponentAtNode(s)}}}}}}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts",[],function(){var e=[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"effort_total",alignment:"base"},{id:"time_spent_remain",alignment:"base"},{id:"dependencies",alignment:"base"},{id:"cycle_time",alignment:"base"},{id:"state_short",alignment:"alt"}]];return{epic:e,feature:e,userstory:e,task:e,bug:[[{id:"general_entity_id",alignment:"base"},{id:"project_abbr",alignment:"alt"},{id:"severity_icon",alignment:"alt"},{id:"tags_long",alignment:"base"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"effort_total",alignment:"base"},{id:"time_spent_remain",alignment:"base"},{id:"dependencies",alignment:"base"},{id:"cycle_time",alignment:"base"},{id:"state_short",alignment:"alt"}]],request:[[{id:"general_entity_id",alignment:"base"},{id:"tags_long",alignment:"base"},{id:"project_abbr",alignment:"alt"}],[{id:"entity_name_small_sizes",alignment:"base"}],[{id:"effort_total",alignment:"base"},{id:"time_spent_remain",alignment:"base"},{id:"dependencies",alignment:"base"},{id:"state_short",alignment:"alt"}]]}}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.model",["require","Underscore","jQuery","tau/core/class","tau/models/board.plus/model.board.slice.extender","tau/services/customize/service.customize.card.layout.factory","tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts","tau/models/board.customize.units/const.card.sizes","tau/utils/utils.date"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),a=e("tau/models/board.plus/model.board.slice.extender"),r=e("tau/services/customize/service.customize.card.layout.factory"),s=e("tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts"),o=e("tau/models/board.customize.units/const.card.sizes"),l=e("tau/utils/utils.date"),c=6,d=o.zoomToSize(c);
return n.extend({SHOW_MAX_CARDS:100,CARD_SETTINGS:null,LAYOUTS:null,cardsRetrieving:null,cardsRetrieved:null,_acid:null,_configurator:null,_entityTypes:t.keys(s),_cometSubscription:null,init:function(e,i,n){this._configurator=i,this._updateSettings(n),this._cards=[],this.cardsRetrieving=t.Callbacks(),this.cardsRetrieved=t.Callbacks();var a=this.CARD_SETTINGS=t.reduce(s,function(e,t,i){return e[i]={},e[i][d]=t,e},{}),o=new r(this._configurator);this.LAYOUTS=t.reduce(a,function(e,t,i){return e[i]=o.getLayout(a,i,d),e},{}),this.updateContext(e)},updateContext:function(e){this._acid=e.acid,this._createSliceAndLoadToDoList()},update:function(e){this._updateSettings(e),this._createSliceAndLoadToDoList()},getCardDataByEntityId:function(e){var i=t.findWhere(this._cards,{id:e});return i?i.data:null},_updateSettings:function(e){this._entityTypes=e.entities,this._highlight=e.highlight},_createSliceAndLoadToDoList:function(){this.cardsRetrieving.fire(),this._stopCometListener(),i.when(this._createSlice()).then(function(){this._startCometListener(),this._loadToDoList()}.bind(this))},_loadToDoList:function(){i.when(this.slice.list({$skip:0,$take:this.SHOW_MAX_CARDS+1})).then(function(e){var t=e.data.items,i=t.length>0?t[0].dynamic:{};return this._loadAdditionalCardData(i.items||[])}.bind(this)).then(this._storeLoadedCards.bind(this))},_loadAdditionalCardData:function(e){if(!e.length)return e;var i=t.map(e,function(e){return e.data.cardData.id});return this._configurator.getStore().getDef("assignable",{fields:["id","lastStateChangeDate"],$query:{id:{$in:i}}}).then(function(i){return t.each(e,function(e){var n=t.findWhere(i,{id:e.data.cardData.id});e.lastStateChangeDate=n&&n.lastStateChangeDate?l.parseTimestampToDate(n.lastStateChangeDate):null})})},_storeLoadedCards:function(e){this._cards=e.slice(0,this.SHOW_MAX_CARDS),this.cardsRetrieved.fire({cards:this._cards,hasMore:e.length>this.SHOW_MAX_CARDS,layouts:this.LAYOUTS,highlight:this._highlight})},_createSlice:function(){var e=this._configurator.getSliceFactory().create(this._createSliceParameters()),t=new a;
return t.extend({slice:e},this._createLayoutFactory()).then(function(e){return this.slice=e.slice,this.slice}.bind(this))},_createSliceParameters:function(){var e={definition:this._createDefinition()};return e.definition.global={acid:this._acid},e},_createLayoutFactory:function(){var e=this._createDefinition(),t={get:function(){return i.Deferred().resolve(e)}};return new r(this._configurator,t)},_startCometListener:function(){var e=this.slice.getCometParameters();this._stopCometListener(),this._cometSubscription=this._configurator.getComet().subscribe("slice",{parameters:e,batchCallback:function(){this._loadToDoList()}.bind(this)})},_stopCometListener:function(){this._cometSubscription&&(this._cometSubscription.stop(),this._cometSubscription=null)},_createDefinition:function(){return{cells:{filter:"? Responsible is Me and AssignedUser.Contains(Me) and EntityState.IsFinal is False",ordering:{name:"Rank",direction:"Desc"},types:this._entityTypes,useFilter:!0},cardSettings:this.CARD_SETTINGS,zoomLevel:c}},destroy:function(){this._stopCometListener()}})}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.constants",[],function(){return{HIGHLIGHT_COLOR:"#f9d9d1",NO_STATE_CHANGE_DAYS:5}}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.open.card.view.mixin",["require","jQuery"],function(e){var t=e("jQuery"),i=".todo_list_open_card_view_mixin";return{componentDidMount:function(){t(this.getDOMNode()).parent().on("click"+i,".tau-id",function(e){var i=t(e.target);this.props.openEntityView({entityId:i.data("entityId"),entityType:i.data("entityType")}),e.preventDefault()}.bind(this))},componentWillUnmount:function(){t(this.getDOMNode()).parent().off(i)}}}),define("jsx!tau/components/dashboard/widget.templates/todo.list/todo.widget.unit.interaction.mixin",["require","jQuery","Underscore"],function(e){var t=e("jQuery"),i=e("Underscore"),n=".todo-widget-unit-interaction-mixin";return{componentDidMount:function(){this._getWidgetContainer().on("click"+n,".tau-board-unit--editable",this._onUnitClick)
},componentWillUnmount:function(){this._getWidgetContainer().off(n)},_getWidgetContainer:function(){return t(this.getDOMNode()).closest(".i-role-dashboard-widget-content")},_onUnitClick:function(e){if(i.isFunction(this.props.handleUnitInteraction)){var n=t(e.currentTarget),a=n.closest(".i-role-card");this.props.handleUnitInteraction({$unit:n,$card:a,cardId:a.data("id").toString(),unitId:n.data("unit-id").toString()}),e.stopPropagation()}}}}),define("jsx!tau/components/dashboard/widget.templates/todo.list/todo.widget.view",["require","Underscore","react","./todo.widget.constants","./todo.widget.open.card.view.mixin","jsx!../shared/status.view","jsx!./todo.widget.unit.interaction.mixin"],function(e){var t=e("Underscore"),i=e("react"),n=e("./todo.widget.constants"),a=e("./todo.widget.open.card.view.mixin"),r=e("jsx!../shared/status.view"),s=e("jsx!./todo.widget.unit.interaction.mixin");return i.createClass({displayName:"ToDo Widget",mixins:[a,s],getInitialState:function(){return{isLoaded:!1,hasMore:!1,cards:[]}},componentWillMount:function(){this.props.cardsRetrieving.on(this._onCardsRetrieving,this),this.props.cardsRetrieved.on(this._onCardsRetrieved,this)},componentWillUnmount:function(){this.props.cardsRetrieving.remove(this),this.props.cardsRetrieved.remove(this)},_onCardsRetrieving:function(){this.isMounted()&&this.setState({isLoaded:!1})},_onCardsRetrieved:function(e){this.isMounted()&&this.setState({isLoaded:!0,cards:e.cards,hasMore:e.hasMore,layouts:e.layouts,highlight:e.highlight})},_hasMoreMessage:function(){return this.state.hasMore?i.createElement("div",{className:"empty-message"},"Only the first ",this.state.cards.length," cards are shown"):null},_getStylesForItem:function(e){return this.props.highlighter.shouldHighlightCard(e,this.state.highlight)?{backgroundColor:n.HIGHLIGHT_COLOR}:{}},render:function(){if(!this.state.isLoaded)return i.createElement("div",{className:"tau-dashboard-widget-placeholder tau-loading--centered"});var e=t.map(this.state.cards,function(e){var t=this.props.renderCardAsText(e,this.state.layouts[e.type.toLowerCase()]);
return i.createElement("div",{key:e.data.cardData.id,className:"tau-dashboard-widget-todo-list__item",dangerouslySetInnerHTML:{__html:t},style:this._getStylesForItem(e)})}.bind(this),this);return e.length?i.createElement("div",{className:"tau-dashboard-widget-todo-list"},e,this._hasMoreMessage()):i.createElement(r,{containerClassName:"tau-dashboard-widget-placeholder--success",textClassName:"tau-dashboard-widget-placeholder-text--success"},i.createElement("span",null,"You have no assigned work. Get some rest!"))}})}),define("jsx!tau/components/dashboard/widget.templates/todo.list/todo.widget.settings",["require","Underscore","react","tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts","./todo.widget.constants"],function(e){var t=e("Underscore"),i=e("react"),n=e("tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts"),a=e("./todo.widget.constants"),r=i.createClass({displayName:"HighlightSettingsItem",render:function(){return i.createElement("li",{className:"tau-widget-settings-highlight-cards__item"},i.createElement("label",{className:"tau-checkbox"},i.createElement("input",{type:"checkbox",defaultChecked:this.props.defaultChecked,onChange:this.props.onChange}),i.createElement("i",{className:"tau-checkbox__icon"}),this.props.children,i.createElement("i",{style:{backgroundColor:a.HIGHLIGHT_COLOR},className:"tau-icon tau-icon_type_color"})))}});return i.createClass({getInitialState:function(){return{entities:this.props.initialEntities,highlight:this.props.initialHighlight}},componentDidMount:function(){$(this.getDOMNode()).find(".i-role-no-state-changes-days").editableText({mask:/^\d*$/,className:"none",classNameActive:"none",restoreText:!1})},componentWillUnmount:function(){$(this.getDOMNode()).find(".i-role-no-state-changes-days").editableText("destroy")},_getEntityTerm:function(e){return this.props.termProcessor.getTerms(e).names},_getEntityItem:function(e){var n=t.contains(this.state.entities,e);return i.createElement("li",{className:"tau-widget-settings-show-cards__item",key:e},i.createElement("label",{className:"tau-checkbox tau-checkbox--entity tau-checkbox--entity--"+e},i.createElement("input",{type:"checkbox",value:e,defaultChecked:n,onChange:this._onEntityCheckedChange}),i.createElement("i",{className:"tau-checkbox__icon"}),i.createElement("span",null,this._getEntityTerm(e))))
},_onEntityCheckedChange:function(e){var i=this.state.entities,n=e.target.getAttribute("value");e.target.checked?i.push(n):i=t.filter(i,function(e){return e!==n}),this.setState({entities:i})},_onHighlightBlockersChange:function(e){var t=this.state.highlight;t.blockers=e.target.checked,this.setState({highlight:t})},_onHighlightNoChangeStatesChange:function(e){var t=this.state.highlight;t.noStateChanges=e.target.checked,this.setState({highlight:t})},_onHighlightNoChangeStatesDaysChange:function(e){var t=this.state.highlight;t.noStateChangesDays=e.target.value,this.setState({highlight:t})},render:function(){var e=t.keys(n),a=t.map(e,this._getEntityItem);return i.createElement("div",{className:"tau-widget-settings__content-cards"},i.createElement("ul",{className:"tau-widget-settings-show-cards"},i.createElement("li",{className:"tau-widget-settings-show-cards__item tau-widget-settings-cards-title"},"Show cards"),a),i.createElement("ul",{className:"tau-widget-settings-highlight-cards"},i.createElement("li",{className:"tau-widget-settings-highlight-cards__item tau-widget-settings-cards-title"},"Highlight cards"),i.createElement(r,{defaultChecked:this.state.highlight.blockers,onChange:this._onHighlightBlockersChange},i.createElement("span",null,"Top priority and blockers")),i.createElement(r,{defaultChecked:this.state.highlight.noStateChanges,onChange:this._onHighlightNoChangeStatesChange},i.createElement("span",null,"No state changes in",i.createElement("input",{disabled:this.state.highlight.noStateChanges?"":"disabled",value:this.state.highlight.noStateChangesDays,className:"i-role-no-state-changes-days tau-in-text",type:"text",onChange:this._onHighlightNoChangeStatesDaysChange}),"days"))))}})}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.highlighter",["require","Underscore","jQuery","tau/core/class"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),a=["userstory","bug","request"],r=["userstory","bug","task","request"];return n.extend({init:function(e){this._store=e
},initialize:function(){return this._loadTopPriorities()},_loadTopPriorities:function(){return i.when(this._store.getDef("priority",{fields:["importance",{entityType:["name"]}]}),this._store.getDef("severity",{fields:["importance"]})).then(function(e,i){this._topPriorities={userstory:this._getTopPriorityForEntity(e,"userstory"),request:this._getTopPriorityForEntity(e,"request"),bug:t.min(i,t.property("importance"))}}.bind(this))},_getTopPriorityForEntity:function(e,i){return t.min(t.filter(e,function(e){return e.entityType.name.toLowerCase()===i}),t.property("importance"))},shouldHighlightCard:function(e,i){var n=e.type.toLowerCase();if(i.blockers&&t.contains(a,n)){var s;if("userstory"===n||"request"===n?s=e.data.cardData.importance:"bug"===n&&(s=e.data.severity_icon.severity.importance),s===this._topPriorities[n].importance)return!0}if(i.noStateChanges&&t.contains(r,n)&&e.lastStateChangeDate){var o=Math.floor((t.now()-e.lastStateChangeDate.getTime())/864e5);if(o>=i.noStateChangesDays)return!0}return!1}})}),define("tau/components/dashboard/widget.templates/todo.list/todo.widget.template",["require","Underscore","libs/react/react-ex","./todo.widget.model","jsx!./todo.widget.view","jsx!./todo.widget.settings","./todo.widget.constants","tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts","tau/core/termProcessor","tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized","./todo.widget.highlighter","tau/core/bus"],function(e){var t=e("Underscore"),i=e("libs/react/react-ex"),n=e("./todo.widget.model"),a=e("jsx!./todo.widget.view"),r=e("jsx!./todo.widget.settings"),s=e("./todo.widget.constants"),o=e("tau/components/dashboard/widget.templates/todo.list/todo.widget.entity.layouts"),l=e("tau/core/termProcessor"),c=e("tau/ui/templates/board.plus/customized/ui.template.boardplus.default.card.customized"),d=e("./todo.widget.highlighter"),u=e("tau/core/bus"),p=new u,g=function(e){return{id:g.TEMPLATE_ID,name:"ToDo List",previewSrc:"../img/widgets/todo-list.png",description:"All open work assigned to you",tags:["Lists"],insert:function(t,r,s){var o=new n(s.context,e,r),l=new d(e.getStore());
return l.initialize().then(function(){return i.render(i.createElement(a,{highlighter:l,cardsRetrieving:o.cardsRetrieving,cardsRetrieved:o.cardsRetrieved,renderCardAsText:function(t,i){return c.renderToString({dataItem:t,layout:i,configurator:e})},openEntityView:function(t){e.getEntityViewService().showEntityView(t)},handleUnitInteraction:function(t){var i=e.getUnitsRegistry().getUnitById(t.unitId);if(!i)return void console.error('Unknown unit "'+t.unitId+'". Unable to handle the interaction.');var n=o.getCardDataByEntityId(t.cardId);if(!n)return void console.error('Unable to find card with id "'+t.cardId+'" for unit interaction');var a=n[t.unitId];if(a||console.warn('Card data for unit "'+t.unitId+'" does not exist'),i.interactionConfig&&i.interactionConfig.handler){var r={cardDataForUnit:a,unit:i,$unit:t.$unit,$card:t.$card},s={configurator:e,hostBus:p};i.interactionConfig.handler(r,s)}}}),t),{update:function(e){o.update(e)},updateContext:o.updateContext.bind(o),destroy:function(){o.destroy(),i.unmountComponentAtNode(t)}}})},insertSettings:function(n,a,o){return e.getApplicationContextService().getApplicationContext({acid:o.context.acid}).then(function(e){var o=t.find(e.processes,t.property("isDefault")),c=o||e.processes[0],d=new l(c.terms),u=i.renderClass(r,{termProcessor:d,initialEntities:a.entities,initialHighlight:a.highlight},n);return function(){return{entities:u.state.entities,highlight:{blockers:u.state.highlight.blockers,noStateChanges:u.state.highlight.noStateChanges,noStateChangesDays:u.state.highlight.noStateChangesDays||s.NO_STATE_CHANGE_DAYS}}}})},defaultSettings:{entities:t.keys(o),highlight:{blockers:!1,noStateChanges:!1,noStateChangesDays:s.NO_STATE_CHANGE_DAYS}}}};return g.TEMPLATE_ID="todo_list",g}),define("tau/components/dashboard/widget.templates/burn.down.chart.widget",["jQuery","react","tau/components/component.burn.down.report","tau/components/component.burn.down.filter","jsx!tau/components/dashboard/widget.templates/shared/status.view"],function(e,t,i,n,a){return function(r){return{id:"burnDownChart",name:"Burn Down Chart",previewSrc:"../img/widgets/reports-burndown.png",description:"The Burn Down chart is a graphical representation of work left to do versus time",tags:["Reports"],insert:function(n,s){var o={context:{configurator:r},placeholder:n,name:"burnDownChart",template:["<div></div>"],defaultSettings:s,axes:{x:{labelSlope:"slope"}},emptyTemplate:a.renderToDOM({containerClassName:"tau-dashboard-widget-placeholder--burn-down-chart"},["Not enough data to build this beautiful chart",t.createElement("br",null),"Add Release or Iteration and complete some user stories"]),loaderTemplate:'<div class="tau-dashboard-widget-placeholder tau-loading--centered" />'},l=i.create(o);
return l.fire("initialize",o),l.fire("settings.changed",s),{update:function(e){l.fire("settings.changed",e)},updateContext:function(e){l.fire("acid.changed",e.acid)},resize:function(){l.fire("resize",{width:e(n).width()})}}},insertSettings:function(t,i){var a={settings:i,findPlannableFilter:function(e){e(this.settings)},savePlannableFilter:function(e){this.settings=e}},s=e(t),o={context:{configurator:r},name:"burnDownChartFilter",template:["<div></div>"],storage:a};s.addClass("tau-widget-settings--burn-down");var l=n.create(o),c=e.Deferred(),d=e.Deferred(),u=e.Deferred();return l.on("afterRender",function(e,t){d.resolve(t.element)}),l.on("filter.afterRender",function(){u.resolve()}),e.when(d,u).then(function(e){s.append(e),c.resolve(function(){return a.settings})}),l.fire("initialize",o),c}}}}),define("jsx!tau/components/dashboard/widget.templates/tableau.report/tableau.report.renderer",["require","jQuery","tau/core/class"],function(e){function t(){var t=i.Deferred();return e(["libs/tableau/tableau"],function(){t.resolve(window.tableauSoftware)}),t.promise()}var i=e("jQuery"),n=e("tau/core/class");return n.extend({init:function(e){var t=e.placeholder,i=e.reportUrl;this._placeholder=t,this._reportUrl=i},render:function(){return t().then(this._renderWith.bind(this))},_renderWith:function(e){var t=document.createElement("div");t.style.width=this._placeholder.clientWidth+"px",t.style.height=this._placeholder.clientHeight+"px",i(this._placeholder).empty().append(t);var n=i.Deferred();try{var a,r={width:this._placeholder.clientWidth,height:this._placeholder.clientHeight,hideTabs:!0,hideToolbar:!0,onFirstInteractive:function(){n.resolve({resize:function(){return a.setFrameSize(this._placeholder.clientWidth,this._placeholder.clientHeight)}.bind(this),destroy:a.dispose.bind(a)})}.bind(this)};a=new e.Viz(t,this._reportUrl,r)}catch(s){n.reject(s)}return n}})}),define("tau/components/dashboard/widget.templates/tableau.report/tableau.report.url",["require"],function(){var e=/https?:\/\/.+\/views\/.+/,t=/views\/(.+)\//;
return{isValidReportUrl:function(t){return e.test(t)},reportUrlExample:"http://your.server/views/Workbook/Report",extractReportNameFromUrl:function(e){var i=e.match(t);return i?i[1]:null}}}),define("jsx!tau/components/dashboard/widget.templates/tableau.report/tableau.report.settings.url.editor",["require","react","./tableau.report.url"],function(e){var t=e("react"),i=e("./tableau.report.url");return t.createClass({displayName:"tableau.report.settings.url.editor",propTypes:{initialReportUrl:t.PropTypes.string,onChange:t.PropTypes.func,onEnterKey:t.PropTypes.func},getInitialState:function(){return{reportUrl:this.props.initialReportUrl}},getCurrentReportUrl:function(){return this.state.reportUrl},_onUrlInputChange:function(e){var t=e.target.value;this.setState({reportUrl:t}),this.props.onChange&&this.props.onChange(t)},_onUrlInputKeyDown:function(e){e.which===$.ui.keyCode.ENTER&&this.props.onEnterKey&&this.props.onEnterKey()},render:function(){return t.createElement("div",null,t.createElement("input",{className:"tau-tableau-report-widget-settings__url-editor tau-in-text tau-x-large",type:"url",placeholder:"e.g. "+i.reportUrlExample,value:this.state.reportUrl,onChange:this._onUrlInputChange,onKeyDown:this._onUrlInputKeyDown}),t.createElement("span",{className:"tau-help i-role-tooltipArticle","data-article-id":"tableau.report.widget.url"}))}})}),define("jsx!tau/components/dashboard/widget.templates/tableau.report/tableau.report.selector.view",["require","jQuery","react","jsx!../shared/settings.list.item.view","jsx!../shared/settings.container.view","jsx!./tableau.report.settings.url.editor","./tableau.report.url"],function(e){var t=(e("jQuery"),e("react")),i=e("jsx!../shared/settings.list.item.view"),n=e("jsx!../shared/settings.container.view"),a=e("jsx!./tableau.report.settings.url.editor"),r=e("./tableau.report.url");return t.createClass({displayName:"tableau.report.selector",propTypes:{onApply:t.PropTypes.func.isRequired},getDefaultProps:function(){return{labelText:"Please specify a link to the Tableau report you'd like to display here"}
},getInitialState:function(){return{reportUrl:""}},_onUrlInputChange:function(e){this.setState({reportUrl:e})},_applyUrl:function(){this._isValidUrl()&&this.props.onApply(this.state.reportUrl)},_isValidUrl:function(){return r.isValidReportUrl(this.state.reportUrl)},render:function(){return t.createElement(n,null,t.createElement(i,{title:"Please specify a link to the Tableau report you'd like to display here"},t.createElement(a,{onChange:this._onUrlInputChange,onEnterKey:this._applyUrl})),this._renderApplyButton())},_renderApplyButton:function(){return t.createElement("button",{className:"tau-btn tau-primary",onClick:this._applyUrl,disabled:!this._isValidUrl()},"Show this report")}})}),define("jsx!tau/components/dashboard/widget.templates/tableau.report/tableau.report.settings.view",["require","react","jsx!../shared/settings.list.item.view","jsx!../shared/settings.container.view","jsx!./tableau.report.settings.url.editor"],function(e){var t=e("react"),i=e("jsx!../shared/settings.list.item.view"),n=e("jsx!../shared/settings.container.view"),a=e("jsx!./tableau.report.settings.url.editor");return t.createClass({displayName:"tableau.report.settings.view",propTypes:{initialReportUrl:t.PropTypes.string},getCurrentSettings:function(){return{reportUrl:this.refs.urlEditor.getCurrentReportUrl()}},render:function(){return t.createElement(n,null,t.createElement(i,{title:"Link to the Tableau report"},t.createElement(a,{ref:"urlEditor",initialReportUrl:this.props.initialReportUrl})))}})}),define("tau/components/dashboard/widget.templates/tableau.report/tableau.report.template",["require","jQuery","react","jsx!./tableau.report.renderer","jsx!./tableau.report.selector.view","jsx!./tableau.report.settings.view","jsx!../shared/error.view","./tableau.report.url"],function(e){var t=e("jQuery"),i=e("react"),n=e("jsx!./tableau.report.renderer"),a=e("jsx!./tableau.report.selector.view"),r=e("jsx!./tableau.report.settings.view"),s=e("jsx!../shared/error.view"),o=e("./tableau.report.url");return{id:"tableau.report.embedded",name:"Tableau report",description:"Display Tableau reports and dashboards in Targetprocess",tags:["Beta","Reports"],previewSrc:"../img/widgets/reports-tableau.png",layout:{aspectRatio:1.6},defaultSettings:{reportUrl:""},insert:function(e,i,a){if(!this._canInsertReport(i))return this._insertReportSelector(e,a);
var r=t.Deferred(),s={placeholder:e,reportUrl:i.reportUrl};return new n(s).render().done(r.resolve.bind(r)).fail(function(t){r.resolve(this._insertErrorView(e,t))}.bind(this)),r.promise()},_canInsertReport:function(e){return o.isValidReportUrl(e.reportUrl)},_insertReportSelector:function(e,t){var n={onApply:function(e){var i=o.extractReportNameFromUrl(e),n=i?{name:i}:null;t.widgetApi.internalModifyDefinition({reportUrl:e},n)}.bind(this)};i.render(i.createElement(a,n),e)},_insertErrorView:function(e,t){var n={header:"Oops, seems that we can't render this report",message:"Please verify that the report URL is correct or let us know about this issue",technicalDetails:t};return i.render(i.createElement(s,n),e)},insertSettings:function(e,t){var n={initialReportUrl:t.reportUrl},a=i.render(i.createElement(r,n),e);return a.getCurrentSettings}}}),define("jsx!tau/components/dashboard/widget.templates/sample.widget",["require","Underscore","libs/react/react-ex","jsx!./shared/settings.container.view","jsx!./shared/settings.list.item.view"],function(e){function t(){var e="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a diam lectus. Sed sit amet ipsum mauris. Maecenas congue ligula ac quam viverra nec consectetur ante hendrerit. Donec et mollis dolor. Praesent et diam eget libero egestas mattis sit amet vitae augue. Nam tincidunt congue enim, ut porta lorem lacinia consectetur. Donec ut libero sed arcu vehicula ultricies a non tortor. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean ut gravida lorem. Ut turpis felis, pulvinar a semper sed, adipiscing id dolor. Pellentesque auctor nisi id magna consequat sagittis. Curabitur dapibus enim sit amet elit pharetra tincidunt feugiat nisl imperdiet. Ut convallis libero in urna ultrices accumsan. Donec sed odio eros. Donec viverra mi quis quam pulvinar at malesuada arcu rhoncus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In rutrum accumsan ultricies. Mauris vitae nisi at sem facilisis semper ac in est.",t=e.split(" ");
return i.take(t,i.random(5,t.length-1)).join(" ")}var i=e("Underscore"),n=e("libs/react/react-ex"),a=e("jsx!./shared/settings.container.view"),r=e("jsx!./shared/settings.list.item.view"),s=n.createClass({displayName:"Widget",render:function(){return n.createElement("div",{className:"i-role-dashboard-sample-widget",style:{backgroundColor:this.props.color,padding:"20px",height:"100%"}},this.props.content)}}),o=n.createClass({displayName:"WidgetSettings",mixins:[n.addons.LinkedStateMixin],getInitialState:function(){return{content:this.props.content,color:this.props.color}},render:function(){return n.createElement(a,{labelsOnTop:!1},n.createElement(r,{title:"Content"},n.createElement("input",{className:"i-role-dashboard-sample-widget-settings-content-input",type:"text",valueLink:this.linkState("content")})),n.createElement(r,{title:"Color"},n.createElement("input",{className:"i-role-dashboard-sample-widget-settings-content-color",type:"text",valueLink:this.linkState("color")})))}});return function(e){e=e||{};var a={id:e.id||"sample_widget",name:e.name||"Sample widget",description:e.description||"Widget placeholder",tags:["~debug","scrum","agile"],layout:{minHeight:e.minHeight,maxHeight:e.maxHeight,aspectRatio:e.aspectRatio},insert:function(t,i){var a=n.renderClass(s,i,t);return e.widgetInserted&&e.widgetInserted(a),{update:a.setProps.bind(a)}},insertSettings:function(t,i){var a=n.renderClass(o,i,t);return e.settingsInserted&&e.settingsInserted(a),function(){return a.state}}};return Object.defineProperty(a,"defaultSettings",{get:function(){var e=["#69D2E7","#A7DBD8","#6495ED","#E0E4CC","#F38630","#FA6900","#BFCAAA","#D0A28A","#C58B80","#CF4459","#791241"];return{color:e[i.random(e.length-1)],content:t()}},enumerable:!0}),a}}),define("tau/components/dashboard/widget.templates/sample.context.widget",["require","libs/react/react-ex"],function(e){var t=e("libs/react/react-ex"),i=t.DOM,n=t.createClass({render:function(){var e=this.props.applicationContext?"Current ACID is "+this.props.applicationContext:"Loading ACID...";
return i.div({},e)}});return function(){return{id:"sample_context_widget",name:"Sample context",description:"Sample context-aware widget",tags:["~debug"],insert:function(e,i,a){var r=t.renderClass(n,{applicationContext:a.context.acid},e);return{updateContext:function(e){r.setProps({applicationContext:e.acid})}}},insertSettings:function(e,i,a){return t.renderClass(n,{applicationContext:a.context.acid},e),function(){return{}}}}}}),define("tau/components/dashboard/widget.templates/sample.resize.widget",["require","libs/react/react-ex"],function(e){var t=e("libs/react/react-ex"),i=t.DOM,n=t.createClass({render:function(){var e="Placeholder size is "+this.props.width+"x"+this.props.height;return i.div({},e)}});return function(){return{id:"sample_resize_widget",name:"Sample resize",description:"Sample widget with resize callback",tags:["~debug"],insert:function(e){var i=function(){return{width:e.clientWidth,height:e.clientHeight}},a=t.renderClass(n,i(),e);return{resize:function(){a.setProps(i())}}}}}}),define("jsx!tau/components/dashboard/widget.templates/sample.async.widget",["require","jQuery","Underscore","libs/react/react-ex"],function(e){var t=e("jQuery"),i=e("Underscore"),n=e("libs/react/react-ex"),a=n.DOM,r=3e3,s=1e3,o=n.createClass({displayName:"Widget",render:function(){var e="I am finally loaded after "+this.props.delay+"ms delay";return a.div({},e)}}),l=n.createClass({displayName:"WidgetSettings",mixins:[n.addons.LinkedStateMixin],getInitialState:function(){return{delay:this.props.initialDelay,settingsDelay:this.props.initialSettingsDelay}},render:function(){return n.createElement("ul",{className:"tau-widget-settings-list"},n.createElement("li",{className:"tau-widget-settings-list__item"},n.createElement("label",null,n.createElement("span",{className:"tau-widget-settings-list__title"},"Render delay"),n.createElement("input",{className:"i-role-dashboard-sample-widget-settings-content-input",type:"text",valueLink:this.linkState("delay")}))),n.createElement("li",{className:"tau-widget-settings-list__item"},n.createElement("label",null,n.createElement("span",{className:"tau-widget-settings-list__title"},"Settings delay"),n.createElement("input",{className:"i-role-dashboard-sample-widget-settings-content-input",type:"text",valueLink:this.linkState("settingsDelay")}))))
}});return function(){return{id:"sample_async_widget",name:"Sample async",description:"Sample asynchronously loaded widget",tags:["~debug"],defaultSettings:{delay:r,settingsDelay:s},insert:function(e,i){return t.when.timeout(i.delay).then(function(){return n.renderClass(o,i,e),{destroy:function(){n.unmountComponentAtNode(e),console.log("Async widget was destroyed")}}})},insertSettings:function(e,a){return t.when.timeout(a.settingsDelay).then(function(){var t=n.renderClass(l,{initialDelay:a.delay,initialSettingsDelay:a.settingsDelay},e);return function(){return i.pick(t.state,"delay","settingsDelay")}})}}}}),define("tau/components/dashboard/services/dashboard.widget.template.default.source",["require","tau/core/class","Underscore","jQuery","./dashboard.widget.template.default.source.lists","./dashboard.widget.template.default.source.reports","../widget.templates/dashboard.widget.latest.comments.template","../widget.templates/dashboard.widget.follow.activity.template","../widget.templates/todo.list/todo.widget.template","../widget.templates/new.list/linked/new.list.linked.widget.template","../widget.templates/custom.report/linked/custom.report.linked.template","../widget.templates/burn.down.chart.widget","../widget.templates/tableau.report/tableau.report.template","jsx!./../widget.templates/sample.widget","./../widget.templates/sample.context.widget","../widget.templates/sample.resize.widget","jsx!../widget.templates/sample.async.widget"],function(e){var t=e("tau/core/class"),i=e("Underscore"),n=e("jQuery"),a=e("./dashboard.widget.template.default.source.lists"),r=e("./dashboard.widget.template.default.source.reports"),s=e("../widget.templates/dashboard.widget.latest.comments.template"),o=e("../widget.templates/dashboard.widget.follow.activity.template"),l=e("../widget.templates/todo.list/todo.widget.template"),c=e("../widget.templates/new.list/linked/new.list.linked.widget.template"),d=e("../widget.templates/custom.report/linked/custom.report.linked.template"),u=e("../widget.templates/burn.down.chart.widget"),p=e("../widget.templates/tableau.report/tableau.report.template"),g=e("jsx!./../widget.templates/sample.widget"),m=e("./../widget.templates/sample.context.widget"),h=e("../widget.templates/sample.resize.widget"),f=e("jsx!../widget.templates/sample.async.widget"),y=[g(),g({id:"sample_widget_max_height",name:"Sample widget (max height)",maxHeight:250}),g({id:"sample_widget_aspect_ration",name:"Sample widget (aspect ratio)",aspectRatio:4/3})];
return t.extend({id:"default",init:function(e){this._configurator=e,this._featuresService=e.getFeaturesService()},getWidgetTemplates:function(){var e=this._getSampleWidgets();e.push(c(this._configurator)),e.push(s(this._configurator)),e.push(o(this._configurator)),e.push(l(this._configurator)),e=e.concat(a.getCustomListTemplates(this._configurator)),this._featuresService.isEnabled("customReports")&&(e.push(d(this._configurator)),e=e.concat(r.getCustomReportTemplates(this._configurator))),e.push(u(this._configurator)),e.push(p);var t=i.map(e,n.when);return n.Deferred().resolve(t)},_getSampleWidgets:function(){return this._featuresService.isEnabled("dashboard.sample.widgets")?i.toArray(y).concat(m(),h(),f()):[]}})}),define("tau/components/extensions/dashboard/extension.dashboard.widget.registry.builder",["require","tau/components/extensions/component.extension.base","tau/components/dashboard/services/dashboard.widget.template.default.source"],function(e){var t=e("tau/components/extensions/component.extension.base"),i=e("tau/components/dashboard/services/dashboard.widget.template.default.source");return t.extend({init:function(e){this._super(e);var t=e.context.configurator,n=t.getDashboardWidgetTemplateRegistry();n.addWidgetTemplateSource(new i(t))}})}),define("tau/app.resolver",["Underscore"],function(e){var t=function(t){var i=t.split("/");if(i.length<2)return null;var n=i[0],a=i[1],r=a.length,s=e.without([a.indexOf("&"),a.indexOf("||"),r],-1),o=e.min(s),l=a.substring(0,o);return{id:l,type:n}};return{resolvePageInfo:function(i,n,a){var r=i.configurator.getExternal(),s=r.getHashParam(i.appId,null),o=s||r.getHash(),l=t(o),c=l;return l||(c=n,e.isFunction(a)&&a.call(r,c)),c},getQueryParam:function(e,t){var i=e.indexOf(t+"=");if(-1===i)throw'Param "'+t+'" not found';i=i+t.length+1;var n=e.indexOf("&",i);n=-1!==n?n:e.length;var a=e.substring(i,n);return a}}}),define("main.boardplus.login",["Underscore","jQuery","tau/core/class","tau/app.resolver","tau/components/component.video-intro.popup"],function(e,t,i,n,a){return i.extend({init:function(e,t){this.configurator=e,this.applicationId=t
},process:function(){var e=this.configurator.getWindow(),t=!e.appIsInDebugMode&&e.tauUserInfo&&e.tauUserInfo.isFirstTimeTp3Login;return t?this.firstTimeLogin():this.notFirstTimeLogin()},notFirstTimeLogin:function(){var i=this.configurator.getHashService(),a=!i.getHash();if(a&&e.has(i.getHrefParsed().queryKey,"start"))this.setHash("start/start");else if(a&&e.has(i.getHrefParsed().queryKey,"invite"))this.setHash("invite");else{var r=this.applicationId;n.resolvePageInfo({appId:this.applicationId,configurator:this.configurator},{type:"board",id:"last"},function(e){this.setHashParam(r,e.type+"/"+e.id)})}return t.Deferred().resolve()},showCallAdminPopup:function(){var e=this.configurator.getGlobalBus();a.create({url:"//www.youtube.com/embed/Lxl2sTEyYaE",showNextButton:!1}),e.fire("contentRendered")},firstTimeLogin:function(){var e=this.configurator.getLoggedUser().isAdministrator,i=window.tauUserInfo&&window.tauUserInfo.Tp3Available,n=this._isSsoWelcomePage(),a=!0,r=t.Deferred();if(e?this.setHash("start/start"):i?n||this.setHash("invite"):i||(this.showCallAdminPopup(),a=!1),a)if(n)r.resolve();else{var s=this.configurator.getGlobalSettingsService();s.sendRequest("GlobalSettingsService","FirstTimeLoginTP3",null).done(r.resolve).fail(function(){throw new Error("First time login operation is failed")})}else r.reject();return r},_isSsoWelcomePage:function(){var e=this.configurator.getHashService();return"sso/welcome"==e.getHashParam("page")},setHash:function(e){this.configurator.getHashService().setHash(this.applicationId+"="+e)}})}),define("tau/configurations/adapters/sso.welcome.route.adapter",[],function(){var e=function(){var e=this.configurator.getLoggedUser().id,t=this.configurator.getBoardSettingsFactory().createComponentSettings({id:"user"});t.set({set:{generalTab:"accountSettings"},callback:function(){this.resolve({entity:{id:e,type:"user"},cssClass:"tau-app tau-page-single tau-page-entity i-role-bubble-holder",handlers:{onPageLoaded:function(){this.configurator.service("errorBar").fire("notification",{message:"We created a new TP user for you, but didn't have enough details. Please change “John Doe” to your real name."})
}.bind(this)}})}.bind(this)})};return e}),define("main.boardplus.routes",["require","jQuery","Underscore","app.path","tp/reports/service.chart.size","tau/services/boards/view.types","tau/components/board.menu/models/board.menu.section.collection","tau/configurations/adapters/sso.welcome.route.adapter"],function(e){function t(e,t){return e+"/"+t}function i(e,t){var i=a.Deferred(),n=null,r=!1,o={fields:["acid"],callback:function(i){n=i.acid,r=!1,taus.context({"@":"--app-context-core",host:s.get(),version:e.getSystemInfo().version,path:t,user:e.getLoggedUser(),acid:i.acid})}};return e.getAppStateStore().get({fields:o.fields,callback:function(e){o.callback(e),i.resolve()},skipCacheUpdate:!0}),e.getApplicationContextService().onApplicationContextRetrieved.add(function(e){e.acid!==n||r||(r=!0,taus.track("appContext",{"@":"--app-context-teams-projects",projects:e.selectedProjectIds,teams:e.selectedTeamIds}))},!0),i}function n(e,n){var a=this.configurator,r=a.getBoardDefinitionFactory();a.getRestStorage()._cache={};var s={id:t(e,n),type:e,args:n};r.getById(n).then(function(t){i(a,s),taus.track("views",{"@":"open-view-action",view:t}),this.resolve({id:t.key,entity:e})}.bind(this)).fail(function(){a.getRouting().redirect(a.getUrlBuilder().getDefaultViewUrl())})}var a=e("jQuery"),r=e("Underscore"),s=e("app.path"),o=e("tp/reports/service.chart.size"),l=e("tau/services/boards/view.types"),c=e("tau/components/board.menu/models/board.menu.section.collection"),d=e("tau/configurations/adapters/sso.welcome.route.adapter");return{createApplicationRoutes:function(){return[{pattern:/start/,host:{name:"board_startScreen_h",type:"board.startScreen"},type:{name:"board_startScreen",type:"board.startScreen"}},{name:"process-setup-workflow",pattern:/process-setup\/(\d+)\/workflows\/([a-z]+)/,adapter:function(e,t){this.resolve({processId:parseInt(e,10),optionGroupId:"workflows",entityType:t})},host:{name:"board_host",type:"master.board"},type:{name:"setup workflow",type:"setup.workflow"}},{name:"process-setup-terms",pattern:/process-setup\/(\d+)\/terms/,host:{name:"board_host",type:"master.board"},adapter:function(e){this.resolve({processId:parseInt(e,10),optionGroupId:"terms"})
},type:{name:"terms",type:"terms"}},{name:"process-setup-general",pattern:/process-setup\/(\d+)\/([a-z\-]+)/,adapter:function(e,t){this.resolve({processId:parseInt(e,10),optionGroupId:t})},host:{name:"board_host",type:"master.board"},type:{name:"setup process",type:"setup.process"}},{pattern:/invite/,adapter:function(){var e=this.configurator,t=e.getHelpScenarioService(),i=t.getAvailableFlows().scratch;t.setCurrentFlow(i.id),t.setState(t.stateTypes.ToBeStarted),e.getRouting().redirect(e.getUrlBuilder().getDefaultViewUrl())},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/\bcustomreport\/(\d+)/,adapter:r.partial(n,l.REPORT),host:{name:"board_host",type:"master.board"},type:{name:"customReport_page",type:"page.customReport"}},{pattern:/report\/(\d+)/,adapter:function(e){var t=this.configurator;t.registerService("chart.size",new o),this.resolve({id:e,entity:"report"})},host:{name:"board_host",type:"master.board"},type:{name:"report_page",type:"page.report"}},{pattern:/\bdashboard\/(\d+)/,adapter:r.partial(n,l.DASHBOARD),host:{name:"board_host",type:"master.board"},type:{name:"dashboard_page",type:"page.dashboard"}},{pattern:/\b(?:view|board)\/last/,adapter:function(){var e=this.configurator,i=e.getUrlBuilder(),n=a.Deferred(),r=null,s=e.getRouting().restoreReferer();if(s){var o=/(?:board|dashboard)\/(.+)/.exec(s)||[];r=o[1]}r?e.getViewApiService().getViewMenuItem(r).done(function(e){var a=e.data,r=a.itemType||"board",s=i.getRelativeBoardPageUrl(t(r,a.key),a.acid||void 0);n.resolve(s)}).fail(function(){n.resolve(i.getDefaultViewUrl())}):n.resolve(i.getDefaultViewUrl()),a.when(n).then(function(t){e.getRouting().redirect(t)})},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/\b(?:view|board)\/current/,adapter:function(){var e=this.configurator;e.getGlobalBus().fire("applicationStart");var i=e.getAppStateStore().settings.acid||void 0;e.getViewsMenuService().getViewsMenuForUser().then(function(t){var i=new c;
i.setSections(t);var n=i.findFirstVisibleViewData(),r=a.Deferred();return n?r.resolve(n):e.getBoardDefinitionFactory().createBoard().done(function(e){r.resolve(e)}),r}).then(function(n){var a=e.getUrlBuilder(),r=n.itemType||"board",s=a.getRelativeBoardPageUrl(t(r,n.key),n.acid||i);e.getRouting().redirect(s)})},host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/\bboard\/([^&]+)/,adapter:r.partial(n,l.BOARD),host:{name:"board_host",type:"master.board"},type:{name:"board_page",type:"page.board"}},{pattern:/finish-(\w+)\/(\d+)/,adapter:function(e,t){this.resolve({entity:{id:parseInt(t,10),type:e}})},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.finish-iteration"}},{pattern:/(\w+)\/(\d+)\b/,adapter:function(e,n){var a=this,r=this.configurator,s=taus.start("statistics_view",{"@":["--add-last-view-entity-context",function(e){var t="@timing";return e.loadTime=e[t],delete e[t],e}],entity:{id:n,type:e.toLowerCase()}}),o={id:t(e,n),type:e,args:n};i(r,o).then(function(){taus.track({"@":["--save-last-view-entity-context"],action:"view entity",name:"view "+e+" #"+n,tags:["view entity"],type:e,id:n})}).then(function(){a.resolve({entity:{id:parseInt(n,10),type:e},action:"show",cssClass:"tau-app tau-page-single tau-page-entity i-role-bubble-holder",handlers:{onPageLoaded:function(){s.stop()}}})})},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.entity",comet:{enabled:!0}}},{pattern:/(\w+)\/(\d+)\/(\w+).*/,adapter:function(e,t,i){this.resolve({entity:{id:parseInt(t,10),type:e},action:i,cssClass:"tau-app tau-page-single tau-page-entity i-role-bubble-holder"})},host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.entity"}},{pattern:/sso\/welcome/,adapter:d,host:{name:"board_host",type:"master.board"},type:{name:"entity component",type:"page.entity"}}]}}}),define("tp/mashups.loader",["jQuery","Underscore","tp/mashups","libs/parseUri"],function(e,t,i,n){var a=["beforeAppInit"],r={initDeferred:e.Deferred(),loadState:{},initPointsData:{},init:function(){this._setLoadStates(),this._overrideMashupsFunctions();
var e=n(location.href).hasQueryKey("nomashups");return e||require(["user/mashups"],function(){this._processRegisteredMashups(),this.initDeferred.resolve()}.bind(this)),this},_setLoadStates:function(){t.each(a,function(t){this.loadState[t]={status:e.Deferred()}},this)},_overrideMashupsFunctions:function(){this.originalFunctions={initializeMashupFolder:i.prototype.initializeMashupFolder},i.prototype.initializeMashupFolder=e.noop},_processRegisteredMashups:function(){var e=i.prototype.getRegisteredMashups();t.each(e,function(e){var t=e.options.initPoint;this.initPointsData[t]||(this.initPointsData[t]={initPoint:t,mashups:[]}),e.mashups.length&&this.initPointsData[t].mashups.push(e)},this)},loadMashups:function(e){this.initDeferred.done(this._loadMashups.bind(this,e))},_loadMashups:function(e){var t=this.initPointsData[e]||{},i=t.mashups||[];t.startTime=Date.now();var n=this._initializeMashups(i);n.done(this._toggleState.bind(this,e))},_initializeMashups:function(i){var n=e.Deferred(),a=i.length,r=[],s=function(){0===a&&n.resolve(r)};return s(),t.each(i,function(e){var t=Date.now();this.originalFunctions.initializeMashupFolder.call(e.ctx),e.initDeferred.done(function(){r.push(e)}),e.initDeferred.always(function(){a--,e.totalTime=Date.now()-t,s()})},this),n},_toggleState:function(e){var t=this.initPointsData[e]||{};this._updateTimingData(t),this._trackMashupsLoad(t),this.loadState[e].status.resolve()},_trackMashupsLoad:function(e){var i={"@":["--exclude-board-context"]},n=t.extend({},i,e);taus.track("mashups.load",n)},_updateTimingData:function(e){e.totalTime=Date.now()-e.startTime,delete e.startTime}};return r}),define("tracking/stores/store.testconsole",["tau/core/class","Underscore"],function(e){return e.extend({init:function(e){this.config=e||{},window.testconsole={posts:[]}},post:function(e){window.testconsole.posts.push(e)}})}),define("tracking/stores/store.console",["tau/core/class","Underscore"],function(e,t){return e.extend({init:function(e){this.config=e||{},t.defaults(this.config,{method:"log"})
},post:function(e){console[this.config.method](e)}})}),define("tracking/stores/store.tauspy",["jQuery","Underscore","app.path","libs/json2"],function(e,t,i){var n=!1,a=0;"withCredentials"in new XMLHttpRequest&&(n=!0);var r=[],s=function(e){this.config=t.defaults(e||{},{local:"taus"}),this.usePost=n,this.config.local&&(this.localUrl=i.get()+"/"+e.local,this.usePost=!0)};return s.prototype={encode:function(e){var t,i,n,a,r,s,o,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,u=0,p="",g=[];if(!e)return e;do t=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),l=t<<16|i<<8|n,a=l>>18&63,r=l>>12&63,s=l>>6&63,o=63&l,g[u++]=c.charAt(a)+c.charAt(r)+c.charAt(s)+c.charAt(o);while(d<e.length);p=g.join("");var m=e.length%3;return(m?p.slice(0,m-3):p)+"===".slice(m||3)},postViaImage:function(e){try{if(!e)return!1;var t="https:"===document.location.protocol;if(t&&!this.config.urlSSL)return!1;var i=this.encode(encodeURIComponent(JSON.stringify(e)));if(Image){var n=t?this.config.urlSSL:this.config.url;(new Image).src=n+"?f=b&d="+i}}catch(a){}return!0},queueItem:function(e){var i=this;t.isArray(e)?r=r.concat(e):r.push(e),clearTimeout(a);var n=function(){if(0!==r.length){var e=r.concat([]);r=[],i.usePost?i.postForm(e):i.postViaImage(e)}};r.length>(i.usePost?20:3)?n():a=setTimeout(n,1e3)},postForm:function(t){try{if(!t)return!1;var i=this.localUrl;if(!i){i=n?this.config.urlSSL:this.config.url;var n="https:"===document.location.protocol;if(n&&!this.config.urlSSL)return!1}e.ajax({type:"POST",url:i,dataType:"text",processData:!1,data:JSON.stringify(t),contentType:"application/json; charset=utf-8"})}catch(a){}return!0},post:function(e){this.queueItem(e)}},s}),define("tracking/stores/store.factory",["tracking/stores/store.testconsole","tracking/stores/store.console","tracking/stores/store.tauspy"],function(e,t,i){var n=function(){},a={testconsole:e,console:t,tauspy:i,empty:function(){this.init=n,this.post=n}};return{createTrackingStore:function(e,t){var i;if(t.api)t.api&&t.api.init&&(t.api.init(t.config),i=t.api);
else{var n=a.hasOwnProperty(e)?e:"empty";i=new a[n](t)}return{api:i}}}}),define("tracking/taus",["Underscore","tracking/stores/store.factory"],function(e,t){var i="action",n=function(i){this.sid=i.sid,this.globalBus=i.globalBus,this.debugMode=i.debugMode,this.stores=e.map(i.store,function(e,i){return t.createTrackingStore(i,e)});var n=i.adapters;this.adapters={get:function(t){return n[t]||e.identity}},this.getPostAdapters=i.getPostAdapters||function(e){return[e,"--global--"]},this.sync={},this.temp={},this.last={},this.adaptersScope={sid:this.sid}};return n.prototype={_getAdapterArr:function(t){return e.isArray(t)?t:e.isString(t)?[t]:[]},_isDuplicate:function(e,t){var i="--tmp-"+e,n=JSON.stringify(t),a=(new Date).getTime(),r=a-(this.last[i]||0);return this.temp[i]===n&&3e3>=r?!0:(this.temp[i]=n,this.last[i]=a,!1)},_post:function(t){if(e.isObject(t))for(var i=0;i<this.stores.length;i++)try{this.stores[i].api.post(t)}catch(n){}},_verifyThenPost:function(t,i){if(this._isDuplicate(t,i))return!1;var n={};return n[t]=e.extend({sid:this.sid,tick:(new Date).getTime()},i),this._post(n),!0},_adapt:function(t,i){var n=e.isFunction(i)?i:this.adapters.get(i);return n.call(this.adaptersScope,t)},_applyAdapters:function(t,i){var n="@",a=this._getAdapterArr(t[n]),r=e.omit(t,n),s=a.concat(i);return e.reduce(s,this._adapt.bind(this),r)},context:function(e){this._applyAdapters(e,[])},track:function(t,n){1===arguments.length&&(n=e.isString(t)?{name:t}:t,t=i);try{var a=this._applyAdapters(n,this.getPostAdapters(t));this._verifyThenPost(t,a)}catch(r){this.debugMode&&"undefined"!=typeof console&&console.log(r)}},error:function(e){this.track("error",e)},start:function(){var t,n;if(e.isFunction(arguments[0])){var a=arguments[0]();t=a.tick,n=a.args}else t=+new Date,n=[].slice.call(arguments);var r,s,o;if(3===n.length)r=n[0],s=n[1],o=n[2];else if(2===n.length){var l=e.isObject(n[0]);r=l?i:n[0],s=l?n[0]:n[1],o=l?n[1]:e.uniqueId()}else 1===n.length&&(r=i,s=e.isString(n[0])?{name:n[0]}:n[0],o=e.uniqueId());
return this.sync[o]={t0:t,type:r,data:s},{stop:this.stop.bind(this,o)}},stop:function(){var t,i;if(e.isFunction(arguments[0])){var n=arguments[0]();t=n.tick,i=n.args}else t=+new Date,i=[].slice.call(arguments);var a=i[0],r=i[1]||{},s=this.sync[a];if(s&&s.t0){var o=e.extend({t0:s.t0,t1:t},s.data,r),l=this._getAdapterArr(o["@"]);l.splice(0,0,"to-timing"),o["@"]=l,this.track(s.type,o),delete this.sync[a]}}},n}),define("tracking/taus.types.adapters",["Underscore"],function(e){var t="@timing",i="--exclude-board-context-flag",n={tick:function(){return(new Date).getTime()},getInfoFromTypes:function(t){if(!t)return"empty";var i=[],n=t.types?t.types:t;return e.isArray(n)&&(i=e.map(n,function(t){return e.isString(t)?t:t.type})),0===i.length?"empty":i.join(",")},getFilter:function(e){return e&&e.filter?e.filter:""},getBoardContext:function(t){if(!t)return{};var i=this.getInfoFromTypes(t.cells).split(",");1===i.length&&"empty"==i[0]&&(i=[]),i=e.sortBy(i);var n=t.user||{};return{x:{type:this.getInfoFromTypes(t.x),filter:this.getFilter(t.x)},y:{type:this.getInfoFromTypes(t.y),filter:this.getFilter(t.y)},mode:t.viewMode||null,zoomLevel:t.zoomLevel||null,user_cardFilter:n.cardFilter||"",cards:{types:i,filter:this.getFilter(t.cells)},cardSettings:t.cardSettings}},makePlainCleanObject:function(t,i,n,a){if(!(e.isUndefined(i)||e.isNull(i)||e.isEmpty(i))){var r=this;t=t||{};var s=e.isArray(i);if(!e.isObject(i)&&!s)return void(t[n]=i);if(s)return t[n]=[],e.each(i,function(e){e&&t[n].push(r.makePlainCleanObject({},e,"",a))}),t;for(var o=e.keys(i),l=n?n+"_":"",c=0;c<o.length;c++){var d=o[c];e.indexOf(a,d)>=0||r.makePlainCleanObject(t,i[d],l+d,a)}return t}}},a=function(t,i){var n=i?e.pick(i,"mode","zoomLevel","x","y","cards","user_cardFilter"):null;if(n&&"timeline"===(n.mode||"").toLocaleLowerCase()){var a=e.pick(i,"timelineGlobalDateRange","timelineLocalDateRange","timelineSettings");e.extend(n,a)}return e.extend(t,{"@board-context":n})},r={"--app-context-core":function(e){var t,i,n,a;return e.host&&(t=e.host.toLowerCase().replace("http://","").replace("https://","")),e.user&&(i=[t,"user",e.user.id].join("/")),e.path&&(n=e.path),e.acid&&(a=e.acid),this.cntx={appContext:{id:[t,a].join("/"),host:t,version:e.version,acid:a},host:{id:t},user:{id:i},path:n},this.cntx
},"--app-context-teams-projects":function(t){var i=function(e){return"null"===e?-1:e};return{_id:this.cntx.appContext.id,host:{id:this.cntx.host.id},teams:t.teams?e.map(t.teams,i):[],projects:t.projects?e.map(t.projects,i):[]}},"--add-last-view-entity-context":function(e){return e["@view-context"]=this.viewEntityContext||null,e},"--save-last-view-entity-context":function(e){return this.viewEntityContext={id:e.id,type:e.type,sid:+new Date},r["--add-last-view-entity-context"].call(this,e)},"view-entity":function(e){var t=e.tags||[];return t.push("view entity"),e.tags=t,r["--add-last-view-entity-context"].call(this,e)},"to-timing":function(i){var n={};return n[t]=i.t1-i.t0,e.extend(e.omit(i,"t0","t1"),n)},action:function(e){if(e.action=e.action||e.name,!e.action)throw"stats: [action | name] property must be provided for action message";return e},"action.id.sid":function(e){return e._id&&(e._id+="/"+this.sid),e},"--exclude-board-context":function(e){return e[i]=!0,e},"--update-board-context":function(t){return this.boardContext&&e.extend(this.boardContext,t.changes),t},"open-board-action":function(t){var i=t.boardSettings,a=t.definition,s=n.getBoardContext(a),o=e.extend({},i,s);this.boardContext=o;var l=e.extend({action:"open board",tags:["board","open board"],contextBoard:i.acid&&i.acid.length>0?!0:!1},o);l.boardName=l.name||"Unknown board",delete l.cards;var c=s.cards.types.join(",");return c||(c="no cards"),l.name=['open board "',l.boardName,'" ',"[",s.x.type,"/",s.y.type," with cards ",c,"]"].join(""),r["--exclude-board-context"](l)},"open-view-action":function(t){var i=e.extend({action:"open view",tags:["view","open view"]},t.view);return r["--exclude-board-context"](i)},"slice-request-completed":function(i){var a=function(e){return!i.hasOwnProperty(e)};if(e.any(["command","response",t],a))throw new Error("Invalid argument's properties for [slice-request-completed] adapter");var s=i.command||{},o=i[t],l=i.response||{},c=e.defaults({},s,{config:{$skip:0,$take:0}}),d=parseInt(l.getResponseHeader("X-Stopwatch")),u=l.getResponseHeader("X-Sql-Stopwatch"),p=parseInt(l.getResponseHeader("X-Count")),g=(l.responseText||"").length,m={method:c.method,page:{skip:c.config.$skip,take:c.config.$take},totalTime:o,netTime:o-d,serverTime:d,contentSize:g};
return e.keys(s.config||{}).length>0&&(m.params=c.config),isNaN(p)||(m.countOfEntities=p),u&&(m.serverSqlTimes=u.split(";")),n.makePlainCleanObject(m,i.request.definition,"",["global"]),r["--exclude-board-context"](m)},"slice-detailed-error":function(t){var i=e.extend({place:"slice",board:n.getBoardContext(t.definition)},e.omit(t,"definition"));return r["--exclude-board-context"](i)},"header-menu-click":function(t){var i=t.tags||[],n=i[0]||"click",a=i[1]||"header menu click";return e.extend(t,{action:a,name:a,tags:["board","click","page header","page header item"],area:"page header",event:n})},"--save-statistics_newlist_cardLoad":function(e){return this.latestStatisticsNewlistCardLoad=e,e},"--restore-statistics_newlist_cardLoad":function(){var e=this.latestStatisticsNewlistCardLoad;return delete this.latestStatisticsNewlistCardLoad,e},"--cast-statistics_newlist_cardLoad-to-statistics":function(e){return e.board=e["@board-context"]||{mode:"entitynewlist"},delete e["@board-context"],e.loadTime=e["@timing"],delete e["@timing"],e},"--global--":function(t){return t[i]||a(t,this.boardContext),delete t[i],e.extend({},t,this.cntx)}};return r}),define("tracking/extensions/extension.tracking.base",["tau/core/extension.base","app.path","Underscore"],function(e,t,i){return e.extend({init:function(e){this.global=e.bus.getGlobalBus(),this._super(e)},getPath:function(){return t.get()},getHost:function(){return t.get().toLowerCase().replace("http://","").replace("https://","")},makePlainCleanObject:function(e,t,n,a){if(!(i.isUndefined(t)||i.isNull(t)||i.isEmpty(t))){e=e||{};var r=i.isArray(t);if(!i.isObject(t)&&!r)return void(e[n]=t);if(r)return e[n]=[],i.each(t,function(t){t&&e[n].push(this.makePlainCleanObject({},t,"",a))},this),e;for(var s=i.keys(t),o=n?n+"_":"",l=0;l<s.length;l++){var c=s[l];i.indexOf(a,c)>=0||this.makePlainCleanObject(e,t[c],o+c,a)}return e}},getInfoFromTypes:function(e){if(!e)return"empty";var t=[];return e.types&&(e=e.types),i.isArray(e)&&i.each(e,function(e){t.push(i.isString(e)?e:e.type)
}),t.length?t.join(","):"empty"},getFilter:function(e){return e&&e.filter?e.filter:""},getBoardContext:function(e){if(!e)return{};var t=this.getInfoFromTypes(e.cells).split(",");1===t.length&&"empty"==t[0]&&(t=[]),t=i.sortBy(t);var n=e.user||{};return{x:{type:this.getInfoFromTypes(e.x),filter:this.getFilter(e.x)},y:{type:this.getInfoFromTypes(e.y),filter:this.getFilter(e.y)},mode:e.viewMode||null,zoomLevel:e.zoomLevel||null,user_cardFilter:n.cardFilter||"",cards:{types:t,filter:this.getFilter(e.cells)},cardSettings:e.cardSettings}}})}),define("tracking/extensions/extension.tracking.board.statistics",["./extension.tracking.base","Underscore"],function(e,t){return e.extend({"global start.lifecycle + overview.board.ready + board.paging.settings + model.cells.content.loaded":function(e){var i=e["start.lifecycle"],n=e["overview.board.ready"],a=e["board.paging.settings"].data,r=e["model.cells.content.loaded"].data;if(i.caller.id==n.caller.id){var s=n.date-i.date,o=0;r.data?t.each(r.data.items,function(e){o+=e.dynamic.items.length}):r.cards&&(o=r.cards.length);var l=["viewMode","x","y","cells","global","boardId"],c=this.makePlainCleanObject(this.getBoardContext(a.definition),a.definition,null,l);if("newlist"!==(c.mode||"").toLowerCase()){var d={"@":["--exclude-board-context"],loadTime:s,page:{current:t.extend({},a.page),size:{x:a.x.onPage,y:a.y.onPage},total:{x:a.x.totalPages,y:a.y.totalPages}},cardsCount:o,board:c};window.performance&&window.performance.timing&&!this.initialLoadTracked&&(this.initialLoadTracked=!0,d.totalLoadTime=Date.now()-performance.timing.navigationStart),this.fire("track.statistics",d)}}}})}),define("tracking/extensions/extension.tracking.application.context",["Underscore","./extension.tracking.base"],function(e,t){return t.extend({init:function(e){this._super(e);var t=e.context.configurator,i=t.getAppStateStore();i.bind({fields:["acid"],listener:this,callback:this.fire.bind(this,"acid.changed")})},"global acid.changed > track.new.context":function(e,t,i){var n=this._extractSelectedIds(i),a={action:"change context",name:this._getEventDescription(n),teams:n.teams,projects:n.projects,processes:n.processes,tags:["selected context"]};
this.fire("track.action",a)},_extractSelectedIds:function(e){return{teams:this._getEntityIds(e.selectedTeams),projects:this._getEntityIds(e.selectedProjects),processes:e.selectedProcessIds}},_getEntityIds:function(t){return e.without(e.pluck(t,"id"),"None")},_getEventDescription:function(e){return"context changed, teams="+e.teams.length+", projects="+e.projects.length+", processes="+e.processes.length}})}),define("tracking/extensions/extension.tracking.board.actions",["Underscore","./extension.tracking.base","libs/json2"],function(e,t){var i=function(t){try{return JSON.stringify(t)}catch(i){try{var n={};return e.each(t,function(e,t){try{JSON.stringify(e)&&(n[t]=e)}catch(i){n[t]=e+"[cyclic reference]"}}),JSON.stringify(n)}catch(a){return"[object "+a.message+"]"}}};return t.extend({bs_id:0,"global boardSettings.ready":function(e,t){var i=t.boardSettings;this.bs_id!==i.__objectId&&(this.bs_id=i.__objectId,this.boardSettings&&this.boardSettings.onChange.remove(this.trackBoardSettingsDiff),this.boardSettings=i,this.boardSettings.onChange.remove(this.trackBoardSettingsDiff).add(this.trackBoardSettingsDiff))},"global add.board":function(t,i){this.fire("track.action",e.extend({name:"add board"},i))},"global remove.board":function(t,i){this.fire("track.action",e.extend({name:"remove board"},i))},"global help.flow.action":function(e,t){var i={name:t.name,area:"help flow",tags:["help flow","help"]};t.tags&&(i.tags=i.tags.concat(t.tags)),t.progress&&(i.progress=t.progress),this.fire("track.action",i)},"global quick.add.popup.rendered":function(){this.fire("track.action",{name:"show quick add popup",tags:["board","quick add"]})},"global relatedQuickAdd.afterShow":function(){this.fire("track.action",{name:"show related quick add popup",tags:["board","quick add"]})},"global paging.cell.show.more":function(){this.fire("track.action",{name:"show more cards",tags:["board","show more"]})},"global board.configurator.ready:last + model.data.item.did.add":function(e,t,i){var n=i.message;if(n&&n.dataItem&&n.dataItem.type&&n.dataItem.data){var a=n.dataItem.data.cardData,r=a.type.toLowerCase();
this.fire("track.action",{action:"entity added",name:r+" #"+a.id+" added using quick add",type:r,tags:["add "+r,"add card","board"]})}},"global error":function(t,n){var a;n?e.isString(n)?a=n:n.message?a=n.message+(n.details||""):n.$node?(a=n.$node.text&&n.$node.text(),a=a||"unknown issue: unknown $node"):a="unknown issue: "+i(n):a="unknown issue: unspecified global error",this.fire("track.error",{message:a})},"global model.data.item.did.fail.add":function(e,t){t.Message&&(this.fire("track.error",{name:"quick add error",message:t.Message}),this.fire("track.action",{name:"quick add error",tags:["error","board","quick add"],message:t.Message}))},"global view.card.batch.move.completed":function(t,i){var n=[],a={};e.each(i,function(e){if(e.data){var t=e.data("entity-type");n.push({type:t,id:e.data("entity-id")}),a[t]||(a[t]=0),a[t]++}}),this.fire("track.action",{action:"move cards",name:n.length+" card(s) moved "+JSON.stringify(a),cards:n,tags:["board","business action","move cards"]})},"global board.template.selected":function(e,t){t=t||{name:"not defined"},this.fire("track.action",{action:"apply template",name:"apply template ["+t.name+"]",template:t,tags:["board","templates","customize","settings"]})},trackBoardSettingsDiff:function(t){if(t){var i=[],n={};e.each(t,function(e,t){var a=t;"isdraft"!==a.toLowerCase()&&(a="user"===t?"user filter":"edit"===t?"switch "+(e?"on":"off")+" board edit mode":"name"==t?"boardName":t,n[a]=e,i.push(a))}),i.length>0&&taus.track({"@":["--update-board-context"],action:"customize board",name:"change board settings ["+i.join(",")+"]",tags:["customize","board"].concat(i),changes:n})}}})}),define("tracking/extensions/extension.tracking.clicks",["./extension.tracking.base","Underscore","jQuery"],function(e,t,i){return e.extend({track:function(e,i,n){e||(e="body"),n=n||"click",i=i||{},t.defaults(i,{tags:[]});var a=function(e){i.tags.indexOf(e.toLowerCase())<0&&i.tags.push(e)};a("board"),a(n),i.area&&a(i.area);var r={selector:e,data:i,event:n};
return this.clickMap[e]=r,{name:function(e){return i.name=e,a(e),this},nameSelector:function(e){return r.nameSelector=e,this},nameTemplate:function(e){return r.nameTemplate=e,this},tag:function(){return t.each(arguments,function(e){a(e)}),this},event:function(e){return r.event=e,a(e),this},area:function(e){return i.area=e,a(e),this}}},trackArea:function(e,t){var i=this;return function(n){var a=e+(n?" "+n:"");return i.track(a,{area:t})}},trackMainMenu:function(){this.track(".tau-user-submenu .tau-menu-item").area("page header menu").tag("context menu");var e=this.trackArea(".tau-teams-projects-manager","project/team selection");e("button"),this.track(".tau-social-share-popup .tau-share-link").area("social sharing").tag("share targetprocess")},trackGettingStarted:function(){this.track(".tau-getting-started .rhino-btn,.tau-getting-started .rhino-bullet").area("getting started popup").tag("getting started")},trackQuickAdd:function(){var e=this.trackArea(".tau-quick-add-dialog","quick add popup");e("button").tag("quick add popup")},trackBoard:function(){this.track(".tau-board-settings-header.i-role-tabheaders").area("board settings").tag("select setting tab").nameTemplate("select [<%= name%>] tab"),this.track(".tau-cellholder .tau-add").area("board").tag("quick add").name("quick add in cell")},trackSidebar:function(){this.track(".tau-pane-collapser").area("sidebar").name("boards menu collapse (expand)"),this.track(".tau-boardselector__headermenu__item").nameTemplate("customize board menu -> <%= name%>").area("sidebar").tag("boards menu header")},startTracking:function(){var e=this,n=function(e){return e?e:null},a=function(e){var t=n(e.text())||n(e.attr("title"))||n(e.data("title"))||n(e.data("label"))||n(e.attr("role"))||"";return t.toLowerCase()},r=function(e,t){var n;return e.nameSelector?(n=i(e.nameSelector,this).text(),n&&e.data.name&&(n=e.data.name+" "+n),n):(n=e.data.name||a(t)||a(i(this)),n.replace(/[\t\n;]/g,""))},s=function(n){try{var a=i(n.target),s=n.data,o=r.call(this,s,a);
if(!o)return;s.nameTemplate&&(o=t.template(s.nameTemplate)({name:o}));var l=t.defaults({name:o,event:s.event},s.data);e.fire("track.action",l)}catch(c){}},o=i("body");t.each(this.clickMap,function(e){o.on(e.event,e.selector,e,s)})},init:function(e){var i=this;i._super(e),e=e||{},e.disableClicksTracking!==!0&&(t.defaults(e,{clickMap:{}}),i.clickMap=e.clickMap,i.trackSidebar(),i.trackMainMenu(),i.trackGettingStarted(),i.trackBoard(),i.trackQuickAdd(),i.startTracking())}})}),define("libs/schedule",[],function(){function e(e){this.createdOn=new Date,this.period=e,this.expected=0,this.xxx=null,this.MAX_DELTA=6e4,this.iterationNo=-1;var t=this.loop=function(e,i){var n=new Date,a=n.getTime(),r=this.expected>0?this.expected:a,s=a-r;i||e({date:n,"schedule-shift":s,i:++this.iterationNo}),this.expected=+new Date+this.period,this.xxx=setTimeout(function(){t(e,i)},this.period)}.bind(this);this.stop=function(){this.expected=0,clearTimeout(this.xxx)}.bind(this)}return e}),define("tracking/extensions/session",["jQuery"],function(e){var t=e.Deferred();window.session={options:{use_html5_location:!1,session_timeout:1},start:function(e){t.resolve(e)}};var i=function(e,t,i){"use strict";var a=.4,r={use_html5_location:!1,ipinfodb_key:!1,gapi_location:!0,location_cookie:"location",location_cookie_timeout:5,session_timeout:32,session_cookie:"first_session",get_object:null,set_object:null},s=function(){if(e.session=e.session||{},e.session.contains=function(e){if("string"==typeof e)return-1!==this.indexOf(e);for(var t=0;t<e.length;t++)if(-1!==this.indexOf(e[t]))return!0;return!1},e.session&&e.session.options)for(var t in e.session.options)r[t]=e.session.options[t];var i={api_version:a,locale:l.locale(),current_session:l.session(),original_session:l.session(r.session_cookie,24*r.session_timeout*60*60*1e3),browser:l.browser(),plugins:l.plugins(),time:l.time(),device:l.device()};if(r.use_html5_location?i.location=l.html5_location():r.ipinfodb_key?i.location=l.ipinfodb_location(r.ipinfodb_key):r.gapi_location&&(i.location=l.gapi_location()),e.session&&e.session.start)var n=e.session.start;
var s,o=0,c=function(t){t&&o--,0===o&&n&&n(e.session)};e.session={};for(var d in i)if(s=i[d],"function"==typeof s)try{s(function(t){e.session[d]=t,c(!0)}),o++}catch(u){e.console&&"function"==typeof console.log&&(console.log(u),c(!0))}else e.session[d]=s;c()},o={detect:function(){var e={browser:this.search(this.data.browser),version:this.search(i.userAgent)||this.search(i.appVersion),os:this.search(this.data.os)};if("Linux"==e.os)for(var t=["CentOS","Debian","Fedora","Gentoo","Mandriva","Mageia","Red Hat","Slackware","SUSE","Turbolinux","Ubuntu"],n=0;n<t.length;n++)if(i.userAgent.toLowerCase().match(t[n].toLowerCase())){e.distro=t[n];break}return e},search:function(e){if("object"!=typeof e){var t=e.indexOf(this.version_string);if(-1==t)return;return parseFloat(e.substr(t+this.version_string.length+1))}for(var i=0;i<e.length;i++){var n=e[i].string,a=e[i].prop;if(this.version_string=e[i].versionSearch||e[i].identity,n){if(-1!=n.indexOf(e[i].subString))return e[i].identity}else if(a)return e[i].identity}},data:{browser:[{string:i.userAgent,subString:"Chrome",identity:"Chrome"},{string:i.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:i.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:e.opera,identity:"Opera",versionSearch:"Version"},{string:i.vendor,subString:"iCab",identity:"iCab"},{string:i.vendor,subString:"KDE",identity:"Konqueror"},{string:i.userAgent,subString:"Firefox",identity:"Firefox"},{string:i.vendor,subString:"Camino",identity:"Camino"},{string:i.userAgent,subString:"Netscape",identity:"Netscape"},{string:i.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:i.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:i.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:i.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:i.platform,subString:"Win",identity:"Windows"},{string:i.platform,subString:"Mac",identity:"Mac"},{string:i.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:i.userAgent,subString:"iPad",identity:"iPad"},{string:i.userAgent,subString:"Android",identity:"Android"},{string:i.platform,subString:"Linux",identity:"Linux"}]}},l={browser:function(){return o.detect()
},time:function(){var e=new Date,t=new Date;return e.setMonth(0),e.setDate(1),t.setMonth(6),t.setDate(1),{tz_offset:-(new Date).getTimezoneOffset()/60,observes_dst:e.getTimezoneOffset()!==t.getTimezoneOffset()}},locale:function(){var e=(i.language||i.browserLanguage||i.systemLanguage||i.userLanguage||"").split("-");return 2==e.length?{country:e[1].toLowerCase(),lang:e[0].toLowerCase()}:e?{lang:e[0].toLowerCase(),country:null}:{lang:null,country:null}},device:function(){var n,a,r={screen:{width:e.screen.width,height:e.screen.height}};try{n=e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth}catch(s){n=0}try{a=e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight}catch(s){a=0}return r.viewport={width:n,height:a},r.is_tablet=!!i.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),r.is_phone=!r.is_tablet&&!!i.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i),r.is_mobile=r.is_tablet||r.is_phone,r},plugins:function(){var e=function(e){if(i.plugins){for(var t,n=0,a=i.plugins.length;a>n;n++)if(t=i.plugins[n],t&&t.name&&-1!==t.name.toLowerCase().indexOf(e))return!0;return!1}return!1},t=function(e){for(var t=!0,i=0;i<e.length;i++){try{var t=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"+e[i]),!0)}catch(n){}if(t)return!0}return!1};return{flash:e("flash")||t([".7",".6",""]),silverlight:e("silverlight"),java:e("java"),quicktime:e("quicktime")}},session:function(i,n){var a=c.get_obj(i);if(null==a){a={visits:1,start:(new Date).getTime(),last_visit:(new Date).getTime(),url:e.location.href,path:e.location.pathname,referrer:t.referrer,referrer_info:c.parse_url(t.referrer),search:{engine:null,query:null}};var r,s=[{name:"Google",host:"google",query:"q"},{name:"Bing",host:"bing.com",query:"q"},{name:"Yahoo",host:"search.yahoo",query:"p"},{name:"AOL",host:"search.aol",query:"q"},{name:"Ask",host:"ask.com",query:"q"},{name:"Baidu",host:"baidu.com",query:"wd"}],o=s.length,l=0,d="q query term p wd query text".split(" ");
for(l=0;o>l;l++)if(r=s[l],-1!==a.referrer_info.host.indexOf(r.host)){a.search.engine=r.name,a.search.query=a.referrer_info.query[r.query],a.search.terms=a.search.query?a.search.query.split(" "):null;break}if(null===a.search.engine&&a.referrer_info.search.length>1)for(l=0;l<d.length;l++){var u=a.referrer_info.query[d[l]];if(u){a.search.engine="Unknown",a.search.query=u,a.search.terms=u.split(" ");break}}}else a.prev_visit=a.last_visit,a.last_visit=(new Date).getTime(),a.visits++,a.time_since_last_visit=a.last_visit-a.prev_visit;return c.set_obj(i,a,n),a},html5_location:function(){return function(e){i.geolocation.getCurrentPosition(function(t){t.source="html5",e(t)},function(){r.gapi_location?l.gapi_location()(e):e({error:!0,source:"html5"})})}},gapi_location:function(){return function(t){var i=c.get_obj(r.location_cookie);i&&"google"===i.source?t(i):(e.gloader_ready=function(){"google"in e&&(e.google.loader.ClientLocation?(e.google.loader.ClientLocation.source="google",t(e.google.loader.ClientLocation)):t({error:!0,source:"google"}),c.set_obj(r.location_cookie,e.google.loader.ClientLocation,60*r.location_cookie_timeout*60*1e3))},c.embed_script("https://www.google.com/jsapi?callback=gloader_ready"))}},architecture:function(){var e=n.userAgent.match(/x86_64|Win64|WOW64|x86-64|x64\;|AMD64|amd64/)||"x64"===n.cpuClass?"x64":"x86";return{arch:e,is_x64:"x64"==e,is_x86:"x68"==e}},ipinfodb_location:function(t){return function(i){var n=c.get_obj(r.location_cookie);n||"ipinfodb"!==n.source?i(n):(e.ipinfocb=function(e){if("OK"===e.statusCode)e.source="ipinfodb",c.set_obj(r.location_cookie,e,60*r.location_cookie*60*1e3),i(e);else{if(r.gapi_location)return l.gapi_location()(i);i({error:!0,source:"ipinfodb",message:e.statusMessage})}},c.embed_script("http://api.ipinfodb.com/v3/ip-city/?key="+t+"&format=json&callback=ipinfocb"))}}},c={parse_url:function(e){var i=t.createElement("a"),n={};i.href=e;var a=i.search.substr(1);if(""!=a)for(var r,s=a.split("&"),o=0,l=s.length;l>o;o++)r=s[o].split("="),2===r.length&&(n[r[0]]=decodeURI(r[1]));
return{host:i.host,path:i.pathname,protocol:i.protocol,port:""===i.port?80:i.port,search:i.search,query:n}},set_cookie:function(i,n,a,r){return i?(r||(r={}),(null===n||void 0===n)&&(a=-1),a&&(r.expires=(new Date).getTime()+a),t.cookie=[encodeURIComponent(i),"=",encodeURIComponent(String(n)),r.expires?"; expires="+new Date(r.expires).toUTCString():"","; path="+(r.path?r.path:"/"),r.domain?"; domain="+r.domain:"",e.location&&"https:"===e.location.protocol?"; secure":""].join("")):null},get_cookie:function(e,i){return(i=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(t.cookie))?decodeURIComponent(i[1]):null},embed_script:function(e){var i=t.createElement("script");i.type="text/javascript",i.src=e,(t.body||t.getElementsByTagName("body")[0]||t.head).appendChild(i)},package_obj:function(e){if(e){e.version=a;var t=d.stringify(e);return delete e.version,t}},set_obj:function(e,t,i,n){c.set_cookie(e,c.package_obj(t),i,n)},get_obj:function(e){var t;try{t=d.parse(c.get_cookie(e))}catch(i){}return t&&t.version==a?(delete t.version,t):void 0}};null!=r.get_object&&(c.get_obj=r.get_object),null!=r.set_object&&(c.set_obj=r.set_object);var d={parse:e.JSON&&e.JSON.parse||function(e){return"string"==typeof e&&e?new Function("return "+e)():null},stringify:e.JSON&&e.JSON.stringify||function(e){var t=typeof e;if("object"===t&&null!==e){var i,n,a=[],r=e&&e.constructor===Array;for(i in e)n=e[i],t=typeof n,"string"===t?n='"'+n+'"':"object"===t&&null!==n&&(n=this.stringify(n)),a.push((r?"":'"'+i+'":')+n);return(r?"[":"{")+a.join(",")+(r?"]":"}")}return"string"===t?'"'+e+'"':void 0}};s()};return"undefined"==typeof window.exports?i(window,document,navigator):window.exports.session=i,t}),define("tracking/extensions/host.info",["jQuery","app.path","libs/json2"],function(e,t){var i=null;return{get:function(){if(i)return i;var n=localStorage.getItem("host_info");if(n)try{n=e.parseJSON(n);var a=new Date-new Date(n.date),r=Math.floor(a/36e5);if(24>r)return i=e.Deferred().resolve(n.data)}catch(s){}return i=e.ajax({url:t.get()+"/info.ashx",dataType:"json"}).done(function(e){var t={date:(new Date).getTime(),data:e};
localStorage.setItem("host_info",JSON.stringify(t))})}}}),define("tracking/extensions/extension.tracking.user.host",["jQuery","app.path","Underscore","libs/schedule","./extension.tracking.base","tau/configurator","./session","tp/mashups","./host.info","tp/mashups/failed"],function(e,t,i,n,a,r,s,o,l,c){var d=function(e,t){if(!e)return"";var i=e.toLowerCase().split("/mashups/");return i.length?(i=(i[i.length-1]||"").replace("/","").replace(t,"").replace(".js",""),i=i.split(o.prototype.mashupKeySeparator)[0]):""};return a.extend({init:function(e){var t=e.scheduler;this._super.apply(this,arguments),this.global.on("application.context.data",function(e){e.removeListener(),t.onceADay(function(){this.getSessionData(e.data,function(e){this.fire("data.track",e)}.bind(this))}.bind(this)),window.performance&&window.performance.memory&&window.performance.memory.usedJSHeapSize&&t.eachXMins(30,function(e){var t={date:e.date,"live-minutes":30*e.i,"schedule-shift":e["schedule-shift"],memory:window.performance.memory};taus.track("browser-memory",t)})}.bind(this),this)},"global boardsSet.selected":function(e,t){var i=this.getHost(),n=this.getUser(),a={userProcess:{_id:n._id,user:{id:n._id},host:{id:i},process:t}};this.fire("data.track",a)},getUser:function(e){var t=this.getHost();e=e||{};var n=[window.loggedUser,r.getLoggedUser(),e.loggedUser,{id:0,role:"N/A"}],a=i.find(n,i.identity);return a=i.deepClone(a),a._id=t+"/user/"+a.id,a.host={id:t},a.tau_keep_date=!0,delete a.id,a},getSessionData:function(t,n){var a=this,r=a.getHost(),u=this.getUser(t);s.done(function(t){var a=t.location||{address:{}},s=new Date,p=s.getDate()+"_"+(s.getMonth()+1)+"_"+s.getFullYear(),g=u._id+"/"+p;delete a.latitude,delete a.longitude,delete a.source,u.location=a;var m=[],h=o.prototype.getRegisteredMashups();i.each(i.keys(h),function(e){var t=d(e,r),n=h[e],a=n.files;t.length&&m.push({_id:r+"/"+t+"/"+p,name:i.trim(t),host:{id:r},files:a})});var f={user:u,mashup:m,host:{_id:r},visit:{_id:g,user:{id:u._id},host:{id:r},browser:t.browser,device:t.device,locale:t.locale,location:a}},y=i.keys(c);
if(y.length>0){var v=[];i.each(y,function(e){var t=d(e,r);t.length&&v.push({_id:r+"/"+t+"/"+p,name:t,path:e,host:{id:r}})}),f.failedMashup=v}l.get().done(function(t){if("string"===e.type(t.createdOn)){var a=t.createdOn.split("/");t.createdOn=new Date(parseInt(a[2],10),parseInt(a[0],10)-1,parseInt(a[1],10))}i.extend(f.host,t),i.extend(f.visit.host,t),i.extend(f.user.host,t),n(f)})})}})}),define("tracking/extensions/extension.tracking.store.v2",["Underscore","./extension.tracking.base","tracking/stores/store.factory"],function(e,t,i){return t.extend({init:function(t){this._super(t),this.sid=t.sid,this.stores=[],e.each(t.store,function(e,t){try{var n=i.createTrackingStore(t,e);this.stores.push(n)}catch(a){}},this)},postData:function(t){if(e.isObject(t))for(var i=this,n=0;n<i.stores.length;n++){var a=i.stores[n];try{a.api.post(t,i.bus)}catch(r){}}},"bus data.track":function(e,t){this.postData(t)},"bus track.action":function(e,t){taus.track(t)},"bus track.action.id.sid":function(e,t){t["@"]=["action.id.sid"],taus.track(t)},"bus track.error":function(e,t){taus.error(t)},"bus track.statistics":function(e,t){taus.track("statistics",t)}})}),define("tracking/extensions/extension.tracking.rest",["Underscore","./extension.tracking.base","tau/configurator"],function(e,t,i){return t.extend({"global store.command.executed":function(t,n){if(n&&n.command&&n.command.config&&("save"==n.command.name||"remove"==n.command.name)){var a=n.command.config.id,r=a?" #"+a:"",s=n.command.type.toLowerCase();if("remove"==n.command.name)return void this.fire("track.action",{action:"delete entity",name:"delete "+s+r,area:"entity",tags:["delete "+s,"delete entity","entity"],type:s,id:a});var o=n.command.config.$set;if("save"==n.command.name&&o){var l=a||o.id?"update ":"add ",c=e.keys(o);if(0===c.length)return;var d=c.join(","),u=window.loggedUser||i.getLoggedUser()||{id:0,role:"N/A"};this.fire("track.action.id.sid",{action:"update entity",_id:this.getHost()+"/"+t.caller.id+"/"+u.id+"/"+c.join("_"),name:l+s+r+" ["+d.toLowerCase()+"]",area:"entity",tags:[l+s,l+"entity","entity","add|update"],type:s,changes:c,params:o,id:a})
}}},"global store.command.failed":function(t){var i="something is wrong";try{if(t.data&&t.data.data){t.data.data.Message&&(i=t.data.data.Message);var n=t.data.data.response;if(n){if(n.Message&&(i=n.Message),e.isArray(n)){var a=[n[1]];e.isArray(n[4])&&n[4].length>0&&n[4][0]!=a[0]&&a.push(n[4][0]),i=a.join(":&nbsp;")}n.Error&&n.Error.Message&&(i=n.Error.Message)}}}catch(r){}var s={name:i,tags:["error","rest"]};this.fire("track.error",s)}})}),define("tracking/component.tracking",["Underscore","tau/core/component-base","./extensions/extension.tracking.board.statistics","./extensions/extension.tracking.application.context","./extensions/extension.tracking.board.actions","./extensions/extension.tracking.clicks","./extensions/extension.tracking.user.host","./extensions/extension.tracking.store.v2","./extensions/extension.tracking.rest"],function(e,t,i,n,a,r,s,o,l){return{create:function(c){var d=e.compact([{type:i},{type:r},{type:s},{type:n},{type:a},{type:o},{type:l}]),u={name:"tracking component","queue.bus":!0},p=new t(e.extend(u,c||{}));return e.each(d,function(e){p.attach(e.type,e.config)}),p.bus}}}),define("tracking/spy.event",["jQuery"],function(e){return e.Deferred()}),define("tracking/tauspy",["Underscore","jQuery","./taus","./taus.types.adapters","tau/core/global.bus","./component.tracking","./spy.event","libs/schedule"],function(e,t,i,n,a,r,s,o){var l=null,c={start:function(e){return l||(e=e||{},l=r.create(e)),l}},d=function(t){var n=[],a=function(e){return function(){n.push({methodName:e,params:[].slice.call(arguments)})}};window.taus={context:a("context"),track:a("track"),error:a("error"),start:function(){var t,i,a,r="action",s=[].slice.call(arguments);return 3===s.length?(t=s[0],i=s[1],a=s[2]):2===s.length?e.isObject(s[0])?(t=r,i=s[0],a=s[1]):(t=s[0],i=s[1],a=e.uniqueId()):1===s.length&&(t=r,i=e.isString(s[0])?{name:s[0]}:s[0],a=e.uniqueId()),n.push({methodName:"start",params:[function(){return{tick:+new Date,args:[t,i,a]}}]}),{stop:this.stop.bind(this,a)}},stop:function(){var e=[].slice.call(arguments);
n.push({methodName:"stop",params:[function(){return{tick:+new Date,args:e}}]})}};for(var r=new i(t);n.length>0;){var s=n.shift();r[s.methodName].apply(r,s.params)}window.taus=r},u=function(e,t){var i=new Date,n=i.getHours(),a=i.getMinutes(),r=60*(24-n)-a,s=new o(60*(r+1)*1e3);s.loop(function(t){e(t.date),s.stop(),setTimeout(u.bind(null,e,!0),0)},t)},p=function(e){var t=e.data("label")||e.attr("title")||e.data("title")||e.attr("role")||e.text()||"";return t.toLowerCase()},g=function(e){var t=e.attr("tauspref")||"",i=["click"];t&&i.push(t);var n=i.join(" "),a=e.attr("taustype"),r=a?a.split(","):[];taus.track("action",{"@":r,action:n,name:[n,p(e)].join(" "),tags:i})};return t(document).on("click",".i-taus",function(e){g(t(e.currentTarget))}),t.Event.prototype.stopPropagation=e.wrap(t.Event.prototype.stopPropagation,function(e){var i=this.originalEvent;if(i){var n=t(i.target).closest(".i-taus");0!==n.length&&g(n)}return e.apply(this,arguments)}),s.done(function(t){var i=(new Date).getTime(),r={version:2},s={onceADay:u,eachXMins:function(e,t){new o(60*e*1e3).loop(t)}};c.start(e.extend({sid:i},t,{scheduler:s},r)),d(e.extend({sid:i},t,{scheduler:s},r,{globalBus:a.get(),adapters:n}))}),c}),define("tau/ui/behaviour/common/ui.behaviour.dnd",["require","jQuery","Underscore"],function(e){var t=e("jQuery"),i=e("Underscore"),n=Boolean(window.FileReader);if(n){var a=".i-role-uploader-area",r=function(){return t(a)},s=function(e){return function(t){return i.contains(t.originalEvent.dataTransfer.types,"Files")?e.call(this,t):void 0}},o=t("body");o.on("dragover.uploader",a,s(function(e){return e.originalEvent.dataTransfer.dropEffect="copy",!1})),o.on("dragenter.uploader",a,s(function(){t(this).addClass("hover")})),o.on("dragleave.uploader",s(function(e){var t=this.getBoundingClientRect(),i=e.originalEvent,n=i.clientX-t.left,a=i.clientY-t.top,s=0>=n||0>=a||n>=t.width||a>=t.height;s&&r().removeClass("dragged-over hover")})),o.on("dragenter.uploader",s(function(){r().addClass("dragged-over")
})),o.on("drop.uploader",s(function(){r().removeClass("dragged-over hover")})),o.on("dragover.uploader",".cke",s(function(){return!1})),o.on("dragover.uploader",s(function(e){e.originalEvent.dataTransfer.dropEffect="none",r().removeClass("hover"),e.preventDefault()}))}}),define("main.boardplus.init",["require","jQuery","Underscore","libs/parseUri","tau/service.container","tau/configurator","tracking/tracking.headers","tau/services/service.navigator","tau/components/component.application.generic","tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific","tau/components/extensions/extension.tracking.performance","tau/components/extensions/extension.views.menu.comet.listener","tau/components/extensions/dashboard/extension.dashboard.widget.registry.builder","main.boardplus.login","main.boardplus.routes","tp/mashups.loader","Modernizr","tracking/tauspy","tau/ui/behaviour/common/ui.behaviour.dnd"],function(e){function t(e){var t=new r;t._id=n.uniqueId("board_"),t.isBoardEdition=!0,t.setWindow(window),t.setFeaturesService(t.getWindow().tauFeatures),t.setLoggedUser(t.getWindow().loggedUser);var i=new l(t,{parameterName:e});return t.registerService("navigator",i),t}var i=e("jQuery"),n=e("Underscore"),a=e("libs/parseUri"),r=e("tau/service.container"),s=e("tau/configurator"),o=e("tracking/tracking.headers"),l=e("tau/services/service.navigator"),c=e("tau/components/component.application.generic"),d=e("tau/ui/extensions/application.generic/ui.extension.application.generic.boardSpecific"),u=e("tau/components/extensions/extension.tracking.performance"),p=e("tau/components/extensions/extension.views.menu.comet.listener"),g=e("tau/components/extensions/dashboard/extension.dashboard.widget.registry.builder"),m=e("main.boardplus.login"),h=e("main.boardplus.routes"),f=e("tp/mashups.loader");e("Modernizr"),e("tracking/tauspy"),e("tau/ui/behaviour/common/ui.behaviour.dnd"),s.isBoardEdition=!0,i(function(){o.trackByDefault();var i="page",n=t(i),r=s.getGlobalBus();
if(tauFeatures["load.progress"]){var l={},y=function(){r.removeAllListeners(l),setTimeout(function(){tauLoadProgress.activityEnd("app.init").remove()},4)};r.addEventListener("error",y,l),r.addEventListener("contentRendered",y,l)}new m(n,i).process().then(function(){var t={name:"application board",options:{applicationId:i},routes:h.createApplicationRoutes(),context:{configurator:n},extensions:[d,u,p,g]},r=function(){var e=c.create(t);tauFeatures["load.progress"]&&tauLoadProgress.activityEnd("user.mashups").activity("app.init"),e.initialize(t)};a(location.href).hasQueryKey("nomashups")?r():n.getFeaturesService().isEnabled("mashups.loader")?f.initDeferred.done(function(){f.loadState.beforeAppInit.status.done(function(){r()})}):e(["user/mashups"],function(){r()})})})}),require(["main.boardplus.init"],function(){}),define("main.boardplus",function(){});