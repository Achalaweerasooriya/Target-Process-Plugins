define(["Underscore","./extension.tracking.base"],function(e,t){return t.extend({init:function(e){this._super(e);var t=e.context.configurator,s=t.getAppStateStore();s.bind({fields:["acid"],listener:this,callback:this.fire.bind(this,"acid.changed")})},"global acid.changed > track.new.context":function(e,t,s){var n=this._extractSelectedIds(s),c={action:"change context",name:this._getEventDescription(n),teams:n.teams,projects:n.projects,processes:n.processes,tags:["selected context"]};this.fire("track.action",c)},_extractSelectedIds:function(e){return{teams:this._getEntityIds(e.selectedTeams),projects:this._getEntityIds(e.selectedProjects),processes:e.selectedProcessIds}},_getEntityIds:function(t){return e.without(e.pluck(t,"id"),"None")},_getEventDescription:function(e){return"context changed, teams="+e.teams.length+", projects="+e.projects.length+", processes="+e.processes.length}})});