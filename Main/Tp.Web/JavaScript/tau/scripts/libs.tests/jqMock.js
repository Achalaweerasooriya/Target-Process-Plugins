define(["libs/jquery/jquery"],function(a){var b=function(a){function c(a,b,e,f){e=e||!1,f=f||[];if(a===b)return!0;if(b instanceof r)return b.assert(a);if(a===null||b===null)return!1;if(a instanceof Array&&b instanceof Array){if(a.length!=b.length)return!1;for(var g=0;g<a.length;g++){var h=d(a[g],b[g],e,f,b[g]);if(!h)return!1}return!0}if(typeof a=="object"&&typeof b=="object"){for(var g in b){var h=d(a[g],b[g],e,f,b[g]);if(!h)return!1}if(!e)for(var g in a)if(!c(a[g],b[g]))return!1;return!0}return!1}function d(a,b,d,e,f){if(typeof f=="object"){for(var g=0;g<e.length;g++)if(f===e[g])throw new Error("Circular Reference detected in the object!");var h=e.length;e.push(f);var i=c(a,b,d,e);return e.splice(h),i}return c(a,b,d,e)}function e(a,b,d){var e=a===b||c(a,b);QUnit.push(e,a,b,d)}function g(b,c){c=c||[];if(c.length>f)return".....";if(typeof b=="object")for(var d=0;d<c.length;d++)if(b==c[d])return"...";c.push(b);var e=c.length,h=[];if(b===null)return"null";if(b===undefined)return"undefined";if(b instanceof Array){h.push("[");for(var i=0;i<b.length;i++)h.push(g(b[i],c)),h.push(",");b.length>0?h[h.length-1]="]":h.push("]")}else{if(b instanceof r)return b.tostring();if(b instanceof Error){var j={};return"name"in b&&(j.name=b.name),"message"in b&&(j.message=b.message),g(j,c)}if(a.isFunction(b))return"function()";if(typeof b=="object"){h.push("{");for(var k in b){if(/^__/.test(k))continue;h.push(k),h.push(":"),h.push(g(b[k],c)),h.push(",")}h[h.length==1?h.length:h.length-1]="}"}else h.push(typeof b=="string"?"'":""),h.push(b),h.push(typeof b=="string"?"'":"")}return c.splice(e),h.join("")}function h(b){try{return a.trim(b.toString()).match(/^function\s(.*)\(/)[1]}catch(c){return b instanceof Error&&b.name?b.name:b.toString()}}function i(a,b){try{a(),QUnit.ok(!1,"The expected exception was never thrown. Expression was: "+g(b))}catch(c){e(c,b,"expected exception matching "+g(b)+" to be thrown")}}function j(a,b){this._fnName=a,this._origFn=b,this._args=[],this._multiplicity=p.exactly(1),this._returnValue=undefined,this._returnValueSpecified=!1,this._exception=null,this._matchCount=0}function o(a,b,c,d){this.type=a,this.lower=b,this.upper=c,this.satisfied=d,this.isDisabled=!1}function r(a,b){this.type=a,this.param=b}function t(b,c){var d=[],e=[],f=b,h=c,i=!1,k=0,n=!1;if(b==undefined||b[c]==undefined)throw new Error("Could not create Mock: the object or function you specified is not defined, obj."+c);if(!a.isFunction(b[c]))throw new Error("Could not create Mock: "+c+" is not a function");var o=function(){var a,b;if(i)n||(b=e[k].matches(arguments),b==m?a=e[k]:(k++,e.length>k&&(b=e[k].matches(arguments),b==m&&(a=e[k])))),a===undefined&&(n=!0);else for(var f=0;f<e.length;f++){b=e[f].matches(arguments);if(b==m){a=e[f];break}}if(a)return a.doAction(this,arguments);var h=Array.prototype.slice.call(arguments),j=c+"("+g(h).replace(/^\[(.*)\]$/,"$1")+")";d.push({matchResult:b,msg:j})};if(!!b[c].isMock)throw new Error("Could not create Mock: you tried to overwrite a function which is already a mock!");var p=b[c];b[c]=o,b[c].isMock=!0,this.reset=function(){k=0,n=!1;for(var a=0;a<e.length;a++)delete e[a];e=[];for(var a=0;a<d.length;a++)delete d[a];d=[]},this.restore=function(){this.reset(),f[h]=p},this.modify=function(){return e.push(new j(h,p)),e[e.length-1]},this.setOrdered=function(a){i=a};var q=function(a){if(e.length<=0)throw new Error("Expectation setup error. You must set up some expectations");var b=!0;for(var c=0;c<e.length;c++)if(!e[c].satisfied()){b=!1;break}var f="";if(!b){f+=(i?"Ordered":"Unordered")+" expectations have not yet been satisfied:<br/>";for(var c=0;c<e.length;c++)f+=e[c].tostring()+"<br/>"}if(d.length>0)if(a){b=!1,f+="No expectation matched for the following calls:<br/>";for(var c=0;c<d.length;c++)f+=d[c].msg+"<br/>"}else{var g="";for(var c=0;c<d.length;c++)d[c].matchResult==l&&(g+=d[c].msg+"<br/>");g.length>0&&(f+="No expectation matched for the following calls which were setup as expectations:<br/>"+g,b=!1)}f==""&&(f=e.length+" expectations were satisfied"),QUnit.ok(b,f)};this.verify=function(){q(!1)},this.verifyAll=function(){q(!0)}}function u(){if(window.expect||window.is)throw new Error("Cannot add shortcuts, expect() or is() already exists in global scope!");expect=b.expect,is=b.is}var f=100;j.prototype.args=function(){var a=Array.prototype.slice.call(arguments);return this._args=a,this},j.prototype.multiplicity=function(a){if(a instanceof o)this._multiplicity=a;else if(typeof a=="number")this._multiplicity=p.exactly(a);else throw new Error("Invalid argument for multiplicity()");return this},j.prototype.returnValue=function(a){this._returnValueSpecified=!0,typeof a!="undefined"&&(this._returnValue=a)},j.prototype.throwException=function(a){this._exception=a};var k=-1,l=0,m=1;j.prototype.matches=function(a){var b=!0,d=this._args;if(d.length==0)b=a.length==0;else if(d.length==a.length){for(var e=0;e<d.length;e++)if(!c(a[e],d[e])){b=!1;break}}else b=!1;return b?this._multiplicity.isDisabled?l:(this._multiplicity.verify(++this._matchCount),m):k},j.prototype.doAction=function(a,b){if(this._returnValueSpecified)return this._returnValue;if(this._exception)throw this._exception;return this._origFn.apply(a,b)},j.prototype.satisfied=function(){return this._multiplicity.satisfied},j.prototype.tostring=function(){return[this._multiplicity.satisfied?"&nbsp;&nbsp;&nbsp;":"&rarr;",this._matchCount," ",this._multiplicity.tostring()," ",this._fnName,"(",g(this._args).replace(/^\[(.*)\]$/,"$1"),")"].join("")};var n={EXACTLY:0,ATLEAST:1,ATMOST:2,RANGE:3};o.prototype.verify=function(a){this.satisfied=a>=this.lower&a<=this.upper,this.isDisabled=a>=this.upper},o.prototype.tostring=function(){return this.type==n.EXACTLY?"("+this.lower+")":["(",this.lower,"..",this.upper==Infinity?"*":this.upper,")"].join("")};var p={exactly:function(a){return a==0?new o(n.ATMOST,0,0,!0):new o(n.EXACTLY,a,a,!1)},times:function(a,b){return arguments.length==1?new o(n.EXACTLY,a,a,!1):a==0?new o(n.ATMOST,0,b,!0):new o(n.RANGE,a,b,!1)},atLeast:function(a){return new o(n.ATLEAST,a,Infinity,!1)},atMost:function(a){return new o(n.ATMOST,0,a,!0)}},q={ANYTHING:0,NOT:1,INSTANCEOF:2,SUPERSET:3,REGEX:4,ANYOF:5,ALLOF:6,CUSTOM:7,ERROR:8};r.prototype.assert=function(a){switch(this.type){case q.ANYTHING:return!0;case q.NOT:return!c(a,this.param);case q.INSTANCEOF:return a instanceof this.param;case q.SUPERSET:return c(a,this.param,!0);case q.REGEX:return this.param.test(a);case q.ANYOF:for(var b=0;b<this.param.length;b++)if(c(a,this.param[b]))return!0;return!1;case q.ALLOF:for(var b=0;b<this.param.length;b++)if(!c(a,this.param[b]))return!1;return!0;case q.CUSTOM:return this.param(a);case q.ERROR:var d=!0;return"name"in this.param&&(d=d&&this.param.name===a.name),"message"in this.param&&(d=d&&this.param.message===a.message),"type"in this.param&&(d=d&&c(a,this.param.type)),d}},r.prototype.tostring=function(){switch(this.type){case q.ANYTHING:return"is.anything";case q.NOT:return"is.not("+g(this.param)+")";case q.INSTANCEOF:return"is.instanceOf("+h(this.param)+")";case q.SUPERSET:return"is.objectThatIncludes("+g(this.param)+")";case q.REGEX:return"is.regex("+this.param.toString()+")";case q.ANYOF:return"is.anyOf("+g(this.param)+")";case q.ALLOF:return"is.allOf("+g(this.param)+")";case q.CUSTOM:return"is.custom(function)";case q.ERROR:return c(this.param,{})?"is.exception()":"is.exception("+g(this.param)+")"}};var s={anything:new r(q.ANYTHING),not:function(a){return new r(q.NOT,a)},instanceOf:function(a){if(typeof a!="function")throw new Error("Invalid argument to is.instanceOf() , argument must be a Class");return new r(q.INSTANCEOF,a)},objectThatIncludes:function(a){return new r(q.SUPERSET,a)},regex:function(a){if(a instanceof RegExp)return new r(q.REGEX,a);throw new Error("Invalid argument to is.regex() , argument must be regex")},anyOf:function(a){if(a instanceof Array)return new r(q.ANYOF,a);throw new Error("Invalid argument to is.anyOf() , argument must be an Array")},allOf:function(a){if(a instanceof Array)return new r(q.ALLOF,a);throw new Error("Invalid argument to is.allOf() , argument must be an Array")},custom:function(b){if(!a.isFunction(b))throw new Error("Invalid argument to is.custom() , argument must be a Function that returns a boolean value");return new r(q.CUSTOM,b)},exception:function(a){if(typeof a=="string")return new r(q.ERROR,{message:a});typeof a=="undefined"&&(a={});if(typeof a!="object")throw new Error("Invalid argument to is.exception() , argument must be an object or string");if("type"in a&&typeof a["type"]!="function")throw new Error("Invalid argument to is.exception() , the type attribute of the parameter must be a Class");return"type"in a&&(a.type=new r(q.INSTANCEOF,a.type)),new r(q.ERROR,a)}};return{assertThat:e,tostring:g,expectThatExceptionThrown:i,Mock:t,expect:p,is:s,addShortcut:u}}(a);window.jqMock=b})