define(["jQuery"],function(a){(function(a){function b(b,c,d){var e,f=a.extend({target:c,preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isPropagationStopped:function(){return!0},isImmediatePropagationStopped:function(){return!0},isDefaultPrevented:function(){return!0},bubbles:!0,cancelable:b!="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},d||{});return a.isFunction(document.createEvent)?(e=document.createEvent("MouseEvents"),e.initMouseEvent(b,f.bubbles,f.cancelable,f.view,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget||document.body.parentNode)):document.createEventObject&&(e=document.createEventObject(),a.extend(e,f),e.button={0:1,1:4,2:2}[e.button]||e.button),e}function c(a,b,c){return a.dispatchEvent?a.dispatchEvent(c):a.fireEvent&&a.fireEvent("on"+b,c),c}function d(b){var b=a(b),c=b.offset();return{x:c.left+b.outerWidth()/2,y:c.top+b.outerHeight()/2}}a.fn.simulateDragSortable=function(e){var f=a.extend({},a.fn.simulateDragSortable.defaults,e);return this.each(function(){var e=this,g=f.handle?a(this).find(f.handle)[0]:a(this)[0],h=f.listItem,i=f.placeHolder,j=a(this),k=Math.floor(f.move),l=k>0?"down":"up",m=0,n=0;if(k===0)return;while(k!==0)l==="down"?(j.next(h).length&&(j=j.next(h),m+=j.outerHeight()),k-=1):(j.prev(h).length&&(j=j.prev(h),m-=j.outerHeight()),k+=1);var o=d(g),p=Math.floor(o.x),q=Math.floor(o.y);c(g,"mousedown",b("mousedown",g,{clientX:p,clientY:q})),c(document,"mousemove",b("mousemove",document,{clientX:p+1,clientY:q+1})),i=i&&a(this).parent().find(i),i&&i.length?(m+=(l==="down"?-1:1)*Math.min(a(this).outerHeight()/2,5),n=(l==="down"?1:-1)*a(this).outerHeight()):l==="down"?(a(this).outerHeight()>a(j).outerHeight()&&(m+=a(this).outerHeight()-a(j).outerHeight()),m+=a(j).outerHeight()/2):m-=Math.min(a(this).outerHeight()/2,5);if(j[0]!==a(this)[0]){var r=m+n;for(var s=0;Math.abs(s)<Math.abs(r);s+=l==="down"?10:-10)c(document,"mousemove",b("mousemove",document,{clientX:p,clientY:q+s}));c(document,"mousemove",b("mousemove",document,{clientX:p,clientY:q+r}))}else window.console&&console.log("Could not move as at top or bottom already");setTimeout(function(){c(document,"mousemove",b("mousemove",document,{clientX:p,clientY:q+m}))},5),setTimeout(function(){c(g,"mouseup",b("mouseup",g,{clientX:p,clientY:q+m}))},10)})},a.fn.simulateDragSortable.defaults={move:0}})(a)})