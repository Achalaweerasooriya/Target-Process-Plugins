define(["jQuery"],function(jQuery){(function($){function a(a,b,c){var d,e=$.extend({target:b,preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isPropagationStopped:function(){return!0},isImmediatePropagationStopped:function(){return!0},isDefaultPrevented:function(){return!0},bubbles:!0,cancelable:a!="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},c||{});return $.isFunction(document.createEvent)?(d=document.createEvent("MouseEvents"),d.initMouseEvent(a,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget||document.body.parentNode)):document.createEventObject&&(d=document.createEventObject(),$.extend(d,e),d.button={0:1,1:4,2:2}[d.button]||d.button),d}function b(a,b,c){return a.dispatchEvent?a.dispatchEvent(c):a.fireEvent&&a.fireEvent("on"+b,c),c}function c(a){var a=$(a),b=a.offset();return{x:b.left+a.outerWidth()/2,y:b.top+a.outerHeight()/2}}$.fn.simulateDragSortable=function(d){var e=$.extend({},$.fn.simulateDragSortable.defaults,d);return this.each(function(){var d=this,f=e.handle?$(this).find(e.handle)[0]:$(this)[0],g=e.listItem,h=e.placeHolder,i=$(this),j=Math.floor(e.move),k=j>0?"down":"up",l=0,m=0;if(j===0)return;while(j!==0)k==="down"?(i.next(g).length&&(i=i.next(g),l+=i.outerHeight()),j-=1):(i.prev(g).length&&(i=i.prev(g),l-=i.outerHeight()),j+=1);var n=c(f),o=Math.floor(n.x),p=Math.floor(n.y);b(f,"mousedown",a("mousedown",f,{clientX:o,clientY:p})),b(document,"mousemove",a("mousemove",document,{clientX:o+1,clientY:p+1})),h=h&&$(this).parent().find(h),h&&h.length?(l+=(k==="down"?-1:1)*Math.min($(this).outerHeight()/2,5),m=(k==="down"?1:-1)*$(this).outerHeight()):k==="down"?($(this).outerHeight()>$(i).outerHeight()&&(l+=$(this).outerHeight()-$(i).outerHeight()),l+=$(i).outerHeight()/2):l-=Math.min($(this).outerHeight()/2,5);if(i[0]!==$(this)[0]){var q=l+m;for(var r=0;Math.abs(r)<Math.abs(q);r+=k==="down"?10:-10)b(document,"mousemove",a("mousemove",document,{clientX:o,clientY:p+r}));b(document,"mousemove",a("mousemove",document,{clientX:o,clientY:p+q}))}else window.console&&console.log("Could not move as at top or bottom already");setTimeout(function(){b(document,"mousemove",a("mousemove",document,{clientX:o,clientY:p+l}))},5),setTimeout(function(){b(f,"mouseup",a("mouseup",f,{clientX:o,clientY:p+l}))},10)})},$.fn.simulateDragSortable.defaults={move:0}})(jQuery)})