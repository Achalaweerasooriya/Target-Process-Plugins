define(["Underscore","tau/core/external"],function(_,a){var b=function(a){var b=a.split("/");if(b.length<2)return null;var c=b[0],d=b[1],e=d.length,f=_.without([d.indexOf("&"),d.indexOf("||"),e],-1),g=_.min(f),h=d.substring(0,g);return{id:h,type:c}};return{resolvePageInfo:function(c,d){var e=new a(c.win),f=e.getHashParam(c.appId,null),g=f||e.getHash(),h=b(g)||d;if(c.force&&!f){var i=["#",c.appId,"=",h.type,"/",h.id].join("");c.win.location.replace(i)}return h},getQueryParam:function(a,b){var c=a.indexOf(b+"=");if(c===-1)throw'Param "'+b+'" not found';c=c+b.length+1;var d=a.indexOf("&",c);d=d!==-1?d:a.length;var e=a.substring(c,d);return e}}})