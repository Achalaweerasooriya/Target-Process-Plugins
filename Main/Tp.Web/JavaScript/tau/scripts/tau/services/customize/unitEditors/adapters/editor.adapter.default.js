define(["require","Underscore","jQuery","tau/core/class","../editor.workflow"],function(e){var t=e("Underscore"),i=e("jQuery"),n=e("tau/core/class"),r=e("../editor.workflow");return n.extend({init:function(){this.editorSaving=t.Callbacks(),this.editorSaved=t.Callbacks(),this.editFinished=t.Callbacks(),this.cleanedUp=t.Callbacks()},adaptEditorData:function(e,i){return t.cloneDeep(i)},adaptComponentContext:function(e){return i.Deferred().resolve(e)},createEditableElement:function(e){return this._editableDeferred||(this._editorBus=e,this._editableDeferred=i.Deferred(),this._getEditable(this._editorBus,this._editableDeferred)),this._editableDeferred},startEdit:function(e,t){i.when(this._editableDeferred).then(function(i){this._initEditor(i,e,t)}.bind(this))},_getEditable:function(e,t){e.on("afterRender",function(e,i){t.resolve(i.element)})},_initEditor:function(e,t,i){t.tauBubble("adjust");var n=new r(t,this._editorBus,i,this);n.start()},_enableBubbleAdjustOnKeydown:function(e,i){i.on("keydown",t.throttle(function(){e.data("ui-tauBubble")&&e.tauBubble("adjust")},400))},_focusOnText:function(e){e.find(":text").focus(1)}})});