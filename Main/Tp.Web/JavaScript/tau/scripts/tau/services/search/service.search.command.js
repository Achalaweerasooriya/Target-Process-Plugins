define(["jQuery","Underscore","tau/core/class","tau/services/search/service.search.resultHandler"],function(e,t,i,n){var a=i.extend({init:function(e,t,i){this.configurator=e,this.params=t,this.$resultDeferred=i,this.searchResultHandler=new n},_fetchDetailsByIDs:function(i){var n=t.defaults(i.IndexProgressData||{},{CompleteInPercents:100}),a={info:{pageNo:this.params.pageNo,pageSize:this.params.pageSize,total:i.Total,indexProgress:n.CompleteInPercents},items:[]},r=e.Deferred();if(a.info.total>0){var s=i.AssignableIds,d=i.TestCaseIds,c=i.GeneralIds,o=i.ImpedimentIds,l=i.CommentIds,f=this.configurator.getStore();if(s.length){var m={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{entityState:["id","name","isFinal"]},{project:["id","name"]},{team:["id","name"]}],$query:{id:{$in:s}}};f=f.find("assignable",m)}if(d.length){var u={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{project:["id","name"]}],$query:{id:{$in:d}}};f=f.find("testcase",u)}if(c.length){var p={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{project:["id","name"]}],$query:{id:{$in:c}}};f=f.find("general",p)}if(o.length){var g={fields:["id","name","description","tags","createDate",{entityType:["id","name"]},{entityState:["id","name","isFinal"]},{project:["id","name"]}],$query:{id:{$in:o}}};f=f.find("impediment",g)}if(l.length){var h={fields:["id","description","createDate",{general:["id","name",{entityType:["id","name"]}]}],$query:{id:{$in:l}}};f=f.find("comment",h)}f.done({success:function(e){var i=[];t.each(e,function(e){i=i.concat(e.data)}),a.items=t.sortBy(i,function(e){return-1*e.id}),r.resolve(a)},failure:function(e){r.reject(e)}})}else r.resolve(a);return r},_done:function(e){this.searchResultHandler.handle(e,this.$resultDeferred,this.params.searchString)}});return a.allowsToBeFiltered=!1,a});