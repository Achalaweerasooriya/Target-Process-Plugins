define(["Underscore","jQuery","tau/core/class"],function(s,i,r){return r.extend({init:function(r,t){this.subscriptionIds=[],this.resourceProxy=t.get(r),this.aborted=i.Deferred(),this.resourceProxy.onStatus.progress(s.bind(function(i){var r=s.difference(this.subscriptionIds,i);r.length>0&&this.aborted.resolve()},this))},subscribe:function(i,r){var t=s.bind(function(s,i,r){this.subscriptionIds=s.union(this.subscriptionIds,r),i(this.subscriptionIds)},this,s,r);this.resourceProxy.subscribe(i,t)},unsubscribe:function(s){this.resourceProxy.unsubscribe(this.subscriptionIds,s),this.subscriptionIds=[]}})});