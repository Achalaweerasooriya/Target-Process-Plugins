define(["require","jQuery","Underscore","tau/core/class"],function(i){var t=i("jQuery"),e=i("Underscore"),n=i("tau/core/class");return n.extend({init:function(i){this._appStateStore=i,this.acidInitialized=t.Deferred(),this.acidChanged=e.Callbacks(),i.get({fields:["acid"],callback:function(i){this._setAcid(i.id,i.acid),this.acidInitialized.resolve()}.bind(this)}),i.bind({listener:this,fields:["acid"],callback:function(t){this._setAcid(i.settings.id,t.acid),this.acidChanged.fire(this.getCurrentAcid())}.bind(this)})},getIsAcidInitialized:function(){return"resolved"===this.acidInitialized.state()},getCurrentAcid:function(){return e.clone(this._lastAcidValue)},_setAcid:function(i,t){this._lastAcidValue={id:i,acid:t}},destroy:function(){this._appStateStore.unbind({listener:this})}})});