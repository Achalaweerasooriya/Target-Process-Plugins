define(["Underscore","jQuery","tau/core/class"],function(e,t,r){return r.extend({editProcessWorkflow:function(r,o,s,i){this._isProcessSetupEnabled(r)?this._triggerSetupProcess(r,i,e.map(s,function(e){return e.toLowerCase()})):(o.tauIFramePopup({url:r.getUrlBuilder().getAdminWorkflowEdit(i)}),o.on("tauiframepopupload",function(r,o){var i=t((o[0].contentDocument||o[0].contentWindow.document).body),n=i.find("._entities"),u=n.find("option").filter(function(r,o){var i=e.first(s)||"userstory";return t(o).attr("value").toLowerCase()=="tp.businessobjects."+i.toLowerCase()});n.val(u.attr("value")),n.trigger("change")}),o.tauIFramePopup("show"))},editProcess:function(e,r){this._isProcessSetupEnabled(e)?this._triggerSetupProcess(e,r):t("<i>").tauIFramePopup({url:e.getUrlBuilder().getAdminProcessEdit(r)}).tauIFramePopup("show").on("tauiframepopuphide",function(){t(this).remove()})},_triggerSetupProcess:function(e,t,r){e.getGlobalBus().fire("process.setup.start",{processId:t,entityTypes:r})},_isProcessSetupEnabled:function(e){return e.getFeaturesService().isEnabled("process.setup")}})});