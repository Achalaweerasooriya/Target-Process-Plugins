define(["Underscore","jQuery","tau/configurator"],function(_,$,a){$.widget("ui.listSelectable",{_create:function(){},_handler:function(a){},enable:function(b){b=_.defaults(b||{},{saveScroll:!1});if(this._enabled)return;this._enabled=!0;var c=this.element.parents(".ui-drop-down:first").find(".filter-field-wrapper :text");c.length&&c.focus();var d=this;this.reset(b);var e=function(a){return a++,a>=d._max&&(a=0),a},f=function(a){return a--,a<0&&(a=d._max-1),a},g=this.$items,h=this.options.className;a.getKeyBoardManager().pushHandler({handleKeyDown:function(a){var b=d._index;switch(a.keyCode){case $.ui.keyCode.DOWN:a.preventDefault(),b=e(b);break;case $.ui.keyCode.UP:a.preventDefault(),b=f(b);break;case $.ui.keyCode.ENTER:a.preventDefault();if(b<0)return;d.$items.eq(b).trigger("click");break;default:return}d._index=b,d.$items.removeClass(h),b>=0&&d.$items.eq(b).addClass(h),d.$list.animate({scrollTop:d._getOffset(b)},{duration:0})}})},_getOffset:function(a){var b=this.$items.eq(a);if(b.length==0)return 0;var c=this.$inner.position().top,d=b.position().top,e=b.parent("i-group");e.length&&(d+=e.position().top);var f=-c+d-this.$list.height()/2;return f},reset:function(a){a=_.defaults(a||{},{saveScroll:!1}),this.$items=this.element.find(this.options.items).filter(":visible");var b=this.element;this.$list=b,this.$inner=this.$list.find(this.options.inner||".i-inner"),a.saveScroll==0&&b.scrollTop(0);var c=b.height();this.step=this.$items.eq(0).height()*.5,this._index=-1,this._max=this.$items.length;var d=this.options.className;a.saveScroll==0&&this.$items.removeClass(d)},disable:function(){if(!this._enabled)return;this._enabled=!1,a.getKeyBoardManager().popHandler()},destroy:function(){this.disable()}})})