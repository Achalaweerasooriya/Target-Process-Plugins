define(["Underscore","jQuery","tau/configurator"],function(a,b,c){b.widget("ui.listSelectable",{_create:function(){},_handler:function(a){},enable:function(){if(this._enabled)return;this._enabled=!0;var a=this.element.parents(".ui-drop-down:first").find(".filter-field-wrapper :text");a.length&&a.focus();var d=this;this.reset();var e=function(a){return a++,a>=d._max&&(a=0),a},f=function(a){return a--,a<0&&(a=d._max-1),a},g=this.$items,h=this.options.className;c.getKeyBoardManager().pushHandler({handleKeyDown:function(a){var c=d._index;switch(a.keyCode){case b.ui.keyCode.DOWN:a.preventDefault(),c=e(c);break;case b.ui.keyCode.UP:a.preventDefault(),c=f(c);break;case b.ui.keyCode.ENTER:a.preventDefault();if(c<0)return;d.$items.eq(c).trigger("click")}d._index=c,d.$items.removeClass(h),c>=0&&d.$items.eq(c).addClass(h),d.$list.animate({scrollTop:d._getOffset(c)},{duration:0})}})},_getOffset:function(a){var b=this.$items.eq(a);if(b.length==0)return 0;var c=b.parents(".i-inner:first").position().top,d=b.position().top,e=b.parent("i-group");e.length&&(d+=e.position().top);var f=-c+d-this.$list.height()/2;return f},reset:function(){this.$items=this.element.find(this.options.items).filter(":visible");var a=this.element;this.$list=a,a.scrollTop(0);var b=a.height();this.step=this.$items.eq(0).height()*.5,this._index=-1,this._max=this.$items.length;var c=this.options.className;this.$items.removeClass(c)},disable:function(){if(!this._enabled)return;this._enabled=!1,c.getKeyBoardManager().popHandler()},destroy:function(){this.disable()}})})