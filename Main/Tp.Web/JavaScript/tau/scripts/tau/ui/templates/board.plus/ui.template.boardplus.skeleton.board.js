define(["Underscore","tau/core/templates-factory","tau/ui/extensions/board.plus/ui.board.plus.utils"],function(_,templates,BoardPlusUtils){var config={name:"boardplus.skeleton.board",engine:"jqote2",customFunctions:{generateId:BoardPlusUtils.generateId,generateCellData:BoardPlusUtils.generateElementData,hasAdditionalInfo:function(data,occurrence,key){return _.any(data,function(item){return key&&(item=item[key]),~occurrence.indexOf(item)})}},markup:["<% var hasX = !this.x.isNull; %>","<% var hasY = !this.y.isNull; %>",'<% var xcols = hasX ? this.x.data : [{x:"null"}]; %>','<% var yrows = hasY ? this.y.data : [{y:"null"}]; %>','<% var xColsAdditionalInfo = fn.hasAdditionalInfo(this.definition.x&&this.definition.x.types,["release","iteration","teamiteration"]); %>','<% var yRowsAdditionalInfo = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["release","iteration","teamiteration"]); %>','<% var yRowsUserAvatar = fn.hasAdditionalInfo(this.definition.y&&this.definition.y.types,["team"])&&!fn.hasAdditionalInfo(this.definition.cells&&this.definition.cells.types,["user"],"type"); %>','<% var additionalClasses = [" zoom-level-" + this.zoomLevel]; %>','<% !hasX && additionalClasses.push(" tau-no-cols"); %>','<% !hasY && additionalClasses.push(" tau-no-rows"); %>','<div class="tau-board-body <%=xColsAdditionalInfo?"additional-info_x":""%> <%=yRowsUserAvatar?"additional-info_avatar":""%> <%=yRowsAdditionalInfo?"additional-info_y":""%> ">',"<div class=\"tau-board-grid-view<%= additionalClasses.join('') %>\" ",'data-zoom-level="<%= this.zoomLevel%>"',">",'<div role="board-body" class="i-role-board-body">',"<% if (hasX && hasY) { %>",'<div class="tau-x-header">','<div class="tau-cell">','<div class="tau-collapser">','<button class="tau-h-collapser i-role-collapser"></button>',"</div>",'<div class="tau-label">',"<%= this.y.title %>"," / ","<%= this.x.title %>","</div>","</div>","</div>","<% } %>","<% if (hasY) { %>",'<div role="header" data-dimension="y" class="i-role-header tau-rows-header tau-header-<%= this.definition.y.types[0].toLowerCase() %>">',"<ul>","<% for (var i = 0; i < this.y.data.length; i++) { %>","<% var m = this.y.data[i]; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({y:m.y}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>","<% if (hasX) { %>",'<div role="header" data-dimension="x" class="i-role-header tau-cols-header tau-header-<%= this.definition.x.types[0].toLowerCase() %>">',"<ul>","<% for (var i = 0; i < this.x.data.length; i++) { %>","<% var m = this.x.data[i]; %>",'<li role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(m) %>" <%= fn.generateCellData({x:m.x}) %>>',"</div>","</li>","<% } %>","</ul>","</div>","<% } %>",'<div role="grid" class="i-role-grid tau-grid <% if (!hasX){ %>tau-grid_x_false<% } %> <% if (!hasY){ %>tau-grid_y_false<% } %>" id="grid_<%= _.uniqueId() %>">','<table cellpadding="0" cellspacing="0">',"<tbody>","<% for (var y = 0; y < yrows.length; y++) { %>","<tr>","<% for (var x = 0; x < xcols.length; x++) { %>","<% var coords = { x: xcols[x].x, y: yrows[y].y }; %>",'<td role="cellholder" class="i-role-cellholder tau-cellholder" id="ch_<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %> >','<div role="cell" class="i-role-cell tau-cell" id="<%= fn.generateId(coords) %>" <%= fn.generateCellData(coords) %>>',"</div>","</td>","<% } %>","</tr>","<% } %>","</tbody>","</table>","</div>","</div>","</div>","</div>"],dependencies:[]};return templates.register(config)})