define(["Underscore","tau/core/templates-factory","tau/ui/templates/board.cell.quick.add/ui.customFunctions.template.board.cell.quick.add","tau/components/workflow.selector/utils/workflow.utils","tau/ui/templates/board.context.selector/ui.template.board.context.selector.teams.list"],function(e,t,o,a){var i={name:"board.cell.item.quick.add.field.TeamMultiSelect",engine:"jqote2",customFunctions:e.defaults(o,{markTeamSelected:function(t,o){var a=e.find(t,function(e){return e.id===o.id});a&&(a.selected=!0,a.disabled=!0)},getWorkflowData:function(t){var o=e.chain(t.workflows).groupBy(function(e){return e.process.id}).map(function(o,i){return[i,{workflows:e.map(o,a.workflowMapper()),terms:e.chain(t.terms).filter(function(e){return e.process.id==i}).map(function(t){return e.pick(t,"value","wordKey")}).value()}]}).object().value();return{processes:o,groups:e.pluck(t.teams,"id"),defaultProcessId:t.defaultProcessId,resetOnProcessChange:!0}},getTeams:function(t,o){return t.options.workflows?e.map(t.options.teams,function(t){return e.extend(t,{customizableWorkflow:o})}):t.options.teams}}),markup:["<% if (this.field.options.teams.length > 0) { %>","<% var field = this.field; %>",'<div class="tau-field <%=(field.options.workflows && this.subWorkflowsEnabled)? "tau-new-entity-form__row--customizable": ""%>">','   <div class="tau-note tau-field-caption">Assign to Teams:</div>',"   <% if (field.options.selectedTeam && field.options.selectedTeam.id) { ","       fn.markTeamSelected(field.options.teams, field.options.selectedTeam);","   }%>",'   <div class="tau-category-settings-container">','      <div class="tau-teams tau tau-required-field-editor <%= field.id%>"              data-validate=\'{"caption":"<%= field.caption%>","rules":<%=fn.getValidationRules(field, ["teammultiselect"])%>}\' ','              data-fieldname="<%=field.id%>" data-fieldtype="<%=field.type%>">','             <ul name="<%= field.id%>" class="tau-category-items-selector i-role-list">','                 <%= fn.sub("board.context.selector.teams.list", fn.getTeams(field, this.subWorkflowsEnabled)) %>',"             </ul>","              <% if (field.options.workflows && this.subWorkflowsEnabled) { %>","                  <span runas=\"workflow.selector\" data-name=\"team.workflow.selector\" data-context:general='' data-uniquename='workflow.selector' data-name='workflow.selector'","                      data-data='<%=JSON.stringify(fn.getWorkflowData(field.options))%>'/>","              <% } %>","      </div>","   </div>","</div>","<% } %>"]};
return t.register(i)});