define(["Underscore","jQuery","tau/core/termProcessor"],function(_,$,TermProcessor){return $.extend($.tmpl.tag,{term:{_default:{$1:"'type'",$2:"null"},open:["var $__t = $item;","while($__t.parent && !$__t.$tau){","$__t = $__t.parent","}","_=_.concat($__t.$tau.terms($2)[$1]);"].join("")}}),{register:function(cfg,templateOptionsRef){var terms=cfg.context?cfg.context.getTerms():[];templateOptionsRef.$tau=templateOptionsRef.$tau||{};var termProc=new TermProcessor(terms);templateOptionsRef.$tau.terms=function(entityType){return termProc.getTerms(entityType)}}}})