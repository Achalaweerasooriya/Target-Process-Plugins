define(["jQuery","Underscore","tau/core/extension.base","tau/const/testCaseRun.status"],function(t,e,n,s){return n.extend({"bus beforeInit":function(t,e){var n=e.config;this.store=n.store,this.entity=n.context.entity},"bus afterRender":function(e,n){var i=n.element,a=i.find(".i-role-results");a.on("click",".tau-btn",function(e){var n=t(e.target),i=s.notRun;n.hasClass("tau-checked")||(i=n.data("result")),this.fire("testCaseRun.status.selected",i)}.bind(this)),n.data.isTestPlanRunStateFinal?a.find(".tau-btn").prop("disabled",!0):this._monitorState(a)},_setState:function(t,e){var n=t.find(this._getButtonSelector(e));n.siblings(".tau-btn").removeClass("tau-checked"),n.addClass("tau-checked")},_resetState:function(t){t.find(".tau-btn").removeClass("tau-checked")},_getButtonSelector:function(t){return"[data-result="+t.toLowerCase()+"]"},_monitorState:function(t){this.store.unbind(this),this.store.on({eventName:"afterSave",type:this.entity.entityType.name,listener:this,hasChanges:["status"],filter:{id:this.entity.id}},function(e){var n=e.data.changes;s.isNotRun(n.status)?this._resetState(t):this._setState(t,n.status)}.bind(this))},"bus afterRender > destroy":function(){this.store.unbind(this)}})});