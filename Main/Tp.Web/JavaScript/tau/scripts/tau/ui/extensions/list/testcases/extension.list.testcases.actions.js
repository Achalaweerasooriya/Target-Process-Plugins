define(["Underscore","tau/ui/extensions/list/collapse/extension.list.actions.collapse","tau/const/testCaseRun.status"],function(t,e,i){return e.extend({"bus prioritize.start":function(){var t=this.$el.find(".ui-richeditor:visible");t.length&&t.prev().richeditor("hideEditor")},"bus preDataBind":function(t){var e=t.data;e.labelAdd=this.config.labelAdd||"Add"},"bus testCaseWasAdded":function(){this.fire("evictTestCases")},"bus evictTestCases":function(){var t=this.config.context.entity;this.config.context.configurator.getStore().evictProperties(t.id,t.entityType.name,["testCases","testCases-count"]),this.fire("refresh")},"bus afterRender":function(e,s){this._super(e,s);var n=s.element;this.$el=n;var a=this,o=this.config.context.configurator.getStore(),r=function(t,e){o.save("testcase",{id:t.id,$set:{lastRunStatus:e,lastFailureComment:null},fields:["id","lastRunStatus","lastRunDate"]}).done({success:function(){}})},l=t.bind(this.addTestCaseClickHandler,this);n.delegate("[role=action-add]","click",function(t){t.preventDefault(),t.stopPropagation(),l(t)}),n.delegate("[role=action-pass]","click",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).parents("[role=item]:first"),s=e.data("tmplItem").data;r(s,i.passed),a._toggle(e,!1);var n=e.next("[role=item]");n.length&&a._toggle(n,!0)}),n.delegate("[role=action-fail]","click",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).parents("[role=item]:first"),s=e.data("tmplItem").data;r(s,i.failed),a._toggle(e,!1);var n=e.next("[role=item]");n.length&&a._toggle(n,!0)})},addTestCaseClickHandler:function(t){this.bus.fire("action.add",{originalEvent:t,entity:this.config.context.entity})}})});