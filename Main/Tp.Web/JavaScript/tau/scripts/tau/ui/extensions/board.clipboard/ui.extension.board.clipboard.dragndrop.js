define(["jQuery","tau/core/extension.base"],function($,ExtensionBase){return ExtensionBase.extend({"bus configurator.ready + $sortable.ready":function(evt,configurator,$sortable){configurator.getGlobalBus().on("isPrioritizable.ready",function(e,isPrioritizable){$sortable.tauSortable("option","moveInGroup",isPrioritizable)})},"bus $el.ready+$selectable.ready+view.dom.ready":function(ev,$el,$selectable,dom){var self=this,$sortable=$el,$containment=$el.parents("[role=main]:first");$sortable.tauSortable({groups:".tau-boardclipboard__holder, .i-role-grid .i-role-cellholder",items:".i-role-card",appendTo:$sortable,containment:$containment,addClasses:!1,useSelectable:$selectable,connectedSortable:".i-role-grid",processToGroup:function($item,$fromGroup,$toGroup){var $targetPlace=$toGroup;$toGroup.is(".i-role-cellholder")&&($targetPlace=$toGroup.children(".i-role-cell")),$targetPlace.data("isempty",!0),$item.appendTo($targetPlace);var countChildren=$targetPlace.children().size();countChildren-=1,countChildren&&$targetPlace.data("isempty",!1)}}),$sortable.bind("tausortablestart",function(event,ui){ui.helper&&ui.helper.find(".i-role-card").removeClass("i-role-card"),ui.items.removeClass("i-role-card"),self.fire("sort.started",[event,ui])}),$sortable.bind("tausortablegroupentered",function(event,ui){self.fire("sort.groupentered",[event,ui])}),$sortable.bind("tausortablegroupleft",function(event,ui){self.fire("sort.groupleft",[event,ui])}),$sortable.bind("tausortablestop",function(event,ui){ui.items.addClass("i-role-card"),self.fire("sort.stopped",[event,ui])}),self.fire("$sortable.ready",$sortable)},"bus $selectable.ready:last+$holder.ready:last+sort.stopped":function(ev,$selectable,$holder,sortData){var event=sortData[0],ui=sortData[1],$group=$(ui.group),self=this;if($group.is($holder))return;var $all=$(ui.items);self.fire("$cards.drag.stop",$all)},"bus $sortable.ready:last+sort.groupentered":function(ev,$sortable,sortData){var ui=sortData[1],$group=ui.group,$helper=ui.helper,$parent=$sortable;$group.parents(".i-role-grid").length&&($parent=$group.parents(".i-role-grid")),$(ui.item).data("draggable").scrollParent=$parent,$(ui.item).data("draggable").overflowOffset=$parent.offset()}})})