define(["require","Underscore","jQuery","tau/core/extension.base.stateful","tau/ui/extensions/board.plus/ui.board.plus.utils","tau/ui/templates/board.plus/ui.template.boardplus.skeleton","tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton","tau/ui/templates/board.plus/customized/ui.template.boardplus.cell.grid.skeleton.customized"],function(e){var t=e("Underscore"),l=e("jQuery"),a=e("tau/core/extension.base.stateful"),i=e("tau/ui/extensions/board.plus/ui.board.plus.utils"),n=e("tau/ui/templates/board.plus/ui.template.boardplus.skeleton"),o=e("tau/ui/templates/board.plus/ui.template.boardplus.cell.axis.skeleton"),u=e("tau/ui/templates/board.plus/customized/ui.template.boardplus.cell.grid.skeleton.customized"),s=a.extend({name:"view.board.plus","bus view.build.skeleton":function(e){i.resetCardIds();var t=e.data;this.fire("template.bind",{template:n,data:t})},getCoords:function(e){var t={};return e.hasAttribute("data-x")&&(t.x=e.getAttribute("data-x")),e.hasAttribute("data-y")&&(t.y=e.getAttribute("data-y")),t},bound:function(e){var l=e.data.element;this.fire("view.skeleton.built",{element:l});var a=l.find(".i-role-cell");this.fire("view.cellSlot.built.start",{cells:a}),t.each(a,function(e){this.fire("view.cellSlot.built",{element:e,data:this.getCoords(e),id:e.id})},this),this.fire("view.cellSlot.built.end",{cells:a})},"bus template.boardplus.skeleton.bound":function(e){this.bound(e)},"bus template.boardplus.skeleton.customized.bound":function(e){this.bound(e)},createFireBindTemplateHandler:function(){return t.bind(function(e){this.fire("template.bind",e)},this)},buildCellSkeleton:function(e,t,a){l.when(this.getCellTemplateConfig(e,t,a)).then(this.createFireBindTemplateHandler())},"bus configurator.ready:last + cardLayoutFactory.ready:last + view.build.cell.skeleton + view.skeleton.built:last":function(e,t,l,a,i){this.buildCellSkeleton(t,l,a,i)},buildAxisSkeleton:function(e,t,a){l.when(this.getAxisTemplateConfig(e,t,a)).then(this.createFireBindTemplateHandler())
},"bus configurator.ready:last + cardLayoutFactory.ready:last + view.build.axis.skeleton + view.skeleton.built:last":function(e,t,l,a,i){this.buildAxisSkeleton(t,l,a,i)},getAxisTemplateConfig:function(e,t,l){return{template:o,data:i.convertCellAxisData(l)}},getCellTemplateConfig:function(e,a,i){var n=l.Deferred();return a.getLayoutFactory().done(function(l){var a=t.extend({getLayout:l,configurator:e},i);n.resolve({template:u,data:a})}),n},getCellElement:function(e,t){var l=i.generateId(e);return t.find("#"+l)},appendCellToBoardSkeleton:function(e,t){var l=e.data,a=e.element,i=this.getCellElement(l,t),n={cell:i,content:a};this.fire("view.cell.skeleton.element.beforeUpdate",n),i.append(a),this.fire("view.cell.skeleton.element.afterUpdate",n),this.fireCellSkeletonBuilt({element:i,data:l})},fireCellSkeletonBuilt:function(e){this.fire("view.cell.skeleton.built",e)},"bus view.skeleton.built:last + template.boardplus.cell.grid.skeleton.customized.bound":function(e){var t=e["view.skeleton.built"].data.element,l=e["template.boardplus.cell.grid.skeleton.customized.bound"].data;this.appendCellToBoardSkeleton(l,t)},"bus view.skeleton.built:last+template.boardplus.cell.axis.skeleton.bound":function(e){var t=e["view.skeleton.built"].data.element,l=e["template.boardplus.cell.axis.skeleton.bound"].data;this.appendCellToBoardSkeleton(l,t)},"bus view.cell.skeleton.built":function(e){var t=this,a=e.data,i=a.data,n=i.hasOwnProperty("x"),o=i.hasOwnProperty("y");if(n&&o){var u=a.element;u.find(".i-role-card").each(function(){var e=l(this);t.fire("view.card.skeleton.built",{element:e,data:{id:e.attr("data-id"),type:e.attr("data-type")}})})}}});return s});