define(["jQuery","tau/components/extensions/component.extension.base"],function($,a){return a.extend({"bus afterRender":function(a){this.$selectedCards=$()},"bus view.card.selected":function(a){var b=a.data.element;a.data.selected?this.$selectedCards=this.$selectedCards.add(b):this.$selectedCards=this.$selectedCards.not(b)},"bus view.card.drag.start":function(a){var b=a.data.helper,c=a.data.element;this.$selectedCards=this.$selectedCards.add(c),c.toggleClass("tau-selected",!0);var d=this.$selectedCards;d.each(function(){var a=$(this),b=a.parent();a.data("prevPosition",{cardId:a.prev().attr("id"),cellId:b.attr("id"),sourceData:{x:b.data("x")||null,y:b.data("y")||null}})}),d.length>1&&(b.attr("data-batch_count",d.length+""),b.addClass("tau-drag-helper_batch"),d.not(c).detach())},"bus view.card.drag.stop":function(a){var b=a.data.element,c=this.$selectedCards;c.length>1&&c.not(b).insertAfter(b).show(),b.removeAttr("data-batch_count"),b.removeClass("tau-drag-helper_batch");var d=this;c.each(function(){d.fire("view.card.selected",{element:$(this),selected:!1})}),c.addClass("tau-highlighted"),c.draggable("disable");var e=[],f=b.parents(".i-role-cell:first").data();f={x:f.x,y:f.y},c.each(function(){var a=$(this);e.push({entityId:a.data("id"),elementId:a.attr("id"),cellData:f,sourceData:b.data("prevPosition").sourceData})}),this.fire("view.card.batch.move",e),this.$selectedCards=$()},"bus afterRender:last+view.card.batch.move.after:last":function(a){var b=_.values(a)[0].data.element,c=_.values(a)[1].data||{};_.forEach(c,function(a){var c=b.find("#"+a.elementId);c.draggable("enable").removeClass("tau-highlighted");if(!a.success){var d=c.data("prevPosition")||{};d.cardId?c.insertAfter("#"+d.cardId):d.cellId&&c.appendTo("#"+d.cellId)}})}})})