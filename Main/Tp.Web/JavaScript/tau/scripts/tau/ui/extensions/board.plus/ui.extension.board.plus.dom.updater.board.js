define(["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function($,_,ExtensionBase){return ExtensionBase.extend({"bus view.skeleton.built":function(evt){var $element=evt.data.element;$element.children().css({opacity:0})},"bus page.ready > page.changed":function(evt){var from=_.values(evt)[0].data,to=_.values(evt)[1].data,direction=this.getDirection(from,to);this.fire("refresh",{page:{from:from,to:to,direction:direction}})},"bus refresh > board.element.updated":function(evt){var refreshData=evt.refresh.data||{},elementsData=evt["board.element.updated"].data,$oldElement=elementsData.oldElement,$newElement=elementsData.newElement,parent=$oldElement.parent();parent.append($newElement),refreshData.page&&refreshData.page.direction?this.fire("page.appended",{prev:$oldElement,next:$newElement,data:refreshData.page}):this.fire("board.reload",{prev:$oldElement,next:$newElement})},"bus board.element.updated > refresh":function(evt,data){data.oldElement.hide().remove()},"bus afterRender:last > refresh":function(evt,data,refreshData){if(refreshData&&refreshData.page&&refreshData.page.direction)return;data.element.addClass("tau-board-becomes-old")},"bus board.reload > no.data.in.slice":function(evt,data){var $oldElement=data.prev;$oldElement.hide().removeClass("tau-board-becomes-old").replaceWith(data.next)},"bus board.reload > overview.board.ready > board.size.updated":function(evt,data){var $oldElement=data.prev;$oldElement.hide().removeClass("tau-board-becomes-old").replaceWith(data.next)},"bus page.appended > overview.board.ready > board.size.updated":function(evt){var pages=_.values(evt)[0].data,$oldElement=pages.prev,$newElement=pages.next;this.swap($oldElement,$newElement,pages.data.direction)},swap:function($oldBoard,$newBoard,direction){var controlProperty=this.directionToProperty(direction),animationProperties={};$(".tau-grid",$oldBoard).css("overflow","hidden"),$(".tau-grid",$newBoard).css("overflow","hidden"),animationProperties[controlProperty]="+=100%",$newBoard.css(controlProperty,"-100%"),$newBoard.children().css("opacity","1"),$oldBoard.add($newBoard).animate(animationProperties,{duration:750,complete:function(){$newBoard.css(controlProperty,""),$(".tau-grid",$newBoard).css({overflowY:"scroll",overflowX:"auto"}),setTimeout(function(){$oldBoard.remove()},50)}})},"bus refresh > overview.board.ready > board.size.updated":function(evt){var $element=evt["overview.board.ready"].data.element,refreshData=evt.refresh.data||{};(!refreshData.page||!refreshData.page.direction)&&$element.children().animate({opacity:1})},"bus initialize > overview.board.ready > board.size.updated":function(evt){var $element=evt["overview.board.ready"].data.element;$element.children().animate({opacity:1})},getDirection:function(pageFrom,pageTo){var direction=null;return pageFrom.x==pageTo.x?pageFrom.y-pageTo.y==1?direction="up":pageFrom.y-pageTo.y==-1&&(direction="down"):pageFrom.y==pageTo.y&&(pageFrom.x-pageTo.x==1?direction="left":pageFrom.x-pageTo.x==-1&&(direction="right")),direction},directionToProperty:function(direction){return{up:"top",down:"bottom",left:"left",right:"right"}[direction]}})})