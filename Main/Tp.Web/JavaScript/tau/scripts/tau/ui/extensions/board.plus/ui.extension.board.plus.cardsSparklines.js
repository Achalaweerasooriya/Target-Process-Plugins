define(["jQuery","tau/core/extension.base","tau/libs/working-queue","tau/libs/sparklines/sparklines","Underscore"],function(e,i,n,r,t){function a(i){var n={width:100,height:50,letterWidth:9,letterHeight:9},t=new r(n);t.draw(null,i),e(i).parent().removeClass(s)}var s="tau-sparkline-loading";return i.extend({init:function(){this.sparklineDrawQueue=new n({interval:150,iterator:a}),this._super.apply(this,arguments)},"bus showHint":function(e,i){var n=i.$card.find(".i-role-sparkline");n.each(function(){a(this)})},"bus overview.board.ready:last + cardsFullyLoaded":function(i,n,r){if(r.isRunAdditionalAction){this.sparklineDrawQueue.clean();var a=n.element;t.each(a.find(".i-role-card"),function(i){var n=e(i).find(".i-role-sparkline");n.children().length||this._pushToDrawingQueue(n)},this)}},"bus overview.board.ready:last + operation.execute.done":function(e,i){var n=i.element,r=this._extractEmptySparkline(n);this._pushToDrawingQueue(r)},"bus overview.board.ready:last + view.card.batch.move.finished":function(e,i){var n=i.element,r=this._extractEmptySparkline(n);this._pushToDrawingQueue(r)},_extractEmptySparkline:function(e){return e.find(".i-role-card .i-role-sparkline:empty")},_pushToDrawingQueue:function(e){var i=this;e.parent().addClass(s),e.each(function(){i.sparklineDrawQueue.push(this)})}})});