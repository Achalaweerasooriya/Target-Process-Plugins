define(["Underscore","jQuery","tau/ui/extensions/board.plus/layout/ui.board.plus.layout","tau/ui/extensions/board.plus/layout/size.calculator-timeline"],function(e,t,i,l){return i.extend({init:function(){this._super(l),this.scrollKeeperClass="i-role-scroll-keeper",this.scrollKeeperSelector="."+this.scrollKeeperClass},getFixedColumnSize:function(e){var t=this._super(e),i=this.isColumnCollapsed(e);if(!t&&!i){var l=this.getBacklogColumnId();if(l&&e==l)return 2}return t},iteratorUpdateCell:function(e){e.data.x===this.getBacklogColumnId()&&this._super(e)},beforeRowsHeightRecalculation:function(){var e=this.$el.find(".tau-timeline-flow");this.$el.find(this.scrollKeeperSelector).remove(),t("<div></div>").addClass(this.scrollKeeperClass).css({height:e[0].scrollHeight,position:"absolute",width:"1px"}).prependTo(e)},afterRowsHeightRecalculation:function(){this.lastRowHeightCalculation(),this.$el.find(this.scrollKeeperSelector).remove()},lastRowHeightCalculation:function(){var e=this.$el.find(".tau-timeline-canvas"),t=this.$el.find(".tau-timeline-flow"),i=t.last().offset(),l=this.$el.find(".footer-pillow"),o=l.last().offset(),s=e.outerHeight(),r=this.$el.find(".i-role-cell").last(),a=r.find(".i-role-cell-planner");if(o.top-i.top<s){var n=s-(o.top-i.top);a.height(n+r.outerHeight()),l.height(n)}else a.css("height",""),l.height(0)},calculateColumnWidth:function(e){var t=this.sizeCalculator.calculateWidth({col:e,getCardWidth:this._getCardWidthByColumn.bind(this),zoomLevel:this.getCurrentZoomLevel()});return t+this.scrollWidth},getBacklogColumnId:e.memoize(function(){var t=e.find(this.headerCells,function(e){return e.data.isbacklog});return t.data.x})})});