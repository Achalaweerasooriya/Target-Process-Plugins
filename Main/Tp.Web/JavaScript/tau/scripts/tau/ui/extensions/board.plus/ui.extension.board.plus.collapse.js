define(["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/extensions/board.plus/ui.board.plus.utils"],function($,_,ExtensionBase,boardUtils){return ExtensionBase.extend({"bus afterRender":function(evt){var $el=evt.data.element,self=this,$header=$el.find(".i-role-header"),$grid=$el.find(".i-role-grid");$header.delegate(".i-role-collapser","click",function(e){var $cell=$(this).parents(".i-role-cellholder:first"),dimension=self.getCellDimension($cell),id=$cell.attr("data-"+dimension);self.fire("view.axis.collapser.executed.before"),self.toggleCollapsing($grid,$cell,dimension),self.fire("view.axis.collapser.executed.after");var action=$cell.hasClass("tau-collapsed")?"collapse":"expand";self.fire("board.save.header.collapsing.settings",{id:id,dimension:dimension,setting:action})}),$el.find(".tau-x-header .i-role-collapser").click(function(){var $header=$(this);self.toggleHeaderCollapsing($header),self.fire("view.axis.collapser.executed.after");var action=$header.hasClass("tau-collapsed")?"collapse":"expand";self.fire("board.save.header.collapsing.settings",{id:0,dimension:"axisY",setting:action})})},toggleHeaderCollapsing:function($header){$header.toggleClass("tau-collapsed").closest(".tau-board-grid-view").toggleClass("rows-h-collapsed")},toggleCollapsing:function($grid,$headerCell,dimension){var collapsed1="tau-collapsed",collapsed2="tau-collapsed_"+dimension;$headerCell.toggleClass(collapsed1+" "+collapsed2);var $cells=boardUtils.dimension($grid,$headerCell);$cells.toggleClass(collapsed2).each(function(){var $cell=$(this),realCollapsed=$cell.hasClass("tau-collapsed_x")||$cell.hasClass("tau-collapsed_y");$cell.toggleClass(collapsed1,realCollapsed)})},"bus afterRender + view.collapsed.axis":function(evt,renderData,collapsedData){var $el=renderData.element,self=this,settings=collapsedData,$grid=$el.find(".i-role-grid"),$headerCells=$el.find(".i-role-header .i-role-cellholder");$headerCells.each(function(){var $headerCell=$(this),dimension=self.getCellDimension($headerCell),id=$headerCell.attr("data-"+dimension),shouldBeCollapsed=_.contains(settings[dimension],id);shouldBeCollapsed&&self.toggleCollapsing($grid,$headerCell,dimension)});var $header=$el.find(".tau-x-header .i-role-collapser"),shouldBeCollapsed=_.contains(settings.axisY,0);$header.length&&shouldBeCollapsed&&self.toggleHeaderCollapsing($header),self.fire("view.axis.collapser.executed.after")},"bus view.cell.skeleton.element.afterUpdate":function(evt,update){var cell=update.cell,moreCollapsed=cell.find(".more-collapsed");moreCollapsed.length||(moreCollapsed=$('<span class="more-collapsed">&#8230;</span>')),cell.find(".i-role-card:last").after(moreCollapsed)},getCellDimension:function($cell){return $cell.attr("data-x")?"x":"y"}})})