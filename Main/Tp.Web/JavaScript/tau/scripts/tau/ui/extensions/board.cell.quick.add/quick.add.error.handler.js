define(["Underscore"],function(e){var s=function(s,t){for(var n=s;n.InnerException;)n=n.InnerException;return e.isUndefined(n)||"Tp.BusinessObjects.InvalidLicenseException"!==n.Type?!1:(a(n.Message,t),!0)},t=function(s,t,a,n){if(!(s.Details&&s.Details.ServerErrorCodes&&e.contains(s.Details.ServerErrorCodes,"ProjectNotAssignedToTeam")))return!1;var r=n.getStore(),i=$('<div class="tau-message tau-danger">'+s.Message+' <a class="i-role-assign-team-to-project" href="#">Assign</a></div>'),o=s.InnerException.Details.Suggest,c=e.findWhere(o,{id:"project"}).value,d=e.findWhere(o,{id:"team"}).value;return i.find("a").on("click",function(){r.save("teamProject",{$set:{project:{id:c},team:{id:d}},fields:["id","project","team"]}).done({success:function(e){var s=e[0].data.team.name,a=e[0].data.project.name,n=$('<div class="tau-message tau-success"> Success! The '+s+" team is now assigned to the "+a+" project.</div>");t.setText(n)}})}),t.setText(i),!0},a=function(e,s){var t=$('<div class="tau-message tau-danger">Error: '+e+"</div>");s.setText(t)};return{handle:function(e,n,r,i){s(e,r)||t(e,r,n,i)||a(e.Message,r)}}});