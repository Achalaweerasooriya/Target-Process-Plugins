define(["require","tau/core/extension.base","jQuery"],function(e){var t=e("tau/core/extension.base"),s=e("jQuery");return t.extend({category:"edit","bus afterRender":function(e,t){var i=t.element;i.sortable({items:".i-role-teststep[data-id]",appendTo:i,distance:5,axis:"y",placeholder:this._createPlaceholder(),opacity:.8,cancel:'[contentEditable="true"]',cursor:"move",start:function(e,t){var n=s(document.activeElement);n.is(".i-role-editable")&&n.blur(),this._toggleClassesOnDnD(i,t.item)}.bind(this),stop:function(e,t){this._toggleClassesOnDnD(i,t.item),t.item.css("zIndex","")}.bind(this),update:function(e,t){this.fire("test.step.order.changed",{teststep:t.item})}.bind(this)})},_createPlaceholder:function(){return{element:function(){var e=s('<div class="test-case-description_rows i-role-teststep tau-sortable__placeholder-inner">Reordering</div>');return e},update:function(e,t){var s=e.currentItem,i=s.height();t.width(s.width()),t.height(i),t.css("line-height",i+"px")}}},_toggleClassesOnDnD:function(e,t){this._toggleListClass(e),this._toggleListItemClass(t)},_toggleListClass:function(e){e.toggleClass("tau-teststep-reordering")},_toggleListItemClass:function(e){e.toggleClass("tau-teststep-draggable")}})});