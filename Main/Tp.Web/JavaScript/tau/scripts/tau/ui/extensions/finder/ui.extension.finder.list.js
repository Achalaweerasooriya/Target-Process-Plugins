define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/finder/ui.template.finder.resultList"],function(_,$,a,b){return a.extend({appendData:function(a,c){var d=this;d.getShowMoreElement(a).hide();var e=b.get().bind(d.config,c),f=c.emptyMessage||"";d._setNoResultsMessage(a,f);var g=$(".tau-result-list>tbody>tr",e);g.appendTo($(".ui-resultList>table>tbody",a)),d.bus.fire("dataRendered",{element:a})},_setScrollingMode:function(a,b){this.getList(a).data("noScrolling",!b)},_setNoResultsMessage:function(a,b){var c=$(".tau-no-results",a);c.text(b),b===""||_.isNull(b)||_.isUndefined(b)?c.hide():c.show()},"bus elementReady+dataLoaded":function(a){var b=a.elementReady.data.element,c=a.dataLoaded.data.data;this.appendData(b,c)},"bus dataRendered+nextPageAvailable":function(a){var b=a.dataRendered.data.element;this._setScrollingMode(b,!0)},"bus search+dataLoaded":function(a){var b=this,c=a.search.data.element;this.bus.fire("elementReady",{element:c})},"bus loadMore+dataLoaded":function(a){var b=this,c=a.loadMore.data.element;this.bus.fire("elementReady",{element:c})},getList:function(a){return $(".ui-resultList",a)},attachScrollingEvents:function(a){var b=this,c=b.getList(a).scroll(function(d){c.data("noScrolling")!=1&&c.scrollTop()+c.innerHeight()>=c[0].scrollHeight&&b.bus.fire("scrollToEnd",{element:a})})},"bus search":function(a){var b=a.data.element;$(".tau-result-list>tbody",b).html(""),this.getShowMoreElement(b).show(),this._setNoResultsMessage(b,""),this._setScrollingMode(b,!1);var c=this.getList(b);c.prop({scrollTop:c.get(0).scrollHeight})},_signUpOnActionsAndSelection:function(a){var b=this;b.getList(a).click(function(a){var c=$(a.target).parents("tr.tau-result-list-row:first");if(!c.data)return;var d=c.data();if(!d)return;if(!d.tmplItem)return;d=d.tmplItem.data;if(!d)return;b.bus.fire("entitySelected",{entity:d})}),$(".action-link",a).click(function(){var a=$(this).data().tmplItem.data;a.fn.call(b)})},"bus afterRender":function(a){var b=a.data.element,c=this;c.bus.fire("elementReady",{element:b}),c.attachScrollingEvents(b),c._setScrollingMode(b,!1),this._signUpOnActionsAndSelection(b)},getShowMoreElement:function(a){return $(".tau-resultList-load-more",a)},"bus scrollToEnd+nextPageAvailable":function(a){var b=this,c=a.scrollToEnd.data.element,d=b.getList(c);b._setScrollingMode(c,!1),b.getShowMoreElement(c).show(),d.prop({scrollTop:d.get(0).scrollHeight}),b.bus.fire("loadMore",{element:c})}})})