define(["jQuery","Underscore","tau/core/extension.base","tau/core/bus"],function(e,t,o){return o.extend({"bus initialize":function(t,o){var i=o.context.configurator,s=e("body"),n=i.service("errorBar");n.on("error",function(e){this.showError(s,e.data)},this),n.on("notification",function(e){this.showNotification(s,e.data)},this),n.on("clearError",function(e){this.clearError(s,e.data)},this),this.fire("$notified.ready",s),this.on("destroy",function(){n.removeAllListeners(this),s=null}.bind(this))},"bus $notified.ready:last + clearError":function(e,t,o){this.clearError(t,o)},"bus $notified.ready:last + error":function(e,t,o){this.showError(t,o)},"bus $notified.ready:last + notification":function(e,t,o){this.showNotification(t,o)},clearError:function(e,t){e.notifyBar("remove",t)},showError:function(e,o){this.notify({id:o.id,type:o.type||"error",message:t.isString(o)?o:o.message||"Error",details:o.details,$node:o.$node,delay:o.delay,disableAutoClose:o.disableAutoClose===!0,button:o.button},e)},showNotification:function(e,t){this.notify({id:t.id,type:t.type,message:t.message,$node:t.$node,delay:t.delay,disableAutoClose:t.disableAutoClose===!0,button:t.button},e)},notify:function(o,i){if(!o.$node&&(o.$node=e('<div class="tau-system-message-body-inner"></div>'),o.$node.append("<h3>"+t.asString(o.message)+"</h3>"),o.details)){var s=e("<p></p>").append(o.details);o.$node.append(s)}var n=o.type||"success",r="success"===n,a=o.disableAutoClose,d=r?5e3:o.delay||1e5;r&&void 0===a&&(a=!1),i.notifyBar({id:o.id,className:"tau-system-message-"+n,$node:o.$node,delay:d,disableAutoClose:a,button:o.button})}})});