define(["Underscore","tau/core/extension.base","tau/ui/behaviour/tags/ui.behaviour.tagsEditor"],function(_,ExtensionBase){return ExtensionBase.extend({category:"edit","bus afterRender":function(evt,renderData){var $el=renderData.element;this.fire("$el.ready",$el);var self=this,$editor=$el.find(".i-role-editor");$editor.tagsEditor({validation:{trim:!0},onSave:function(tags){$editor.addClass("data-saving"),self.fire("form.submitted",{tags:tags})}}),$editor.bind("tagseditorshow",_.bind(this.fire,this,"$editor.shown",$editor)),this.fire("$editor.ready",$editor)},"bus tagsProcessor.ready:last + $editor.ready:last + external.toggleTag":function(evt,processor,$editor,tag){$editor.tagsEditor("showEditor");var $text=$editor.find(":text"),tags=processor.asArray($text.val());tag.checked?tags.push(tag.text):tags=_.without(tags,tag.text);var v=processor.asString(tags);v.length?$text.val(v):$editor.tagsEditor("hideEditor")}})})