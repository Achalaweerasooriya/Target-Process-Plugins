define(["Underscore","jQuery","tau/core/extension.base"],function(e,t,o){return o.extend({init:function(t,o){this._super(t),this._selectorBusName=o,this._configuratorReadyCallbacks=e.Callbacks(),this._configuratorReadyCallbacks.once(this._onConfiguratorReady.bind(this))},resetLifecycle:!0,"bus initialize":function(){this.activeTab="selector"},"bus beforeInit":function(e,t){var o=t.config.context.configurator;this.fire("configurator.ready",o)},"bus show":function(){"selector"!=this.activeTab?this.fire("tab.activate","selector"):this.fire("tab.activate.completed","selector")},"bus $el.ready":function(e,t){var o=this;t.on("click",".i-role-section-teams .i-role-formtrigger",function(){o.fire("tab.activate","team.formAdd")}),t.on("click",".i-role-section-projects .i-role-formtrigger",function(){o.fire("tab.activate","project.formAdd")}),t.on("click",".i-role-section-projects .i-role-add-program-trigger",function(){o.fire("tab.activate","program.formAdd")}),t.on("click","[type=reset]",function(){o.fire("tab.activate","selector")})},"bus configurator.ready":function(e,t){this._configuratorReadyCallbacks.fire(t)},_onConfiguratorReady:function(e){e.getComponentBusRegistry().getByName("team_form_add").done(function(e){this.fire("teamFormAddBus.ready",e),e.on("entity.add.completed",this._backToMainTab.bind(this))}.bind(this)),e.getComponentBusRegistry().getByName("project_form_add").done(function(e){this.fire("projectFormAddBus.ready",e),e.on("entity.add.completed",this._backToMainTab.bind(this))}.bind(this)),e.getComponentBusRegistry().getByName("board_selector_add-program").done(function(e){this.fire("programFormAddBus.ready",e),e.on("afterRender",function(){setTimeout(e.fire.bind(e,"show.completed"),10)}),e.on("program.add.completed",function(e,t){this._backToMainTab(),this.fire("program.add.completed",t)}.bind(this))}.bind(this)),e.getComponentBusRegistry().getByName(this._selectorBusName).done(function(e){this.fire("selectorBus.ready",e),this.on("program.add.completed",function(t,o){e.fire("program.add.completed",o)
})}.bind(this))},_backToMainTab:function(){this.fire("tab.activate","selector")},"bus $bubbled.ready:last + $el.ready:last + childrenBuses.ready:last + tab.activate":function(o,i,r,a,s){t("body").data("contextOverflow",t("body").css("overflow")),t("body").css("overflow","hidden"),r.css("visibility","hidden"),r.css("overflow","hidden"),r.css("width",r.width()+"px"),r.css("height",r.height()+"px");var c;e.forEach(a,function(e,t){t!=s?e.fire("hide"):c=e}),c&&(c.once("show.completed",function(e,o){o.length&&(r.css("width","auto"),r.css("height","auto"),r.css("overflow","visible")),i.tauBubble("adjust"),r.css("visibility","visible"),t("body").css("overflow",t("body").data("contextOverflow"))},this),c.fire("show"),this.fire("tab.activate.completed",s),this.activeTab=s)},"bus teamFormAddBus.ready:last + tab.activate.completed":function(e,t,o){"team.formAdd"==o&&t.fire("show.completed")},"bus projectFormAddBus.ready:last + tab.activate.completed":function(e,t,o){"project.formAdd"==o&&t.fire("show.completed")},"bus programFormAddBus.ready:last + tab.activate.completed":function(e,t,o){"program.formAdd"==o&&t.fire("show.completed")}})});