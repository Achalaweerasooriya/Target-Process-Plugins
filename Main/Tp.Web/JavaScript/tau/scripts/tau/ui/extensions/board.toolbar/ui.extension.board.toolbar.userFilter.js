define(["Underscore","jQuery","tau/ui/extensions/board.editor/ui.extension.board.editor.autocomplete","tau/ui/extensions/board.plus/ui.board.plus.utils","libs/jquery/jquery.placeholder","libs/jquery/jquery.tau.resetableInput","libs/jquery/jquery.toggleFilter"],function(e,t,i){return i.extend({SHORT_PLACEHOLDER:"filter off","bus afterRender":function(e,t){var i=t.element,l=i.find(".i-role-filter-input");this.defaultPlaceholder=l.attr("placeholder"),l.attr("placeholder",this.SHORT_PLACEHOLDER),l.tauResetableInput({showAlways:!0}).placeholder(),i.find(".i-role-filter-control").toggleFilter({additionalClass:"tau-boardsettings__filter_hide-toggle",defaultExpand:!0}),this.fire("$form.ready",i),this.fire("$el.ready",i)},"bus $el.ready":function(e,i){var l=this.$filter=i.find("[name=cells_filter]");this.$filterControl=i.find(".i-role-filter-control"),l.on("focus",function(){this.fire("preloading.execute"),this.expandFilter()}.bind(this)),l.on("_change clear",function(){var e=l.val();this.updateFilterState(e),this.fire("user.filter.changed",e)}.bind(this)),i.on("keydown","[name=cells_filter]",function(e){e.which==t.ui.keyCode.ENTER&&t(e.target).blur(),(e.which==t.ui.keyCode.ENTER||e.which==t.ui.keyCode.TAB)&&this.shrinkFilter()}.bind(this)),this.updateFilterState()},"bus cell.types + afterRender:last + view.dom.ready:last":function(e,i,l){t("[name=cells_filter]",l.element).prop("disabled",0===i.length),t(".i-role-help",l.element).prop("disabled",0===i.length)},expandFilter:function(){this.$filterControl.addClass("active"),this.$filter.attr("placeholder",this.defaultPlaceholder),t(document).off("mousedown.expandFilter").on("mousedown.expandFilter",e.bind(this.onDocumentClick,this))},shrinkFilter:function(){this.$filterControl.removeClass("active"),this.$filter.attr("placeholder",this.SHORT_PLACEHOLDER),t(document).off("mousedown.expandFilter")},onDocumentClick:function(e){t.contains(this.$filterControl[0],e.target)||t(e.target).closest(".filter-help,.tau-bubble-tooltipArticle,.tau-autocomplete__menu").length||this.shrinkFilter()},updateFilterState:function(e){e=e||this.$filter.val()||"",this.$filter.toggleClass("full tau-extension-board-tooltip",!!e).data("title",e)}})});