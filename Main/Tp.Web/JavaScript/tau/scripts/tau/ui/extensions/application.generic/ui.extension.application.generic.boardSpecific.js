define(["Underscore","jQuery","tau/core/extension.base","tau/configurations/definitions/board.definition.factory","tau/services/boards/view.types"],function(e,t,i,r,o){return i.extend({"bus configurator.ready":function(e,t){t.getBoardDefinitionFactory=function(){return this.boardDefinitionFactory=this.boardDefinitionFactory||new r(t),this.boardDefinitionFactory}},"bus afterRender":function(t,i){this.initializeFeedback(),this.processBody(i.element).done(e.bind(function(e){this.fire("view.dom.ready",{element:e})},this))},"bus configurator.ready + application.exit":function(e,t){this.fire("initProgress"),t.getRouting().redirect(t.getUrlBuilder().getDashboardUrl())},"bus configurator.ready:last > application.navigate > controller.postExecute":function(e,t,i){var r=i.requestArgs||{},n=function(e){this.fire("boardSettings.ready",{boardSettings:e})}.bind(this),a=o.isKnownViewType(r.entity);if(a){var s=r.id;this._processViewSettings(s,r.entity,t).done(n)}else{var c=this._createDefaultBoardSettings("none",t);c.markFieldsRetrieved(this._getDefaultBoardFields()),c.settings.viewMode="list",n(c)}},"bus controller.app.host:last + controller.app.page:last + boardSettings.ready":function(t,i,r,o){e.forEach([i,r],function(e){e.fire("boardSettings.ready",o)})},processBody:function(e){t(":root").addClass("tau-app-frame");var i=t("body").prepend(e);return t.Deferred().resolve(i)},_processViewSettings:function(e,i,r){var o=t.Deferred(),n=r.getBoardDefinitionFactory().createDefault(i);r.setBoardSettingsOptions(n);var a=r.getBoardSettingsFactory().create(e);return a.get({fields:this._getDefaultBoardFields(),callback:function(){o.resolve(a)}}),o},_createDefaultBoardSettings:function(e,t){var i=t.getBoardDefinitionFactory().createDefault();return t.setBoardSettingsOptions(i),t.getBoardSettingsFactory().create(e)},_getDefaultBoardFields:function(){return["name","x","y","cells","viewMode","zoomLevel","collapse","focus","itemType"]},initializeFeedback:function(){var e=document.createElement("script");
e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"widget.uservoice.com/rywvig4l55Tifwaw7wk3Ag.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}})});