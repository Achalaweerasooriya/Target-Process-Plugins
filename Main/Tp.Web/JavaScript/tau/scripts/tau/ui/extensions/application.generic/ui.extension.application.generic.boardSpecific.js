define(["Underscore","jQuery","tau/core/extension.base","tau/configurations/definitions/board.definition.factory"],function(e,t,r,i){return r.extend({"bus configurator.ready":function(e,t){t.getBoardDefinitionFactory=function(){return this.boardDefinitionFactory=this.boardDefinitionFactory||new i(t),this.boardDefinitionFactory}},"bus afterRender":function(t,r){this.initializeFeedback(),this.processBody(r.element).done(e.bind(function(e){this.fire("view.dom.ready",{element:e})},this))},"bus configurator.ready + application.exit":function(e,t){this.fire("initProgress"),t.getRouting().redirect(t.getUrlBuilder().getDashboardUrl())},"bus configurator.ready:last + application.navigate + controller.postExecute":function(e,t,r){var i=r.requestArgs||{},o=function(e){this.fire("boardSettings.ready",{boardSettings:e})}.bind(this),n="board"==i.entity;if(n){var a=i.id;this.processBoardSettings(a,t).done(o)}else{var s=this._createDefaultBoardSettings("none",t);s.markFieldsRetrieved(this._getDefaultBoardFields()),s.settings.viewMode="list",o(s)}},"bus controller.app.host:last + controller.app.page:last + boardSettings.ready":function(t,r,i,o){e.forEach([r,i],function(e){e.fire("boardSettings.ready",o)})},processBody:function(e){var r=t.Deferred();t(":root").addClass("tau-app-frame");var i=t("body");return i.prepend(e),r.resolve(i),r},processBoardSettings:function(e,r){var i=t.Deferred(),o=r.getBoardDefinitionFactory().createDefault();r.setBoardSettingsOptions(o);var n=r.getBoardSettingsFactory().create(e);return n.get({fields:this._getDefaultBoardFields(),callback:function(){i.resolve(n)}}),i},_createDefaultBoardSettings:function(e,t){var r=t.getBoardDefinitionFactory().createDefault();return t.setBoardSettingsOptions(r),t.getBoardSettingsFactory().create(e)},_getDefaultBoardFields:function(){return["name","x","y","cells","viewMode","zoomLevel","collapse","focus"]},initializeFeedback:function(){!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"widget.uservoice.com/rywvig4l55Tifwaw7wk3Ag.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}})});