define(["Underscore","tau/core/extension.base"],function(_,ExtensionBase){return ExtensionBase.extend({category:"edit","bus beforeInit":function(evt,initConfig){this.fire("configurator.ready",initConfig.config.context.configurator)},"bus afterRender":function(evt,renderData){this.fire("$el.ready",renderData.element)},"bus configurator.ready":function(evt,configurator){configurator.getComponentBusRegistry().getByName("tagsCloud").done(_.bind(function(bus){bus.removeAllListeners(this),bus.on("tag.toggled",_.bind(function(evt,tag){this.fire("tagsCloudTag.toggled",tag)},this),this),this.fire("tagsCloudBus.ready",bus)},this))},"bus componentsCreated":function(evt,componentsData){var buses=_.pluck(componentsData,"component"),tagsBus=buses[0],tagsCloudContainerBus=buses[1];this.fire("tagsBus.ready",tagsBus),this.fire("tagsCloudContainerBus.ready",tagsCloudContainerBus)},"bus $el.ready:last + tagsCloudContainerBus.ready":function(evt,$el,tagCloudContainerBus){var self=this;$el.on("click",".i-role-action-cloud",function(){$(this).toggleClass("tau-active"),$el.find(".i-role-tagscloudcontainer").toggleClass("tau-active"),self.cloudVisible||(self.cloudVisible=!0,tagCloudContainerBus.fire("refresh",{visible:!0}))})},"bus $el.ready:last + tagsBus.ready":function(evt,$el,tagsBus){var $tabheader=$el.find(".i-role-tabheader").detach().removeAttr("hidden");this.fire("$tabheader.ready",$tabheader),$el.find(".i-role-editor").append($tabheader),tagsBus.on("afterRender",function(el,renderData){$el.find(".i-role-editor").append($tabheader)}),$el.on("click",".i-role-editor :submit",function(){$el.find(".i-role-action-cloud").toggleClass("tau-active",!1),$el.find(".i-role-tagscloudcontainer").toggleClass("tau-active",!1)})},"bus tagsCloudBus.ready + tagsBus.ready":function(evt,tagsCloudBus,tagsBus){tagsCloudBus.removeAllListeners(this),tagsCloudBus.on("tag.toggled",_.bind(function(evt,tag){tagsBus.fire("external.toggleTag",tag)},this),this),tagsCloudBus.on("afterRender",_.bind(function(evt,renderData){this.fire("$cloudEl.ready",renderData.element)},this),this)},"bus $el.ready:last + $cloudEl.ready":function(evt,$el,$cloudEl){var hasFilter=$cloudEl.find("[name=filter]").length>0,$link=$el.find(".i-role-action-cloud");$link.toggleClass("tau-tags-cloud__trigger_filter_true",hasFilter)}})})