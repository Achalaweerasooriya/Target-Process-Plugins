define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor","tau/ui/extensions/comment/mention.ckeditor.plugin"],function(t,e,i,n,o){var r=i.extend({category:"edit","bus afterRender":function(t){this.element=t.data.element,this.initializeEditor()},onSave:function(t){this.fire("editorSave"),this.fire("saveComment",{description:t}),this.closeEditor()},onCancel:function(){this.closeEditor()},closeEditor:function(){this.fire("destroy")},initializeEditor:function(){var i=this.element,n=i,r=n.find(".ui-comment-text"),a="richeditor";if(!r.data("ui-richeditor")){var c=this.config.context.configurator;r=r[a]({ckPath:this.config.context.configurator.getCkPath(),text:"",settings:{toolbar:"Basic",removePlugins:"autogrow,magicline",allowedContent:!0,MentionPlugin:o.getMentionPlugin({configurator:c}),height:200},executionGroupName:"comments",onSave:t.bind(this.onSave,this),onCancel:t.bind(this.onCancel,this),onCreate:t.bind(function(){var t=i.parents(".ui-popup-content:first");0===t.length&&(t=e(window)),t.scrollTo(r.parent(),100),this.fire("$editor.ready",r),this.fire("$editorHolder.ready",n)},this),saveAction:{text:"Add comment",disableIfEmpty:!0},cancelAction:{available:!0}})}r[a]("show")}});return r});