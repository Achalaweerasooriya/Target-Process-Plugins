define(["tau/components/extensions/component.extension.base"],function(t){return t.extend({"bus beforeInit":function(t){var e=this.config=t.data.config;if(e.hasOwnProperty("stateName")){var n=e[e.stateName];if(_.isNull(n)||_.isUndefined(n))return;var i="true"==n.toString().toLowerCase();e.collapsed=i,this.collapsed=i}},getStateName:function(){return this.config.stateName},onStateChanged:function(t){var e=t[this.getStateName()];(_.isNull(e)||_.isUndefined(e))&&(e=this.collapsed);var n="true"==e.toString().toLowerCase(),i=n?"collapse":"expand",a=this.config;a.collapsed=n;var s=a.stateName;s&&(a[s]=n),this.fire(i)},"bus childrenRendered":function(t){var e=t.data.children,n=e[0];n.on("expanded",this.onExpanded,this),n.on("collapsed",this.onCollapsed,this)},onCollapsed:function(){this.saveState(!0)},onExpanded:function(){this.saveState(!1)},saveState:function(t){var e=this.getStateName();if(e&&this.config[e]!=t){var n=this,i=n.config.context.componentSettings;if(i){var a={};a[e]=t,i.set({set:a})}}},destroy:function(){var t=this,e=t.config.context.componentSettings;e&&e.unbind({listener:t}),this._super()},"bus initialize":function(){var t=this,e=t.config.context.componentSettings;e&&e.bind({fields:[this.getStateName()],listener:t,callback:t.onStateChanged})}})});