define(["Underscore","jQuery","tau/utils/utils.textsearch","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(_,$,TextSearch,ExtensionBase){var stateListEditable=ExtensionBase.extend({"bus afterRender":function(evtArgs,renderData){var $el=renderData.element;config.filter&&realStatesLength>3&&(this.filterField=$("<input type='text' class='filter-field' />").keyup($.proxy(this._filterDelegate,this)),$("<div class='filter-field-wrapper'></div>").append(this.filterField).insertBefore(this.$list))},_filterDelegate:function(evt){if(evt.keyCode==jQuery.ui.keyCode.DOWN||evt.keyCode==jQuery.ui.keyCode.UP||evt.keyCode==jQuery.ui.keyCode.ENTER||evt.keyCode==jQuery.ui.keyCode.ESCAPE)return;if(!this.searchIndex){var data=[];this.searchIndex=new TextSearch,this.$options.each(function(key,item){data.push({_id:key,data:$(item).text()}),$(this).data("text",$(item).text())}),this.searchIndex.load(data)}var searchText=this.filterField.val(),result=this.searchIndex.search(searchText);this.$options.hide();var $options=this.$options;_.forEach(result,function(item){var $option=$options.eq(item._id),text=$option.data("text")+"";text=text.substr(0,item.entry.from)+"<em>"+text.substr(item.entry.from,item.entry.len)+"</em>"+text.substr(item.entry.from+item.entry.len,text.length),$option.html(text),$option.show(),$option.parent().show()}),$options.filter(":hidden").parent().not($options.filter(":visible").parent()).hide(),searchText.length?result.length==0?this._noResults(searchText):this._clearNoResults():(this._clearNoResults(),this._resetList()),this.$list.listSelectable("reset")}});return stateListEditable})