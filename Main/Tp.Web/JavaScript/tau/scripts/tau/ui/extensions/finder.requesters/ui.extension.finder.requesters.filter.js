define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,ExtensionBase){return ExtensionBase.extend({"bus afterRender":function(evt){var $element=evt.data.element,$filterForm=$element.find("[role=filter]"),$inputs=$filterForm.find(":input"),$buttons=$filterForm.find(":button"),self=this;this.state="clear",$buttons.prop("disabled","disabled"),$buttons.addClass("disable"),$inputs.bind("change keyup",function(){self.state="dirty",$buttons.prop("disabled",!1),$buttons.removeClass("disable")});var _search=function(action){var data={};$inputs.each(function(){var $input=$(this),val=_.trim($input.val());data[$input.attr("name")]=val}),data.action=action,self.bus.fire("search.parametersBound",{parameters:data})};$inputs.bind("keydown",function(e){switch(e.keyCode){case $.ui.keyCode.ENTER:_search("search"),e.stopPropagation(),e.preventDefault();break;case $.ui.keyCode.DOWN:$(this).is("input")?$(this).blur():(e.stopPropagation(),e.preventDefault())}}),$buttons.eq(0).click(function(){_search($(this).val())}),$buttons.eq(1).click(function(){var data={};$inputs.each(function(){var $input=$(this);$input.val(null);var val=_.trim($input.val());data[$input.attr("name")]=val}),data.action=$(this).val(),self.bus.fire("search.parametersBound",{parameters:data}),$buttons.prop("disabled","disabled"),$buttons.addClass("disable"),$inputs.filter("[data-autofocus]").focus()});var $companyWidget=$inputs.filter("[name=companyId]"),$typeWidget=$inputs.filter("[name=type]"),dep=function(){$typeWidget.val()=="User"?($companyWidget.val(null),$companyWidget.prop("disabled","disabled")):$companyWidget.prop("disabled",!1)};dep(),$typeWidget.on("change",dep)}})})