define(["Underscore","jQuery","tau/core/extension.base","tau/configurations/const.page.entity.actions"],function(e,t,a,n){return a.extend({"bus configurator.ready":function(t,a){var n=this,r=a.getRequireLoader();r(["all.components"],function(){r(["tau/components/component.application"],function(t){var r=a.createChild();r._id=e.uniqueId("board_entityViewer_"),r.isBoardEdition=!0,a.getHashService().onHashChange(function(){n.fire("hash.changed")}),n.fire("appData.ready",{component:t,configurator:r})})})},"bus afterRender":function(){var e=t("body");e.tauProgressIndicator(),this.fire("$progressIndicator.ready",e)},"bus appData.ready":function(e,t){var a=t.configurator,n=t.component;a.getHashService().setFakeWindow();var r=this,o={name:"viewer",context:{configurator:a},options:{applicationId:"boardEntityViewerPopup",integration:{showInCoverView:!0,keepAlive:!0},routing:{silent:!0,executeOnStart:!1},comet:{enabled:!0}}},i=n.create(o);i.on("application.error",function(e){r.fire("error",e.data),r.fire("application.error",e.data)}),i.on("contentRendered",function(e){r.fire("application.contentRendered",e.data)}),i.initialize(o),r.fire("appBus.ready",i)},"bus appData.ready:last + appBus.ready:last + cardDataToShowSilent.ready":function(e,t,a,r){this.showCard(t,a,r,n.SILENT)},"bus appData.ready:last + appBus.ready:last + cardDataToShow.ready":function(e,t,a,n){this.showCard(t,a,n)},"bus appBus.ready:last + hash.changed":function(e,t){t.fire("popup.close")},"bus appBus.error":function(e,t){this.fire("error",t)},"bus appBus.ready + destroy":function(e,t){t.destroy()},showCard:function(e,t,a,n){var r=e.configurator;return a.entityId&&a.entityType?(this.cleanupStore(r),t.fire("history.reset"),void t.fire("application.navigate.entity",{id:a.entityId,entity:a.entityType,action:n})):void console.error("bad data for viewer",a)},cleanupStore:function(e){e.getStore().evictData()}})});