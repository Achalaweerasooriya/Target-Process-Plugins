define(["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/templates/board.editor/ui.template.board.editor.filterHelp","tp/codemirror/lib/codemirror","tp/codemirror.stylesheet","tp/codemirror/lib/util/runmode","tp/codemirror/mode/python/python"],function(e,t,n,i,r){return n.extend({"bus content.ready:last + refresh.help.content":function(e,n,r){var o=this,l=i.get();t.each(n,function(e){t.each(r,function(t,n){var i=e.find("[role="+n+"_help]");if(i.length){var r=l.bind({},{name:"rebind",predefinedFilters:t});i.find("table").remove(),i.append(r.find("table")),o.fire("content.$element.ready",i.parent())}})})},"bus afterRender:last + content.$element.ready":function(e,t,n){var i=n.find(".i-role-complex-filter-example"),r=n.find(".filter-help").attr("role")+"_button",o=t.element.find("."+r);o.toggle(i.length>0)},"bus afterRender":function(e){var n=e.data.element.find(".i-role-help"),i=t.map(n,this._initHelp.bind(this));this.fire("content.ready",i)},"bus content.$element.ready:last + destroy":function(e,t){t.off("click.helpfilter"),t=null},_initHelp:function(t){var n=e(t),i=n.parents(".i-role-filter:first").find(":text"),r=n.next(".i-role-help-content");return r.on("click.helpfilter",".i-role-predefined-filter",function(){var t=e(this).data("value");n.tauBubble("hide"),i.focus(),setTimeout(function(){i.val(t)},1)}),this.fire("content.$element.ready",r),this._initHelpBubble(n,r),r},_initHelpBubble:function(t,n){t.tauBubble({className:"i-role-taububble-ignore",content:n,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),onResize:function(e,t){var n=t.height;e.find("[role=content]").css({maxHeight:n-20,overflowY:"auto"})},onShow:function(t){this.element.toggleClass("tau-checked",!0),t.find(".i-role-output-filter").each(function(){var t=e(this);t.data("processed")||(r.runMode(t.text(),"python",this),t.data("processed",!0))
})},onHide:function(){this.element.toggleClass("tau-checked",!1)}})}})});