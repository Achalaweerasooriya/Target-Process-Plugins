define(["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/ui/templates/board.editor/ui.template.board.editor.filterHelp","libs/aceEditor/aceEditor"],function(e,t,n,i,o){return n.extend({"bus content.ready:last + refresh.help.content":function(e,n,o){var r=this,a=i.get();t.each(n,function(e){t.each(o,function(t,n){var i=e.find("[role="+n+"_help]");if(i.length){var o=a.bind({},{name:"rebind",predefinedFilters:t});i.find("table").remove(),i.append(o.find("table")),r.fire("content.$element.ready",i.parent())}})})},"bus afterRender:last + content.$element.ready":function(e,t,n){var i=n.find(".i-role-complex-filter-example"),o=n.find(".filter-help").attr("role")+"_button",r=t.element.find("."+o);r.toggle(i.length>0)},"bus afterRender":function(e){var n=e.data.element.find(".i-role-help"),i=t.map(n,this._initHelp.bind(this));this.fire("content.ready",i)},"bus content.$element.ready:last + destroy":function(e,t){t.off("click.helpfilter"),t=null},_initHelp:function(t){var n=e(t),i=n.parents(".i-role-filter:first").find(":text"),o=n.next(".i-role-help-content");return o.on("click.helpfilter",".i-role-predefined-filter",function(){var t=e(this).data("value");n.tauBubble("hide"),i.focus(),setTimeout(function(){i.val(t)},1)}),this.fire("content.$element.ready",o),this._initHelpBubble(n,o),o},_initHelpBubble:function(t,n){var i=this.bus;t.tauBubble({className:"i-role-taububble-ignore",content:n,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),onResize:function(e,t){var n=t.height;e.find("[role=content]").css({maxHeight:n-20,overflowY:"auto"})},onShow:function(t){this.element.toggleClass("tau-checked",!0),t.find(".i-role-output-filter").each(function(t,n){var r=e(n);r.data("processed")||(r.data("processed",!0),this._maxWidth=r.width()>(this._maxWidth||0)?r.width():this._maxWidth,o.setEditor(r,i,{mode:"ace/mode/python",readOnly:!0,showGutter:!1}))
}.bind(this)),t.find(".i-role-output-filter").each(function(t,n){e(n).width(this._maxWidth+.2*this._maxWidth)}.bind(this))},onHide:function(){this.element.toggleClass("tau-checked",!1)}})}})});