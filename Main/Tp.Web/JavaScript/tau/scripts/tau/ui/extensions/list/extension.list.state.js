define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(a,b,c,d){return c.extend({name:"extension.list.state",initialState:{},"bus preDataBind":function(b){var c=b.data,e=d.getRouting().getStateParameter("list")||{},f=this;a.forEach(c.groups,function(b){var c=(new String(b.key)).toString();f.initialState[c]=b.collapsed,a.isUndefined(e[c])==0&&(b.collapsed=e[c])})},"bus afterInit+afterRender":function(a){this.$el=a.afterRender.data.element},"bus toggled":function(c){var e=this.$el.find("[role=group]"),f={},g=this;e.each(function(){var c=b(this),d=c.hasClass("tau-list__group_collapsed_true"),e=c.data("tmplItem").data,h=(new String(e.key)).toString();a.isUndefined(g.initialState[h])==0&&g.initialState[h]!==d&&(f[h]=d)}),d.getRouting().setStateParameter("list",f,!0),d.getHistory().updateCurrent({url:d.getRouting().getUrl().source})}})})