define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(t,e,n){return n.extend({name:"extension.list.state",initialState:{},"bus beforeInit":function(){},"bus preDataBind":function(e){var n=e.data,a=this.stateManager=this.config.context.componentSettings||this.config.context.configurator.getStateManager(),i={};a.get({id:"list",fields:["state"],callback:function(t){i=t.state||{}}});var s=this;t.forEach(n.groups,function(e){var n=t.asString(e.key);s.initialState[n]=e.collapsed,t.isUndefined(i[n])||(e.collapsed=i[n])})},"bus afterInit+afterRender":function(t){this.$el=t.afterRender.data.element},"bus toggled":function(){var n=this.$el.find("[role=group]"),a={},i=this;n.each(function(){var n=e(this),s=n.hasClass("tau-list__group_collapsed_true"),o=n.data("tmplItem").data,r=t.asString(o.key);t.isUndefined(i.initialState[r])||i.initialState[r]===s||(a[r]=s)});{var s=this.stateManager;this.config.context.configurator}s.set({id:"list",set:{state:a},callback:function(){}})}})});