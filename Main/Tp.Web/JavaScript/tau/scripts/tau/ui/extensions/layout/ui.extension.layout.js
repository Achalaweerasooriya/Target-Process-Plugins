define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,n,t){return t.extend({"bus afterRender + existLazyChildren":function(n,t){var i=e.defaults(this.config.spinnerConfigForLazy||{},{delay:500,isShow:!1,height:10,selectorForHeight:null});i.isShow&&this.setSpinnerForLazyContainer(t.element,i)},setSpinnerForLazyContainer:function(e,t){function i(){clearTimeout(o),r.reject()}e.tauProgressIndicator();var r=n.Deferred();r.done(function(e){e.data("ui-tauProgressIndicator")&&e.tauProgressIndicator("hide")});var o=setTimeout(function(){if("pending"===r.state()&&e.data("ui-tauProgressIndicator")){var n=t.selectorForHeight&&e.closest(t.selectorForHeight).height()||t.height;e.css({height:n}),e.tauProgressIndicator("show")}},t.delay);this.bus.on("refresh",i),this.bus.on("destroy",i),this.bus.on("childrenRenderedLazy",function(){e.css({height:""}),r.resolve(e)})},appendChildren:function(n,t,i){var r=this;r.element=t.element;var o=n.childrenEvtArgs;r.config.layout=r.config.layout||"list";var l=r.config,a=["_add",l.layout,"item"].join(" ");l.childrenContainerSelector=l.childrenContainerSelector||("list"===l.layout?null:"> tbody > tr"),e.each(o,function(e){var n=e.element,t={element:n,data:e};r.fire("append.child.element",t),r[a](t.element,e.view?e.view.config:{})}),r.element&&(t.element=r.element),!i&&this.fire("$children.rendered",this.element)},"bus childrenRendered + afterRender":function(e,n,t){this.appendChildren(n,t,!1)},"bus childrenRenderedLazy + afterRender":function(e,n,t){this.appendChildren(n,t,!0)},"_add list item":function(e){var n=e.jquery?e:e.element,t=this.config.childrenContainerSelector?this.element.find(this.config.childrenContainerSelector):this.element;t.append(n)},getTableItemContainer:function(){var e=this,t=e.config,i=e.element.find(t.childrenContainerSelector+":last");if(t.hasOwnProperty("columnCount")){var r=i.children("td").size();r>=t.columnCount&&(i=n("<tr></tr>"),e.element.children("tbody").append(i))}return i},"_add table item":function(e){var t=this,i=e.jquery?e:e.element,r=t.config,o=this.getTableItemContainer(),l=o.children("td").length,a=r.cellsCssClass&&r.cellsCssClass[l]||"";n("<td></td>").addClass(a).append(i).appendTo(o)},"_add selectable item":function(e,n){var t=this.element,i=n.selector||"[role=main]",r=t.filter(i);0==r.length&&(r=t.find(i)),0==r.length?(console.log(t),console.error('No element for selector "'+i+'"')):r.eq(0).append(e)},"_add replaceable item":function(e){var n=e.jquery?e:e.element,t=this.element;t.parent().length?t.replaceWith(n):this.element=n}})});