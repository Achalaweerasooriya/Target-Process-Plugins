define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,t,n){return n.extend({"bus afterRender + existLazyChildren":function(t,n){var i=e.defaults(this.config.spinnerConfigForLazy||{},{delay:500,isShow:!1,height:10,selectorForHeight:null});i.isShow&&this.setSpinnerForLazyContainer(n.element,i)},setSpinnerForLazyContainer:function(e,n){function i(){clearTimeout(s),r.reject()}e.tauProgressIndicator();var r=t.Deferred();r.done(function(e){e.data("ui-tauProgressIndicator")&&e.tauProgressIndicator("hide")});var s=setTimeout(function(){if("pending"===r.state()&&e.data("ui-tauProgressIndicator")){var t=n.selectorForHeight&&e.closest(n.selectorForHeight).height()||n.height;e.css({height:t}),e.tauProgressIndicator("show")}},n.delay);this.bus.on("refresh",i),this.bus.on("destroy",i),this.bus.on("childrenRenderedLazy",function(){e.css({height:""}),r.resolve(e)})},appendChildren:function(t,n,i){this.element=n.element;var r=t.childrenEvtArgs,s=this.config;s.layout=s.layout||"list";var o=["_add",s.layout,"item"].join(" ");s.childrenContainerSelector=s.childrenContainerSelector||("list"===s.layout?null:"> tbody > tr"),e.each(r,function(e){var t={element:e.element,data:e};this.fire("append.child.element",t),this[o](t.element,e.view?e.view.config:{})},this),this.element&&(n.element=this.element),i||this.fire("$children.rendered",this.element)},"bus childrenRendered + afterRender":function(e,t,n){this.appendChildren(t,n,!1)},"bus childrenRenderedLazy + afterRender":function(e,t,n){this.appendChildren(t,n,!0)},"_add list item":function(e){var t=e.jquery?e:e.element,n=this.config.childrenContainerSelector?this.element.find(this.config.childrenContainerSelector):this.element;n.append(t)},getTableItemContainer:function(){var e=this.element.find(this.config.childrenContainerSelector+":last");if(this.config.columnCount){var n=e.children("td").length;n>=this.config.columnCount&&(e=t("<tr></tr>"),this.element.children("tbody").append(e))}return e},"_add table item":function(e,n){var i,r=e.jquery?e:e.element,s=this.getTableItemContainer();
if(this.config.cellsCssClass){var o=s.children("td").length;i=this.config.cellsCssClass[o]}i=i||"",n.containerCssClass&&s.addClass(n.containerCssClass),t("<td></td>").addClass(i).append(r).appendTo(s)},"_add selectable item":function(e,t){var n=this.element,i=t.selector||"[role=main]",r=n.filter(i);0===r.length&&(r=n.find(i)),0===r.length?(console.log(n),console.error('No element for selector "'+i+'"')):r.eq(0).append(e)},"_add replaceable item":function(e){var t=e.jquery?e:e.element,n=this.element;n.parent().length?n.replaceWith(t):this.element=t}})});