define(["jQuery","tau/core/extension.base"],function($,ExtensionBase){return ExtensionBase.extend({"bus $el.ready":function(evt,$el){var $header=$el.find(".i-role-header[data-dimension=x]");$header.length==0&&this.fire("$headerX.ready",$header)},"bus $headerX.ready":function(evt,$headerX){var onPositionConfig=function(config){return config.at="center bottom",config.my="center top",config.offset="-1 5",config},onArrowPositionConfig=function(config){return config.at="center bottom",config.my="center top",config.offset="-1 5",config},$bubbledHeader=$headerX.tauBubble({className:"tau-cardtooltip tau-cardtooltip-header  zoom-level-3",showEvent:"nothing",template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow"  role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),onPositionConfig:onPositionConfig,onArrowPositionConfig:onArrowPositionConfig});this.fire("$bubbledHeader.ready",$bubbledHeader),this.fire("hintHeader.enable")},"bus sort.started":function(){this.fire("hintHeader.disable")},"bus view.card.batch.move.after":function(){_.delay(_.bind(this.fire,this,"hintHeader.enable"),100)},"bus $headerX.ready:last+$bubbledHeader.ready:last+hintHeader.enable:last":function(evt,$headerX,$bubbledHeader){this._enable($headerX,$bubbledHeader)},"bus $headerX.ready:last+$bubbledHeader.ready:last+hintHeader.disable:last":function(evt,$headerX,$bubbledHeader){this._disable($headerX,$bubbledHeader)},_showHandler:function($bubbled,evt){var $card=$(evt.currentTarget);if(!$card.parents(".i-role-cellholder:first").hasClass("tau-collapsed")){$bubbled.tauBubble("disable");return}$bubbled.tauBubble("enable");var $viewTrigger=$card.find(".i-role-cellaxis-viewtrigger"),data=$viewTrigger.data(),name=$card.find(".tau-label__text").text();if(!data||!data.entityType)return;var $t=$('<div class="tau-card tau-'+data.entityType+'"><div></div><div class="tau-name i-role-name">'+name+"</div></div>"),$popup=$bubbled.tauBubble("widget");$popup.length&&data.entityType!=$popup.data("entityType")&&($popup.removeClass("tau-cardtooltip-header-"+$popup.data("entityType")),$popup.data("entityType",data.entityType),$popup.addClass("tau-cardtooltip-header-"+$popup.data("entityType"))),$popup.length||$bubbled.tauBubble("option","className","tau-cardtooltip tau-cardtooltip-header  zoom-level-3 tau-cardtooltip-header-"+data.entityType),$bubbled.tauBubble("option","content",$t),$bubbled.tauBubble("option","alignTo",$viewTrigger),clearTimeout(this.timeout),this.timeout=setTimeout(_.bind($bubbled.tauBubble,$bubbled,"show"),500)},_hideHandler:function($bubbled,evt){clearTimeout(this.timeout),$bubbled.tauBubble("hide")},_enable:function($grid,$bubbled,onlyCollapsed){this._disable($grid,$bubbled);var s=".tau-label";$grid.delegate(s,"mouseenter.hint",_.bind(this._showHandler,this,$bubbled)),$grid.delegate(s,"mouseleave.hint",_.bind(this._hideHandler,this,$bubbled))},_disable:function($grid,$bubbled){this._hideHandler($grid,$bubbled);var s=".tau-label";$grid.undelegate(s,"mouseenter.hint"),$grid.undelegate(s,"mouseleave.hint")}})})