define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,ExtensionBase){return ExtensionBase.extend({getColumns:function(){return[{Id:"RowID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Entity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ID",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Modification",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"ProjectID",Title:null,Type:"int",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"InnerEntity",Title:null,Type:"string",IsSynthetic:!0,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Date",Title:"Date Time",Type:"date",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}},{Id:"Description",Title:"Action",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:300,Facet:{}},{Id:"Modifier",Title:"Modified By",Type:"HTMLText",IsSynthetic:!1,IsUpdateable:!1,IsRequired:!1,Width:null,Facet:{}}]},getDataRequest:function(){var entity=this.config.context.entity;return{GridID:null,GroupBy:null,OrderBy:"Date",OrderDir:!1,Start:0,Limit:10,Cnt:{ID:entity.id,Type:entity.entityType.name}}},"bus extJsHistoryPanel":function(args){var panel=args.data.panel;this.config.store.on({type:"general",eventName:"afterSave",filter:{id:this.config.context.entity.id},listener:this},function(args){setTimeout(function(){panel&&panel.store&&panel.getStore().reload()},500)})},destroy:function(){this.config.store.unbind(this),this._super()},"bus extJsHistoryPanel+destroy":function(args){var panel=args.extJsHistoryPanel.data.panel;panel.destroy()},"bus initialize":function(){var self=this,pathToService=this.config.context.configurator.getApplicationPath()+"/PageServices/AuditHistoryListService.asmx/js?d=1";require([pathToService],function(){self.fire("serviceLoaded")})},"bus afterRender+serviceLoaded":function(evtArgs){var $element=evtArgs.afterRender.data.element,element=$element[0],self=this;self.config.store.unbind(this),gridPanelType="Ext.grid.GridPanel",configurationFactory="Tp.controls.grid.AuditHistoryConfigurationFactory",editorFieldFactory="Tp.controls.grid.AuditHistoryFieldFactory",gridProxy="Ext.Tp.GridServiceProxy({ webServiceProxy: Tp.Web.Extensions.ExtJs.AuditHistoryListService, webServiceProxyMethod: Tp.Web.Extensions.ExtJs.AuditHistoryListService.GetData })";var config={id:"super_grid",canEdit:!1,canDelete:!1,isOwner:!1,gridHeader:{Title:"History",Columns:self.getColumns()},gridDataRequest:self.getDataRequest(),pluginTypes:"Tp.controls.grid.plugins.HidePagingConstraint",innerGridConfig:[]};Ext.onReady(function(){var $tempEl=$('<div class="ext-holder"/>').appendTo("body"),factory=Tp.controls.grid.Factory.getInstance();config=factory.getConfigurationFactory(config).createConfig(),config.applyTo=$tempEl[0];var panel=new Ext.grid.GridPanel(config);$tempEl.appendTo($element),panel.on("viewready",function(){var t=setInterval(function(){$element.parents("body").length&&(panel.syncSize(),clearInterval(t))},500)}),self.fire("extJsHistoryPanel",{panel:panel}),$(".ui-empty-data-msg",$element).hide()})}})})