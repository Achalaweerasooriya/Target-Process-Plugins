define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/configurator"],function(_,$,a,b){return a.extend({category:"edit","bus afterRender":function(a){var b=this,c=a.data,d=c.element,e=this.config.imagePreviewContentSelector,f=d.find(e).find("img");if(f.size()>0)var g=setInterval(function(){$.contains(document.body,d[0])&&(clearInterval(g),b.onDOMReady(d))},1e3)},onDOMReady:function(a){var b=this,c=this.config.imagePreviewContentSelector,d=a.find(c).find("img"),e=a.width();for(var f=0,g=d.size();f<g;f++){var h=d.eq(f),i=parseInt(h[0].style.width);if(i>e){var j=$('<div class="tau-lightbox-container"></div>'),k=$('<a rel="lightbox" class="tau-lightbox-full-size">View Full Size</a>');k.attr("href",h.attr("src")),k.click($.proxy(b.pushEscapeHandler,b)),j.append(h.clone()).append(k),h.replaceWith(j)}}},pushEscapeHandler:function(){var a=this,c=b.getKeyBoardManager();c.pushHandler({handleKeyDown:function(b){b.keyCode==$.ui.keyCode.ESCAPE&&a.popHandler()}}),$("body").find("#ux-lightbox-overlay").bind("click",a.popHandler)},popHandler:function(){var a=this;b.getKeyBoardManager().popHandler(),$("body").find("#ux-lightbox-overlay").unbind("click",a.popHandler)}})})