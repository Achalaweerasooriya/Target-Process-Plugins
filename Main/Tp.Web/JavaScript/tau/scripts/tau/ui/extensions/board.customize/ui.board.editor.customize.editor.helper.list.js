define(["jQuery","Underscore","tau/ui/extensions/board.customize/ui.board.editor.customize.editor.helper.base","tau/ui/templates/board.editor.customize/ui.template.board.editor.customize.editor.list.unit","tau/utils/utils.customFields.list"],function(t,e,i,n,s){var a=function(){},o=e.constant(!0),r=e.constant(!1);t.widget("tau.pscrollerForCustomize",t.ui.pscroller,{setPoint:function(t){this.__setPoint(t)}});var l=i.extend({init:function(){this.CLASS_MAP=e.defaults({CARD_SECTION:"tau-list-canvas",CARD:"tau-list-canvas"},this.CLASS_MAP)},setUnits:function(t){this.units=t},setConfigurator:function(t){this.configurator=t},getUnitLineNumber:function(){return 0},initializeScroll:function(t){this.getLayoutCompositor(t).pscrollerForCustomize().pscrollerForCustomize("enable")},setOptionScroll:function(t,e){this.getLayoutCompositor(t).pscrollerForCustomize("setPoint",e.point)},destroyScroll:function(t){this.getLayoutCompositor(t).pscrollerForCustomize("destroy")},appendToSection:function(t){this.showPlaceholder(t)},getPlaceholder:function(t){return t.find("."+this.CLASS_MAP.BOARD_UNIT_DND_PROXY).find(".tau-board-unit")},addDraggableClasses:function(t){t.closest(".tau-canvas-board-unit-cell").addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)},enableUnitInCard:function(t,e){t.addClass(this.CLASS_MAP.BOARD_UNIT_DND_SOURCE).closest(".tau-canvas-board-unit-cell").removeClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT).show(),e&&t.animateWithCss({cssClassName:"tau-operation_unit_added",offsetTimeout:-40})},isSectionCardElement:function(t){return this._super(t)||t.closest(".tau-canvas-board-unit-cell").hasClass("tau-canvas-board-unit-cell_not_dnd")},insertAfterUnit:function(t,e){t.closest(".tau-canvas-board-unit-cell").after(e.closest(".tau-canvas-board-unit-cell"))},insertBeforeUnit:function(t,e){t.closest(".tau-canvas-board-unit-cell").before(e.closest(".tau-canvas-board-unit-cell"))},getUnitHolder:function(t){return t.closest(".tau-canvas-board-unit-cell")
},getUnit:function(t){return t.find("."+this.CLASS_MAP.BOARD_UNIT)},isOverUnit:function(t){return t.hasClass("tau-canvas-board-unit-cell")&&!t.hasClass("tau-canvas-board-unit-cell_not_dnd")&&!t.hasClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY)&&!t.closest("."+this.CLASS_MAP.LAYOUT_COMPONENTS_SET).length&&!t.closest("."+this.CLASS_MAP.CARD_SECTION).hasClass(this.CLASS_MAP.NOT_DROP)},isMultipleLineUnit:r,isDoubleLineUnit:r,isStretchableUnit:r,removeFromSection:function(t){t.closest(".tau-canvas-board-unit-cell").remove()},setSectionStyles:a,resetSectionStyles:a,insertSectionToCard:a,isAvailableSpaceOnSection:o,isAvailableSpaceForMultipleUnit:o,isAvailableSpaceForStretchableUnit:o,checkAvailableSpaceOnCard:o,hidePlaceholder:function(t){t.closest(".tau-canvas-board-unit-cell").hide()},showPlaceholder:function(t){t.closest(".tau-canvas-board-unit-cell").show()},showPlaceholderOutLibrary:a,preInsertUnitOnCard:function(i,n){var a,o=n;if(o.length){this.setSectionStyles(o,i);var r=i.data("unitId"),l=e.find(this.units,function(t){return t.unitId==r}),u=this.renderUnitCell(l.unit);a=u.find(".tau-board-unit"),u.addClass(this.CLASS_MAP.BOARD_UNIT_DND_PROXY+" "+this.CLASS_MAP.BOARD_UNIT_DND_PRE_INSERT),a.addClass(this.CLASS_MAP.BOARD_UNIT_ALIGNMENT_BASE),this.hidePlaceholder(a),this.setAlignment(a,!0);var c=u.data("rank"),d=o.find("[data-rank="+c+"]");if(r.indexOf("custom_field")>=0){var h=u.find(".tau-board-unit-label");h.text(s.getListHeader(h.text()))}var S=d.last();S.length?S.after(u):o.append(u)}else a=t("<div/>").remove(),a.length=0;return a},handleDragOverStretchableUnit:a,renderUnitCell:function(t){return n.render({unit:t,configurator:this.configurator})},fixLayoutNearStretchable:a,freezeStretchableUnits:a,unfreezeStretchableUnit:a,unfreezeStretchableUnits:a});return new l});