define(["require","jQuery","Underscore","tau/core/class","tau/core/extension.base","tau/components/component.filter.builder","./board.editor.filter.utils"],function(t){var e=t("jQuery"),i=t("Underscore"),r=t("tau/core/class"),s=t("tau/core/extension.base"),n=t("tau/components/component.filter.builder"),o=t("./board.editor.filter.utils"),d=r.extend({init:function(t,i,r){this._$input=e(t),this._typesProperty=o.getFilterInputTypesPropertyName(this._$input),this._boardSettingsService=i,this._configurator=r,this._builder=null,this._isDestroyed=!1},integrate:function(){this._boardSettingsService.get({fields:[this._typesProperty]}).then(this._onBoardDataRetrieved.bind(this)).then(function(){this._isDestroyed||this._boardSettingsService.bind({listener:this,fields:[this._typesProperty],callback:this._onBoardDataRetrieved.bind(this)})}.bind(this))},_onBoardDataRetrieved:function(t){if(!this._isDestroyed){this._destroyBuilder();var e=(t[this._typesProperty]||{}).types;this._builder=n.renderEntityFilterBuilderForInput({input:this._$input[0],entityTypes:e,configurator:this._configurator})}},_destroyBuilder:function(){this._builder&&this._builder.destroy()},destroy:function(){this._destroyBuilder(),this._boardSettingsService.unbind({listener:this}),this._isDestroyed=!0}});return s.extend({init:function(t){this._super(t),this._activeIntegrations=[]},"bus configurator.ready:last + boardSettings.ready:last + $form.ready":function(t,e,r,s){var n=e.getFeaturesService().isEnabled("ui.filter.builder");if(this._destroyExistingBuilders(),n){var a=o.getFilterInputs(s);this._activeIntegrations=i.map(a,function(t){var i=new d(t,r.boardSettings,e);return i.integrate(),i})}},_destroyExistingBuilders:function(){i.invoke(this._activeIntegrations,"destroy"),this._activeIntegrations=[]},destroy:function(){this._destroyExistingBuilders(),this._super()}})});