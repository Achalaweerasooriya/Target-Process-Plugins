define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e,t,i){return i.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus boardSettings.ready:last + dataBind:last + afterRender":function(t,i,n,a){function s(e){var t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}var l=i.boardSettings,d=a.element,o=d.find("[role=name]"),r=d.find("[role=name_output]");if(this.fire("$nameEl.ready",o),this.fire("$nameOutputEl.ready",r),1===o.size()){o.editableText({enabled:!1,restoreText:!0,className:" ",classNameActive:" ",maxLength:40,onSave:function(t){var i=e.trim(t.slice(0,40));this.$element.editableText("setValue",i),this.$element.prev().text(i),l.set({set:{name:i},callback:function(){}})}}),o.editableText("disable");var u=function(e){var t=e.edit&&n.isEditable;return this._toggleEditorVisibility(o,r,t),t}.bind(this);l.get({fields:["edit","isDraft"],callback:function(e){var t=u(e);t&&setTimeout(function(){o.click(),e.isDraft&&s(o[0])},1e3)}.bind(this)}),l.unbind({listener:this}),l.bind({fields:["edit"],listener:this,callback:function(e){var t=u(e);t&&o.click()}}),l.bind({fields:["name"],listener:this,callback:function(e){o.editableText("setValue",e.name),r.text(e.name)}})}},"bus $nameEl.ready:last + name.provided":function(e,t,i){t.text(i.value)},"bus $nameOutputEl.ready:last + name.provided":function(e,t,i){t.text(i.value)},_toggleEditorVisibility:function(e,t,i){t.toggle(!i),e.toggle(i),e.editableText(i?"enable":"disable")}})});