define(["require","Underscore","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText"],function(e){var t=e("Underscore"),n=e("tau/components/extensions/component.extension.base");return e("tau/ui/behaviour/common/ui.behaviour.editableText"),n.extend({"bus boardSettings.ready:last + destroy":function(e,t){t.boardSettings.unbind({listener:this})},"bus boardSettings.ready:last + dataBind:last + afterRender":function(e,n,i,a){function s(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}var l=n.boardSettings,o=a.element,d=o.find("[role=name]"),r=o.find("[role=name_output]");if(this.fire("$nameEl.ready",d),this.fire("$nameOutputEl.ready",r),1===d.length){d.editableText({enabled:!1,restoreText:!0,className:" ",classNameActive:" ",maxLength:40,onSave:function(e){var n=t.trim(e.slice(0,40));this.$element.editableText("setValue",n),this.$element.prev().text(n),l.set({set:{name:n},callback:t.noop})}}),d.editableText("disable");var u=function(e){var t=e.edit&&i.isEditable;return this._toggleEditorVisibility(d,r,t),t}.bind(this);l.get({fields:["edit","isDraft"],callback:function(e){var t=u(e);t&&setTimeout(function(){d.click(),e.isDraft&&s(d[0])},1e3)}.bind(this)}),l.unbind({listener:this}),l.bind({fields:["edit"],listener:this,callback:function(e){var t=u(e);t&&d.click()}}),l.bind({fields:["name"],listener:this,callback:function(e){d.editableText("setValue",e.name),r.text(e.name)}})}},"bus $nameEl.ready:last + name.provided":function(e,t,n){t.text(n.value)},"bus $nameOutputEl.ready:last + name.provided":function(e,t,n){t.text(n.value)},_toggleEditorVisibility:function(e,t,n){t.toggle(!n),e.toggle(n),e.editableText("instance")&&e.editableText(n?"enable":"disable")}})});