define(["Underscore","jQuery","tau/core/extension.base"],function(_,$,BaseExtension){return BaseExtension.extend({resetLifecycle:!0,"bus slice.ready":function(e,evtSlice){var self=this,lazyCall=function(se){var items=se.data.result.items,reduceIterator=function(memo,cellItem){return _(cellItem.dynamic.items).each(function(item){memo.push(item.data.id)}),memo},cardIds=_(items).chain().reduce(reduceIterator,[]).uniq().value(),$q={$set:{CardsIds:cardIds}};evtSlice.lazy.cardDetails($q).done(function(r){var sItems=r.data.items,hashIds=_(sItems).reduce(function(memo,t){var id=t.data&&t.data.id;return id&&(memo[id]=t),memo},{}),rItems=_(cardIds).reduce(function(memo,i){var item=hashIds[i];return item&&memo.push(hashIds[i]),memo},[]);self.fire("lazy.cards.ready",rItems)})};evtSlice.base.on("after.cells",lazyCall),evtSlice.base.on("after.list",lazyCall)},"bus domWrapper.ready:last + lazy.cards.ready":function(e,domWrapper,cardItems){var self=this;_.each(cardItems,function(c){var $card=domWrapper.augmentCard(c);self.fire("card.is.augmented",{element:$card})})}})})