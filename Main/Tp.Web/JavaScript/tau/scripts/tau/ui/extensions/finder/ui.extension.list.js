define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/templates/finder/ui.template.resultList"],function(a,b,c,d){return c.extend({appendData:function(a,c){var e=this;e.getShowMoreElement(a).hide();var f=d.get().bind(e.config,c),g=c.emptyMessage||"";e._setNoResultsMessage(a,g);var h=b(".tau-result-list>tbody>tr",f);h.appendTo(b(".ui-resultList>table>tbody",a)),e.bus.fire("dataRendered",{element:a})},_setScrollingMode:function(a,b){this.getList(a).data("noScrolling",!b)},_setNoResultsMessage:function(c,d){var e=b(".tau-no-results",c);e.text(d),d===""||a.isNull(d)||a.isUndefined(d)?e.hide():e.show()},"bus elementReady+dataLoaded":function(a){var b=a.elementReady.data.element,c=a.dataLoaded.data.data;this.appendData(b,c)},"bus dataRendered+nextPageAvailable":function(a){var b=a.dataRendered.data.element;this._setScrollingMode(b,!0)},"bus search+dataLoaded":function(a){var b=this,c=a.search.data.element;this.bus.fire("elementReady",{element:c})},"bus loadMore+dataLoaded":function(a){var b=this,c=a.loadMore.data.element;this.bus.fire("elementReady",{element:c})},getList:function(a){return b(".ui-resultList",a)},attachScrollingEvents:function(a){var b=this,c=b.getList(a).scroll(function(d){c.data("noScrolling")!=1&&c.scrollTop()+c.innerHeight()>=c[0].scrollHeight&&b.bus.fire("scrollToEnd",{element:a})})},"bus search":function(a){var c=a.data.element;b(".tau-result-list>tbody",c).html(""),this.getShowMoreElement(c).show(),this._setNoResultsMessage(c,""),this._setScrollingMode(c,!1);var d=this.getList(c);d.prop({scrollTop:d.get(0).scrollHeight})},_signUpOnActionsAndSelection:function(a){var c=this;c.getList(a).click(function(a){var d=b(a.target).parents("tr.tau-result-list-row:first");if(!d.data)return;var e=d.data();if(!e)return;if(!e.tmplItem)return;e=e.tmplItem.data;if(!e)return;c.bus.fire("entitySelected",{entity:e})}),b(".action-link",a).click(function(){var a=b(this).data().tmplItem.data;a.fn.call(c)})},"bus afterRender":function(a){var b=a.data.element,c=this;c.bus.fire("elementReady",{element:b}),c.attachScrollingEvents(b),c._setScrollingMode(b,!1),this._signUpOnActionsAndSelection(b)},getShowMoreElement:function(a){return b(".tau-resultList-load-more",a)},"bus scrollToEnd+nextPageAvailable":function(a){var b=this,c=a.scrollToEnd.data.element,d=b.getList(c);b._setScrollingMode(c,!1),b.getShowMoreElement(c).show(),d.prop({scrollTop:d.get(0).scrollHeight}),b.bus.fire("loadMore",{element:c})}})})