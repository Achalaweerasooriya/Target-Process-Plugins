define(["jQuery","Underscore","tau/ui/extensions/board.plus/card-context-menu/menu-action-item-base","tau/utils/utils.boardCard","tau/models/page.entity/entity.context.factory"],function(e,t,n,r,i){return n.extend({name:"Change Assignment and Effort",className:"i-role-card-context-menu-change-assignments",getDisabledEntityTypes:function(){return["user","requester","project","program","release","iteration","teamiteration","testcase","team","build","impediment","projectmember"]},itemClickCallback:function(e){var n=this.getBubbleCreator(e),a=r.convertToEntity(e.$trigger.data());i.create(a,this.settings.configurator).done(t.bind(this.createBubble,this,n,e.$trigger,a))},createBubble:function(n,r,i,a){var o=function(){if("timeline"===this.settings.viewMode){var r=e(n.cardSelector),i=r.parent(".i-role-timeline-card-holder,.i-role-timeline-planner-card-holder");return i.length?i:r}var a=[n.cardSelector+" .tau-people:visible",n.cardSelector+" .tau-effort:visible",n.cardSelector],o=n.$trigger.data("card-selector");o&&a.push(o);var s;return t.find(a,function(t){return s=e(t),s.length>0}),s},s={context:a,className:"tau-context-menu-assignments",alignTo:t.bind(o,this),entitySubscriptionChanges:["effort","assignments"],closeOnStoreActions:!1,stackName:"assignmentsContextMenu",componentsConfig:{components:[{type:"assignmentsList",onBeforeInitializeComponent:function(e){e.on("afterRender",function(){t.defer(function(){n.getTarget().tauBubble("adjust")})})}}]}};n.createBubble(s)}})});