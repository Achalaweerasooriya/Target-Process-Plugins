define(["jQuery","tau/ui/behaviour/common/ui.behaviour.progressIndicator","tau/utils/utils.urlBuilder.service.tp2"],function(e,t,i){return window._criticalTauChanges=!1,{getType:function(e){return e=e.toLowerCase(),e.indexOf("story")>=0?"UserStory":e.indexOf("bug")>=0?"Bug":e.indexOf("task")>=0?"Task":e.indexOf("feature")>=0?"Feature":e.indexOf("testplanrun")>=0?"TestPlanRun":e},show:function(n,r,o){var a=this;if(a.lastEntityID!==n){a.lastEntityID=n,r=this.getType(r).toLowerCase(),o=o||!1;var u=function(e){if(e&&e.data&&e.data.cmd){if(u.cmd===e.data.cmd)return;u.cmd=e.data.cmd}o.apply({},arguments)},s=t.get(e("body"));s.show("Loading..."),require(["all.components"],function(){require(["tau/configurator","tau/components/component.application"],function(e,t){s.hide(),e.clearSingles(),e.setConfig("isPopup",!0),e.getExternal().setFakeWindow(),e.setLoggedUser(window.loggedUser),e.registerService("urlBuilder",new i(e));var c={context:{configurator:e},options:{applicationId:"integrationPopup",routing:{silent:!0,executeOnStart:!1},integration:{showInPopup:!0,keepAlive:!1,progress:s,reloadCallback:u}}},d=t.create(c);d.initialize(c),d.fire("history.reset"),d.fire("application.navigate.entity",{id:n,entity:r});var l,g=!!o;l=g?function(){e.getWindow()._criticalTauChanges=!0,d.fire("destroy")}:function(){d.fire("initProgress"),e.getRouting().redirect(e.getUrlBuilder().getDashboardUrl())},d.on("application.exit",l),d.on("destroy",function(){s.hide(),a.lastEntityID=null})})})}}}});