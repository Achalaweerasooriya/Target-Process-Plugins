define(["tau/store/store","tau/store/repository","tau/store/services/service.rest","tau/core/global.bus","tau/rules/core","tau/rules/rule.auto-include-before-save","tau/rules/rule.auto-action-after-save","tau/rules/rule.auto-include-before-remove","tau/target.process.rules.registrator","tau/store/types.targetprocess"],function(a,b,c,d,e,f,g,h,i,j){return{appPath:window.appHostAndPath,rulesDisabled:!1,clearSingles:function(){this.rulesEngine&&(this.rulesEngine.destroy&&this.rulesEngine.destroy(),delete this.rulesEngine),delete this.proxy,delete this.service,delete this.store},clear:function(){this.clearSingles(),delete this.initialData,delete this.appPath,delete this.rulesDisabled},setApplicationPath:function(a){if(this.appPath===a)return;this.appPath=a},getApplicationPath:function(){return this.appPath},setInitialData:function(a){this.initialData=a},setService:function(a){if(this.service===a)return;this.clearSingles(),this.service=a},getService:function(){return this.service||(this.service=new c({appPath:this.getApplicationPath(),path:this.getRestPath()})),this.service},getRestPath:function(){return this.getApplicationPath()+"/api/v1"},setProxy:function(a){this.proxy=a},getProxy:function(){return this.proxy||(this.proxy=new b({service:this.getService()})),this.initialData&&(this.proxy.registerData(this.initialData,!0),delete this.initialData),this.proxy},disableRules:function(){this.rulesDisabled=!0},enableRules:function(){this.rulesDisabled=!1},initRules:function(a){if(this.rulesDisabled===!0)return;this.rulesEngine=new e({store:this.store,rules:[],rulesImpl:[f,g,h]}),i.registerRules(this.rulesEngine,a)},getStore:function(b){return b=b||{},this.store||(b.proxy=this.getProxy(),_.defaults(b,{eventEmitter:d.get()}),this.store=new a(b),this.initRules(b.services)),this.store}}})