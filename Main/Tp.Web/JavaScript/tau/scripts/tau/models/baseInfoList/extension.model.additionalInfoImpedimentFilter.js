define(["Underscore","tau/models/extension.model.base"],function(_,a){var b=a.extend({"bus extendGetEntityQuery":function(a){var b=a.data.fields,c=["id"];b=a.data.fields=_.uniq(_.union(b,[{owner:c},{responsible:c},"isPrivate"])),_.each(b,function(a){a.hasOwnProperty("entityState")&&(a.entityState=_.uniq(_.union(a.entityState,["isFinal"])))})},"bus filterEntities":function(a){var b=a.data;b.entities=_.select(b.entities,function(a){if(a.entityState.isFinal)return!1;if(!a.isPrivate)return!0;var b=this.config.context.getLoggedUser().id;return(a.owner||{}).id==b||(a.responsible||{}).id==b},this)}});return b})