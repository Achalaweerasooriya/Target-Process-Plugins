define(["Underscore","tau/models/extension.model.base"],function(_,ModelBase){var ModelListBase=ModelBase.extend({"bus extendGetEntityQuery":function(evtArgs){var fields=evtArgs.data.fields,generalUser=["id"];fields=evtArgs.data.fields=_.uniq(_.union(fields,[{owner:generalUser},{responsible:generalUser},"isPrivate"])),_.each(fields,function(field){field.hasOwnProperty("entityState")&&(field.entityState=_.uniq(_.union(field.entityState,["isFinal"])))})},"bus filterEntities":function(evtArgs){var data=evtArgs.data;data.entities=_.select(data.entities,function(entity){if(entity.entityState.isFinal)return!1;if(!entity.isPrivate)return!0;var loggedUserId=this.config.context.getLoggedUser().id;return(entity.owner||{}).id==loggedUserId||(entity.responsible||{}).id==loggedUserId},this)}});return ModelListBase})