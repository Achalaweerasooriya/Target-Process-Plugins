define(["Underscore","tau/models/extension.model.base"],function(e,t){var i=t.extend({"bus extendGetEntityQuery":function(t){var i=t.data.fields,n=["id"];i=t.data.fields=e.uniq(e.union(i,[{owner:n},{responsible:n},"isPrivate"])),e.each(i,function(t){t.hasOwnProperty("entityState")&&(t.entityState=e.uniq(e.union(t.entityState,["isFinal"])))})},"bus filterEntities":function(t){var i=t.data;i.entities=e.select(i.entities,function(e){if(e.entityState.isFinal)return!1;if(!e.isPrivate)return!0;var t=this.config.context.getLoggedUser().id;return(e.owner||{}).id==t||(e.responsible||{}).id==t},this)}});return i});