define(["tau/core/model-base"],function(a){var b=a.extend({onInit:function(){var a=this,b=a.config.context,c=b.entity.entityType.name,d=b.entity.id;a.store.unbind(a),a.store.on(a.getSubscriptionConfig("afterSave"),_.bind(a.onEntityAfterSave,a)),a.store.on(a.getSubscriptionConfig("beforeSave"),_.bind(a.onEntityBeforeSave,a)),a.store.get(c,{id:d,fields:["id","effort",{roleEfforts:["id",{role:["id","hasEffort"]}]}]}).done({scope:a,success:a.done})},done:function(a){var b=this,c=a[0].data,d=b.config.context,e=d.entity.entityType.name,f={id:c.id,effort:Math.round(100*c.effort)/100,unit:d.getEffortPoint(e),roleEfforts:c.roleEfforts};b.fire("dataBind",f)},getSubscriptionConfig:function(a){var b=this,c=b.config.context.entity;return{eventName:a,type:"roleEffort",listener:b,filter:{assignable:{id:c.id}},hasChanges:["effort"]}},onEntityAfterSave:function(a){this.fire("propertyChanged")},onEntityBeforeSave:function(a){this.fire("beforeChangeProperty")}});return b})