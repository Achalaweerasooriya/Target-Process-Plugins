define(["tau/core/model-base"],function(e){var t=e.extend({onInit:function(){var e=this,t=e.config.context,n=t.entity.entityType.name,o=t.entity.id;e.store.unbind(e),e.store.on(e.getSubscriptionConfig("afterSave"),_.bind(e.onEntityAfterSave,e)),e.store.on(e.getSubscriptionConfig("beforeSave"),_.bind(e.onEntityBeforeSave,e)),e.store.get(n,{id:o,fields:["id","effort",{roleEfforts:["id",{role:["id","hasEffort"]}]}]}).done({scope:e,success:e.done})},done:function(e){var t=this,n=e[0].data,o=t.config.context,i=o.entity.entityType.name,r={id:n.id,effort:Math.round(100*n.effort)/100,unit:o.getEffortPoint(i),roleEfforts:n.roleEfforts};t.fire("dataBind",r)},getSubscriptionConfig:function(e){var t=this,n=t.config.context.entity;return{eventName:e,type:"roleEffort",listener:t,filter:{assignable:{id:n.id}},hasChanges:["effort"]}},onEntityAfterSave:function(){this.fire("propertyChanged")},onEntityBeforeSave:function(){this.fire("beforeChangeProperty")}});return t});