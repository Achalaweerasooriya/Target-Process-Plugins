define(["Underscore","tau/models/dataProviders/model.provider.groups.base","tau/utils/utils.date"],function(a,b,c){return b.extend({fetch:function(a,b,c){return this._fetchReleases(a,b,c)},_fetchReleases:function(b,d,e){var f=this.config.context,g=f.entity.entityType.name,h=f.entity.id,i=this.config.store,j=this,k={id:h,nested:!0,fields:[{releases:["id","name","startDate","endDate"]}]};i.get("project",k).done({success:function(b){var d=a(b).pluck("data")[0].releases;d=a.sortBy(d,function(a){return-1*c.parse(a.startDate)});var f=[];a.forEach(d,function(a){f.push(j._processRelease(a))}),a.forEach(f,function(a){a.items=[]}),e(f)}})},_processRelease:function(a){var b=c.parse(a.startDate).clearTime(),d=c.parse(a.endDate).clearTime(),e=!0,f=!1;Date.today().between(b,d)&&(e=!1,f=!0);var g="d MMM",h=c.formatAs(b,g)+" / "+c.formatAs(d,g);h=h+" ("+Math.floor((d.getTime()-b.getTime())/1e3/60/60/24+1)+" days)",f&&(h+=" (current)");var i={key:a.id,title:a.name,subtitle:h,collapsed:e,realGroup:a};return i}})})