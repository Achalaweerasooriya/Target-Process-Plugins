define(["Underscore","tau/models/dataProviders/model.provider.items.base"],function(t,e){return e.extend({fetch:function(t){this._fetch("userStories","userStory","priority",t)},_createDetailCommand:function(t){var e={};return e[t]=["id","name","numericPriority","tags",{priority:["id","name","importance"]},"effort","effortCompleted","effortToDo","timeSpent","timeRemain","tasks-count","tasks-effort-sum","tasks-effortToDo-sum",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","isPair","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{project:["id"]}],e},_convertData:function(t){return t=e.prototype._convertData.call(this,t),t=this._calculateEffortToMaximum(t),this._sortByPriority(t)},_convertItem:function(t){var e=this;t.project=t.project||{};var i={id:t.id,name:t.name,__type:t.__type,numericPriority:t.numericPriority,entityState:{id:t.entityState.id,name:t.entityState.name,isInitial:t.entityState.isInitial,isFinal:t.entityState.isFinal,numericPriority:t.entityState.numericPriority},tags:this._processTags(t),priority:{id:t.priority.id,name:t.priority.name,kind:e.importanceProcessor.getKind(t.priority.importance)},effort:this._getEffortData(t),assignments:this._processAssignments(t),projectId:t.project.id,entitiesCount:t["tasks-count"],url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(t.id,t.__type,!0)};return i.visibleEntityState=i.entityState,i}})});