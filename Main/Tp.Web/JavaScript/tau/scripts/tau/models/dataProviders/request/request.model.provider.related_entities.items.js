define(["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(_,a,b){return a.extend({fetch:function(a){var b=_.bind(function(b){this._loadFull(b,a)},this);this._fetch("relatedEntities","bug",null,b)},_loadFull:function(a,b){var c=_.pluck(this.config.context.getPractices(),"name"),d=this.config.store,e=[];_.forEach(a,function(a){var b=a.__type.toLowerCase(),f=["id",{entityState:["id","name","isInitial","isFinal","numericPriority","isCommentRequired",{nextStates:["id"]}]}];f.push({release:["id","name"]}),_.indexOf(c,"Iterations")!=-1&&f.push({iteration:["id","name"]}),b.toLowerCase()=="userstory"&&f.push({tasks:["id"]}),e.push(function(c){d.get(b,{id:a.id,fields:f}).done({success:function(b){a=_.extend(a,b[0].data),c(null,a)}})})}),_.series(e,function(a,c){b(c)})},_createDetailCommand:function(a){var b={};return b[a]=["id","name","numericPriority","endDate",{entityType:["id","name"]}],b},_convertItem:function(a){var c=this,d={id:a.id,name:a.name,numericPriority:a.numericPriority,__type:a.entityType.name,endDate:b.format.date.short(a.endDate),tags:[]};return d}})})