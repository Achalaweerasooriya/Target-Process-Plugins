define(["Underscore","tau/models/dataProviders/model.provider.items.base","tau/utils/utils.date"],function(_,BaseProvider,dateUtils){return BaseProvider.extend({fetch:function(fnCallback){this._fetch("iterations","iteration",!1,fnCallback)},_createDetailCommand:function(collectionType){var detailCommand={};return detailCommand[collectionType]=["id","name","tags","startDate","endDate",{release:["id","name"]},"bugs-effortToDo-sum","bugs-effortCompleted-sum","userStories-effortToDo-sum","userStories-effortCompleted-sum"],detailCommand},_getAssignedEffort:function(serverDataItem){var data={},effortToDo=0,effortCompleted=0;return effortToDo+=serverDataItem["bugs-effortToDo-sum"],effortToDo+=serverDataItem["userStories-effortToDo-sum"],effortCompleted+=serverDataItem["bugs-effortCompleted-sum"],effortCompleted+=serverDataItem["userStories-effortCompleted-sum"],data.value=Math.round((effortToDo+effortCompleted)*100)/100,data.unit=this.config.context.getEffortPoint(serverDataItem.__type),data},_convertItem:function(data){var item={id:data.id,name:data.name,__type:data.__type,tags:this._processTags(data),release:data.release,assignedEffort:this._getAssignedEffort(data),startDate:dateUtils.format.date.short(dateUtils.convertToTimezone(data.startDate)),endDate:dateUtils.format.date.short(dateUtils.convertToTimezone(data.endDate)),url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(data.id,data.__type,!0)};return item},_convertData:function(data){return data=this._super(data),this._sortByStartDate(data)},_sortByStartDate:function(items){return _.sortBy(items,function(item){return-1*item.startDate})}})})