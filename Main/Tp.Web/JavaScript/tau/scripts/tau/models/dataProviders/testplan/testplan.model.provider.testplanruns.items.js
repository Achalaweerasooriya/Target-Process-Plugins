define(["Underscore","tau/models/dataProviders/model.provider.items.base"],function(t,e){return e.extend({fetch:function(t){this._fetch("testPlanRuns","testPlanRun","severity",t)},_createDetailCommand:function(e){var i={};i[e]=["id","name","numericPriority","tags","effort","effortCompleted","effortToDo","timeSpent","timeRemain","passedCount","failedCount","notRunCount","onHoldCount","blockedCount","testCaseRuns-count",{entityState:this.fields.entityStateWithComment},{roleEfforts:["id","effort","effortToDo",{role:["id","name","hasEffort"]}]},{assignments:["id",{role:["id"]},{generalUser:this.fields.generalUser}]},{release:["id","name"]},{iteration:["id","name"]},{build:["id","name"]}];var n={project:["id"]};return this.config.multiprojects&&n.project.push("abbreviation"),i[e].push(n),this.config.additionalFields&&t.indexOf(this.config.additionalFields,"iteration")>-1&&i[e].push({iteration:["id","name"]}),i},_convertData:function(e){return e=this._super(e),t.sortBy(e,function(t){var e=t.numericPriority||0;return e})},_convertItem:function(e){var i=!0;this.config.context.isPracticeAvailable("Iterations")||(i=!1),e.project=e.project||{};var n={id:e.id,name:e.name,numericPriority:e.numericPriority,__type:e.__type,entityState:{id:e.entityState.id,name:e.entityState.name,isInitial:e.entityState.isInitial,isFinal:e.entityState.isFinal,numericPriority:e.entityState.numericPriority},assignments:this._processAssignments(e),projectId:e.project.id,entitiesCount:0,release:e.release,iteration:e.iteration,build:e.build,passedCount:t.toNumber(e.passedCount)||0,failedCount:t.toNumber(e.failedCount)||0,notRunCount:(t.toNumber(e.notRunCount)||0)+(t.toNumber(e.onHoldCount)||0)+(t.toNumber(e.blockedCount)||0),url:this.config.context.configurator.getUrlBuilder().getNewViewUrl(e.id,e.__type,!0),isAvailableIteration:i,additionalActions:{}};return this.config.multiprojects&&(n.project={id:e.project.id,abbreviation:e.project.abbreviation}),this.config.additionalFields&&t.indexOf(this.config.additionalFields,"iteration")>-1&&(n.iteration={id:e.iteration?e.iteration.id:null,name:e.iteration?e.iteration.name:null}),n
}})});