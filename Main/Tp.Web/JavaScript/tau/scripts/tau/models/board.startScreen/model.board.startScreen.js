define(["Underscore","jQuery","tau/core/extension.base"],function(e,t,r){return r.extend({"bus beforeInit":function(r,o){var i=o.config.context.configurator;this.fire("configurator.ready",i);var a=e.defaults(o.config.options||{},{boardTemplatesGroupName:"boardTemplates",boardTemplateGroupsGroupName:"boardTemplateGroups",boardsGroupName:"boards"});this.fire("options.ready",a);var n=t.Deferred();i.getLoggedUser().isAdministrator?i.getRestStorage().select(a.boardsGroupName,{$where:'(publicData.isShared == "true")',$fields:["key"]}).done(function(e){var t=e.data||[];0===t.length?n.resolve():n.reject()}):n.reject(),n.done(e.bind(function(){this.fire("dataBind",{})},this)).fail(function(){i.getRouting().redirect(i.getUrlBuilder().getDefaultViewUrl())})},"bus configurator.ready:last + options.ready:last + boardsSet.selected":function(r,o,i,a){var n=t.Deferred(),s=o.getHelpScenarioService(),d=s.getScenarioById(a),c=d.requiredProject;c?o.getApplicationContextService().getApplicationContext({projectIds:[c],teamIds:[]},{success:n.resolve}):n.resolve({acid:void 0});var l=t.Deferred();t.post(o.getApplicationPath()+"/board/generate/"+a).fail(function(e){console.log("ERROR: "+e.responseText)}).done(function(){this.fire("boardsSet.applied"),l.resolve()}.bind(this)),t.when(n,l).done(e.bind(function(e){var t=s.checkScenarioPrerequisites(e,d)?a:"scratch";s.setCurrentFlow(t),s.setState(s.stateTypes.ToBeStarted),o.getRouting().redirect(o.getUrlBuilder().getDefaultViewUrl(e.acid)),this.fire("helpFlow.activated")},this))}})});