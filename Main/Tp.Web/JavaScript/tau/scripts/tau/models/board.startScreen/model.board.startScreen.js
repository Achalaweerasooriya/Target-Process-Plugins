define(["Underscore","jQuery","tau/core/extension.base","tau/components/board.menu/models/board.menu.section.collection","tau/services/boards/view.types"],function(e,t,r,o,i){return r.extend({"bus beforeInit":function(r,n){var a=n.config.context.configurator;this.fire("configurator.ready",a);var s=e.defaults(n.config.options||{},{boardTemplatesGroupName:"boardTemplates",boardTemplateGroupsGroupName:"boardTemplateGroups",boardsGroupName:"boards"});this.fire("options.ready",s);var d=t.Deferred();a.getLoggedUser().isAdministrator?a.getViewsMenuService().getViewsMenuForUser().then(function(t){var r=new o;r.setSections(t);var n=r.getAllBoards(),a=e.where(n,{itemType:i.BOARD});0===a.length?d.resolve():d.reject()}):d.reject(),d.done(e.bind(function(){this.fire("dataBind",{})},this)).fail(function(){a.getRouting().redirect(a.getUrlBuilder().getDefaultViewUrl())})},"bus configurator.ready:last + options.ready:last + boardsSet.selected":function(r,o,i,n){var a=t.Deferred(),s=o.getHelpScenarioService(),d=s.getScenarioById(n),c=d.requiredProject;c?o.getApplicationContextService().getApplicationContext({projectIds:[c],teamIds:[]},{success:a.resolve}):a.resolve({acid:void 0});var u=t.Deferred();t.post(o.getApplicationPath()+"/board/generate/"+n).fail(function(e){console.log("ERROR: "+e.responseText)}).done(function(){this.fire("boardsSet.applied"),u.resolve()}.bind(this)),t.when(a,u).done(e.bind(function(e){var t=s.checkScenarioPrerequisites(e,d)?n:"scratch";s.setCurrentFlow(t),s.setState(s.stateTypes.ToBeStarted),o.getRouting().redirect(o.getUrlBuilder().getDefaultViewUrl(e.acid)),this.fire("helpFlow.activated")},this))}})});