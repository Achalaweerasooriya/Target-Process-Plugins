define(["Underscore","tau/core/extension.base"],function(e,r){return r.extend({init:function(e){var r=this;r._super.apply(r,arguments);var t=e.context.configurator,n=t.service("search");r.refreshTrigger=function(){r.fire("refresh")},n.onSubmit(r.refreshTrigger),r.destructor=function(){n.offSubmit(r.refreshTrigger)}},destroy:function(){this.destructor(),this._super.apply(this,arguments)},"bus afterInit":function(r){var t=this,n=r.data.config.context.configurator,i=n.service("search"),a=i.params().get();i.search(a).done(function(r){r.data.items=e.map(r.data.items,function(e){var r=e.id,t=e.entityType.name;return"comment"==e.entityType.name.toLowerCase()&&(r=e.general.id,t=e.general.entityType.name),e.url=n.getUrlBuilder().getNewViewUrl(r,t,!0),e}),r.data.srcParams=a,t.fire("dataBind",r.data)})}})});