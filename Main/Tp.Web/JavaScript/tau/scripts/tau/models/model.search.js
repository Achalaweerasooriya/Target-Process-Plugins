define(["Underscore","tau/core/extension.base"],function(e,t){return t.extend({init:function(e){var t=this;t._super.apply(t,arguments);var r=e.context.configurator,n=r.service("search");t.refreshTrigger=function(){t.fire("refresh")},n.onSubmit(t.refreshTrigger),t.destructor=function(){n.offSubmit(t.refreshTrigger)}},destroy:function(){this.destructor(),this._super()},"bus afterInit":function(t){var r=this,n=t.data.config.context.configurator,i=n.service("search"),a=i.params().get();i.search(a).done(function(t){t.data.items=e.map(t.data.items,function(e){var t=this._getLinkEntity(e);return e.url=n.getUrlBuilder().getNewViewUrl(t.id,t.entityType.name,!0),e}.bind(this)),t.data.srcParams=a,r.fire("dataBind",t.data)}.bind(this))},_getLinkEntity:function(e){switch(e.entityType.name.toLowerCase()){case"comment":return e.general;case"teststep":return e.testCase;default:return e}}})});