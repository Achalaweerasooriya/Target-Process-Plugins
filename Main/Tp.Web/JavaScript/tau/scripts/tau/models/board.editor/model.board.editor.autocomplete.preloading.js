define(["require","Underscore","jQuery","tau/core/extension.base"],function(e){var r=e("Underscore"),t=e("jQuery"),n=e("tau/core/extension.base");return n.extend({"bus boardSettings.ready:last + suggestionManager.ready:last + preloading.execute":function(e,r,t){r.boardSettings.get({fields:["x","y","cells","user"],callback:this.safeCallback(function(e){this._preloadAll(t,e).done(this.safeCallback(function(){this.fire("preload.complete")}))})})},_preloadAll:function(e,r){var n=[];return r.x&&(n=n.concat(this._preload(r.x.types,r.x.filter,e))),r.y&&(n=n.concat(this._preload(r.y.types,r.y.filter,e))),r.cells&&(n=n.concat(this._preload(r.cells.types,r.cells.filter,e)),r.user&&(n=n.concat(this._preload(r.cells.types,r.user.cardFilter,e)))),t.whenList(n)},_preload:function(e,t,n){if(r.isArray(e)||(e=[e]),!(e.indexOf("effort")>=0||e.indexOf("source")>=0)){var s=r.map(e,function(e){return r.isString(e)?e:e.type});t=t||"";var a=["?"];return t.length>1&&"?"===t[0]&&a.push(t.trim()+" "),0===s.length?[]:r.map(a,function(e){return n.get({query:{resourceTypes:s,script:e}})})}}})});