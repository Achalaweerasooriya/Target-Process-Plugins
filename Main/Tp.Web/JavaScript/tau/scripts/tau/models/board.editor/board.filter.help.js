define(["Underscore","jQuery","tau/core/class","tau/models/board.editor/board.filter.help.data","tau/store/types"],function(e,t,a,r,n){var s={},i={assigneduser:"assignment",createdate:"datetime",enddate:"datetime",startdate:"datetime"},o={userStory:["releasable"],bug:["releasable"],feature:["releasable"],task:["releasable"],iteration:["releasable","time_container"],teamIteration:["time_container"],release:["time_container"]};return a.extend({getTypes:function(e){return s.hasOwnProperty(e)||(s[e]=this._getTypes(e)),s[e]},_getTypes:function(e){var t=[];i.hasOwnProperty(e)&&(e=i[e]);var a=n.findByKeyword(e);if(a&&a.name&&o.hasOwnProperty(a.name)&&(t=t.concat(o[a.name])),a){var r=a.parent;for(t.push(a.name);r;){t.push(r);var s=n.findByKeyword(r);if(!s)break;r=s.parent}}else t.push(e);return t},get:function(a){a=a||{};var n={},s=this,i=t.Deferred();return e.each(e.keys(a),function(t){var i=(a[t]||{}).types||[];if(0!==i.length){n[t]=[];var o=[];e.each(i,function(e){o.push(s.getTypes(e))}),o=e.intersection.apply(null,o),e.each(o,function(e){var a=r[e];a&&(n[t]=n[t].concat(a))}),n[t]=n[t].concat(r.customRules(i))}}),i.resolve(n),i.promise()}})});