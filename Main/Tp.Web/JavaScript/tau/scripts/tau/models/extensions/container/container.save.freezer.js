define(["Underscore","tau/core/extension.base"],function(e,n){return n.extend({init:function(e){this._super.apply(this,arguments),this.setQueueBusForComponents(e.children),this.suspendedEvents=[]},setQueueBusForComponents:function(e){for(var n=0;n<e.length;n++){var s=e[n];s["queue.bus"]=!0,this.setQueueBusForComponents(s.children||[])}},handleChildComponentCreated:function(e){e.data.on("before_save",this.onBeforeSave,this),e.data.on("childComponentCreated",this.handleChildComponentCreated,this)},"bus childComponentCreated":function(e){this.handleChildComponentCreated(e)},onBeforeSave:function(n){n.suspendMain(),this.fire("event.suspended",n),this.suspendedEvents=e.reject(this.suspendedEvents,function(e){return e.sender===n.sender}),this.suspendedEvents.push(n)},"bus resumeSave":function(){e.each(this.suspendedEvents,function(e){e.resumeMain()})}})});