define(["tau/models/model.property"],function(e){return e.extend({onInit:function(){this.listenOfPropertyChanged();var e=this.config.context.entity,t=e.entityType.name,a={};a[this.config.propertyName]=["id","firstName","lastName","email","avatarUri"],this.store.get(t,{id:e.id,fields:["id",a]}).done({scope:this,success:this.initialDataProcessor}),this.bindStoreListeners()},initialDataProcessor:function(e){var t=this.config;if(t){var a=e[0].data,i=a[t.propertyName];if(i){var r=i.email;(i.firstName||i.lastName)&&(r=_.trim([i.firstName,i.lastName].join(" ")));var n=r;t.hidename&&(r="");var s={id:i.id,avatar:i.avatarUri+"24",name:r,visibleName:n};this.fire("dataBind",s)}}},bindStoreListeners:_.once(function(){this.store.on({eventName:"afterSave",type:"user",hasChanges:["avatarUri"],listener:this},function(e){this.afterUserSaved(e)}.bind(this))}),afterUserSaved:function(e){this.fire("userAvatarChanged",e.data)},"bus dataBind:last + userAvatarChanged":function(e,t,a){t.id===a.id&&this.fire("avatarChanged",a)}})});