define(["tau/models/model.property"],function(t){return t.extend({onInit:function(){this.listenOfPropertyChanged();var t=this.config.context.entity,e=t.entityType.name,i={};i[this.config.propertyName]=["id","firstName","lastName","email","avatarUri"],this.store.get(e,{id:t.id,fields:["id",i]}).done({scope:this,success:this.initialDataProcessor}),this.bindStoreListeners()},initialDataProcessor:function(t){var e=this.config;if(e){var i=t[0].data,a=i[e.propertyName];if(!a)return void this.fire("dataBind",{});var r=a.email;(a.firstName||a.lastName)&&(r=_.trim([a.firstName,a.lastName].join(" ")));var n=r;e.hidename&&(r="");var s={id:a.id,avatar:a.avatarUri+"32",name:r,visibleName:n};this.fire("dataBind",s)}},bindStoreListeners:_.once(function(){this.store.on({eventName:"afterSave",type:"user",hasChanges:["avatarUri"],listener:this},function(t){this.afterUserSaved(t)}.bind(this))}),afterUserSaved:function(t){this.fire("userAvatarChanged",t.data)},"bus dataBind:last + userAvatarChanged":function(t,e,i){e.id===i.id&&this.fire("avatarChanged",i)}})});