define(["Underscore","tau/core/extension.base.stateful"],function(e,t){return t.extend({onInit:function(t){var n=t.context,i=this.store,a=n.entity;i.unbind(this),i.on({eventName:"afterSave",type:a.entityType.name,listener:this,filter:{id:a.id},hasChanges:["name"]},e.bind(function(){this.fire("refresh")},this));var r=["id","name"];i.get(a.entityType.name,{id:a.id,fields:r}).done({success:e.bind(function(e){this.fire("data.ready",e[0].data)},this)})},"bus beforeInit+data.ready":function(t,n,i){var a=n.config.context,r=a.configurator,d=a.entity,s=e.pick(i,"id","name");s.entityType={name:d.entityType.name.toLowerCase()},s.entity={name:i.name},s.url=r.getUrlBuilder().getNewViewUrl(s.id,s.entityType.name,!0),this.fire("dataBind",s)},"bus configurator.ready + destroy":function(e,t){t.getStore().unbind(this)}})});