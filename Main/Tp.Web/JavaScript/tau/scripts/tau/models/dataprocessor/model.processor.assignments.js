define(["Underscore"],function(_){var assignmentsConverter={getAssignmentsForRole:function(role,serverData){var assignments=_(serverData.assignments).select(function(assignment){return assignment.role.id==role.id});return assignments},getAssignments:function(serverData){var assignments={groups:[]},roleEfforts=serverData.roleEfforts;for(var i=0;i<roleEfforts.length;i++){var role=roleEfforts[i].role,group={role:{id:role.id,name:role.name.substring(0,3)},users:[]},assignmentsForRole=this.getAssignmentsForRole(role,serverData);for(var assignmentsNumber=0;assignmentsNumber<assignmentsForRole.length;assignmentsNumber++){var user=assignmentsForRole[assignmentsNumber].generalUser,name=[];user.firstName?(name.push(user.firstName),user.lastName&&name.push(_.asString(user.lastName).substring(0,1)+".")):user.lastName?name.push(user.lastName):name.push(user.email),group.users.push({id:user.id,name:_.trim(name.join(" ")),assignmentId:assignmentsForRole[assignmentsNumber].id,avatarUri:user.avatarUri})}assignments.groups.push(group)}return assignments}};return assignmentsConverter})