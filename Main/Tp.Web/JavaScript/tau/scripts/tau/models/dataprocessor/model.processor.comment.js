define(["tau/configurator","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(a,b,c){function d(a){this.context=a}return d.prototype={destroy:function(){this.context=null},convertDTO:function(d){var e=this,f={id:d.id,parentId:d.parentId,avatar:[a.getApplicationPath(),"/Avatar.ashx?UserId=",d.owner.id,"&size=32"].join(""),name:e.getName(d.owner),description:b.fromSourceToHtml(d.description),age:this.getAge(d.createDate),createDate:c.format.datetime.short(c.convertToTimezone(d.createDate)),comments:[],deleted:"DELETED"===d.description,isRequester:d.owner.kind&&d.owner.kind.toString().toLowerCase()==="requester"};return this.context.getLoggedUser().id==d.owner.id&&(f.isOwnerComment=!0),f},getName:function(a){var b=a.firstName||"",c=a.lastName||"",d="";if(b.length>0||c.length>0)d=[b," ",c.trim().substring(0,1),"."].join("");return d},getAge:function(a){if(!a)return"Draft";var b=c.getAge(c.parse(a));return b.isZero?"Just added":b.toString()}},d})