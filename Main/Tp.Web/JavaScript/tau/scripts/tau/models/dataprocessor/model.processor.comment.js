define(["tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(htmlConverter,dateUtils){function commentConverter(context){this.context=context}return commentConverter.prototype={destroy:function(){this.context=null},convertDTO:function(comment){var self=this,commentData={id:comment.id,parentId:comment.parentId,avatar:[comment.owner.avatarUri,"32"].join(""),name:self.getName(comment.owner),description:htmlConverter.fromSourceToHtml(comment.description),age:this.getAge(comment.createDate),createDate:dateUtils.format.datetime.short(dateUtils.convertToTimezone(comment.createDate)),comments:[],deleted:"DELETED"===comment.description,isRequester:comment.owner.kind&&comment.owner.kind.toString().toLowerCase()==="requester"};return this.context&&this.context.getLoggedUser().id==comment.owner.id&&(commentData.isOwnerComment=!0),commentData},getName:function(commentOwner){var firstName=commentOwner.firstName||"",lastName=commentOwner.lastName||"",result="";if(firstName.length>0||lastName.length>0)result=[firstName," ",_.trim(lastName).substring(0,1),"."].join("");return result},getAge:function(commentCreateDate){if(!commentCreateDate)return"Draft";var result=dateUtils.getAge(dateUtils.parse(commentCreateDate));return result.isZero?"Just added":result.toString()}},commentConverter})