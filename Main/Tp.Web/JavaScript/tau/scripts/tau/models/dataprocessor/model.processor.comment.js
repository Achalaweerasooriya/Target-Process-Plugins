define(["Underscore","tau/utils/utils.htmlConverter","tau/utils/utils.date"],function(e,t,r){var n=function(e){this.configurator=e};return n.prototype={destroy:function(){this.context=null},convertDTO:function(e){var n=this,i="DELETED"===e.description,o={id:e.id,parentId:e.parentId,owner:e.owner,avatar:[e.owner.avatarUri,"32"].join(""),name:n.getName(e.owner),fullName:n.getFullName(e.owner),description:t.fromSourceToHtml(e.description),rawDescription:e.description,age:this.getAge(r.convertToTimezone(e.createDate)),createDate:r.format.datetime.short(r.parse(e.createDate)),comments:[],deleted:i,isRequester:e.owner.kind&&"requester"===e.owner.kind.toString().toLowerCase()};return this.configurator&&this.configurator.getLoggedUser().id==e.owner.id&&(o.isOwnerComment=!0),o.actions={edit:!i,reply:i,"delete":i},o},getName:function(t){var r=t.firstName||"",n=t.lastName||"",i="";return(r.length>0||n.length>0)&&(i=[r," ",e.trim(n).substring(0,1),"."].join("")),i},getFullName:function(t){var r=t.firstName||"",n=t.lastName||"";return e.trim([e.trim(r)," ",e.trim(n)].join(""))},getAge:function(e){if(!e)return"Draft";var t=r.getAge(e,this.configurator.getCurrentDate());return t.isZero?"Just added":t.toString()}},n});