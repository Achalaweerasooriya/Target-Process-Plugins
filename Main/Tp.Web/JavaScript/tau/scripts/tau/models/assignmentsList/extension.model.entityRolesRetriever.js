define(["Underscore","tau/models/extension.model.base"],function(_,a){return a.extend({category:"model entity roles retriever extension","bus registerStoreRequest":function(){var a=this.config.context.entity||{entityType:{}},b={role:["id","name","isPair","hasEffort"]};this.fire("get",{type:a.entityType.name,query:{id:a.id,fields:[{roleEfforts:["id","effort","effortToDo",b,{assignable:["id"]}],list:!0}]},callback:{scope:this,success:this.onRoleEffortsRetrieved}})},"bus userGroupWasCreated":function(a){var b=a.data||{},c=b.role||{};if(c.hasEffort){var d=this.entity.roleEfforts;_.each(d,function(a){if(a.role.id==c.id)return b.roleEffort={effort:this.floatToString(a.effort),remain:this.floatToString(a.effortToDo),id:a.id},!0},this),this.fire("roleEffortsReady",d)}else b.roleEffort=null},getRoles:function(){var a=this.entity.roleEfforts,b=[],c=a.length;for(var d=0;d<c;d++)b.push(a[d].role);return b},onRoleEffortsRetrieved:function(a){this.entity=a.data;var b=this.getRoles();this.fire("rolesReady",b)},"bus extendDataToBind":function(a){var b=a.data||{}}})})