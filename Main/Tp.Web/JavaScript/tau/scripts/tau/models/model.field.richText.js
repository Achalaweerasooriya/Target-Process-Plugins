define(["tau/core/extension.base","tau/utils/utils.htmlConverter"],function(ModelBase,htmlConverter){var descriptionModel=ModelBase.extend({"bus beforeInit":function(evt,initConfig){var self=this,entity=initConfig.config.context.entity,store=initConfig.config.context.configurator.getStore(),fieldName=initConfig.config.fieldName,entityTypeName=entity.entityType.name,entityId=entity.id;store.unbind(self);var onChange=function(name,evt){if(evt.data.id!=entityId)return;var changes=evt.data.changes;if(!changes.hasOwnProperty(fieldName))return;self.fire(name,changes)};store.on({eventName:"beforeSave",type:entityTypeName,listener:this},_.bind(onChange,this,"prepareChanges")).on({eventName:"afterSave",type:entityTypeName,listener:this},_.bind(onChange,this,"applyChanges")),store.get(entityTypeName,{id:entityId,fields:["id",fieldName]}).done(function(res){var data=res[0].data;self.fire("dataBind",{html:htmlConverter.fromSourceToHtml(data[fieldName])})})}});return descriptionModel})