define(["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,ModelProperyListBase){return ModelProperyListBase.extend({name:"states-list",propertyType:"entityState",onInit:function(){var self=this,success=function(r){var assignable=r[0].data;self.store.get(self.propertyType,self.createGetStateForAssignableCommand(assignable)).done({success:_.bind(self.onDataRetrieved,self)})};this.getAssignable(success)},getRequiredFields:function(){return[{entityState:["id"]}]},createGetStateForAssignableCommand:function(assignable){return{id:assignable.entityState.id,fields:["id","name","isCommentRequired",{nextStates:["id","name","isCommentRequired","numericPriority"]}]}},processData:function(assignable){var states=[];assignable.nextStates=_.sortBy(assignable.nextStates,function(item){return item.numericPriority}),_.each(assignable.nextStates,function(state){states.push({id:state.id,name:state.name,isCommentRequired:state.isCommentRequired})}),this.fire("dataBind",{states:states,completed:!0,nullableValue:!1})}})})