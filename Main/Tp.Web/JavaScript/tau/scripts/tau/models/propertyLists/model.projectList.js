define(["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,ModelBase){return ModelBase.extend({propertyType:"project","bus beforeInit":function(evt,initConfig){var entity=initConfig.config.context.entity,configurator=initConfig.config.context.configurator,store=configurator.getStore(),fire=_.bind(this.fire,this);store.get("project",{fields:["id","name","color","isActive",{process:["id",{practices:["id","name"]}]}]}).done(function(result){fire("items.ready",result[0].data)}),store.get(entity.entityType.name,{id:entity.id,fields:["id",{project:["id"]}]}).done(function(result){fire("currentItem.ready",result[0].data.project||{})})},"bus beforeInit:last + items.ready + currentItem.ready":function(evt,initConfig,items,currentItem){var config=initConfig.config,entityType=initConfig.config.context.entity.entityType.name.toLowerCase(),practices={bug:["Bug Tracking"],feature:["Requirements"],release:["Requirements"],testcase:["Test Cases"],testplan:["Test Cases"],iteration:["Iterations"],request:["Help Desk"]}[entityType]||[];items=_.filter(items,function(v){var byPractice=!0;if(practices.length&&v.isActive){var prs=_.pluck(v.process.practices,"name");byPractice=_.any(prs,function(pr){return _.indexOf(practices,pr)>=0})}return v.isActive&&byPractice}),items=_.sortBy(items,function(v){return v.name.toLowerCase()});var showReset=!!(config.showReset&&currentItem&&currentItem.id),data={states:_.reject(items,function(item){return currentItem&&item.id===currentItem.id}),completed:!0,nullableValue:showReset,templateOption:config.templateOption};this.fire("dataBind",data)}})})