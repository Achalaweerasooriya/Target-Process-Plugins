define(["Underscore","tau/models/propertyLists/model.propertyList.base"],function(_,ModelBase){return ModelBase.extend({onInit:function(){var self=this,config=this.config,entity=this.config.context.entity;self.store.get(entity.entityType.name,{id:entity.id,fields:["id",config.data.name]}).done({success:_.bind(self.onDataRetrieved,self)})},onDataRetrieved:function(result){var entity=result[0].data,current=entity[this.config.data.name],items=this.config.values;_.forEach(items,function(item,k){_.isObject(item)==0&&(item={id:item,name:item},items[k]=item)});var showReset=!!this.config.showReset&&!!current,data={states:_.reject(items,function(item){return current&&item.id==current}),completed:!0,nullableValue:showReset};this.fire("dataBind",data)},"bus updateState":function(evt){var $set={},value=null;evt.data&&evt.data.id&&(value=evt.data.id),$set[this.config.data.name]=value,this.fire("save",$set)}})})