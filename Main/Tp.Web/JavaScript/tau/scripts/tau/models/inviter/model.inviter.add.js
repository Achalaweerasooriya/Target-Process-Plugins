define(["Underscore","tau/core/extension.base","tau/libs/inviter/inviter"],function(e,t,n){return t.extend({"bus configurator.ready:last + form.submitted":function(e,t,a){var i=this,r=new n(t);r.invite(a.members).done(function(e){i.fire("members.saved",e)})},"bus configurator.ready:last + entity.ready:last + members.saved":function(t,n,a,i){var r=this,s=n.getStore(),o=a.entityType.name,u=o+"Members",c=e.compact(e.pluck(i,"failure"));c.length&&this.fire("team.add.nonFatalFailure","Can't assign users.");var d=e.compact(e.pluck(i,"success")),m={};m[u]=e.map(d,function(e){return{user:{id:e}}});var f=["id","name"];f.push("team"===o?"icon":"color");var l={};l[u]=[{user:["id","firstName","lastName","avatarUri"]},{role:["id","name"]}],f.push(l),s.save(o,{id:a.id,$set:m,fields:f}).done(function(e){r.fire("members.connected",e[0].data)})},"bus entity.ready:last + members.saved + members.connected":function(e,t,n,a){this.fire("invitation.success",a)}})});