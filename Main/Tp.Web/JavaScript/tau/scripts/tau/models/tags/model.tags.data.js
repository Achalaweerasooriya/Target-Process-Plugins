define(["Underscore","tau/core/extension.base","tau/models/tags/tagsProcessor"],function(_,ExtensionBase,TagsProcessor){return ExtensionBase.extend({"bus beforeInit":function(evt,initConfig){var entity=initConfig.config.context.entity,configurator=initConfig.config.context.configurator;this.fire("entity.ready",entity),this.fire("configurator.ready",configurator),this.fire("tagsProcessor.ready",new TagsProcessor)},"bus configurator.ready + entity.ready + tagsProcessor.ready + beforeInit":function(evt,configurator,entity,tagsProcessor){var store=configurator.getStore();store.get(entity.entityType.name,{id:entity.id,fields:["id","tags"]}).done(_.bind(function(res){this.fire("dataBind",{tags:this._process(tagsProcessor.asArray(res[0].data.tags))})},this))},_process:function(tags){return tags=_.map(tags,function(v){var tag={name:v},dupl=tag.name.match(/^duplicateOf\#(\d+)$/i);return dupl&&(tag.isDuplicate=!0,tag.href="#bug/"+dupl[1]),tag}),tags}})})