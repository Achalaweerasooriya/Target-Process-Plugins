define(["Underscore","tau/core/model.editable.base"],function(_,a){var b=a.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(a){var b=a.data.cmd.$set.customFields[0].value;a.data.cmd.$set.customFields[0].value=b?b:null,a.data.cmd.$set.customFields[0].type=="URL"&&b.label==null&&b.url==null&&(a.data.cmd.$set.customFields[0].value=null)},"bus beforeInit+configurationProvided":function(a){var b=a.beforeInit.data.config.context.entity,c=a.configurationProvided.data;this.configuration=c,this.beforeSaveHandler||(this.beforeSaveHandler=_.bind(this._beforeSave,this),this.store.on({eventName:"beforeSave",type:b.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:b.id}},this.beforeSaveHandler)),this.afterSaveHandler||(this.afterSaveHandler=_.bind(this._afterSave,this),this.store.on({eventName:"afterSave",type:b.entityType.name,listener:this,filter:{id:b.id}},this.afterSaveHandler))},_beforeSave:function(a){var b=a.data.changes.customFields[0];_.mergeFields(a.data.cmd.config.fields,["customFields"]);var c=this.configuration;b.name==c.name&&b.type==c.type&&this.bus.fire("preRefreshRow",{data:b})},_afterSave:function(a){this.bus.fire("refreshRow",{})},destroy:function(){this.beforeSaveHandler=null,this.afterSaveHandler=null,this._super()}});return b})