define(["Underscore","tau/core/model.editable.base"],function(a,b){var c=b.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.bus.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(a){var b=a.data.cmd.$set.customFields[0].value;a.data.cmd.$set.customFields[0].value=b?b:null,a.data.cmd.$set.customFields[0].type=="URL"&&b.label==null&&b.url==null&&(a.data.cmd.$set.customFields[0].value=null)},"bus beforeInit+configurationProvided":function(b){var c=b.beforeInit.data.config.context.entity,d=b.configurationProvided.data;this.configuration=d,this.beforeSaveHandler||(this.beforeSaveHandler=a.bind(this._beforeSave,this),this.store.on({eventName:"beforeSave",type:c.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:c.id}},this.beforeSaveHandler)),this.afterSaveHandler||(this.afterSaveHandler=a.bind(this._afterSave,this),this.store.on({eventName:"afterSave",type:c.entityType.name,listener:this,filter:{id:c.id}},this.afterSaveHandler))},_beforeSave:function(b){var c=b.data.changes.customFields[0];a.mergeFields(b.data.cmd.config.fields,["customFields"]);var d=this.configuration;c.name==d.name&&c.type==d.type&&this.bus.fire("preRefreshRow",{data:c})},_afterSave:function(a){(a.data.changes.customFields||this.configuration.type=="URL")&&this.bus.fire("refreshRow",{})},destroy:function(){this.beforeSaveHandler=null,this.afterSaveHandler=null,this._super()}});return c})