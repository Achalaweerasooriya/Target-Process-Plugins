define(["Underscore","jQuery","tau/core/model-base"],function(t,e,n){return n.extend({"bus beforeInit":function(t,e){var n=e.config,i=n.context.entity;n.store.get(i.entityType.name,{id:i.id,fields:[{testcase:["id"]}]}).done({scope:this,success:function(t){this.testCaseId=t[0].data.testcase?t[0].data.testcase.id:null,this.fire("dataBind",{hasAccess:!0})}})},"bus afterRender":function(t,n){if(this.testCaseId){e(n.element).show();var i=this.config.context.configurator,s={type:"attachments"},a={context:{entity:{id:this.testCaseId,entityType:{name:"testcase"}},configurator:i}};i.getComponentBuilder().createAsChild(s,this.bus).then(function(t){this.fire("attachmentsBus",t),t.on("afterRender",function(t,e){var i=n.element.find(".i-role-attachments");i.empty(),i.append(e.element),this.fire("load.done")}.bind(this)),t.on("load.error",function(t){if(404===t.data.data.status){var e="You don't have access to the initial Test Case, so you cannot view the attachments. Please contact your administrator.";n.element.find(".i-role-error").text(e)}this.fire("load.done")}.bind(this)),t.fire("initialize",a)}.bind(this))}}})});