define(["Underscore"],function(_){var _calculateCounts=function(fields,callbackInfo){var self=this,ctx=self.config.context,type=ctx.entity.entityType.name,copyFields=[];for(var i=0;i<fields.length;i++)copyFields.push(fields[i]);var cmdSettings={id:ctx.entity.id,fields:fields},proc={innerCallback:function(evtData){var data=evtData.data,totalCount=0;for(var i=0;i<copyFields.length;i++)totalCount+=data[copyFields[i]];callbackInfo.callback.call(callbackInfo.scope,{count:totalCount})}};self.store.get(type,cmdSettings,{success:proc.innerCallback,scope:proc}).done()};return{calculateTagsCount:function(callbackInfo){_calculateCounts.call(this,["tags-count"],callbackInfo)},calculateBugsAndTasksCount:function(callbackInfo){var fields=[];this.config.context.isPracticeAvailable("Planning")&&fields.push("tasks-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&fields.push("bugs-count"),_calculateCounts.call(this,fields,callbackInfo)},calculateTasksCount:function(callbackInfo){_calculateCounts.call(this,["tasks-count"],callbackInfo)},calculateBugsCount:function(callbackInfo){_calculateCounts.call(this,["bugs-count"],callbackInfo)},calculateUserStoriesAndBugsCount:function(callbackInfo){var fields=[];fields.push("userStories-count"),this.config.context.isPracticeAvailable("Bug Tracking")&&fields.push("bugs-count"),_calculateCounts.call(this,fields,callbackInfo)},calculateIterationsCount:function(callbackInfo){_calculateCounts.call(this,["iterations-count"],callbackInfo)},calculateReleasesCount:function(callbackInfo){_calculateCounts.call(this,["releases-count"],callbackInfo)},calculateFeaturesCount:function(callbackInfo){_calculateCounts.call(this,["features-count"],callbackInfo)},calculateRequestsCount:function(callbackInfo){_calculateCounts.call(this,["requests-count"],callbackInfo)},calculateImpedimentsCount:function(callbackInfo){_calculateCounts.call(this,["impediments-count"],callbackInfo)},calculateTimesCount:function(callbackInfo){_calculateCounts.call(this,["times-count"],callbackInfo)},calculateAttachmentsCount:function(callbackInfo){_calculateCounts.call(this,["attachments-count"],callbackInfo)},calculateCommentsCount:function(callbackInfo){_calculateCounts.call(this,["comments-count"],callbackInfo)},calculateTesCasesCount:function(callbackInfo){_calculateCounts.call(this,["testCases-count"],callbackInfo)},calculateTestPlanRunsCount:function(callbackInfo){_calculateCounts.call(this,["testPlanRuns-count"],callbackInfo)},calculateUserStoriesCount:function(callbackInfo){_calculateCounts.call(this,["userStories-count"],callbackInfo)},calculateTestCaseRunsCount:function(callbackInfo){_calculateCounts.call(this,["testCaseRuns-count"],callbackInfo)},calculateRelatedEntitiesCount:function(callbackInfo){_calculateCounts.call(this,["relatedEntities-count"],callbackInfo)},calculateRequestersCount:function(callbackInfo){_calculateCounts.call(this,["requesters-count"],callbackInfo)}}})