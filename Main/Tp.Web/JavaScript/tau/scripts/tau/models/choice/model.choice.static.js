define(["Underscore","./model.choice.base"],function(t,e){return e.extend({onInit:function(){var e=this,i=this.config,n=this.config.context.entity;e.store.get(n.entityType.name,{id:n.id,fields:["id",i.data.name]}).done({success:t.bind(e.onDataRetrieved,e)})},onDataRetrieved:function(e){var i=e[0].data,n=i[this.config.data.name],a=this.config.values;t.forEach(a,function(e,i){t.isObject(e)||(a[i]={id:e,name:e})});var d={states:t.reject(a,function(t){return n&&t.id==n}),completed:!0};this.fire("dataBind",d)},"bus updateState":function(t){var e={},i=null;t.data&&t.data.id&&(i=t.data.id),e[this.config.data.name]=i,this.fire("save",e)}})});