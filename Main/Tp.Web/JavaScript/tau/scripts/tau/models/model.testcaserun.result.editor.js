define(["Underscore","tau/core/extension.base.stateful"],function(e,t){return t.extend({"bus beforeInit":function(e,t){this.entity=t.config.context.entity,this.store.get(this.entity.entityType.name,{id:this.entity.id,fields:["passed"]}).done({success:function(e){var t=e[0].data,s={};t.passed===!0?s.passed=!0:t.passed===!1&&(s.failed=!0),this.fire("dataBind",s)}.bind(this)})},"bus result.changed":function(e,t){var s={id:this.entity.id,runDate:new Date,comment:null,executed:!0};switch(t){case"passed":s.passed=!0;break;case"failed":s.passed=!1,s.comment="";break;case"skip":s.passed=null;break;default:s.executed=!1,s.runDate=null,s.passed=null}this.store.save("testcaserun",{$set:s}).done()}})});