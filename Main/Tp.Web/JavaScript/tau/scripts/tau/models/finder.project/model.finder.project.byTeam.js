define(["Underscore","tau/core/extension.base","tau/configurations/factory.container.config"],function(e,t,r){return t.extend({resetLifecycle:!0,"bus beforeInit":function(e,t){var r=t.config.context.configurator;this.fire("configurator.ready",r),this.fire("entity.ready",t.config.context.entity)},"bus configurator.ready + entity.ready":function(t,r){var i=r.getStore(),n=e.bind(this.fire,this,"refresh");i.unbind(this),i.on({eventName:"afterSave",type:"team",listener:this,hasChanges:["teamProjects"]},n)},"bus configurator.ready:last + teamProjects.ready:last + activeTab.ready:last + beforeInit":function(t,i,n,o){var a=this,s=i.getStore(),c=[];c.push(e.bind(this._getList,this,s,"project",["id","name","color"],e.pluck(e.compact(e.pluck(n,"project")),"id"))),c.push(e.bind(this._getList,this,s,"process",["id","name","isDefault"],[])),e.parallel(c,function(e,t){var i=t[0],n=t[1];a.fire("dataBind",{projects:i,activeTab:o,canAddProjects:!0,teams:[],canAddTeams:!1,showTeams:!1,submitLabel:"Assign",showEmpty:!0,showSearch:i.length>20,colors:r.getConfigByType("project").prototype.colors,processes:n})})},_getList:function(t,r,i,n,o){t.get(r,{fields:i}).done({success:function(t){var r=t[0].data;r=e.filter(r,function(t){return-1==e.indexOf(n,t.id)}),r=e.sortBy(r,function(e){return e.name.toUpperCase()}),o(!1,r)}})},"bus configurator.ready:last + entity.ready":function(e,t,r){var i=this;t.getStore().get("team",{id:r.id,fields:[{teamProjects:[{project:["id","name"]}]}]}).done({success:function(e){i.fire("teamProjects.ready",e[0].data.teamProjects)}})},"bus configurator.ready:last + destroy":function(e,t){var r=t.getStore();r.unbind(this)}})});