define(["jQuery","Underscore","tau/core/extension.base"],function(e,t,s){return s.extend({init:function(e,t){this._super(e),this._commandFactory=t},"bus configurator.ready:last + entity.ready:last + form.submitted":function(e,t,s,n){var r=n.projectIds;this._assign(t,s,r).done(this.fire.bind(this,"projects.connected",r))},"bus configurator.ready:last + entity.ready:last + project.add.success":function(e,t,s,n){var r=[n.id];this._assign(t,s,r).done(this.fire.bind(this,"projects.connected",r))},_assign:function(t,s,n){var r=this._commandFactory.create(s,n),i=t.getStore(),o=e.Deferred();return i.evictProperties.apply(i,r.evictProperties),i.save(r.type,r.data).done({success:function(e){o.resolve(e[0].data)}}),o}})});