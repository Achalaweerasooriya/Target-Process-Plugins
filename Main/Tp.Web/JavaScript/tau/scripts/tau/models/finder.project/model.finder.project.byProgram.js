define(["Underscore","tau/models/finder.project/model.finder.project.byEntity.abstract","tau/components/context.selector/models/model.context.program"],function(e,t,r){return t.extend({"bus configurator.ready:last + programProjects.ready:last + activeTab.ready:last + beforeInit":function(e,t,r,n){var o=t.getStore(),s={projects:this._getProjects.bind(this,o),processes:this._getList.bind(this,o,"process",["id","name","isDefault"],[])};this._getAvailableEntities(s,n)},_getProjects:function(t,n){var o=["id","name","color",{program:["id","name"]}];new r(t).getAvailableProjects(o).then(function(t){t=e.sortBy(t,function(e){return e.name.toUpperCase()}),n(!1,t)})},_getStoreOnRefreshConfig:function(){return{eventName:"afterSave",type:"program",listener:this,hasChanges:["projects"]}},_getAssignedEntities:function(e,t){var r=this;e.get("program",{id:t.id,fields:[{projects:[{project:["id","name"]}]}]}).done({success:function(e){r.fire("programProjects.ready",e[0].data.projects)}})}})});