define(["Underscore","tau/models/boardSettings/model.board.settings","tau/core/async.source.adapter","tau/storage/api"],function(_,a,b,c){var d=function(a,c){var d=a.getStateManager();return new b({onGet:function(a){d.get({id:c.id,fields:a.fields,callback:a.callback})},onSet:function(a){d.set({id:c.id,set:a.set,callback:a.callback})},onBind:function(a){var b=function(b){var c={};c[b.fieldName]=b.value,a.callback.call(this,c)};d.bind({paramId:c.id,fieldName:a.fields[0],callback:b,listener:a.listener})},onUnbind:function(a){d.unbind(a.listener)}})},e=function(a){var d=new c({service:a.service});return new b({onGet:function(b){d.data(a.groupName,a.id).done(function(a){var c=a.data||{};c=c.userData||{};var d={};for(var e=0;e<b.fields.length;e++){var f=b.fields[e];c.hasOwnProperty(f)&&(d[f]=c[f])}b.callback(d)})},onSet:function(b){var c=b.set;d.data(a.groupName,a.id,{scope:"Public",userData:c}).done(function(a){b.callback(c)})},onBind:function(a){},onUnbind:function(a){}})};return{createInstance:function(b,c){var f=[];c.groupName="boards",c.service=b.getRestStorageService(),f.push(d(b,c)),f.push(e(c));var g=new a(c,f);return g},createComponentSettings:function(b,c){var f=[];c.groupName="settings",c.service=b.getRestStorageService(),f.push(e(c)),f.push(d(b,c));var g=new a(c,f);return g}}})