define(["jQuery","Underscore","tau/core/extension.base"],function(e,a,r){return r.extend({"bus configurator.ready:last + getCardsData":function(r,t){var n=t.service("currentBoard").$element,i=n.find(".i-role-header"),d=function(r){var t=[];return a.each(i.find(".i-role-cellholder"),function(i){var d=e(i),c=d.data(r),o=".i-role-grid .i-role-cell[data-"+r+"="+c+"] .i-role-card",s=a.chain(n.find(o)).map(this._getCardData).value();s.length&&t.push({name:d.find(".i-role-name").text(),cards:s})},this),t}.bind(this),c=[],o=i.length;switch(o){case 1:var s=i.data("dimension");c=d(s);break;case 2:c=d("x");break;default:var l=a.map(n.find(".i-role-card"),this._getCardData);l.length&&(c=[{name:"",cards:l}])}this.fire("currentCards",c)},_getCardData:function(a){return e(a).data()}})});