define(["tau/models/customField/model.customField.editable","tau/utils/utils.jsonSchema"],function(e,t){var i=e.extend({category:"edit",name:"Editable custom field",schema:t.Schema.create({type:"object",properties:{value:{type:"object",optional:!1,pre:function(e){var t=!!_.trim(e.label)||!!_.trim(e.url);return this.schema.properties.label.optional=this.schema.properties.label.optional&&!t,this.schema.properties.label.empty=this.schema.properties.label.empty&&!t,this.schema.properties.url.optional=this.schema.properties.url.optional&&!t,this.schema.properties.url.empty=this.schema.properties.url.empty&&!t,e},properties:{label:{type:"string",optional:!0,maxLength:30,pre:["trim"]},url:{type:"string",optional:!0,pattern:t.PATTERN_URL,pre:["trim",function(e){return 0==e.length&&this.schema.optional&&(this._wasError=1),e}]}},post:function(e){return e.label||e.url||(e={label:null,url:null}),e}}}}),"bus validate":function(e){var t=e.data,i=t.cmd.$set.customFields[0],r=this.config.customField||this.config.data;this.schema.properties.value.properties.label.optional=!r.required,this.schema.properties.value.properties.label.empty=!r.required,this.schema.properties.value.properties.url.optional=!r.required,this.schema.properties.value.properties.url.empty=!r.required,t.validation=this.schema.validate(i),delete t.validation.instance.value.__id}});return i});