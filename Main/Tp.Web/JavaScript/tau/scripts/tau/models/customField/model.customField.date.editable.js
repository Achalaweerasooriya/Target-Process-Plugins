define(["tau/models/model.customField.editable","tau/utils/utils.jsonSchema","tau/utils/utils.date"],function(ModelBase,jsonSchema,dateUtils){var model=ModelBase.extend({category:"edit",name:"Editable custom field",schema:jsonSchema.Schema.create({type:"object",properties:{value:{type:"string",optional:!1,post:function(val){if(this.wasError()==0){var date=dateUtils.parse(val);date==null?new this.Error("Date","Incorrect date format"):date<new Date("01/01/1900")?new this.Error("Date","Date must be greater then 01-01-1900"):val=dateUtils.format.date.short(date)}return val},additionalProperties:{dateFormat:dateUtils.getFormatData().date.short}}}}),"bus validate":function(evt){var args=evt.data,data=args.cmd.$set.customFields[0];this.schema.properties.value.optional=!this.config.customField.required,this.schema.properties.value.empty=!this.config.customField.required,args.validation=this.schema.validate(data)}});return model})