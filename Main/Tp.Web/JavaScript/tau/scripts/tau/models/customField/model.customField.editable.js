define(["Underscore","tau/core/model.editable.base"],function(e,t){var i=t.extend({category:"edit",name:"Editable custom field","bus dataBind":function(){this.fire("permissionsReady",{editable:!0,deletable:!0})},"bus beforeSave":function(e,t){var i=t.cmd.$set.customFields[0].value;t.cmd.$set.customFields[0].value=i?i:null,"URL"==t.cmd.$set.customFields[0].type&&null==i.label&&null==i.url&&(t.cmd.$set.customFields[0].value=null)},"bus beforeInit + configurationProvided":function(t,i,a){var n=i.config.context.entity,s=i.config.context.configurator.getStore();this.configuration=a,s.unbind(this),this.beforeSaveHandler=e.bind(this._beforeSave,this),s.on({eventName:"beforeSave",type:n.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:n.id}},this.beforeSaveHandler),this.afterSaveHandler=e.bind(this._afterSave,this),s.on({eventName:"afterSave",type:n.entityType.name,listener:this,hasChanges:["customFields"],filter:{id:n.id}},this.afterSaveHandler)},"bus beforeInit:last + destroy":function(e,t){var i=t.config.context.configurator.getStore();i.unbind(this)},_beforeSave:function(t){var i=t.data.changes.customFields[0];e.mergeFields(t.data.cmd.config.fields,["customFields"]);var a=this.configuration;i.name==a.name&&i.type==a.type&&this.fire("preRefreshRow",{data:i})},_afterSave:function(e){for(var t=this.configuration,i=0;i<e.data.changes.customFields.length;i++){var a=e.data.changes.customFields[i];a.name==t.name&&a.type==t.type&&this.fire("refreshRow",{data:a})}}});return i});