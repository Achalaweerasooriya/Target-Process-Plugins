define(["require","Underscore","tau/models/customField/model.customField.editable"],function(e){var t=e("Underscore"),i=e("tau/models/customField/model.customField.editable");return i.extend({"bus beforeInit":function(e,i){var n=i.config;n.customField=n.customField||n.data;var u=n.context.getCustomFields(),o=t.findWhere(u,{name:n.customField.name}),d=n.customField.value,l=this._getOptions(o.value);this.fire("dataBind",{nullableValue:!!d&&!n.customField.required,states:t.compact(t.map(l,function(e){return e===d?null:{id:e,name:e}}))})},_getOptions:function(e){return e?e.split("\r\n"):[]},"bus beforeInit:last + updateState":function(e,t,i){this.fire("save",{customFields:[{name:t.config.customField.name,type:t.config.customField.type,value:i&&i.id?i.id:null}]})}})});