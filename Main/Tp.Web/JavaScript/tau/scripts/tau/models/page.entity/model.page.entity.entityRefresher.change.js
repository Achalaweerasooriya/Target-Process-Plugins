define(["Underscore","tau/core/extension.base"],function(e,t){return t.extend({"bus entity.ready + configurator.ready":function(t,n,i){var r=n.entityType.name,o=i.getStore(),a=e.bind(this.fire,this);o.unbind(this);var s=!1,d=o.getEvictedPropertiesByType(r);e.forEach(d,function(t){o.on({eventName:"afterSave",type:r,listener:this,filter:{id:n.id},hasChanges:[t]},function(t){if(!s){if(s=!0,o.unbind(this),a("entity.toEvict",n),"project"!==r){var i=t.data,d=e.extend({},i.obj,i.changes,{__type:i.obj.type});o.register(d)}a("refresh")}})},this)},"bus configurator.ready > destroy":function(e,t){t.getStore().unbind(this)}})});