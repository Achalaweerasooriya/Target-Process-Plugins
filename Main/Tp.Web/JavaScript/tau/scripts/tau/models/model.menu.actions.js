define(["Underscore","tau/core/extension.base","tau/core/termProcessor"],function(_,BaseModel,TermProcessor){var TASK_ENTITYTYPE_ID=45,model=BaseModel.extend({"bus beforeInit":function(evt,initConfig){var config=initConfig.config,configurator=initConfig.config.context.configurator,entity=initConfig.config.context.entity;this.fire("configurator.ready",configurator),this.fire("entity.ready",entity);var items=config.items,processedItems=[],groupItemsCount=0;_.forEach(items,function(item){if(item==="-----"){if(groupItemsCount===0)return;groupItemsCount=0}else++groupItemsCount;processedItems.push(item)}),this.fire("dataBind",{items:processedItems})},"bus configurator.ready:last + beforeInit:last + entity.ready:last + menu.show.first":function(evt,configurator,initConfig,entity){var tp=new TermProcessor(initConfig.config.context.getTerms()),actionsService=configurator.getActionsService();actionsService.getEntityTypesToConvert(entity.id).done(_.bind(function(entityTypes){var items=_(entityTypes).chain().filter(function(v){return v.id!=TASK_ENTITYTYPE_ID}).map(function(v){var terms=tp.getTerms(v.name);return{id:v.id,label:terms.name,name:v.name,className:"tau-"+v.name.toLowerCase(),icon:terms.iconSmall}}).value(),task=_.find(entityTypes,function(et){return et.id==TASK_ENTITYTYPE_ID});if(task){var terms=tp.getTerms(task.name);items.push({id:task.id,label:terms.name+"&hellip;",name:task.name,className:"tau-"+task.name.toLowerCase(),icon:terms.iconSmall,alias:"convertToTask"})}this.fire("convertSubmenuData.ready",{items:items})},this))}});return model})