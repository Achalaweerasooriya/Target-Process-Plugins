define(["Underscore","tau/core/model.editable.base"],function(_,a){return a.extend({category:"edit",name:"Editable attachment","bus dataBind":function(a){this.bus.fire("permissionsReady",{editable:!0,deletable:!0}),this._attachments||(this._attachments=a.data.items)},"bus attachmentUploaded":function(a){this._addAttachment(a.data.data)},onInit:function(){var a=this;this.store.on({eventName:"afterRemove",listener:a,type:"attachment"},function(b){var c=parseInt(b.data.cmd.config.id);a._isValidAttachmentId(c)&&(a._removeAttachment(c),a.bus.fire("afterAttachmentRemove",{id:c}))})},_addAttachment:function(a){this._attachments.push(a)},_removeAttachment:function(a){this._attachments=_.reject(this._attachments,function(b){return a===b.id})},_isValidAttachmentId:function(a){return _.any(this._attachments,function(b){return b.id===a})}})})