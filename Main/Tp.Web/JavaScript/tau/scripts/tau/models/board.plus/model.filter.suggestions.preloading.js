define(["Underscore","./model.board.base","tau/models/board.editor/board.filter.suggestionManager"],function(_,baseModel,SuggestionsManager){return baseModel.extend({"bus configurator.ready":function(evt,configurator){var suggestionManager=new SuggestionsManager(configurator);this.fire("suggestionManager.ready",suggestionManager)},_preload:function(types,prefix,service){var resourceTypes=[];_.isArray(types)||(types=[types]);if(types.indexOf("effort")>=0||types.indexOf("source")>=0)return;_.each(types,function(type){_.isString(type)?resourceTypes.push(type):resourceTypes.push(type.type)}),prefix=prefix||"";var preloads=["?"];prefix.length>1&&prefix[0]==="?"&&preloads.push(prefix.trim()+" ");if(resourceTypes.length===0)return;_.each(preloads,function(s){service.get({query:{resourceTypes:resourceTypes,script:s}})})},"bus board.definition.ready + suggestionManager.ready:last + overview.board.ready:last":function(evt,definition,suggestionManager){var f=_.bind(function(){definition.x&&this._preload(definition.x.types,definition.x.filter,suggestionManager),definition.y&&this._preload(definition.y.types,definition.y.filter,suggestionManager),definition.cells&&(this._preload(definition.cells.types,definition.cells.filter,suggestionManager),definition.user&&this._preload(definition.cells.types,definition.user.cardFilter,suggestionManager))},this,definition);_.delay(f,100)}})})