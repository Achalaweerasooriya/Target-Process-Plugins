define(["tau/models/model.property","tau/configurator"],function(a,b){return a.extend({onInit:function(){var a=this;a._super.apply(a,arguments),a.store.unbind(a),a.store.on({type:a.getEntityTypeName(),eventName:"beforeSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.store.evictProperties(a.getEntityId(),a.getEntityTypeName(),[a.config.refField]),a.fire("beforeChanged",b.data)}),a.store.on({type:a.getEntityTypeName(),eventName:"afterSave",listener:a,filter:{id:a.getEntityId()},hasChanges:[a.propertyName]},function(b){a.fire("propertyChanged",b.data)})},getPropertyData:function(){var a=this;a.store.get(a.getEntityTypeName(),{id:a.getEntityId(),fields:["id",a.config.refField]},{success:function(b){if(!b.data[a.config.refField]||b.data[a.config.refField].length===0){a.processProperty({});return}a.store.get("assignable",{id:b.data[a.config.refField][0],fields:[a.displayField,a.valueField]},{success:function(b){a.processProperty(b.data)}}).done()},scope:a}).done()}})})