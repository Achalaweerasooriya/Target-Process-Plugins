define(["Underscore","tau/core/model-base","tau/libs/store2/store2","tau/core/templates-factory"],function(t,e,o,r){return e.extend({name:"Program Progress Bar",onInit:function(){var e=this.config.context.configurator.getStore2(),o=this.config.context.entity,n=o.id;e.findAll(t.sprintf("Program?select=({userStoriesCount() as totalStoriesCount, openUserStoriesCount() as openStoriesCount})&where=(Id=%d)",n)).then(function(e){var o=e[0],n=o.totalStoriesCount-o.openStoriesCount;this.fire("dataBind",{percentCompleted:this.calculatePercentCompleted(o),title:t.sprintf("%d of %d %s completed",n,o.totalStoriesCount,r.termProcessor.getTerms("userStory").names)})}.bind(this))},calculatePercentCompleted:function(t){return 0===t.totalStoriesCount?0:Math.round(100*(1-t.openStoriesCount/t.totalStoriesCount))}})});