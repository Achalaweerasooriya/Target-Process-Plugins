define(["Underscore","tau/models/model.label"],function(e,t){var a=t.extend({_updateBadge:function(e){this.fire("updateBadge",{badgeConfig:e})},"bus updateBadge":function(e,t){var a=t.badgeConfig||{};this._badgeDataRetrieve(a)},_badgeDataRetrieve:function(t){this.config.context.configurator.getStore2().findAll("general?select={masterRelations.Count()%20%2B%20slaveRelations.Count()%20as%20totalRelationCount,%20masterRelations.ActiveMasterRelationsCount().openBlockers%20as%20blockerRelationCount,%20masterRelations.Select({id,master.id%20as%20masterId})%20as%20masterRelations}&where=(id=="+this.config.context.entity.id+")").done(e.bind(function(e){0!==e.length&&this.fire("badgeDataRetrieved",{badgeConfig:t,badgeData:e[0]})},this))},"bus badgeDataRetrieved":function(e){var t=e.data.badgeConfig,a=e.data.badgeData;this._setBadgeData(t,a)},_setBadgeData:function(e,t){var a={totalRelationCount:t.totalRelationCount,blockerRelationCount:t.blockerRelationCount};this.fire("setBadgeData",a)}});return a});