define(["Underscore","tau/core/model-base","tau/core/event","tau/configurator"],function(a,b,c,d){var e=b.extend({"bus currentFound":function(a){this._dataHandler(a.data)},"bus currentUpdated":function(a){d.getHistory().updateCurrent(a.data),this.bus.getGlobalBus().fire("history.setCurrent",a.data)},_dataHandler:function(b){var c=this;if(b){d.getHistory().setCurrent(b),this.bus.getGlobalBus().fire("history.setCurrent",b);var e=d.getHistory().stack,f=a.detect(e,function(a){return a.id===b.id});if(f){var g=a.indexOf(e,f);d.getHistory().stack=e.slice(0,g)}}this.bus.fire("stackFound",{})},"bus beforeInit+stackFound":function(){var b=a.clone(d.getHistory().stack);b=b.slice(-3),this.fire("dataBind",{items:b});var c=this}});return e})