define(["Underscore","tau/core/model-base"],function(_,ModelBase){var model=ModelBase.extend({"bus loadMore+nextPageCommandFormed":function(evt){var self=this,cmd=evt.nextPageCommandFormed.data;self.fire("partialDataRequest",{type:cmd.type,config:cmd.config})},"bus dataRequestCompleted":function(evt){var r=evt.data,self=this,isNextPageAvailable=r.data.isNextPageAvailable();isNextPageAvailable||self.fire("nextPageIsNotAvailable");var emptyMessage=r.data.length===0?this.config.emptyDataMessage:null;self.fire("dataLoaded",{data:{emptyMessage:emptyMessage,items:r.data}}),isNextPageAvailable&&(self.fire("nextPageCommandFormed",r.data.getNextPageCommand()),self.fire("nextPageAvailable",{}))},getFields:function(){var fields=this.config.fields||["id","name",{project:["id","abbreviation"]},{entityState:["id","name"]}];return fields},"bus newSearchQuery":function(evt){this.processSearchQuery(evt)},processSearchQuery:function(evt){var searchConfig=evt.data,self=this;_.extend(searchConfig.config,{fields:self.getFields()}),self.fire("partialDataRequest",{type:searchConfig.type,config:searchConfig.config})},"bus searchConfigFormed":function(evt){this.processSearchQuery(evt)},onInit:function(){var self=this,actions=this.config.actions||[];this.config.emptyDataMessage=this.config.emptyDataMessage||"No data found",self.fire("dataBind",{actions:actions,data:{items:[]}}),self.config.context&&self.config.context.entity?self.fire("dataRequest",{type:"general",config:{id:self.config.context.entity.id,fields:[{project:["id","name"]}]},callback:function(r){self.fire("requireSearchConfig",{project:r.data.project})}}):self.fire("requireSearchConfig",{})}});return model})