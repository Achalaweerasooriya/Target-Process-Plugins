define(["Underscore","tau/models/finder/model.build.search"],function(_,a){return a.extend({"bus requireSearchConfig":function(a){var b=this,c=a.data.project,d=this.config.context.entity;this.config.store.get("testPlanRun",{id:d.id,fields:["id",{project:["id",{process:["id",{practices:["id","name"]}]}]},{release:["id"]},{iteration:["id"]}]}).done({success:function(a){var c=a[0].data,d=c.project.process.practices,e=_.any(d,function(a){return a.name.toLowerCase()=="iterations"}),f={"Project.Id":null,"Release.Id":null};c.project&&(f["Project.Id"]=c.project.id),c.release&&(f["Release.Id"]=c.release.id),c.iteration&&e==1&&(f["Iteration.Id"]=c.iteration.id),b.setInitialLimits(f);var g={$skip:0,$limit:20,$query:f},h=b.getInitialQueryString();b.fire("searchConfigFormed",{type:b.getType(),config:g,properties:b.properties,searchQuery:h})}})}})})