define(["Underscore","jQuery","tau/core/extension.base","tau/core/tau"],function(e,r,t,i){var o=i.Error;return t.extend({"bus initialize":function(r,t){var i=this._extractOptions(t,{applicationId:e.uniqueId("app"),turnOffLoadingIndicator:!1,integration:{showInPopup:!1,keepAlive:!1,appendTo:null},routing:{silent:!1,executeOnStart:!0},comet:{enabled:!1}}),o=t.context.configurator;this.fire("configurator.ready",o),this.fire("options.ready",i),this.checkCompatibility(o).done(e.bind(function(){this.fire("routing.enable")},this)).fail(e.bind(function(e){this.fire("routing.disable"),this.fire("routing.forward",{url:"error",args:{error:e}})},this))},"bus afterInit":function(){this.fire("dataBind",{})},getCompatibilityMessage:function(t){var i={ieDocMode:"Targetprocess 3 does not support Internet Explorer in %s document mode. Please, turn standards mode.",other:'Targetprocess 3 is not supported in this browser. Please, try one of these:</p><div class="msg"><ul><li style=""><a href="http://www.google.com/chrome/">Google Chrome</a></li><li><a href="http://www.mozilla.com/firefox/">Mozilla Firefox</a> 10+</li><li><a href="http://www.microsoft.com/windows/Internet-explorer/">Internet Explorer</a> 9+</li><li><a href="http://www.apple.com/safari/download/">Safari</a> 5+</li></ul></div>'},o=r.browser;if(!(o.webkit||o.msie||o.mozilla||o.opera))return i.other;var n=parseInt(o.version,10);if(o.mozilla&&t&&10>n)return i.other;if(!o.msie)return null;var a=t?9:8;if("BackCompat"===document.compatMode)return e.sprintf(i.ieDocMode,"Quirks");var s=document.documentMode||6;return a>s?a>n?i.other:e.sprintf(i.ieDocMode,"IE"+s):null},checkCompatibility:function(e){var t=r.Deferred(),i=this.getCompatibilityMessage(e.isBoardEdition);return i?t.reject(new o("Browser is not supported",i)):t.resolve(),t}})});