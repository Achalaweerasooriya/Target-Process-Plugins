define(["Underscore","jQuery","tau/core/extension.base","tau/core/tau","tau/core/termProcessor","tau/models/dataprocessor/model.processor.context","Modernizr"],function(e,t,r,i,o,n,a){var s=i.Error;return r.extend({init:function(e){var t=e.context.configurator,r=t.getAppStateStore(),i=t.getApplicationContextService(),a=function(e){e.acid&&i.getApplicationContext({acid:e.acid},{success:function(e){var r=n({applicationContext:e});t.getTemplateFactory().setTermProcessor(new o(r.getTerms()))}})};r.bind({fields:["acid"],listener:this,callback:a}),r.get({fields:["acid"]}).then(a),this._super(e)},"bus initialize":function(t,r){var i=this._extractOptions(r,{applicationId:e.uniqueId("app"),turnOffLoadingIndicator:!1,integration:{showInPopup:!1,keepAlive:!1,appendTo:null},routing:{silent:!1,executeOnStart:!0},comet:{enabled:!1}}),o=r.context.configurator;this.fire("configurator.ready",o),this.fire("options.ready",i),this.checkCompatibility(o).done(e.bind(function(){this.fire("routing.enable")},this)).fail(e.bind(function(e){this.fire("routing.disable"),this.fire("routing.forward",{url:"error",args:{error:e}})},this))},"bus initialize + destroy":function(e,t){var r=t.context.configurator,i=r.getAppStateStore();i.unbind({listener:this})},"bus afterInit":function(){this.fire("dataBind",{})},getCompatibilityMessage:function(t){var r={ieDocMode:"Targetprocess 3 does not support Internet Explorer in %s document mode. Please, turn standards mode.",other:'Targetprocess 3 supports the two most recent versions of the following browsers:</p><div class="msg"><ul><li style=""><a href="http://www.google.com/chrome/">Google Chrome</a> (recommended)</li><li><a href="http://www.mozilla.com/firefox/">Mozilla Firefox</a></li><li><a href="http://www.microsoft.com/windows/Internet-explorer/">Internet Explorer</a></li><li><a href="http://www.apple.com/safari/download/">Safari</a></li></ul></div><p>'};if(t){var o=e.all(["csscalc","flexbox","inlinesvg","svg"],function(e){return a[e]}),n=/PhantomJS/.test(navigator.userAgent);
if(o||n)return null}else{var s=i.getIEVersion();if(s>=9){var c=9;if("BackCompat"===document.compatMode)return e.sprintf(r.ieDocMode,"Quirks");var l=document.documentMode||6;return c>l?c>s?r.other:e.sprintf(r.ieDocMode,"IE"+l):null}if(!s)return null}return r.other},checkCompatibility:function(e){var r=t.Deferred(),i=this.getCompatibilityMessage(e.isBoardEdition);return i?r.reject(new s("We're sorry, but this browser is not supported",i)):r.resolve(),r}})});