define(["Underscore","tau/core/model.editable.base","tau/models/model.state-list.strategies"],function(_,a,b){return a.extend({name:"states-list",onInit:function(){var a=this,c=a.config.context,d=c.entity.entityType.name,e=c.entity.id,f={id:e,fields:[{entityState:["id"]},{entityType:["id"]}]};d=="iteration"?f.fields=["id"]:d=="project"?f.fields=["id"]:d.toLowerCase()=="testcase"&&(f.fields=[{entityType:["id","name"]}]);var g=this.strategyConfig=b.get(a.config.listType);a.store.get(d,f).done({success:function(b){var d=_(c).clone();a.entity=d.assignable=b[0].data,a.store.get(g.listType,g.getCommand(d)).done({success:a.onDataRetrieved.tauCreateDelegate(a)})}})},onDataRetrieved:function(a){var b=this,c=this.entity,d=a[0].data,e=b.config.data&&b.config.data.value?b.config.data.value:b.config.data,f=b.strategyConfig.filter(c,d,e,b.config),g={states:f.items,completed:f.completed,nullableValue:f.nullableValue===!0};f.defaultValue&&(g.defaultValue=f.defaultValue),b.fire("dataBind",g)},"bus updateState":function(a){var b=this,c=a.data,d={},e=b.config.listType;d[e]={id:c.id},this.fire("save",d)},destroy:function(){this.strategyConfig=null,this._super()}})})