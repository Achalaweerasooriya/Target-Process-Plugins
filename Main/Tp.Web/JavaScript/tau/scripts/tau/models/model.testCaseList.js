define(["tau/core/model-base","tau/core/dates","tau/converters/converter.date","tau/utils/utils.urlBuilder"],function(a,b,c,d){function e(a){this.model=a}e.prototype={getAssignableRetrievedCallback:function(){return{scope:this,success:this.onAssignableRetrieved}},onAssignableRetrieved:function(a){var b={items:[]};this.model.assignable=a.data;var c=a.data.testCases,d=c.length;for(var e=0;e<d;e++)b.items.push(this.convertServerDataModelData(c[e]));this.model.bus&&this.model.bus.fire("dataBind",b)},convertServerDataModelData:function(a){var e=null;if(a.lastRunDate){var f=b.fromStringToDate(a.lastRunDate);e=c.convertDateToMothDayYearTimeString(f)}var g=undefined;a.lastStatus!=undefined&&(g={isPassed:a.lastStatus});var h={__type:"testCase",id:a.id,name:a.name,lastRunDate:e,applicationUrl:"#testcase/"+a.id,externalUrl:d.getViewUrl(a.id),steps:a.steps,success:a.success};g&&(h.lastRunStatus=g);return h}};var f=a.extend({onInit:function(){var a=this,b=new e(a),c=a.config.context.entity;this.store.get(c.entityType.name,{id:c.id,fields:["id",{testCases:["id","name","lastRunDate","lastStatus","steps","success"]}]},b.getAssignableRetrievedCallback()).done()},"bus evictTestCases":function(){var a=this.config.context.entity;this.store.evictProperties(a.id,a.entityType.name,["testCases","testCases-count"])}});return f})