define(["jQuery","Underscore","app.path","tau/core/query"],function($,_,a,b){var c=a.get(),d=c+"/slice/v1/";return{resolve:function(a,c){var e=a.global.acid;if(!e)throw"acid should be defined";var f=[d,c.method,"?type=matrix&definition={","cells:{"," items: [{ id:'"+a.cells.types[0]+"'}]",",filter: '"+(a.cells.filter||"")+"'","}",",x:{ id:'"+a.x.types[0]+"', filter:'"+(a.x.filter||"")+"'}",",y:{ id: '"+a.y.types[0]+"', filter:'"+(a.y.filter||"")+"'}",",global: {acid:'"+e+"'}","}"].join(""),g=_.clone(c.config||{});_.defaults(g,{$take:999}),f+="&take="+g.$take,g.$skip&&(f+="&skip="+g.$skip);var h=b.render(g);return h&&(f+="&where="+h),g.$set&&_.each(_.keys(g.$set),function(a){f+="&"+a+"="+g.$set[a]}),encodeURI(f)}}})