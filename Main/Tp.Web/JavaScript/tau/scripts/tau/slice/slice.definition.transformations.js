define(["Underscore"],function(e){return{createSliceDefinitionFromBoardSettings:function(t){var n=t.global?t.global.acid:null,i=t.global?t.global.entityId:null,r={global:{acid:n,entityId:i}};if(t.hasOwnProperty("x")){var o=this._convertToDefinitionItem(t.x);o&&(r.x=o)}if(t.hasOwnProperty("user")){var l=e.cloneDeep(t.user);l&&(r.user=l)}if(t.hasOwnProperty("y")){var s=this._convertToDefinitionItem(t.y);s&&(r.y=s)}if(t.hasOwnProperty("cells")&&(r.cells=this._convertToDefinitionCells(t.cells)),t.hasOwnProperty("colorSettings")){var a=this._convertToDefinitionColorSettings(t.colorSettings);a&&(r.color=a)}return t.hasOwnProperty("entityId")&&t.hasOwnProperty("entityType")&&(r.entityId=t.entityId,r.entityType=t.entityType,r.templateTypesFilter=t.templateTypesFilter),r},_convertToDefinitionColorSettings:function(e){var t=e&&e.customEncoding.filter(function(e){return e.filter}).map(function(e){return{value:JSON.stringify(e.value),filter:e.filter}})||[];return t.length?{id:"color",caseModel:{cases:t,combine:!0}}:null},_convertToDefinitionItem:function(t){if(!t)return null;t=e.cloneDeep(t);var n={};if(e.isString(t)&&(t=[t]),e.isArray(t))n.id=t.length?t[0]:null,n.filter=null,n.ordering=null;else if(e.isObject(t)){var i=t.type||t.types;n.id=e.isArray(i)?i.length?i[0]:null:i,e.isString(t.data)&&(n.data=t.data),this._convertFilterAndOrdering(t,n)}return n},_convertToDefinitionCells:function(t){if(!t)return null;t=e.cloneDeep(t);var n={};return e.isArray(t)?n.items=t:e.isObject(t)&&(n.items=t.items||t.types||t.type,this._convertFilterAndOrdering(t,n)),e.each(n.items,function(e,t){n.items[t]=this._convertToDefinitionItem(e)},this),n},_convertFilterAndOrdering:function(e,t){e.useFilter!==!1&&(t.filter=e.filter||null),t.ordering=e.ordering&&e.ordering.name?e.ordering:null}}});