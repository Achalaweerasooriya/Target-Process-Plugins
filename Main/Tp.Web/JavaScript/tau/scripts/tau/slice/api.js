define(["tau/core/Class","jQuery","Underscore","./url.resolver","./url.resolver.proto"],function(a,$,_,b,c){return a.extend({config:null,init:function(a){this.config=a||{},_.defaults(this.config,{service:$.ajax})},_deferredResolved:function(a,b){a.$deferred.resolve(b)},_deferredRejected:function(a,b){a.$deferred.reject(b)},resolve:function(a){a=a||{};var c=a.command||{},d=c.config||{},e=b,f=d.hasOwnProperty("$url")?d.$url:e.resolve(this.config.definition,c),g={url:f,dataType:"json",$scope:a},h={ajaxConfig:g,command:c},i=this;return this.config.service(g).done(function(b){h.data=b,i._deferredResolved(a,h)}).fail(function(b){h.data=b,i._deferredRejected(a,h)}),a.$deferred},url:function(a){return this.resolveDeferred("url",a)},x:function(a){return this.resolveDeferred("xaxis",a)},y:function(a){return this.resolveDeferred("yaxis",a)},move:function(a){return this.resolveDeferred("move",a)},axes:function(){var a=this.createDeferredCall("axes"),b={command:a.command};return $.when(this.x(),this.y()).done(function(c,d){b.data={x:c.data.items,y:d.data.items},a.$deferred.resolve(b)}).fail(function(c){b.data=c,a.$deferred.reject(b)}),a.$deferred},size:function(){var a=this.createDeferredCall("size"),b={command:a.command};return $.when(this.x(),this.y()).done(function(c,d){b.data={x:c.data.items.length,y:d.data.items.length},a.$deferred.resolve(b)}).fail(function(c){b.data=c,a.$deferred.reject(b)}),a.$deferred},cell:function(a){return this.resolveDeferred("cells",a)},list:function(a){return this.resolveDeferred("list",a)},createDeferredCall:function(a,b){var c=$.Deferred(),d={config:b,method:a};return{$deferred:c,command:d}},resolveDeferred:function(a,b){return this.resolve(this.createDeferredCall(a,b))}})})