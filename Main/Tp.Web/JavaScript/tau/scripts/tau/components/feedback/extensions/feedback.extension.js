define(["jQuery","Underscore","tau/components/extensions/component.extension.base","tau/utils/utils.serverErrorTranslator","template!tau/components/feedback/templates/feedback.template"],function(e,t,n,a,r){return n.extend({TEXT_TEMPLATE:["Like","----------------------","","","Miss","----------------------","","","Improve (your ideas)","----------------------","",""],"bus configurator.ready:last + dataBind + afterRender":function(e,t,n,a){var i=a.element.find(".i-role-feedback-btn");if(i.length){var s=i.data("feature")||"this feature",o=r.render({feature:s,text:this.TEXT_TEMPLATE.join("\n")}).on("click.sendFeedback",".i-role-actionok",function(){var e=o.find("textarea");i.tauBubble("hide"),t.getActionsService().sendFeedback(s,e.val()).then(function(t){return e.val(""),t}).done(this._handleSuccess.bind(this)).fail(this._handleError.bind(this))}.bind(this));i.tauBubble({content:o,zIndex:2,onShow:function(){i.addClass("tau-checked"),o.find("textarea").focus()},onHide:function(){i.removeClass("tau-checked")}}),this.$content=o}},_handleSuccess:function(){this.fire("notification",{message:"Feedback sent.",delay:500})},_handleError:function(e){var t=JSON.parse(e.responseText)||{Message:"Server is not available"},n=a.translateServerError.call(this,t);this.fire("error",n)},destroy:function(){this.$content&&this.$content.off(".sendFeedback"),this._super()}})});