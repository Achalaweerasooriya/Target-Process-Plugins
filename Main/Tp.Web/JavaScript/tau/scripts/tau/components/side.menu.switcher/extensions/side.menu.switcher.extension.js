define(["require","Underscore","tau/core/extension.base"],function(e){var t=e("Underscore"),s=e("tau/core/extension.base");return s.extend({init:function(e){this._super(e);var t=e.context.configurator;this._routing=t.getRouting(),this._showProcessSetup=null,this._onRouteChanged(this._routing.getCurrentRoute()),this._routing.routeChanged.add(this._onRouteChanged,this)},_processSetupRouteNames:["process-setup-terms","process-setup-general","process-setup-workflow"],_onRouteChanged:function(e){this.fire(t.contains(this._processSetupRouteNames,e.route.name)?"process.setup.start":"process.setup.close")},"bus componentsCreated:last + boardSettings.ready":function(e,t,s){this._fireOnChildren(t,"boardSettings.ready",s)},"bus componentsCreated:last + view.dom.ready":function(e,t,s){this._fireOnChildren(t,"view.dom.ready",s)},"bus configurator.ready:last + componentsCreated:last + afterRender":function(e,t,s,o){this._subscribe(t,o.element,s)},"bus configurator.ready:last + componentsCreated:last + afterRender:last + process.setup.start":function(e,t,s,o){this._toggleProcessSetup(t,o.element,s,!0)},"bus configurator.ready:last + componentsCreated:last + afterRender:last + process.setup.close":function(e,t,s,o){this._toggleProcessSetup(t,o.element,s,!1)},"bus configurator.ready:last + toggle.collapser":function(e,t,s){var o=t.getComponentBusRegistry();o.getByName("board.collapser.aside").then(function(e){e.fire(s)})},_subscribe:function(e,t,s){var o=this._toggleProcessSetup.bind(this,e,t,s,!0),n=this._toggleProcessSetup.bind(this,e,t,s,!1);this.bus.getGlobalBus().on("process.setup.start",o),this._onChildEvent(s,"process.setup.close",n)},_toggleProcessSetup:function(e,t,s,o){if(this._showProcessSetup===o)return void this._fireOnChildren(s,"_process.changed");this._showProcessSetup=o,t.find("[role=process-setup]").toggle(o),t.find("[role=board-menu]").toggle(!o);var n=o?"_process.setup.start":"_process.setup.close";this._fireOnChildren(s,n),this.fire("toggle.collapser",o?"disable":"enable")
},_fireOnChildren:function(e,s,o){t.each(e,function(e){e.component.fire(s,o)})},_onChildEvent:function(e,s,o){t.each(e,function(e){e.component.on(s,o)})},destroy:function(){this._routing.routeChanged.remove(this),this._super()}})});