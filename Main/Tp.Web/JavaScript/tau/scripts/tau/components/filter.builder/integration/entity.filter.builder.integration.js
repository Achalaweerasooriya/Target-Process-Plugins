define(["require","Underscore","tau/core/class","jQuery"],function(e){var t=e("Underscore"),n=e("tau/core/class"),i=e("jQuery");return n.extend({init:function(e){this._$element=i(e.htmlElement),this._initializeComponent=e.createComponentInContainer,this._createdComponent=null,this._eventNamespace=t.uniqueId(".entityFilterBuilderIntegration")},integrateWithInput:function(){this._$element.on("input"+this._eventNamespace,function(){var e=this._getCurrentText();e.length?this._destroyBuilder():this._initBuilder()}.bind(this)).on("click"+this._eventNamespace,function(){this._initBuilder()}.bind(this))},_getCurrentText:function(){return this._$element.prop("value")},_initBuilder:function(){if(!this._$element.tauBubble("instance")){var e=i("<div></div>");this._$container=e,this._createdComponent=this._initializeComponent(e),this._$element.tauBubble({content:e,onPositionConfig:function(e){e.my="left top",e.at="left+1 bottom-6"},showArrow:!1,className:"filter-builder-popup",stackName:"filterBuilderPopup",dontCloseSelectors:[".filter-builder",".i-role-filter-input"],showEvent:"__ignore",hideEvent:"__ignore",onHide:function(){this._destroyComponent(),this._$element.tauBubble("destroy")}.bind(this)})}this._$element.tauBubble("show")},_destroyComponent:function(){this._createdComponent.fire("destroy"),this._$container.remove()},_destroyBuilder:function(){this._$element.tauBubble("instance")&&this._$element.tauBubble("hide")},destroy:function(){this._destroyBuilder(),this._$element.off(this._eventNamespace)}})});