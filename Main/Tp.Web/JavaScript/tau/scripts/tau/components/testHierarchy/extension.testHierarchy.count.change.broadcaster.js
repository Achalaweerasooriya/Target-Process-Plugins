define(["require","tau/core/extension.base","Underscore"],function(t){var e=t("tau/core/extension.base"),n=t("Underscore");return e.extend({init:function(t){this._super(t),this.config=t},"bus eventAggregator.ready":function(t,e){this._unbind(e),e.totalNodeCountChanged.add(this._broadcast,this)},"bus eventAggregator.ready > destroy":function(t,e){this._unbind(e)},_unbind:function(t){t.totalNodeCountChanged.remove(this._broadcast,this)},_broadcast:function(t){var e=this.bus.getGlobalBus(),o=n.reduce(t.types,function(t,e){return t+e.count},0);e&&e.fire("test.hierarchy.count.changed",{entity:this.config.context.entity,count:o})}})});