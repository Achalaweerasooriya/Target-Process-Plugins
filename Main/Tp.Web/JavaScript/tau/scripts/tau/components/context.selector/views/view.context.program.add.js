define(["Underscore","jQuery","tau/core/class","template!tau/components/context.selector/templates/template.context.program.add"],function(t,e,n,r){var o=n.extend({init:function(e){this.onProgramCreate=t.Callbacks(),this._$container=e,e.on("click","[type=submit]",this._onSubmit.bind(this))},render:function(e){e.projects=t.map(e.projects,function(e){return t.extend({tooltip:""},e)}),this._$container.empty().append(r.render(e))},focus:function(){this._$container.find(".i-role-form :text:first").focus()},error:function(){this._$container.find(".i-role-form :text:first").focus().select().addClass("tau-error")},_onSubmit:function(){return this.onProgramCreate.fire(this._collectFormData()),!1},_getValueAsId:function(t){return parseInt(t.val(),10)},_collectFormData:function(){var t=e("input.tau-new-entity-name",this._$container).val(),n=e(".i-role-project [type=checkbox]:checked",this._$container).map(function(t,n){return{id:this._getValueAsId(e(n))}}.bind(this)).toArray();return{name:t,projects:n}}});return o});