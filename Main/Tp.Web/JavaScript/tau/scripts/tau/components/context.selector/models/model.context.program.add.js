define(["Underscore","jQuery","tau/components/context.selector/models/model.context.program"],function(e,t,n){var r=["id","name","color","isActive","process[id,name]"],o=["id","name","projects["+r.join(",")+"]"],i=n.extend({init:function(t){this.onProjectSaved=e.Callbacks(),this._super(t),this._store.on({type:"project",eventName:"afterSave",listener:this},this._onProjectSaved.bind(this))},getData:function(){return this.getAvailableProjects(r).then(function(e){return{projects:e}})},setData:function(e){var n=t.Deferred();return this._store.save("program",{$set:e,fields:o},{failure:n.reject}).done(function(e){n.resolve(e[0].data)}),n.promise()},_onProjectSaved:function(e){this.onProjectSaved.fire(e)}});return i});