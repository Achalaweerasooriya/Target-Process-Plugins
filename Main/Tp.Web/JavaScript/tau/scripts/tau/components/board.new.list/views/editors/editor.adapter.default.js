define(["Underscore","jQuery","tau/core/class","./editor.workflow"],function(e,t,i,n){return i.extend({init:function(){this.editorSaving=e.Callbacks(),this.editorSaved=e.Callbacks(),this.editFinished=e.Callbacks(),this.cleanedUp=e.Callbacks()},adaptEditorData:function(t,i){return e.cloneDeep(i)},createEditableElement:function(e){return this._editableDeferred||(this._editorBus=e,this._editableDeferred=t.Deferred(),this._getEditable(this._editorBus,this._editableDeferred)),this._editableDeferred},startEdit:function(e,i){t.when(this._editableDeferred).then(function(t){this._initEditor(t,e,i)}.bind(this))},_getEditable:function(e,t){e.on("afterRender",function(e,i){t.resolve(i.element)})},_initEditor:function(e,t,i){t.tauBubble("adjust");var d=new n(t,this._editorBus,i,this);d.start()},_enableBubbleAdjustOnKeydown:function(t,i){i.on("keydown",e.throttle(function(){t.data("ui-tauBubble")&&t.tauBubble("adjust")},400))},_focusOnText:function(e){e.find(":text").focus(1)}})});