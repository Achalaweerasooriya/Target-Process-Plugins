define(["require","Underscore","tau/core/controller.base","./controller.new.list.tree.root","tau/models/board.plus/model.board.slice.extender","../models/model.new.list.tree.root","tau/libs/boardSettings/board.settings.to.definition.translator"],function(e){var t=e("Underscore"),i=e("tau/core/controller.base"),o=e("./controller.new.list.tree.root"),n=e("tau/models/board.plus/model.board.slice.extender"),r=e("../models/model.new.list.tree.root"),s=e("tau/libs/boardSettings/board.settings.to.definition.translator");return i.extend({_lastRenderedElement:null,init:function(e,t,i,o,n,r,s,a,l){this._skeletonView=e,this._listModel=t,this._eventAggregator=i,this._configurator=r,this._editorComponentBuilder=o,this._quickAddComponentBuilder=n,this._sliceFactory=s,this._componentBus=a,this._behaviorsConfig=l},startLifeCycle:function(e,t,i){taus.start("statistics_newlist_cardLoad",{},"statistics_newlist_cardLoad");var o=new s(e,i);o.getBoardDefinition().then(function(e){var i=e.definition,o=e.configuration;this._eventAggregator.acidRetrieved.fire(i.global.acid),this._eventAggregator.boardSettingsRetrieved.fire(o),this._eventAggregator.definitionReady.fire(i,o);var r={definition:i},s=this._sliceFactory.create(r),a=new n;a.extend({slice:s},t).then(function(e){this._eventAggregator.sliceServiceCreated.fire({service:e.slice,definition:i})}.bind(this))}.bind(this))},buildSkeleton:function(e,t){var i=this._listModel.getEmptyModelInfoArgs(e.config.definition);this._eventAggregator.sliceInfoRetrieved.fire(i),this._skeletonView.buildSkeleton(e.config.definition,i,t)},render:function(e,i,n){var s=i.config.definition;e.get(["cellPaging"]).then(t.bind(function(a){var l={paging:a.cellPaging,boardId:e.settings.id,listSettings:{apiService:i,boardSettingsService:e,serviceContainer:this._configurator,options:n}},d=new r(l);if(this._listModel.setup(d,s),this._listModel.isNotConfigured())this._skeletonView.showNotConfiguredMessage();else{var g=new o(d,this._skeletonView,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,l);
g.startLifeCycle(),this._addChildDestroyable(g),t.each(this._createBehaviors(l,g),function(e){this._addChildDestroyable(e),e.attach()},this)}},this))},_createBehaviors:function(e,i){var o={eventAggregator:this._eventAggregator,skeletonView:this._skeletonView,configurator:this._configurator,componentBus:this._componentBus,rootTreeController:i,modelSettings:e,listModel:this._listModel,behaviorsSettings:this._behaviorsConfig.settings};return t.map(this._behaviorsConfig.behaviors,function(e){return new e(o)})}})});