define(["jQuery","Underscore","tau/core/class"],function(t,a,e){return e.extend({init:function(t,e){this.treeModel=t,this.slice=e,this.data=null,this.dataLoaded=a.Callbacks()},loadData:function(){if(this._isSupported()){var t=this._getParamsForLoadData();return this._loadData(t).done(this._handleDataResponse.bind(this))}},_loadData:function(){},_getParamsForLoadData:function(){return{$set:{path:this.treeModel.hierarchy.getPath(),expansionState:this.getExpansionStateForLoadData()}}},getExpansionStateForLoadData:function(){},_handleDataResponse:function(t){this._bindData(t.data)},_bindData:function(t){t.dataItem.dataItem.data&&(this.data=t.dataItem.dataItem.data),this.dataLoaded.fire(),a.each(t.nodes.items,function(t){var a=this.treeModel.hierarchy.findChildByCardId(t.dataItem.nodeId);this._getDataModelFromNodeModel(a)&&this._getDataModelFromNodeModel(a)._bindData(t)},this)},_bindSparseData:function(t){t.dataItem.dataItem&&(this.data=t.dataItem.dataItem.data,this.dataLoaded.fire()),a.each(t.nodes.items,function(t){var a=this.treeModel.hierarchy.findChildByCardId(t.dataItem.nodeId);a&&this._getDataModelFromNodeModel(a)&&this._getDataModelFromNodeModel(a)._bindSparseData(t)},this)},setSparseData:function(t){this._bindSparseData(t)},collapse:function(){this.data=null},_getDataModelFromNodeModel:function(){},_isSupported:function(){return!this.treeModel.hierarchyMetaInfo.isInnerCollectionsLevel}})});