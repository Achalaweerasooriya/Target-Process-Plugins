define(["Underscore","tau/core/controller.base","./controller.new.list.tree.node.collection"],function(t,e,i){return e.extend({init:function(t,e,i,s,o,n,r){this._model=t,this._viewBuilder=e,this._eventAggregator=i,this._configurator=n,this._editorComponentBuilder=s,this._quickAddComponentBuilder=o,this._modelSettings=r,this._model.nodeCollectionCreated.add(this._whenLoaded.bind(this)),this._model.loadingStatusChanged.add(this._onLoadingStatusChanged.bind(this))},startLifeCycle:function(){this._model.loadTreeData().then(function(){taus.stop("statistics_newlist_cardLoad",{"@":"--save-statistics_newlist_cardLoad",cardsCount:this._model.getCardsCount()}),taus.track("statistics",{"@":["--restore-statistics_newlist_cardLoad","--cast-statistics_newlist_cardLoad-to-statistics","--exclude-board-context"]})}.bind(this))},_whenLoaded:function(){var t=taus.start("statistics_newlist_initialRender",{});this._destroyTreeView();var e=this._model.nodes;this._rootTreeView=this._viewBuilder.createTreeView(e);var s=new i(e,this._rootTreeView,this._model,this._eventAggregator,this._editorComponentBuilder,this._quickAddComponentBuilder,this._configurator,this._modelSettings);this._addChildDestroyable(s),s.startLifeCycle().then(this._whenInitialListIsRendered.bind(this)).then(t.stop.bind(t)),this._eventAggregator.cellModelLoaded.fire(e)},_whenInitialListIsRendered:function(){this._viewBuilder.appendRoot(),this._viewBuilder.updateEmptyListMessage();var e=this._rootTreeView.$treeContainer;t.defer(function(){this._eventAggregator.treeRendered.fire(e)}.bind(this))},_onLoadingStatusChanged:function(t){this._viewBuilder.toggleProgress(t.isLoading)},destroy:function(){this._destroyTreeView(),this._super()},_destroyTreeView:function(){this._rootTreeView&&(this._rootTreeView.destroy(),this._rootTreeView=null)}})});