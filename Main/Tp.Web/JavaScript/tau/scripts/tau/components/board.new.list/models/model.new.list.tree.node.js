define(["Underscore","jQuery","tau/core/class","tau/ui/extensions/board.plus/ui.board.plus.utils","./model.new.list.tree.base","./hierarchy.meta","./card","./showMorePaging"],function(e,t,i,n,s,a,r,o){var d=s.extend({_createPaging:function(){return new o},_getNodeConstructor:function(){return d},resetModel:function(){this.collapse(),this.pagingModel.reset(),this.modelReset.fire()},expand:function(){var e=this._createTreeViewRequestArguments(0);return this._executeTreeDataWorkflow(function(t){return t.treeViewExpand(e)})},collapse:function(){this.nodes=null},goToNextPage:function(){if(!this.pagingModel.hasNext)return t.Deferred().resolve();this.pagingLoadingStarted.fire();var i=this.nodes.items.length<this.pagingModel.getTake()?this.nodes.items.length:this.pagingModel.getTake();return this._apiService.treeView(this._createTreeViewRequestArguments(i)).done(e.bind(function(e){var t=this.card?this.card.type:void 0,i=this._createNodeCollectionModel(e.data.nodes,new a(e.data.meta),this.level,!1,t),n=i&&i.items&&i.items.length;if(n){var s=i.items;this.nodes.removeDuplicatesWith(s),this.nodes.addNewItems(s)}this.pagingModel.updateWithResponseData(e.data.nodes),this.pagingModel.goToNextPage(),this.pagingUpdated.fire()},this)).done(this.countsModel.loadData.bind(this.countsModel)).fail(this._handleFailedTreeResponse.bind(this))},getCardId:function(){return this.card?this.card.getId():null},getCardType:function(){return this.card?this.card.getEntityType():null},_createTreeViewRequestArguments:function(e){var t=this.hierarchy.getPath();return{$skip:e,$take:this.pagingModel.getTake(),$set:{path:t}}}});return d});