define(["require","jQuery","./model.new.list.tree.base","./hierarchy.meta","./showMorePaging"],function(e){var t=e("jQuery"),i=e("./model.new.list.tree.base"),n=e("./hierarchy.meta"),r=e("./showMorePaging"),a=i.extend({_createPaging:function(){return new r(this)},_getNodeConstructor:function(){return a},resetModel:function(){this.collapse(),this.pagingModel.reset(),this.modelReset.fire()},expand:function(){var e=this._createTreeViewRequestArguments(0);return this._executeTreeDataWorkflow(function(t){return t.treeViewExpand(e)})},collapse:function(){this.nodes=null,this.pagingUpdated.empty(),this.pagingLoadingStarted.empty()},goToNextPage:function(){return this.pagingModel.hasNext?(this.pagingLoadingStarted.fire(),this._apiService.treeView(this._createTreeViewRequestArguments()).done(function(e){this.pagingModel.goToNextPage(),this._handleNewItemsLoaded(e.data.nodes,e.data.meta)}.bind(this)).fail(this._handleFailedTreeResponse.bind(this))):t.Deferred().resolve()},_handleNewItemsLoaded:function(e,t){var i=this.card?this.card.type:null,r=this._createNodeCollectionModel(e,new n(t),this.level,!1,i),a=r&&r.items&&r.items.length;if(a){var s=r.items;this.nodes.removeDuplicatesWith(s),this.nodes.addNewItems(s)}this.pagingModel.updateWithResponseData(e),this.pagingUpdated.fire(),this.countsModel.loadData()},getCardId:function(){return this.card?this.card.getId():null},getUnderlyingCardEntityType:function(){return this.card?this.card.getEntityType():null},getGenericCardEntityType:function(){return this.card?this.card.type:null},_createTreeViewRequestArguments:function(){var e=this.hierarchy.getPath();return{$skip:this.pagingModel.getSkip(),$take:this.pagingModel.getTake(),$set:{path:e}}}});return a});