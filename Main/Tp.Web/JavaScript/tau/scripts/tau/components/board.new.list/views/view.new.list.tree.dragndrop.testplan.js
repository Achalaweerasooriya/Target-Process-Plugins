define(["require","jQuery","./view.new.list.tree.dragndrop.base"],function(e){var t=e("jQuery"),i=e("./view.new.list.tree.dragndrop.base");return i.extend({PRIORITIZATION_OPTIONS:{enabled:{prioritizationPossible:!0,content:"Prioritization on"}},init:function(e,t,i,n){this._super(e,t,i,n),this._dataIsPrioritizable=this.treeModel.hierarchyMetaInfo.isPrioritizable,this._dataIsMovableToAnyLevel=this._dataIsPrioritizable,this._dataIsMovableToSameLevel=!1,this._dataIsMovable=this._dataIsMovableToAnyLevel||this._dataIsMovableToSameLevel,(this._dataIsMovable||this._dataIsPrioritizable)&&this._makeSortable()},_getSortableOptions:function(){var e=this._dataIsMovable;return{items:"> .i-role-card:not(.tau-axis-card-no-value), > .tau-list-level",cancel:"."+this.IS_BEING_MOVED_CLASS,handle:".tau-drag-handler-enabled.tau-drag-handler-level-"+this.level,connectWith:this._getMovableConnectionSelector(),axis:"y",opacity:.8,containment:e?null:this.containment,scrollSensitivity:33,tolerance:this.dndOptions.tolerance||"intersect",placeholder:this._createPlaceholder(),helper:this._createHelper.bind(this),start:function(t,i){var n=i.item;e&&(this._toggleMovingState(!0),this._markEmptyTreeContainer(n)),this._refreshPositions(),this._storeStartCoordinates(n)}.bind(this),change:e?function(e,t){this._forcePlaceholderAfterExpandedLevel(t.placeholder),this._adjustItemToLevel(t.helper,t.placeholder)}.bind(this):t.noop,stop:function(t,i){var n=i.item;e&&(this._toggleMovingState(!1),this._unmarkEmptyTreeContainer()),this._removePlaceholder(),this._getFinishCoordinates(n)||this._storeFinishCoordinates(n),this._moveCardWithSubTree(n)}.bind(this),receive:function(e,t){var i=t.item;this._storeFinishCoordinates(i),this._removeSubTree(i)}.bind(this)}},_getPrioritizationOptions:function(){return this.PRIORITIZATION_OPTIONS.enabled},_createPlaceholder:function(){return{element:function(){var e=this._getPrioritizationOptions();return t(this._createPlaceholderElement("tau-list-sortable-placeholder-float",e.content))
}.bind(this),update:function(){this._refreshPositions()}.bind(this)}},_removePlaceholder:function(){this.$treeContainer.find(".tau-list-sortable-placeholder-fixed").remove()},setDndOptions:function(e){this.dndOptions=e,this._updateSortableClasses()},isMovedWithPrioritization:function(){return!0},_toggleMovingState:function(e){this.containment.toggleClass("tau-moving",e)},_markEmptyTreeContainer:function(e){var t=this.$treeContainer.find("> .i-role-card:not(.i-role-placeholder)"),i=0===t.not(e).length;this.$treeContainer.toggleClass("empty",i)},_unmarkEmptyTreeContainer:function(){this.$treeContainer.removeClass("empty")}})});