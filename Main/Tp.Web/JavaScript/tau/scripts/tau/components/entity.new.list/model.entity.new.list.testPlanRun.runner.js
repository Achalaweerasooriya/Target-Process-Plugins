define(["require","Underscore","tau/core/class"],function(e){var n=e("Underscore"),t=e("tau/core/class");return t.extend({init:function(e,t){this._newListFacade=e,this._testPlanRun=t,this.nextRun=n.Callbacks()},runNext:function(e){this._goToNextToRun(e).then(this._runNext.bind(this,e))},_goToNextToRun:function(e){return this._withTreeModel(function(n){var t=Math.floor(e[0].index/n.pagingModel.pageSize);n.pagingModel.getCurrentPage()!==t&&n.goToPage(t)}.bind(this))},_withTreeModel:function(e){return this._newListFacade.getTreeModel().done(e)},_runNext:function(e){this._withTreeModel(function(t){var i=e[0].id,o=n.find(t.nodes.items,function(e){return e.card&&e.card.getId()===i});this.nextRun.fire(o)}.bind(this))},destroy:function(){this.nextRun.empty()}})});