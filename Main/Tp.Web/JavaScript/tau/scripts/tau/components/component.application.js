define(["tau/components/component.application.generic","tau/services/service.navigator","tau/ui/extensions/page/ui.extension.page.print","libs/parseUri"],function(t,e,n,i){return{create:function(a){var r=a.context.configurator;r.registerService("navigator",new e(r,{parameterName:a.options.applicationId||null}));var o="entity component",p=function(t,e,n){taus.track({"@":["--save-last-view-entity-context"],action:"view entity",name:"view "+t+" #"+e,tags:["view entity"],type:t,id:e});var i=taus.start("statistics_view",{"@":["--add-last-view-entity-context",function(t){var e="@timing";return t.loadTime=t[e],delete t[e],t}],entity:{id:e,type:t.toLowerCase()}});this.resolve({entity:{id:parseInt(e,10),type:t},action:n,handlers:{onPageLoaded:function(){i.stop()}}})},s=function(t,e,n){var i=this.configurator,a=i.getStore(),r=i.getBoardSettingsFactory().createComponentSettings({id:"project"}),o=$.Deferred();a.find("projectmember",{id:e,fields:[{project:["id"]}]}).done({success:function(t){var n=_.find(t[0].data[0],function(t){return t.id==e});o.resolve(n&&n.project?n.project.id:e)},failure:function(){o.resolve(e)}});var s=$.Deferred();r.set({set:{generalTab:"people"},callback:function(){s.resolve()}});var c=p.bind(this);$.when(o,s).done(function(t){c("project",t,n)})},c=function(t,e,n){var i="projectmember"==t.toLowerCase()?s:p;_.bind(i,this)(t,e,n||"show")};return a.routes=[{pattern:/^$/,adapter:function(){var t=this.configurator.getRouting().getReferer();t?this.configurator.service("navigator").to(t):this.fire("application.exit")},host:{name:"empty_host",type:"master.empty"},type:{name:o,type:"page.entity"}},{pattern:/finish-(\w+)\/([0-9]+)/,adapter:function(t,e){this.resolve({entity:{id:parseInt(e,10),type:t},applicationClassName:"tau-info-popup"})},host:{name:"empty_host",type:"master.empty"},type:{name:"entity_page",type:"page.finish-iteration"}},{pattern:/(\w+)\/([0-9]+)($|\s|&)/,adapter:function(t,e){_.bind(c,this)(t,e)},host:{name:"empty_host",type:"master.empty"},type:{name:o,type:"page.entity"}},{pattern:/(\w+)\/([0-9]+)\/silent/,adapter:function(t,e){_.bind(c,this)(t,e)},host:{name:"empty_host",type:"master.empty",turnOffLoadingIndicator:!0},type:{name:o,type:"page.entity",turnOffLoadingIndicator:!0}},{pattern:/(\w+)\/([0-9]+)\/print/,adapter:function(t,e){var n=i(window.location.href);"Print.aspx"!=n.file?this.configurator.service("navigator").to("#"+t+"/"+e):_.bind(c,this)(t,e,"print")},host:{name:"empty_host",type:"master.empty"},type:{name:o,type:"page.entity",hostClassName:"tau-page-entity",extensions:[n]}},{pattern:/(\w+)\/([0-9]+)\/(\w+)[&|]*.*/,adapter:function(t,e,n){_.bind(c,this)(t,e,n)},host:{name:"empty_host",type:"master.empty"},type:{name:o,type:"page.entity",hostClassName:"tau-page-entity"}}],t.create(a)}}});