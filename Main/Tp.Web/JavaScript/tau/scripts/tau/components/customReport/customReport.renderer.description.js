define(["require","jQuery","Underscore","tau/core/class"],function(i){var t=i("jQuery"),e=(i("Underscore"),i("tau/core/class")),s=e.extend({init:function(i){this._$el=i,this._$editEl=this._$el.find(".i-role-edit-mode"),this._$viewEl=this._$el.find(".i-role-view-mode"),this._$fullSectionEl=this._$el.find(".i-role-report-description")},setDescription:function(i){this._setValues({description:i.description||"",edit:!1})},bindDescription:function(i){this._boardSettings=i,this._bindDescriptionChanged(),this._refresh(),this._bindBoardSettingsChanged()},destroy:function(){this._boardSettings&&this._boardSettings.unbind(this)},_bindBoardSettingsChanged:function(){this._boardSettings.unbind(this),this._boardSettings.bind({listener:this,fields:["edit"],callback:function(){this._refresh()}.bind(this)})},_bindDescriptionChanged:function(){var i=function(){var i=this._titleizeDescription(this._$editEl.val());this._boardSettings.set({set:{description:i}}),this._$editEl.val(i)}.bind(this);this._$editEl.keyup(function(i){i.keyCode===t.ui.keyCode.ENTER&&this._$editEl.blur()}.bind(this)),this._$editEl.blur(i)},_refresh:function(){this._boardSettings.get({fields:["edit","description"]}).then(function(i){this._setValues(i)}.bind(this))},_setValues:function(i){var t=this._titleizeDescription(i.description);this._$editEl.val(t),this._$viewEl.text(t);var e=i.edit===!0;this._$editEl.toggle(e),this._$viewEl.toggle(!e);var s=Boolean(e||t);this._$fullSectionEl.toggle(s),this._$fullSectionEl.toggleClass("tau-board__report-editable-wide",s),this._$fullSectionEl.toggleClass("tau-board__report-editable-narrow",!s)},_titleizeDescription:function(i){return i?1===i.length?i.toUpperCase():i.charAt(0).toUpperCase()+i.slice(1):""}});return s});