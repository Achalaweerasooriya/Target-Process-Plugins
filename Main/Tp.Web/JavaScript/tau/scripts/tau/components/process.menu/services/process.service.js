define(["require","Underscore","jQuery","tau/utils/utils.serverErrorTranslator","tau/core/class","tau/libs/store2/store2"],function(e){"use strict";var r=e("Underscore"),t=e("jQuery"),s=e("tau/utils/utils.serverErrorTranslator"),n=e("tau/core/class"),o=e("tau/libs/store2/store2");return n.extend({MAX_PROCESS_COUNT:1e3,init:function(e){this._configurator=e,this._store2=new o(e)},_requiredFields:["Id","Name","IsDefault","Projects.Select(Name) as Projects","Practices.Select(Name) as Practices","Terms.Select({WordKey,Value}) as Terms"].join(","),getProcesses:function(){return this._store2.findAll("process?select={"+this._requiredFields+"}&take="+this.MAX_PROCESS_COUNT)},updateProcess:function(e,t){return this._getStore().saveDef("process",{$set:r.extend(t,{id:e})}).then(function(e){return e.data},function(e){this._handleXhrErrorRequest(e.data)}.bind(this))},deleteProcess:function(e){return this._getStore().removeDef("process",{id:e}).then(function(){return e},function(e){this._handleXhrErrorRequest(e.data)}.bind(this))},cloneProcess:function(e){return t.ajax({type:"POST",contentType:"application/json",dataType:"json",data:"{}",url:[this._configurator.getApplicationPath(),"/api/v1/Processes/",e,"/clone"].join("")}).fail(this._handleXhrErrorRequest.bind(this))},_getStore:function(){return this._configurator.getStore()},_handleXhrErrorRequest:function(e){this._configurator.service("errorBar").fire("error",s.translateXhrError(e))}})});