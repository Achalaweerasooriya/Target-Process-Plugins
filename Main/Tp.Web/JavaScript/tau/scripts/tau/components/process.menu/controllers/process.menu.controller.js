define(["require","tau/core/class","libs/react/react-ex","../services/process.service","../models/process.menu.model","jQuery","jsx!../views/process.menu.view"],function(e){"use strict";var s=e("tau/core/class"),t=e("libs/react/react-ex"),i=e("../services/process.service"),o=e("../models/process.menu.model"),n=e("jQuery"),r=e("jsx!../views/process.menu.view");return s.extend({init:function(e,s,c){this._container=c;var d=new i(e),h=e.getRouting(),l=e.getUrlBuilder();this._model=new o(d,h,l),this._viewIsInDom=n.Deferred();var a=t.resolveClass(s,r,{urlBuilder:e.getUrlBuilder(),activePage:this._model.getActivePage(),setActivePage:this._model.setActivePage.bind(this._model),actions:{renameProcess:this._model.renameProcess.bind(this._model),cloneProcess:this._cloneProcess.bind(this),deleteProcess:this._model.deleteProcess.bind(this._model)}});this._view=t.renderComponent(a,this._container),this._model.processesChanged.add(this._onProcessesChanges,this),this._model.activePageChanged.add(function(e){this._view.setProps({activePage:e})},this),n.when(this._model.refresh(),this._viewIsInDom).then(function(){this._view.setState({isInDom:!0})}.bind(this)),n.contains(document.documentElement,this._container)&&this.markAsInDom()},_cloneProcess:function(e){this._model.cloneProcess(e).then(function(e){this._model.setActivePage({processId:e})}.bind(this))},updateActivePage:function(){this._model.setActivePage()},markAsInDom:function(){this._viewIsInDom.resolve()},destroy:function(){t.unmountComponentAtNode(this._container),this._model.destroy(),this._model=null,this._view=null},_onProcessesChanges:function(e){this._view.setState({processes:e})}})});