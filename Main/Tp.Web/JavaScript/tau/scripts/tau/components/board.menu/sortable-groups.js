define(["jQuery","tau/core/class","tau/components/react/mixins/sortable.axis.y"],function(t,e,r){return e.mixin(r,{getDefaultSortableOptions:function(){return{sortableRootSelector:".i-role-board-menu",sortableItemSelector:".t3-view",sortableGroupSelector:".t3-view-list-regular-group",sortableHandleSelector:null,groupSelector:".t3-view-list-group",sortItems:null,sortGroups:null}},_removeDropClasses:function(t){return t.removeClass("t3-drop-target t3-drop-item-target t3-drop-group-target t3-drop-before t3-drop-after")},_addDropClasses:function(t){this._super(t);var e=this.getSharedSortState();e.elementIsGroup?t.addClass("t3-drop-group-target"):(t.addClass("t3-drop-item-target"),e.$targetGroup&&e.$targetGroup.addClass("t3-drop-target t3-drop-item-target"))},_expandGroup:function(){var t=this.getSharedSortState(),e=t.$targetGroup;if(e&&e[0]){var r=this._getSortableKey(e);this.props.model.expandGroup(r)}},_findSection:function(t){var e=t.closest(".t3-views-section");if(0===e.length){var r=this._findSortableRoot(t);e=r.find(".t3-views-section:last")}return e},_findContainingGroup:function(t){return t.closest(this.sortableOptions.groupSelector)},_findSortableTargetFromEventForItem:function(e,r){var o=this.getSharedSortState();if(!o.overNonSortable)return{$group:this._findContainingGroup(r),$element:r};var i,n=t(e.target),s=this._findContainingGroup(n);if(0===s.length&&(i=this._findSection(n),s=i.find(".t3-view-list-group:last"),0===s.find(".t3-view:not(.t3-dragging)").length))return{$group:s,$element:s};var a=n.closest(".t3-header");return a.length?(s=this._findContainingGroup(a),r=this._findFirstSortable(s),{$group:s,$element:r.length?r:s}):(s=this._findContainingGroup(r),s.length?(r=this._findLastSortable(s),{$group:s,$element:r.length?r:s}):(n.is(".t3-views-section > .t3-name")&&(i=this._findSection(n),r=this._findFirstSortable(i),s=this._findContainingGroup(r)),{$group:s,$element:r}))},_findSortableTargetFromEventForGroup:function(e){var r,o,i=t(e.target),n=i.closest(".t3-views-section");
if(!n.length)return r=this._findSortableRoot(i),o=r.find(this.sortableOptions.sortableGroupSelector+":last"),o.length||(o=r.find(".t3-view-list-group:last")),o;if(o=i.closest(this.sortableOptions.sortableGroupSelector),o.length)return o;var s=n.find(this.sortableOptions.sortableGroupSelector);if(s.length)return o=i.is(".t3-views-section")||i.closest(".i-role-board-menu-item").length?s.last():s.first();var a=n.find(".t3-view-list-group");return a.length?o=a:(r=this._findSortableRoot(i),o=r.find(this.sortableOptions.sortableGroupSelector+":first"),o.length||(o=r.find(".t3-view-list-group:last")),o)},_findSortableTargetFromEvent:function(t){var e,r,o=this.getSharedSortState();if(o.elementIsGroup)e=this._findSortableTargetFromEventForGroup(t),r=e;else{var i=this._super(t),n=this._findSortableTargetFromEventForItem(t,i);e=n.$group,r=n.$element}var s=o.$targetGroup&&o.$targetGroup[0];return s!==e[0]&&(clearTimeout(o.groupExpandTimeout),o.$targetGroup=e,o.elementIsGroup||(o.groupExpandTimeout=setTimeout(this._expandGroup,500))),r},_clearSortState:function(){var t=this.getSharedSortState();clearTimeout(t.groupExpandTimeout),this._super()},_updateSortStateSource:function(e){var r=this.getSharedSortState();r.$element=t(e).closest("[draggable]"),r.key=this._getSortableKey(r.$element),r.type=this._getSortableType(r.$element),r.elementIsGroup=r.$element.is(this.sortableOptions.groupSelector)},_getSortableText:function(){var t=this.getSharedSortState();return t.elementIsGroup?t.$element.find(".t3-group > .i-role-view-menu-header").text():t.$element.find("a").prop("href")},_sortItems:function(){var t=this.getSharedSortState(),e=t.key,r=t.target.$element,o=this._getSortableKey(r);if(e!==o){var i=t.placeAfter;if(t.elementIsGroup)return void(t.$element.is(i?r.next():r.prev())||this.sortableOptions.sortGroups(e,o,i));var n=this._getSortableKey(t.$targetGroup);n===o||null===n?this.sortableOptions.sortItems(e,null,n,!1):this.sortableOptions.sortItems(e,o,n,i)}}})});