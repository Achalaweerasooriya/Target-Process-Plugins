define(["require","Underscore","tau/core/class","./board.menu.constants","./../services/board.menu.transformations.service"],function(e){var t=e("Underscore"),i=e("tau/core/class"),r=e("./board.menu.constants"),n=e("./../services/board.menu.transformations.service"),o={};return o[r.FAVORITES_SECTION_TYPE]="Favorites",o[r.OTHERS_SECTION_TYPE]="Other",i.extend({init:function(e,i){this._urlService=e,this.viewsMenuSectionUpdated=t.Callbacks(),this.name=o[i.sectionType],this.sectionType=i.sectionType,this.viewMenuGroups=t.sortBy(i.groups,t.property("menuNumericPriority")),t.each(this.viewMenuGroups,function(e){e.viewsMenuGroupUpdated.add(this._onGroupUpdated,this)},this)},getVisibleData:function(e){var i=this.viewMenuGroups,r=n.getVisibleViewGroups(i,e),o=e.filterText?this.getBoardsInSection():t.flatMap(r,t.property("boards")),u=n.getVisibleBoards(o,e);return{groups:r,boards:u}},getIsOthersSection:function(){return this.sectionType===r.OTHERS_SECTION_TYPE},getIsFavoritesSection:function(){return this.sectionType===r.FAVORITES_SECTION_TYPE},_initGroupModel:function(e){e.viewsMenuGroupUpdated.add(this._onGroupUpdated,this)},getBoardsInSection:function(){return t.flatMap(this.viewMenuGroups,t.property("boards"))},addMenuGroup:function(e){return this._initGroupModel(e),this.viewMenuGroups.push(e),this.viewMenuGroups=t.sortBy(this.viewMenuGroups,t.property("menuNumericPriority")),this.viewsMenuSectionUpdated.fire(this),e},moveGroupToSection:function(e,t){this._removeMenuGroupInternal(e),t.addMenuGroup(e)},removeMenuGroup:function(e){var t=this._findGroupById(e);t&&(t.moveAllBoardsToGroup(this.getUngroupedGroup()),this._removeMenuGroupInternal(t))},_removeMenuGroupInternal:function(e){e.viewsMenuGroupUpdated.remove(this),this.viewMenuGroups=t.without(this.viewMenuGroups,e),this.viewsMenuSectionUpdated.fire(this)},getUngroupedGroup:function(){return t.find(this.viewMenuGroups,function(e){return e.getIsUngroupedGroup()})},_findGroupById:function(e){return t.findWhere(this.viewMenuGroups,{groupId:e})
},findGroupIndexById:function(e){return t.findIndex(this.viewMenuGroups,t.matches({groupId:e}))},invalidateGroupsOrder:function(){this.viewMenuGroups=t.sortBy(this.viewMenuGroups,t.property("menuNumericPriority")),this.viewsMenuSectionUpdated.fire(this)},_onGroupUpdated:function(){this.viewsMenuSectionUpdated.fire(this)}})});