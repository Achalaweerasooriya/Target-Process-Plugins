define(["require","Underscore","tau/core/class","./board.menu.board","./board.menu.constants"],function(r){var t=r("Underscore"),e=r("tau/core/class"),o=r("./board.menu.board"),a=r("./board.menu.constants"),i=["key","name","isExpanded","isFavorite","menuNumericPriority","menuIsVisible","isShared","customSharedData","ownerIds"];return e.extend({init:function(r,e){this._urlService=r,this.viewsMenuGroupUpdated=t.Callbacks(),this.boards=t.chain(e.boards).sortBy(t.property("menuNumericPriority")).map(this._createBoardModel,this).value(),this._applyGroupData(e),this.groupTypes=[];var o=e.key;o===a.FAVORITES_GROUP_KEY&&this.groupTypes.push(a.FAVORITES_GROUP_TYPE,a.UNGROUPED_GROUP_TYPE),o===a.UNGROUPED_GROUP_KEY&&this.groupTypes.push(a.UNGROUPED_GROUP_TYPE)},getIsFavoriteUngroupedGroup:function(){return this.isFavorite&&this.getIsUngroupedGroup()},getIsRegularGroup:function(){return!this.getIsUngroupedGroup()},getIsUngroupedGroup:function(){return t.contains(this.groupTypes,a.UNGROUPED_GROUP_TYPE)},getIsPrivate:function(){return!this.isShared},getIsCustomShared:function(){return this.isShared&&this.customSharedData&&this.customSharedData.isActive},findBoardIndexById:function(r){return t.findIndex(this.boards,t.matches({boardId:r}))},hasBoard:function(r){return this.findBoardIndexById(r)>-1},updateGroupData:function(r){this._applyGroupData(r),this.viewsMenuGroupUpdated.fire(this)},invalidateViewsOrder:function(){this.boards=t.sortBy(this.boards,t.property("menuNumericPriority")),this.viewsMenuGroupUpdated.fire(this)},getUpdatedGroupData:function(r){var e=t.extend(t.deepClone(this._storedGroupData||{}),t.pick(r,i));return t.defaults(e,{isFavorite:!1})},_applyGroupData:function(r){var e=this.getUpdatedGroupData(r);this._storedGroupData=e,t.extend(this,e),this.groupId=e.key},createBoardInGroup:function(r){return this.createBoardsInGroupBatch([r])[0]},createBoardsInGroupBatch:function(r){var e=t.map(r,this._createBoardModel,this);return this.boards=this.boards.concat(e),this.invalidateViewsOrder(),e
},removeBoard:function(r){var e=t.findWhere(this.boards,{boardId:r});return e&&(this.boards=t.without(this.boards,e),this.viewsMenuGroupUpdated.fire(this)),e?e.storedViewData:null},_removeBoardsBatchInternal:function(r){var e=t.filter(this.boards,function(e){return t.contains(r,e.boardId)});return this.boards=t.difference(this.boards,e),t.map(e,t.property("storedViewData"))},moveBoardToGroup:function(r,t){var e=this.removeBoard(r);return t.createBoardInGroup(e)},moveBoardsToGroupBatch:function(r,t){var e=this._removeBoardsBatchInternal(r);this.viewsMenuGroupUpdated.fire(this),t.createBoardsInGroupBatch(e)},moveAllBoardsToGroup:function(r){var e=t.map(this.boards,t.property("boardId"));this.moveBoardsToGroupBatch(e,r)},_createBoardModel:function(r){var t=new o(this._urlService,r);return t.boardUpdated.add(this._onBoardUpdated,this),t},_onBoardUpdated:function(){this.viewsMenuGroupUpdated.fire(this)}})});