define(["jQuery","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit",editableIndexes:null,init:function(t){this._super(t),this.onRowClickProxy=e.proxy(this.onRowClick,this)},"bus beforeComponentsInitialize":function(e,t){this.editableIndexes=[],this.createComponentList(t),this.attachListeners()},"bus afterRender":function(e){this.$el=e.data.element,this.addEditableBehaviour()},"bus refresh":function(){this.clearComponent()},createComponentList:function(e){this.components=[];for(var t=1;t<e.length;t+=2)this.components.push(e[t].component)},addEditableBehaviour:function(){for(var e=0;e<this.editableIndexes.length;e++)this.doEditableRow(this.editableIndexes[e])},attachListeners:function(){var e=this.components;if(e)for(var t=0;t<e.length;t++)e[t].on("permissionsReady",this.onPermissionsReady,this,{index:t})},removeListeners:function(){var e=this.components;if(e)for(var t=0;t<e.length;t++)e[t].removeListener("permissionsReady",this.onPermissionsReady,this)},onRowClick:function(t){var i=e(t.target);i.is("a")||i.parent().is("a")||(t.stopPropagation(),t.data.component.fire("edit"))},doEditableRow:function(e){var t=this.$el.find(" > tbody > tr").eq(e);t.off("click",this.onRowClickProxy),t.on("click",{component:this.components[e]},this.onRowClickProxy),t.addClass("ui-additionalinfo_editable_true")},onPermissionsReady:function(e){if(e.data.editable){var t=e.listenerData.index;this.$el?this.doEditableRow(t):this.editableIndexes.push(t)}},clearComponent:function(){this.removeListeners(),delete this.components,delete this.editableIndexes,delete this.$el},destroy:function(){this.clearComponent(),this._super()}})});