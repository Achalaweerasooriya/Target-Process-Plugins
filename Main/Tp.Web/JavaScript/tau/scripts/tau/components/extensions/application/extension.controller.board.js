define(["Underscore","jQuery","tau/core/event.emitter","tau/utils/utils.redirect","tau/components/extensions/print.convert.extension"],function(_,$,a,b,c){return a.extend({init:function(a){this._super(a),this.config=a},"bus view.dom.ready+componentsCreated":function(a){var b=a.componentsCreated.data;_.each(b,function(a){a.component.fire("view.dom.ready")})},"bus afterRender:last+innerContentRendered":function(a){var b=a.afterRender.data.element,c=a.innerContentRendered.data.element,d="",e="";c.hasClass("tau-board-container")?(d="tau-page-board",e="tau-page-entity"):(d="tau-page-entity",e="tau-page-board"),b.removeClass(e).addClass(d).append(c)},"bus application.navigate.board":function(a){this.executeAction({strategy:"board",action:"actionBoard",parameters:a.data})},"bus application.navigate.entity":function(a){var b=a.data,c="action"+(b.action||"show").toLocaleLowerCase();c=this.hasOwnProperty(c)?c:"actionshow",this.executeAction({strategy:"entity",action:c,parameters:b})},executeAction:function(a){var b=this;require(["tau/components/component.page."+a.strategy],function(c){var d=a.action,e=a.parameters;b.fire("controller.preExecute",{action:d,parameters:e}),b[d](c,e.id,e.entity),b.fire("controller.postExecute")})},actionBoard:function(a,b){this.current&&this.current.fire("destroy");var c=this,d={context:{configurator:c.config.context.configurator,entity:{id:b,entityType:{name:"board"}}}};this.current=a.create(d),this.current.on("componentsCreated",function(a){this.fire.apply(c,arguments)},this),this.current.on("error",function(a){c.fire("application.error")}),this.current.on("afterRender",function(a){c.fire("innerContentRendered",{element:a.data.element})}),this.current.on("componentsCreated",function(a){c.fire("componentsCreated",a.data)}),this.current.initialize()},_getItemConfig:function(a,b){return{context:{configurator:this.config.context.configurator},entity:{id:a,type:b}}},actionshow:function(a,b,c){this._action(a,b,c),$("html").toggleClass("tau-html_action_view",!0).toggleClass("tau-html_action_print",!1)},actionprint:function(a,b,d){this._action(a,b,d,{extensions:[c]}),$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!0),$("body").addClass("print-mode")},_action:function(a,c,d,e){$("html").toggleClass("tau-html_action_view",!1).toggleClass("tau-html_action_print",!1),this.current&&this.current.fire("destroy");var f=this;this.current=a.create(this._getItemConfig(c,d),e||{}),this.current.on("beforeDelete",function(a){f.fire("initProgress")}),this.current.on("deleted",function(a){var c=f.config.context.configurator.getHistory(),d=new b,e=c.pop();e?(c.setCurrent(null),d.redirect(e.url)):f.fire("application.exit")}),this.current.on("error",function(a){f.fire("application.error")}),this.current.on("afterRender",function(a){f.fire("innerContentRendered",{element:a.data.element})}),this.current.initialize()},destroy:function(){this._super(),this.current&&this.current.fire("destroy"),delete this.current,delete this.config}})})