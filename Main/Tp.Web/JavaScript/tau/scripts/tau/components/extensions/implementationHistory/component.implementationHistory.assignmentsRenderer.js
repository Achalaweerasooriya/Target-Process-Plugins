define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(t,e,n){return n.extend({"bus afterRender+stateProgressRendered":function(t){this._$element=t.afterRender.data.element,this._data=t.afterRender.data.data,this._render()},_render:function(){var n=this._$element.find(".tau-historyGrid .tau-historyItem");t.each(this._data.historyItems,function(t,s){t.assignments&&!t.state.isFinal&&e('<div class="tau-assignments"/>').insertAfter(n.eq(s).find(".tau-flow")).append(this._getAssignments(t))},this)},_getAssignments:function(e){var n=[];return t.each(e.assignments,function(t){var s=[t.firstName,t.lastName,"("+this._getAssignmentRoles(t)+")"].join(" "),i=t.avatarUri+"50",a=this._isActiveAssignment(t,e)?' class="active"':"";n.push("<img"+a+' alt="avatar" title="'+s+'" src="'+i+'"/>')},this),n.join("")},_getAssignmentRoles:function(e){return t.map(e.roles,function(t){return t.name}).join(", ")},_isActiveAssignment:function(e,n){return t.any(e.roles,function(t){return t.id==n.state.roleId})}})});