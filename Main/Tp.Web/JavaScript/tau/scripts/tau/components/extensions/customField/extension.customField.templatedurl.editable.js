define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.editableText","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,i){return i.extend({category:"edit","bus permissionsReady+afterRender":function(e){var t=this,i=e.afterRender.data.data,a=e.permissionsReady.data;if(a.editable){var n=e.afterRender.data.element,o=n.find(".ui-customfield__value");t.$widget=o;var d;o.editableText({onEditStart:function(){d=o.children().detach(),o.text(""),o.hasClass("ui-validationerror")||o.text(o.data("textEdit"))},onEditEnd:function(){o.hasClass("ui-validationerror")||o.html(d)},restoreText:!1,onSave:function(e){t.bus.fire("save",{customFields:[{name:i.name,type:i.type,value:e}]})}}),o.on("click","a",function(e){e.stopImmediatePropagation()}),n.behaviourCustomFieldRow({onActivate:function(){o.editableText("activate"),o.focus()}}),n.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.editableText("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.editableText("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.editableText("setValidationErrors",e.data.validation.errors[0].description)}})});