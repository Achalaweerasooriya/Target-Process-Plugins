define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,ComponentExtensionBase){return ComponentExtensionBase.extend({"bus afterRender":function(evt){this._$element=evt.data.element,this._data=evt.data.data,this._render()},_render:function(){var stateDateItemsHash=this._createStateDateItemsHash();this._$element.find(".tau-historyGridInterpretation .stateName").each(function(index,state){var $state=$(state),stateInfo=stateDateItemsHash[$state.text()],title=$state.attr("title")+" ("+stateInfo.absolute+" days)";$state.attr("title",title).addClass("tau-dateItems-"+stateInfo.relative)})},_createStateDateItemsHash:function(){var hash={};return _.each(this._data.entityStates,function(stateName){hash[stateName]={absolute:0,relative:0}}),this._calculateAbsoluteHashValues(hash),this._calculateRelativeHashValues(hash),hash},_calculateAbsoluteHashValues:function(hash){_.each(this._data.historyItems,function(item){var dateSpan=item.state.dateSpan;dateSpan&&(hash[item.state.name].absolute+=dateSpan)})},_calculateRelativeHashValues:function(hash){var maxValue=_.max(hash,function(dateItemsCount){return dateItemsCount.absolute}).absolute;_.each(hash,function(dateItemsCount,stateName){var relativeCount=dateItemsCount.absolute*100/maxValue;hash[stateName].relative=Math.round(relativeCount/10)*10})}})})