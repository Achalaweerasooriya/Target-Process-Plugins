define(["Underscore","tau/components/extensions/component.extension.base"],function(e,t){return t.extend({category:"edit","bus permissionsReady+afterRender+dataBind":function(t){var n=this,i=this.element=t.afterRender.data.element;t.afterRender.data.element.find(".external-view").click(function(e){e.stopPropagation()});var o=this.permissions=t.permissionsReady.data;if(o.editable!==!1){i.find(".tau-property").addClass("tau-property_editable_true"),i.addClass("tau-editable");var a=t.dataBind.data;if(a.text&&a.text.length||i.find(".property").addClass("editable"),o.editable){this.config.targetElementSelector=this.config.targetElementSelector||".property-text";var s=this.config.targetElementSelector||"",r=this.config.alignElementSelector||"",d={components:[e.extend({data:a},this.config.editorComponentConfig)],context:n.config.context},l={target:i.is(s)?i:i.find(s),alignTo:i.is(r)?i:i.find(r),componentsConfig:d,applyBubbleClasses:this.config.applyBubbleClasses,onPositionConfig:this.config.onPositionConfig||$.noop,className:this.config.bubbleClassName,onShow:e.bind(function(){this.config.context.configurator.getKeyBoardManager().pushHandler({})},this),onHide:e.bind(function(){this.config.context.configurator.getKeyBoardManager().popHandler()},this),dontCloseSelectors:[".i-role-bubble"]};this.fire("initBubble",l),i.on("click",".i-role-reset",e.bind(function(){return this.fire("reset.apply"),!1},this))}}},"bus edit":function(){this.permissions.editable&&this.fire("toggleBubble")}})});