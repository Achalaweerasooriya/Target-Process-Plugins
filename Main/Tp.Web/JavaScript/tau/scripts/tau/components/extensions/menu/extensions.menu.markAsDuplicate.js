define(["tau/components/extensions/component.extension.base"],function(ExtensionBase){var popupId=0;return ExtensionBase.extend({"bus markAsDuplicate":function(evt){var generalID=evt.data.generalID;this.markAsDuplicate(generalID)},markAsDuplicate:function(generalID){var configurator=this.config.context.configurator;Ext.WindowMgr.zseed=99999;var projectIds=[];for(var i=0;i<_projectContext.length;i++)projectIds.push(_projectContext[i].id);var self=this,wnd=Tp.controls.Duplicate.CreatePopup(projectIds,generalID,undefined,{onMarkDelegate:function(data){var store=self.config.context.configurator.getStore(),promise=store.freeze();self.fire("bugWasMarkedAsDuplicate",data),promise.unfreeze()}});wnd.show(projectIds,generalID),configurator.getKeyBoardManager().pushHandler({handleKeyDown:function(evt){evt.which==27&&(configurator.getKeyBoardManager().popHandler(),wnd.hide(),wnd.destroy())}})}})})