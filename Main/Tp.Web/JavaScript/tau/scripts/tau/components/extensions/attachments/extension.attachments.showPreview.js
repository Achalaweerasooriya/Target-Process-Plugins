define(["Underscore","tau/components/extensions/component.creator.extension"],function(e,t){return t.extend({"bus initialize":function(e){var t=e.data.context,i=t.entity,n={entityType:i.entityType,id:i.id};this.contextForPreview={applicationContext:t.applicationContext,entity:n,configurator:t.configurator}},"bus beforeInit":function(t,i){i.config.context.configurator.getComponentBusRegistry().getByName("imagePreview").done(e.bind(function(e){this.fire("previewBus.ready",e)},this))},"bus previewBus.ready:last + attachments:last + image.selected":function(t,i,n,o){i.fire("refresh",{items:e.filter(n,function(e){return e.mimeType&&0===e.mimeType.indexOf("image/")}),selectedId:o.id})},"bus attachments:last + attachmentSelected":function(t,i,n){var o=e.find(i,function(e){return e.id===n});o.mimeType&&0===o.mimeType.indexOf("image/")?this.fire("image.selected",o):window.open(o.uri,"_blank")}})});