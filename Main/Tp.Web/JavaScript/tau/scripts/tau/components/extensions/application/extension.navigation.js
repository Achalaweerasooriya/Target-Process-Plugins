define(["Underscore","jQuery","tau/core/extension.base"],function(_,$,ExtensionBase){return ExtensionBase.extend({"bus configurator.ready":function(evt,configurator){var self=this;configurator.getRouter().on("urlToNavigate.ready",function(evt,url){self.fire("urlToNavigate.ready",url)})},"bus options.ready:last + innerContentRendered":function(e,options,renderData){if(!options.routing.silent)return;var self=this,$el=renderData.element;$el.delegate("a","click",function(e){if(e.ctrlKey||e.metaKey)return;var href=$(e.currentTarget).attr("href")||"";if(href==="#")return;href.charAt(0)==="#"&&(e.preventDefault(),e.stopPropagation(),self.fire("urlToNavigate.ready",href))})},"bus options.ready:last + configurator.ready:last + urlToNavigate.ready":function(evt,options,configurator,url){var router=configurator.getRouter(),external=configurator.getExternal();url.charAt(0)==="#"&&(url=url.substring(1));if(options.routing.silent){var nv=url.split("/"),entityParams={id:nv[1],entity:nv[0],action:nv[2]};router.fire("changed",entityParams),this.fire("application.navigate.entity",entityParams)}else external.setHash(url)}})})