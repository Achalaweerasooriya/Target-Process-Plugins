define(["tau/components/extensions/component.extension.base"],function(ExtensionBase){return ExtensionBase.extend({"bus configurator.ready:last + entity.ready:last + convertTo":function(evt,configurator,entity,convertTo){var self=this,service=configurator.getActionsService();self.fire("showProgress",{text:"Converting..."});var generalId=entity.id,convertSuccess=function(result){self.fire("hideProgress");var general=result.d,parts=general.EntityTypeName.split("."),typeName=parts[parts.length-1],data={entity:{id:general.GeneralID},entityType:{name:typeName}};configurator.getHistory().exclude(generalId,!1),configurator.getRouter().navigate("#"+typeName.toLowerCase()+"/"+general.GeneralID),window._criticalTauChanges=!0,self.fire("generalWasConverted",data)},convertFailed=function(result){self.fire("hideProgress");var parseJSON=jQuery.parseJSON(result.responseText)||{Message:"Server is not available"},errorMessage=parseJSON.Message;self.fire("error",{message:errorMessage})};convertTo.entityType.name.toLowerCase()=="task"?service.convertGeneralToTask(generalId,convertTo.userStory.id,convertSuccess,convertFailed):service.convertGeneralToType(generalId,convertTo.entityType.id,convertSuccess,convertFailed)}})})