define(["Underscore","jQuery","tau/core/class","tau/core/event","tau/core/types","tau/configurator","tau/utils/utils.redirect"],function(a,b,c,d,e,f,g){return c.extend({init:function(a){this.config=a,this.config.integration=this.config.integration||{},this.bus=a.bus,this.globalBus=this.bus.getGlobalBus(),d.subscribeOn(this),this.criticalChanged=!1,this.window=f.getWindow(),this.redirect=new g},"bus afterRender":function(){b("body").delegate("a[href=#]","click",function(a){a.preventDefault()});var a=this.config.integration.reloadCallback,c=!!a;c?b("html").addClass("tau-html_integration_popup"):b("html").addClass("tau-html_integration_main")},"bus initProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show("Reloading...")},"bus application.error":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"globalBus showProgress":function(a){this.config.integration.progress&&this.config.integration.progress.show(a.data.text)},"globalBus hideProgress":function(a){this.config.integration.progress&&this.config.integration.progress.hide()},"bus destroy":function(){f.getGlobalBus().removeAllListeners(this),this.window._criticalTauChanges&&(this.bus.fire("initProgress"),this.redirect.reload()),b("body .jquery-notify-bar").remove()},"bus application.reload":function(a){var b=this.config.integration.reloadCallback;if(!!b==0)return;b(a)},"bus application.exit":function(a){var b=this.config.integration.reloadCallback,c=!!b;c?(this.window._criticalTauChanges=!0,this.bus.fire("destroy")):(this.bus.fire("initProgress"),this.redirect.redirect("default.aspx"))}})})