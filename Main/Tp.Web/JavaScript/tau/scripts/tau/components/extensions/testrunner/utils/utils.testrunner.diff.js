define([],function(){var a=Object.prototype.toString,b=Object.prototype.hasOwnProperty,c=function(){function a(a,c){var d={},e={};for(var f=0;f<c.length;f++)d[c[f]]==null&&(d[c[f]]={rows:[],o:null}),d[c[f]].rows.push(f);for(var f=0;f<a.length;f++)e[a[f]]==null&&(e[a[f]]={rows:[],n:null}),e[a[f]].rows.push(f);for(var f in d){if(!b.call(d,f))continue;d[f].rows.length==1&&typeof e[f]!="undefined"&&e[f].rows.length==1&&(c[d[f].rows[0]]={text:c[d[f].rows[0]],row:e[f].rows[0]},a[e[f].rows[0]]={text:a[e[f].rows[0]],row:d[f].rows[0]})}for(var f=0;f<c.length-1;f++)c[f].text!=null&&c[f+1].text==null&&c[f].row+1<a.length&&a[c[f].row+1].text==null&&c[f+1]==a[c[f].row+1]&&(c[f+1]={text:c[f+1],row:c[f].row+1},a[c[f].row+1]={text:a[c[f].row+1],row:f+1});for(var f=c.length-1;f>0;f--)c[f].text!=null&&c[f-1].text==null&&c[f].row>0&&a[c[f].row-1].text==null&&c[f-1]==a[c[f].row-1]&&(c[f-1]={text:c[f-1],row:c[f].row-1},a[c[f].row-1]={text:a[c[f].row-1],row:f-1});return{o:a,n:c}}return function(b,c){b=b.replace(/\s+$/,""),c=c.replace(/\s+$/,"");var d=a(b==""?[]:b.split(/\s+/),c==""?[]:c.split(/\s+/)),e="",f=b.match(/\s+/g);f==null?f=[" "]:f.push(" ");var g=c.match(/\s+/g);g==null?g=[" "]:g.push(" ");if(d.n.length==0)for(var h=0;h<d.o.length;h++)e+="<del>"+d.o[h]+f[h]+"</del>";else{if(d.n[0].text==null)for(c=0;c<d.o.length&&d.o[c].text==null;c++)e+="<del>"+d.o[c]+f[c]+"</del>";for(var h=0;h<d.n.length;h++)if(d.n[h].text==null)e+="<ins>"+d.n[h]+g[h]+"</ins>";else{var i="";for(c=d.n[h].row+1;c<d.o.length&&d.o[c].text==null;c++)i+="<del>"+d.o[c]+f[c]+"</del>";e+=" "+d.n[h].text+g[h]+i}}return e}}();return c})