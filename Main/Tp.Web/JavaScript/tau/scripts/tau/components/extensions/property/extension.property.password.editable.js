define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(e,r,s){return s.extend({category:"edit",init:function(){this._super.apply(this,arguments),this.onBlurProxy=e.bind(this.onBlur,this),this.onKeyDownProxy=e.bind(this.onKeyDown,this)},findPasswordElements:function(e){return e.find(".tau-password,.tau-password-verify")},"bus permissionsReady+afterRender":function(e){if(e.permissionsReady.data.editable){var r=e.afterRender.data.element;this.findPasswordElements(r).blur(this.onBlurProxy),r.find(".tau-password,tau-password-verify").keydown(this.onBlurProxy)}},"bus view.password.ready:last+view.password.confirmation.ready:last":function(e){var r=e["view.password.ready"].data,s=e["view.password.confirmation.ready"].data,t=r.length>0;if(t&&r===s){var a={};a[this.config.propertyName]=r,this.fire("save",a)}},"bus after_save":function(){this.fire("view.clear.passwords")},"bus afterRender:last+view.clear.passwords":function(e){this.findPasswordElements(r(e.afterRender.data.element)).val("")},getEventNameFromTarget:function(e){var s=r(e).hasClass("tau-password-verify");return s?"view.password.confirmation.ready":"view.password.ready"},firePasswordReadyEventDependOnTarget:function(e){var s=r(e).val();this.fire(this.getEventNameFromTarget(e),s)},onBlur:function(e){var r=e.target;this.firePasswordReadyEventDependOnTarget(r)},onKeyDown:function(e){var r=e.target;13==e.keyCode&&this.firePasswordReadyEventDependOnTarget(r)}})});