define(["Underscore","tau/components/extensions/component.extension.base"],function(_,ComponentExtensionBase){return ComponentExtensionBase.extend({"bus beforeInit":function(evt,initConfig){var store=this.config.store,self=this;store.unbind(this),store.on({eventName:"failure",listener:self},function(evt){if(evt.data.cmd.config.failureGlobal!==!1){if(initConfig&&initConfig.config&&initConfig.config.context.entity){var entity=initConfig.config.context.entity;store.evictPersistedObject(entity.id,entity.type)}self.onFailure.apply(self,arguments)}})},onFailure:function(ev){var message="Looks like application is not available. Please check your connection or server availability";if(ev.data&&ev.data.data){ev.data.data.Message&&(message=ev.data.data.Message);var response=ev.data.data.response;if(response){response.Message&&(message=response.Message);if(_.isArray(response)){var parts=[response[1]];_.isArray(response[4])&&response[4].length>0&&response[4][0]!=parts[0]&&parts.push(response[4][0]),message=parts.join(":&nbsp;")}response.Error&&response.Error.Message&&(message=response.Error.Message)}}var status=0;ev.data&&ev.data.data&&(status=ev.data.data.status||0),status===500&&window.appIsInDebugMode===!1&&(message="Looks like application is not available. Please check your connection or server availability"),this.fire("error",{message:message}),(status>=400||status===0)&&this.fire("globalFailure");if(ev.data&&ev.data.cmd){var commandName=ev.data.cmd.name;!_.include(["get","find"],commandName)||status===0&&this.fire("destroy")}},destroy:function(){this.config.store.unbind(this),this._super()}})})