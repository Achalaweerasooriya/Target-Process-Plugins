define(["Underscore","jQuery","tau/ui/extensions/editable-base","tau/ui/behaviour/menu/ui.behaviour.menu.actions","libs/jquery/jquery.ui.tauConfirm"],function(t,e,i){return i.extend({"bus afterRender":function(t,e){var i=this.$el=e.element,n=i.find(".drop-down-list");this.fire("$el.ready",i),this.fire("$menu.ready",n),this.fire("menu.show.first",i)},"bus configurator.ready + dataBind + $el.ready + $menu.ready":function(e,i,n,o,r){var a=this;this.bindData=n,this.redirect=i.getRedirect(),o.behaviourMenuActions({keyboardManager:i.getKeyBoardManager(),onClick:function(){a.wasShownBefore||(a.fire("menu.show.first",o),a.wasShownBefore=!0),a.fire("menu.show",o)}}),r.find(".ui-menu__item-action").click(t.bind(this.executeCommand,this))},"bus select":function(){this.$el.behaviourMenuActions("show")},removeEntity:function(){var t=this.config.context.entity,e=this.config.context.configurator.getStore();e.remove(t.entityType.name,{id:t.id}).done(),this.config.context.configurator.getHistory().exclude(t.id)},redirectTo:function(t,e){this.redirect.redirect(t,e)},split:function(){var t=this.config.context.entity.id,e={generalID:t};this.fire("split",e)},markAsDuplicate:function(){var t=this.config.context.entity.id,e={generalID:t};this.fire("markAsDuplicate",e)},attachToRequest:function(){var t=this.config.context.entity.id;this.fire("attachToRequest",{generalID:t})},moveOrCopy:function(){var t=this.config.context.entity.id;this.fire("moveOrCopy",{generalID:t})},copyToProject:function(t){this.fire("board.plus.copy.to.project",{entity:this.config.context.entity,$popupTarget:t.$target})},executeCommand:function(i){if(!e(i.target).is("a")&&!e(i.target).is("i")){var n=this,o=e(i.currentTarget),r=o.data("alias"),a=t.find(this.bindData.items,function(t){return t.alias==r});if(a){var c=a.command,s=a.confirmation||!1,u=t.bind(function(){if(t.isFunction(c)){var e={$target:o};c.call(n,n,e)}else if("object"==typeof c){var i={components:c,context:n.config.context};n.createComponents(i,function(t){var e=t[0].component;e.initialize()})}else a.url&&n.redirectTo(a.url);this.fire("action.started",{})},this);s?o.tauConfirm({showOnCreation:!0,content:["<h3>"+s+"</h3>"].join(""),callbacks:{success:u}}):u()}}}})});