define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(_,$,ExtensionBase){return ExtensionBase.extend({category:"edit","bus permissionsReady+afterRender":function(eventData){var self=this,field=eventData.afterRender.data.data,permissions=eventData.permissionsReady.data;if(permissions.editable){var $el=eventData.afterRender.data.element,$widget=$el.find(".ui-customfield__value");self.$widget=$widget,$widget.richeditor({text:$el.tmplItem().data.value,placeholder:{text:"Double-click to add content...",className:"ui-description__inner_empty_true"},settings:{fitImgWidth:!1,toolbar:[["Cut","Copy","Paste","PasteText","PasteFromWord","-","Bold","Italic","Underline","Strike","-","Subscript","Superscript"],["NumberedList","BulletedList","-","Outdent","Indent"],["JustifyLeft","JustifyCenter","JustifyRight"],["Link","Unlink","Anchor"],["Image","Table","HorizontalRule","SpecialChar"],"/",["Source","Format","Font","FontSize"],["Replace","-","RemoveFormat","TextColor","BGColor","-","Templates"],["Maximize"]],extraPlugins:"autogrow,charcount",charcount_limit:4e3},onCreateEditor:function(value){self.fire("editor.ready",value)},onStopEdit:function(value){self.fire("stop.editing",value)},onStartEdit:function(value){self.fire("start.editing",value)},onBeforeSaveWithClose:function(text){self.fire("allow.close.editor",text)},onSave:function(text){self.bus.fire("save",{customFields:[{name:field.name,type:field.type,value:text}]})}})}},"bus validate":function(){this.$widget.richeditor("resetValidationErrors")},"bus afterValidate":function(evt){this.$widget.richeditor("setValue",evt.data.validation.instance.value)},"bus validationFailed":function(evt){this.$widget.richeditor("setValidationErrors",evt.data.validation.errors[0].description)}})})