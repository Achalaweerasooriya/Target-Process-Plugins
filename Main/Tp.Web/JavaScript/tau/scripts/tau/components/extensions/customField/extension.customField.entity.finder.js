define(["Underscore","tau/core/extension.base","tau/models/customField/model.customField.entity.editable"],function(_,ExtensionBase,ModelCustomFieldEntityEditable){return ExtensionBase.extend({"bus beforeInit + configurationProvided + afterRender":function(evtData){var customField=evtData.beforeInit.data.customField,$target=evtData.afterRender.data.element.find("tr"),finderData=_.deepClone($target.tmplItem().data),view=evtData.afterRender.data.view,cfConfig=evtData.configurationProvided.data,finderConfig=this._createFinderConfig(finderData,customField,cfConfig);this._initBubbleWithFinder($target,view,finderConfig)},_createFinderConfig:function(finderData,customField,cfConfig){var conf={type:"finder",fields:["id","name",{project:["id","name","abbreviation"]}],additionalExtensions:[ModelCustomFieldEntityEditable],maxHeight:400,data:finderData,resetDisabled:customField&&customField.required===!0};return cfConfig.options.length>0&&(conf.$query={entityType:{id:{$in:cfConfig.options.join(",")}}}),conf},_initBubbleWithFinder:function($target,view,finderConfig){$target.addClass("tau-bubble-target"),$target.addClass("ui-customfield_editable_true");var bubbleConfig={target:$target,alignTo:$target.find(".entity-custom-field-link"),onShow:function(){view.config.context.configurator.getKeyBoardManager().pushHandler({})},onHide:function(){view.config.context.configurator.getKeyBoardManager().popHandler()},componentsConfig:{components:[finderConfig]}};this.fire("initBubble",bubbleConfig)}})})