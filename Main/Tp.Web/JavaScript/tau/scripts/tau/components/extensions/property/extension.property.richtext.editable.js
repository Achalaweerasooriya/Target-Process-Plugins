define(["require","Underscore","tau/core/extension.base","tau/utils/utils.constants","tau/ui/behaviour/common/markdown.uploader.plugin","tau/ui/behaviour/common/ui.behaviour.richeditor","tau/ui/behaviour/common/ui.behaviour.richeditorMarkdown"],function(e){var i=e("Underscore"),t=e("tau/core/extension.base"),o=e("tau/utils/utils.constants").get("editorByType"),n=e("tau/ui/behaviour/common/markdown.uploader.plugin");return e("tau/ui/behaviour/common/ui.behaviour.richeditor"),e("tau/ui/behaviour/common/ui.behaviour.richeditorMarkdown"),t.extend({category:"edit",resetLifecycle:!0,editorIsActive:!1,"bus applyChanges":function(){this.editorIsActive||this.fire("refresh")},"bus beforeInit:last + submitted":function(e,i,t){var o=i.config.context.entity;i.config.context.configurator.getStore().evictProperties(o.id,o.entityType.name,[i.config.fieldName]);var n={};n[i.config.fieldName]=t,this.fire("save",n)},"bus beforeInit + dataBind + permissionsReady + afterRender":function(e,t,r,a,u){var c=u.element;if(a.editable)var s=c.find(".i-role-property"),d=t.config.context.configurator,h=i.bind(this.fire,this),f=o[r.editorType],b=s[f]({ckPath:d.getCkPath(),text:r.value,rawText:r.rawDescription,plugins:[n(r.pluginConfig)],settings:{toolbar:"Full",height:"auto"},onCreate:i.bind(function(){this.editorIsActive=!0,h("$editor.ready",b)},this),onHide:i.bind(function(){this.editorIsActive=!1},this),onSave:function(e){s[f]("hide"),h("submitted",e)},onCancel:function(){s[f]("hide")}})}})});