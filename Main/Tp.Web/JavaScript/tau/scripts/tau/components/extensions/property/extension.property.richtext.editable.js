define(["Underscore","jQuery","tau/core/extension.base","tau/ui/behaviour/common/ui.behaviour.richeditor"],function(e,i,t){return t.extend({category:"edit",resetLifecycle:!0,editorIsActive:!1,"bus applyChanges":function(){this.editorIsActive||this.fire("refresh")},"bus beforeInit:last + submitted":function(e,i,t){var n=i.config.context.entity;i.config.context.configurator.getStore().evictProperties(n.id,n.entityType.name,[i.config.fieldName]);var o={};o[i.config.fieldName]=t,this.fire("save",o)},"bus beforeInit + dataBind + permissionsReady + afterRender":function(i,t,n,o,r){var c=r.element;if(o.editable)var a=c.find(".i-role-property"),s=t.config.context.configurator,d=e.bind(this.fire,this),f=t.config.richediitor?t.config.richediitor:"richeditor",u=a[f]({ckPath:s.getCkPath(),text:n.value,settings:{toolbar:"Full",height:"auto"},onCreate:e.bind(function(){this.editorIsActive=!0,d("$editor.ready",u)},this),onHide:e.bind(function(){this.editorIsActive=!1},this),onSave:function(e){a[f]("hide"),d("submitted",e)},onCancel:function(){a[f]("hide")}})}})});