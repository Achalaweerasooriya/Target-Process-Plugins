define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(a,b,c){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var c=this,d=a.afterRender.data.data,e=a.permissionsReady.data;if(e.editable){var f=a.afterRender.data.element,g=f.find(".ui-customfield__value");g.addClass("editableText"),this.$widget=g,b.datepicker.parseDate=function(a,b,c){return Date.parse(b)},b.datepicker.formatDate=function(a,b,c){return b.format(a)};var h="MM/dd/yyyy";this.config.context&&(h=this.config.context.applicationContext.culture.shortDateFormat),g.dateEditor({dateFormat:h,onSave:function(a){c.bus.fire("save",{customFields:[{name:d.name,value:a}]})}}),f.behaviourCustomFieldRow({onActivate:function(){g.dateEditor("activate"),g.focus()}}),f.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.dateEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}})})