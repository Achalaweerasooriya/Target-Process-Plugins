define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor"],function(a,b,c,d){return c.extend({category:"edit","bus permissionsReady+afterRender":function(a){var c=this,e=a.afterRender.data.data,f=a.permissionsReady.data;if(f.editable){var g=a.afterRender.data.element,h=g.find(".ui-customfield__value");h.addClass("editableText"),this.$widget=h,b.datepicker.parseDate=function(a,b,c){return d.parse(b)},b.datepicker.formatDate=function(a,b,c){return d.formatAs(b,a)};var i=d.getFormatData().date.short;h.dateEditor({dateFormat:i,onSave:function(a){c.bus.fire("save",{customFields:[{name:e.name,value:a}]})}}),g.behaviourCustomFieldRow({onActivate:function(){h.dateEditor("activate"),h.focus()}}),g.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(a){this.$widget.dateEditor("setValue",a.data.validation.instance.value)},"bus validationFailed":function(a){this.$widget.dateEditor("setValidationErrors",a.data.validation.errors[0].description)}})})