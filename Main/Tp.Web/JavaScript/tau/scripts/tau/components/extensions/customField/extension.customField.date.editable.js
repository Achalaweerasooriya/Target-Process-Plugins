define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tau/utils/utils.date","tau/ui/behaviour/date/ui.behaviour.dateEditor","tau/ui/behaviour/customField/ui.behaviour.customField.row"],function(e,t,a,i){return a.extend({category:"edit","bus permissionsReady+afterRender":function(a){var d=this,o=a.afterRender.data.data,r=a.permissionsReady.data;if(r.editable){var n=a.afterRender.data.element,s=n.find(".ui-customfield__value");s.addClass("editableText"),this.$widget=s,t.datepicker.parseDate=function(e,t){return i.parse(t)},t.datepicker.formatDate=function(e,t){return i.formatAs(t,e)};var u=i.getFormatData().date.short;s.dateEditor({dateFormat:u,delayedSave:e.has(this.config,"delayedDateSave")?this.config.delayedDateSave:!0,keyboardManager:this.config.context.configurator.getKeyBoardManager(),onSave:function(e){d.bus.fire("save",{customFields:[{name:o.name,type:o.type,value:e}]})}}),n.behaviourCustomFieldRow({onActivate:function(){s.dateEditor("activate"),s.focus()}}),n.addClass("ui-customfield_editable_true")}},"bus validate":function(){this.$widget.dateEditor("resetValidationErrors")},"bus afterValidate":function(e){this.$widget.dateEditor("setValue",e.data.validation.instance.value)},"bus validationFailed":function(e){this.$widget.dateEditor("setValidationErrors",e.data.validation.errors[0].description)}})});