define(["Underscore","jQuery","tau/components/extensions/component.extension.base","app.path"],function(_,$,ExtensionBase,appPath){return ExtensionBase.extend({"bus afterRender+permissionsReady":function(evtArgs){if(evtArgs.permissionsReady.data.editable){var $el=evtArgs.afterRender.data.element;$el.find(".tau-add-testCase").click($.proxy(this.addTestCaseClickHandler,this))}},addTestCaseClickHandler:function(){function showTestCaseEditor(){Ext.WindowMgr.zseed=9999999;var panel=new Tp.controls.TestCaseCreateEditorWindow({userStoryId:userStoryId,processId:context.getProcessId()});panel.show(),panel.on("saved",function(){self.fire("testCaseWasAdded",{assignable:{id:userStoryId}})})}var context=this.config.context,userStoryId=context.entity.id,self=this;if(!window.processConfigurations){var progress=window.progressDialog||{show:function(){},hide:function(){}};progress.show("Loading..."),Ext.Ajax.request({url:(new appPath.tp.WebServiceURL("/PageServices/TestCaseListService.asmx/GetProcessConfiguration")).toString(),headers:{"Content-Type":"application/json"},success:function(result){progress.hide();var processes=$.parseJSON(result.responseText).d;processConfigurations=processes,showTestCaseEditor()},jsonData:{userStoryId:userStoryId}})}else showTestCaseEditor()}})})