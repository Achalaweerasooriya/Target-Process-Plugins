define(["Underscore","jQuery","tau/core/extension.base.stateful","tau/ui/behaviour/common/ui.behaviour.listSelectable"],function(e,i,t){return t.extend({category:"edit",name:"user list","bus initialize + afterRender":function(i,t,n){var s=n.element;s.delegate(".unassign-button","click",e.bind(this.onUnassignClick,this)),s.delegate(".assign-to-me-button","click",e.bind(this.onAssignToMeClick,this)),s.delegate(".user-search-box","keyup",e.bind(this.onFilterChanged,this,s)),s.delegate(".user","click",e.bind(this.onUserClick,this)),s.delegate(".more-link","click",e.bind(this.onMoreClick,this,s))},"bus afterRender":function(e,i){var t=i.element.find("[role=list]");t.listSelectable({items:".user",className:"user_hover",keyboardManager:this.config.context.configurator.getKeyBoardManager()}),this.fire("$listSelectable.ready",t)},"bus $listSelectable.ready:last+focus":function(e,i){this._doListAction(i,"enable")},"bus refresh + afterRender":function(e,i,t){this._doListAction(t.element.find("[role=list]"),"enable")},"bus afterRender:last+focus":function(e,i){var t=i.element;t.is(":visible")&&t.find(".user-search-box").focus()},"bus $listSelectable.ready:last+blur":function(e,i){this._doListAction(i,"disable")},onMoreClick:function(e,i){i.stopPropagation(),this._doListAction(e.find("[role=list]"),"disable"),this.fire("showMore")},onUserClick:function(e){var t=i(e.target),n=t.tmplItem().data;this.fire("changeAssignment",{user:n})},onUnassignClick:function(){this.fire("removeAssignment")},onAssignToMeClick:function(){this.fire("assignToLoggedUser")},onFilterChanged:function(e,t){t.keyCode!=i.ui.keyCode.DOWN&&t.keyCode!=i.ui.keyCode.UP&&t.keyCode!=i.ui.keyCode.ENTER&&(t.preventDefault(),this._doListAction(e.find("[role=list]"),"disable"),this.fire("setFilter",{filter:i(t.target).val()}))},_doListAction:function(e,i){e.listSelectable("instance")&&e.listSelectable(i)}})});