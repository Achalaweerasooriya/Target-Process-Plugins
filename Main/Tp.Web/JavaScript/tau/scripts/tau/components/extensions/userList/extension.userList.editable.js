define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(a,b,c){return c.extend({category:"edit",name:"user list",init:function(){this._super.apply(this,arguments),this._userClick=b.proxy(this.onUserClick,this),this._unassignClick=b.proxy(this.onUnassignClick,this),this._assignToMeClick=b.proxy(this.onAssignToMeClick,this),this._filterChanged=b.proxy(this.onFilterChanged,this),this._moreClicked=b.proxy(this.onMoreClick,this)},onMoreClick:function(a){a.stopPropagation(),this.fire("showMore")},onUserClick:function(a){var c=b(a.target),d=c.tmplItem().data;this.fire("changeAssignment",{user:d})},onUnassignClick:function(){this.fire("removeAssignment")},onAssignToMeClick:function(){this.fire("assignToLoggedUser")},onFilterChanged:function(a){if(a.keyCode==b.ui.keyCode.DOWN||a.keyCode==b.ui.keyCode.UP||a.keyCode==b.ui.keyCode.ENTER)return;a.preventDefault(),this.fire("setFilter",{filter:b(a.target).val()})},"bus beforeRender":function(){var a=this.$element;a&&(a.find(".user").unbind("click",this._userClick),a.find(".unassign-button").unbind("click",this._unassignClick),a.find(".assign-to-me-button").unbind("click",this._assignToMeClick),a.find(".user-search-box").unbind("keyup",this._filterChanged),a.find(".more-link").unbind("click",this._moreClicked))},"bus afterRender":function(a){var b=this,c=b.$element=a.data.element;c.find(".user").click(this._userClick),c.find(".unassign-button").click(this._unassignClick),c.find(".assign-to-me-button").click(this._assignToMeClick),c.find(".user-search-box").keyup(this._filterChanged),c.find(".more-link").bind("click",this._moreClicked)},"bus refresh":function(a){var b=this.$element.find(".user-list");this._resize(),b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),b.listSelectable("reset")},"bus focus":function(a){var b=this.$element.find(".user-list");b.listSelectable({items:".user",className:"user_hover"}),b.listSelectable("enable"),this.$element.find(".user-search-box").focus()},"bus blur":function(a){var b=this.$element.find(".user-list");b.listSelectable("disable")},_resize:function(a){if(!this.$element)return;var c=this.$element,d=c.find(".user-list");d.css("maxHeight",b(window).height()/3),d.css("overflowY","auto"),d.css("overflowX","hidden")},"bus afterRender+popupResize":function(a){this._resize(a.popupResize.data)},"bus popupResize":function(a){this._resize(a.data)}})})