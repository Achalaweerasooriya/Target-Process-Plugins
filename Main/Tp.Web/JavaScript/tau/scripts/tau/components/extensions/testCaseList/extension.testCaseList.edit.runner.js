define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){return a.extend({"bus dataBind":function(a){this.data=a.data},onAfterRender:function(){},"bus afterRender":function(a){this.element=a.data.element,this.onAfterRender()},"bus afterRender+permissionsReady":function(a){if(a.permissionsReady.data.editable){var b=a.afterRender.data.element;b.find(".last-run").removeClass("hidden"),b.find(".buttons").removeClass("hidden"),b.find(".passed").click($.proxy(this.passedClickHandler,this)),b.find(".failed").click($.proxy(this.failedClickHandler,this))}},getTestCaseId:function(a){return $(a.target).parents("tbody").eq(0).tmplItem().data.id},passedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!0)},failedClickHandler:function(a){var b=this.getTestCaseId(a);this.setTestCaseStatus(b,!1)},setTestCaseStatus:function(a,b){Ext.Ajax.request({url:(new Tp.WebServiceURL("/PageServices/TestCaseListService.asmx/ChangeRunState")).toString(),headers:{"Content-Type":"application/json"},success:this._onChangeStateComplete.createDelegate(this),failure:this._onChangeStateFailed.createDelegate(this),jsonData:{testCaseID:a,status:b}})},openNextTestCase:function(){var a=this.testCaseId,b=this.data.items;for(var c=0;c<b.length-1;c++)b[c].id===a&&this.fire("expandTestCase",{testCaseId:b[c+1].id});this.onAfterRender=function(){}},_onChangeStateComplete:function(a){this.testCaseId=$.parseJSON(a.responseText).d.TestCaseID,this.onAfterRender=this.openNextTestCase,this.fire("testCaseStateWasChanged")},_onChangeStateFailed:function(a){this.fire("showError",{message:a.get_message()})},destroy:function(){delete this.data,delete this.element}})})