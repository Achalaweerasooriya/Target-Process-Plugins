define(["Underscore","jQuery","tau/components/extensions/component.extension.base","app.path"],function(e,t,s,a){return s.extend({"bus dataBind":function(e){this.data=e.data},onAfterRender:function(){},"bus afterRender":function(e){this.element=e.data.element,this.onAfterRender()},"bus afterRender+permissionsReady":function(e){if(e.permissionsReady.data.editable){var s=e.afterRender.data.element;s.find(".last-run").removeClass("hidden"),s.find(".buttons").removeClass("hidden"),s.find(".passed").click(t.proxy(this.passedClickHandler,this)),s.find(".failed").click(t.proxy(this.failedClickHandler,this))}},getTestCaseId:function(e){return t(e.target).parents("tbody").eq(0).tmplItem().data.id},passedClickHandler:function(e){var t=this.getTestCaseId(e);this.setTestCaseStatus(t,!0)},failedClickHandler:function(e){var t=this.getTestCaseId(e);this.setTestCaseStatus(t,!1)},setTestCaseStatus:function(e,t){Ext.Ajax.request({url:new a.tp.WebServiceURL("/PageServices/TestCaseListService.asmx/ChangeRunState").toString(),headers:{"Content-Type":"application/json"},success:this._onChangeStateComplete.createDelegate(this),failure:this._onChangeStateFailed.createDelegate(this),jsonData:{testCaseID:e,status:t}})},openNextTestCase:function(){for(var e=this.testCaseId,t=this.data.items,s=0;s<t.length-1;s++)t[s].id===e&&this.fire("expandTestCase",{testCaseId:t[s+1].id});this.onAfterRender=function(){}},_onChangeStateComplete:function(e){this.testCaseId=t.parseJSON(e.responseText).d.TestCaseID,this.onAfterRender=this.openNextTestCase,this.fire("testCaseStateWasChanged")},_onChangeStateFailed:function(e){this.fire("showError",{message:e.get_message()})},destroy:function(){delete this.data,delete this.element}})});