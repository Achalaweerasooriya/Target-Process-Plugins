define(["Underscore","jQuery","tau/components/extensions/component.extension.base"],function(_,$,a){var b={create:function(a,b){return $("<div/>").addClass(this._createClassName(a,b)).attr("title",this._createTitle(a,b)).data("entityInfo",{id:a.id,type:a.type,alias:a.alias||a.type}).click(this._onRelatedEntityClick)},_createTitle:function(a,b){var c=["["+(a.alias||a.type)+"]"," #"+a.id,a.name,b?"(closed)":"(added)"].join(" ");return c},_createClassName:function(a,b){var c=["tau-entity","tau-"+a.type.toLowerCase(),b?"tau-closed":""].join(" ");return c},_onRelatedEntityClick:function(a){var b=$(this).data("entityInfo");b&&location.assign("#"+b.type+"/"+b.id)}};return a.extend({"bus afterRender":function(a){this._$element=a.data.element,this._data=a.data.data,this._render()},_render:function(){var a=this._$element.find(".tau-historyGrid .tau-historyItem");_.each(this._data.historyItems,function(c,d){var e=a.eq(d).find(".tau-relatedEntities");c.relatedEntities&&(_.each(c.relatedEntities.opened,function(a){e.append(b.create(a))}),_.each(c.relatedEntities.closed,function(a){e.append(b.create(a,!0))}))})}})})