define(["Underscore","tau/core/model-base","tau/models/model.extensions"],function(t,e,s){return e.extend({init:function(){this._super.apply(this,arguments),this.hideElementIfHelpDeskPracticeIsOff(this.config.context)},hideElementIfHelpDeskPracticeIsOff:function(t){this.store=this.config.context.configurator.getStore(),t.isPracticeAvailable("Help Desk")<0&&(this.bus.getGlobalBus().on("requestWasAttachedToEntity",this._updateRefresh,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this._updateRefresh,this),this.bus.on("afterRender",this._update,this))},_updateRefresh:function(){var t=this.config.context;this.config.store.evictProperties(t.entity.id,t.entity.entityType.name,["requests-count"]),this._update()},_update:function(){s.calculateRequestsCount.call(this,{callback:function(t){var e=t.count,s=this.$el;e>0?s.show():s.hide()},scope:this})},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this._updateRefresh,this),this._super()},"bus afterRender":function(t){this.$el=t.data.element}})});