define(["Underscore","tau/core/model-base","tau/models/model.extensions","tau/configurator","libs/jsonselect"],function(a,b,c,d){return b.extend({init:function(a){this._super.apply(this,arguments),this.hideElementIfHelpDeskPracticeIsOff(this.config.context.applicationContext)},hideElementIfHelpDeskPracticeIsOff:function(b){this.store=d.getStore();var c=a.pluck(b.processes[0].practices,"name");a.indexOf(c,"Help Desk")<0&&(this.bus.getGlobalBus().on("requestWasAttachedToEntity",this._updateRefresh,this),this.bus.getGlobalBus().on("bugWasMarkedAsDuplicate",this._updateRefresh,this),this.bus.on("afterRender",this._update,this))},_updateRefresh:function(){var a=this.config.context;this.config.store.evictProperties(a.entity.id,a.entity.entityType.name,["requests-count"]),this._update()},_update:function(){c.calculateRequestsCount.call(this,{callback:function(a){var b=a.count,c=this.$el;b>0?c.show():c.hide()},scope:this})},destroy:function(){this.bus.getGlobalBus().removeListener("requestWasAttachedToEntity",this._updateRefresh,this),this._super()},"bus afterRender":function(a){this.$el=a.data.element}})})