define(["Underscore","jQuery","tau/core/class","tau/core/event","tau/store/types","tau/configurator"],function(_,$,a,b,c,d){return a.extend({init:function(a){this.config=a,this.bus=a.bus;var c=this.routing=d.getRouting(),e=c.getUrl().source;this.defaultHash=e!=="#"?e:"#__"+_.uniqueId(),b.subscribeOn(this)},"bus registerRoute":function(a){var b=a.data;this.routing.register(b.pattern,b.callback)},"bus registerRouteNotFound":function(a){var b=a.data;this.routing.register404(b.callback)},"bus afterInit":function(a){this.bus.fire("routing.registered",{})},"bus controller.ready":function(){this.routing.start();var a=d.getRouting().getUrl();this.config.startUrl?a.url===this.config.startUrl?this.routing.execute(this.config.startUrl):(this.routing.execute(this.config.startUrl),d.getRouting().setInternalUrl(this.config.startUrl)):this.config.executeOnStart!==!1&&this.routing.execute(a.source)},"bus destroy":function(){this.bus.getGlobalBus().removeAllListeners(this),this.routing.reset(),this.routing.stop(),this.routing.setUrl(this.defaultHash),this.routing.removeAllListeners(this)}})})