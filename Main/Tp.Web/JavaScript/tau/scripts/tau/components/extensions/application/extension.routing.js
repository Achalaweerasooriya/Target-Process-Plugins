define(["Underscore","jQuery","tau/core/event.emitter","tau/core/event","tau/store/types"],function(_,$,a,b,c){return a.extend({init:function(a){this._super(a),this.config=a,this.routing=a.context.configurator.getRouting(a.applicationId);var b=this.routing.getUrl().source;this.defaultHash=b!=="#"?b:"#__"+_.uniqueId()},"bus registerRoute":function(a){var b=a.data;this.routing.register(b.pattern,b.callback)},"bus registerRouteNotFound":function(a){var b=a.data;this.routing.register404(b.callback)},"bus afterInit":function(a){this.fire("routing.registered",{})},"bus controller.ready":function(){this.routing.start();var a=this.routing.getUrl();this.config.startUrl?a.url===this.config.startUrl?this.routing.execute(this.config.startUrl):(this.routing.execute(this.config.startUrl),this.routing.setInternalUrl(this.config.startUrl)):this.config.executeOnStart!==!1&&this.routing.execute(a.source)},destroy:function(){this._super(),this.routing.reset(),this.routing.stop(),this.routing.removeAllListeners(this),!this.config.applicationId&&this.config.integration&&this.config.integration.showInPopup&&this.routing.setUrl(this.defaultHash),delete this.config,delete this.routing,delete this.defaultHash}})})