define(["Underscore","tau/core/class"],function(r,t){var e={id:function(r){return function(t){return t.id===r}}},n=t.extend({init:function(r,t){this._cards=r,this._ordering=t},actualCount:function(){return r.reject(this._cards,r.property("isPromise")).length},insert:function(r){var t=null;return this._ordering.isImplemented?(t=this._getSortedIndex(r),this._cards.splice(t,0,r)):(t=this._cards.length,this._cards.push(r)),t},sort:function(r){return this._ordering.isImplemented?(this.remove(r.id),this.insert(r)):this._cards.indexOf(r)},get:function(t){return r.find(this._cards,e.id(t))},range:function(r,t){return r=r||0,t=t||this._cards.length-1,this._cards.slice(r,t+1)},has:function(t){return r.any(this._cards,e.id(t))},remove:function(t){this._cards=r.reject(this._cards,e.id(t))},_getSortedIndex:function(t){return r.chain(this._cards).pluck("_cardData").pluck("orderingValue").sortedIndex(t.cardData().orderingValue,this._ordering.predicate).value()}});return n});