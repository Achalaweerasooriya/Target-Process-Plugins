define(["Underscore","jQuery","tau/core/class","tau/components/board.timeline/models/collection.coords.based","tau/components/board.timeline/models/cell/model.cell.timeline","tau/components/board.timeline/models/cell/model.cell.board"],function(t,e,i,n,o,c){return i.extend({init:function(t){this._collection=new n,this.timelineRangeModel=t},setDefinition:function(t){this.definition=t},clear:function(){this._collection.clear()},forEach:function(t){this._collection.forEach(t)},get:function(t){return this._collection.get(t)},registerCell:function(e,i,n){var a=t.find(i.fixed.items,t.matches({type:"timeline"})),l=a?new o(this.definition,i,this.timelineRangeModel,n):new c(this.definition,i);return this._collection.insert(e,l),l},addCards:function(e,i){t.each(e,function(t){var e=this._collection.get(t);e&&e.addCard(t.data,i)},this)},updateCards:function(e,i){t.each(e,function(t){var e=this._collection.get(t);e&&e.updateCard(t.data,i)},this);var n=t.uniq(t.map(e,function(t){return t.data.id}));this._collection.forEach(function(i,o){var c=t.any(e,function(e){var i=this._collection._extractCoords(e);return t.isEqual(i,o)},this);c||t.each(n,function(t){i.clearCard(t)})},this)},removeCards:function(e,i){this._collection.forEach(function(n){t.each(e,function(t){n.removeCard(t.data.id,i)})})}})});