define(["Underscore","tau/core/class","jQuery","tau/components/board.timeline/view/view.cell.base","tau/ui/extensions/board.plus/ui.board.plus.dom.utils","tau/ui/templates/board.plus/ui.template.boardplus.show-more","tau/ui/templates/board.plus/ui.template.boardplus.cell-paging-track","tau/ui/behaviour/common/ui.behaviour.progressIndicator"],function(e,i,t,n,r,s,a,o){var l=i.extend({init:function(){this.onClick=e.Callbacks()},render:function(){return s.render({}).on("click",this.onClick.fire.bind(this.onClick))}}),d=i.extend({render:function(){return a.render({})}}),c=n.extend({init:function(i,t,n,r,s){this._pagingTriggerView=new l,this._pagingTriggerView.onClick.add(this.processPagingInCell.bind(this)),this._tempCardsTrackView=new d,this._getCellPagingTrigger=e.once(this._pagingTriggerView.render.bind(this._pagingTriggerView)),this._getTempCardsTrack=e.once(this._tempCardsTrackView.render.bind(this._tempCardsTrackView)),this._super(i,t,n,r,s),i.onDonePaging.add(this.renderRange.bind(this))},processPagingInCell:function(){this._showProgress(),this._cellModel.doPaging()},renderRange:function(e){var i=this._createContentRange(e);this._appendCellContent(i,!0)},_createContentRange:function(e){return this._convertCardsToCellContent(this._cellModel.getCardModels().range(e.from,e.to))},_appendCellContent:function(e,i){var t=this._getCellPagingTrigger(),n=this._getTempCardsTrack();this._super(e,i),this._cellModel.hasPaging?(this._adjustCellPagingTrigger(t),this._$cell.append(t).append(n)):(t.detach(),n.detach()),this._hideProgress()},_showProgress:function(){o.get(this._$cell).show(),this._$cell.parent().css("opacity",.5)},_hideProgress:function(){o.get(this._$cell).hide(),this._$cell.parent().css("opacity",1)},_adjustCellPagingTrigger:function(e){var i=this._$cell.closest(".i-role-board-body-holder"),t=i.hasClass("tau-ui-size-min"),n=!t&&i.hasClass("tau-ui-size-xl");if(!t&&!n){var r=this._$cell.find(".i-role-card:eq(0)");e.css({height:r.outerHeight(),width:r.outerWidth()})}},_addCardToDom:function(e,i){e.isPromise()?e.appendTo(this._getTempCardsTrack()):this._super(e,i)
},_updateCardDom:function(i,t,n){e.isUndefined(n.index)||n.index!==i.index()&&(i.markAsChanged(),i.insertAt(this._$cell,n.index)),this._super(i,t,n)},createPlaceholderContent:r.createDragNDropPlaceholderContent});return c});