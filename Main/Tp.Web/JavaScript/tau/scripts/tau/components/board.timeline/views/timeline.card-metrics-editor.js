define(["Underscore","tau/core/class"],function(i,t){var e=t.extend({init:function(i,t){this._model=i,this._viewMetrics=t},commit:function(){this._model.commitEdit()},resize:function(){throw new Error("Resize should be implemented in derived class")},drag:function(){throw new Error("Drag should be implemented in derived class")},leftResizeAvailable:function(){return!0},rightResizeAvailable:function(){return!0},plannedRange:function(){throw new Error("plannedRange should be implemented in derived classes")},_applyEdit:function(){throw new Error("_applyEdit should be implemented in derived classes")}}),n=e.extend({begin:function(){this._initial=i.pick(this.plannedRange(),"from","to"),this.drag(0)},drag:function(i){var t=-this._initial.to,e=1-this._initial.from,n=a(i,t,e);this._applyEdit(n,n)},resize:function(i,t){i==-t?this._resizeLeft(i):this._resizeRight(t)},leftResizeAvailable:function(){return this._viewMetrics.planned.from>=0},rightResizeAvailable:function(){return this._viewMetrics.planned.to<=1},plannedRange:function(){return{from:this._model.isStartDateInfinite?0:this._viewMetrics.planned.from,to:this._model.isEndDateInfinite?1:this._viewMetrics.planned.to}},_resizeLeft:function(i){var t=-this._initial.from,e=Math.min(this._initial.to,1)-this._initial.from;this._applyEdit(a(i,t,e),0)},_resizeRight:function(i){var t=this._initial.to-this._initial.from,e=-t,n=1-(this.plannedRange().from+t);this._applyEdit(0,a(i,e,n))},_applyEdit:function(i,t){var e=this._initial.from+i,n=this._initial.to+t;this._viewMetrics.applyEdit(e,n)}}),r=e.extend({begin:function(){this._initial={from:this.plannedRange().from}},drag:function(i){this._applyEdit(a(i,-this._initial.from,-this._initial.from+1),0)},leftResizeAvailable:function(){return!1},rightResizeAvailable:function(){return!1},plannedRange:function(){return{from:this._viewMetrics.planned.from,to:null}},_applyEdit:function(i){var t=this._initial.from+i;this._viewMetrics.applyEdit(t,t)}}),a=function(i,t,e){return Math.max(t,Math.min(e,i))
},s={fixed:r,durable:n};return{createFor:function(i,t){return new s[i.type](i,t)}}});