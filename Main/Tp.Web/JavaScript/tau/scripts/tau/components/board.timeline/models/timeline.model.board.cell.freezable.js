define(["Underscore","jQuery","tau/models/board.plus/model.board.cell.freezable"],function(e,i,t){return t.extend({init:function(e,i,t){this.timelineCellModelRegistry=i,this.timelineAxesModelRegistry=t,this._super(e),this.on("refresh",function(){this.timelineCellModelRegistry.clear(),this.timelineAxesModelRegistry.clear()}.bind(this)),this.on("definition.ready",function(e){this.timelineCellModelRegistry.setDefinition(e.data)}.bind(this))},_isCell:function(e){var i=e.coords;return i.x&&i.y},fireModelGetCellBasicInfo:function(i){var t=e.deepClone(i);e.has(t,"x")&&(t.x=null===t.x?"null":t.x),e.has(t,"y")&&(t.y=null===t.y?"null":t.y),this.fire("model.get.cell.basicInfo",t)},_initializeCells:function(e){if(this._isCell(e)){var i=this.timelineAxesModelRegistry.get({y:e.coords.y}),t=this.timelineCellModelRegistry.registerCell(e.coords,e.dataItem,i);t.onDoPaging&&t.onDoPaging.add(function(e){this.fire("paging.cell.show.more",{}),this.fireModelGetCellBasicInfo(e)}.bind(this))}else this.timelineAxesModelRegistry.registerAxis(e.coords,e.dataItem)},_updateCellsPaging:function(i){if(this._isCell(i)){var t=this.timelineCellModelRegistry.get(i.coords),l=e(i.coords).pick("from","to");l.dataItem=i.dataItem,t.triggerPaging(l)}},fireCellBasicInfoRetrieved:function(e){0===e.coords.from?this._initializeCells(e):this._updateCellsPaging(e),this._super(e)},"bus slice.ready":function(e,i){i.lazy.on("after.cardsDetails",function(e){this.timelineCellModelRegistry.forEach(function(i){i.augmentCards(e.data.result.items)})}.bind(this))},queryCells:function(e,i){var t=e.config.definition;t.user.globalDateRange?this._super(e,i):this.skipQueryCells()}})});