define(["Underscore","jQuery","tau/components/board.timeline/models/cell/model.cell.base"],function(e,i,t){var a={type:function(e){return function(i){return i.type===e}}},s=t.extend({init:function(i,t){this._super(i,t),this.isTimeline=!1,this.onDoPaging=e.Callbacks(),this.onDonePaging=e.Callbacks(),this.processPaging(this.dataItem.fixed.items)},processPaging:function(i){var t=e.find(i,a.type("cellpaging"));t?(this.hasPaging=!0,this.nextOrderingValue=t.data.nextOrderingValue):(this.hasPaging=!1,this.nextOrderingValue=e.MAX_INT)},doPaging:function(){var e=this.getCardModels().actualCount();this.onDoPaging.fire({x:this.dataItem.x,y:this.dataItem.y,from:e,to:e+this.pageSize-1})},triggerPaging:function(i){var t=this._convertCardItemsToModels(i.dataItem.dynamic.items),a=e.pluck(t,"id"),s=e.filter(a,this._cardModels.has.bind(this._cardModels));e.each(s,this.clearCard,this),e.each(t,this._cardModels.insert.bind(this._cardModels)),this.processPaging(i.dataItem.fixed.items);var r=e.pick(i,"from","to");this.onDonePaging.fire(r)},_isInCellPaging:function(e){if(!this.hasPaging)return!1;var i=this._getOrdering();return i.isImplemented&&i.predicate(e.orderingValue)>=this.nextOrderingValue},updateCard:function(e,i){e=this.processRawCardItem(e);var t=this._cardModels.get(e.id);(t||!this._isInCellPaging(e))&&(t?(t.update(e),i.index=this._cardModels.sort(t)):i.index=this._cardModels.insert(this._createCardModel(e)),this.onCardsUpdated.fire([this._cardModels.get(e.id)],i))},addCard:function(e,i){e=this.processRawCardItem(e);var t=this._isInCellPaging(e);if(!t||i.forceAppend){var a=this._createCardModel(e);t?(a.isPromise=!0,this._cardModels.insert(a),this.onCardsAdded.fire([a],i)):this._checkIfCardCanBeAdded(a)&&(i.index=this._cardModels.insert(a),this.onCardsAdded.fire([a],i))}},moveCardIn:function(e){return this._createCardModel(e)},getMoveParameters:e.identity});return s});