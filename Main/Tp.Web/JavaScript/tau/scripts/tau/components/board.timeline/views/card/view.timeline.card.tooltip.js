define(["Underscore","jQuery","tau/core/class","tau/utils/utils.date"],function(t,o,e,i){var n=e.extend({init:function(t){this._$dom=this._render(),this._model=t,this._model.onMetricsUpdating.add(this._update,this),this._model.onMetricsUpdated.add(this._hide,this),this._$dom.on("remove",this._destroy.bind(this))},appendTo:function(t){this._$dom.appendTo(t)},_render:function(){return o('<div class="tau-timeline-card-tooltip" style="width:100%;"></div>').tauBubble({zIndex:999,template:['<div class="tau-bubble-board">','<div class="tau-bubble-board__arrow" role="arrow"></div>','<div class="tau-bubble-board__inner tau-container" role="content"></div>',"</div>"].join(""),className:"tau-bubble-tooltip",mode:"tooltip",showEvent:"none",stackName:"tooltip",delay:500,onPositionConfig:this._tooltipPositionConfig,onArrowPositionConfig:this._tooltipPositionConfig})},_tooltipPositionConfig:function(t){t.at="center bottom-1",t.my="center top"},_update:function(){var t=this._$dom.closest(".i-role-bubble-holder");this._$dom.tauBubble("option","appendTo",t),this._$dom.tauBubble("show").tauBubble("setContent",d[this._model.type](this._model.plannedDateRange())).tauBubble("adjust")},_hide:function(){this._$dom.tauBubble("hide")},_destroy:function(){this._model.onMetricsUpdating.remove(this),this._model.onMetricsUpdated.remove(this)}}),d={fixed:function(t){return s(t.startDate)},durable:function(t){return r(t)}},s=function(t){return i.format.datetime.short(i.convertToTimezone(t))},a=function(t){return null===t?"-&infin;":i.format.date.short(i.convertToTimezone(t))},r=function(t){return a(t.startDate)+"&nbsp;â€”&nbsp;"+a(t.endDate)};return n});