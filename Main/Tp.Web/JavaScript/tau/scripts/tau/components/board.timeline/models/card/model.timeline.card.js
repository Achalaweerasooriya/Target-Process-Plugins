define(["Underscore","tau/core/class","tau/components/board.timeline/models/card/model.board.card"],function(t,e,n){var i=n.extend({type:"base",init:function(e,n){if(t.isUndefined(n))throw new Error("dateRangeModel should be defined");this._isDirty=!1,this.onPlannedDatesUpdating=t.Callbacks(),this.onPlannedDatesUpdated=t.Callbacks(),this._dateRangeModel=n,this.id=e.id,this.update(e)},update:function(t){this._isDirty||this._updateCore(t)},_updateCore:function(e){if(e.showActual&&!e.hasActual)throw new Error("Actual inconsistency");if(e.showPlanned&&!e.hasPlanned)throw new Error("Planned inconsistency");if(e.fixedDatePlan&&e.showPlanned)throw new Error("Planned and Fixed inconsistency");t.extend(this,this._extractProperties(e)),this._cardData=e,this._validState=t.clone(e)},isUnfinished:function(){return this._cardData.hasActual&&this._cardData.inProgress},_extractProperties:function(){return{}},plannedRange:function(){throw new Error("plannedRange should be implemented in derived classes")},plannedDateRange:function(){return this._dateRangeModel.createDateRange(this.plannedRange())},applyEdit:function(){this._isDirty=!0,this.onPlannedDatesUpdating.fire(this)},commitEdit:function(){this._isDirty=!1,this.onPlannedDatesUpdated.fire(this)},rollbackEdit:function(){this.update(this._validState),this.onPlannedDatesUpdating.fire(this)}});return i});