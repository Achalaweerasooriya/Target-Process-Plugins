define(["Underscore","jQuery","tau/components/board.timeline/views/card/view.timeline.card.section-base"],function(t,i,e){var s=e.extend({init:function(t,i,e,s){this._super(t,i,e),this._$section.find(".i-role-card-placeholder").replaceWith(s)},setContent:function(t){this._$section.find(".i-role-card").replaceWith(t)},setPosition:function(){this._super(),this._$section.toggleClass("tau-timeline-part-card",this._metrics().left<0)},_prepareSection:function(t){t.css({left:"",width:0}).mousedown(function(t){var e=i(this).offset();taus.track("action",{name:"timeline-actual-part-click",width:i(this).width(),height:i(this).height(),offsetX:t.pageX-e.left,offsetY:t.pageY-e.top})})},_isVisible:function(){return this._viewMetrics.actual.show?!0:this._viewMetrics.forecast.show&&this._model.hasActual?!0:this._isForecastPlannerVisible()},_isForecastPlannerVisible:function(){return Boolean(this._viewMetrics.forecast.show&&this._model.hasPlanned&&!this._model.hasActual)},_metrics:function(){return{left:this._zeroIfNaN(this._getLeft()),width:this._width()}},_getLeft:function(){return this._viewMetrics.actual.show?this._viewMetrics.actual.from:this._isForecastPlannerVisible()?this._viewMetrics.planned.from:this._viewMetrics.forecast.from},_width:function(){var t,i=this._viewMetrics.forecast.to-this._viewMetrics.forecast.from,e=this._viewMetrics.actual.to-this._viewMetrics.actual.from;return this._isForecastPlannerVisible()?t=this._viewMetrics.forecast.from-this._zeroIfNaN(this._viewMetrics.planned.from):(t=e,i=this._viewMetrics.forecast.show?i:0),this._zeroIfNaN(t)+Math.max(i,0)}});return s});