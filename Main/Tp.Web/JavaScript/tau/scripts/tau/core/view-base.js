define(["Underscore","jQuery","tau/core/event.emitter","tau/ui/templateRenderer.extensions","tau/core/templates-factory","tau/ui/templateRenderer"],function(_,$,a,b,c){var d=a.extend({name:"view-base",init:function(a){this._super(a),this.config=a||{}},destroy:function(){this._super(),this.element&&this.element.remove(),delete this.element,delete this.config},merge:function(a,b){var c=this;if(b&&c.element){$.isArray(b)||(b=[b]);var d=_(b).isArray()?b:[b],e=this.element;_(d).each(function(b){var c=e.find(b),d=a.find(b);c.each(function(a){$(this).replaceWith(d.eq(a))})})}},bindTemplate:function(a){var b=this.config.template.name,d=c.get(b).bind(this.config,a);return d},prepareElement:function(a){var b=this.config.template.name,c=("tmpl-"+b).replace(/\./g,"-");return a.addClass(c),a.addClass("ui-placeholder"),a},updateElement:function(a,b){var c=this;c.element&&b?c.merge(a,b):(c.element&&(a.length?c.element.replaceWith(a):c.element.remove()),c.element=a)},doRender:function(a,b){var c=this.bindTemplate(a);c=this.prepareElement(c),this.updateElement(c,b),!this.config.visible&&this.hide()},fireAfterInit:function(a){this.fire("afterInit",{config:this.config,refreshSelector:a})},initialize:function(a){var b=this;this.fireAfterInit(a)},setDefaultConfig:function(){var a=this;_.defaults(a.config,{visible:!0})},"bus refreshData":function(a){this.doRender(a.data),this.fire("elementRefreshedWithData",{element:this.element})},"bus refresh":function(a){this._super();var b=a.data||{},c=b.refreshSelector;this.startLifeCycle(a,c)},"bus initialize":function(a){this.startLifeCycle(a)},startLifeCycle:function(a,b){var c=this;c.setDefaultConfig(),_.extend(c.config,a.data),c.fire("beforeInit",{config:c.config}),this.initialize(b)},"bus show":function(){this.show()},"bus hide":function(){},"bus show+afterRender:last":function(a){var b=a.afterRender.data.element},"bus hide+afterRender:last":function(a){var b=a.afterRender.data.element;b.hide(),this.config.visible=!1},showElement:function(){this.element.show()},show:function(){this.showElement(),this.config.visible=!0},hideElement:function(){this.element.hide()},hide:function(){this.hideElement(),this.config.visible=!1},"bus applyTo":function(a){this.element=a.data.element},"bus afterInit+dataBind":function(a){this.render(a.dataBind.data,a.afterInit.data)},render:function(a,b){this.fireBeforeRender({data:a}),this.doRender(a,b.refreshSelector),this.fireAfterRender({data:a})},fireBeforeRender:function(a){a=a||{},this.fire("beforeRender",{data:a.data,view:this,element:this.element})},fireAfterRender:function(a){a=a||{},this.fire("afterRender",{data:a.data,view:this,element:this.element})}});return d})