define(["Underscore","tau/core/class","tau/core/bus","tau/configurator"],function(t,n,e,o){return n.extend({init:function(n){return this.config=t.extend({},n),this.config.context=this.config.context||{},t.defaults(this.config.context,{configurator:o}),this.bus=new e({name:this.config.name,globalBus:this.config.context.configurator.getGlobalBus(),"queue.bus":this.config["queue.bus"]||this.config.queuedBus}),t.defaults(this.config,{bus:this.bus}),this},attach:function(n,e){e=e||{};var o=[];t.isObject(n)&&t.has(n,"extType")&&t.has(n,"args")&&(o=n.args,n=n.extType);var i=this.config.disabledExtensionCategories;if(i){var r=n.prototype.category;if(r&&t.contains(i,r))return this}var s=t.clone(this.config);e.hasOwnProperty("onCreate")||(s=t.extend(s,e));var c=o.length?this.applyConstruct(n,[s].concat(o)):new n(s);return e.onCreate&&e.onCreate(c),this},extendWithArgs:function(t,n){return{ExtType:t,args:n}},applyConstruct:function(t,n){function e(){}var o,i;return e.prototype=t.prototype,o=new e,o.constructor=t,i=t.apply(o,n),null===i||"object"!=typeof i&&"function"!=typeof i||(o=i),o}})});