define(["Underscore","tau/core/class","tau/core/bus","tau/configurator"],function(_,Class,Bus,configurator){return Class.extend({init:function(config){return this.config=_.extend({},config),this.config.context=this.config.context||{},_.defaults(this.config.context,{configurator:configurator}),this.bus=new Bus({name:this.config.name,globalBus:this.config.context.configurator.getGlobalBus(),"queue.bus":this.config["queue.bus"]||this.config.queuedBus}),_.defaults(this.config,{bus:this.bus}),this},attach:function(ExtensionClass,attachmentConfig){attachmentConfig=attachmentConfig||{};var excludes=this.config.disabledExtensionCategories;if(excludes){var category=ExtensionClass.prototype.category;if(category&&_.indexOf(excludes,category)>=0)return this}var config=_.clone(this.config);attachmentConfig.hasOwnProperty("onCreate")||(config=_.extend(config,attachmentConfig));var a=new ExtensionClass(config);return attachmentConfig.onCreate&&attachmentConfig.onCreate(a),this}})})