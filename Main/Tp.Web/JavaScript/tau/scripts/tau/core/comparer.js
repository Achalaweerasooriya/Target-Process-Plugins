define(["Underscore"],function(a){return{isEqualIncluded:function(b,c){if(b===c)return!0;var d=typeof b,e=typeof c;if(d!=e)return!1;if(b==c)return!0;if(!b&&c||b&&!c)return!1;if(a.isDate(b)&&a.isDate(c))return b.getTime()===c.getTime();if(a.isNaN(b)&&a.isNaN(c))return!1;if(a.isRegExp(b)&&a.isRegExp(c))return b.source===c.source&&b.global===c.global&&b.ignoreCase===c.ignoreCase&&b.multiline===c.multiline;if(d!=="object")return!1;if(a.isArray(b)&&a.isArray(c)&&b.length!==c.length)return!1;var f=a.keys(c);for(var g=0;g<f.length;g++){var h=f[g];if(b.hasOwnProperty(h)&&!this.isEqualIncluded(b[h],c[h]))return!1}return!0},compare:function(b,c){var d=this,e={changes:{}};return b?(a.each(a(c).keys(),function(a){var f={value:c[a]};if(!b.hasOwnProperty(a)){e.changes[a]=f;return}d.isEqualIncluded(b[a],c[a])||(e.changes[a]=f)}),e):e}}})