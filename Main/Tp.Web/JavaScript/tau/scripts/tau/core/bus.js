define(["Underscore","tau/core/class","tau/core/bus.reg","tau/core/event"],function(a,b,c,d){function f(a,b,c){var d=b[1],e=b[0];a.name.match(/(diagnostics)/)&&console.log(a.name,"["+a.id+"]",":",e,d||"")}var e=b.extend({globalBus:null,init:function(b){b=b||{},this.globalBus=b&&b.globalBus?b.globalBus:null,this.name=b&&b.name?b.name:a.uniqueId()+"",a.defaults(b,{id:a.uniqueId("bus_")}),this.id=b.id,c.onCreate(this)},initialize:function(a){this.fire("initialize",a)},destroy:function(){this.fire("destroy"),delete this.globalBus},getGlobalBus:function(){return this.globalBus}});return d.implementOn(e.prototype),e.prototype.fire=function(a,b,e){this.globalBus&&this.globalBus.fire(a,b,this);var f=d.prototype.fire.apply(this,arguments);return a==="destroy"&&(c.onDestroy(this),delete this.globalBus),f},e})