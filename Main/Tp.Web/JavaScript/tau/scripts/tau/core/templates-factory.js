define(["Underscore","jQuery","libs/jquery/jquery.tmpl"],function(a,b){var c={sub:function(b,c){var e=a.isArray(c)?c:[c],f=[];for(var g=0,h=e.length;g<h;g++)f.push(d.get(b).render(null,e[g]));return f.join("")}},d={templates:{},initialized:{},get:function(a){var b=this,c=b.templates[a];if(!c)throw["Template '",a,"' was not registered."].join("");return b[c.engine+".get"](a)},"jquery.get":function(a){var c=this;if(!b.template.hasOwnProperty(a))throw["jQuery template '",a,"' was not found."].join("");return{bind:function(d,e){var f={},g=c.templates[a],h=g.tags||[];for(var i=0;i<h.length;i++){var j=h[i];j.register(d,f)}var k=b.template[a];return b.tmpl(k,e,f)}}},"jqote2.get":function(a){var d=this,e=d.templates[a];if(!e.jqotecmpl)throw["Template '",a,"' was not compiled."].join("");return{render:function(a,b){return e.jqotecmpl.call(b,0,0,[b],c)},bind:function(a,c){var d=this.render(a,c);return b(d)}}},registerRecursively:function(a,c){var d=this;c=c||{tags:[]};var e=null;if(!b.template.hasOwnProperty(a)){e=this.templates[a];if(!e)throw["Template '",a,"' was not found."].join("");e.tags&&(c.tags=c.tags.concat(e.tags)),b.each(e.dependencies,function(a,b){d.registerRecursively(b,c)}),e.tags=c.tags;var f=e.markup;b.template(a,f)}else e=e||this.templates[a],e.tags&&(c.tags=c.tags.concat(e.tags))},"jquery.register":function(a){var b=this;b.registerRecursively(a.name)},"jqote2.register":function(a){a.jqotecmpl=b.jqotec(a.markup)},register:function(b){var c=this;return b.dependencies=b.dependencies||[],b.markup=a.isArray(b.markup)?b.markup.join(""):b.markup,b.engine=b.engine||"jquery",c.templates[b.name]=b,c[b.engine+".register"](b),{name:b.name,options:b.options||{},get:function(){return c.get(b.name)}}}};return d})