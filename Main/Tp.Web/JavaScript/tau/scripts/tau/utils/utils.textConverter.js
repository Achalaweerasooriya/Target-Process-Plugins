define(["Underscore","tau/core/class"],function(n,r){var e=r.extend({convert:function(n,r){var e=n;if(r===!0){for(var p=$("<span></span>"),t=e.split(/\r\n|\r|\n/),a=0;a<t.length;a++)t[a]=p.text(t[a]).html();e=t.join("\r\n")}return e=e.replace(/([^\r])\n/gi,"$1<br />\n"),e=e.replace(/\r\n/gi,"<br />\r\n"),e=e.replace(/  /gi,"&nbsp;&nbsp;"),e=e.replace(/&nbsp; /gi,"&nbsp;&nbsp;")}});return e});