define(["Underscore","jQuery","tau/core/class","tau/storage/app.state.store.seriailzer","tau/services/service.hash"],function(t,e,r,i,n){return r.extend({init:function(e){this.applicationPath=e.getApplicationPath(),this.currentAcid=e.getCurrentAcid(),this.configurator=e,this.stateManager=e.getStateManager(),this.stateManager.get({id:"appConfig",fields:["acid"],callback:t.bind(function(t){t.acid&&(this.currentAcid=t.acid)},this)}),this.stateManager.bind({paramId:"appConfig",fieldName:"acid",listener:this,callback:t.bind(function(t){t.value&&(this.currentAcid=t.value)},this)}),this.pages={view:"/RestUI/TpView.aspx"}},getApplicationPath:function(){return this.applicationPath},getCurrentAcid:function(){return this.currentAcid},hash:function(){var e=new n(this.configurator),r={location:{hash:"",replace:function(t){r.location.hash=t}}};return e.setWindow(r),{append:function(r){return t.forEach(r,function(t,r){e.setHashParam(r,t)}),this},build:function(){return"#"+e.getHash()}}},getAddImpedimentUrl:function(t){return this.getApplicationPath()+"/Project/Tracking/Impediment/Edit.aspx?AssignableID="+t},getAddTimeUrl:function(t){return this.getApplicationPath()+"/Project/Tracking/Time/Edit.aspx?AssignableID="+t},getAddTaskForUserStoryUrl:function(t){return this.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?UserStoryID="+t},getAddTaskForRequestUrl:function(t){return this.getApplicationPath()+"/Project/Planning/Task/Edit.aspx?RequestID="+t},getSplitForUserStoryUrl:function(t,e){return this.getApplicationPath()+"/Project/Planning/UserStory/Split.aspx?UserStoryID="+t+"&SplittedStoryID="+e},getAddBugForUserStoryUrl:function(t){return this.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?UserStoryID="+t},getAddBugForRequestUrl:function(t){return this.getApplicationPath()+"/Project/QA/Bug/Edit.aspx?RequestID="+t},getAddTestCaseForUserStoryUrl:function(t){return this.getApplicationPath()+"/Project/QA/TestCase/Edit.aspx?UserStoryID="+t},getAssignTestCasesForTestPlanUrl:function(t){return this.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+t},getAddTestRunForTestPlanUrl:function(t){return this.getApplicationPath()+"/Project/QA/TestPlanRun/Edit.aspx?TestPlanID="+t},getAddUserStoryForRequestUrl:function(t){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?RequestID="+t},getAddUserStoryForFeatureUrl:function(t){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?FeatureID="+t},getAddUserStoryForIterationUrl:function(t){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?IterationID="+t},getAddUserStoryForTeamIterationUrl:function(t){return this.getApplicationPath()+"/Project/Planning/UserStory/Edit.aspx?TeamIterationID="+t},getAddFeatureForRequestUrl:function(t){return this.getApplicationPath()+"/Project/Planning/Feature/Edit.aspx?RequestID="+t},getAddTestCaseForTestPlanRunUrl:function(t){return this.getApplicationPath()+"/Project/QA/TestPlan/AssignTestCases.aspx?TestPlanID="+t},getAddIterationForReleaseUrl:function(t){return this.getApplicationPath()+"/Project/Planning/Iteration/Edit.aspx?ReleaseID="+t},getBoardPageRelativePath:function(){return"restui/board.aspx"},getPrintUrlRelative:function(t,e){return"RestUI/Print.aspx?acid="+this.getCurrentAcid()+"#"+e.toLowerCase()+"/"+t+"/print"},getNewViewUrl:function(t,e,r){return this.getRelativeBoardPageUrl(e.toLowerCase()+"/"+t,r===!0?void 0:r)},getDashboardUrl:function(){return this.getRelativeBoardPageUrl("board/current")},getShortViewUrl:function(t){return this.getApplicationPath()+"/entity/"+t.id},getEditUrl:function(e,r){var i=this.getApplicationPath()+"/",n=r.toLowerCase();return"project"==n?i+="EditProject.aspx?ProjectID="+e:(i+="Project/",i+=t.indexOf(["bug","testplan","testcase","testplanrun"],n)>-1?"QA/":t.indexOf(["impediment"],n)>-1?"Tracking/":t.indexOf(["request"],n)>-1?"HelpDesk/":"time"===n?"Tracking/":"Planning/",i+=r+"/Edit.aspx?"+r+"ID="+e),i},getAvatarUrl:function(t,e){return this.getApplicationPath()+"/Avatar.ashx?UserId="+t+"&size="+e},getLogoutUrl:function(){return this.getApplicationPath()+"/login.aspx?logout=true"},getUserUrl:function(t,e){var r="/User/View.aspx?UserID=";return e&&"Requester"==e&&(r="/User/Requester/View.aspx?RequesterID="),[this.getApplicationPath(),r,t].join("")},getRelativeBoardPageUrl:function(e,r){if(t.isUndefined(r))r=this.configurator.getAppStateStore().settings;else if(t.isString(r)){var n=this.configurator.getAppStateStore().settings;n.acid=r,r=n}var a=this.hash();return a.append({page:e}),a.append(i.extractSharedState(r)),a.build()},getRelativeBoardUrl:function(t,e){return this.getRelativeBoardPageUrl("board/"+t,e)},getAdminWorkflowEdit:function(t){return this.getApplicationPath()+"/Admin/Workflow.aspx?acid="+this.getCurrentAcid()+"&ProcessID="+t+"&rmnav=1&hideleftmenu=1"},_build:function(t){var r="";r=t.path;var i=e.param(t.params);return i&&(r=r+"?"+i),t.hash&&(r=r+"#"+t.hash),r},destroy:function(){this.stateManager.unbind(this)}})});