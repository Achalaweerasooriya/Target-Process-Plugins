define(["Underscore","jQuery","tau/core/class"],function(_,$,Class){return Class.extend({init:function(_window,appPath){this.window=_window,this.appPath=appPath},_process:function(url,context){var resultUrl=null;if(url.match(/^http(s)?:\/\//i))resultUrl=url;else if(url[0]=="#")resultUrl=url;else{var root=this.appPath;url[0]!=="/"&&(url="/"+url),resultUrl=root+url}return context&&(resultUrl=$.tmpl(resultUrl,context).text()),resultUrl},_redirect:function(url,targetWindow){targetWindow.location.href=url},redirect:function(url,target,context){var targetWindow=this.window;if(target){var $doc=$(document),config={scrollbars:1,width:$doc.width()*.8,height:$doc.height()*.8,top:50},arr=[],prop=null;for(prop in config)arr.push(prop+"="+config[prop]);var str=arr.join(",");targetWindow=this.window.open(this._process(url,context),target,str);return}this._redirect(this._process(url,context),targetWindow)},back:function(){this.window.history&&this.window.history.back&&this.window.history.back()},reload:function(){if(this.window.location&&this.window.location.reload){var reload=_.bind(function(){this.window.location.reload()},this);setTimeout(reload,1)}}})})