define(["Underscore","tau/configurator","tau/core/repository","tau/services/service.rest","tests/common/modelConfig"],function(a,b,c,d,e){var f={scope:null,setup:function(c,d){this.scope=c,a(d).defaults({}),b.clear(),this.setAppPath("/TP"),this.setCurrentDate(new Date(1307600546192)),b.disableRules(),this.scope.mockControl=new MockControl;return this},setAppPath:function(a){var c=this.scope;c.rootAppPath=a,b.setApplicationPath(c.rootAppPath);return this},setCurrentDate:function(a){b.setCurrentDate(a);return this},getAppPath:function(){var a=this.scope;return a.rootAppPath},setInitialData:function(c){a(c).defaults({testData:[]}),b.setInitialData(c.testData),this.scope.testData=c.testData;return this},mockRepository:function(c){c=c||{},a(c).defaults({testData:[]});var e=this.scope,f=e.serviceMock=e.mockControl.createMock(d);b.setService(f),e.repository=b.getProxy(),e.repository.registerData(c.testData),e.testData=c.testData,e.repositoryMock=e.mockControl.createMock(e.repository),b.setProxy(e.repositoryMock);return this},mockService:function(c){c=c||{},a(c).defaults({testData:[]});var e=this.scope;e.serviceMock=e.mockControl.createMock(d),b.setService(e.serviceMock),e.repository=b.getProxy(),e.repository.registerData(c.testData),e.testData=c.testData;return this},createModel:function(b){var c=this.scope;a(b).defaults({context:{type:"story",id:15},data:{}});if(!b.factory)throw"Factory is missing";b.context.type&&(c.context=e[b.context.type](b.context.id)),a(c.context).extend(b.data),c.model=b.factory.createModel(c.context);return this},tearDown:function(a){delete a.rootAppPath,delete a.mockControl,delete a.repository,delete a.repositoryMock,delete a.context,delete a.model,delete a.assignable,delete a.bug,delete a.story,delete a.component,delete a.config}};return f})