define(["Underscore","tau/core/class","tau/utils/utils.fixturesLoader","tau/models/dataprocessor/model.processor.context"],function(_,Class,FixturesLoader,contextProcessor){var context=Class.extend({init:function(config){this.entity={id:7357,type:"bug"},this.defaultFixtures={context:{test:{acid:"56B47A374989E87FC3C87D817A69C46E",loggedUser:"u1",processes:["all"],selectedProjects:["p1"],culture:"en-US",edition:"Pro"}},users:{u1:{firstName:"Administrator",lastName:"Administrator",email:"admin@example.com",isActive:!0,isAdministrator:!0}},projects:{p1:{name:"Test Project",process:"all"}},process:{all:{id:777,name:"All Practices",practices:["planning","timeTracking","bugTracking","requirements","testCases","sourceControl","helpDesc","iterations"]}},processInfo:{all:{id:777,name:"All Practices",practices:["planning","timeTracking","bugTracking","requirements","testCases","sourceControl","helpDesc","iterations"]}},practices:{planning:{name:"Planning",effortPoints:"Hour",isStoryEffortEqualsSumTasksEffort:!1},timeTracking:{name:"Time Tracking",isCloseAssignableIfZeroTimeRemaining:!1,isTimeDescriptionFieldVisible:!0,isTimeDescriptionRequired:!0,isRequiredShowRoleDropDown:!1},bugTracking:{name:"Bug Tracking"},requirements:{name:"Requirements"},testCases:{name:"Test Cases"},sourceControl:{name:"Source Control"},helpDesc:{name:"Help Desk"},iterations:{name:"Iterations"}},cultures:{"en-US":{name:"en-US",timePattern:"g:i A",shortDateFormat:"M/d/yyyy",longDateFormat:"dddd, MMMM dd, yyyy",decimalSeparator:"."}}};var loader=new FixturesLoader({generateId:!0,setType:!0,copyAdditionalFields:!0}),data=loader.load(this.defaultFixtures);this.defaultData=data;var self=this;_.forEach(data.context.test,function(value,key){})},selectDefaultProject:function(){this.selectedProjects=[this.defaultData.project.p1],this.processes=[this.defaultData.project.p1.process]},selectProject:function(projectData,excludePractices){projectData.process?projectData.process.practices.length==0&&(projectData.process.practices=this.defaultData.process.all.practices):projectData.process=this.defaultData.process.all,excludePractices&&_.forEach(projectData.process.practices,function(practice,key){_.inArray(practice.name.toLowerCase(),excludePractices)&&projectData.process.practices.splice(key,1)}),this.selectedProjects=[projectData],this.processes=[projectData.process]},excludePractices:function(names){if(names){var self=this;_.forEach(this.processes[0].practices,function(practice,key){_.inArray(practice.name,names)&&self.processes[0].practices.splice(key,1)})}},loginAs:function(user){this.loggedUser=user},setEntity:function(entity){this.entity={id:entity.id,type:entity.type?entity.type:entity.__type?entity.__type:"assignable"}},setEdition:function(val){this.defaultData.context.test.edition=val},process:function(){_.defaults(this.entity,{id:7357,type:"bug"});var appContext=this.defaultData.context.test;appContext.processes=[appContext.selectedProjects[0].process];var result={entity:this.entity,applicationContext:appContext};return contextProcessor(result)}});return context})