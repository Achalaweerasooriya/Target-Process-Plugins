define(["tau/core/tau"],function(tau){function getText($el){var childNodes=$el.get(0).childNodes,parts=[];for(var i=0,length=childNodes.length;i<length;i++)childNodes[i].nodeType==3&&parts.push(childNodes[i].nodeValue);return tau.concat.apply(window,parts)}return{checkAssignments:function($assignments,data){var $nobr=$assignments.find("nobr");equal($nobr.length,data.groups.length,"Count of assignments is valid");for(var i=0;i<$nobr.length;i++){var userNames=[],users=data.groups[i].users,$el=$nobr.eq(i);if(users.length>0){for(var userNumber=0;userNumber<users.length;userNumber++)userNames.push(users[userNumber].name);equal($el.text(),[data.groups[i].role.name," ",userNames.join(" | ")].join(""),"Role name is valid")}else equal($el.find(".unassigned-link").text(),"Unassigned"),equal($el.text(),[data.groups[i].role.name," ","Unassigned"].join(""),"Role name is valid");i<$nobr.length-1&&ok($nobr.next().is("br"),"Break line was added")}},getDOMStructure:function($el){var structure={};structure.tagName=$el.get(0).tagName.toLowerCase();var attributes=$el.get(0).attributes;if(attributes&&attributes.length>0){structure.attributes={};for(var i=0,length=attributes.length;i<length;i++)structure.attributes[attributes[i].name]=attributes[i].value}var text=_.trim(getText($el));text&&text.length>0&&(structure.text=text);var $children=$el.children(),self=arguments.callee;if($children.length>0){var children=[];$children.each(function(i,dom){children.push(self($(dom)))}),structure.children=children}return structure}}})