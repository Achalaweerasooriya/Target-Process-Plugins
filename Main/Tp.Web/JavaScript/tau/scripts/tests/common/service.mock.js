define(["tau/core/class"],function(Class){return Class.extend({saveCommandList:null,removeCommandList:null,removeFromListCommandList:null,getCommandList:null,findCommandList:null,refreshCommandList:null,init:function(){this.saveCommandList=[],this.removeCommandList=[],this.removeFromListCommandList=[],this.getCommandList=[],this.findCommandList=[],this.refreshCommandList=[]},registerSaveCommand:function(command){this.saveCommandList.push(command)},registerRemoveCommand:function(command){this.removeCommandList.push(command)},registerRemoveFromListCommand:function(command){this.removeFromListCommandList.push(command)},registerGetCommand:function(command){this.getCommandList.push(command)},registerFindCommand:function(command){this.findCommandList.push(command)},registerRefreshCommand:function(command){this.refreshCommandList.push(command)},executeCommand:function(methodName,commandList,command){if(commandList.length==0)throw same(command,null,"Actual command"),"Unexpected call "+methodName+" function of service with command"+command;var expectedCommand=commandList[0];commandList.splice(0,1),same(command.config,expectedCommand.config),expectedCommand.preCheck&&expectedCommand._test&&expectedCommand._test[expectedCommand.preCheck]&&expectedCommand._test[expectedCommand.preCheck].apply(expectedCommand._test),command.callbacks.success(expectedCommand.returnedData)},remove:function(command){this.executeCommand("remove",this.removeCommandList,command)},removeFromList:function(command){this.executeCommand("removeFromList",this.removeFromListCommandList,command)},save:function(command){this.executeCommand("save",this.saveCommandList,command)},get:function(command){this.executeCommand("get",this.getCommandList,command)},find:function(command){this.executeCommand("find",this.findCommandList,command)},refresh:function(command){this.executeCommand("refresh",this.refreshCommandList,command)},verify:function(strongVerification){var verifyCommandList=function(list,cmdName){list.length>0&&same([],list,"Not all "+cmdName+" commands were executed")};strongVerification&&verifyCommandList(this.getCommandList,"get"),verifyCommandList(this.saveCommandList,"save"),verifyCommandList(this.removeCommandList,"remove"),verifyCommandList(this.removeFromListCommandList,"remove"),verifyCommandList(this.findCommandList,"find"),verifyCommandList(this.refreshCommandList,"refresh")}})})