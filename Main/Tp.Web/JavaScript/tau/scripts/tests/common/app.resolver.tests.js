define(["Underscore","jQuery","tau/app.resolver","tau/service.container"],function(_,$,appResolver,ServiceContainer){var innerRun=function(){module("[AppResolver] module tests",{setup:function(){this.configurator=new ServiceContainer,this.appConfig={appId:"page",configurator:this.configurator}},teardown:function(){delete this.appConfig,this.configurator.clear(),delete this.configurator}}),test("should resolve page info without appId param",function(){this.configurator.getHashService().setFakeWindow("#board/7");var info=appResolver.resolvePageInfo(this.appConfig);equals(info.type,"board","Page type"),equals(info.id,"7","Page id")}),test("should resolve page info with appId param",function(){var win={location:{hash:"#abcdefg&page=board/7&popup=bug/22"}};this.configurator.setExternal(win);var info=appResolver.resolvePageInfo(this.appConfig);equals(info.type,"board","Page type"),equals(info.id,"7","Page id")}),test("should resolve page info with legacy state",function(){this.configurator.getHashService().setFakeWindow('#bug/22||{"state":1}&state=123');var info=appResolver.resolvePageInfo(this.appConfig);equals(info.type,"bug","Page type"),equals(info.id,"22","Page id")}),test("should resolve page info with legacy state",function(){this.configurator.getHashService().setFakeWindow('#bug/22||{"state":1}&state=123');var info=appResolver.resolvePageInfo(this.appConfig);equals(info.type,"bug","Page type"),equals(info.id,"22","Page id")}),test("should resolve page info with default param",function(){this.configurator.getHashService().setFakeWindow({search:"?acid=1234567890"});var acid=appResolver.getQueryParam("?acid=1234567890","acid"),defaultPageInfo={id:acid,type:"board"},info=appResolver.resolvePageInfo(this.appConfig,defaultPageInfo);equals(info.type,"board","Page type"),equals(info.id,"1234567890","Page id")})};return{run:innerRun}})