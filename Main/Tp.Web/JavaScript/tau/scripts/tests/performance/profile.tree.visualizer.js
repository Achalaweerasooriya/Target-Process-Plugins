define(["Underscore","jQuery"],function(_,$){function a(a,b,c){var d=$("<div></div>");d.css("width",Math.round(b*100)+"%");if(a.stack.length===0||a.value>4+c){var e=a.value+"ms / "+a.name;d.css("margin","10px 0 4px 1px").css("border","1px #000 solid").css("color","#FFF").css("font-size","12px").css("font-family","Tahoma").css("background-color","#2F4F4F").css("overflow","hidden").css("white-space","nowrap").css("text-overflow","ellipsis").attr("title",e),d.html("<span>"+e+"</span>")}return d}function b(c,d){var e=d.value;return _(d.stack).each(function(d){var f=d.value/e,g=0;_(d.stack).each(function(a){g+=a.value});if(f>.05){var h=a(d,f,g);b(h,d),c.append(h)}}),c}return{build:function(a){var c=$("<div></div>");return c.css("width",1e3).css("margin-top","5px").css("background-color","#F0FFF0").css("border","1px #000 solid"),b(c,a.tree)}}})