define(["Underscore","jQuery"],function(a,b){function c(a,c,d){var e=b("<div></div>");e.css("width",Math.round(c*100)+"%");if(a.stack.length===0||a.value>4+d){var f=a.value+"ms / "+a.name;e.css("margin","10px 0 4px 1px").css("border","1px #000 solid").css("color","#FFF").css("font-size","12px").css("font-family","Tahoma").css("background-color","#2F4F4F").css("overflow","hidden").css("white-space","nowrap").css("text-overflow","ellipsis").attr("title",f),e.html("<span>"+f+"</span>")}return e}function d(b,e){var f=e.value;return a(e.stack).each(function(e){var g=e.value/f,h=0;a(e.stack).each(function(a){h+=a.value});if(g>.05){var i=c(e,g,h);d(i,e),b.append(i)}}),b}return{build:function(a){var c=b("<div></div>");return c.css("width",1e3).css("margin-top","5px").css("background-color","#F0FFF0").css("border","1px #000 solid"),d(c,a.tree)}}})