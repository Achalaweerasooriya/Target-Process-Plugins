define(["Underscore","tests/components/list/specific/component.list.spec.base","tau/models/dataProviders/feature/feature.model.provider.user_stories.items","tau/models/dataProviders/feature/feature.model.provider.user_stories.groups","tau/ui/templates/list_/grid.entity/ui.template.list.grid.entity"],function(_,a,b,c){var d=function(){var d=a.Testcase.create("[list.feature.user_stories]",b,c,function(){var a={us:"UserStory"},b={kanban:"Kanban",scrum:"Scrum"},c={p1:"Good"},d={s1:"Good"},e={p_kanban:{name:"Project Kanban",abbrevation:"PK",process:"kanban"},p_scrum:{name:"Project Scrum",abbrevation:"PS",process:"scrum"}},f={kanban_us_new:{name:"New",entityType:"us",process:"kanban",nextStates:["kanban_us_inprogress"],isInitial:!0},kanban_us_inprogress:{name:"In Progress",entityType:"us",nextStates:["kanban_us_done"],process:"kanban"},kanban_us_done:{name:"Done",entityType:"us",process:"kanban",isFinal:!0},scrum_us_open:{name:"Open",entityType:"us",process:"scrum",nextStates:["scrum_us_planned"],isInitial:!0},scrum_us_planned:{name:"Planned",entityType:"us",nextStates:["scrum_us_indevelopment","scrum_us_closed"],process:"scrum"},scrum_us_indevelopment:{name:"In Development",entityType:"us",nextStates:["scrum_us_intesting"],isCommentRequired:!0,process:"scrum"},scrum_us_intesting:{name:"In Testing",entityType:"us",nextStates:["scrum_us_closed"],process:"scrum"},scrum_us_closed:{name:"Closed",entityType:"us",process:"scrum",isFinal:!0}},g={f1:{name:"Feature",userStories:["us1","us2"],project:"p_kanban",process:"kanban"}},h={us1:{name:"US1",entityState:"kanban_us_inprogress",priority:"p1",project:"p_kanban"},us2:{name:"US2",entityState:"scrum_us_planned",priority:"p1",project:"p_scrum"}};this.loadFixtures({entityType:a,projects:e,entityStates:f,userStories:h,priority:c,severity:d,processes:b,features:g}),this.setProject(this.data.project.p_kanban),this.setEntity(this.data.feature.f1)});d.add(new a.TestMarkup({groups:[{title:"New, Open",items:[]},{title:"In Progress",items:["US1"]},{title:"Planned",items:["US2"]},{title:"In Development",items:[]},{title:"In Testing",items:[]},{title:"Done, Closed",items:[]}]}));var e=new a.Test;d.add(new a.Test({name:"dnd available states using process",test:function(){var a=this.$el.find("[role=group]:eq(2)"),b=this.$el.find("[role=group]:eq(5)");b.find("[role=title]").click();var c=a.find("[role=item]:eq(0)"),f=d.data.userStory.us2,g=d.data.entityState.scrum_us_closed;e.registerPrioritize(f.id,{beforeId:null,afterId:null}),e.registerChangeState(f,g),e.$el=this.$el,e.checkGroupsAvailability(6,0),e.startMove(c),e.checkGroupsAvailability(3,3);var h=this.$el.find("[role=group]");ok(h.eq(3).hasClass("tau-list__group_available_true"),"In Dev available"),ok(h.eq(5).hasClass("tau-list__group_available_true"),"Done available"),e.moveAfter(c,b),e.endMove(),e.checkGroupsAvailability(6,0)}})),d.add(new a.Test({name:"dnd change state use comment",test:function(){var a="fuck you",b=this.$el.find("[role=group]:eq(2)"),c=this.$el.find("[role=group]:eq(3)"),f=b.find("[role=item]:eq(0)"),g=d.data.userStory.us2,h=d.data.entityState.scrum_us_indevelopment;e.$el=this.$el,e.checkGroupsAvailability(6,0),e.startMove(f),e.checkGroupsAvailability(3,3),e.moveAfter(f,c),e.checkBubble(f),e.cancelBubble(f),b=this.$el.find("[role=group]:eq(2)"),c=this.$el.find("[role=group]:eq(3)"),f=b.find("[role=item]:eq(0)"),e.registerComment(g,a),e.registerPrioritize(g.id,{beforeId:null,afterId:null}),e.registerChangeState(g,h),e.$el=this.$el,e.checkGroupsAvailability(6,0),e.startMove(f),e.checkGroupsAvailability(3,3),e.moveAfter(f,c),e.checkBubble(f),e.submitBubble(f,a),e.endMove(),e.checkGroupsAvailability(6,0)}})),d.run()};return{run:d}})