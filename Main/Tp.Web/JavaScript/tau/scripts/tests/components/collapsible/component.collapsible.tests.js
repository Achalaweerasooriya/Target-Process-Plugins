define(["tau/components/component.collapsible","tests/components/common/common.setup","tests/components/component.specs","tau/configurator","tests/components/component1","tests/components/component2"],function(component,componentSetup,componentSpecs,configurator){var innerRun=function(){var getCommonConfig=function(isCollapsed){return{context:{type:"bug",id:1},settings:{collapsed:isCollapsed,header:[],items:[{path:"tests/components/component1",x:3,y:5},{path:"tests/components/component2",x:3,y:5}]}}},commonTests=[{name:"should has child controls",test:function(){var $el=this.$el,isCollapsed=this.config.collapsed;equals($el.find(".ui-collapsible-header").length,1,"Collapsible header component is rendered");var amount=isCollapsed?0:1;equals($el.find(".component1").length,amount,'Amount of "Component 1" child is valid'),equals($el.find(".component2").length,amount,'Amount of "Component 2" child is valid')}}],viewExpandedTests=commonTests.concat([{name:"should collapse on click",test:function(){var $el=this.$el,$header=$el.find(".ui-collapsible-header"),$innerContainer=$el.find(".component1").parent();ok($innerContainer.css("display")!=="none","Inner container is visible before click"),$header.click(),ok($innerContainer.css("display")==="none","Inner container is hidden after click")}}]),setup=componentSetup.create("[component.collapsible][expanded]",{},component,{context:{configurator:configurator}});componentSpecs.create(setup,getCommonConfig(!1)).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests(viewExpandedTests).done();var viewCollapsedTests=commonTests.concat([{name:"should expand on click",test:function(){var $el=this.$el,$header=$el.find(".ui-collapsible-header"),$innerContainer=$header.next();ok($innerContainer.css("display")==="none","Inner container is hidden before click"),$header.click(),ok($innerContainer.css("display")!=="none","Inner container is visible after click"),equals($el.find(".component1").length,1,'Amount of "Component 1" child is valid'),equals($el.find(".component2").length,1,'Amount of "Component 2" child is valid')}}]),setup=componentSetup.create("[component.collapsible][collapsed]",{},component,{context:{configurator:configurator}});componentSpecs.create(setup,getCommonConfig(!0)).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests(viewCollapsedTests).done()};return{run:innerRun}})