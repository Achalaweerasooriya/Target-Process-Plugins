define(["jQuery","tau/components/component.property.owner","tests/components/component.specs","tests/common/testData.Generator","tests/common/service.mock","tau/configurator","tests/components/common/common.setup"],function($,a,b,c,d,e,f){var g=function(){function g(a){return[a.firstName,a.lastName].join(" ")}var h=new c;h.initDefaultData();var i=h.getData(),j=h.getBugs()[0],k={context:{type:"bug",id:j.id}},l=j.owner,m="/TP/Avatar.ashx?UserId="+l.id+"&size=32",n=g(l),o=h.getUsers()[5],p=g(o),q=f.create("[component.owner]",i,a,k),r=[{name:"should render valid markup",test:function(){var a=this.$el;equal(a.find(".owner-avatar-container .owner-avatar").attr("src"),m,"Avatar src"),equal(a.find(".owner-info .user-name").text(),n,"User name")}},{name:"should change owner",preSetup:function(){var a=this.service=new d;e.setService(a)},test:function(){var a=this.$el,b=a.find(".owner-info .user-name");b.click();var c=$(".tau-bubble");equal(c.size(),1,"Count of bubbles");var d=c.eq(0).find('.user-name:contains("'+p+'")');this.service.registerSaveCommand({config:{$set:{owner:{id:o.id}},fields:["id",{owner:["id","firstName","lastName"]}],id:j.id},returnedData:{id:j.id,owner:o}}),d.click(),equal(this.$el.find(".owner-info .user-name").text(),p,"Owner was changed")}}];b.create(q,k).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests(r).done()};return{run:g}})