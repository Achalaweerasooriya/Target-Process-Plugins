define(["Underscore","tau/utils/utils.textsearch"],function(_,a){var b=function(){module("[utils.textsearch]",{setup:function(){}}),test("should build index and do search",function(){var b=new a;b.load([{_id:1,data:"Lorem ipsum"},{_id:2,data:"Preved medved"}]);var c=b.search("preved");same(c,[{_id:2,data:"Preved medved",entry:{from:0,len:6}}],"search data: preved"),b.load([{_id:1,data:"Preved    medved"},{_id:2,data:"[Preved] medved"},{_id:3,data:"Abra PREved: medved cadabra"},{_id:4,data:"Sim Salabim"},{_id:5,data:"preved-medved"}]),c=b.search("preved medved"),same(c,[{_id:1,data:"Preved    medved",entry:{from:0,len:16}},{_id:2,data:"[Preved] medved",entry:{from:1,len:14}},{_id:3,data:"Abra PREved: medved cadabra",entry:{from:5,len:14}},{_id:5,data:"preved-medved",entry:{from:0,len:13}}],"search data: preved medved"),c=b.search("medved!!!"),same(c,[],"zero result: medved!!!"),b.load([{_id:1,data:"колесо  сансары"},{_id:2,data:"карма!!"},{_id:3,data:"харе кришна"}]),c=b.search("харе"),same(c,[{_id:3,data:"харе кришна",entry:{from:0,len:4}}],"Search non latin: харе")}),test("should build index and do strong search",function(){var b=new a;b.load([{_id:1,data:"Lorem ipsum"},{_id:2,data:"Preved medved"},{_id:3,data:"Preved  super medved"}]);var c=b.search("preved medved");same(c,[{_id:2,data:"Preved medved",entry:{from:0,len:13}},{_id:3,data:"Preved  super medved",entry:{from:0,len:20}}],"search data: preved medved")}),test("should allow simple match",function(){var b=new a,c=b.match("preved medved","ved");same(c,{from:3,len:3},"find match: ved"),c=b.match("preved medved","bzz"),same(c,null,"find match: bzz"),c=b.match("preved medved"," eve  "),same(c,{from:2,len:3},"find match:  eve  ")}),test("match tuning",function(){var b=new a,c=[["Kanban for Program area","Kanban area",0,23],["Kanban for Program area","Kanban program",0,18],["Kanban for Program area","Kan are",null],["TP 1.7 - 2.0 Migration","1.",3,2],["TP 1.7 - 2.0 Migration","1?2",null],["TP 1 1!!","1!!",5,3],["[SVN] Auto-mapping SVN to TP Users","auto-",6,5]];for(var d=0;d<c.length;d++){var e=c[d],f=b.match(e[0],e[1]),g=e[2]===null?null:{from:e[2],len:e[3]};same(f,g,"find match: "+e[1])}})};return{run:b}})