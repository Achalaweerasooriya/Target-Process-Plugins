define(["tau/configurator","tau/utils/utils.redirect"],function(a,b){var c=null;b.prototype._redirect=function(a){c=a};var d={entity:{entityType:{name:"bug"},id:15}},e=function(){module("[utils.redirect] tests",{setup:function(){this.appPathBackup=a.getApplicationPath(),a.setApplicationPath("/TP"),this.windowBackup=a.getWindow();var c={open:function(){}};this.mockControl=new MockControl,this.windowMock=this.mockControl.createMock(c),a.setWindow(this.windowMock),this.redirect=new b(d)},teardown:function(){a.setWindow(this.windowBackup),a.setApplicationPath(this.appPathBackup)}}),test("should convert relative path",function(){this.redirect.redirect("/FAQ/Page_1"),equals(c,"/TP/FAQ/Page_1","Redirect to url"),this.redirect.redirect("FAQ/Page_1"),equals(c,"/TP/FAQ/Page_1","Redirect to url")}),test("should convert hash path",function(){this.redirect.redirect("#preved/medved"),equals(c,"#preved/medved","Redirect to url with hash")}),test("should convert urls with templates",function(){this.redirect.redirect("http://somewhere.com/App/SubApp/${entity.id}/${entity.entityType.name}"),equals(c,"http://somewhere.com/App/SubApp/15/bug","Redirect to url")}),test("should be able to open new window",function(){this.windowMock.expects().open("http://google.com","google",TypeOf.isA(String)).andStub(function(){return{location:{}}}),this.redirect.redirect("http://google.com","google"),this.mockControl.verify()})};return{run:e}})