define(["tau/store/types.targetprocess","jQuery","tau/components/component.property.severity","tests/components/component.specs","tests/common/testData.Generator","tests/common/service.mock","tau/configurator","tests/components/common/common.setup"],function(a,$,b,c,d,e,f,g){var h=function(){var a=new d;a.initDefaultData();var h=a.getData(),i=a.getProjects(),j=a.getBugs()[0],k=a.getSeverities(),l={manualContext:!0,context:{entity:{entityType:{name:j.__type},id:j.id},applicationContext:{selectedProjects:[i[0]],culture:{name:"en-US",timePattern:"g:i A",shortDateFormat:"M/d/yyyy",longDateFormat:"dddd, MMMM dd, yyyy",decimalSeparator:".",__type:"culture"},processes:a.getProcesses()}}},m=j.severity,n=k[3],o=function(){var a=this.service=new e;f.setService(a),f.getProxy().markRecordSetAsCompleteLoaded("severity")},p=g.create("[component.severity]",h,b,l),q=[{name:"should render valid markup",preSetup:o,test:function(){var a=this.$el;equal(a.find(".property-text").text(),m.name,"Severity name")}},{name:"should change severity",preSetup:o,test:function(){var a=this.$el,b=a.find(".property-text");b.click();var c=$(".tau-bubble");equal(c.size(),1,"Count of bubbles");var d=c.eq(0).find('.drop-down-option:contains("'+n.name+'")');this.service.registerSaveCommand({config:{$set:{severity:{id:n.id}},fields:["id"],id:j.id},returnedData:{id:j.id,severity:{id:n.id,name:n.name}}}),d.click(),equal(this.$el.find(".property-text").text(),n.name,"Severity was changed")}}];c.create(p,l).viewShouldFollowBasicComponentLifeCycle(o).viewShouldPassTests(q).done();var r=g.create("[component.severity] empty",h,b,l),s=a.getBugs()[1],t={context:{type:s.__type,id:s.id}};c.create(r,t).viewShouldFollowBasicComponentLifeCycle(o).viewShouldPassTests([{name:"should render valid markup for empty Severity",preSetup:o,test:function(){var a=this.$el;equal(a.find(".property-text").text(),"","Severity name")}}]).done()};return{run:h}})