define(["jQuery","tau/components/component.property.priority","tests/components/component.specs","tests/common/testData.Generator","tests/common/service.mock","tau/configurator","tests/components/common/common.setup"],function($,a,b,c,d,e,f){var g=function(){var g=new c;g.initDefaultData();var h=g.getData(),i=g.getProjects(),j=g.getBugs()[0],k=g.getPriorities(),l={manualContext:!0,context:{entity:{entityType:{name:j.__type},id:j.id},applicationContext:{selectedProjects:[i[0]],culture:{name:"en-US",timePattern:"g:i A",shortDateFormat:"M/d/yyyy",longDateFormat:"dddd, MMMM dd, yyyy",decimalSeparator:".",__type:"culture"},processes:g.getProcesses()}}},m=j.priority,n=k[2],o=f.create("[component.priority]",h,a,l),p=[{name:"should render valid markup",test:function(){var a=this.$el;equal(a.find(".property-text").text(),m.name,"Priority name"),equal(a.find(".external-view").size(),0,"Url is not added")}},{name:"should change priority",preSetup:function(){var a=this.service=new d;e.setService(a),e.getProxy().markRecordSetAsCompleteLoaded("priority")},test:function(){var a=this.$el,b=a.find(".property-text");b.click();var c=$(".tau-bubble");equal(c.size(),1,"Count of bubbles");var d=c.eq(0).find('.drop-down-option:contains("'+n.name+'")');this.service.registerSaveCommand({config:{$set:{priority:{id:n.id}},fields:["id"],id:j.id},returnedData:{id:j.id,Priority:{Id:n.id,Name:n.name}}}),d.click(),equal(this.$el.find(".property-text").text(),n.name,"Priority was changed")}}];b.create(o,l).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests(p).done();var q=f.create("[component.priority] empty",h,a,l),r=g.getBugs()[1],s={context:{type:r.__type,id:r.id}};b.create(q,s).viewShouldFollowBasicComponentLifeCycle().viewShouldPassTests([{name:"should render valid markup for empty release",test:function(){var a=this.$el;equal(a.find(".property-text").text(),"","Release name")}}]).done()};return{run:g}})