define(["Underscore","jQuery","tau/configurations/factory.container.config","tau/components/component.entity.actions","tests/components/component.specs","tests/common/testData","tests/components/common/common.setup","tests/common/applicationContext"],function(_,$,factoryContainerConfig,component,componentSpecs,testData,commonSetup,AppContext){var innerRun=function(){function runTestIteration(entityTypeName){var setup=commonSetup.create("[component.entity.actions]["+entityTypeName+"]",{},component),viewTests=[{name:"should render valid markup",test:function(){var $el=this.$el,$target=$el.find(".tau-entity-actions-target");ok($target.hasClass("tau-bubble-target")),$target.click();var $menuItems=$("body").find(".tau-bubble__inner > .ui-menu-actions > .drop-down-list > .ui-menu__item");ok($menuItems.size()>0,"Menu items are shown on click")}}],context={context:{type:entityTypeName,id:15}},appContext=new AppContext(context);context.context.applicationContext=appContext,componentSpecs.create(setup,context).viewShouldFollowDataComponentLifeCycle().viewShouldPassTests(viewTests).done()}function checkPractices(cfg){var entityTypeName=cfg.entityTypeName,practiceName=cfg.practiceName,menuItemTitle=cfg.menuItemTitle,practiceEnabled=cfg.practiceEnabled,context={context:{type:entityTypeName,id:15}},appContext=new AppContext(context);if(!practiceEnabled)appContext.processes[0].practices=_(appContext.processes[0].practices).select(function(practice){return practice.name!==practiceName});else{var practices=_(appContext.processes[0].practices).select(function(practice){return practice.name===practiceName});if(!practices.length)throw{message:"["+practiceName+"] practice not found"}}context.context.applicationContext=appContext;var setup=commonSetup.create("[component.entity.actions]["+entityTypeName+"]["+practiceName+":"+practiceEnabled+"]",{},component,null,appContext),viewTests=[{name:"should render valid markup",test:function(){var $el=this.$el,$target=$el.find(".tau-entity-actions-target");ok($target.hasClass("tau-bubble-target")),$target.click();var $menuItems=$("body").find(".tau-bubble__inner > .ui-menu-actions > .drop-down-list > .ui-menu__item"),menuItem=$menuItems.find(":contains('"+menuItemTitle+"')"),expectedAmount=practiceEnabled?1:0;equals(menuItem.size(),expectedAmount,"Practice is applied")}}];componentSpecs.create(setup,context).viewShouldPassTests(viewTests).done()}runTestIteration("bug"),runTestIteration("userStory"),runTestIteration("feature"),runTestIteration("release"),checkPractices({entityTypeName:"userStory",practiceName:"Bug Tracking",menuItemTitle:"Add Issue",practiceEnabled:!0}),checkPractices({entityTypeName:"userStory",practiceName:"Bug Tracking",menuItemTitle:"Add Issue",practiceEnabled:!1}),checkPractices({entityTypeName:"release",practiceName:"Iterations",menuItemTitle:"Add Iteration",practiceEnabled:!0}),checkPractices({entityTypeName:"release",practiceName:"Iterations",menuItemTitle:"Add Iteration",practiceEnabled:!1})};return{run:innerRun}})