define(["jQuery","tests/common/testkit","tau/components/component.customField.multiselect","tau/components/component.customField.multiselect.list"],function($,ComponentTestKit,Component){var run=function(){var TestCase=new ComponentTestKit("[component.customField.multiselect]",Component),userStories={us1:{name:"US1",customFields:[{name:"Multi",type:"MultipleSelectionList",value:"Aaren,Abahri"}]}},data=TestCase.loadFixtures({userStories:userStories});return TestCase.setData(data),TestCase.setEntity(data.userStory.us1),TestCase.selectDefaultProject(),TestCase.appContext.processes[0].customFields=[{name:"Multi",type:"MultipleSelectionList",required:!1,listed:!1,value:"Aaren\r\nAarika\r\nAaron\r\nAartjan\r\nAbagael\r\nAbagail\r\nAbahri\r\nAbbas\r\nAbbe\r\nAbbey\r\nAbbi\r\nAbbie\r\nAbby\r\nAbbye\r\nAbdalla\r\nAbdallah\r\nAbdul\r\nAbdullah\r\nAbe\r\nAbel\r\nAbigael\r\nAbigail\r\nAbigale\r\nAbra\r\nAbraham\r\nAbu\r\nAccess\r\nAccounting\r\nAchal\r\nAchamma\r\nAction\r\nAda\r\nAdah\r\nAdaline\r\nAdam\r\nAdan\r\nAdara\r\nAdda"}],TestCase.addTest({name:"should render valid markup",test:function(){var $el=this.$el;equals($el.find(".ui-customfield__value").text(),"Aaren, Abahri","Correct process and output")}}),TestCase.addTest({name:"should allow to edit",test:function(){var $el=this.$el,$val=$el.find(".tau-bubble-target"),entity=data.userStory.us1;$val.click();var $popup=$val.tauBubble("widget"),$empty=$popup.find("[role=placeholder-empty]");equals($empty.length,0," No Show empty"),equals($popup.length,1,"Show popup");var $options=$popup.find("[role=option]");equals($options.length,38,"Show optss"),equals($options.eq(0).text(),"Aaren","First opt"),equals($options.eq(1).text(),"Aarika","Second opt"),equals($options.eq(0).hasClass("tau-option_selected_true"),!0,"First opt"),equals($options.eq(1).hasClass("tau-option_selected_true"),!1,"Second opt");var $buttons=$popup.find("input");equals($buttons.length,2,"There is a buttons"),$options.eq(3).click(),equals($options.eq(3).hasClass("tau-option_selected_true"),!0),$buttons.eq(1).click(),$val.click();var $popup=$val.tauBubble("widget"),$options=$popup.find("[role=option]");equals($options.length,38,"Show optss"),equals($options.eq(3).hasClass("tau-option_selected_true"),!1,"Reset cancel works");var $buttons=$popup.find("input");equals($buttons.length,2,"There is a buttons"),TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Multi",type:"MultipleSelectionList",value:"Aaron,Aartjan,Abahri"}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Multi",type:"MultipleSelectionList",value:"Aaron,Aartjan,Abahri"}]}}),$options.eq(0).click(),$options.eq(2).click(),$options.eq(3).click(),$buttons.eq(0).click(),$newEl=this.$el,ok($newEl!==$el,"Reload field"),equals($newEl.find(".ui-customfield__value").text(),"Aaron, Aartjan, Abahri","New value")}}),TestCase.addTest({name:"process empty",test:function(){var $el=this.$el,$val=$el.find(".tau-bubble-target"),entity=data.userStory.us1;$val.click();var $popup=$val.tauBubble("widget"),$reset=$popup.find(".action-link.clear");equals($reset.length,1,"Reset active"),TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Multi",type:"MultipleSelectionList",value:null}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Multi",type:"MultipleSelectionList",value:null}]}}),$reset.click();var $el=this.$el,$val=$el.find(".tau-bubble-target");$val.click();var $popup=$val.tauBubble("widget"),$reset=$popup.find(".action-link.clear");equals($reset.length,0,"no reset active")}}),TestCase.run({customField:{type:"MultipleSelectionList",name:"Multi"}})};return{run:run}})