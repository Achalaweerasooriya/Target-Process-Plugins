define(["jQuery","tests/common/testkit","tau/components/component.customField.number"],function($,ComponentTestKit,Component){var run=function(){var TestCase=new ComponentTestKit("[component.customField.number]",Component),userStories={us1:{name:"US1",customFields:[{name:"NumberOfBeast",type:"Number",value:666}]}},data=TestCase.loadFixtures({userStories:userStories});return TestCase.setData(data),TestCase.setEntity(data.userStory.us1),TestCase.selectDefaultProject(),TestCase.appContext.processes[0].customFields=[{name:"NumberOfBeast",type:"Number",required:!1,listed:!1,value:null}],TestCase.addTest({name:"should render valid markup",test:function(){var $el=this.$el;equals($el.find(".ui-customfield__label").text().trim(),"NumberOfBeast","Name is valid"),equals($el.find(".ui-customfield__value").text(),666,"Correct process and output")}}),TestCase.addTest({name:"should allow to edit",test:function(){var $el=this.$el,entity=data.userStory.us1;TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"NumberOfBeast",type:"Number",value:777}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"NumberOfBeast",type:"Number",value:"777"}]}}),ok($el.hasClass("ui-customfield_editable_true"),"Editable highlighting is applied");var $valEl=this.$el.find(".ui-customfield__value"),value=$valEl.text();$valEl.click(),equals($valEl.attr("contenteditable"),"true","Generate editor"),$valEl.focus(),$valEl.text("777"),$valEl.blur(),equals($valEl.text(),"777","Save value")}}),TestCase.addTest({name:"validation",test:function(){var entity=data.userStory.us1,value=this.$el.find(".ui-customfield__value").text();this.$el.find(".ui-customfield__value").click(),equals(this.$el.find(".ui-customfield__value").attr("contenteditable"),"true","Generate editor"),this.$el.find(".ui-customfield__value").focus(),this.$el.find(".ui-customfield__value").text("preved"),this.$el.find(".ui-customfield__value").blur(),ok(this.$el.find(".ui-customfield__value").hasClass("ui-validationerror"),"Validate with error"),ok(this.$el.find(".ui-customfield__value").attr("title")!=0,"Validated with error"),TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"NumberOfBeast",type:"Number",value:123}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"NumberOfBeast",type:"Number",value:"123"}]}}),this.$el.find(".ui-customfield__value").click(),this.$el.find(".ui-customfield__value").focus(),this.$el.find(".ui-customfield__value").text("  123  "),this.$el.find(".ui-customfield__value").blur(),equals(this.$el.find(".ui-customfield__value").text(),"123","Sanitize value"),equals(this.$el.find(".ui-customfield__value").hasClass("ui-validationerror"),!1,"Validate sanitized value"),ok(_.isEmpty(this.$el.find(".ui-customfield__value").attr("title")),"Validate sanitized value")}}),TestCase.addTest({name:"spec validation",test:function(){var $el=this.$el,entity=data.userStory.us1,$valEl=this.$el.find(".ui-customfield__value"),value=$valEl.text();$valEl.click(),TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"NumberOfBeast",type:"Number",value:null}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"NumberOfBeast",type:"Number",value:null}]}}),this.$el.find(".ui-customfield__value").focus(),this.$el.find(".ui-customfield__value").text(""),this.$el.find(".ui-customfield__value").blur(),$valEl.click(),equals(this.$el.find(".ui-customfield__value").text(),"","Sanitize empty value"),equals(this.$el.find(".ui-customfield__value").hasClass("ui-validationerror"),!1,"Validate empty value"),ok(_.isEmpty(this.$el.find(".ui-customfield__value").attr("title")),"Validate empty value");var $valEl=this.$el.find(".ui-customfield__value"),value=$valEl.text();$valEl.click(),TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"NumberOfBeast",type:"Number",value:0x7048860ddf79}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"NumberOfBeast",type:"Number",value:0x7048860ddf79}]}}),this.$el.find(".ui-customfield__value").focus(),this.$el.find(".ui-customfield__value").text("123456789012345"),this.$el.find(".ui-customfield__value").blur(),equals(this.$el.find(".ui-customfield__value").text(),"123456789012345","Process large numbers"),equals(this.$el.find(".ui-customfield__value").hasClass("ui-validationerror"),!1,"Process large numbers")}}),TestCase.run({customField:{type:"Number",name:"NumberOfBeast"}})};return{run:run}})