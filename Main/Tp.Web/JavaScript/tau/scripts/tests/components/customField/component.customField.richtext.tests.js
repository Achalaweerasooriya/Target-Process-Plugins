define(["jQuery","tests/common/testkit","tau/components/component.customField.richtext"],function($,a,b){var c=function(){var c=new a("[component.customField.richtext]",b),d={us1:{name:"US1",customFields:[{name:"Bio",type:"RichText",value:"Lorem Ipsum"}]}},e=c.loadFixtures({userStories:d});return c.setData(e),c.setEntity(e.userStory.us1),c.selectDefaultProject(),c.appContext.processes[0].customFields=[{name:"Bio",type:"RichText",required:!1,listed:!1,value:null}],c.addTest({name:"should render valid markup",test:function(){var a=this.$el;equals(a.find(".value:first").html(),"Lorem Ipsum","Content is valid")}}),c.addTest({name:"should allow to edit",test:function(){var a=this.$el,b=e.userStory.us1,d=this.$el.find(".value:first"),f=d.html();c.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:"edited"}]},fields:["id","customFields"],id:b.id},returnedData:{id:b.id,customFields:[{name:"Bio",type:"RichText",value:"edited"}]}});var g=a.find(".value:first");g.dblclick(),equals(a.find("textarea").length,1,"Generate editor textarea"),equals(a.find("textarea").val(),f,"Set value to editor");var h="edited";a.find("textarea").val(h),a.find("button:first").click();var d=this.$el.find(".value:first");equals(d.html(),h,"Save value from editor");var a=this.$el,d=this.$el.find(".value:first"),f=d.html();c.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:""}]},fields:["id","customFields"],id:b.id},returnedData:{id:b.id,customFields:[{name:"Bio",type:"RichText",value:""}]}});var g=a.find(".value:first");g.dblclick(),a.find("textarea").val(""),a.find("button:first").click()}}),c.run({customField:{type:"RichText",name:"Bio"}})};return{run:c}})