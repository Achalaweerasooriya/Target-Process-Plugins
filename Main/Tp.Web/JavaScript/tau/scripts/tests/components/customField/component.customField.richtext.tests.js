define(["jQuery","tests/common/testkit","tau/components/component.customField.richtext"],function(a,b,c){var d=function(){var a=new b("[component.customField.richtext]",c),d={us1:{name:"US1",customFields:[{name:"Bio",type:"RichText",value:"Lorem Ipsum"}]}},e=a.loadFixtures({userStories:d});return a.setData(e),a.setEntity(e.userStory.us1),a.selectDefaultProject(),a.appContext.processes[0].customFields=[{name:"Bio",type:"RichText",required:!1,listed:!1,value:null}],a.addTest({name:"should render valid markup",test:function(){var a=this.$el;equals(a.find(".value:first").html(),"Lorem Ipsum","Content is valid")}}),a.addTest({name:"should allow to edit",test:function(){var b=this.$el,c=e.userStory.us1,d=this.$el.find(".value:first"),f=d.html();a.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:"edited"}]},fields:["id","customFields"],id:c.id},returnedData:{id:c.id,customFields:[{name:"Bio",type:"RichText",value:"edited"}]}});var g=b.find(".value:first");g.dblclick(),equals(b.find("textarea").length,1,"Generate editor textarea"),equals(b.find("textarea").val(),f,"Set value to editor");var h="edited";b.find("textarea").val(h),b.find("button:first").click();var d=this.$el.find(".value:first");equals(d.html(),h,"Save value from editor");var b=this.$el,d=this.$el.find(".value:first"),f=d.html();a.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:""}]},fields:["id","customFields"],id:c.id},returnedData:{id:c.id,customFields:[{name:"Bio",type:"RichText",value:""}]}});var g=b.find(".value:first");g.dblclick(),b.find("textarea").val(""),b.find("button:first").click()}}),a.run({customField:{type:"RichText",name:"Bio"}})};return{run:d}})