define(["jQuery","tests/common/testkit","tau/components/component.customField.richtext"],function($,ComponentTestKit,Component){var run=function(){var TestCase=new ComponentTestKit("[component.customField.richtext]",Component),userStories={us1:{name:"US1",customFields:[{name:"Bio",type:"RichText",value:"Lorem Ipsum"}]}},data=TestCase.loadFixtures({userStories:userStories});return TestCase.setData(data),TestCase.setEntity(data.userStory.us1),TestCase.selectDefaultProject(),TestCase.appContext.processes[0].customFields=[{name:"Bio",type:"RichText",required:!1,listed:!1,value:null}],TestCase.addTest({name:"should render valid markup",test:function(){var $el=this.$el;equals($el.find(".value:first").html(),"Lorem Ipsum","Content is valid")}}),TestCase.addTest({name:"should allow to edit",test:function(){var $el=this.$el,entity=data.userStory.us1,$valEl=this.$el.find(".value:first"),value=$valEl.html();TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:"edited"}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Bio",type:"RichText",value:"edited"}]}});var $target=$el.find(".value:first");$target.dblclick(),equals($el.find("textarea").length,1,"Generate editor textarea"),equals($el.find("textarea").val(),value,"Set value to editor");var newData="edited";$el.find("textarea").val(newData),$el.find("button:first").click();var $valEl=this.$el.find(".value:first");equals($valEl.html(),newData,"Save value from editor");var $el=this.$el,$valEl=this.$el.find(".value:first"),value=$valEl.html();TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Bio",type:"RichText",value:""}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Bio",type:"RichText",value:""}]}});var $target=$el.find(".value:first");$target.dblclick(),$el.find("textarea").val(""),$el.find("button:first").click()}}),TestCase.run({customField:{type:"RichText",name:"Bio"}})};return{run:run}})