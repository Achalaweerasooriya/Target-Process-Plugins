define(["jQuery","tests/common/testkit","tau/components/component.customField.url","tau/components/component.customField.url.editor"],function(a,b,c){var d=function(){var a=new b("[component.customField.url]",c),d={us1:{name:"US1",customFields:[{name:"Best Porn",type:"URL",value:{label:"XXXVip",url:"http://xxx.xxx"}}]}},e=a.loadFixtures({userStories:d});return a.setData(e),a.setEntity(e.userStory.us1),a.selectDefaultProject(),a.appContext.processes[0].customFields=[{name:"Best Porn",type:"URL",required:!1,listed:!1,value:null}],a.addTest({name:"should render valid markup",test:function(){var a=this.$el;equals(a.find(".ui-customfield__label").text(),"Best Porn","Correct output"),equals(a.find(".ui-customfield__value").text(),"XXXVip","Correct output"),equals(a.find(".ui-customfield__value-url").attr("href"),"http://xxx.xxx","Correct output")}}),a.addTest({name:"should allow to edit",test:function(){var b=this.$el,c=b.find(".tau-bubble-target"),d=e.userStory.us1;c.click();var f=c.tauBubble("widget");equals(f.length,1,"Show popup");var g=f.find(":text");equals(g.length,2,"There is a inputs");var h=f.find(":button");equals(h.length,2,"There is a buttons"),a.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Best Porn",type:"URL",value:{url:"http://megapornus.com",label:"MegaPorn"}}]},fields:["id","customFields"],id:d.id},returnedData:{id:d.id,customFields:[{name:"Best Porn",type:"URL",value:{label:"MegaPorn",url:"http://megapornus.com"}}]}}),g.eq(0).val("http://megapornus.com"),g.eq(1).val("MegaPorn"),h.eq(0).click(),$newEl=this.$el,ok($newEl!==b,"Reload field"),equals($newEl.find(".ui-customfield__value").text(),"MegaPorn","New value")}}),a.run({customField:{type:"URL",name:"Best Porn"}})};return{run:d}})