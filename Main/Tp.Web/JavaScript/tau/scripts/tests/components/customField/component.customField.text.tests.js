define(["jQuery","tests/common/testkit","tau/components/component.customField.text"],function($,ComponentTestKit,Component){var run=function(){var TestCase=new ComponentTestKit("[component.customField.text]",Component),userStories={us1:{name:"US1",customFields:[{name:"Motto",type:"Text",value:"Kill them all"}]}},data=TestCase.loadFixtures({userStories:userStories});return TestCase.setData(data),TestCase.setEntity(data.userStory.us1),TestCase.selectDefaultProject(),TestCase.appContext.processes[0].customFields=[{name:"Motto",type:"Text",required:!1,listed:!1,value:null}],TestCase.addTest({name:"should render valid markup",test:function(){var $el=this.$el;equals($el.find(".ui-customfield__label").text().trim(),"Motto","Name is valid"),equals($el.find(".ui-customfield__value").text(),"Kill them all","Correct process and output")}}),TestCase.addTest({name:"should allow to edit",test:function(){var $el=this.$el,entity=data.userStory.us1;TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Motto",type:"Text",value:"Now or never"}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Motto",type:"Text",value:"Now or never"}]}}),ok($el.hasClass("ui-customfield_editable_true"),"Editable highlighting is applied");var $valEl=this.$el.find(".ui-customfield__value"),value=$valEl.text();$valEl.click(),equals($valEl.attr("contenteditable"),"true","Generate editor"),$valEl.focus(),$valEl.text("Now or never"),$valEl.blur();var $valEl=this.$el.find(".ui-customfield__value");equals($valEl.text(),"Now or never","Save value")}}),TestCase.addTest({name:"should allow to save empty",test:function(){var $el=this.$el,entity=data.userStory.us1;TestCase.getService().registerSaveCommand({config:{$set:{customFields:[{name:"Motto",type:"Text",value:null}]},fields:["id","customFields"],id:entity.id},returnedData:{id:entity.id,customFields:[{name:"Motto",type:"Text",value:null}]}}),ok($el.hasClass("ui-customfield_editable_true"),"Editable highlighting is applied");var $valEl=this.$el.find(".ui-customfield__value"),value=$valEl.text();$valEl.click(),equals($valEl.attr("contenteditable"),"true","Generate editor"),$valEl.focus(),$valEl.text("  "),$valEl.blur();var $valEl=this.$el.find(".ui-customfield__value");equals($valEl.text(),"","Save value")}}),TestCase.run({customField:{type:"Text",name:"Motto"}})};return{run:run}})