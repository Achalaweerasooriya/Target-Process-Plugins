(function(a){module("changeLogPopup",{setup:function(){jQuery.fx.off=!0,this.source=[{Version:{Number:"1"},Url:"http://link1"},{Version:{Number:"2"},Url:"http://link2"},{Version:{Number:"3"},Url:"http://link3"},{Version:{Number:"4"},Url:"http://link4"},{Version:{Number:"5"},Url:"http://link5"}],this.iterator=new changeLogIterator(this.source),this.form=a('<div style="display:none"/>'),this.container=a('<div style="display:none"/>'),this.close=a('<a class="close" id="uniquecloseid">close</a>'),this.close.appendTo(this.container),this.prev=a('<a class="prev" id="uniqueprevid">${Version.Number}</a>'),this.prev.appendTo(this.container),this.next=a('<a class="next" id="uniquenextid">${Version.Number}</a>'),this.next.appendTo(this.container),this.targetElement=a('<a id="whatsNewLink">What\'s new</a>'),this.targetElement.appendTo(this.container),this.iframe=new iframeMock;var b={form:this.form,iterator:this.iterator,iframe:this.iframe,header:a("<div>header</div>"),sourceElement:this.targetElement};this.container.changeLogPopup(b),this.widget=this.container.data("changeLogPopup")},teardown:function(){this.widget.hide(),delete this.source,delete this.iterator,this.container.remove(),delete this.container,this.close.remove(),delete this.close,this.prev.remove(),delete this.prev,this.next.remove(),delete this.next,this.targetElement.remove(),delete this.targetElement,delete this.iframe,this.widget.destroy(),delete this.widget}}),test("creation",function(){equals(this.widget.closeLink.id(),this.close.id()),equals(this.widget.prevLink.id(),this.prev.id()),equals(this.widget.nextLink.id(),this.next.id())}),test("show",function(){this.widget.show(),equals(this.iframe.src,this.iterator.current().Url,"source should be set to iterator.current()"),this.iframe.load(),equals(this.container.css("display")=="none",!1,"popup should be shown when content is loaded"),equals(a(".modalBackground").length,1,"popup should be shown as modal"),equals(this.next.css("display")!="none",!0,"Next button should be shown"),equals(this.prev.css("display")!="none",!0,"Previous button should be shown"),this.widget.hide(),equals(a(".modalBackground").length,0,"popup should be hidden as modal")}),test("paging",function(){this.widget.show(),this.iframe.load(),equals(this.next.text(),"2","next version should be shown on next button"),this.next.click(),equals(this.iframe.src,"http://link2","next version url should be in iframe.src when moving forward"),equals(this.next.text(),"3","next version should be updated when next button clicked"),equals(this.prev.text(),"1","previous version should be updated when next button clicked"),this.prev.click(),equals("http://link1",this.iframe.src),equals(this.next.text(),"2","next version should be updated when previous button clicked")}),test("close",function(){this.widget.show(),this.iframe.load(),this.close.click(),equals(this.container.css("display"),"none","popup should be hidden when close clicked")}),test("positioning",function(){this.widget.show(),this.iframe.load()}),test("singlePage",function(){var b=[{Version:{Number:"1"},Url:"http://link1"}],c=new changeLogIterator(b),d=a('<div style="display:none"/>'),e=a('<a class="close" id="uniquecloseid">close</a>');e.appendTo(d);var f=a('<a class="prev" id="uniqueprevid">${Version.Number}</a>');f.appendTo(d);var g=a('<a class="next" id="uniquenextid">${Version.Number}</a>');g.appendTo(d);var h=new iframeMock;d.changeLogPopup({iterator:c,iframe:h,header:a("<div>header</div>")}),equals(g.css("display")=="none",!0,"Next button should be hidden"),equals(f.css("display")=="none",!0,"Previous button should be hidden")})})(jQuery)