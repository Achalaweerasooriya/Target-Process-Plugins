require(["tp/plugins/pluginsRepository"],function(pluginsRepository){(function(){module("plugins repository tests",{setup:function(){this.plugins=[{category:"New Plugins",plugins:[{name:"Bugzilla",description:"Synchronizes Bugzilla and TargetProcess",newProfileUrl:"/targetprocess/Admin/EditProfileExt.aspx?acid=CBDA7D6711B8B8AD2B61B1B6BB3C4017&PluginName=Bugzilla&Placeholders=profileeditorbugzilla&BackUrl=%2ftargetprocess%2fAdmin%2fPlugins.aspx",profiles:[{name:"bz",pluginName:"Bugzilla",editUrl:"/targetprocess/Admin/EditProfileExt.aspx?acid=CBDA7D6711B8B8AD2B61B1B6BB3C4017&PluginName=Bugzilla&ProfileName=bz&Placeholders=profileeditorbugzilla&BackUrl=%2ftargetprocess%2fAdmin%2fPlugins.aspx"}]}]}],this.pluginsRepository=pluginsRepository;var that=this;this.pluginsRepository.gateway={postJSON:function(url,data,success){success(that.plugins)}}},teardown:function(){}}),test("should find started plugin with at least one profile",function(){expect(1);var pluginStartedAndHasProfile=!1;this.pluginsRepository.pluginStartedAndHasAtLeastOneProfile("Bugzilla",function(data){pluginStartedAndHasProfile=!0}),ok(pluginStartedAndHasProfile,"Plugin started and has at least one profile")}),test("should not do anything if plugin is not started or doesn't have any profiles",function(){expect(1);var pluginStartedAndHasProfile=!1;this.pluginsRepository.pluginStartedAndHasAtLeastOneProfile("Noname",function(data){pluginStartedAndHasProfile=!0}),ok(pluginStartedAndHasProfile==0,"Plugin is not started or doesn't have any profiles")})})()})