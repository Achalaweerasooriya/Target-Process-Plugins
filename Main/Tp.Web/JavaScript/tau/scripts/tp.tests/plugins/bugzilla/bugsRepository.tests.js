require(["tp/plugins/bugzilla/bugsRepository"],function(bugzillaRepository){(function(){module("check bugzilla repository",{setup:function(){this.repository=bugzillaRepository,this.repository.commandGateway={execute:function(command,data,success){success([{Classification:"Unclassified",Component:"TestComponent",CustomFields:[{Name:"cf_cm",Values:[null]}],Id:"1",OS:"Windows",Platform:"PC",Reporter:"bugzilla@targetprocess.com",TpId:100,Version:"unspecified"},{Classification:"Unclassified",Component:"TestComponent",CustomFields:[{Name:"cf_cm",Values:[null]}],Id:"2",OS:"Windows",Platform:"PC",Reporter:"bugzilla@targetprocess.com",TpId:102,Version:"unspecified"},{Classification:"Unclassified",Component:"TestComponent",CustomFields:[{Name:"cf_cm",Values:[null]}],Id:"10",OS:"Windows",Platform:"PC",Reporter:"bugzilla@targetprocess.com",TpId:110,Version:"unspecified"},{Classification:"Unclassified",Component:"TestComponent",CustomFields:[{Name:"cf_cm",Values:[null]}],Id:"20",OS:"Windows",Platform:"PC",Reporter:"bugzilla@targetprocess.com",TpId:120,Version:"unspecified"}])}},this.findBugById=function(bugId){return function(element){return element.TpId===bugId}}},teardown:function(){}}),test("should get bugzilla bugs by single id",function(){var bugId=102;this.repository.getBugs([bugId],function(){});var bug=this.repository.getBugInfo(bugId);ok(bug.TpId===bugId,"server should return requested bugzilla info");var bugs=$.grep(this.repository.store,this.findBugById(bug.TpId));ok(bugs.length===1,"bug from the server should be stored locally")})})()})