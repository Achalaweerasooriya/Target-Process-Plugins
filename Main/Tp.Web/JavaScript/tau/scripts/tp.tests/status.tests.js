require(["tp/status"],function(status){(function(){module("status tests",{setup:function(){status.defaultTimeout=1e3},teardown:function(){}}),test("should show custom status and then hide",function(){var state="warn",message="test message";status.custom(state,message,2e3,100);var repeat=function(condition,check,delay,timeout){var checkCondition=function(condition,check,delay,timeout,counter){return function(){condition()||delay*counter>timeout?check():setTimeout(checkCondition(condition,check,delay,timeout,counter+1),delay)}};return checkCondition(condition,check,delay,timeout,0)()};stop(),repeat(function(){return $(".plugins.info-block").find("div").hasClass("_opened")},function(){var block=$(".plugins.info-block");ok(block.find("div").hasClass(state),"status is valid"),equals(block.text(),message,"status message is valid"),notEqual(block.css("display"),"none","status message is shown"),start()},50,2100)})})()})