define(["tp/codemirror/lib/codemirror"],function(t){t.defineMode("gfm",function(e){function o(t,e){return t.sol()&&t.match(/^```([\w+#]*)/)?(e.localMode=r(RegExp.$1),e.localMode&&(e.localState=e.localMode.startState()),e.token=a,"code"):l.token(t,e.mdState)}function a(t,e){return t.sol()&&t.match(/^```/)?(e.localMode=e.localState=null,e.token=o,"code"):e.localMode?e.localMode.token(t,e.localState):(t.skipToEnd(),"code")}function n(t,e){var o;if(t.match(/^\w+:\/\/\S+/))return"linkhref";if(t.match(/^[^\[*\\<>` _][^\[*\\<>` ]*[^\[*\\<>` _]/))return l.getType(e);if(o=t.match(/^[^\[*\\<>` ]+/)){var a=o[0];return"_"===a[0]&&"_"===a[a.length-1]?void t.backUp(a.length):l.getType(e)}return t.eatSpace()?null:void 0}var l=t.getMode(e,"markdown"),c={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp"},r=function(){var o,a,n={},l={},r=t.listModes();for(o=0;o<r.length;o++)n[r[o]]=r[o];var d=t.listMIMEs();for(o=0;o<d.length;o++)a=d[o].mime,l[a]=d[o].mime;for(var i in c)(c[i]in n||c[i]in l)&&(n[i]=c[i]);return function(o){return n[o]?t.getMode(e,n[o]):null}}();return{startState:function(){var t=l.startState();return t.text=n,{token:o,mode:"markdown",mdState:t,localMode:null,localState:null}},copyState:function(e){return{token:e.token,mode:e.mode,mdState:t.copyState(l,e.mdState),localMode:e.localMode,localState:e.localMode?t.copyState(e.localMode,e.localState):null}},token:function(t,e){return e.token(t,e)}}})});