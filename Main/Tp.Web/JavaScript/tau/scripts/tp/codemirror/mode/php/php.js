define(["tp/codemirror/lib/codemirror"],function(a){(function(){function b(a){var b={},c=a.split(" ");for(var d=0;d<c.length;++d)b[c[d]]=!0;return b}function c(a){return function(b,c){return b.match(a)?c.tokenize=null:b.skipToEnd(),"string"}}var d={name:"clike",keywords:b("abstract and array as break case catch cfunction class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw try use var while xor returndie echo empty exit eval include include_once isset list require require_once print unset"),blockKeywords:b("catch do else elseif for foreach if switch try while"),atoms:b("true false null TRUE FALSE NULL"),multiLineStrings:!0,hooks:{$:function(a,b){return a.eatWhile(/[\w\$_]/),"variable-2"},"<":function(a,b){return a.match(/<</)?(a.eatWhile(/[\w\.]/),b.tokenize=c(a.current().slice(3)),b.tokenize(a,b)):!1},"#":function(a,b){return a.skipToEnd(),"comment"}}};a.defineMode("php",function(b,c){function i(a,b){if(b.curMode==e){var c=e.token(a,b.curState);return c=="meta"&&/^<\?/.test(a.current())?(b.curMode=h,b.curState=b.php,b.curClose=/^\?>/,b.mode="php"):c=="tag"&&a.current()==">"&&b.curState.context&&(/^script$/i.test(b.curState.context.tagName)?(b.curMode=f,b.curState=f.startState(e.indent(b.curState,"")),b.curClose=/^<\/\s*script\s*>/i,b.mode="javascript"):/^style$/i.test(b.curState.context.tagName)&&(b.curMode=g,b.curState=g.startState(e.indent(b.curState,"")),b.curClose=/^<\/\s*style\s*>/i,b.mode="css")),c}return a.match(b.curClose,!1)?(b.curMode=e,b.curState=b.html,b.curClose=null,b.mode="html",i(a,b)):b.curMode.token(a,b.curState)}var e=a.getMode(b,"text/html"),f=a.getMode(b,"text/javascript"),g=a.getMode(b,"text/css"),h=a.getMode(b,d);return{startState:function(){var a=e.startState();return{html:a,php:h.startState(),curMode:c.startOpen?h:e,curState:c.startOpen?h.startState():a,curClose:c.startOpen?/^\?>/:null,mode:c.startOpen?"php":"html"}},copyState:function(b){var c=b.html,d=a.copyState(e,c),f=b.php,g=a.copyState(h,f),i;return b.curState==c?i=d:b.curState==f?i=g:i=a.copyState(b.curMode,b.curState),{html:d,php:g,curMode:b.curMode,curState:i,curClose:b.curClose}},token:i,indent:function(a,b){return a.curMode!=h&&/^\s*<\//.test(b)||a.curMode==h&&/^\?>/.test(b)?e.indent(a.html,b):a.curMode.indent(a.curState,b)},electricChars:"/{}:"}}),a.defineMIME("application/x-httpd-php","php"),a.defineMIME("application/x-httpd-php-open",{name:"php",startOpen:!0}),a.defineMIME("text/x-php",d)})()})