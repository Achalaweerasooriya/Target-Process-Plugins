CodeMirror.defineMode("stex",function(a,b){function l(a,b){var c=a.peek();if(c=="{"||c=="["){var f=d(b),g=f.openBracket(c);a.eat(c),i(b,j);return"bracket"}if(/[ \t\r]/.test(c)){a.eat(c);return null}i(b,j),f=d(b),f&&e(b);return j(a,b)}function k(a,b){a.skipToEnd(),i(b,j);return"comment"}function j(a,b){if(a.match(/^\\[a-z]+/)){var e=a.current();e=e.substr(1,e.length-1);var g=h[e];typeof g=="undefined"&&(g=h.DEFAULT),g=new g,c(b,g),i(b,l);return g.style}var j=a.next();if(j=="%"){i(b,k);return"comment"}if(j=="}"||j=="]"){g=d(b);if(g)g.closeBracket(j),i(b,l);else return"error";return"bracket"}if(j=="{"||j=="["){g=h.DEFAULT,g=new g,c(b,g);return"bracket"}if(/\d/.test(j)){a.eatWhile(/[\w.%]/);return"atom"}a.eatWhile(/[\w-_]/);return f(b)}function i(a,b){a.f=b}function g(a,b,c,d){return function(){this.name=a,this.bracketNo=0,this.style=b,this.styles=d,this.brackets=c,this.styleIdentifier=function(a){return this.bracketNo<=this.styles.length?this.styles[this.bracketNo-1]:null},this.openBracket=function(a){this.bracketNo++;return"bracket"},this.closeBracket=function(a){}}}function f(a){var b=a.cmdState;for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.name=="DEFAULT")continue;return d.styleIdentifier()}return null}function e(a){if(a.cmdState.length>0){var b=a.cmdState.pop();b.closeBracket()}}function d(a){return a.cmdState.length>0?a.cmdState[a.cmdState.length-1]:null}function c(a,b){a.cmdState.push(b)}var h=[];h.importmodule=g("importmodule","tag","{[",["string","builtin"]),h.documentclass=g("documentclass","tag","{[",["","atom"]),h.usepackage=g("documentclass","tag","[",["atom"]),h.begin=g("documentclass","tag","[",["atom"]),h.end=g("documentclass","tag","[",["atom"]),h.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=function(a){},this.openBracket=function(a){},this.closeBracket=function(a){}};return{startState:function(){return{f:j,cmdState:[]}},copyState:function(a){return{f:a.f,cmdState:a.cmdState.slice(0,a.cmdState.length)}},token:function(a,b){var c=b.f(a,b),d=a.current();return c}}}),CodeMirror.defineMIME("text/x-stex","stex")