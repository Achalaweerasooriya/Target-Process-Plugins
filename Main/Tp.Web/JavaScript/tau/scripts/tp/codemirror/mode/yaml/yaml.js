define(["tp/codemirror/lib/codemirror"],function(CodeMirror){CodeMirror.defineMode("yaml",function(){var cons=["true","false","on","off","yes","no"],keywordRegex=new RegExp("\\b(("+cons.join(")|(")+"))$","i");return{token:function(stream,state){var ch=stream.peek(),esc=state.escaped;state.escaped=!1;if(ch=="#")return stream.skipToEnd(),"comment";if(state.literal&&stream.indentation()>state.keyCol)return stream.skipToEnd(),"string";state.literal&&(state.literal=!1);if(stream.sol()){state.keyCol=0,state.pair=!1,state.pairStart=!1;if(stream.match(/---/))return"def";if(stream.match(/\.\.\./))return"def";if(stream.match(/\s*-\s+/))return"meta"}if(!state.pair&&stream.match(/^\s*([a-z0-9\._-])+(?=\s*:)/i))return state.pair=!0,state.keyCol=stream.indentation(),"atom";if(state.pair&&stream.match(/^:\s*/))return state.pairStart=!0,"meta";if(stream.match(/^(\{|\}|\[|\])/))return ch=="{"?state.inlinePairs++:ch=="}"?state.inlinePairs--:ch=="["?state.inlineList++:state.inlineList--,"meta";if(state.inlineList>0&&!esc&&ch==",")return stream.next(),"meta";if(state.inlinePairs>0&&!esc&&ch==",")return state.keyCol=0,state.pair=!1,state.pairStart=!1,stream.next(),"meta";if(state.pairStart){if(stream.match(/^\s*(\||\>)\s*/))return state.literal=!0,"meta";if(stream.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable-2";if(state.inlinePairs==0&&stream.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(state.inlinePairs>0&&stream.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(stream.match(keywordRegex))return"keyword"}return state.pairStart=!1,state.escaped=ch=="\\",stream.next(),null},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}}}}),CodeMirror.defineMIME("text/x-yaml","yaml")})