CodeMirror.defineMode("tiddlywiki",function(a,b){function F(a,b){var c,d,f,g;if(a.current()=="<<")return w("brace","macro");c=a.next();if(!c){b.tokenize=x;return w(c)}if(c==">"&&a.peek()==">"){a.next(),b.tokenize=x;return w("brace","macro")}a.eatWhile(/[\w\$_]/),f=a.current(),g=e.propertyIsEnumerable(f)&&e[f];return g?w(g.type,g.style,f):w("macro",null,f)}function E(a,b){var c=!1,d,e;while(d=a.next()){if(d=="-"&&c){b.tokenize=x;break}c=d=="-"}return w("text","line-through")}function D(a,b){var c=!1,d;while(d=a.next()){if(d=="_"&&c){b.tokenize=x;break}c=d=="_"}return w("text","underlined")}function C(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=x;break}c=d=="/"}return w("text","em")}function B(a,b){var c,d=b.block;if(d&&a.current())return w("code","code");if(!d&&a.match(r)){b.tokenize=x;return w("code","code-inline")}if(d&&a.sol()&&a.match(p)){b.tokenize=x;return w("code","code")}c=a.next();return d?w("code","code"):w("code","code-inline")}function A(a,b){var c=!1,d;while(d=a.next()){if(d=="'"&&c){b.tokenize=x;break}c=d=="'"}return w("text","strong")}function z(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=x;break}c=d=="%"}return w("comment","comment")}function y(a){return function(b,c){t(b,a)||(c.tokenize=x);return w("string","string")}}function x(a,b){var c=a.sol(),e,p;b.block=!1,e=a.peek();if(c&&/[<\/\*{}\-]/.test(e)){if(a.match(o)){b.block=!0;return s(a,b,B)}if(a.match(j))return w("quote","quote");if(a.match(h)||a.match(i))return w("code","code");if(a.match(k)||a.match(l)||a.match(m)||a.match(n))return w("code","code");if(a.match(g))return w("hr","hr")}var e=a.next();if(c&&/[\/\*!#;:>|]/.test(e)){if(e=="!"){a.skipToEnd();return w("header","header")}if(e=="*"){a.eatWhile("*");return w("list","list")}if(e=="#"){a.eatWhile("#");return w("list","list")}if(e==";"){a.eatWhile(";");return w("list","list")}if(e==":"){a.eatWhile(":");return w("list","list")}if(e==">"){a.eatWhile(">");return w("quote","quote")}if(e=="|")return w("table","table")}if(e=="{"&&a.match(/\{\{/))return s(a,b,B);if(/[hf]/i.test(e)&&/[ti]/i.test(a.peek())&&a.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return w("link-external","link-external");if(e=='"')return w("string","string");if(/[\[\]]/.test(e)&&a.peek()==e){a.next();return w("brace","brace")}if(e=="@"){a.eatWhile(f);return w("link-external","link-external")}if(/\d/.test(e)){a.eatWhile(/\d/);return w("number","number")}if(e=="/"){if(a.eat("%"))return s(a,b,z);if(a.eat("/"))return s(a,b,C)}if(e=="_"&&a.eat("_"))return s(a,b,D);if(e=="-"&&a.eat("-"))return s(a,b,E);if(e=="'"&&a.eat("'"))return s(a,b,A);if(e!="<")return w(e);if(a.eat("<"))return s(a,b,F);a.eatWhile(/[\w\$_]/);var q=a.current(),r=d.propertyIsEnumerable(q)&&d[q];return r?w(r.type,r.style,q):w("text",null,q)}function w(a,b,c){u=a,v=c;return b}function t(a,b){var c=!1,d;while((d=a.next())!=null){if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function s(a,b,c){b.tokenize=c;return c(a,b)}var c=a.indentUnit,d=function(){function a(a){return{type:a,style:"text"}}return{}}(),e=function(){function a(a){return{type:a,style:"macro"}}return{allTags:a("allTags"),closeAll:a("closeAll"),list:a("list"),newJournal:a("newJournal"),newTiddler:a("newTiddler"),permaview:a("permaview"),saveChanges:a("saveChanges"),search:a("search"),slider:a("slider"),tabs:a("tabs"),tag:a("tag"),tagging:a("tagging"),tags:a("tags"),tiddler:a("tiddler"),timeline:a("timeline"),today:a("today"),version:a("version"),option:a("option"),"with":a("with"),filter:a("filter")}}(),f=/[\w_\-]/i,g=/^\-\-\-\-+$/,h=/^\/\*\*\*$/,i=/^\*\*\*\/$/,j=/^<<<$/,k=/^\/\/\{\{\{$/,l=/^\/\/\}\}\}$/,m=/^<!--\{\{\{-->$/,n=/^<!--\}\}\}-->$/,o=/^\{\{\{$/,p=/^\}\}\}$/,q=/\{\{\{/,r=/.*?\}\}\}/,u,v;return{startState:function(a){return{tokenize:x,indented:0,level:0}},token:function(a,b){if(a.eatSpace())return null;var c=b.tokenize(a,b);return c},electricChars:""}}),CodeMirror.defineMIME("text/x-tiddlywiki","tiddlywiki")