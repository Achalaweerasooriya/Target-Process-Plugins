define(["app.path","tp/gateway","jQuery"],function(t,i,e){function n(){this._ctor()}var s=t.get();return n.prototype={_requestUrlBase:"/api/v1/Plugins.asmx",_registeredPlugins:null,_waitingForPluginsCallbacks:null,_ctor:function(){this.gateway=i},_getUrl:function(){var t=s+this._requestUrlBase;return t},pluginsRetrieved:function(t){this._registeredPlugins=t;for(var i=0;i<this._waitingForPluginsCallbacks.length;i++)this._waitingForPluginsCallbacks[i](this._registeredPlugins)},getStartedPlugins:function(t){this._registeredPlugins||this._waitingForPluginsCallbacks?!this._registeredPlugins&&this._waitingForPluginsCallbacks?this._waitingForPluginsCallbacks.push(t):this._registeredPlugins&&t(this._registeredPlugins):(this._waitingForPluginsCallbacks=[t],this.gateway.postJSON(this._getUrl(),{},e.proxy(this.pluginsRetrieved,this)))},pluginStartedAndHasAtLeastOneProfile:function(t,i,n){this.getStartedPlugins(e.proxy(function(s){var r=e.grep(s,function(i){var n=e.grep(i.plugins,function(i){return i.name==t});if(0===n.length)return!1;var s=!1;return e(n).each(function(t,i){i.profiles.length>0&&(s=!0)}),s});r.length>0?i():n&&n()},this))}},new n});