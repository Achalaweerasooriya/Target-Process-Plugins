define(["app.path","tp/gateway","jQuery"],function(AppPath,gateway,$){function PluginsRepository(){this._ctor()}var appPath=AppPath.get();return PluginsRepository.prototype={_requestUrlBase:"/api/v1/Plugins.asmx",_registeredPlugins:null,_waitingForPluginsCallbacks:null,_ctor:function(){this.gateway=gateway},_getUrl:function(){var url=appPath+this._requestUrlBase;return url},pluginsRetrieved:function(plugins){this._registeredPlugins=plugins;for(var i=0;i<this._waitingForPluginsCallbacks.length;i++)this._waitingForPluginsCallbacks[i](this._registeredPlugins)},getStartedPlugins:function(success){!this._registeredPlugins&&!this._waitingForPluginsCallbacks?(this._waitingForPluginsCallbacks=[success],this.gateway.postJSON(this._getUrl(),{},$.proxy(this.pluginsRetrieved,this))):!this._registeredPlugins&&this._waitingForPluginsCallbacks?this._waitingForPluginsCallbacks.push(success):this._registeredPlugins&&success(this._registeredPlugins)},pluginStartedAndHasAtLeastOneProfile:function(pluginName,success){this.getStartedPlugins($.proxy(function(data){var plugins=$.grep(data,function(element){var plugin=$.grep(element.plugins,function(item){return item.name==pluginName});if(plugin.length===0)return!1;var hasProfiles=!1;return $(plugin).each(function(index,item){item.profiles.length>0&&(hasProfiles=!0)}),hasProfiles});plugins.length>0&&success()},this))}},new PluginsRepository})