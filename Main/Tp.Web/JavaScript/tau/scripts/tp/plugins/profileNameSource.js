define(["tp/bus","app.path","jQuery","tp/mashups"],function(bus,appPath){function ProfileNameSource(config){this._create(config)}return ProfileNameSource.prototype={_create:function(config){this.bus=bus,this.bus.subscribe("ProfileNameSource",{onProfileSaveSucceed:$.proxy(function(profile){this.setProfileName(profile.Name)},this)},!0)},getPluginName:function(){return(new appPath.tp.URL(location.href)).getArgumentValue("PluginName")},getProfileNameKey:function(){return"ProfileName"},getProfileName:function(){var url=new appPath.tp.URL(location.href),profileName=url.getArgumentValue(this.getProfileNameKey());if(!profileName){var hash=url.getReference();hash&&(profileName=hash.substr(1))}return profileName},setProfileName:function(profileName){if(this.getProfileName())return;window.location=window.location+"#"+profileName}},new ProfileNameSource})