define(["jQuery","tp/plugins/profileNameSource","tp/gateway","app.path"],function($,profileNameSource,gateway,appPath){function CommandGateway(config){this._create(config)}return CommandGateway.prototype={_requestUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Commands/{CommandName}",_requestForProfileUrlBase:"/api/v1/Plugins.asmx/{PluginName}/Profiles/{ProfileName}/Commands/{CommandName}",_pluginName:null,_create:function(config){this.profileNameSource=profileNameSource,this.gateway=gateway,config&&config.pluginName?this._pluginName=config.pluginName:this._pluginName=this.profileNameSource.getPluginName()},_getUrl:function(commandName){var relativeUrl=this._requestUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{CommandName}/g,commandName);return(new appPath.tp.WebServiceURL(relativeUrl)).url},_getUrlForProfile:function(commandName){var relativeUrl=this._requestForProfileUrlBase.replace(/{PluginName}/g,this._pluginName).replace(/{ProfileName}/g,this.profileNameSource.getProfileName()).replace(/{CommandName}/g,commandName);return(new appPath.tp.WebServiceURL(relativeUrl)).url},_post:function(url,data,success,fail,error){this.gateway.postJSON(url,data,function(response){success&&success(response)},function(response){fail&&fail(response.responseText)},function(response){error&&error(response.responseText)})},execute:function(command,data,success,fail,error){this._post(this._getUrl(command),data,success,fail,error)},executeForProfile:function(command,data,success,fail,error){this._post(this._getUrlForProfile(command),data,success,fail,error)}},CommandGateway})