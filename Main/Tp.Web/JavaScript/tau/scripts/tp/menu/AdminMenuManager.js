define(["tp/menu/MenuManager","jQuery","app.path","tp/plugins/restService","tau/configurator"],function(e,t,i,r,n){function s(e){this._create(e)}return s.prototype={_create:function(r){this._itemText=r.itemText,this._itemUrl=new i.tp.WebServiceURL(r.itemUrl).url,this._identifyUrlPart=r.identifyUrlPart,this._menuManager=new e({menu:t('[id="System Settings Action Group"]')}),this._item='<tr><td><div><a class="'+r.classIdentificator+' _adminMashupMenuItem" href="'+this._itemUrl+'">'+this._itemText+"</a></div></td></tr>"},addItem:function(){var e=this._itemIsAvailableForCurrentUser();e.done(function(e){e&&(this._menuManager.addItem(this._item),this._fixSelection())}.bind(this))},_fixSelection:function(){this._menuManager.fixSelection(this._identifyUrlPart,this._itemText)},_itemIsAvailableForCurrentUser:function(){var e=t.Deferred();if(n.getLoggedUser&&n.getLoggedUser()){var i=n.getLoggedUser().isAdministrator;e.resolve(i)}else{var s=new r;t.getJSON(s._getUrl("context")).done(function(t){e.resolve(t.LoggedUser.IsAdministrator)})}return e.promise()}},s});