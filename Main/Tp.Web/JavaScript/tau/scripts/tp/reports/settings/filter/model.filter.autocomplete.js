define(["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.suggestionManager"],function(e,t,n){var r=t.extend({"bus beforeInit":function(e,t){var r=t.config.context.configurator;this.fire("configurator.ready",r),this.fire("suggestionManager.ready",new n(r))},getTypes:function(t){return e.map(t.parameters.definition.cells.items,function(e){return e.id})},"bus filter.autocomplete.preload + suggestionManager.ready:last + settings.changed:last":function(t,n,r,i){var o=this.getTypes(i);if(0!=o.length){var s=n.value;if(s&&0!==s.length&&"?"==s[0]){var a=[s.trim()+" ",s.trim()+"."];e.each(a,function(e){var t={query:{resourceTypes:o,script:e}};r.get(t)})}}},"bus filter.autocomplete.resolve + suggestionManager.ready:last + settings.changed:last":function(t,n,r,i){var o=this.getTypes(i);if(0==o.length)return void n.next([]);var s=function(t){var r=t.Suggestions?t.Suggestions.Items:[];r=e.map(r,function(e){return e.Source=t.Source,e.Position=t.Position,e}),n.next(r)},a=function(){n.next([])},u={query:{resourceTypes:o,script:n.term}};r.get(u).done(s).fail(a)}});return r});