define(["Underscore","tau/core/extension.base","tau/models/board.editor/board.filter.suggestionManager"],function(e,t,n){var r=t.extend({"bus beforeInit":function(e,t){var r=t.config.context.configurator;this.fire("configurator.ready",r),this.fire("suggestionManager.ready",new n(r))},getTypes:function(t){return e.map(t.parameters.definition.cells.items,function(e){return e.id})},"bus filter.autocomplete.preload + suggestionManager.ready:last + settings.changed:last":function(t,n,r,i){var s=this.getTypes(i);if(0!=s.length){var o=n.value;if(o&&0!==o.length&&"?"==o[0]){var a=[o.trim()+" ",o.trim()+"."];e.each(a,function(e){var t={query:{resourceTypes:s,script:e}};r.get(t)})}}},"bus filter.autocomplete.resolve + suggestionManager.ready:last + settings.changed:last":function(t,n,r,i){var s=n.$input,o=this.getTypes(i);if(0==o.length)return void n.next([]);var a=n.request.term.slice(0,s[0].selectionStart),u=function(t){var r=t.Suggestions?t.Suggestions.Items:[];r=e.map(r,function(e){return e.Source=t.Source,e.Position=t.Position,e}),n.next(r)},g=function(){n.next([])},c={query:{resourceTypes:o,script:a}};r.get(c).done(u).fail(g)}});return r});