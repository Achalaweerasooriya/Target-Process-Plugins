define(["Underscore","tau/core/extension.base"],function(t,e){return e.extend({defaultData:{},"bus beforeInit":function(e,a){var i=a.config.context.configurator;this.fire("configurator.ready",i);var n=i.getRestStorage();n=t.bind(n.data,n,"settings",a.config.storageName),this.fire("storageSettings.ready",n),n().done(t.bind(function(e){e.data&&e.data.userData?this.fire("model.ready",t.defaults(e.data.userData,this.defaultData)):this.fire("model.ready",this.defaultData)},this))},"bus configurator.ready:last > storageSettings.ready:last > formData.changed":function(e,a,i,n){this.saveSettings(i,n),this.getAcid(a).done(t.bind(function(t){this.setSettings(n,t,a)},this))},"bus saveSettings:last + storageSettings.ready:last + saveSetting":function(e,a,i,n){i({scope:"Public",userData:t.extend(a,n)}).done()},getAcid:function(t){var e=$.Deferred();return t.getAppStateStore().get({fields:["acid"],callback:function(t){e.resolve(t.acid)}}),e},saveSettings:function(t,e){this.fire("saveSettings",e)},setSettings:function(){}})});