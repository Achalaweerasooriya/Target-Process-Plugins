define(["jQuery","tp/reports/plot","tp/reports/burndown/summaryPopup"],function(t,e){var r=function(r){this.name=r.name,this.placeholder=t(r.placeholder),this.dataProvider=r.dataProvider,this.plot=new e({charts:r.charts,captions:r.captions,height:r.height,width:r.width,margin:r.margin||50,showLegend:r.showLegend,showLabels:r.showLabels,axes:r.axes}),this.navigator=r.navigator,this.contextProvider=r.contextProvider,this.template=r.template||'<div class="burnDownReport _burnDownReport">\n    <span class="tableTitle">Burn Down</span>\n    <div>\n        <div id="report-filter">\n        </div>\n    </div>\n    <div id="report-chart" class="tau-chart-plot">    \n    </div>\n</div>',t(r.charts).on("click",this._chartClick.bind(this))};return r.prototype={getTermProcessor:function(){return this.contextProvider.getTermProcessorForCurrentProject()},update:function(e){this.placeholder.html("").height("").width("").addClass("loader"),this.dataProvider.initialize(e,function(e){this.placeholder.removeClass("loader"),this.plot.render(e),t(this).trigger("afterRender")}.bind(this))},resize:function(e){this.plot.resize(e),t(this).trigger("afterRender")},render:function(){t(this).trigger("afterInit"),this.plot.placeholder=this.placeholder},_chartClick:function(e,r){if(r.data.effort){var i=r.$rect;if(i.data("summaryPopup")&&i.summaryPopup("popup").is(":visible"))return void r.origin.stopPropagation();var o=this,a=this.navigator;this.dataProvider.getDetails(r.data,function(n){i.summaryPopup({alignTo:r.$pointer,termProcessor:o.getTermProcessor(),hideOnScrollContainer:o.contextProvider.isTP3?i.scrollParent():null,index:r.index,data:n,show:function(){e.target.fadeOut(r.rect)},hide:function(){e.target.fadeIn(r.rect)},navigate:function(t){a.navigate(t)}}).summaryPopup("show"),t(o).trigger("details.afterRender",[i.summaryPopup("popup")])})}}},r});