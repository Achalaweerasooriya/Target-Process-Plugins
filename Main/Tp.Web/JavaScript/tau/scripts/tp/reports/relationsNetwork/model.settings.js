define(["Underscore","tp/reports/settings/model.settings","tp/reports/settings/definitionBuilder","tp/reports/settings/templateDataBuilder"],function(_,BaseModel,DefinitionBuilder,templateDataBuilder){return BaseModel.extend({NAME_CHART:"Relations Network",DESCRIPTION:["This network is a visualization of direct and hidden dependency relations between any entities in TargetProcess (e.g. projects, user stories, features, bugs, tasks, etc.)"],defaultData:{entities:JSON.stringify(["userstory"]),filter:"?Iteration is Current",onlyWithRelations:!1,isShowSettings:!0,isShowLegend:!0},saveSettings:function(storage,data){var settings={filter:data.filter,onlyWithRelations:data.onlyWithRelations,entities:JSON.stringify(_.map(data.entities,function(d){return d.id}))};storage({scope:"Public",userData:settings}).done(),this._super(storage,settings)},setSettings:function(data,acid){var settings={strategy:"page",parameters:DefinitionBuilder.getWithRelations(data,acid)};this.fire("settings.changed",settings)},"bus configurator.ready:last + model.ready":function(e,configurator,model){var types=configurator.getFeaturesService().isEnabled("tp2.application")?templateDataBuilder.tp2generals(model):templateDataBuilder.generals(model);this.fire("dataBind",{onlyWithRelations:model.onlyWithRelations,types:types,filter:templateDataBuilder.filter(model,"?Iteration is Current"),isShowSettings:model.isShowSettings,name:this.NAME_CHART,description:this.DESCRIPTION})}})})