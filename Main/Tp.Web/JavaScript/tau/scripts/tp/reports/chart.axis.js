define(["libs/d3/d3"],function(t){var a=function(a){function r(){r.d3axis.apply(this.d3axis,arguments),r.transform.apply(r.transform,arguments),r.axis.apply(r.axis,arguments),r.tick.apply(r.tick,arguments),r.label.apply(r.label,arguments),r.additionalAxes.apply(r.additionalAxes,arguments)}var e=10;return r.d3axis=t.svg.axis(),r.transform=function(){},r.axis=function(){},r.tick=function(r){r.selectAll("g").attr("class","axisLabel");var e=r.selectAll(".tick")[0].map(function(a){var r=t.select(a);return{x2:r.attr("x2"),transform:r.attr("transform")}}).concat(r.selectAll("g.axisLabel")[0].map(function(a){var r=t.select(a);return{x2:r.select("line.tick").attr("x2"),transform:r.attr("transform")}}));r.selectAll(".tick").attr("y1",-a).attr("y2",function(){return parseFloat(t.select(this).attr("y2"))-a}),r.selectAll(".smallAxisTick").remove();var n=r.selectAll(".smallAxisTick").data(e.filter(function(t){return t.transform}));n.enter().append("line").attr("x2",function(t){return t.x2}).attr("y2",6).attr("transform",function(t){return t.transform}).attr("class","smallAxisTick")},r.label=function(){},r.scale=function(t){return this.d3axis.scale(t),r},r.additionalAxes=function(){},r.orient=function(n){switch(n.type){case"x-grid":var i=n.margin-n.height;return r.d3axis.orient("bottom").tickSize(i,n.margin-n.height,0).tickPadding(10),r.transform=function(t){t.attr("transform","translate(0,"+(n.height+a)+")")},r.axis=function(r){r.select("path").attr("d",function(){var r=t.select(this).attr("d"),e=/M\D*\d+\D*/.exec(r)[0].length-1,n=parseFloat(r.substr(1,e-1));return"M"+(n-a)+r.substr(e)})},r.label=function(a){var e=t.select(a.selectAll(".axisLabel text")[0][0]);a.selectAll("text.axisLabel").attr("transform","translate("+(r.d3axis.scale().range()[1]+n.margin/4)+", 0)").attr("y",e.attr("y")).attr("dy",e.attr("dy")).text(n.label)},r.additionalAxes=function(t){var e=[{id:"top",value:n.margin-n.height-a},{id:"bottom",value:-a}],i=t.selectAll("line._additionalXAxis").data(e,function(t){return t.id});i.enter().append("line").attr("class","additionalAxis _additionalXAxis"),i.attr("x1",r.d3axis.scale().range()[0]).attr("x2",r.d3axis.scale().range()[1]).attr("y1",function(t){return t.value}).attr("y2",function(t){return t.value}),i.exit().remove()},r;case"y-grid":var i=-n.width+n.margin;return r.d3axis.orient("left").tickSize(i,i,0).tickPadding(e),r.transform=function(t){t.attr("transform","translate("+(n.margin-a)+", 0)")},r.axis=function(r){r.select("path").attr("d",function(){var r=t.select(this).attr("d"),e=r.indexOf("V"),n=r.indexOf("H",e),i=parseFloat(r.substr(e+1,n-e-1))+a;return r.substr(0,e+1)+i+r.substr(n)})},r.tick=function(r){r.selectAll("g").attr("class","axisLabel"),r.selectAll(".tick").attr("dx",.5*n.margin).attr("x1",a).attr("x2",function(){return parseFloat(t.select(this).attr("x2"))+a});var e=r.selectAll(".tick")[0].map(function(a){var r=t.select(a);return{y2:r.attr("y2"),transform:r.attr("transform")}}).concat(r.selectAll("g.axisLabel")[0].map(function(a){var r=t.select(a);return{y2:r.select("line.tick").attr("y2"),transform:r.attr("transform")}}));r.selectAll(".smallAxisTick").remove();var i=r.selectAll(".smallAxisTick").data(e.filter(function(t){return t.transform}));i.enter().append("line").attr("y2",function(t){return t.y2}).attr("x2",-6).attr("transform",function(t){return t.transform}).attr("class","smallAxisTick")},r.label=function(t){t.selectAll("text.axisLabel").attr("transform","translate("+-n.margin/2+","+(n.margin-a+e)+")").text(n.label)},r.additionalAxes=function(t){var e=[{id:"right",value:n.width-n.margin+a},{id:"left",value:a}],i=t.selectAll("line._additionalYAxis").data(e,function(t){return t.id});i.enter().append("line").attr("class","additionalAxis _additionalYAxis"),i.attr("x1",function(t){return t.value}).attr("x2",function(t){return t.value}).attr("y1",r.d3axis.scale().range()[0]).attr("y2",r.d3axis.scale().range()[1]),i.exit().remove()},r}},r.tickSubdivide=function(t){return r.d3axis.tickSubdivide(t),r},r.tickFormat=function(t){return r.d3axis.tickFormat(t),r},r};return a});