define(["libs/d3/d3"],function(t){var a=function(t,a){return["translate(",t,",",a,")"].join("")};return function(r){function e(){e.d3axis.apply(this.d3axis,arguments),e.transform.apply(e.transform,arguments),e.axis.apply(e.axis,arguments),e.tick.apply(e.tick,arguments),e.label.apply(e.label,arguments),e.additionalAxes.apply(e.additionalAxes,arguments)}var n=10;return e.d3axis=t.svg.axis(),e.transform=function(){},e.axis=function(){},e.tick=function(a){a.selectAll("g").classed({axisLabel:!0}).selectAll("line").classed({"i-role-tick":!0});var e=a.selectAll("line.i-role-tick")[0].map(function(a){var r=t.select(a);return{x2:r.attr("x2"),transform:r.attr("transform")}}).concat(a.selectAll("g.axisLabel")[0].map(function(a){var r=t.select(a);return{x2:r.select("line.i-role-tick").attr("x2"),transform:r.attr("transform")}}));a.selectAll(".i-role-tick").attr("y1",-r).attr("y2",function(){return parseFloat(t.select(this).attr("y2"))-r}),a.selectAll(".smallAxisTick").remove();var n=a.selectAll(".smallAxisTick").data(e.filter(function(t){return t.transform}));n.enter().append("line").attr("x2",function(t){return t.x2}).attr("y2",6).attr("transform",function(t){return t.transform}).attr("class","smallAxisTick")},e.label=function(){},e.scale=function(t){return this.d3axis.scale(t),e},e.additionalAxes=function(){},e.orient=function(i){var l;switch(i.type){case"x-grid":return l=i.margin-i.height,e.d3axis.orient("bottom").tickSize(l,i.margin-i.height,0).tickPadding(10),e.transform=function(t){t.attr("transform",a(0,i.height+r))},e.axis=function(a){a.select("path").attr("d",function(){var a=t.select(this).attr("d"),e=/M\D*\d+\D*/.exec(a)[0].length-1,n=parseFloat(a.substr(1,e-1));return"M"+(n-r)+a.substr(e)})},e.label=function(r){var n=t.select(r.selectAll(".axisLabel text")[0][0]);r.selectAll("text.axisLabel").attr("transform",a(e.d3axis.scale().range()[1]+i.margin/4,0)).attr("y",n.attr("y")).attr("dy",n.attr("dy")).text(i.label)},e.additionalAxes=function(t){var a=[{id:"top",value:i.margin-i.height-r},{id:"bottom",value:-r}],n=t.selectAll("line._additionalXAxis").data(a,function(t){return t.id
});n.enter().append("line").attr("class","additionalAxis _additionalXAxis"),n.attr("x1",e.d3axis.scale().range()[0]).attr("x2",e.d3axis.scale().range()[1]).attr("y1",function(t){return t.value}).attr("y2",function(t){return t.value}),n.exit().remove()},e;case"y-grid":return l=-i.width+i.margin,e.d3axis.orient("left").tickSize(l,l,0).tickPadding(n),e.transform=function(t){t.attr("transform",a(i.margin-r,0))},e.axis=function(a){a.select("path").attr("d",function(){var a=t.select(this).attr("d"),e=a.indexOf("V"),n=a.indexOf("H",e),i=parseFloat(a.substr(e+1,n-e-1))+r;return a.substr(0,e+1)+i+a.substr(n)})},e.tick=function(a){a.selectAll("g").classed({axisLabel:!0}).selectAll("line").classed({"i-role-tick":!0}),a.selectAll(".i-role-tick").attr("dx",.5*i.margin).attr("x1",r).attr("x2",function(){return parseFloat(t.select(this).attr("x2"))+r});var e=a.selectAll(".i-role-tick")[0].map(function(a){var r=t.select(a);return{y2:r.attr("y2"),transform:r.attr("transform")}}).concat(a.selectAll("g.axisLabel")[0].map(function(a){var r=t.select(a);return{y2:r.select("line.i-role-tick").attr("y2"),transform:r.attr("transform")}}));a.selectAll(".smallAxisTick").remove();var n=a.selectAll(".smallAxisTick").data(e.filter(function(t){return t.transform}));n.enter().append("line").attr("y2",function(t){return t.y2}).attr("x2",-6).attr("transform",function(t){return t.transform}).attr("class","smallAxisTick")},e.label=function(t){t.selectAll("text.axisLabel").attr("transform",a(-i.margin/2,i.margin-r+n)).text(i.label)},e.additionalAxes=function(t){var a=[{id:"right",value:i.width-i.margin+r},{id:"left",value:r}],n=t.selectAll("line._additionalYAxis").data(a,function(t){return t.id});n.enter().append("line").attr("class","additionalAxis _additionalYAxis"),n.attr("x1",function(t){return t.value}).attr("x2",function(t){return t.value}).attr("y1",e.d3axis.scale().range()[0]).attr("y2",e.d3axis.scale().range()[1]),n.exit().remove()},e;default:return e}},e.tickSubdivide=function(t){return e.d3axis.tickSubdivide(t),e
},e.tickFormat=function(t){return e.d3axis.tickFormat(t),e},e}});