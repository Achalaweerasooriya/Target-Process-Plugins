define(["Underscore","tp/reports/settings/model.settings","tp/reports/settings/definitionBuilder","tp/reports/settings/templateDataBuilder"],function(e,t,i,r){return t.extend({NAME_CHART:"Cycle Time Distribution",defaultData:{scale:"cycleTime",entities:["userstory","bug"],filter:"?EndDate > Today - 180(days)"},processSettings:function(t){return{scale:t.time.key,filter:t.filter,useFilter:t.useFilter,entities:JSON.stringify(e.reduce(t.entities,function(e,t){return e.push(t.id),e},[]))}},setSettings:function(t,r){function n(e){return function(t){return t[e]}}function s(e,t){return{map:n(e),label:t}}function o(e){return{map:$.noop,label:e}}var a={strategy:"all",parameters:i.getWithLeadAndCycleTime(t,r),filter:function(i){return e.has(i,t.time.key)},mapping:{y:s(t.time.key,"% of all entities"),x:o(t.time.label),fill:s("type")}};this.fire("settings.changed",a)},"bus model.ready + contextProvider.ready":function(t,i,n){this.fire("dataBind",{times:r.times(i),types:r.assignables(i),isShowSettings:i.isShowSettings,name:this.NAME_CHART,description:this.getDescription(n),filter:r.filter(i,"?EndDate > Today - 180(days)"),useFilter:e.isUndefined(i.useFilter)?!0:i.useFilter,termProcessor:n.getTermProcessorForCurrentProject()})},getDescription:function(e){return["The distribution bars show how many entities were completed within a given cycle time. ","The cumulative line shows how many days will it take to complete a ",e.getTerms("userStory").name.toLowerCase()," or other entity with the desired probability."].join("")}})});