define(["Underscore","jQuery","tau/components/extensions/component.extension.base","tp/reports/chart.plot","tp/reports/timeDistribution/chart.scales","tp/reports/timeDistribution/chart.histogram","libs/d3/d3","tp/reports/timeDistribution/chart.axes","tp/reports/timeDistribution/behaviour.hover"],function(_,$,ExtensionBase,Plot,Scales,HistogramChart,d3,Axes,Hover){return ExtensionBase.extend({"bus afterRender + contextProvider.ready":function(evt,data,contextProvider){var width=$(window).width()*.8,height=$(window).height()*.75,plot=new Plot({scales:new Scales,placeholder:data.element.find(".tau-chart-plot").get(0),width:width,height:height,axes:[Axes.x,Axes.y],charts:[new HistogramChart({contextProvider:contextProvider,handlers:[Hover.create({placeholder:data.element,contextProvider:contextProvider})]})]});this.fire("plot.ready",plot)},"bus plot.ready:last + beforeLoad":function(e,plot){plot.loading(!0)},"bus plot.ready:last + afterLoad":function(e,plot){plot.loading(!1)},_hist:function(data){var histogram=d3.layout.histogram().bins(function(d){return d3.range(0,Math.min(Math.round(d3.max(d))+1,Scales.xMax+1)+1)}).frequency(!1).value(function(d){return d.y});return d3.nest().key(function(d){return d.fill}).rollup(function(leaves){return $.extend(histogram(leaves),{count:leaves.length})}).entries(data)},"bus plot.ready:last + data.ready":function(e,plot,loadedData){plot.data(this._hist(loadedData.data),loadedData.settings),this.fire("plot.afterRender",plot)}})})