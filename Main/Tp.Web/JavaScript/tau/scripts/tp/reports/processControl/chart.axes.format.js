define(["libs/d3/d3","tau/models/model.leadCycleTime"],function(d3,LeadCycleTimeModel){function timeFormat(formats){return function(date){var i=formats.length-1,f=formats[i];while(!f[1](date))f=formats[--i];return f[0](date)}}var timeFormatSelector=function(config){return[[config.year,function(){return!0}],[config.month,function(d){return d.getMonth()}],[config.date,function(d){return d.getDate()!=1}],[config.day,function(d){return d.getDay()&&d.getDate()!=1}],[config.time,function(d){return d.getHours()}]]},formatFirst=timeFormat(timeFormatSelector({year:d3.time.format("%Y"),month:d3.time.format("%b %Y"),date:d3.time.format("%b %e %Y"),day:d3.time.format("%b %e %Y"),time:d3.time.format("%b %e %Y")})),formatNext=timeFormat(timeFormatSelector({year:d3.time.format("%Y"),month:d3.time.format("%b"),date:d3.time.format("%b %e"),day:d3.time.format("%a %e"),time:d3.time.format("%I %p")})),leadCycleTimeModel=new LeadCycleTimeModel({});return{time:function(d,i){return i==0?formatFirst(d):formatNext(d)},timerange:function(dayLabel,hourLabel,minuteLabel){return function(d){return leadCycleTimeModel.getTimeWithAbbreviation(d,dayLabel,hourLabel,minuteLabel)}}}})