define(["jQuery","tp/jquery.utils"],function(){!function(e){e.widget("ui.animatedPopup",{_create:function(){this.element.modal(),this.resizeHandler=e.proxy(this._onResize,this),this.closeLink=e('<a href="#" class="close"></a>').appendTo(this.element.find(".popup-header")),this.closeLink.click(e.proxy(this.hide,this)),e(document).keydown(e.proxy(this._keydown,this))},_keydown:function(e){switch(e.which){case 27:this.hide()}},_onResize:function(){this._trigger("resize"),this._center()},_center:function(){var e=this._getOffset();this.element.offset(e)},_getOffset:function(){var t=e("body"),i=t.width(),n=t.height(),o=(i-this.options.fixedWidth)/2,s=Math.max((n-this._getPopupWidth())/2,50);return{top:s,left:o}},_getPopupWidth:function(){return 200+this.options.fixedWidth},show:function(){var t=this;e(window).bind("resize",t.resizeHandler),t.element.modal("show"),t.options.content.hide();var i=t._getOffset(),n={target:t.options.sourceElement,callback:function(){t.options.content.show(),t._onResize()},settings:{left:i.left,top:i.top,width:t.options.fixedWidth,height:t.options.fixedHeight}};t.element.maximizeFrom(n)},hide:function(){var t=this;e(window).unbind("resize",t.resizeHandler);var i={target:this.options.sourceElement,callback:function(){t.element.modal("hide")}};t.options.content.hide(),this._trigger("onHide"),t.element.minimizeTo(i)}})}(jQuery)});