define(["Underscore","jQuery","./testcase.api","./data.comet"],function(_,$,TestCaseApi,fixtures){var testCase=new TestCaseApi("cell actions",{fixtures:fixtures});return testCase.create({name:"template item for userStory",method:"cell",asserts:function(test,r,slice){var deferred=$.Deferred(),self=this,templateTest=function(r){test.ok(r.data.dataItemTemplate.release,self.desc("release provided")),test.ok(r.data.dataItemTemplate.feature,self.desc("feature provided")),test.equals(r.data.requiredFields.items[0].name,"Name",self.desc("name is required")),test.equals(r.data.requiredFields.items[1].name,"Project",self.desc("project is required")),deferred.resolve()},cell=r.data.items[0],coords={$set:{x:cell.x,y:cell.y,dataItemType:"UserStory"}};return slice.dataItemTemplate(coords).done(templateTest).fail(function(r){test.fail(r.data.status+": "+r.data.statusText),deferred.resolve()}),deferred}}),testCase.create({name:"cell actions",method:"cell",asserts:function(test,r,slice){var deferred=$.Deferred(),self=this,cellActionsTest=function(r){try{test.ok(r.data.items,self.desc("items provided"));var items=r.data&&r.data.items||[];test.equals(items.length,2,self.desc("items are filtered")),test.equals(items[1].hasOwnProperty("x"),!1,"Has no x coordinate"),test.equals(items[1].hasOwnProperty("y"),!1,"Has no y coordinate")}catch(e){test.fail(e.message)}deferred.resolve()},cell=r.data.items[0],coords={$whereX:{x:{$in:[cell.x]}},$whereY:{y:{$in:[cell.y]}}};return slice.cellActions(coords).done(cellActionsTest).fail(function(r){test.fail(r.data.status+": "+r.data.statusText),deferred.resolve()}),deferred}}),testCase.get()})