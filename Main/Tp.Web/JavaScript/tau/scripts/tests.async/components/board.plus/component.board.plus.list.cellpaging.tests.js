define(["Underscore","jQuery","tau/core/event","tau/ui/extensions/board.plus/ui.board.plus.utils","tests.async/testkit/testkit.component.board","tau/components/component.board.plus.list"],function(_,$,Event,BoardPlusUtils,TestKit,ComponentBoardPlus){var testDataCfg={boardSize:4,cardsPerCell:13},testKit=new TestKit(ComponentBoardPlus,{viewMode:"list",x:{types:["release"],filter:"?It is not None"},y:{types:["feature"],filter:"?It is not None"}},testDataCfg),testcase={name:"component.board.plus.list.cellpaging"};return testcase["should render by 100 (+25%) cards"]=testKit.test(function(test){var bus=test.get("bus"),EXPECTED_TOTAL_CARDS_COUNT=testDataCfg.boardSize*testDataCfg.boardSize*testDataCfg.cardsPerCell,EXPECTED_TESTS_COUNT=10;test.expect(EXPECTED_TESTS_COUNT);var checkDynamicItemsBatch=function(actualData,expectations,test){test.equals(actualData.dynamic.items.length,expectations.dynamicItemsLength,expectations.dynamicItemsLength+" items are loaded");var cellpaging=_(actualData.fixed.items).find(function(item){return item.type==="cellpaging"});expectations.hasCellPagingItem?test.ok(cellpaging!=null,"Cell paging fixed item is presented"):test.ok(cellpaging==null,"Cell paging fixed item is not presented anymore")},checkCellNode=function($skeletonCellNode,expectations,test){var $cards=$skeletonCellNode.find(".i-role-card");test.equals($cards.size(),expectations.cardsCountLength,"Cards count");var $showMoreActionPanel=$skeletonCellNode.siblings(".i-role-cell-paging-more"),$showMoreLink=$();return expectations.hasShowMoreLink?(test.equals($showMoreActionPanel.size(),1,"Show more panel is added"),$showMoreLink=$showMoreActionPanel.children(".i-role-cell-paging-more-link"),test.equals($showMoreLink.size(),1,"Show more link is added"),test.ok($showMoreLink.text().indexOf("more")>=0,"Show more text is correct")):test.equals($showMoreActionPanel.size(),0,"Show more panel is removed"),{$showMoreLink:$showMoreLink}},testFlow={bus:bus,"bus model.cells.content.loaded[0]":function(evt){var actualData=evt.data.data.items[0];checkDynamicItemsBatch(actualData,{dynamicItemsLength:100,hasCellPagingItem:!0},test)},"bus view.build.skeleton[0]+view.skeleton.built[0]+view.cell.skeleton.built[0]":function(evt){var evtCellSkeleton=evt["view.cell.skeleton.built[0]"].data,$skeletonCellNode=evtCellSkeleton.element,r=checkCellNode($skeletonCellNode,{cardsCountLength:100,hasShowMoreLink:!0},test);r.$showMoreLink.click()},"bus model.cells.content.loaded[1]+view.cell.skeleton.updated[0]":function(evt){var actualData=evt["model.cells.content.loaded[1]"].data.data.items[0];checkDynamicItemsBatch(actualData,{dynamicItemsLength:EXPECTED_TOTAL_CARDS_COUNT-100,hasCellPagingItem:!1},test);var evtCellSkeleton=evt["view.cell.skeleton.updated[0]"].data,$skeletonCellNode=evtCellSkeleton.element;checkCellNode($skeletonCellNode,{cardsCountLength:EXPECTED_TOTAL_CARDS_COUNT,hasShowMoreLink:!1},test),test.done()}};Event.subscribeOn(testFlow)}),testcase})