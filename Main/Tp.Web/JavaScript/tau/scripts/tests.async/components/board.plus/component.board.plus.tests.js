define(["Underscore","jQuery","tau/core/event","tests.async/testkit/testkit.component.board","tau/components/component.board.plus"],function(_,$,a,b,c){var d=new b(c),e={name:"component.board.plus"},f=function(a){this.$skeleton=a,this.$children=a.find("[role=board-body] > div")},g=function(){var a=[];return this.find("[role=cell] .tau-label").each(function(){a.push($(this).text())}),a},h=function(a){var b=$(this).find("ul > li > [role=cell]");return arguments.length>0&&(b=b.eq(a)),b};f.prototype={getZeroPoint:function(){var a=this.$children.eq(0);return a},getRowsContainer:function(){var a=this.$children.eq(1);return a.getNames=g,a.getMarks=h,a},getColsContainer:function(){var a=this.$children.eq(2);return a.getMarks=h,a.getNames=g,a},getCellsContainer:function(){var a=this.$children.eq(3);return a}};var i=function(a,b,c,d){d.getMarks().each(function(d){var e=$(this),f=c[d];a.equal(e.attr("id"),b+f.id+"-","Element id");var g={};g[b]=f.id,a.same(e.data(),g,"Cell data")})},j=function(a,b,c,d){for(var e=0;e<c.length;e++){var f=c[e],g=b+f.id+"-",h=d.find("#"+g);a.equal(h.size(),1,"Element id");var i={};i[b]=f.id,a.same(h.data(),i,"Cell data")}},k=function(a,b,c,d){var e=b.find("tbody > tr");a.equals(e.size(),4,"Count rows in table");for(var f=0;f<e.size();f++){var g=e.eq(f).find("td > [role=cell]");a.equals(g.size(),4,"Count of cells in row");for(var h=0;h<g.size();h++){var i=g.eq(h),j=c.getMarks(h).data(),k=d.getMarks(f).data();a.equal(i.attr("id"),["x",j.x,"-","y",k.y,"-"].join(""),"Cell ID ["+h+":"+f+"]");var l={x:j.x,y:k.y};a.same(i.data(),l,"Cell data")}}};return e["should render skeleton"]=d.test(function(b){var c=b.get("bus");b.expect(420);var d={bus:c,"bus view.skeleton.built[0]":function(a){var c=a.data.element,d=new f(c);b.ok(c.hasClass("tau-board"),"Tau board css class"),b.equals(c.find(".i-role-name").length,1,"Tau board has name"),b.equals(c.find(".i-role-name").text(),"storage preved","Tau board has name");var e=d.getRowsContainer(),g=d.getColsContainer(),h=d.getCellsContainer();b.ok(d.getZeroPoint().hasClass("tau-x-header"),"x-header css class"),b.ok(e.hasClass("tau-rows-header"),"rows-header css class"),b.ok(g.hasClass("tau-cols-header"),"cols-header css class"),b.ok(h.hasClass("tau-grid"),"grid css class"),b.equal(g.find("> ul > li").size(),4,"Count of columns"),b.equal(e.find("> ul > li").size(),4,"Count of rows");var i=b.get("data"),l=_(i.release).map(function(a){return a}),m=_(l).pluck("name"),n=g.getNames(),o=_.difference(m,n);b.same(o,[],"Names of X axis"),b.equal(g.find("> ul > li > [role=cell]").size(),4,"Count of X-axis cells"),b.equal(e.find("> ul > li > [role=cell]").size(),4,"Count of Y-axis cells"),j(b,"x",l,g);var p=_(i.feature).map(function(a){return a}),q=_(p).pluck("name"),r=e.getNames(),s=_.difference(q,r);b.same(s,[],"Names of Y axis"),j(b,"y",p,e);var t=h.children("table");b.equal(t.children("tbody").children("tr").size(),4,"Rows size"),b.equal(t.children("tbody").children("tr").eq(0).children("td").size(),4,"Columns size"),k(b,t,g,e)},"bus view.skeleton.built[0]:last+template.boardplus.cell.grid.skeleton.bound":function(a){var c=a["view.skeleton.built[0]"].data,d=a["template.boardplus.cell.grid.skeleton.bound"].data,e=d.data,f=c.element,g=b.get("data"),h=_(g.userStory).map(function(a){return a}),i="x"+e.x+"-"+"y"+e.y+"-",j=f.find("#"+i),k=j.find("[role=card]");b.equal(k.size(),4,"Amount of cards in cell");var l=_(h).filter(function(a){return a.release.id==e.x&&a.feature.id==e.y});for(var m=0;m<l.length;m++){var n=l[m],o=n.entityType.name,p=j.find("#"+o.toLowerCase()+"-"+n.id),q=p.find(".tau-id");b.equal(q.text(),n.id,"Card id "+n.id),b.equal(q.attr("href"),"#"+o.toLowerCase()+"/"+n.id,"Card id reference "+n.id),b.equal(p.find(".tau-name").text(),n.name,"Card name "+n.name);var r=p.data();r.type=r.type.toLowerCase(),b.same(r.id,n.id,"Card data"),b.same(r.type,o.toLowerCase(),"Card data")}},"bus view.skeleton.built[0]:last+template.boardplus.cell.axis.skeleton.bound":function(a){var c=a["view.skeleton.built[0]"].data,d=a["template.boardplus.cell.axis.skeleton.bound"].data,e=d.data,f=c.element,g=b.get("data"),h="",i="";e.hasOwnProperty("x")?(h="release",i="x"):e.hasOwnProperty("y")&&(h="feature",i="y");var j=_(g[h]).map(function(a){return a}),k=_(j).find(function(a){return a.id==e[i]}),l=i+e[i]+"-",m=f.find("#"+l);b.equal(m.find(".tau-label").size(),1,"One label only"),b.equal(m.find(".tau-label").text(),k.name,"Label on axis "+i+" = "+k.name)},"bus template.boardplus.cell.grid.skeleton.bound[15]+template.boardplus.cell.axis.skeleton.bound[7]":function(){b.done()}};a.subscribeOn(d)}),e})