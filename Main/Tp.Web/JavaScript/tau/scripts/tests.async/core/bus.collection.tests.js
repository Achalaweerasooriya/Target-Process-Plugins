define(["Underscore","jQuery","tests.async/testkit/testkit","tau/core/bus.collection","tau/core/bus"],function(_,$,TestKit,BusCollection,Bus){var testKit=new TestKit,testcase={name:"bus.collection"};return testcase["reg unreg api"]=testKit.test(function(test){var collection=new BusCollection,bubs=new Bus,tubs=new Bus;collection.onCreate(bubs),collection.onCreate(tubs),test.equals(collection.size(),2,"size"),collection.onDestroy(bubs),test.equals(collection.size(),1,"size"),test.done()}),testcase["get by name"]=testKit.test(function(test){var collection=new BusCollection,bubs=new Bus({name:"bubs"}),tubs=new Bus,dude=new Bus({name:"dude"});collection.onCreate(tubs),collection.onCreate(bubs),collection.getByName("bubs").done(function(bus){test.equals(bus===bubs,!0,"get bus ")}),collection.getByName("dude").done(function(bus){test.equals(bus===dude,!0,"get bus "),test.done()}),collection.onCreate(dude)}),testcase["get by name only one"]=testKit.test(function(test){var collection=new BusCollection,dude=new Bus({name:"dude"}),i=0;collection.getByName("dude").done(function(bus){i++,test.equals(bus===dude,!0,"get bus ")}),collection.onCreate(dude),collection.onCreate(dude),collection.onCreate(dude),test.done()}),testcase})