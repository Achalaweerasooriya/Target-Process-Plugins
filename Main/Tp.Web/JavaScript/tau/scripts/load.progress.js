!function(){var t={_getUrl:function(t){var i=this._getSearch(t);return location.origin+location.pathname+i+location.hash},_getSearch:function(t){var i=location.search?"&":"?";return location.search+i+t},getNoCdnUrl:function(){return this._getUrl("nocdn=1")},getNoMashupsUrl:function(){return this._getUrl("nomashups=1")}},i='Loading mashups takes longer than usual.<br/>Probably, some of them crashed.<br/><a href="'+t.getNoMashupsUrl()+'">Try loading application without mashups</a>.',e={animationOptions:{progressbar:{enabled:!0,activityFakeRunWidthOffset:50},logo:{enabled:!0,lineFullRunOpacity:1,linesInGroupDelay:500}},transitionOptions:{overlayFadeoutDuration:500,progressbar:{property:"width",defaultDuration:3e3,shortDuration:500,easing:"ease"}},loadWarning:{text:"Fetching assets takes longer than usual.<br/>It's possible that content delivery network is not available for you.<br/><a href=\""+t.getNoCdnUrl()+'">Try loading application without CDN</a>.',delay:1e4},activities:[{name:"libs",text:"Loading common libraries…"},{name:"all.components",text:"Loading application components…"},{name:"user.mashups",text:"Loading mashups…",note:{delay:1e4,text:i}},{name:"app.init",text:"Initializing application…",note:{delay:1e4,text:i}}],init:function(){return this.els=this._getElements(),this.progressbarSizes=this._getProgressbarSizes(),this.activitiesMap=this._getProcessedActivities(),this._loadWarningTimeoutTimer=this._showLoadWarning(),this},_getElements:function(){var t=document.querySelector(".i-role-tp-load-progress-overlay"),i=t.querySelector(".i-role-load-progress-bar"),e=t.querySelector(".i-role-load-progress-bar-marker"),n=t.querySelector(".tau-load-progress-logo-content__wrap").querySelector("svg"),s=n.querySelectorAll("line"),r=t.querySelector(".i-role-load-activity-text"),a=t.querySelector(".i-role-load-activity-note"),o=t.querySelector(".i-role-load-activity-warning");return{overlay:t,progressBar:i,marker:e,logo:n,logoLines:s,activityText:r,activityNote:a,activityWarning:o}
},_showLoadWarning:function(){var t=this;return setTimeout(function(){t.els.activityWarning.innerHTML=t.loadWarning.text},this.loadWarning.delay)},_getProgressbarSizes:function(){var t=parseInt(getComputedStyle(this.els.progressBar).width,10),i=Math.floor(t/this.activities.length),e={totalWidth:t,activityWidth:i,currentWidth:0};return e},_getProcessedActivities:function(){var t={},i=this.els.logoLines,e=this.activities,n=this._getGroupedLines(i,e);return this.activities.forEach(function(i,e){var s=i.name;i.index=e,i.displayedLinesCount=0,i.lines=n[e],t[s]=i}),t},_getGroupedLines:function(t,i){var e=Math.floor(t.length/i.length),n=Array.prototype.slice.call(t,t.length-e),s=Array.prototype.slice.call(t,0);s.length=s.length-e;for(var r=[],a=0;a<i.length-1;a++){r[a]||(r[a]=[]);for(var o=0;e>o;o++){var l=Math.floor(Math.random()*s.length),h=s.splice(l,1),c=h[0];r[a].push(c)}}return r.push(n),r},_getTransitionStyle:function(t){var i=t.property+" "+t.duration+"ms "+t.easing;return i},activity:function(t){if(!this._isKnownActivity(t))return this;var i=this.activitiesMap[t];if(this._setActivityText(i.text),i.note){var e=this;this._activityNoteTimeoutTimer=setTimeout(function(){e._setActivityNote(i.note.text)},i.note.delay)}return this.animationOptions.logo.enabled&&this._startLogoAnimation(t),this.animationOptions.progressbar.enabled&&this._startProgressbarAnimation(t),this},_isKnownActivity:function(t){return!!this.activitiesMap[t]},_startLogoAnimation:function(t){var i=this._getLogoAnimationDelay(t);this._showActivityLines({activityName:t,delay:i})},_startProgressbarAnimation:function(t){var i=this._getProgressbarAnimationDelay(t),e=this.transitionOptions.progressbar.defaultDuration;this._advanceMarker({duration:e,width:this._getNewMarkerWidth({isFakeRun:!0}),delay:i})},_getLogoAnimationDelay:function(t){var i=0,e=this.activitiesMap[t],n=e.index,s=this.activities[n-1];if(s){var r=s.lastDisplayedLineTime||s.activityLinesProcessedTime,a=s.displayedLinesCount,o=this.animationOptions.logo.linesInGroupDelay,l=s.lines.length-a,h=r?Date.now()-r:o,c=h>o?0:h;
i=l*o+c}return i},_getProgressbarAnimationDelay:function(){return this.isProgressbarFinishingCurrentActivity?this.transitionOptions.progressbar.shortDuration:0},_showActivityLines:function(t){var i=t.delay||0,e=this.activitiesMap[t.activityName],n=e.lines;e.activityLinesProcessedTime=Date.now(),n.forEach(function(t,n){var s=this.animationOptions.logo.linesInGroupDelay*n;this._showActivityLine({activity:e,line:t,delay:i+s})},this)},_showActivityLine:function(t){var i=t.activity,e=t.line,n=t.delay;setTimeout(function(){i.lastDisplayedLineTime=Date.now(),i.displayedLinesCount++,e.setAttribute("class","")},n)},_getNewMarkerWidth:function(t){var i=t.isFakeRun,e=this.progressbarSizes.activityWidth,n=this.animationOptions.progressbar.activityFakeRunWidthOffset,s=i?e-n:n,r=this.progressbarSizes.currentWidth+s;return r},_advanceMarker:function(t){var i=this._getTransitionStyle({property:this.transitionOptions.progressbar.property,duration:t.duration,easing:this.transitionOptions.progressbar.easing});this.progressbarSizes.currentWidth=t.width,this._updateMarker(this.progressbarSizes.currentWidth,i,t.delay)},_updateMarker:function(t,i,e){var n=this;setTimeout(function(){n.progressbarSizes.animatedToWidth&&n.progressbarSizes.animatedToWidth>t||(n.els.marker.style.transition=i,n.els.marker.style.width=t+"px",n.progressbarSizes.animatedToWidth=t)},e)},_setActivityText:function(t){this.els.activityText.innerHTML=t||""},_setActivityNote:function(t){this.els.activityNote.innerHTML=t||""},_stopActivityNoteTimeoutTimer:function(){this._activityNoteTimeoutTimer&&clearTimeout(this._activityNoteTimeoutTimer)},activityEnd:function(t){return this._isKnownActivity(t)?(this._setActivityText(),this._setActivityNote(),this._stopActivityNoteTimeoutTimer(),this.animationOptions.progressbar.enabled&&this._finishProgressbarAnimation(t),this):this},_finishProgressbarAnimation:function(){var t=this._getNewMarkerWidth({isFakeRun:!1});this.isProgressbarFinishingCurrentActivity=!0;var i=this;setTimeout(function(){i.isProgressbarFinishingCurrentActivity=!1
},this.transitionOptions.progressbar.shortDuration),this._advanceMarker({duration:this.transitionOptions.progressbar.shortDuration,width:t,delay:0})},remove:function(){this._loadWarningTimeoutTimer&&clearTimeout(this._loadWarningTimeoutTimer),this._finishAllAnimations(),$(this.els.overlay).animate({opacity:"0"},this.transitionOptions.overlayFadeoutDuration,function(){e.els.overlay.parentNode.removeChild(e.els.overlay),e.destroy()})},_finishAllAnimations:function(){this._showAllRemainingActivitiesLines()},_showAllRemainingActivitiesLines:function(){this.activities.forEach(function(t){if(t.lines.length!=t.displayedLinesCount){var i=t.lines.slice(t.displayedLinesCount);i.forEach(function(i){this._showActivityLine({line:i,activity:t,delay:0})},this)}},this)},destroy:function(){delete window.tauLoadProgress}};window.tauLoadProgress=e.init()}();